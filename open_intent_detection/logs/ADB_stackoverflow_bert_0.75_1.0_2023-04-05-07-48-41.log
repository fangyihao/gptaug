2023-04-05 07:48:41,330 - Detection - Open Intent Detection Begin...
2023-04-05 07:48:41,331 - Detection - Parameters Initialization...
2023-04-05 07:48:41,331 - Detection - ============================== Params ==============================
2023-04-05 07:48:41,331 - Detection - type:	open_intent_detection
2023-04-05 07:48:41,331 - Detection - logger_name:	Detection
2023-04-05 07:48:41,331 - Detection - log_dir:	logs
2023-04-05 07:48:41,331 - Detection - dataset:	stackoverflow
2023-04-05 07:48:41,331 - Detection - known_cls_ratio:	0.75
2023-04-05 07:48:41,331 - Detection - labeled_ratio:	1.0
2023-04-05 07:48:41,331 - Detection - method:	ADB
2023-04-05 07:48:41,331 - Detection - train:	True
2023-04-05 07:48:41,331 - Detection - pretrain:	True
2023-04-05 07:48:41,331 - Detection - save_model:	True
2023-04-05 07:48:41,331 - Detection - backbone:	bert
2023-04-05 07:48:41,331 - Detection - config_file_name:	ADB
2023-04-05 07:48:41,331 - Detection - seed:	3
2023-04-05 07:48:41,331 - Detection - gpu_id:	0
2023-04-05 07:48:41,331 - Detection - pipe_results_path:	pipe_results
2023-04-05 07:48:41,331 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-05 07:48:41,331 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-05 07:48:41,331 - Detection - model_dir:	models
2023-04-05 07:48:41,331 - Detection - load_pretrained_method:	None
2023-04-05 07:48:41,331 - Detection - result_dir:	results
2023-04-05 07:48:41,331 - Detection - results_file_name:	results_ADB.csv
2023-04-05 07:48:41,331 - Detection - save_results:	True
2023-04-05 07:48:41,331 - Detection - loss_fct:	CrossEntropyLoss
2023-04-05 07:48:41,331 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_0.75_1.0_bert_3
2023-04-05 07:48:41,331 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_0.75_1.0_bert_3/models
2023-04-05 07:48:41,331 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-05 07:48:41,331 - Detection - num_train_epochs:	100
2023-04-05 07:48:41,331 - Detection - num_labels:	None
2023-04-05 07:48:41,331 - Detection - max_seq_length:	None
2023-04-05 07:48:41,331 - Detection - freeze_backbone_parameters:	True
2023-04-05 07:48:41,332 - Detection - feat_dim:	768
2023-04-05 07:48:41,332 - Detection - warmup_proportion:	0.1
2023-04-05 07:48:41,332 - Detection - lr_boundary:	0.05
2023-04-05 07:48:41,332 - Detection - lr:	2e-05
2023-04-05 07:48:41,332 - Detection - activation:	relu
2023-04-05 07:48:41,332 - Detection - train_batch_size:	128
2023-04-05 07:48:41,332 - Detection - eval_batch_size:	64
2023-04-05 07:48:41,332 - Detection - test_batch_size:	64
2023-04-05 07:48:41,332 - Detection - wait_patient:	10
2023-04-05 07:48:41,332 - Detection - ============================== End Params ==============================
2023-04-05 07:48:41,332 - Detection - Data and Model Preparation...
2023-04-05 07:48:41,332 - Detection - The number of known intents is 15
2023-04-05 07:48:41,332 - Detection - Lists of known labels are: ['scala', 'bash', 'apache', 'svn', 'drupal', 'spring', 'haskell', 'hibernate', 'sharepoint', 'osx', 'magento', 'oracle', 'wordpress', 'visual-studio', 'qt']
2023-04-05 07:48:41,371 - Detection - Number of labeled training samples = 9000
2023-04-05 07:48:41,371 - Detection - Number of unlabeled training samples = 3000
2023-04-05 07:48:41,375 - Detection - Number of evaluation samples = 1500
2023-04-05 07:48:41,388 - Detection - Number of testing samples = 6000
2023-04-05 07:48:49,075 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-05 07:48:50,742 - Detection - Pre-training Begin...
2023-04-05 07:49:00,986 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 07:49:00,986 - Detection -   best_eval_score = 0
2023-04-05 07:49:00,986 - Detection -   eval_score = 16.2
2023-04-05 07:49:00,986 - Detection -   train_loss = 2.701969929144416
2023-04-05 07:49:10,974 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 07:49:10,974 - Detection -   best_eval_score = 16.2
2023-04-05 07:49:10,974 - Detection -   eval_score = 37.53
2023-04-05 07:49:10,974 - Detection -   train_loss = 2.64942595656489
2023-04-05 07:49:21,420 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 07:49:21,420 - Detection -   best_eval_score = 37.53
2023-04-05 07:49:21,420 - Detection -   eval_score = 52.33
2023-04-05 07:49:21,420 - Detection -   train_loss = 2.448285458793103
2023-04-05 07:49:31,891 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 07:49:31,891 - Detection -   best_eval_score = 52.33
2023-04-05 07:49:31,891 - Detection -   eval_score = 75.0
2023-04-05 07:49:31,891 - Detection -   train_loss = 1.8593987427966696
2023-04-05 07:49:42,371 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 07:49:42,371 - Detection -   best_eval_score = 75.0
2023-04-05 07:49:42,371 - Detection -   eval_score = 83.8
2023-04-05 07:49:42,371 - Detection -   train_loss = 1.110244635125281
2023-04-05 07:49:53,017 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 07:49:53,017 - Detection -   best_eval_score = 83.8
2023-04-05 07:49:53,017 - Detection -   eval_score = 86.07
2023-04-05 07:49:53,017 - Detection -   train_loss = 0.6785731995609444
2023-04-05 07:50:03,642 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 07:50:03,642 - Detection -   best_eval_score = 86.07
2023-04-05 07:50:03,642 - Detection -   eval_score = 86.33
2023-04-05 07:50:03,642 - Detection -   train_loss = 0.5421616409865904
2023-04-05 07:50:14,112 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 07:50:14,112 - Detection -   best_eval_score = 86.33
2023-04-05 07:50:14,112 - Detection -   eval_score = 86.73
2023-04-05 07:50:14,112 - Detection -   train_loss = 0.4791622212235357
2023-04-05 07:50:24,574 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 07:50:24,574 - Detection -   best_eval_score = 86.73
2023-04-05 07:50:24,574 - Detection -   eval_score = 87.93
2023-04-05 07:50:24,574 - Detection -   train_loss = 0.44067869345906757
2023-04-05 07:50:35,038 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 07:50:35,038 - Detection -   best_eval_score = 87.93
2023-04-05 07:50:35,039 - Detection -   eval_score = 88.27
2023-04-05 07:50:35,039 - Detection -   train_loss = 0.406982700589677
2023-04-05 07:50:45,504 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 07:50:45,504 - Detection -   best_eval_score = 88.27
2023-04-05 07:50:45,504 - Detection -   eval_score = 88.93
2023-04-05 07:50:45,504 - Detection -   train_loss = 0.3804894513647321
2023-04-05 07:50:55,958 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 07:50:55,958 - Detection -   best_eval_score = 88.93
2023-04-05 07:50:55,958 - Detection -   eval_score = 89.2
2023-04-05 07:50:55,958 - Detection -   train_loss = 0.3582204997959271
2023-04-05 07:51:06,453 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 07:51:06,453 - Detection -   best_eval_score = 89.2
2023-04-05 07:51:06,453 - Detection -   eval_score = 89.07
2023-04-05 07:51:06,453 - Detection -   train_loss = 0.3387959219620261
2023-04-05 07:51:16,903 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 07:51:16,903 - Detection -   best_eval_score = 89.2
2023-04-05 07:51:16,903 - Detection -   eval_score = 89.2
2023-04-05 07:51:16,903 - Detection -   train_loss = 0.3185719589532261
2023-04-05 07:51:27,332 - Detection - ***** Epoch: 15: Eval results *****
2023-04-05 07:51:27,332 - Detection -   best_eval_score = 89.2
2023-04-05 07:51:27,332 - Detection -   eval_score = 89.13
2023-04-05 07:51:27,332 - Detection -   train_loss = 0.301984562945198
2023-04-05 07:51:37,753 - Detection - ***** Epoch: 16: Eval results *****
2023-04-05 07:51:37,753 - Detection -   best_eval_score = 89.2
2023-04-05 07:51:37,753 - Detection -   eval_score = 89.33
2023-04-05 07:51:37,753 - Detection -   train_loss = 0.28788252552630195
2023-04-05 07:51:48,182 - Detection - ***** Epoch: 17: Eval results *****
2023-04-05 07:51:48,182 - Detection -   best_eval_score = 89.33
2023-04-05 07:51:48,182 - Detection -   eval_score = 89.47
2023-04-05 07:51:48,182 - Detection -   train_loss = 0.27220438788054696
2023-04-05 07:51:58,588 - Detection - ***** Epoch: 18: Eval results *****
2023-04-05 07:51:58,588 - Detection -   best_eval_score = 89.47
2023-04-05 07:51:58,588 - Detection -   eval_score = 89.2
2023-04-05 07:51:58,588 - Detection -   train_loss = 0.26466895199157825
2023-04-05 07:52:08,999 - Detection - ***** Epoch: 19: Eval results *****
2023-04-05 07:52:09,000 - Detection -   best_eval_score = 89.47
2023-04-05 07:52:09,000 - Detection -   eval_score = 89.4
2023-04-05 07:52:09,000 - Detection -   train_loss = 0.24721743754098113
2023-04-05 07:52:19,403 - Detection - ***** Epoch: 20: Eval results *****
2023-04-05 07:52:19,403 - Detection -   best_eval_score = 89.47
2023-04-05 07:52:19,403 - Detection -   eval_score = 90.13
2023-04-05 07:52:19,403 - Detection -   train_loss = 0.23510485048025426
2023-04-05 07:52:29,799 - Detection - ***** Epoch: 21: Eval results *****
2023-04-05 07:52:29,799 - Detection -   best_eval_score = 90.13
2023-04-05 07:52:29,799 - Detection -   eval_score = 89.53
2023-04-05 07:52:29,799 - Detection -   train_loss = 0.22639967081412463
2023-04-05 07:52:40,279 - Detection - ***** Epoch: 22: Eval results *****
2023-04-05 07:52:40,279 - Detection -   best_eval_score = 90.13
2023-04-05 07:52:40,279 - Detection -   eval_score = 89.67
2023-04-05 07:52:40,279 - Detection -   train_loss = 0.21816467546241383
2023-04-05 07:52:50,679 - Detection - ***** Epoch: 23: Eval results *****
2023-04-05 07:52:50,679 - Detection -   best_eval_score = 90.13
2023-04-05 07:52:50,679 - Detection -   eval_score = 90.07
2023-04-05 07:52:50,679 - Detection -   train_loss = 0.21290420572942412
2023-04-05 07:53:01,074 - Detection - ***** Epoch: 24: Eval results *****
2023-04-05 07:53:01,074 - Detection -   best_eval_score = 90.13
2023-04-05 07:53:01,074 - Detection -   eval_score = 90.0
2023-04-05 07:53:01,074 - Detection -   train_loss = 0.20323210157139202
2023-04-05 07:53:11,455 - Detection - ***** Epoch: 25: Eval results *****
2023-04-05 07:53:11,455 - Detection -   best_eval_score = 90.13
2023-04-05 07:53:11,455 - Detection -   eval_score = 90.07
2023-04-05 07:53:11,456 - Detection -   train_loss = 0.20045311528612192
2023-04-05 07:53:21,838 - Detection - ***** Epoch: 26: Eval results *****
2023-04-05 07:53:21,838 - Detection -   best_eval_score = 90.13
2023-04-05 07:53:21,838 - Detection -   eval_score = 89.67
2023-04-05 07:53:21,838 - Detection -   train_loss = 0.1870825599196931
2023-04-05 07:53:32,219 - Detection - ***** Epoch: 27: Eval results *****
2023-04-05 07:53:32,219 - Detection -   best_eval_score = 90.13
2023-04-05 07:53:32,219 - Detection -   eval_score = 89.87
2023-04-05 07:53:32,219 - Detection -   train_loss = 0.17575383291278088
2023-04-05 07:53:42,598 - Detection - ***** Epoch: 28: Eval results *****
2023-04-05 07:53:42,598 - Detection -   best_eval_score = 90.13
2023-04-05 07:53:42,599 - Detection -   eval_score = 89.8
2023-04-05 07:53:42,599 - Detection -   train_loss = 0.1710618076400018
2023-04-05 07:53:52,974 - Detection - ***** Epoch: 29: Eval results *****
2023-04-05 07:53:52,974 - Detection -   best_eval_score = 90.13
2023-04-05 07:53:52,974 - Detection -   eval_score = 89.8
2023-04-05 07:53:52,974 - Detection -   train_loss = 0.1648651552452168
2023-04-05 07:54:03,336 - Detection - ***** Epoch: 30: Eval results *****
2023-04-05 07:54:03,336 - Detection -   best_eval_score = 90.13
2023-04-05 07:54:03,336 - Detection -   eval_score = 90.0
2023-04-05 07:54:03,336 - Detection -   train_loss = 0.15654137898498857
2023-04-05 07:54:03,336 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_0.75_1.0_bert_3/models
2023-04-05 07:54:03,886 - Detection - Pre-training finished...
2023-04-05 07:54:03,886 - Detection - Training Begin...
2023-04-05 07:54:21,915 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 07:54:21,916 - Detection -   best_eval_score = 0
2023-04-05 07:54:21,916 - Detection -   eval_score = 4.96
2023-04-05 07:54:21,916 - Detection -   train_loss = 8.190119420978386
2023-04-05 07:54:32,185 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 07:54:32,185 - Detection -   best_eval_score = 4.96
2023-04-05 07:54:32,185 - Detection -   eval_score = 78.69
2023-04-05 07:54:32,185 - Detection -   train_loss = 4.593355413893579
2023-04-05 07:54:42,465 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 07:54:42,465 - Detection -   best_eval_score = 78.69
2023-04-05 07:54:42,465 - Detection -   eval_score = 82.74
2023-04-05 07:54:42,465 - Detection -   train_loss = 1.8982363872125114
2023-04-05 07:54:52,742 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 07:54:52,742 - Detection -   best_eval_score = 82.74
2023-04-05 07:54:52,742 - Detection -   eval_score = 82.76
2023-04-05 07:54:52,742 - Detection -   train_loss = 1.6626456489025707
2023-04-05 07:55:03,031 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 07:55:03,031 - Detection -   best_eval_score = 82.76
2023-04-05 07:55:03,031 - Detection -   eval_score = 82.83
2023-04-05 07:55:03,031 - Detection -   train_loss = 1.6749891815051225
2023-04-05 07:55:13,309 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 07:55:13,309 - Detection -   best_eval_score = 82.83
2023-04-05 07:55:13,310 - Detection -   eval_score = 82.79
2023-04-05 07:55:13,310 - Detection -   train_loss = 1.6692612456603788
2023-04-05 07:55:23,586 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 07:55:23,586 - Detection -   best_eval_score = 82.83
2023-04-05 07:55:23,587 - Detection -   eval_score = 82.79
2023-04-05 07:55:23,587 - Detection -   train_loss = 1.6604011277077904
2023-04-05 07:55:33,868 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 07:55:33,868 - Detection -   best_eval_score = 82.83
2023-04-05 07:55:33,868 - Detection -   eval_score = 82.83
2023-04-05 07:55:33,868 - Detection -   train_loss = 1.675291870681333
2023-04-05 07:55:44,142 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 07:55:44,143 - Detection -   best_eval_score = 82.83
2023-04-05 07:55:44,143 - Detection -   eval_score = 82.74
2023-04-05 07:55:44,143 - Detection -   train_loss = 1.6733895137276449
2023-04-05 07:55:54,421 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 07:55:54,421 - Detection -   best_eval_score = 82.83
2023-04-05 07:55:54,421 - Detection -   eval_score = 82.75
2023-04-05 07:55:54,421 - Detection -   train_loss = 1.6745605300849593
2023-04-05 07:56:04,710 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 07:56:04,710 - Detection -   best_eval_score = 82.83
2023-04-05 07:56:04,710 - Detection -   eval_score = 82.79
2023-04-05 07:56:04,710 - Detection -   train_loss = 1.680668980302945
2023-04-05 07:56:15,085 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 07:56:15,085 - Detection -   best_eval_score = 82.83
2023-04-05 07:56:15,085 - Detection -   eval_score = 82.79
2023-04-05 07:56:15,085 - Detection -   train_loss = 1.6742614155084314
2023-04-05 07:56:25,345 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 07:56:25,345 - Detection -   best_eval_score = 82.83
2023-04-05 07:56:25,346 - Detection -   eval_score = 82.74
2023-04-05 07:56:25,346 - Detection -   train_loss = 1.6907123864536555
2023-04-05 07:56:35,640 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 07:56:35,640 - Detection -   best_eval_score = 82.83
2023-04-05 07:56:35,640 - Detection -   eval_score = 82.83
2023-04-05 07:56:35,640 - Detection -   train_loss = 1.6864099233922825
2023-04-05 07:56:45,917 - Detection - ***** Epoch: 15: Eval results *****
2023-04-05 07:56:45,917 - Detection -   best_eval_score = 82.83
2023-04-05 07:56:45,917 - Detection -   eval_score = 82.67
2023-04-05 07:56:45,917 - Detection -   train_loss = 1.6719016575477492
2023-04-05 07:56:45,918 - Detection - Training Finished...
2023-04-05 07:56:45,918 - Detection - Testing begin...
2023-04-05 07:56:51,306 - Detection - ***** Test: Confusion Matrix *****
2023-04-05 07:56:51,307 - Detection - [[ 231    0    0    0    0    0    0    1    0    0    0    0    0    1
     0   67]
 [   0  218    0    0    0    0    0    0    0    5    0    0    0    0
     0   77]
 [   0    1  212    1    0    0    0    0    0    0    0    0    1    0
     0   85]
 [   0    0    1  249    0    0    0    0    0    0    0    0    0    1
     0   49]
 [   0    0    1    0  255    0    0    0    0    0    0    0    0    0
     0   44]
 [   0    0    0    0    0  231    0    7    0    0    0    0    0    0
     0   62]
 [   0    0    0    0    0    0  225    0    0    0    0    0    0    0
     0   75]
 [   0    0    0    0    0    4    0  252    0    0    0    3    0    0
     0   41]
 [   0    0    0    0    0    0    0    0  242    0    0    0    0    2
     0   56]
 [   0    0    1    1    0    0    0    0    0  226    0    0    0    0
     3   69]
 [   0    0    0    0    0    0    0    0    0    0  258    0    0    0
     0   42]
 [   0    0    0    0    0    0    0    0    0    0    0  244    0    0
     0   56]
 [   0    0    2    0    0    0    0    0    0    0    0    0  260    0
     0   38]
 [   0    0    1    0    0    0    0    0    1    1    0    0    0  221
     0   76]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
   275   25]
 [   1    0    9    0    0    0    3    1    2   80    0    9    2   10
     5 1378]]
2023-04-05 07:56:51,307 - Detection - ***** Test results *****
2023-04-05 07:56:51,307 - Detection -   Acc = 82.95
2023-04-05 07:56:51,307 - Detection -   F1 = 86.3072
2023-04-05 07:56:51,307 - Detection -   F1-known = 87.1484
2023-04-05 07:56:51,307 - Detection -   F1-open = 73.6898
2023-04-05 07:56:51,307 - Detection - Testing finished...
2023-04-05 07:56:51,307 - Detection - Results saved in results/results_ADB.csv
2023-04-05 07:56:51,327 - Detection - Open Intent Detection Finished...
