2023-04-20 14:36:05,869 - Detection - Open Intent Detection Begin...
2023-04-20 14:36:05,869 - Detection - Parameters Initialization...
2023-04-20 14:36:05,869 - Detection - ============================== Params ==============================
2023-04-20 14:36:05,869 - Detection - type:	open_intent_detection
2023-04-20 14:36:05,869 - Detection - logger_name:	Detection
2023-04-20 14:36:05,869 - Detection - log_dir:	logs
2023-04-20 14:36:05,869 - Detection - dataset:	banking_cg
2023-04-20 14:36:05,869 - Detection - known_cls_ratio:	0.5
2023-04-20 14:36:05,870 - Detection - labeled_ratio:	1.0
2023-04-20 14:36:05,870 - Detection - method:	ADB
2023-04-20 14:36:05,870 - Detection - train:	True
2023-04-20 14:36:05,870 - Detection - pretrain:	True
2023-04-20 14:36:05,870 - Detection - save_model:	True
2023-04-20 14:36:05,870 - Detection - backbone:	bert
2023-04-20 14:36:05,870 - Detection - config_file_name:	ADB
2023-04-20 14:36:05,870 - Detection - seed:	9
2023-04-20 14:36:05,870 - Detection - gpu_id:	0
2023-04-20 14:36:05,870 - Detection - pipe_results_path:	pipe_results
2023-04-20 14:36:05,870 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-20 14:36:05,870 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-20 14:36:05,870 - Detection - model_dir:	models
2023-04-20 14:36:05,870 - Detection - load_pretrained_method:	None
2023-04-20 14:36:05,870 - Detection - result_dir:	results
2023-04-20 14:36:05,870 - Detection - results_file_name:	results_ADB.csv
2023-04-20 14:36:05,870 - Detection - save_results:	True
2023-04-20 14:36:05,870 - Detection - loss_fct:	CrossEntropyLoss
2023-04-20 14:36:05,870 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.5_1.0_bert_9
2023-04-20 14:36:05,870 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.5_1.0_bert_9/models
2023-04-20 14:36:05,870 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-20 14:36:05,870 - Detection - num_train_epochs:	100
2023-04-20 14:36:05,870 - Detection - num_labels:	None
2023-04-20 14:36:05,870 - Detection - max_seq_length:	None
2023-04-20 14:36:05,870 - Detection - freeze_backbone_parameters:	True
2023-04-20 14:36:05,870 - Detection - feat_dim:	768
2023-04-20 14:36:05,870 - Detection - warmup_proportion:	0.1
2023-04-20 14:36:05,870 - Detection - lr_boundary:	0.05
2023-04-20 14:36:05,870 - Detection - lr:	2e-05
2023-04-20 14:36:05,870 - Detection - activation:	relu
2023-04-20 14:36:05,870 - Detection - train_batch_size:	128
2023-04-20 14:36:05,870 - Detection - eval_batch_size:	64
2023-04-20 14:36:05,870 - Detection - test_batch_size:	64
2023-04-20 14:36:05,870 - Detection - wait_patient:	10
2023-04-20 14:36:05,870 - Detection - ============================== End Params ==============================
2023-04-20 14:36:05,870 - Detection - Data and Model Preparation...
2023-04-20 14:36:05,871 - Detection - The number of known intents is 38
2023-04-20 14:36:05,871 - Detection - Lists of known labels are: ['card_payment_not_recognised', 'cash_withdrawal_charge', 'declined_transfer', 'exchange_via_app', 'cash_withdrawal_not_recognised', 'declined_card_payment', 'pending_transfer', 'country_support', 'verify_top_up', 'apple_pay_or_google_pay', 'reverted_card_payment?', 'top_up_reverted', 'passcode_forgotten', 'balance_not_updated_after_bank_transfer', 'card_linking', 'lost_or_stolen_phone', 'failed_transfer', 'card_not_working', 'top_up_by_card_charge', 'balance_not_updated_after_cheque_or_cash_deposit', 'compromised_card', 'exchange_charge', 'top_up_by_cash_or_cheque', 'order_physical_card', 'age_limit', 'terminate_account', 'pin_blocked', 'edit_personal_details', 'declined_cash_withdrawal', 'get_physical_card', 'beneficiary_not_allowed', 'disposable_card_limits', 'receiving_money', 'contactless_not_working', 'automatic_top_up', 'getting_virtual_card', 'pending_top_up', 'card_about_to_expire']
2023-04-20 14:36:05,882 - Detection - Number of labeled training samples = 1296
2023-04-20 14:36:05,882 - Detection - Number of unlabeled training samples = 1477
2023-04-20 14:36:05,884 - Detection - Number of evaluation samples = 407
2023-04-20 14:36:05,888 - Detection - Number of testing samples = 1896
2023-04-20 14:36:09,941 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-20 14:36:11,651 - Detection - Pre-training Begin...
2023-04-20 14:36:14,155 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 14:36:14,155 - Detection -   best_eval_score = 0
2023-04-20 14:36:14,155 - Detection -   eval_score = 2.21
2023-04-20 14:36:14,155 - Detection -   train_loss = 3.64158955487338
2023-04-20 14:36:16,124 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 14:36:16,124 - Detection -   best_eval_score = 2.21
2023-04-20 14:36:16,124 - Detection -   eval_score = 4.18
2023-04-20 14:36:16,124 - Detection -   train_loss = 3.6267800547859887
2023-04-20 14:36:18,097 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 14:36:18,098 - Detection -   best_eval_score = 4.18
2023-04-20 14:36:18,098 - Detection -   eval_score = 5.9
2023-04-20 14:36:18,098 - Detection -   train_loss = 3.5926384058865635
2023-04-20 14:36:20,073 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 14:36:20,073 - Detection -   best_eval_score = 5.9
2023-04-20 14:36:20,073 - Detection -   eval_score = 4.18
2023-04-20 14:36:20,073 - Detection -   train_loss = 3.5594944086941807
2023-04-20 14:36:22,035 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 14:36:22,035 - Detection -   best_eval_score = 5.9
2023-04-20 14:36:22,035 - Detection -   eval_score = 4.91
2023-04-20 14:36:22,035 - Detection -   train_loss = 3.4976951859214087
2023-04-20 14:36:24,028 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 14:36:24,028 - Detection -   best_eval_score = 5.9
2023-04-20 14:36:24,028 - Detection -   eval_score = 7.13
2023-04-20 14:36:24,028 - Detection -   train_loss = 3.4134754701094194
2023-04-20 14:36:26,070 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 14:36:26,070 - Detection -   best_eval_score = 7.13
2023-04-20 14:36:26,070 - Detection -   eval_score = 13.02
2023-04-20 14:36:26,070 - Detection -   train_loss = 3.2642300562425093
2023-04-20 14:36:28,073 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 14:36:28,073 - Detection -   best_eval_score = 13.02
2023-04-20 14:36:28,073 - Detection -   eval_score = 24.57
2023-04-20 14:36:28,074 - Detection -   train_loss = 3.0674037716605445
2023-04-20 14:36:30,119 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 14:36:30,119 - Detection -   best_eval_score = 24.57
2023-04-20 14:36:30,119 - Detection -   eval_score = 34.89
2023-04-20 14:36:30,119 - Detection -   train_loss = 2.739799131046642
2023-04-20 14:36:32,204 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 14:36:32,204 - Detection -   best_eval_score = 34.89
2023-04-20 14:36:32,204 - Detection -   eval_score = 42.75
2023-04-20 14:36:32,204 - Detection -   train_loss = 2.393976341594349
2023-04-20 14:36:34,332 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 14:36:34,332 - Detection -   best_eval_score = 42.75
2023-04-20 14:36:34,332 - Detection -   eval_score = 48.65
2023-04-20 14:36:34,332 - Detection -   train_loss = 2.0721042047847402
2023-04-20 14:36:36,456 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 14:36:36,457 - Detection -   best_eval_score = 48.65
2023-04-20 14:36:36,457 - Detection -   eval_score = 55.53
2023-04-20 14:36:36,457 - Detection -   train_loss = 1.7219842022115535
2023-04-20 14:36:38,545 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 14:36:38,545 - Detection -   best_eval_score = 55.53
2023-04-20 14:36:38,545 - Detection -   eval_score = 59.95
2023-04-20 14:36:38,545 - Detection -   train_loss = 1.5000266595320269
2023-04-20 14:36:40,710 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 14:36:40,710 - Detection -   best_eval_score = 59.95
2023-04-20 14:36:40,710 - Detection -   eval_score = 65.6
2023-04-20 14:36:40,710 - Detection -   train_loss = 1.3055144331671975
2023-04-20 14:36:42,872 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 14:36:42,872 - Detection -   best_eval_score = 65.6
2023-04-20 14:36:42,872 - Detection -   eval_score = 69.53
2023-04-20 14:36:42,872 - Detection -   train_loss = 1.1393292383714155
2023-04-20 14:36:45,070 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 14:36:45,070 - Detection -   best_eval_score = 69.53
2023-04-20 14:36:45,070 - Detection -   eval_score = 69.78
2023-04-20 14:36:45,071 - Detection -   train_loss = 1.0147085894237866
2023-04-20 14:36:47,163 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 14:36:47,163 - Detection -   best_eval_score = 69.78
2023-04-20 14:36:47,163 - Detection -   eval_score = 71.01
2023-04-20 14:36:47,163 - Detection -   train_loss = 0.8878718560392206
2023-04-20 14:36:49,308 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 14:36:49,308 - Detection -   best_eval_score = 71.01
2023-04-20 14:36:49,308 - Detection -   eval_score = 72.73
2023-04-20 14:36:49,308 - Detection -   train_loss = 0.8242443854158575
2023-04-20 14:36:51,408 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 14:36:51,409 - Detection -   best_eval_score = 72.73
2023-04-20 14:36:51,409 - Detection -   eval_score = 74.2
2023-04-20 14:36:51,409 - Detection -   train_loss = 0.7133738452737982
2023-04-20 14:36:53,565 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 14:36:53,566 - Detection -   best_eval_score = 74.2
2023-04-20 14:36:53,566 - Detection -   eval_score = 76.17
2023-04-20 14:36:53,566 - Detection -   train_loss = 0.6790254007686268
2023-04-20 14:36:55,664 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 14:36:55,664 - Detection -   best_eval_score = 76.17
2023-04-20 14:36:55,664 - Detection -   eval_score = 75.68
2023-04-20 14:36:55,665 - Detection -   train_loss = 0.6152708286588843
2023-04-20 14:36:57,772 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 14:36:57,772 - Detection -   best_eval_score = 76.17
2023-04-20 14:36:57,772 - Detection -   eval_score = 76.9
2023-04-20 14:36:57,772 - Detection -   train_loss = 0.5740297599272295
2023-04-20 14:36:59,883 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 14:36:59,883 - Detection -   best_eval_score = 76.9
2023-04-20 14:36:59,883 - Detection -   eval_score = 78.13
2023-04-20 14:36:59,883 - Detection -   train_loss = 0.5609274912964214
2023-04-20 14:37:02,014 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 14:37:02,014 - Detection -   best_eval_score = 78.13
2023-04-20 14:37:02,014 - Detection -   eval_score = 77.89
2023-04-20 14:37:02,014 - Detection -   train_loss = 0.49707710472020233
2023-04-20 14:37:04,118 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 14:37:04,118 - Detection -   best_eval_score = 78.13
2023-04-20 14:37:04,118 - Detection -   eval_score = 78.87
2023-04-20 14:37:04,118 - Detection -   train_loss = 0.4560429372570731
2023-04-20 14:37:06,282 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 14:37:06,282 - Detection -   best_eval_score = 78.87
2023-04-20 14:37:06,282 - Detection -   eval_score = 79.12
2023-04-20 14:37:06,282 - Detection -   train_loss = 0.4238290109417655
2023-04-20 14:37:08,456 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 14:37:08,456 - Detection -   best_eval_score = 79.12
2023-04-20 14:37:08,456 - Detection -   eval_score = 79.85
2023-04-20 14:37:08,456 - Detection -   train_loss = 0.40560247139497235
2023-04-20 14:37:10,584 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 14:37:10,584 - Detection -   best_eval_score = 79.85
2023-04-20 14:37:10,584 - Detection -   eval_score = 79.85
2023-04-20 14:37:10,584 - Detection -   train_loss = 0.3892126977443695
2023-04-20 14:37:12,731 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 14:37:12,731 - Detection -   best_eval_score = 79.85
2023-04-20 14:37:12,731 - Detection -   eval_score = 81.82
2023-04-20 14:37:12,731 - Detection -   train_loss = 0.375043738972057
2023-04-20 14:37:14,897 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 14:37:14,898 - Detection -   best_eval_score = 81.82
2023-04-20 14:37:14,898 - Detection -   eval_score = 80.84
2023-04-20 14:37:14,898 - Detection -   train_loss = 0.3454397212375294
2023-04-20 14:37:16,998 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 14:37:16,998 - Detection -   best_eval_score = 81.82
2023-04-20 14:37:16,998 - Detection -   eval_score = 80.59
2023-04-20 14:37:16,999 - Detection -   train_loss = 0.3314752985130657
2023-04-20 14:37:19,103 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 14:37:19,103 - Detection -   best_eval_score = 81.82
2023-04-20 14:37:19,103 - Detection -   eval_score = 80.34
2023-04-20 14:37:19,103 - Detection -   train_loss = 0.31336691162802954
2023-04-20 14:37:21,255 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 14:37:21,255 - Detection -   best_eval_score = 81.82
2023-04-20 14:37:21,255 - Detection -   eval_score = 81.08
2023-04-20 14:37:21,255 - Detection -   train_loss = 0.30271272361278534
2023-04-20 14:37:23,420 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 14:37:23,421 - Detection -   best_eval_score = 81.82
2023-04-20 14:37:23,421 - Detection -   eval_score = 81.57
2023-04-20 14:37:23,421 - Detection -   train_loss = 0.28590170632709155
2023-04-20 14:37:25,550 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 14:37:25,550 - Detection -   best_eval_score = 81.82
2023-04-20 14:37:25,550 - Detection -   eval_score = 81.82
2023-04-20 14:37:25,550 - Detection -   train_loss = 0.28075502948327496
2023-04-20 14:37:27,652 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 14:37:27,652 - Detection -   best_eval_score = 81.82
2023-04-20 14:37:27,652 - Detection -   eval_score = 81.57
2023-04-20 14:37:27,652 - Detection -   train_loss = 0.27245325121012604
2023-04-20 14:37:29,749 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 14:37:29,749 - Detection -   best_eval_score = 81.82
2023-04-20 14:37:29,749 - Detection -   eval_score = 82.06
2023-04-20 14:37:29,749 - Detection -   train_loss = 0.25565158372575586
2023-04-20 14:37:31,863 - Detection - ***** Epoch: 38: Eval results *****
2023-04-20 14:37:31,863 - Detection -   best_eval_score = 82.06
2023-04-20 14:37:31,863 - Detection -   eval_score = 82.56
2023-04-20 14:37:31,863 - Detection -   train_loss = 0.2457365556196733
2023-04-20 14:37:33,967 - Detection - ***** Epoch: 39: Eval results *****
2023-04-20 14:37:33,967 - Detection -   best_eval_score = 82.56
2023-04-20 14:37:33,967 - Detection -   eval_score = 82.06
2023-04-20 14:37:33,967 - Detection -   train_loss = 0.23399487137794495
2023-04-20 14:37:36,066 - Detection - ***** Epoch: 40: Eval results *****
2023-04-20 14:37:36,066 - Detection -   best_eval_score = 82.56
2023-04-20 14:37:36,066 - Detection -   eval_score = 81.82
2023-04-20 14:37:36,066 - Detection -   train_loss = 0.22285047038034958
2023-04-20 14:37:38,163 - Detection - ***** Epoch: 41: Eval results *****
2023-04-20 14:37:38,163 - Detection -   best_eval_score = 82.56
2023-04-20 14:37:38,163 - Detection -   eval_score = 81.82
2023-04-20 14:37:38,163 - Detection -   train_loss = 0.21447290886532178
2023-04-20 14:37:40,283 - Detection - ***** Epoch: 42: Eval results *****
2023-04-20 14:37:40,284 - Detection -   best_eval_score = 82.56
2023-04-20 14:37:40,284 - Detection -   eval_score = 81.82
2023-04-20 14:37:40,284 - Detection -   train_loss = 0.21167047863656824
2023-04-20 14:37:42,471 - Detection - ***** Epoch: 43: Eval results *****
2023-04-20 14:37:42,471 - Detection -   best_eval_score = 82.56
2023-04-20 14:37:42,471 - Detection -   eval_score = 82.56
2023-04-20 14:37:42,471 - Detection -   train_loss = 0.20406020364978097
2023-04-20 14:37:44,638 - Detection - ***** Epoch: 44: Eval results *****
2023-04-20 14:37:44,638 - Detection -   best_eval_score = 82.56
2023-04-20 14:37:44,639 - Detection -   eval_score = 83.05
2023-04-20 14:37:44,639 - Detection -   train_loss = 0.20429866286841306
2023-04-20 14:37:46,784 - Detection - ***** Epoch: 45: Eval results *****
2023-04-20 14:37:46,784 - Detection -   best_eval_score = 83.05
2023-04-20 14:37:46,807 - Detection -   eval_score = 82.56
2023-04-20 14:37:46,807 - Detection -   train_loss = 0.2120274224064567
2023-04-20 14:37:48,901 - Detection - ***** Epoch: 46: Eval results *****
2023-04-20 14:37:48,901 - Detection -   best_eval_score = 83.05
2023-04-20 14:37:48,901 - Detection -   eval_score = 82.06
2023-04-20 14:37:48,901 - Detection -   train_loss = 0.1891310919414867
2023-04-20 14:37:50,995 - Detection - ***** Epoch: 47: Eval results *****
2023-04-20 14:37:50,995 - Detection -   best_eval_score = 83.05
2023-04-20 14:37:50,995 - Detection -   eval_score = 82.8
2023-04-20 14:37:50,995 - Detection -   train_loss = 0.17619611187414688
2023-04-20 14:37:53,095 - Detection - ***** Epoch: 48: Eval results *****
2023-04-20 14:37:53,095 - Detection -   best_eval_score = 83.05
2023-04-20 14:37:53,095 - Detection -   eval_score = 83.29
2023-04-20 14:37:53,095 - Detection -   train_loss = 0.18025651574134827
2023-04-20 14:37:55,200 - Detection - ***** Epoch: 49: Eval results *****
2023-04-20 14:37:55,200 - Detection -   best_eval_score = 83.29
2023-04-20 14:37:55,200 - Detection -   eval_score = 83.54
2023-04-20 14:37:55,200 - Detection -   train_loss = 0.1692772297696634
2023-04-20 14:37:57,310 - Detection - ***** Epoch: 50: Eval results *****
2023-04-20 14:37:57,310 - Detection -   best_eval_score = 83.54
2023-04-20 14:37:57,310 - Detection -   eval_score = 82.56
2023-04-20 14:37:57,310 - Detection -   train_loss = 0.16086552359841086
2023-04-20 14:37:59,401 - Detection - ***** Epoch: 51: Eval results *****
2023-04-20 14:37:59,401 - Detection -   best_eval_score = 83.54
2023-04-20 14:37:59,401 - Detection -   eval_score = 82.8
2023-04-20 14:37:59,401 - Detection -   train_loss = 0.16491964053023944
2023-04-20 14:38:01,500 - Detection - ***** Epoch: 52: Eval results *****
2023-04-20 14:38:01,501 - Detection -   best_eval_score = 83.54
2023-04-20 14:38:01,501 - Detection -   eval_score = 83.54
2023-04-20 14:38:01,501 - Detection -   train_loss = 0.1588447703556581
2023-04-20 14:38:03,597 - Detection - ***** Epoch: 53: Eval results *****
2023-04-20 14:38:03,598 - Detection -   best_eval_score = 83.54
2023-04-20 14:38:03,598 - Detection -   eval_score = 83.78
2023-04-20 14:38:03,598 - Detection -   train_loss = 0.1518563303080472
2023-04-20 14:38:05,707 - Detection - ***** Epoch: 54: Eval results *****
2023-04-20 14:38:05,707 - Detection -   best_eval_score = 83.78
2023-04-20 14:38:05,707 - Detection -   eval_score = 83.29
2023-04-20 14:38:05,707 - Detection -   train_loss = 0.14834740351546893
2023-04-20 14:38:07,796 - Detection - ***** Epoch: 55: Eval results *****
2023-04-20 14:38:07,796 - Detection -   best_eval_score = 83.78
2023-04-20 14:38:07,796 - Detection -   eval_score = 83.29
2023-04-20 14:38:07,796 - Detection -   train_loss = 0.15376648577776822
2023-04-20 14:38:09,902 - Detection - ***** Epoch: 56: Eval results *****
2023-04-20 14:38:09,902 - Detection -   best_eval_score = 83.78
2023-04-20 14:38:09,902 - Detection -   eval_score = 83.78
2023-04-20 14:38:09,902 - Detection -   train_loss = 0.14733411303975366
2023-04-20 14:38:11,999 - Detection - ***** Epoch: 57: Eval results *****
2023-04-20 14:38:11,999 - Detection -   best_eval_score = 83.78
2023-04-20 14:38:11,999 - Detection -   eval_score = 83.78
2023-04-20 14:38:11,999 - Detection -   train_loss = 0.15006769380786203
2023-04-20 14:38:14,089 - Detection - ***** Epoch: 58: Eval results *****
2023-04-20 14:38:14,090 - Detection -   best_eval_score = 83.78
2023-04-20 14:38:14,090 - Detection -   eval_score = 83.54
2023-04-20 14:38:14,090 - Detection -   train_loss = 0.14434702355753293
2023-04-20 14:38:16,181 - Detection - ***** Epoch: 59: Eval results *****
2023-04-20 14:38:16,181 - Detection -   best_eval_score = 83.78
2023-04-20 14:38:16,181 - Detection -   eval_score = 83.29
2023-04-20 14:38:16,181 - Detection -   train_loss = 0.1329056518999013
2023-04-20 14:38:18,268 - Detection - ***** Epoch: 60: Eval results *****
2023-04-20 14:38:18,268 - Detection -   best_eval_score = 83.78
2023-04-20 14:38:18,268 - Detection -   eval_score = 83.54
2023-04-20 14:38:18,268 - Detection -   train_loss = 0.13347849182107233
2023-04-20 14:38:20,369 - Detection - ***** Epoch: 61: Eval results *****
2023-04-20 14:38:20,369 - Detection -   best_eval_score = 83.78
2023-04-20 14:38:20,369 - Detection -   eval_score = 83.78
2023-04-20 14:38:20,369 - Detection -   train_loss = 0.13075907799330624
2023-04-20 14:38:22,460 - Detection - ***** Epoch: 62: Eval results *****
2023-04-20 14:38:22,460 - Detection -   best_eval_score = 83.78
2023-04-20 14:38:22,460 - Detection -   eval_score = 83.78
2023-04-20 14:38:22,460 - Detection -   train_loss = 0.13096638159318405
2023-04-20 14:38:24,554 - Detection - ***** Epoch: 63: Eval results *****
2023-04-20 14:38:24,554 - Detection -   best_eval_score = 83.78
2023-04-20 14:38:24,554 - Detection -   eval_score = 83.78
2023-04-20 14:38:24,554 - Detection -   train_loss = 0.12427569045261903
2023-04-20 14:38:24,555 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.5_1.0_bert_9/models
2023-04-20 14:38:25,098 - Detection - Pre-training finished...
2023-04-20 14:38:25,098 - Detection - Training Begin...
2023-04-20 14:38:28,561 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 14:38:28,561 - Detection -   best_eval_score = 0
2023-04-20 14:38:28,561 - Detection -   eval_score = 0.0
2023-04-20 14:38:28,561 - Detection -   train_loss = 11.13003210587935
2023-04-20 14:38:30,642 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 14:38:30,642 - Detection -   best_eval_score = 0
2023-04-20 14:38:30,642 - Detection -   eval_score = 0.0
2023-04-20 14:38:30,642 - Detection -   train_loss = 10.850895361466842
2023-04-20 14:38:32,710 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 14:38:32,710 - Detection -   best_eval_score = 0
2023-04-20 14:38:32,710 - Detection -   eval_score = 0.0
2023-04-20 14:38:32,710 - Detection -   train_loss = 10.475030118768865
2023-04-20 14:38:34,785 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 14:38:34,786 - Detection -   best_eval_score = 0
2023-04-20 14:38:34,786 - Detection -   eval_score = 0.0
2023-04-20 14:38:34,786 - Detection -   train_loss = 10.158770561218262
2023-04-20 14:38:36,856 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 14:38:36,856 - Detection -   best_eval_score = 0
2023-04-20 14:38:36,856 - Detection -   eval_score = 0.0
2023-04-20 14:38:36,856 - Detection -   train_loss = 9.757366787303578
2023-04-20 14:38:38,922 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 14:38:38,922 - Detection -   best_eval_score = 0
2023-04-20 14:38:38,922 - Detection -   eval_score = 0.0
2023-04-20 14:38:38,922 - Detection -   train_loss = 9.216057604009455
2023-04-20 14:38:41,001 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 14:38:41,001 - Detection -   best_eval_score = 0
2023-04-20 14:38:41,001 - Detection -   eval_score = 0.0
2023-04-20 14:38:41,001 - Detection -   train_loss = 8.711738759821111
2023-04-20 14:38:43,075 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 14:38:43,075 - Detection -   best_eval_score = 0
2023-04-20 14:38:43,075 - Detection -   eval_score = 0.32
2023-04-20 14:38:43,075 - Detection -   train_loss = 8.211447542363947
2023-04-20 14:38:45,155 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 14:38:45,155 - Detection -   best_eval_score = 0.32
2023-04-20 14:38:45,156 - Detection -   eval_score = 1.71
2023-04-20 14:38:45,156 - Detection -   train_loss = 7.65613959052346
2023-04-20 14:38:47,325 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 14:38:47,325 - Detection -   best_eval_score = 1.71
2023-04-20 14:38:47,325 - Detection -   eval_score = 3.52
2023-04-20 14:38:47,325 - Detection -   train_loss = 7.031215320933949
2023-04-20 14:38:49,404 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 14:38:49,404 - Detection -   best_eval_score = 3.52
2023-04-20 14:38:49,404 - Detection -   eval_score = 6.91
2023-04-20 14:38:49,405 - Detection -   train_loss = 6.587627454237505
2023-04-20 14:38:51,476 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 14:38:51,476 - Detection -   best_eval_score = 6.91
2023-04-20 14:38:51,476 - Detection -   eval_score = 12.36
2023-04-20 14:38:51,476 - Detection -   train_loss = 5.975832895799116
2023-04-20 14:38:53,561 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 14:38:53,561 - Detection -   best_eval_score = 12.36
2023-04-20 14:38:53,561 - Detection -   eval_score = 16.33
2023-04-20 14:38:53,561 - Detection -   train_loss = 5.493748448111794
2023-04-20 14:38:55,639 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 14:38:55,640 - Detection -   best_eval_score = 16.33
2023-04-20 14:38:55,640 - Detection -   eval_score = 22.97
2023-04-20 14:38:55,640 - Detection -   train_loss = 4.889474782076749
2023-04-20 14:38:57,722 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 14:38:57,722 - Detection -   best_eval_score = 22.97
2023-04-20 14:38:57,722 - Detection -   eval_score = 31.07
2023-04-20 14:38:57,722 - Detection -   train_loss = 4.496250889518044
2023-04-20 14:38:59,795 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 14:38:59,795 - Detection -   best_eval_score = 31.07
2023-04-20 14:38:59,795 - Detection -   eval_score = 37.86
2023-04-20 14:38:59,795 - Detection -   train_loss = 3.9276828982613305
2023-04-20 14:39:01,874 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 14:39:01,874 - Detection -   best_eval_score = 37.86
2023-04-20 14:39:01,874 - Detection -   eval_score = 44.41
2023-04-20 14:39:01,874 - Detection -   train_loss = 3.4595684788443823
2023-04-20 14:39:03,951 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 14:39:03,951 - Detection -   best_eval_score = 44.41
2023-04-20 14:39:03,951 - Detection -   eval_score = 48.6
2023-04-20 14:39:03,951 - Detection -   train_loss = 3.030282410708341
2023-04-20 14:39:06,019 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 14:39:06,019 - Detection -   best_eval_score = 48.6
2023-04-20 14:39:06,019 - Detection -   eval_score = 56.59
2023-04-20 14:39:06,019 - Detection -   train_loss = 2.531070839275013
2023-04-20 14:39:08,097 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 14:39:08,097 - Detection -   best_eval_score = 56.59
2023-04-20 14:39:08,097 - Detection -   eval_score = 59.62
2023-04-20 14:39:08,097 - Detection -   train_loss = 2.1798925291408193
2023-04-20 14:39:10,169 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 14:39:10,169 - Detection -   best_eval_score = 59.62
2023-04-20 14:39:10,169 - Detection -   eval_score = 63.15
2023-04-20 14:39:10,169 - Detection -   train_loss = 1.854544227773493
2023-04-20 14:39:12,248 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 14:39:12,248 - Detection -   best_eval_score = 63.15
2023-04-20 14:39:12,248 - Detection -   eval_score = 65.47
2023-04-20 14:39:12,248 - Detection -   train_loss = 1.6653193343769421
2023-04-20 14:39:14,313 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 14:39:14,313 - Detection -   best_eval_score = 65.47
2023-04-20 14:39:14,313 - Detection -   eval_score = 68.38
2023-04-20 14:39:14,313 - Detection -   train_loss = 1.602730545130643
2023-04-20 14:39:16,391 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 14:39:16,391 - Detection -   best_eval_score = 68.38
2023-04-20 14:39:16,391 - Detection -   eval_score = 70.84
2023-04-20 14:39:16,391 - Detection -   train_loss = 1.4621816656806252
2023-04-20 14:39:18,464 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 14:39:18,464 - Detection -   best_eval_score = 70.84
2023-04-20 14:39:18,464 - Detection -   eval_score = 71.68
2023-04-20 14:39:18,464 - Detection -   train_loss = 1.3202237595211377
2023-04-20 14:39:20,526 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 14:39:20,526 - Detection -   best_eval_score = 71.68
2023-04-20 14:39:20,526 - Detection -   eval_score = 72.66
2023-04-20 14:39:20,526 - Detection -   train_loss = 1.3578307737003674
2023-04-20 14:39:22,603 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 14:39:22,603 - Detection -   best_eval_score = 72.66
2023-04-20 14:39:22,603 - Detection -   eval_score = 72.66
2023-04-20 14:39:22,603 - Detection -   train_loss = 1.296650919047269
2023-04-20 14:39:24,678 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 14:39:24,678 - Detection -   best_eval_score = 72.66
2023-04-20 14:39:24,678 - Detection -   eval_score = 73.4
2023-04-20 14:39:24,678 - Detection -   train_loss = 1.3172691735354336
2023-04-20 14:39:26,758 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 14:39:26,758 - Detection -   best_eval_score = 73.4
2023-04-20 14:39:26,758 - Detection -   eval_score = 73.46
2023-04-20 14:39:26,758 - Detection -   train_loss = 1.2895676656202837
2023-04-20 14:39:28,823 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 14:39:28,823 - Detection -   best_eval_score = 73.46
2023-04-20 14:39:28,823 - Detection -   eval_score = 73.29
2023-04-20 14:39:28,823 - Detection -   train_loss = 1.2722745917060159
2023-04-20 14:39:30,896 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 14:39:30,896 - Detection -   best_eval_score = 73.46
2023-04-20 14:39:30,896 - Detection -   eval_score = 73.95
2023-04-20 14:39:30,896 - Detection -   train_loss = 1.2918047363107854
2023-04-20 14:39:32,963 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 14:39:32,963 - Detection -   best_eval_score = 73.95
2023-04-20 14:39:32,963 - Detection -   eval_score = 73.95
2023-04-20 14:39:32,963 - Detection -   train_loss = 1.3097566041079434
2023-04-20 14:39:35,038 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 14:39:35,038 - Detection -   best_eval_score = 73.95
2023-04-20 14:39:35,038 - Detection -   eval_score = 74.08
2023-04-20 14:39:35,038 - Detection -   train_loss = 1.2609282732009888
2023-04-20 14:39:37,110 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 14:39:37,110 - Detection -   best_eval_score = 74.08
2023-04-20 14:39:37,110 - Detection -   eval_score = 74.14
2023-04-20 14:39:37,110 - Detection -   train_loss = 1.2810119932348079
2023-04-20 14:39:39,174 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 14:39:39,174 - Detection -   best_eval_score = 74.14
2023-04-20 14:39:39,174 - Detection -   eval_score = 74.35
2023-04-20 14:39:39,174 - Detection -   train_loss = 1.2524230155077847
2023-04-20 14:39:41,246 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 14:39:41,247 - Detection -   best_eval_score = 74.35
2023-04-20 14:39:41,247 - Detection -   eval_score = 74.29
2023-04-20 14:39:41,247 - Detection -   train_loss = 1.230070786042647
2023-04-20 14:39:43,315 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 14:39:43,315 - Detection -   best_eval_score = 74.35
2023-04-20 14:39:43,315 - Detection -   eval_score = 74.29
2023-04-20 14:39:43,315 - Detection -   train_loss = 1.2894928130236538
2023-04-20 14:39:45,383 - Detection - ***** Epoch: 38: Eval results *****
2023-04-20 14:39:45,383 - Detection -   best_eval_score = 74.35
2023-04-20 14:39:45,383 - Detection -   eval_score = 74.6
2023-04-20 14:39:45,383 - Detection -   train_loss = 1.3069818019866943
2023-04-20 14:39:47,460 - Detection - ***** Epoch: 39: Eval results *****
2023-04-20 14:39:47,460 - Detection -   best_eval_score = 74.6
2023-04-20 14:39:47,460 - Detection -   eval_score = 74.29
2023-04-20 14:39:47,460 - Detection -   train_loss = 1.2794823538173328
2023-04-20 14:39:49,527 - Detection - ***** Epoch: 40: Eval results *****
2023-04-20 14:39:49,527 - Detection -   best_eval_score = 74.6
2023-04-20 14:39:49,527 - Detection -   eval_score = 74.54
2023-04-20 14:39:49,528 - Detection -   train_loss = 1.2429668578234585
2023-04-20 14:39:51,599 - Detection - ***** Epoch: 41: Eval results *****
2023-04-20 14:39:51,599 - Detection -   best_eval_score = 74.6
2023-04-20 14:39:51,599 - Detection -   eval_score = 73.92
2023-04-20 14:39:51,599 - Detection -   train_loss = 1.2927650646729902
2023-04-20 14:39:53,666 - Detection - ***** Epoch: 42: Eval results *****
2023-04-20 14:39:53,666 - Detection -   best_eval_score = 74.6
2023-04-20 14:39:53,666 - Detection -   eval_score = 74.22
2023-04-20 14:39:53,666 - Detection -   train_loss = 1.2739714167334817
2023-04-20 14:39:55,734 - Detection - ***** Epoch: 43: Eval results *****
2023-04-20 14:39:55,734 - Detection -   best_eval_score = 74.6
2023-04-20 14:39:55,734 - Detection -   eval_score = 73.99
2023-04-20 14:39:55,734 - Detection -   train_loss = 1.312107042832808
2023-04-20 14:39:57,800 - Detection - ***** Epoch: 44: Eval results *****
2023-04-20 14:39:57,800 - Detection -   best_eval_score = 74.6
2023-04-20 14:39:57,800 - Detection -   eval_score = 73.99
2023-04-20 14:39:57,800 - Detection -   train_loss = 1.2434086474505337
2023-04-20 14:39:59,865 - Detection - ***** Epoch: 45: Eval results *****
2023-04-20 14:39:59,865 - Detection -   best_eval_score = 74.6
2023-04-20 14:39:59,865 - Detection -   eval_score = 74.07
2023-04-20 14:39:59,865 - Detection -   train_loss = 1.3344711607152766
2023-04-20 14:40:01,938 - Detection - ***** Epoch: 46: Eval results *****
2023-04-20 14:40:01,938 - Detection -   best_eval_score = 74.6
2023-04-20 14:40:01,938 - Detection -   eval_score = 74.02
2023-04-20 14:40:01,938 - Detection -   train_loss = 1.2554959383877842
2023-04-20 14:40:04,001 - Detection - ***** Epoch: 47: Eval results *****
2023-04-20 14:40:04,001 - Detection -   best_eval_score = 74.6
2023-04-20 14:40:04,001 - Detection -   eval_score = 73.94
2023-04-20 14:40:04,001 - Detection -   train_loss = 1.2593618631362915
2023-04-20 14:40:06,064 - Detection - ***** Epoch: 48: Eval results *****
2023-04-20 14:40:06,064 - Detection -   best_eval_score = 74.6
2023-04-20 14:40:06,064 - Detection -   eval_score = 73.46
2023-04-20 14:40:06,064 - Detection -   train_loss = 1.2510577331889758
2023-04-20 14:40:06,065 - Detection - Training Finished...
2023-04-20 14:40:06,065 - Detection - Testing begin...
2023-04-20 14:40:08,154 - Detection - ***** Test: Confusion Matrix *****
2023-04-20 14:40:08,154 - Detection - [[ 10   0   0 ...   0   0   7]
 [  0  33   0 ...   0   0   1]
 [  0   0  11 ...   0   0   6]
 ...
 [  0   0   0 ...  14   0   9]
 [  0   0   0 ...   0  24   7]
 [ 23  14   2 ...   2   0 618]]
2023-04-20 14:40:08,154 - Detection - ***** Test results *****
2023-04-20 14:40:08,154 - Detection -   Acc = 65.66
2023-04-20 14:40:08,154 - Detection -   F1 = 64.0939
2023-04-20 14:40:08,154 - Detection -   F1-known = 63.9836
2023-04-20 14:40:08,154 - Detection -   F1-open = 68.2873
2023-04-20 14:40:08,154 - Detection - Testing finished...
2023-04-20 14:40:08,154 - Detection - Results saved in results/results_ADB.csv
2023-04-20 14:40:08,174 - Detection - Open Intent Detection Finished...
