2023-04-20 23:44:04,372 - Detection - Open Intent Detection Begin...
2023-04-20 23:44:04,372 - Detection - Parameters Initialization...
2023-04-20 23:44:04,372 - Detection - ============================== Params ==============================
2023-04-20 23:44:04,372 - Detection - type:	open_intent_detection
2023-04-20 23:44:04,372 - Detection - logger_name:	Detection
2023-04-20 23:44:04,372 - Detection - log_dir:	logs
2023-04-20 23:44:04,372 - Detection - dataset:	banking_cg
2023-04-20 23:44:04,372 - Detection - known_cls_ratio:	0.25
2023-04-20 23:44:04,372 - Detection - labeled_ratio:	1.0
2023-04-20 23:44:04,372 - Detection - method:	DA-ADB
2023-04-20 23:44:04,372 - Detection - train:	True
2023-04-20 23:44:04,372 - Detection - pretrain:	True
2023-04-20 23:44:04,372 - Detection - save_model:	False
2023-04-20 23:44:04,372 - Detection - backbone:	bert_disaware_boost
2023-04-20 23:44:04,372 - Detection - config_file_name:	DA-ADB
2023-04-20 23:44:04,372 - Detection - seed:	1
2023-04-20 23:44:04,372 - Detection - gpu_id:	0
2023-04-20 23:44:04,372 - Detection - pipe_results_path:	pipe_results
2023-04-20 23:44:04,372 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-20 23:44:04,372 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-20 23:44:04,372 - Detection - model_dir:	models
2023-04-20 23:44:04,372 - Detection - load_pretrained_method:	None
2023-04-20 23:44:04,372 - Detection - result_dir:	results
2023-04-20 23:44:04,372 - Detection - results_file_name:	results_DA-ADB-BOOST.csv
2023-04-20 23:44:04,372 - Detection - save_results:	True
2023-04-20 23:44:04,372 - Detection - loss_fct:	CrossEntropyLoss
2023-04-20 23:44:04,372 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_cg_0.25_1.0_bert_disaware_boost_1
2023-04-20 23:44:04,372 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_cg_0.25_1.0_bert_disaware_boost_1/models
2023-04-20 23:44:04,372 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-20 23:44:04,372 - Detection - num_train_epochs:	100
2023-04-20 23:44:04,373 - Detection - num_labels:	None
2023-04-20 23:44:04,373 - Detection - max_seq_length:	None
2023-04-20 23:44:04,373 - Detection - freeze_backbone_parameters:	True
2023-04-20 23:44:04,373 - Detection - feat_dim:	768
2023-04-20 23:44:04,373 - Detection - warmup_proportion:	0.1
2023-04-20 23:44:04,373 - Detection - scale:	4
2023-04-20 23:44:04,373 - Detection - lr_boundary:	0.05
2023-04-20 23:44:04,373 - Detection - lr:	2e-05
2023-04-20 23:44:04,373 - Detection - activation:	relu
2023-04-20 23:44:04,373 - Detection - train_batch_size:	128
2023-04-20 23:44:04,373 - Detection - eval_batch_size:	64
2023-04-20 23:44:04,373 - Detection - test_batch_size:	64
2023-04-20 23:44:04,373 - Detection - wait_patient:	10
2023-04-20 23:44:04,373 - Detection - ============================== End Params ==============================
2023-04-20 23:44:04,373 - Detection - Data and Model Preparation...
2023-04-20 23:44:04,373 - Detection - The number of known intents is 19
2023-04-20 23:44:04,373 - Detection - Lists of known labels are: ['edit_personal_details', 'lost_or_stolen_phone', 'declined_card_payment', 'why_verify_identity', 'top_up_by_cash_or_cheque', 'top_up_failed', 'top_up_reverted', 'receiving_money', 'failed_transfer', 'top_up_by_card_charge', 'card_about_to_expire', 'reverted_card_payment?', 'exchange_via_app', 'age_limit', 'verify_top_up', 'declined_cash_withdrawal', 'pending_card_payment', 'card_not_working', 'passcode_forgotten']
2023-04-20 23:44:04,381 - Detection - Number of labeled training samples = 605
2023-04-20 23:44:04,381 - Detection - Number of unlabeled training samples = 2167
2023-04-20 23:44:04,383 - Detection - Number of evaluation samples = 203
2023-04-20 23:44:04,387 - Detection - Number of testing samples = 1896
2023-04-20 23:44:09,848 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-20 23:44:09,932 - Detection - Pre-training Begin...
2023-04-20 23:44:11,918 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 23:44:11,918 - Detection -   best_eval_score = 0
2023-04-20 23:44:11,918 - Detection -   eval_score = 0.36
2023-04-20 23:44:11,918 - Detection -   train_loss = 2.9619322299957274
2023-04-20 23:44:23,651 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 23:44:23,652 - Detection -   best_eval_score = 0.36
2023-04-20 23:44:23,652 - Detection -   eval_score = 2.66
2023-04-20 23:44:23,652 - Detection -   train_loss = 2.948860502243042
2023-04-20 23:44:35,182 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 23:44:35,182 - Detection -   best_eval_score = 2.66
2023-04-20 23:44:35,182 - Detection -   eval_score = 5.33
2023-04-20 23:44:35,182 - Detection -   train_loss = 2.835396337509155
2023-04-20 23:44:46,823 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 23:44:46,824 - Detection -   best_eval_score = 5.33
2023-04-20 23:44:46,824 - Detection -   eval_score = 8.9
2023-04-20 23:44:46,824 - Detection -   train_loss = 2.728124475479126
2023-04-20 23:44:58,524 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 23:44:58,524 - Detection -   best_eval_score = 8.9
2023-04-20 23:44:58,524 - Detection -   eval_score = 39.59
2023-04-20 23:44:58,524 - Detection -   train_loss = 2.500452184677124
2023-04-20 23:45:10,162 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 23:45:10,162 - Detection -   best_eval_score = 39.59
2023-04-20 23:45:10,163 - Detection -   eval_score = 66.23
2023-04-20 23:45:10,163 - Detection -   train_loss = 2.1879273891448974
2023-04-20 23:45:21,926 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 23:45:21,927 - Detection -   best_eval_score = 66.23
2023-04-20 23:45:21,927 - Detection -   eval_score = 69.67
2023-04-20 23:45:21,927 - Detection -   train_loss = 1.8038499116897584
2023-04-20 23:45:33,673 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 23:45:33,673 - Detection -   best_eval_score = 69.67
2023-04-20 23:45:33,673 - Detection -   eval_score = 74.09
2023-04-20 23:45:33,673 - Detection -   train_loss = 1.460708737373352
2023-04-20 23:45:45,383 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 23:45:45,383 - Detection -   best_eval_score = 74.09
2023-04-20 23:45:45,383 - Detection -   eval_score = 77.31
2023-04-20 23:45:45,383 - Detection -   train_loss = 1.1849972248077392
2023-04-20 23:45:56,972 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 23:45:56,972 - Detection -   best_eval_score = 77.31
2023-04-20 23:45:56,972 - Detection -   eval_score = 80.53
2023-04-20 23:45:56,972 - Detection -   train_loss = 0.9727477192878723
2023-04-20 23:46:08,781 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 23:46:08,781 - Detection -   best_eval_score = 80.53
2023-04-20 23:46:08,781 - Detection -   eval_score = 82.27
2023-04-20 23:46:08,781 - Detection -   train_loss = 0.8624686241149903
2023-04-20 23:46:20,374 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 23:46:20,374 - Detection -   best_eval_score = 82.27
2023-04-20 23:46:20,374 - Detection -   eval_score = 81.02
2023-04-20 23:46:20,374 - Detection -   train_loss = 0.7808346748352051
2023-04-20 23:46:31,963 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 23:46:31,963 - Detection -   best_eval_score = 82.27
2023-04-20 23:46:31,963 - Detection -   eval_score = 82.19
2023-04-20 23:46:31,963 - Detection -   train_loss = 0.7273912787437439
2023-04-20 23:46:43,694 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 23:46:43,694 - Detection -   best_eval_score = 82.27
2023-04-20 23:46:43,694 - Detection -   eval_score = 82.78
2023-04-20 23:46:43,694 - Detection -   train_loss = 0.6875061988830566
2023-04-20 23:46:55,256 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 23:46:55,256 - Detection -   best_eval_score = 82.78
2023-04-20 23:46:55,256 - Detection -   eval_score = 83.26
2023-04-20 23:46:55,256 - Detection -   train_loss = 0.6483573317527771
2023-04-20 23:47:07,001 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 23:47:07,001 - Detection -   best_eval_score = 83.26
2023-04-20 23:47:07,001 - Detection -   eval_score = 83.26
2023-04-20 23:47:07,001 - Detection -   train_loss = 0.6202240943908691
2023-04-20 23:47:18,611 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 23:47:18,612 - Detection -   best_eval_score = 83.26
2023-04-20 23:47:18,612 - Detection -   eval_score = 82.86
2023-04-20 23:47:18,612 - Detection -   train_loss = 0.5968946814537048
2023-04-20 23:47:30,347 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 23:47:30,347 - Detection -   best_eval_score = 83.26
2023-04-20 23:47:30,348 - Detection -   eval_score = 82.86
2023-04-20 23:47:30,348 - Detection -   train_loss = 0.5798713088035583
2023-04-20 23:47:41,922 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 23:47:41,922 - Detection -   best_eval_score = 83.26
2023-04-20 23:47:41,922 - Detection -   eval_score = 83.16
2023-04-20 23:47:41,922 - Detection -   train_loss = 0.5678444266319275
2023-04-20 23:47:53,658 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 23:47:53,658 - Detection -   best_eval_score = 83.26
2023-04-20 23:47:53,658 - Detection -   eval_score = 82.07
2023-04-20 23:47:53,658 - Detection -   train_loss = 0.5496491909027099
2023-04-20 23:48:05,242 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 23:48:05,242 - Detection -   best_eval_score = 83.26
2023-04-20 23:48:05,242 - Detection -   eval_score = 82.21
2023-04-20 23:48:05,242 - Detection -   train_loss = 0.5299100518226624
2023-04-20 23:48:16,998 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 23:48:16,998 - Detection -   best_eval_score = 83.26
2023-04-20 23:48:16,998 - Detection -   eval_score = 81.8
2023-04-20 23:48:16,998 - Detection -   train_loss = 0.5224185466766358
2023-04-20 23:48:28,602 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 23:48:28,602 - Detection -   best_eval_score = 83.26
2023-04-20 23:48:28,602 - Detection -   eval_score = 82.58
2023-04-20 23:48:28,602 - Detection -   train_loss = 0.5128208875656128
2023-04-20 23:48:40,268 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 23:48:40,268 - Detection -   best_eval_score = 83.26
2023-04-20 23:48:40,268 - Detection -   eval_score = 82.07
2023-04-20 23:48:40,268 - Detection -   train_loss = 0.5017695665359497
2023-04-20 23:48:51,961 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 23:48:51,961 - Detection -   best_eval_score = 83.26
2023-04-20 23:48:51,961 - Detection -   eval_score = 82.21
2023-04-20 23:48:51,961 - Detection -   train_loss = 0.49360677003860476
2023-04-20 23:48:51,962 - Detection - Pre-training finished...
2023-04-20 23:48:51,962 - Detection - Training Begin...
2023-04-20 23:48:52,854 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 23:48:52,854 - Detection -   best_eval_score = 0
2023-04-20 23:48:52,854 - Detection -   eval_score = 1.54
2023-04-20 23:48:52,854 - Detection -   train_loss = 3.119157409667969
2023-04-20 23:49:03,813 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 23:49:03,813 - Detection -   best_eval_score = 1.54
2023-04-20 23:49:03,813 - Detection -   eval_score = 39.18
2023-04-20 23:49:03,813 - Detection -   train_loss = 2.985464096069336
2023-04-20 23:49:14,859 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 23:49:14,859 - Detection -   best_eval_score = 39.18
2023-04-20 23:49:14,859 - Detection -   eval_score = 66.84
2023-04-20 23:49:14,859 - Detection -   train_loss = 1.0851304054260253
2023-04-20 23:49:25,764 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 23:49:25,765 - Detection -   best_eval_score = 66.84
2023-04-20 23:49:25,765 - Detection -   eval_score = 66.84
2023-04-20 23:49:25,765 - Detection -   train_loss = 0.4971279501914978
2023-04-20 23:49:36,834 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 23:49:36,834 - Detection -   best_eval_score = 66.84
2023-04-20 23:49:36,834 - Detection -   eval_score = 67.46
2023-04-20 23:49:36,834 - Detection -   train_loss = 0.47518110871315
2023-04-20 23:49:47,751 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 23:49:47,751 - Detection -   best_eval_score = 67.46
2023-04-20 23:49:47,751 - Detection -   eval_score = 67.22
2023-04-20 23:49:47,751 - Detection -   train_loss = 0.5066273033618927
2023-04-20 23:49:58,778 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 23:49:58,778 - Detection -   best_eval_score = 67.46
2023-04-20 23:49:58,778 - Detection -   eval_score = 67.46
2023-04-20 23:49:58,778 - Detection -   train_loss = 0.4987454116344452
2023-04-20 23:50:09,797 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 23:50:09,797 - Detection -   best_eval_score = 67.46
2023-04-20 23:50:09,797 - Detection -   eval_score = 67.22
2023-04-20 23:50:09,797 - Detection -   train_loss = 0.4793483972549438
2023-04-20 23:50:20,739 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 23:50:20,739 - Detection -   best_eval_score = 67.46
2023-04-20 23:50:20,739 - Detection -   eval_score = 66.93
2023-04-20 23:50:20,739 - Detection -   train_loss = 0.4695065915584564
2023-04-20 23:50:31,758 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 23:50:31,759 - Detection -   best_eval_score = 67.46
2023-04-20 23:50:31,759 - Detection -   eval_score = 67.46
2023-04-20 23:50:31,759 - Detection -   train_loss = 0.4931043326854706
2023-04-20 23:50:42,707 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 23:50:42,707 - Detection -   best_eval_score = 67.46
2023-04-20 23:50:42,707 - Detection -   eval_score = 67.46
2023-04-20 23:50:42,707 - Detection -   train_loss = 0.48954721689224245
2023-04-20 23:50:53,737 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 23:50:53,737 - Detection -   best_eval_score = 67.46
2023-04-20 23:50:53,737 - Detection -   eval_score = 66.93
2023-04-20 23:50:53,737 - Detection -   train_loss = 0.5055988192558288
2023-04-20 23:51:04,712 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 23:51:04,712 - Detection -   best_eval_score = 67.46
2023-04-20 23:51:04,712 - Detection -   eval_score = 67.22
2023-04-20 23:51:04,712 - Detection -   train_loss = 0.4859310209751129
2023-04-20 23:51:15,638 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 23:51:15,638 - Detection -   best_eval_score = 67.46
2023-04-20 23:51:15,638 - Detection -   eval_score = 67.22
2023-04-20 23:51:15,638 - Detection -   train_loss = 0.49729725122451784
2023-04-20 23:51:26,664 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 23:51:26,664 - Detection -   best_eval_score = 67.46
2023-04-20 23:51:26,664 - Detection -   eval_score = 67.46
2023-04-20 23:51:26,664 - Detection -   train_loss = 0.4901324510574341
2023-04-20 23:51:26,664 - Detection - Training Finished...
2023-04-20 23:51:26,664 - Detection - Testing begin...
2023-04-20 23:51:28,553 - Detection - ***** Test: Confusion Matrix *****
2023-04-20 23:51:28,554 - Detection - [[  26    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    1]
 [   0   15    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    9]
 [   0    0   10    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    1    0   21]
 [   0    0    0   21    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    1]
 [   0    0    0    0    8    0    0    0    0    0    0    0    0    0
     0    0    0    0    0   23]
 [   0    0    0    0    0    1    5    0    0    0    0    0    0    0
     0    0    0    0    0   24]
 [   0    0    0    0    0    1   19    0    0    0    0    0    0    0
     0    0    0    0    0    7]
 [   0    0    0    0    0    0    0    1    0    0    0    0    1    0
     0    0    0    0    0   24]
 [   0    0    0    0    0    0    0    0   22    0    0    0    0    0
     0    0    0    0    0    5]
 [   0    0    0    0    0    0    0    0    0    5    0    0    0    0
     0    0    0    0    0   14]
 [   0    0    0    0    0    0    0    0    0    0   29    0    0    0
     0    0    0    0    0    2]
 [   0    0    0    0    0    0    0    0    0    0    0   14    0    0
     0    0    0    0    0   21]
 [   0    0    0    0    0    0    0    0    0    0    0    0   19    0
     0    0    0    0    0    3]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0   19
     0    0    0    0    0    4]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
    26    0    0    0    0    3]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0   31    0    0    0    4]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0   19    0    0    7]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0   12    0    8]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0   15    1]
 [   0    5    3   37    3    1    6    0   36    2    3   35   72    0
     0   76   12   17    0 1086]]
2023-04-20 23:51:28,554 - Detection - ***** Test results *****
2023-04-20 23:51:28,554 - Detection -   Acc = 73.73
2023-04-20 23:51:28,554 - Detection -   F1 = 57.6072
2023-04-20 23:51:28,554 - Detection -   F1-known = 56.3448
2023-04-20 23:51:28,554 - Detection -   F1-open = 81.5928
2023-04-20 23:51:28,554 - Detection - Testing finished...
2023-04-20 23:51:28,554 - Detection - Results saved in results/results_DA-ADB-BOOST.csv
2023-04-20 23:51:28,574 - Detection - Open Intent Detection Finished...
