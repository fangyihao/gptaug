2023-04-20 18:27:44,081 - Detection - Open Intent Detection Begin...
2023-04-20 18:27:44,082 - Detection - Parameters Initialization...
2023-04-20 18:27:44,082 - Detection - ============================== Params ==============================
2023-04-20 18:27:44,082 - Detection - type:	open_intent_detection
2023-04-20 18:27:44,082 - Detection - logger_name:	Detection
2023-04-20 18:27:44,082 - Detection - log_dir:	logs
2023-04-20 18:27:44,082 - Detection - dataset:	oos_cg
2023-04-20 18:27:44,082 - Detection - known_cls_ratio:	0.5
2023-04-20 18:27:44,082 - Detection - labeled_ratio:	1.0
2023-04-20 18:27:44,082 - Detection - method:	ADB
2023-04-20 18:27:44,082 - Detection - train:	True
2023-04-20 18:27:44,082 - Detection - pretrain:	True
2023-04-20 18:27:44,082 - Detection - save_model:	True
2023-04-20 18:27:44,082 - Detection - backbone:	bert
2023-04-20 18:27:44,082 - Detection - config_file_name:	ADB
2023-04-20 18:27:44,082 - Detection - seed:	9
2023-04-20 18:27:44,082 - Detection - gpu_id:	0
2023-04-20 18:27:44,082 - Detection - pipe_results_path:	pipe_results
2023-04-20 18:27:44,082 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-20 18:27:44,082 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-20 18:27:44,082 - Detection - model_dir:	models
2023-04-20 18:27:44,082 - Detection - load_pretrained_method:	None
2023-04-20 18:27:44,082 - Detection - result_dir:	results
2023-04-20 18:27:44,082 - Detection - results_file_name:	results_ADB.csv
2023-04-20 18:27:44,082 - Detection - save_results:	True
2023-04-20 18:27:44,082 - Detection - loss_fct:	CrossEntropyLoss
2023-04-20 18:27:44,082 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_cg_0.5_1.0_bert_9
2023-04-20 18:27:44,082 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_cg_0.5_1.0_bert_9/models
2023-04-20 18:27:44,082 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-20 18:27:44,082 - Detection - num_train_epochs:	100
2023-04-20 18:27:44,082 - Detection - num_labels:	None
2023-04-20 18:27:44,082 - Detection - max_seq_length:	None
2023-04-20 18:27:44,082 - Detection - freeze_backbone_parameters:	True
2023-04-20 18:27:44,082 - Detection - feat_dim:	768
2023-04-20 18:27:44,082 - Detection - warmup_proportion:	0.1
2023-04-20 18:27:44,082 - Detection - lr_boundary:	0.05
2023-04-20 18:27:44,082 - Detection - lr:	2e-05
2023-04-20 18:27:44,082 - Detection - activation:	relu
2023-04-20 18:27:44,083 - Detection - train_batch_size:	128
2023-04-20 18:27:44,083 - Detection - eval_batch_size:	64
2023-04-20 18:27:44,083 - Detection - test_batch_size:	64
2023-04-20 18:27:44,083 - Detection - wait_patient:	10
2023-04-20 18:27:44,083 - Detection - ============================== End Params ==============================
2023-04-20 18:27:44,083 - Detection - Data and Model Preparation...
2023-04-20 18:27:44,083 - Detection - The number of known intents is 75
2023-04-20 18:27:44,083 - Detection - Lists of known labels are: ['uber', 'pto_request_status', 'where_are_you_from', 'who_do_you_work_for', 'international_fees', 'distance', 'confirm_reservation', 'application_status', 'next_song', 'book_flight', 'change_volume', 'new_card', 'report_fraud', 'reminder', 'exchange_rate', 'order_checks', 'current_location', 'ingredient_substitution', 'restaurant_reservation', 'gas', 'credit_limit', 'cook_time', 'shopping_list', 'change_accent', 'tell_joke', 'pto_request', 'flip_coin', 'what_song', 'bill_due', 'user_name', 'shopping_list_update', 'vaccines', 'change_speed', 'meal_suggestion', 'oil_change_when', 'order_status', 'no', 'freeze_account', 'schedule_meeting', 'bill_balance', 'car_rental', 'reset_settings', 'play_music', 'food_last', 'restaurant_suggestion', 'meaning_of_life', 'balance', 'measurement_conversion', 'direct_deposit', 'transfer', 'meeting_schedule', 'how_busy', 'book_hotel', 'improve_credit_score', 'travel_notification', 'update_playlist', 'share_location', 'weather', 'order', 'change_ai_name', 'travel_suggestion', 'do_you_have_pets', 'alarm', 'payday', 'sync_device', 'calculator', 'insurance', 'oil_change_how', 'timer', 'repeat', 'replacement_card_duration', 'directions', 'damaged_card', 'who_made_you', 'pto_balance']
2023-04-20 18:27:44,095 - Detection - Number of labeled training samples = 1757
2023-04-20 18:27:44,095 - Detection - Number of unlabeled training samples = 1926
2023-04-20 18:27:44,099 - Detection - Number of evaluation samples = 867
2023-04-20 18:27:44,107 - Detection - Number of testing samples = 3632
2023-04-20 18:27:48,094 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-20 18:27:49,778 - Detection - Pre-training Begin...
2023-04-20 18:27:51,966 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 18:27:51,966 - Detection -   best_eval_score = 0
2023-04-20 18:27:51,967 - Detection -   eval_score = 0.69
2023-04-20 18:27:51,967 - Detection -   train_loss = 4.318992614746094
2023-04-20 18:27:53,658 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 18:27:53,658 - Detection -   best_eval_score = 0.69
2023-04-20 18:27:53,658 - Detection -   eval_score = 0.69
2023-04-20 18:27:53,658 - Detection -   train_loss = 4.297440903527396
2023-04-20 18:27:55,338 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 18:27:55,338 - Detection -   best_eval_score = 0.69
2023-04-20 18:27:55,338 - Detection -   eval_score = 0.69
2023-04-20 18:27:55,338 - Detection -   train_loss = 4.258452142987933
2023-04-20 18:27:57,025 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 18:27:57,026 - Detection -   best_eval_score = 0.69
2023-04-20 18:27:57,026 - Detection -   eval_score = 1.15
2023-04-20 18:27:57,026 - Detection -   train_loss = 4.194768599101475
2023-04-20 18:27:58,722 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 18:27:58,722 - Detection -   best_eval_score = 1.15
2023-04-20 18:27:58,722 - Detection -   eval_score = 2.88
2023-04-20 18:27:58,722 - Detection -   train_loss = 4.0885410990033835
2023-04-20 18:28:00,432 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 18:28:00,432 - Detection -   best_eval_score = 2.88
2023-04-20 18:28:00,432 - Detection -   eval_score = 6.92
2023-04-20 18:28:00,432 - Detection -   train_loss = 3.8954889604023526
2023-04-20 18:28:02,281 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 18:28:02,281 - Detection -   best_eval_score = 6.92
2023-04-20 18:28:02,281 - Detection -   eval_score = 10.84
2023-04-20 18:28:02,281 - Detection -   train_loss = 3.5655882358551025
2023-04-20 18:28:04,001 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 18:28:04,001 - Detection -   best_eval_score = 10.84
2023-04-20 18:28:04,001 - Detection -   eval_score = 13.61
2023-04-20 18:28:04,001 - Detection -   train_loss = 3.1219662938799178
2023-04-20 18:28:05,716 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 18:28:05,716 - Detection -   best_eval_score = 13.61
2023-04-20 18:28:05,717 - Detection -   eval_score = 19.95
2023-04-20 18:28:05,717 - Detection -   train_loss = 2.6608015639441356
2023-04-20 18:28:07,446 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 18:28:07,446 - Detection -   best_eval_score = 19.95
2023-04-20 18:28:07,446 - Detection -   eval_score = 33.79
2023-04-20 18:28:07,446 - Detection -   train_loss = 2.223655240876334
2023-04-20 18:28:09,177 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 18:28:09,177 - Detection -   best_eval_score = 33.79
2023-04-20 18:28:09,177 - Detection -   eval_score = 42.45
2023-04-20 18:28:09,177 - Detection -   train_loss = 1.8218942625182015
2023-04-20 18:28:10,932 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 18:28:10,933 - Detection -   best_eval_score = 42.45
2023-04-20 18:28:10,933 - Detection -   eval_score = 50.63
2023-04-20 18:28:10,933 - Detection -   train_loss = 1.5149656193596976
2023-04-20 18:28:12,687 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 18:28:12,687 - Detection -   best_eval_score = 50.63
2023-04-20 18:28:12,687 - Detection -   eval_score = 55.02
2023-04-20 18:28:12,687 - Detection -   train_loss = 1.270538934639522
2023-04-20 18:28:14,451 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 18:28:14,451 - Detection -   best_eval_score = 55.02
2023-04-20 18:28:14,451 - Detection -   eval_score = 59.4
2023-04-20 18:28:14,451 - Detection -   train_loss = 1.064329547541482
2023-04-20 18:28:16,227 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 18:28:16,227 - Detection -   best_eval_score = 59.4
2023-04-20 18:28:16,227 - Detection -   eval_score = 62.4
2023-04-20 18:28:16,227 - Detection -   train_loss = 0.9040802419185638
2023-04-20 18:28:18,001 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 18:28:18,001 - Detection -   best_eval_score = 62.4
2023-04-20 18:28:18,001 - Detection -   eval_score = 63.44
2023-04-20 18:28:18,001 - Detection -   train_loss = 0.7787687608173915
2023-04-20 18:28:19,789 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 18:28:19,789 - Detection -   best_eval_score = 63.44
2023-04-20 18:28:19,789 - Detection -   eval_score = 66.21
2023-04-20 18:28:19,789 - Detection -   train_loss = 0.681899871144976
2023-04-20 18:28:21,585 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 18:28:21,585 - Detection -   best_eval_score = 66.21
2023-04-20 18:28:21,585 - Detection -   eval_score = 68.4
2023-04-20 18:28:21,585 - Detection -   train_loss = 0.6042637548276356
2023-04-20 18:28:23,388 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 18:28:23,388 - Detection -   best_eval_score = 68.4
2023-04-20 18:28:23,388 - Detection -   eval_score = 69.67
2023-04-20 18:28:23,388 - Detection -   train_loss = 0.5328084358147213
2023-04-20 18:28:25,194 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 18:28:25,194 - Detection -   best_eval_score = 69.67
2023-04-20 18:28:25,194 - Detection -   eval_score = 71.51
2023-04-20 18:28:25,194 - Detection -   train_loss = 0.4774286172219685
2023-04-20 18:28:26,996 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 18:28:26,996 - Detection -   best_eval_score = 71.51
2023-04-20 18:28:26,996 - Detection -   eval_score = 72.78
2023-04-20 18:28:26,996 - Detection -   train_loss = 0.43250895185129984
2023-04-20 18:28:28,807 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 18:28:28,807 - Detection -   best_eval_score = 72.78
2023-04-20 18:28:28,807 - Detection -   eval_score = 74.74
2023-04-20 18:28:28,807 - Detection -   train_loss = 0.3849345850093024
2023-04-20 18:28:30,622 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 18:28:30,622 - Detection -   best_eval_score = 74.74
2023-04-20 18:28:30,622 - Detection -   eval_score = 75.89
2023-04-20 18:28:30,622 - Detection -   train_loss = 0.3494694381952286
2023-04-20 18:28:32,431 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 18:28:32,431 - Detection -   best_eval_score = 75.89
2023-04-20 18:28:32,431 - Detection -   eval_score = 76.24
2023-04-20 18:28:32,431 - Detection -   train_loss = 0.31967870039599283
2023-04-20 18:28:34,242 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 18:28:34,242 - Detection -   best_eval_score = 76.24
2023-04-20 18:28:34,242 - Detection -   eval_score = 77.74
2023-04-20 18:28:34,242 - Detection -   train_loss = 0.29786913096904755
2023-04-20 18:28:36,049 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 18:28:36,049 - Detection -   best_eval_score = 77.74
2023-04-20 18:28:36,049 - Detection -   eval_score = 78.55
2023-04-20 18:28:36,049 - Detection -   train_loss = 0.2745959141424724
2023-04-20 18:28:37,867 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 18:28:37,867 - Detection -   best_eval_score = 78.55
2023-04-20 18:28:37,867 - Detection -   eval_score = 78.66
2023-04-20 18:28:37,867 - Detection -   train_loss = 0.25408247858285904
2023-04-20 18:28:39,686 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 18:28:39,686 - Detection -   best_eval_score = 78.66
2023-04-20 18:28:39,686 - Detection -   eval_score = 78.55
2023-04-20 18:28:39,686 - Detection -   train_loss = 0.2383065660084997
2023-04-20 18:28:41,491 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 18:28:41,491 - Detection -   best_eval_score = 78.66
2023-04-20 18:28:41,491 - Detection -   eval_score = 79.7
2023-04-20 18:28:41,491 - Detection -   train_loss = 0.22241532696144922
2023-04-20 18:28:43,371 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 18:28:43,371 - Detection -   best_eval_score = 79.7
2023-04-20 18:28:43,371 - Detection -   eval_score = 79.82
2023-04-20 18:28:43,371 - Detection -   train_loss = 0.2071337816970689
2023-04-20 18:28:45,337 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 18:28:45,337 - Detection -   best_eval_score = 79.82
2023-04-20 18:28:45,337 - Detection -   eval_score = 79.58
2023-04-20 18:28:45,337 - Detection -   train_loss = 0.19853266860757554
2023-04-20 18:28:47,152 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 18:28:47,152 - Detection -   best_eval_score = 79.82
2023-04-20 18:28:47,152 - Detection -   eval_score = 80.16
2023-04-20 18:28:47,152 - Detection -   train_loss = 0.17748225746410234
2023-04-20 18:28:48,961 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 18:28:48,961 - Detection -   best_eval_score = 80.16
2023-04-20 18:28:48,961 - Detection -   eval_score = 80.85
2023-04-20 18:28:48,961 - Detection -   train_loss = 0.17185574344226293
2023-04-20 18:28:50,768 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 18:28:50,768 - Detection -   best_eval_score = 80.85
2023-04-20 18:28:50,768 - Detection -   eval_score = 80.39
2023-04-20 18:28:50,768 - Detection -   train_loss = 0.16571883537939616
2023-04-20 18:28:52,563 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 18:28:52,563 - Detection -   best_eval_score = 80.85
2023-04-20 18:28:52,563 - Detection -   eval_score = 80.85
2023-04-20 18:28:52,563 - Detection -   train_loss = 0.15623509883880615
2023-04-20 18:28:54,358 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 18:28:54,358 - Detection -   best_eval_score = 80.85
2023-04-20 18:28:54,358 - Detection -   eval_score = 80.74
2023-04-20 18:28:54,358 - Detection -   train_loss = 0.1508210918733052
2023-04-20 18:28:56,155 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 18:28:56,156 - Detection -   best_eval_score = 80.85
2023-04-20 18:28:56,156 - Detection -   eval_score = 80.51
2023-04-20 18:28:56,156 - Detection -   train_loss = 0.1409062258899212
2023-04-20 18:28:57,953 - Detection - ***** Epoch: 38: Eval results *****
2023-04-20 18:28:57,953 - Detection -   best_eval_score = 80.85
2023-04-20 18:28:57,953 - Detection -   eval_score = 80.85
2023-04-20 18:28:57,953 - Detection -   train_loss = 0.13525509514978953
2023-04-20 18:28:59,751 - Detection - ***** Epoch: 39: Eval results *****
2023-04-20 18:28:59,751 - Detection -   best_eval_score = 80.85
2023-04-20 18:28:59,751 - Detection -   eval_score = 80.97
2023-04-20 18:28:59,751 - Detection -   train_loss = 0.13110942021012306
2023-04-20 18:29:01,558 - Detection - ***** Epoch: 40: Eval results *****
2023-04-20 18:29:01,558 - Detection -   best_eval_score = 80.97
2023-04-20 18:29:01,558 - Detection -   eval_score = 81.08
2023-04-20 18:29:01,558 - Detection -   train_loss = 0.12409340217709541
2023-04-20 18:29:03,362 - Detection - ***** Epoch: 41: Eval results *****
2023-04-20 18:29:03,362 - Detection -   best_eval_score = 81.08
2023-04-20 18:29:03,362 - Detection -   eval_score = 80.62
2023-04-20 18:29:03,362 - Detection -   train_loss = 0.11926025577953883
2023-04-20 18:29:05,155 - Detection - ***** Epoch: 42: Eval results *****
2023-04-20 18:29:05,155 - Detection -   best_eval_score = 81.08
2023-04-20 18:29:05,155 - Detection -   eval_score = 81.2
2023-04-20 18:29:05,155 - Detection -   train_loss = 0.1146104032439845
2023-04-20 18:29:07,008 - Detection - ***** Epoch: 43: Eval results *****
2023-04-20 18:29:07,008 - Detection -   best_eval_score = 81.2
2023-04-20 18:29:07,008 - Detection -   eval_score = 81.89
2023-04-20 18:29:07,008 - Detection -   train_loss = 0.11466092456664358
2023-04-20 18:29:08,847 - Detection - ***** Epoch: 44: Eval results *****
2023-04-20 18:29:08,847 - Detection -   best_eval_score = 81.89
2023-04-20 18:29:08,847 - Detection -   eval_score = 81.43
2023-04-20 18:29:08,847 - Detection -   train_loss = 0.10604842965091978
2023-04-20 18:29:10,646 - Detection - ***** Epoch: 45: Eval results *****
2023-04-20 18:29:10,646 - Detection -   best_eval_score = 81.89
2023-04-20 18:29:10,646 - Detection -   eval_score = 81.78
2023-04-20 18:29:10,646 - Detection -   train_loss = 0.10296440497040749
2023-04-20 18:29:12,496 - Detection - ***** Epoch: 46: Eval results *****
2023-04-20 18:29:12,496 - Detection -   best_eval_score = 81.89
2023-04-20 18:29:12,496 - Detection -   eval_score = 81.43
2023-04-20 18:29:12,496 - Detection -   train_loss = 0.0972392622913633
2023-04-20 18:29:14,286 - Detection - ***** Epoch: 47: Eval results *****
2023-04-20 18:29:14,286 - Detection -   best_eval_score = 81.89
2023-04-20 18:29:14,286 - Detection -   eval_score = 81.66
2023-04-20 18:29:14,286 - Detection -   train_loss = 0.09928728906171662
2023-04-20 18:29:16,068 - Detection - ***** Epoch: 48: Eval results *****
2023-04-20 18:29:16,068 - Detection -   best_eval_score = 81.89
2023-04-20 18:29:16,068 - Detection -   eval_score = 81.89
2023-04-20 18:29:16,068 - Detection -   train_loss = 0.09665202509079661
2023-04-20 18:29:17,855 - Detection - ***** Epoch: 49: Eval results *****
2023-04-20 18:29:17,855 - Detection -   best_eval_score = 81.89
2023-04-20 18:29:17,855 - Detection -   eval_score = 81.55
2023-04-20 18:29:17,855 - Detection -   train_loss = 0.09124535162534032
2023-04-20 18:29:19,645 - Detection - ***** Epoch: 50: Eval results *****
2023-04-20 18:29:19,645 - Detection -   best_eval_score = 81.89
2023-04-20 18:29:19,645 - Detection -   eval_score = 81.66
2023-04-20 18:29:19,645 - Detection -   train_loss = 0.08941603345530373
2023-04-20 18:29:21,432 - Detection - ***** Epoch: 51: Eval results *****
2023-04-20 18:29:21,432 - Detection -   best_eval_score = 81.89
2023-04-20 18:29:21,432 - Detection -   eval_score = 81.66
2023-04-20 18:29:21,432 - Detection -   train_loss = 0.08551715261169843
2023-04-20 18:29:23,221 - Detection - ***** Epoch: 52: Eval results *****
2023-04-20 18:29:23,221 - Detection -   best_eval_score = 81.89
2023-04-20 18:29:23,221 - Detection -   eval_score = 82.01
2023-04-20 18:29:23,221 - Detection -   train_loss = 0.08448810396449906
2023-04-20 18:29:25,013 - Detection - ***** Epoch: 53: Eval results *****
2023-04-20 18:29:25,014 - Detection -   best_eval_score = 82.01
2023-04-20 18:29:25,014 - Detection -   eval_score = 81.89
2023-04-20 18:29:25,014 - Detection -   train_loss = 0.0816668099058526
2023-04-20 18:29:26,819 - Detection - ***** Epoch: 54: Eval results *****
2023-04-20 18:29:26,819 - Detection -   best_eval_score = 82.01
2023-04-20 18:29:26,819 - Detection -   eval_score = 82.01
2023-04-20 18:29:26,819 - Detection -   train_loss = 0.07744465848164898
2023-04-20 18:29:28,642 - Detection - ***** Epoch: 55: Eval results *****
2023-04-20 18:29:28,643 - Detection -   best_eval_score = 82.01
2023-04-20 18:29:28,643 - Detection -   eval_score = 81.89
2023-04-20 18:29:28,643 - Detection -   train_loss = 0.07664472689586026
2023-04-20 18:29:30,450 - Detection - ***** Epoch: 56: Eval results *****
2023-04-20 18:29:30,450 - Detection -   best_eval_score = 82.01
2023-04-20 18:29:30,450 - Detection -   eval_score = 81.66
2023-04-20 18:29:30,450 - Detection -   train_loss = 0.07888283208012581
2023-04-20 18:29:32,240 - Detection - ***** Epoch: 57: Eval results *****
2023-04-20 18:29:32,240 - Detection -   best_eval_score = 82.01
2023-04-20 18:29:32,240 - Detection -   eval_score = 82.01
2023-04-20 18:29:32,240 - Detection -   train_loss = 0.07572371592479092
2023-04-20 18:29:34,075 - Detection - ***** Epoch: 58: Eval results *****
2023-04-20 18:29:34,076 - Detection -   best_eval_score = 82.01
2023-04-20 18:29:34,076 - Detection -   eval_score = 82.01
2023-04-20 18:29:34,076 - Detection -   train_loss = 0.07327930576034955
2023-04-20 18:29:35,877 - Detection - ***** Epoch: 59: Eval results *****
2023-04-20 18:29:35,877 - Detection -   best_eval_score = 82.01
2023-04-20 18:29:35,877 - Detection -   eval_score = 82.01
2023-04-20 18:29:35,877 - Detection -   train_loss = 0.07292523341519493
2023-04-20 18:29:37,732 - Detection - ***** Epoch: 60: Eval results *****
2023-04-20 18:29:37,732 - Detection -   best_eval_score = 82.01
2023-04-20 18:29:37,732 - Detection -   eval_score = 82.24
2023-04-20 18:29:37,732 - Detection -   train_loss = 0.06698421548519816
2023-04-20 18:29:39,553 - Detection - ***** Epoch: 61: Eval results *****
2023-04-20 18:29:39,553 - Detection -   best_eval_score = 82.24
2023-04-20 18:29:39,553 - Detection -   eval_score = 82.35
2023-04-20 18:29:39,553 - Detection -   train_loss = 0.0699934291520289
2023-04-20 18:29:41,357 - Detection - ***** Epoch: 62: Eval results *****
2023-04-20 18:29:41,357 - Detection -   best_eval_score = 82.35
2023-04-20 18:29:41,357 - Detection -   eval_score = 82.01
2023-04-20 18:29:41,357 - Detection -   train_loss = 0.06643754802644253
2023-04-20 18:29:43,151 - Detection - ***** Epoch: 63: Eval results *****
2023-04-20 18:29:43,152 - Detection -   best_eval_score = 82.35
2023-04-20 18:29:43,152 - Detection -   eval_score = 81.89
2023-04-20 18:29:43,152 - Detection -   train_loss = 0.06639759242534637
2023-04-20 18:29:44,975 - Detection - ***** Epoch: 64: Eval results *****
2023-04-20 18:29:44,976 - Detection -   best_eval_score = 82.35
2023-04-20 18:29:44,976 - Detection -   eval_score = 81.89
2023-04-20 18:29:44,976 - Detection -   train_loss = 0.06413985363074712
2023-04-20 18:29:46,752 - Detection - ***** Epoch: 65: Eval results *****
2023-04-20 18:29:46,752 - Detection -   best_eval_score = 82.35
2023-04-20 18:29:46,752 - Detection -   eval_score = 81.89
2023-04-20 18:29:46,752 - Detection -   train_loss = 0.06388301189456667
2023-04-20 18:29:48,528 - Detection - ***** Epoch: 66: Eval results *****
2023-04-20 18:29:48,528 - Detection -   best_eval_score = 82.35
2023-04-20 18:29:48,528 - Detection -   eval_score = 81.89
2023-04-20 18:29:48,528 - Detection -   train_loss = 0.06538296863436699
2023-04-20 18:29:50,318 - Detection - ***** Epoch: 67: Eval results *****
2023-04-20 18:29:50,318 - Detection -   best_eval_score = 82.35
2023-04-20 18:29:50,318 - Detection -   eval_score = 81.89
2023-04-20 18:29:50,318 - Detection -   train_loss = 0.06193068038140025
2023-04-20 18:29:52,154 - Detection - ***** Epoch: 68: Eval results *****
2023-04-20 18:29:52,154 - Detection -   best_eval_score = 82.35
2023-04-20 18:29:52,154 - Detection -   eval_score = 82.12
2023-04-20 18:29:52,154 - Detection -   train_loss = 0.06054484312023435
2023-04-20 18:29:53,935 - Detection - ***** Epoch: 69: Eval results *****
2023-04-20 18:29:53,935 - Detection -   best_eval_score = 82.35
2023-04-20 18:29:53,935 - Detection -   eval_score = 82.12
2023-04-20 18:29:53,935 - Detection -   train_loss = 0.06159654472555433
2023-04-20 18:29:55,721 - Detection - ***** Epoch: 70: Eval results *****
2023-04-20 18:29:55,722 - Detection -   best_eval_score = 82.35
2023-04-20 18:29:55,722 - Detection -   eval_score = 82.12
2023-04-20 18:29:55,722 - Detection -   train_loss = 0.0587053940232311
2023-04-20 18:29:57,528 - Detection - ***** Epoch: 71: Eval results *****
2023-04-20 18:29:57,529 - Detection -   best_eval_score = 82.35
2023-04-20 18:29:57,529 - Detection -   eval_score = 82.35
2023-04-20 18:29:57,529 - Detection -   train_loss = 0.0601166265883616
2023-04-20 18:29:57,529 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_cg_0.5_1.0_bert_9/models
2023-04-20 18:29:58,066 - Detection - Pre-training finished...
2023-04-20 18:29:58,066 - Detection - Training Begin...
2023-04-20 18:30:00,911 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 18:30:00,911 - Detection -   best_eval_score = 0
2023-04-20 18:30:00,911 - Detection -   eval_score = 0.0
2023-04-20 18:30:00,911 - Detection -   train_loss = 11.86322900227138
2023-04-20 18:30:02,697 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 18:30:02,697 - Detection -   best_eval_score = 0
2023-04-20 18:30:02,697 - Detection -   eval_score = 0.0
2023-04-20 18:30:02,697 - Detection -   train_loss = 11.496360438210624
2023-04-20 18:30:04,464 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 18:30:04,464 - Detection -   best_eval_score = 0
2023-04-20 18:30:04,464 - Detection -   eval_score = 0.0
2023-04-20 18:30:04,465 - Detection -   train_loss = 11.089229583740234
2023-04-20 18:30:06,262 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 18:30:06,262 - Detection -   best_eval_score = 0
2023-04-20 18:30:06,262 - Detection -   eval_score = 0.0
2023-04-20 18:30:06,262 - Detection -   train_loss = 10.539500713348389
2023-04-20 18:30:08,019 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 18:30:08,019 - Detection -   best_eval_score = 0
2023-04-20 18:30:08,020 - Detection -   eval_score = 0.0
2023-04-20 18:30:08,020 - Detection -   train_loss = 9.954933166503906
2023-04-20 18:30:09,773 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 18:30:09,774 - Detection -   best_eval_score = 0
2023-04-20 18:30:09,774 - Detection -   eval_score = 0.0
2023-04-20 18:30:09,774 - Detection -   train_loss = 9.300250053405762
2023-04-20 18:30:11,533 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 18:30:11,533 - Detection -   best_eval_score = 0
2023-04-20 18:30:11,533 - Detection -   eval_score = 0.0
2023-04-20 18:30:11,533 - Detection -   train_loss = 8.68984842300415
2023-04-20 18:30:13,287 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 18:30:13,288 - Detection -   best_eval_score = 0
2023-04-20 18:30:13,288 - Detection -   eval_score = 0.37
2023-04-20 18:30:13,288 - Detection -   train_loss = 8.044401441301618
2023-04-20 18:30:15,049 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 18:30:15,049 - Detection -   best_eval_score = 0.37
2023-04-20 18:30:15,049 - Detection -   eval_score = 0.86
2023-04-20 18:30:15,049 - Detection -   train_loss = 7.3623701844896585
2023-04-20 18:30:16,804 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 18:30:16,804 - Detection -   best_eval_score = 0.86
2023-04-20 18:30:16,804 - Detection -   eval_score = 2.51
2023-04-20 18:30:16,804 - Detection -   train_loss = 6.719526767730713
2023-04-20 18:30:18,569 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 18:30:18,570 - Detection -   best_eval_score = 2.51
2023-04-20 18:30:18,570 - Detection -   eval_score = 5.85
2023-04-20 18:30:18,570 - Detection -   train_loss = 6.079554080963135
2023-04-20 18:30:20,342 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 18:30:20,343 - Detection -   best_eval_score = 5.85
2023-04-20 18:30:20,343 - Detection -   eval_score = 9.56
2023-04-20 18:30:20,343 - Detection -   train_loss = 5.4336921487535745
2023-04-20 18:30:22,089 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 18:30:22,089 - Detection -   best_eval_score = 9.56
2023-04-20 18:30:22,089 - Detection -   eval_score = 14.62
2023-04-20 18:30:22,089 - Detection -   train_loss = 4.837392296109881
2023-04-20 18:30:23,842 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 18:30:23,842 - Detection -   best_eval_score = 14.62
2023-04-20 18:30:23,842 - Detection -   eval_score = 19.61
2023-04-20 18:30:23,842 - Detection -   train_loss = 4.212686589785984
2023-04-20 18:30:25,589 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 18:30:25,589 - Detection -   best_eval_score = 19.61
2023-04-20 18:30:25,590 - Detection -   eval_score = 24.99
2023-04-20 18:30:25,590 - Detection -   train_loss = 3.6155465841293335
2023-04-20 18:30:27,348 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 18:30:27,348 - Detection -   best_eval_score = 24.99
2023-04-20 18:30:27,348 - Detection -   eval_score = 29.51
2023-04-20 18:30:27,348 - Detection -   train_loss = 2.992421882493155
2023-04-20 18:30:29,125 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 18:30:29,125 - Detection -   best_eval_score = 29.51
2023-04-20 18:30:29,125 - Detection -   eval_score = 36.47
2023-04-20 18:30:29,125 - Detection -   train_loss = 2.506240827696664
2023-04-20 18:30:30,877 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 18:30:30,877 - Detection -   best_eval_score = 36.47
2023-04-20 18:30:30,877 - Detection -   eval_score = 42.37
2023-04-20 18:30:30,877 - Detection -   train_loss = 2.097867182322911
2023-04-20 18:30:32,625 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 18:30:32,626 - Detection -   best_eval_score = 42.37
2023-04-20 18:30:32,626 - Detection -   eval_score = 46.63
2023-04-20 18:30:32,626 - Detection -   train_loss = 1.7368525607245309
2023-04-20 18:30:34,370 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 18:30:34,370 - Detection -   best_eval_score = 46.63
2023-04-20 18:30:34,370 - Detection -   eval_score = 49.49
2023-04-20 18:30:34,370 - Detection -   train_loss = 1.5676392231668745
2023-04-20 18:30:36,116 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 18:30:36,116 - Detection -   best_eval_score = 49.49
2023-04-20 18:30:36,116 - Detection -   eval_score = 52.51
2023-04-20 18:30:36,116 - Detection -   train_loss = 1.3671979819025313
2023-04-20 18:30:37,864 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 18:30:37,864 - Detection -   best_eval_score = 52.51
2023-04-20 18:30:37,864 - Detection -   eval_score = 55.71
2023-04-20 18:30:37,864 - Detection -   train_loss = 1.2633975659097945
2023-04-20 18:30:39,609 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 18:30:39,609 - Detection -   best_eval_score = 55.71
2023-04-20 18:30:39,609 - Detection -   eval_score = 57.37
2023-04-20 18:30:39,609 - Detection -   train_loss = 1.2241961700575692
2023-04-20 18:30:41,360 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 18:30:41,360 - Detection -   best_eval_score = 57.37
2023-04-20 18:30:41,360 - Detection -   eval_score = 58.46
2023-04-20 18:30:41,360 - Detection -   train_loss = 1.2071641896452223
2023-04-20 18:30:43,115 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 18:30:43,116 - Detection -   best_eval_score = 58.46
2023-04-20 18:30:43,116 - Detection -   eval_score = 59.35
2023-04-20 18:30:43,116 - Detection -   train_loss = 1.2047771045139857
2023-04-20 18:30:44,859 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 18:30:44,860 - Detection -   best_eval_score = 59.35
2023-04-20 18:30:44,860 - Detection -   eval_score = 59.76
2023-04-20 18:30:44,860 - Detection -   train_loss = 1.1773010662623815
2023-04-20 18:30:46,636 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 18:30:46,636 - Detection -   best_eval_score = 59.76
2023-04-20 18:30:46,636 - Detection -   eval_score = 60.06
2023-04-20 18:30:46,636 - Detection -   train_loss = 1.179308099406106
2023-04-20 18:30:48,403 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 18:30:48,403 - Detection -   best_eval_score = 60.06
2023-04-20 18:30:48,403 - Detection -   eval_score = 60.55
2023-04-20 18:30:48,403 - Detection -   train_loss = 1.1046530561787742
2023-04-20 18:30:50,179 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 18:30:50,179 - Detection -   best_eval_score = 60.55
2023-04-20 18:30:50,179 - Detection -   eval_score = 60.8
2023-04-20 18:30:50,179 - Detection -   train_loss = 1.151883338178907
2023-04-20 18:30:51,924 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 18:30:51,924 - Detection -   best_eval_score = 60.8
2023-04-20 18:30:51,924 - Detection -   eval_score = 60.87
2023-04-20 18:30:51,924 - Detection -   train_loss = 1.1752071934086936
2023-04-20 18:30:53,669 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 18:30:53,669 - Detection -   best_eval_score = 60.87
2023-04-20 18:30:53,669 - Detection -   eval_score = 61.28
2023-04-20 18:30:53,669 - Detection -   train_loss = 1.1272239003862654
2023-04-20 18:30:55,486 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 18:30:55,486 - Detection -   best_eval_score = 61.28
2023-04-20 18:30:55,486 - Detection -   eval_score = 60.96
2023-04-20 18:30:55,486 - Detection -   train_loss = 1.1187536333288466
2023-04-20 18:30:57,363 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 18:30:57,363 - Detection -   best_eval_score = 61.28
2023-04-20 18:30:57,363 - Detection -   eval_score = 60.97
2023-04-20 18:30:57,364 - Detection -   train_loss = 1.1700961802686964
2023-04-20 18:30:59,136 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 18:30:59,136 - Detection -   best_eval_score = 61.28
2023-04-20 18:30:59,136 - Detection -   eval_score = 60.7
2023-04-20 18:30:59,136 - Detection -   train_loss = 1.1229923367500305
2023-04-20 18:31:00,890 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 18:31:00,891 - Detection -   best_eval_score = 61.28
2023-04-20 18:31:00,891 - Detection -   eval_score = 60.65
2023-04-20 18:31:00,891 - Detection -   train_loss = 1.146226934024266
2023-04-20 18:31:02,637 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 18:31:02,637 - Detection -   best_eval_score = 61.28
2023-04-20 18:31:02,638 - Detection -   eval_score = 60.87
2023-04-20 18:31:02,638 - Detection -   train_loss = 1.1321445490632738
2023-04-20 18:31:04,382 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 18:31:04,382 - Detection -   best_eval_score = 61.28
2023-04-20 18:31:04,382 - Detection -   eval_score = 60.54
2023-04-20 18:31:04,382 - Detection -   train_loss = 1.1357865674155099
2023-04-20 18:31:06,158 - Detection - ***** Epoch: 38: Eval results *****
2023-04-20 18:31:06,159 - Detection -   best_eval_score = 61.28
2023-04-20 18:31:06,159 - Detection -   eval_score = 60.8
2023-04-20 18:31:06,159 - Detection -   train_loss = 1.1682583689689636
2023-04-20 18:31:07,931 - Detection - ***** Epoch: 39: Eval results *****
2023-04-20 18:31:07,931 - Detection -   best_eval_score = 61.28
2023-04-20 18:31:07,931 - Detection -   eval_score = 60.98
2023-04-20 18:31:07,931 - Detection -   train_loss = 1.1746493833405631
2023-04-20 18:31:09,684 - Detection - ***** Epoch: 40: Eval results *****
2023-04-20 18:31:09,684 - Detection -   best_eval_score = 61.28
2023-04-20 18:31:09,684 - Detection -   eval_score = 61.35
2023-04-20 18:31:09,684 - Detection -   train_loss = 1.1448930161339896
2023-04-20 18:31:11,466 - Detection - ***** Epoch: 41: Eval results *****
2023-04-20 18:31:11,466 - Detection -   best_eval_score = 61.35
2023-04-20 18:31:11,466 - Detection -   eval_score = 61.34
2023-04-20 18:31:11,466 - Detection -   train_loss = 1.151144368307931
2023-04-20 18:31:13,232 - Detection - ***** Epoch: 42: Eval results *****
2023-04-20 18:31:13,233 - Detection -   best_eval_score = 61.35
2023-04-20 18:31:13,233 - Detection -   eval_score = 60.55
2023-04-20 18:31:13,233 - Detection -   train_loss = 1.1352607267243522
2023-04-20 18:31:14,988 - Detection - ***** Epoch: 43: Eval results *****
2023-04-20 18:31:14,988 - Detection -   best_eval_score = 61.35
2023-04-20 18:31:14,988 - Detection -   eval_score = 60.69
2023-04-20 18:31:14,988 - Detection -   train_loss = 1.1669294238090515
2023-04-20 18:31:16,730 - Detection - ***** Epoch: 44: Eval results *****
2023-04-20 18:31:16,730 - Detection -   best_eval_score = 61.35
2023-04-20 18:31:16,730 - Detection -   eval_score = 60.54
2023-04-20 18:31:16,730 - Detection -   train_loss = 1.1665169596672058
2023-04-20 18:31:18,473 - Detection - ***** Epoch: 45: Eval results *****
2023-04-20 18:31:18,473 - Detection -   best_eval_score = 61.35
2023-04-20 18:31:18,473 - Detection -   eval_score = 60.73
2023-04-20 18:31:18,473 - Detection -   train_loss = 1.130131185054779
2023-04-20 18:31:20,220 - Detection - ***** Epoch: 46: Eval results *****
2023-04-20 18:31:20,220 - Detection -   best_eval_score = 61.35
2023-04-20 18:31:20,220 - Detection -   eval_score = 60.45
2023-04-20 18:31:20,220 - Detection -   train_loss = 1.16256206376212
2023-04-20 18:31:21,967 - Detection - ***** Epoch: 47: Eval results *****
2023-04-20 18:31:21,967 - Detection -   best_eval_score = 61.35
2023-04-20 18:31:21,967 - Detection -   eval_score = 60.44
2023-04-20 18:31:21,967 - Detection -   train_loss = 1.1267391187804086
2023-04-20 18:31:23,715 - Detection - ***** Epoch: 48: Eval results *****
2023-04-20 18:31:23,715 - Detection -   best_eval_score = 61.35
2023-04-20 18:31:23,715 - Detection -   eval_score = 60.44
2023-04-20 18:31:23,715 - Detection -   train_loss = 1.124643738780703
2023-04-20 18:31:25,459 - Detection - ***** Epoch: 49: Eval results *****
2023-04-20 18:31:25,459 - Detection -   best_eval_score = 61.35
2023-04-20 18:31:25,459 - Detection -   eval_score = 60.27
2023-04-20 18:31:25,459 - Detection -   train_loss = 1.1368059005056108
2023-04-20 18:31:27,211 - Detection - ***** Epoch: 50: Eval results *****
2023-04-20 18:31:27,211 - Detection -   best_eval_score = 61.35
2023-04-20 18:31:27,211 - Detection -   eval_score = 60.64
2023-04-20 18:31:27,211 - Detection -   train_loss = 1.1326947893415178
2023-04-20 18:31:27,213 - Detection - Training Finished...
2023-04-20 18:31:27,213 - Detection - Testing begin...
2023-04-20 18:31:29,440 - Detection - ***** Test: Confusion Matrix *****
2023-04-20 18:31:29,440 - Detection - [[  16    0    0 ...    0    0    3]
 [   0    7    0 ...    0    1    7]
 [   0    0   17 ...    0    0    4]
 ...
 [   0    0    0 ...    2    0    8]
 [   0    1    0 ...    0    5    3]
 [   1    1    3 ...    3    3 2169]]
2023-04-20 18:31:29,440 - Detection - ***** Test results *****
2023-04-20 18:31:29,440 - Detection -   Acc = 77.53
2023-04-20 18:31:29,440 - Detection -   F1 = 55.7545
2023-04-20 18:31:29,441 - Detection -   F1-known = 55.3676
2023-04-20 18:31:29,441 - Detection -   F1-open = 84.7762
2023-04-20 18:31:29,441 - Detection - Testing finished...
2023-04-20 18:31:29,441 - Detection - Results saved in results/results_ADB.csv
2023-04-20 18:31:29,461 - Detection - Open Intent Detection Finished...
