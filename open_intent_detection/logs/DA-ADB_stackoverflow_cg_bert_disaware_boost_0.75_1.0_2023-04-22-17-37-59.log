2023-04-22 17:37:59,594 - Detection - Open Intent Detection Begin...
2023-04-22 17:37:59,594 - Detection - Parameters Initialization...
2023-04-22 17:37:59,594 - Detection - ============================== Params ==============================
2023-04-22 17:37:59,594 - Detection - type:	open_intent_detection
2023-04-22 17:37:59,594 - Detection - logger_name:	Detection
2023-04-22 17:37:59,594 - Detection - log_dir:	logs
2023-04-22 17:37:59,594 - Detection - dataset:	stackoverflow_cg
2023-04-22 17:37:59,594 - Detection - known_cls_ratio:	0.75
2023-04-22 17:37:59,594 - Detection - labeled_ratio:	1.0
2023-04-22 17:37:59,594 - Detection - method:	DA-ADB
2023-04-22 17:37:59,594 - Detection - train:	True
2023-04-22 17:37:59,594 - Detection - pretrain:	True
2023-04-22 17:37:59,594 - Detection - save_model:	False
2023-04-22 17:37:59,594 - Detection - backbone:	bert_disaware_boost
2023-04-22 17:37:59,594 - Detection - config_file_name:	DA-ADB
2023-04-22 17:37:59,594 - Detection - seed:	8
2023-04-22 17:37:59,594 - Detection - gpu_id:	0
2023-04-22 17:37:59,594 - Detection - pipe_results_path:	pipe_results
2023-04-22 17:37:59,594 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-22 17:37:59,594 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-22 17:37:59,594 - Detection - model_dir:	models
2023-04-22 17:37:59,594 - Detection - load_pretrained_method:	None
2023-04-22 17:37:59,595 - Detection - result_dir:	results
2023-04-22 17:37:59,595 - Detection - results_file_name:	results_DA-ADB-BOOST.csv
2023-04-22 17:37:59,595 - Detection - save_results:	True
2023-04-22 17:37:59,595 - Detection - loss_fct:	CrossEntropyLoss
2023-04-22 17:37:59,595 - Detection - boost_method:	F-10
2023-04-22 17:37:59,595 - Detection - boost_start_score:	0.0
2023-04-22 17:37:59,595 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.75_1.0_bert_disaware_boost_8
2023-04-22 17:37:59,595 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.75_1.0_bert_disaware_boost_8/models
2023-04-22 17:37:59,595 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-22 17:37:59,595 - Detection - num_train_epochs:	100
2023-04-22 17:37:59,595 - Detection - num_labels:	None
2023-04-22 17:37:59,595 - Detection - max_seq_length:	None
2023-04-22 17:37:59,595 - Detection - freeze_backbone_parameters:	True
2023-04-22 17:37:59,595 - Detection - feat_dim:	768
2023-04-22 17:37:59,595 - Detection - warmup_proportion:	0.1
2023-04-22 17:37:59,595 - Detection - scale:	4
2023-04-22 17:37:59,595 - Detection - lr_boundary:	0.05
2023-04-22 17:37:59,595 - Detection - lr:	2e-05
2023-04-22 17:37:59,595 - Detection - activation:	relu
2023-04-22 17:37:59,595 - Detection - train_batch_size:	128
2023-04-22 17:37:59,595 - Detection - eval_batch_size:	64
2023-04-22 17:37:59,595 - Detection - test_batch_size:	64
2023-04-22 17:37:59,595 - Detection - wait_patient:	10
2023-04-22 17:37:59,595 - Detection - ============================== End Params ==============================
2023-04-22 17:37:59,595 - Detection - Data and Model Preparation...
2023-04-22 17:37:59,595 - Detection - The number of known intents is 15
2023-04-22 17:37:59,596 - Detection - Lists of known labels are: ['hibernate', 'oracle', 'haskell', 'sharepoint', 'visual-studio', 'drupal', 'osx', 'bash', 'qt', 'apache', 'spring', 'ajax', 'scala', 'wordpress', 'linq']
2023-04-22 17:37:59,605 - Detection - Number of labeled training samples = 2092
2023-04-22 17:37:59,606 - Detection - Number of unlabeled training samples = 699
2023-04-22 17:37:59,608 - Detection - Number of evaluation samples = 1072
2023-04-22 17:37:59,614 - Detection - Number of testing samples = 2905
2023-04-22 17:38:05,325 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-22 17:38:05,407 - Detection - Pre-training Begin...
2023-04-22 17:38:10,412 - Detection - ***** Epoch: 1: Eval results *****
2023-04-22 17:38:10,412 - Detection -   best_eval_score = 0
2023-04-22 17:38:10,412 - Detection -   eval_score = 1.54
2023-04-22 17:38:10,412 - Detection -   train_loss = 2.707485283122343
2023-04-22 17:38:43,134 - Detection - ***** Epoch: 2: Eval results *****
2023-04-22 17:38:43,134 - Detection -   best_eval_score = 1.54
2023-04-22 17:38:43,134 - Detection -   eval_score = 3.58
2023-04-22 17:38:43,134 - Detection -   train_loss = 2.6951296469744515
2023-04-22 17:39:16,040 - Detection - ***** Epoch: 3: Eval results *****
2023-04-22 17:39:16,040 - Detection -   best_eval_score = 3.58
2023-04-22 17:39:16,040 - Detection -   eval_score = 45.61
2023-04-22 17:39:16,040 - Detection -   train_loss = 2.575909095651963
2023-04-22 17:39:48,995 - Detection - ***** Epoch: 4: Eval results *****
2023-04-22 17:39:48,995 - Detection -   best_eval_score = 45.61
2023-04-22 17:39:48,995 - Detection -   eval_score = 76.09
2023-04-22 17:39:48,995 - Detection -   train_loss = 2.207034068949082
2023-04-22 17:40:22,049 - Detection - ***** Epoch: 5: Eval results *****
2023-04-22 17:40:22,049 - Detection -   best_eval_score = 76.09
2023-04-22 17:40:22,049 - Detection -   eval_score = 80.93
2023-04-22 17:40:22,049 - Detection -   train_loss = 1.6671598027734196
2023-04-22 17:40:54,907 - Detection - ***** Epoch: 6: Eval results *****
2023-04-22 17:40:54,908 - Detection -   best_eval_score = 80.93
2023-04-22 17:40:54,908 - Detection -   eval_score = 81.96
2023-04-22 17:40:54,908 - Detection -   train_loss = 1.3152294579674215
2023-04-22 17:41:27,803 - Detection - ***** Epoch: 7: Eval results *****
2023-04-22 17:41:27,803 - Detection -   best_eval_score = 81.96
2023-04-22 17:41:27,803 - Detection -   eval_score = 82.8
2023-04-22 17:41:27,803 - Detection -   train_loss = 1.1545692962758682
2023-04-22 17:42:00,635 - Detection - ***** Epoch: 8: Eval results *****
2023-04-22 17:42:00,635 - Detection -   best_eval_score = 82.8
2023-04-22 17:42:00,636 - Detection -   eval_score = 82.66
2023-04-22 17:42:00,636 - Detection -   train_loss = 1.036201890777139
2023-04-22 17:42:33,528 - Detection - ***** Epoch: 9: Eval results *****
2023-04-22 17:42:33,528 - Detection -   best_eval_score = 82.8
2023-04-22 17:42:33,528 - Detection -   eval_score = 82.81
2023-04-22 17:42:33,529 - Detection -   train_loss = 0.9332303019130931
2023-04-22 17:43:06,518 - Detection - ***** Epoch: 10: Eval results *****
2023-04-22 17:43:06,518 - Detection -   best_eval_score = 82.81
2023-04-22 17:43:06,518 - Detection -   eval_score = 83.47
2023-04-22 17:43:06,518 - Detection -   train_loss = 0.8444665880764232
2023-04-22 17:43:39,328 - Detection - ***** Epoch: 11: Eval results *****
2023-04-22 17:43:39,329 - Detection -   best_eval_score = 83.47
2023-04-22 17:43:39,329 - Detection -   eval_score = 83.22
2023-04-22 17:43:39,329 - Detection -   train_loss = 0.7646139579660752
2023-04-22 17:44:12,146 - Detection - ***** Epoch: 12: Eval results *****
2023-04-22 17:44:12,146 - Detection -   best_eval_score = 83.47
2023-04-22 17:44:12,146 - Detection -   eval_score = 83.3
2023-04-22 17:44:12,146 - Detection -   train_loss = 0.6936979539254132
2023-04-22 17:44:45,045 - Detection - ***** Epoch: 13: Eval results *****
2023-04-22 17:44:45,045 - Detection -   best_eval_score = 83.47
2023-04-22 17:44:45,045 - Detection -   eval_score = 82.81
2023-04-22 17:44:45,045 - Detection -   train_loss = 0.6482173905653112
2023-04-22 17:45:17,823 - Detection - ***** Epoch: 14: Eval results *****
2023-04-22 17:45:17,823 - Detection -   best_eval_score = 83.47
2023-04-22 17:45:17,823 - Detection -   eval_score = 82.11
2023-04-22 17:45:17,823 - Detection -   train_loss = 0.5972632239846623
2023-04-22 17:45:50,655 - Detection - ***** Epoch: 15: Eval results *****
2023-04-22 17:45:50,655 - Detection -   best_eval_score = 83.47
2023-04-22 17:45:50,655 - Detection -   eval_score = 82.2
2023-04-22 17:45:50,655 - Detection -   train_loss = 0.5477635930566227
2023-04-22 17:46:23,514 - Detection - ***** Epoch: 16: Eval results *****
2023-04-22 17:46:23,514 - Detection -   best_eval_score = 83.47
2023-04-22 17:46:23,514 - Detection -   eval_score = 82.33
2023-04-22 17:46:23,514 - Detection -   train_loss = 0.5181065412128673
2023-04-22 17:46:56,419 - Detection - ***** Epoch: 17: Eval results *****
2023-04-22 17:46:56,419 - Detection -   best_eval_score = 83.47
2023-04-22 17:46:56,419 - Detection -   eval_score = 82.08
2023-04-22 17:46:56,419 - Detection -   train_loss = 0.5025500777889701
2023-04-22 17:47:29,193 - Detection - ***** Epoch: 18: Eval results *****
2023-04-22 17:47:29,193 - Detection -   best_eval_score = 83.47
2023-04-22 17:47:29,193 - Detection -   eval_score = 82.22
2023-04-22 17:47:29,193 - Detection -   train_loss = 0.46847177077742186
2023-04-22 17:48:01,946 - Detection - ***** Epoch: 19: Eval results *****
2023-04-22 17:48:01,947 - Detection -   best_eval_score = 83.47
2023-04-22 17:48:01,947 - Detection -   eval_score = 82.34
2023-04-22 17:48:01,947 - Detection -   train_loss = 0.45091524895499735
2023-04-22 17:48:34,714 - Detection - ***** Epoch: 20: Eval results *****
2023-04-22 17:48:34,714 - Detection -   best_eval_score = 83.47
2023-04-22 17:48:34,714 - Detection -   eval_score = 82.33
2023-04-22 17:48:34,714 - Detection -   train_loss = 0.42727556474068584
2023-04-22 17:48:34,714 - Detection - Pre-training finished...
2023-04-22 17:48:34,715 - Detection - Training Begin...
2023-04-22 17:48:37,540 - Detection - ***** Epoch: 1: Eval results *****
2023-04-22 17:48:37,540 - Detection -   best_eval_score = 0
2023-04-22 17:48:37,540 - Detection -   eval_score = 0.17
2023-04-22 17:48:37,540 - Detection -   train_loss = 4.693574765149285
2023-04-22 17:49:08,409 - Detection - ***** Epoch: 2: Eval results *****
2023-04-22 17:49:08,409 - Detection -   best_eval_score = 0.17
2023-04-22 17:49:08,409 - Detection -   eval_score = 71.56
2023-04-22 17:49:08,409 - Detection -   train_loss = 4.158747027902042
2023-04-22 17:49:39,344 - Detection - ***** Epoch: 3: Eval results *****
2023-04-22 17:49:39,344 - Detection -   best_eval_score = 71.56
2023-04-22 17:49:39,344 - Detection -   eval_score = 72.01
2023-04-22 17:49:39,344 - Detection -   train_loss = 0.9935789108276367
2023-04-22 17:50:10,195 - Detection - ***** Epoch: 4: Eval results *****
2023-04-22 17:50:10,195 - Detection -   best_eval_score = 72.01
2023-04-22 17:50:10,195 - Detection -   eval_score = 71.51
2023-04-22 17:50:10,195 - Detection -   train_loss = 0.9819205052712384
2023-04-22 17:50:41,044 - Detection - ***** Epoch: 5: Eval results *****
2023-04-22 17:50:41,045 - Detection -   best_eval_score = 72.01
2023-04-22 17:50:41,045 - Detection -   eval_score = 72.34
2023-04-22 17:50:41,045 - Detection -   train_loss = 0.9739419432247386
2023-04-22 17:51:12,024 - Detection - ***** Epoch: 6: Eval results *****
2023-04-22 17:51:12,024 - Detection -   best_eval_score = 72.34
2023-04-22 17:51:12,024 - Detection -   eval_score = 71.69
2023-04-22 17:51:12,024 - Detection -   train_loss = 1.0029498689314897
2023-04-22 17:51:43,079 - Detection - ***** Epoch: 7: Eval results *****
2023-04-22 17:51:43,079 - Detection -   best_eval_score = 72.34
2023-04-22 17:51:43,079 - Detection -   eval_score = 71.53
2023-04-22 17:51:43,080 - Detection -   train_loss = 0.9968956989400527
2023-04-22 17:52:13,915 - Detection - ***** Epoch: 8: Eval results *****
2023-04-22 17:52:13,915 - Detection -   best_eval_score = 72.34
2023-04-22 17:52:13,915 - Detection -   eval_score = 71.53
2023-04-22 17:52:13,915 - Detection -   train_loss = 1.0053903565687292
2023-04-22 17:52:45,031 - Detection - ***** Epoch: 9: Eval results *****
2023-04-22 17:52:45,032 - Detection -   best_eval_score = 72.34
2023-04-22 17:52:45,032 - Detection -   eval_score = 71.81
2023-04-22 17:52:45,032 - Detection -   train_loss = 0.991052203318652
2023-04-22 17:53:16,077 - Detection - ***** Epoch: 10: Eval results *****
2023-04-22 17:53:16,078 - Detection -   best_eval_score = 72.34
2023-04-22 17:53:16,078 - Detection -   eval_score = 72.21
2023-04-22 17:53:16,078 - Detection -   train_loss = 0.9706007908372318
2023-04-22 17:53:46,951 - Detection - ***** Epoch: 11: Eval results *****
2023-04-22 17:53:46,951 - Detection -   best_eval_score = 72.34
2023-04-22 17:53:46,952 - Detection -   eval_score = 72.44
2023-04-22 17:53:46,952 - Detection -   train_loss = 0.9883308060028974
2023-04-22 17:54:18,067 - Detection - ***** Epoch: 12: Eval results *****
2023-04-22 17:54:18,067 - Detection -   best_eval_score = 72.44
2023-04-22 17:54:18,067 - Detection -   eval_score = 71.42
2023-04-22 17:54:18,067 - Detection -   train_loss = 0.9778981734724606
2023-04-22 17:54:49,146 - Detection - ***** Epoch: 13: Eval results *****
2023-04-22 17:54:49,146 - Detection -   best_eval_score = 72.44
2023-04-22 17:54:49,146 - Detection -   eval_score = 72.39
2023-04-22 17:54:49,146 - Detection -   train_loss = 1.012654185295105
2023-04-22 17:55:19,994 - Detection - ***** Epoch: 14: Eval results *****
2023-04-22 17:55:19,994 - Detection -   best_eval_score = 72.44
2023-04-22 17:55:19,995 - Detection -   eval_score = 71.16
2023-04-22 17:55:19,995 - Detection -   train_loss = 0.9808768910520217
2023-04-22 17:55:50,934 - Detection - ***** Epoch: 15: Eval results *****
2023-04-22 17:55:50,934 - Detection -   best_eval_score = 72.44
2023-04-22 17:55:50,934 - Detection -   eval_score = 71.23
2023-04-22 17:55:50,934 - Detection -   train_loss = 0.9858976672677433
2023-04-22 17:56:21,913 - Detection - ***** Epoch: 16: Eval results *****
2023-04-22 17:56:21,913 - Detection -   best_eval_score = 72.44
2023-04-22 17:56:21,913 - Detection -   eval_score = 71.42
2023-04-22 17:56:21,913 - Detection -   train_loss = 0.9780107561279746
2023-04-22 17:56:52,782 - Detection - ***** Epoch: 17: Eval results *****
2023-04-22 17:56:52,782 - Detection -   best_eval_score = 72.44
2023-04-22 17:56:52,782 - Detection -   eval_score = 72.14
2023-04-22 17:56:52,782 - Detection -   train_loss = 0.9939464470919441
2023-04-22 17:57:23,764 - Detection - ***** Epoch: 18: Eval results *****
2023-04-22 17:57:23,764 - Detection -   best_eval_score = 72.44
2023-04-22 17:57:23,764 - Detection -   eval_score = 72.13
2023-04-22 17:57:23,764 - Detection -   train_loss = 0.9839442828122307
2023-04-22 17:57:54,639 - Detection - ***** Epoch: 19: Eval results *****
2023-04-22 17:57:54,640 - Detection -   best_eval_score = 72.44
2023-04-22 17:57:54,640 - Detection -   eval_score = 72.25
2023-04-22 17:57:54,640 - Detection -   train_loss = 0.9893824843799367
2023-04-22 17:58:25,730 - Detection - ***** Epoch: 20: Eval results *****
2023-04-22 17:58:25,730 - Detection -   best_eval_score = 72.44
2023-04-22 17:58:25,730 - Detection -   eval_score = 71.68
2023-04-22 17:58:25,730 - Detection -   train_loss = 1.010687670286964
2023-04-22 17:58:56,490 - Detection - ***** Epoch: 21: Eval results *****
2023-04-22 17:58:56,490 - Detection -   best_eval_score = 72.44
2023-04-22 17:58:56,490 - Detection -   eval_score = 72.13
2023-04-22 17:58:56,490 - Detection -   train_loss = 0.9745412889648887
2023-04-22 17:58:56,490 - Detection - Training Finished...
2023-04-22 17:58:56,490 - Detection - Testing begin...
2023-04-22 17:58:58,910 - Detection - ***** Test: Confusion Matrix *****
2023-04-22 17:58:58,911 - Detection - [[ 83   3   1   0   0   0   1   0   0   1   2   0   0   0   0  37]
 [  0  92   2   0   0   0   0   0   0   1   0   0   0   0   0  32]
 [  0   0  63   0   0   0   0   0   0   0   0   0   2   0   0  57]
 [  0   0   0 130   4   1   0   1   0   0   0   1   0   0   0  34]
 [  0   0   1   1  45   0   8   0   0   0   0   3   0   0   0  48]
 [  0   0   0   2   0  99   0   0   0   2   0   2   0   0   0  23]
 [  0   0   0   0   0   0 122   0   2   0   0   0   0   0   0  69]
 [  0   0   3   0   0   0   3  41   0   0   0   2   0   0   0  90]
 [  0   0   1   0   0   0   1   0 154   0   0   0   0   0   0  16]
 [  0   0   0   0   0   0   0   0   0  70   0   1   0   1   0  98]
 [  1   0   1   0   0   0   0   0   0   2 101   0   0   0   0  46]
 [  1   0   1   0   0   0   1   0   0   2   0  85   0   2   0  68]
 [  0   0   5   0   0   0   0   0   0   0   0   0  77   0   0  42]
 [  0   0   0   0   0   0   0   0   0   2   0   1   0 113   0  21]
 [  0   0   2   0   0   0   0   0   0   0   0   0   1   0 103  25]
 [  1   1  53   4  23   1 119  11   5   7   0   7  11   0   0 503]]
2023-04-22 17:58:58,911 - Detection - ***** Test results *****
2023-04-22 17:58:58,911 - Detection -   Acc = 64.75
2023-04-22 17:58:58,911 - Detection -   F1 = 69.9959
2023-04-22 17:58:58,911 - Detection -   F1-known = 71.2318
2023-04-22 17:58:58,911 - Detection -   F1-open = 51.4578
2023-04-22 17:58:58,911 - Detection - Testing finished...
2023-04-22 17:58:58,911 - Detection - Results saved in results/results_DA-ADB-BOOST.csv
2023-04-22 17:58:58,931 - Detection - Open Intent Detection Finished...
