2023-04-24 04:16:43,646 - Detection - Open Intent Detection Begin...
2023-04-24 04:16:43,646 - Detection - Parameters Initialization...
2023-04-24 04:16:43,646 - Detection - ============================== Params ==============================
2023-04-24 04:16:43,646 - Detection - type:	open_intent_detection
2023-04-24 04:16:43,646 - Detection - logger_name:	Detection
2023-04-24 04:16:43,646 - Detection - log_dir:	logs
2023-04-24 04:16:43,646 - Detection - dataset:	oos_cg
2023-04-24 04:16:43,646 - Detection - known_cls_ratio:	0.75
2023-04-24 04:16:43,646 - Detection - labeled_ratio:	1.0
2023-04-24 04:16:43,646 - Detection - method:	ADB
2023-04-24 04:16:43,646 - Detection - train:	True
2023-04-24 04:16:43,646 - Detection - pretrain:	True
2023-04-24 04:16:43,646 - Detection - save_model:	False
2023-04-24 04:16:43,646 - Detection - backbone:	bert_boost
2023-04-24 04:16:43,646 - Detection - config_file_name:	ADB
2023-04-24 04:16:43,647 - Detection - seed:	0
2023-04-24 04:16:43,647 - Detection - gpu_id:	0
2023-04-24 04:16:43,647 - Detection - pipe_results_path:	pipe_results
2023-04-24 04:16:43,647 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-24 04:16:43,647 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-24 04:16:43,647 - Detection - model_dir:	models
2023-04-24 04:16:43,647 - Detection - load_pretrained_method:	None
2023-04-24 04:16:43,647 - Detection - result_dir:	results
2023-04-24 04:16:43,647 - Detection - results_file_name:	results_ADB-BOOST-F-10.csv
2023-04-24 04:16:43,647 - Detection - save_results:	True
2023-04-24 04:16:43,647 - Detection - loss_fct:	CrossEntropyLoss
2023-04-24 04:16:43,647 - Detection - boost_method:	F-10
2023-04-24 04:16:43,647 - Detection - boost_start_score:	0.0
2023-04-24 04:16:43,647 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_cg_0.75_1.0_bert_boost_0
2023-04-24 04:16:43,647 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_cg_0.75_1.0_bert_boost_0/models
2023-04-24 04:16:43,647 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-24 04:16:43,647 - Detection - num_train_epochs:	100
2023-04-24 04:16:43,647 - Detection - num_labels:	None
2023-04-24 04:16:43,647 - Detection - max_seq_length:	None
2023-04-24 04:16:43,647 - Detection - freeze_backbone_parameters:	True
2023-04-24 04:16:43,647 - Detection - feat_dim:	768
2023-04-24 04:16:43,647 - Detection - warmup_proportion:	0.1
2023-04-24 04:16:43,647 - Detection - lr_boundary:	0.05
2023-04-24 04:16:43,647 - Detection - lr:	2e-05
2023-04-24 04:16:43,647 - Detection - activation:	relu
2023-04-24 04:16:43,647 - Detection - train_batch_size:	128
2023-04-24 04:16:43,647 - Detection - eval_batch_size:	64
2023-04-24 04:16:43,647 - Detection - test_batch_size:	64
2023-04-24 04:16:43,647 - Detection - wait_patient:	10
2023-04-24 04:16:43,647 - Detection - ============================== End Params ==============================
2023-04-24 04:16:43,647 - Detection - Data and Model Preparation...
2023-04-24 04:16:43,647 - Detection - The number of known intents is 112
2023-04-24 04:16:43,648 - Detection - Lists of known labels are: ['spelling', 'jump_start', 'date', 'routing', 'bill_balance', 'reset_settings', 'expiration_date', 'play_music', 'no', 'min_payment', 'travel_suggestion', 'how_busy', 'new_card', 'income', 'last_maintenance', 'distance', 'oil_change_how', 'pto_request_status', 'freeze_account', 'cancel_reservation', 'time', 'maybe', 'change_user_name', 'bill_due', 'todo_list', 'change_language', 'food_last', 'replacement_card_duration', 'redeem_rewards', 'confirm_reservation', 'user_name', 'payday', 'cook_time', 'todo_list_update', 'travel_alert', 'interest_rate', 'card_declined', 'pay_bill', 'international_visa', 'recipe', 'shopping_list_update', 'alarm', 'what_are_your_hobbies', 'flip_coin', 'book_hotel', 'international_fees', 'sync_device', 'what_song', 'text', 'schedule_maintenance', 'measurement_conversion', 'uber', 'ingredients_list', 'order', 'timezone', 'travel_notification', 'rollover_401k', 'whisper_mode', 'greeting', 'who_do_you_work_for', 'pin_change', 'credit_score', 'restaurant_reservation', 'reminder', 'lost_luggage', 'pto_request', 'pto_used', 'tire_pressure', 'gas_type', 'calendar_update', 'shopping_list', 'reminder_update', 'change_accent', 'cancel', 'how_old_are_you', 'application_status', 'yes', 'report_fraud', 'balance', 'meaning_of_life', 'schedule_meeting', 'repeat', 'calendar', 'restaurant_reviews', 'thank_you', 'rewards_balance', 'traffic', 'fun_fact', 'calculator', 'share_location', 'tire_change', 'find_phone', 'who_made_you', 'account_blocked', 'smart_home', 'w2', 'flight_status', 'apr', 'transactions', 'car_rental', 'do_you_have_pets', 'are_you_a_bot', 'improve_credit_score', 'what_is_your_name', 'roll_dice', 'accept_reservations', 'definition', 'credit_limit', 'ingredient_substitution', 'next_song', 'direct_deposit', 'change_speed']
2023-04-24 04:16:43,662 - Detection - Number of labeled training samples = 2823
2023-04-24 04:16:43,662 - Detection - Number of unlabeled training samples = 860
2023-04-24 04:16:43,666 - Detection - Number of evaluation samples = 1225
2023-04-24 04:16:43,675 - Detection - Number of testing samples = 3632
2023-04-24 04:16:47,810 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-24 04:16:49,480 - Detection - Pre-training Begin...
2023-04-24 04:16:52,486 - Detection - ***** Epoch: 1: Eval results *****
2023-04-24 04:16:52,487 - Detection -   best_eval_score = 0
2023-04-24 04:16:52,487 - Detection -   eval_score = 0.82
2023-04-24 04:16:52,487 - Detection -   train_loss = 4.711903696474821
2023-04-24 04:17:22,770 - Detection - ***** Epoch: 2: Eval results *****
2023-04-24 04:17:22,770 - Detection -   best_eval_score = 0.82
2023-04-24 04:17:22,770 - Detection -   eval_score = 12.98
2023-04-24 04:17:22,770 - Detection -   train_loss = 4.688980807428774
2023-04-24 04:17:53,260 - Detection - ***** Epoch: 3: Eval results *****
2023-04-24 04:17:53,260 - Detection -   best_eval_score = 12.98
2023-04-24 04:17:53,260 - Detection -   eval_score = 24.82
2023-04-24 04:17:53,260 - Detection -   train_loss = 3.90079897382985
2023-04-24 04:18:23,603 - Detection - ***** Epoch: 4: Eval results *****
2023-04-24 04:18:23,603 - Detection -   best_eval_score = 24.82
2023-04-24 04:18:23,603 - Detection -   eval_score = 43.1
2023-04-24 04:18:23,603 - Detection -   train_loss = 2.5249873399734497
2023-04-24 04:18:53,796 - Detection - ***** Epoch: 5: Eval results *****
2023-04-24 04:18:53,796 - Detection -   best_eval_score = 43.1
2023-04-24 04:18:53,796 - Detection -   eval_score = 56.57
2023-04-24 04:18:53,796 - Detection -   train_loss = 1.606083590051402
2023-04-24 04:19:24,169 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 04:19:24,169 - Detection -   best_eval_score = 56.57
2023-04-24 04:19:24,169 - Detection -   eval_score = 66.04
2023-04-24 04:19:24,169 - Detection -   train_loss = 0.9920027541077655
2023-04-24 04:19:54,518 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 04:19:54,518 - Detection -   best_eval_score = 66.04
2023-04-24 04:19:54,519 - Detection -   eval_score = 72.65
2023-04-24 04:19:54,519 - Detection -   train_loss = 0.6744087079296941
2023-04-24 04:20:25,038 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 04:20:25,038 - Detection -   best_eval_score = 72.65
2023-04-24 04:20:25,038 - Detection -   eval_score = 74.69
2023-04-24 04:20:25,038 - Detection -   train_loss = 0.43993275191472925
2023-04-24 04:20:55,241 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 04:20:55,241 - Detection -   best_eval_score = 74.69
2023-04-24 04:20:55,241 - Detection -   eval_score = 76.49
2023-04-24 04:20:55,241 - Detection -   train_loss = 0.3147800616596056
2023-04-24 04:21:25,595 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 04:21:25,595 - Detection -   best_eval_score = 76.49
2023-04-24 04:21:25,595 - Detection -   eval_score = 78.12
2023-04-24 04:21:25,595 - Detection -   train_loss = 0.20668159425258636
2023-04-24 04:21:56,110 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 04:21:56,111 - Detection -   best_eval_score = 78.12
2023-04-24 04:21:56,111 - Detection -   eval_score = 78.69
2023-04-24 04:21:56,111 - Detection -   train_loss = 0.15339876079688902
2023-04-24 04:22:26,600 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 04:22:26,600 - Detection -   best_eval_score = 78.69
2023-04-24 04:22:26,600 - Detection -   eval_score = 79.27
2023-04-24 04:22:26,600 - Detection -   train_loss = 0.12131545887045238
2023-04-24 04:22:56,905 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 04:22:56,905 - Detection -   best_eval_score = 79.27
2023-04-24 04:22:56,905 - Detection -   eval_score = 78.69
2023-04-24 04:22:56,905 - Detection -   train_loss = 0.09991203070334766
2023-04-24 04:23:27,166 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 04:23:27,167 - Detection -   best_eval_score = 79.27
2023-04-24 04:23:27,167 - Detection -   eval_score = 78.86
2023-04-24 04:23:27,167 - Detection -   train_loss = 0.0786106225265109
2023-04-24 04:23:57,612 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 04:23:57,612 - Detection -   best_eval_score = 79.27
2023-04-24 04:23:57,612 - Detection -   eval_score = 79.27
2023-04-24 04:23:57,612 - Detection -   train_loss = 0.06334672771070314
2023-04-24 04:24:27,881 - Detection - ***** Epoch: 16: Eval results *****
2023-04-24 04:24:27,881 - Detection -   best_eval_score = 79.27
2023-04-24 04:24:27,881 - Detection -   eval_score = 80.0
2023-04-24 04:24:27,881 - Detection -   train_loss = 0.058046160022849624
2023-04-24 04:24:58,398 - Detection - ***** Epoch: 17: Eval results *****
2023-04-24 04:24:58,398 - Detection -   best_eval_score = 80.0
2023-04-24 04:24:58,398 - Detection -   eval_score = 80.24
2023-04-24 04:24:58,398 - Detection -   train_loss = 0.04916700834165449
2023-04-24 04:25:28,681 - Detection - ***** Epoch: 18: Eval results *****
2023-04-24 04:25:28,681 - Detection -   best_eval_score = 80.24
2023-04-24 04:25:28,681 - Detection -   eval_score = 80.24
2023-04-24 04:25:28,681 - Detection -   train_loss = 0.037766238573290735
2023-04-24 04:25:58,882 - Detection - ***** Epoch: 19: Eval results *****
2023-04-24 04:25:58,882 - Detection -   best_eval_score = 80.24
2023-04-24 04:25:58,883 - Detection -   eval_score = 80.33
2023-04-24 04:25:58,883 - Detection -   train_loss = 0.032818999951300415
2023-04-24 04:26:29,447 - Detection - ***** Epoch: 20: Eval results *****
2023-04-24 04:26:29,447 - Detection -   best_eval_score = 80.33
2023-04-24 04:26:29,447 - Detection -   eval_score = 79.76
2023-04-24 04:26:29,447 - Detection -   train_loss = 0.02763013889932114
2023-04-24 04:26:59,771 - Detection - ***** Epoch: 21: Eval results *****
2023-04-24 04:26:59,771 - Detection -   best_eval_score = 80.33
2023-04-24 04:26:59,771 - Detection -   eval_score = 80.16
2023-04-24 04:26:59,771 - Detection -   train_loss = 0.026381775858285633
2023-04-24 04:27:30,051 - Detection - ***** Epoch: 22: Eval results *****
2023-04-24 04:27:30,051 - Detection -   best_eval_score = 80.33
2023-04-24 04:27:30,051 - Detection -   eval_score = 79.59
2023-04-24 04:27:30,051 - Detection -   train_loss = 0.028014952033434227
2023-04-24 04:28:00,538 - Detection - ***** Epoch: 23: Eval results *****
2023-04-24 04:28:00,538 - Detection -   best_eval_score = 80.33
2023-04-24 04:28:00,538 - Detection -   eval_score = 79.43
2023-04-24 04:28:00,538 - Detection -   train_loss = 0.02132654449214106
2023-04-24 04:28:30,851 - Detection - ***** Epoch: 24: Eval results *****
2023-04-24 04:28:30,851 - Detection -   best_eval_score = 80.33
2023-04-24 04:28:30,851 - Detection -   eval_score = 79.51
2023-04-24 04:28:30,851 - Detection -   train_loss = 0.018469297205624374
2023-04-24 04:29:01,177 - Detection - ***** Epoch: 25: Eval results *****
2023-04-24 04:29:01,177 - Detection -   best_eval_score = 80.33
2023-04-24 04:29:01,177 - Detection -   eval_score = 80.0
2023-04-24 04:29:01,177 - Detection -   train_loss = 0.016350151485075123
2023-04-24 04:29:31,551 - Detection - ***** Epoch: 26: Eval results *****
2023-04-24 04:29:31,551 - Detection -   best_eval_score = 80.33
2023-04-24 04:29:31,551 - Detection -   eval_score = 79.35
2023-04-24 04:29:31,551 - Detection -   train_loss = 0.015358526300153007
2023-04-24 04:30:01,771 - Detection - ***** Epoch: 27: Eval results *****
2023-04-24 04:30:01,771 - Detection -   best_eval_score = 80.33
2023-04-24 04:30:01,771 - Detection -   eval_score = 79.43
2023-04-24 04:30:01,771 - Detection -   train_loss = 0.011911101922716784
2023-04-24 04:30:32,164 - Detection - ***** Epoch: 28: Eval results *****
2023-04-24 04:30:32,164 - Detection -   best_eval_score = 80.33
2023-04-24 04:30:32,164 - Detection -   eval_score = 79.92
2023-04-24 04:30:32,164 - Detection -   train_loss = 0.01327912034669324
2023-04-24 04:31:02,425 - Detection - ***** Epoch: 29: Eval results *****
2023-04-24 04:31:02,425 - Detection -   best_eval_score = 80.33
2023-04-24 04:31:02,425 - Detection -   eval_score = 80.16
2023-04-24 04:31:02,425 - Detection -   train_loss = 0.010836386830424484
2023-04-24 04:31:02,425 - Detection - Pre-training finished...
2023-04-24 04:31:02,426 - Detection - Training Begin...
2023-04-24 04:31:06,544 - Detection - ***** Epoch: 1: Eval results *****
2023-04-24 04:31:06,544 - Detection -   best_eval_score = 0
2023-04-24 04:31:06,544 - Detection -   eval_score = 0.0
2023-04-24 04:31:06,544 - Detection -   train_loss = 16.195907592773438
2023-04-24 04:31:09,049 - Detection - ***** Epoch: 2: Eval results *****
2023-04-24 04:31:09,049 - Detection -   best_eval_score = 0
2023-04-24 04:31:09,049 - Detection -   eval_score = 0.0
2023-04-24 04:31:09,049 - Detection -   train_loss = 15.574500332707943
2023-04-24 04:31:11,556 - Detection - ***** Epoch: 3: Eval results *****
2023-04-24 04:31:11,556 - Detection -   best_eval_score = 0
2023-04-24 04:31:11,556 - Detection -   eval_score = 0.0
2023-04-24 04:31:11,556 - Detection -   train_loss = 14.872928577920664
2023-04-24 04:31:14,066 - Detection - ***** Epoch: 4: Eval results *****
2023-04-24 04:31:14,066 - Detection -   best_eval_score = 0
2023-04-24 04:31:14,066 - Detection -   eval_score = 0.0
2023-04-24 04:31:14,066 - Detection -   train_loss = 13.9073370643284
2023-04-24 04:31:16,581 - Detection - ***** Epoch: 5: Eval results *****
2023-04-24 04:31:16,581 - Detection -   best_eval_score = 0
2023-04-24 04:31:16,581 - Detection -   eval_score = 0.0
2023-04-24 04:31:16,581 - Detection -   train_loss = 12.968403235725734
2023-04-24 04:31:19,098 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 04:31:19,098 - Detection -   best_eval_score = 0
2023-04-24 04:31:19,098 - Detection -   eval_score = 0.0
2023-04-24 04:31:19,098 - Detection -   train_loss = 12.126551918361498
2023-04-24 04:31:21,616 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 04:31:21,616 - Detection -   best_eval_score = 0
2023-04-24 04:31:21,616 - Detection -   eval_score = 0.25
2023-04-24 04:31:21,616 - Detection -   train_loss = 11.272676550823709
2023-04-24 04:31:51,851 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 04:31:51,851 - Detection -   best_eval_score = 0.25
2023-04-24 04:31:51,851 - Detection -   eval_score = 44.51
2023-04-24 04:31:51,851 - Detection -   train_loss = 10.318672636280889
2023-04-24 04:32:21,950 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 04:32:21,951 - Detection -   best_eval_score = 44.51
2023-04-24 04:32:21,951 - Detection -   eval_score = 62.53
2023-04-24 04:32:21,951 - Detection -   train_loss = 2.646935452585635
2023-04-24 04:32:51,949 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 04:32:51,949 - Detection -   best_eval_score = 62.53
2023-04-24 04:32:51,949 - Detection -   eval_score = 63.62
2023-04-24 04:32:51,949 - Detection -   train_loss = 1.684460479280223
2023-04-24 04:33:22,056 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 04:33:22,056 - Detection -   best_eval_score = 63.62
2023-04-24 04:33:22,056 - Detection -   eval_score = 63.52
2023-04-24 04:33:22,056 - Detection -   train_loss = 1.6253015943195508
2023-04-24 04:33:52,006 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 04:33:52,006 - Detection -   best_eval_score = 63.62
2023-04-24 04:33:52,006 - Detection -   eval_score = 63.01
2023-04-24 04:33:52,006 - Detection -   train_loss = 1.6584232423616492
2023-04-24 04:34:22,066 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 04:34:22,066 - Detection -   best_eval_score = 63.62
2023-04-24 04:34:22,066 - Detection -   eval_score = 63.42
2023-04-24 04:34:22,066 - Detection -   train_loss = 1.6154222332912942
2023-04-24 04:34:52,032 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 04:34:52,033 - Detection -   best_eval_score = 63.62
2023-04-24 04:34:52,033 - Detection -   eval_score = 63.06
2023-04-24 04:34:52,033 - Detection -   train_loss = 1.6595394870509272
2023-04-24 04:35:22,067 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 04:35:22,067 - Detection -   best_eval_score = 63.62
2023-04-24 04:35:22,067 - Detection -   eval_score = 63.32
2023-04-24 04:35:22,067 - Detection -   train_loss = 1.6523385669874109
2023-04-24 04:35:52,268 - Detection - ***** Epoch: 16: Eval results *****
2023-04-24 04:35:52,268 - Detection -   best_eval_score = 63.62
2023-04-24 04:35:52,268 - Detection -   eval_score = 63.5
2023-04-24 04:35:52,268 - Detection -   train_loss = 1.6790588420370351
2023-04-24 04:36:22,577 - Detection - ***** Epoch: 17: Eval results *****
2023-04-24 04:36:22,578 - Detection -   best_eval_score = 63.62
2023-04-24 04:36:22,578 - Detection -   eval_score = 62.62
2023-04-24 04:36:22,578 - Detection -   train_loss = 1.67433196047078
2023-04-24 04:36:52,536 - Detection - ***** Epoch: 18: Eval results *****
2023-04-24 04:36:52,536 - Detection -   best_eval_score = 63.62
2023-04-24 04:36:52,536 - Detection -   eval_score = 62.98
2023-04-24 04:36:52,536 - Detection -   train_loss = 1.6143713101096775
2023-04-24 04:37:22,847 - Detection - ***** Epoch: 19: Eval results *****
2023-04-24 04:37:22,847 - Detection -   best_eval_score = 63.62
2023-04-24 04:37:22,847 - Detection -   eval_score = 62.92
2023-04-24 04:37:22,847 - Detection -   train_loss = 1.629018783569336
2023-04-24 04:37:52,962 - Detection - ***** Epoch: 20: Eval results *****
2023-04-24 04:37:52,962 - Detection -   best_eval_score = 63.62
2023-04-24 04:37:52,962 - Detection -   eval_score = 63.19
2023-04-24 04:37:52,962 - Detection -   train_loss = 1.6119910634082297
2023-04-24 04:37:52,963 - Detection - Training Finished...
2023-04-24 04:37:52,963 - Detection - Testing begin...
2023-04-24 04:37:55,032 - Detection - ***** Test: Confusion Matrix *****
2023-04-24 04:37:55,032 - Detection - [[   4    0    0 ...    0    0   10]
 [   0    8    0 ...    0    0    3]
 [   0    0    8 ...    0    0    5]
 ...
 [   0    0    0 ...   13    0    6]
 [   0    0    0 ...    0    9    5]
 [   0    7    0 ...    5    0 1666]]
2023-04-24 04:37:55,032 - Detection - ***** Test results *****
2023-04-24 04:37:55,032 - Detection -   Acc = 71.5
2023-04-24 04:37:55,033 - Detection -   F1 = 56.795
2023-04-24 04:37:55,033 - Detection -   F1-known = 56.6039
2023-04-24 04:37:55,033 - Detection -   F1-open = 78.1976
2023-04-24 04:37:55,033 - Detection - Testing finished...
2023-04-24 04:37:55,033 - Detection - Results saved in results/results_ADB-BOOST-F-10.csv
2023-04-24 04:37:55,055 - Detection - Open Intent Detection Finished...
