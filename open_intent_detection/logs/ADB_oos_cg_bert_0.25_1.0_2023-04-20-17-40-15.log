2023-04-20 17:40:15,892 - Detection - Open Intent Detection Begin...
2023-04-20 17:40:15,892 - Detection - Parameters Initialization...
2023-04-20 17:40:15,893 - Detection - ============================== Params ==============================
2023-04-20 17:40:15,893 - Detection - type:	open_intent_detection
2023-04-20 17:40:15,893 - Detection - logger_name:	Detection
2023-04-20 17:40:15,893 - Detection - log_dir:	logs
2023-04-20 17:40:15,893 - Detection - dataset:	oos_cg
2023-04-20 17:40:15,893 - Detection - known_cls_ratio:	0.25
2023-04-20 17:40:15,893 - Detection - labeled_ratio:	1.0
2023-04-20 17:40:15,893 - Detection - method:	ADB
2023-04-20 17:40:15,893 - Detection - train:	True
2023-04-20 17:40:15,893 - Detection - pretrain:	True
2023-04-20 17:40:15,893 - Detection - save_model:	True
2023-04-20 17:40:15,893 - Detection - backbone:	bert
2023-04-20 17:40:15,893 - Detection - config_file_name:	ADB
2023-04-20 17:40:15,893 - Detection - seed:	3
2023-04-20 17:40:15,893 - Detection - gpu_id:	0
2023-04-20 17:40:15,893 - Detection - pipe_results_path:	pipe_results
2023-04-20 17:40:15,893 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-20 17:40:15,893 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-20 17:40:15,893 - Detection - model_dir:	models
2023-04-20 17:40:15,893 - Detection - load_pretrained_method:	None
2023-04-20 17:40:15,893 - Detection - result_dir:	results
2023-04-20 17:40:15,893 - Detection - results_file_name:	results_ADB.csv
2023-04-20 17:40:15,893 - Detection - save_results:	True
2023-04-20 17:40:15,893 - Detection - loss_fct:	CrossEntropyLoss
2023-04-20 17:40:15,893 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_cg_0.25_1.0_bert_3
2023-04-20 17:40:15,893 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_cg_0.25_1.0_bert_3/models
2023-04-20 17:40:15,893 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-20 17:40:15,893 - Detection - num_train_epochs:	100
2023-04-20 17:40:15,893 - Detection - num_labels:	None
2023-04-20 17:40:15,893 - Detection - max_seq_length:	None
2023-04-20 17:40:15,893 - Detection - freeze_backbone_parameters:	True
2023-04-20 17:40:15,893 - Detection - feat_dim:	768
2023-04-20 17:40:15,893 - Detection - warmup_proportion:	0.1
2023-04-20 17:40:15,893 - Detection - lr_boundary:	0.05
2023-04-20 17:40:15,893 - Detection - lr:	2e-05
2023-04-20 17:40:15,893 - Detection - activation:	relu
2023-04-20 17:40:15,893 - Detection - train_batch_size:	128
2023-04-20 17:40:15,893 - Detection - eval_batch_size:	64
2023-04-20 17:40:15,894 - Detection - test_batch_size:	64
2023-04-20 17:40:15,894 - Detection - wait_patient:	10
2023-04-20 17:40:15,894 - Detection - ============================== End Params ==============================
2023-04-20 17:40:15,894 - Detection - Data and Model Preparation...
2023-04-20 17:40:15,894 - Detection - The number of known intents is 38
2023-04-20 17:40:15,894 - Detection - Lists of known labels are: ['gas', 'application_status', 'current_location', 'change_volume', 'cancel', 'tell_joke', 'pto_request', 'balance', 'restaurant_suggestion', 'make_call', 'pto_balance', 'do_you_have_pets', 'recipe', 'improve_credit_score', 'weather', 'expiration_date', 'mpg', 'uber', 'smart_home', 'flight_status', 'todo_list', 'shopping_list_update', 'what_are_your_hobbies', 'no', 'are_you_a_bot', 'schedule_meeting', 'travel_suggestion', 'meal_suggestion', 'insurance', 'play_music', 'calories', 'change_user_name', 'w2', 'insurance_change', 'bill_due', 'cook_time', 'nutrition_info', 'find_phone']
2023-04-20 17:40:15,905 - Detection - Number of labeled training samples = 875
2023-04-20 17:40:15,905 - Detection - Number of unlabeled training samples = 2808
2023-04-20 17:40:15,909 - Detection - Number of evaluation samples = 443
2023-04-20 17:40:15,917 - Detection - Number of testing samples = 3632
2023-04-20 17:40:20,023 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-20 17:40:21,702 - Detection - Pre-training Begin...
2023-04-20 17:40:23,066 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 17:40:23,066 - Detection -   best_eval_score = 0
2023-04-20 17:40:23,067 - Detection -   eval_score = 3.61
2023-04-20 17:40:23,067 - Detection -   train_loss = 3.627011810030256
2023-04-20 17:40:23,926 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 17:40:23,926 - Detection -   best_eval_score = 3.61
2023-04-20 17:40:23,926 - Detection -   eval_score = 5.42
2023-04-20 17:40:23,926 - Detection -   train_loss = 3.615527663912092
2023-04-20 17:40:24,784 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 17:40:24,784 - Detection -   best_eval_score = 5.42
2023-04-20 17:40:24,784 - Detection -   eval_score = 8.35
2023-04-20 17:40:24,784 - Detection -   train_loss = 3.587361914770944
2023-04-20 17:40:25,649 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 17:40:25,649 - Detection -   best_eval_score = 8.35
2023-04-20 17:40:25,649 - Detection -   eval_score = 7.67
2023-04-20 17:40:25,649 - Detection -   train_loss = 3.5432303292410716
2023-04-20 17:40:26,506 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 17:40:26,506 - Detection -   best_eval_score = 8.35
2023-04-20 17:40:26,506 - Detection -   eval_score = 9.93
2023-04-20 17:40:26,506 - Detection -   train_loss = 3.476647002356393
2023-04-20 17:40:27,376 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 17:40:27,377 - Detection -   best_eval_score = 9.93
2023-04-20 17:40:27,377 - Detection -   eval_score = 11.29
2023-04-20 17:40:27,377 - Detection -   train_loss = 3.374396562576294
2023-04-20 17:40:28,252 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 17:40:28,252 - Detection -   best_eval_score = 11.29
2023-04-20 17:40:28,252 - Detection -   eval_score = 11.74
2023-04-20 17:40:28,252 - Detection -   train_loss = 3.2187884875706265
2023-04-20 17:40:29,111 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 17:40:29,111 - Detection -   best_eval_score = 11.74
2023-04-20 17:40:29,111 - Detection -   eval_score = 15.8
2023-04-20 17:40:29,111 - Detection -   train_loss = 2.962188584463937
2023-04-20 17:40:29,969 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 17:40:29,970 - Detection -   best_eval_score = 15.8
2023-04-20 17:40:29,970 - Detection -   eval_score = 22.12
2023-04-20 17:40:29,970 - Detection -   train_loss = 2.602723870958601
2023-04-20 17:40:30,933 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 17:40:30,933 - Detection -   best_eval_score = 22.12
2023-04-20 17:40:30,933 - Detection -   eval_score = 32.51
2023-04-20 17:40:30,933 - Detection -   train_loss = 2.184585298810686
2023-04-20 17:40:31,794 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 17:40:31,794 - Detection -   best_eval_score = 32.51
2023-04-20 17:40:31,794 - Detection -   eval_score = 42.21
2023-04-20 17:40:31,794 - Detection -   train_loss = 1.7628651005881173
2023-04-20 17:40:32,658 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 17:40:32,658 - Detection -   best_eval_score = 42.21
2023-04-20 17:40:32,658 - Detection -   eval_score = 53.72
2023-04-20 17:40:32,658 - Detection -   train_loss = 1.425259726388114
2023-04-20 17:40:33,531 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 17:40:33,532 - Detection -   best_eval_score = 53.72
2023-04-20 17:40:33,532 - Detection -   eval_score = 61.85
2023-04-20 17:40:33,532 - Detection -   train_loss = 1.1552628449031286
2023-04-20 17:40:34,462 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 17:40:34,462 - Detection -   best_eval_score = 61.85
2023-04-20 17:40:34,462 - Detection -   eval_score = 66.14
2023-04-20 17:40:34,462 - Detection -   train_loss = 0.940995591027396
2023-04-20 17:40:35,346 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 17:40:35,346 - Detection -   best_eval_score = 66.14
2023-04-20 17:40:35,346 - Detection -   eval_score = 69.98
2023-04-20 17:40:35,346 - Detection -   train_loss = 0.7704175795827594
2023-04-20 17:40:36,230 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 17:40:36,230 - Detection -   best_eval_score = 69.98
2023-04-20 17:40:36,230 - Detection -   eval_score = 72.23
2023-04-20 17:40:36,230 - Detection -   train_loss = 0.6424418091773987
2023-04-20 17:40:37,144 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 17:40:37,144 - Detection -   best_eval_score = 72.23
2023-04-20 17:40:37,144 - Detection -   eval_score = 74.72
2023-04-20 17:40:37,144 - Detection -   train_loss = 0.5395140988486153
2023-04-20 17:40:38,021 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 17:40:38,021 - Detection -   best_eval_score = 74.72
2023-04-20 17:40:38,021 - Detection -   eval_score = 76.3
2023-04-20 17:40:38,021 - Detection -   train_loss = 0.4515937396458217
2023-04-20 17:40:38,906 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 17:40:38,906 - Detection -   best_eval_score = 76.3
2023-04-20 17:40:38,906 - Detection -   eval_score = 77.43
2023-04-20 17:40:38,906 - Detection -   train_loss = 0.40085658856800627
2023-04-20 17:40:39,791 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 17:40:39,791 - Detection -   best_eval_score = 77.43
2023-04-20 17:40:39,791 - Detection -   eval_score = 79.01
2023-04-20 17:40:39,791 - Detection -   train_loss = 0.3437127470970154
2023-04-20 17:40:40,691 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 17:40:40,691 - Detection -   best_eval_score = 79.01
2023-04-20 17:40:40,691 - Detection -   eval_score = 79.68
2023-04-20 17:40:40,691 - Detection -   train_loss = 0.30406453354018076
2023-04-20 17:40:41,588 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 17:40:41,589 - Detection -   best_eval_score = 79.68
2023-04-20 17:40:41,589 - Detection -   eval_score = 80.59
2023-04-20 17:40:41,589 - Detection -   train_loss = 0.2764126594577517
2023-04-20 17:40:42,475 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 17:40:42,475 - Detection -   best_eval_score = 80.59
2023-04-20 17:40:42,475 - Detection -   eval_score = 81.49
2023-04-20 17:40:42,475 - Detection -   train_loss = 0.23875527722494944
2023-04-20 17:40:43,385 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 17:40:43,385 - Detection -   best_eval_score = 81.49
2023-04-20 17:40:43,385 - Detection -   eval_score = 81.94
2023-04-20 17:40:43,385 - Detection -   train_loss = 0.21299281077725546
2023-04-20 17:40:44,304 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 17:40:44,304 - Detection -   best_eval_score = 81.94
2023-04-20 17:40:44,304 - Detection -   eval_score = 82.84
2023-04-20 17:40:44,304 - Detection -   train_loss = 0.1937246663229806
2023-04-20 17:40:45,232 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 17:40:45,232 - Detection -   best_eval_score = 82.84
2023-04-20 17:40:45,232 - Detection -   eval_score = 82.84
2023-04-20 17:40:45,232 - Detection -   train_loss = 0.17425684843744552
2023-04-20 17:40:46,139 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 17:40:46,139 - Detection -   best_eval_score = 82.84
2023-04-20 17:40:46,139 - Detection -   eval_score = 83.3
2023-04-20 17:40:46,139 - Detection -   train_loss = 0.161797896027565
2023-04-20 17:40:47,048 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 17:40:47,048 - Detection -   best_eval_score = 83.3
2023-04-20 17:40:47,048 - Detection -   eval_score = 83.97
2023-04-20 17:40:47,048 - Detection -   train_loss = 0.1469854073865073
2023-04-20 17:40:47,964 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 17:40:47,964 - Detection -   best_eval_score = 83.97
2023-04-20 17:40:47,964 - Detection -   eval_score = 84.2
2023-04-20 17:40:47,964 - Detection -   train_loss = 0.1461953350475856
2023-04-20 17:40:48,905 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 17:40:48,905 - Detection -   best_eval_score = 84.2
2023-04-20 17:40:48,905 - Detection -   eval_score = 84.2
2023-04-20 17:40:48,905 - Detection -   train_loss = 0.12687980915818894
2023-04-20 17:40:49,852 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 17:40:49,852 - Detection -   best_eval_score = 84.2
2023-04-20 17:40:49,852 - Detection -   eval_score = 83.75
2023-04-20 17:40:49,852 - Detection -   train_loss = 0.12084761368376869
2023-04-20 17:40:50,757 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 17:40:50,758 - Detection -   best_eval_score = 84.2
2023-04-20 17:40:50,758 - Detection -   eval_score = 83.52
2023-04-20 17:40:50,758 - Detection -   train_loss = 0.10976109653711319
2023-04-20 17:40:51,662 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 17:40:51,662 - Detection -   best_eval_score = 84.2
2023-04-20 17:40:51,662 - Detection -   eval_score = 84.42
2023-04-20 17:40:51,662 - Detection -   train_loss = 0.10359791453395571
2023-04-20 17:40:52,580 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 17:40:52,580 - Detection -   best_eval_score = 84.42
2023-04-20 17:40:52,580 - Detection -   eval_score = 84.65
2023-04-20 17:40:52,580 - Detection -   train_loss = 0.0997023656964302
2023-04-20 17:40:53,495 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 17:40:53,495 - Detection -   best_eval_score = 84.65
2023-04-20 17:40:53,496 - Detection -   eval_score = 84.65
2023-04-20 17:40:53,496 - Detection -   train_loss = 0.09703119418450765
2023-04-20 17:40:54,400 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 17:40:54,400 - Detection -   best_eval_score = 84.65
2023-04-20 17:40:54,400 - Detection -   eval_score = 84.88
2023-04-20 17:40:54,401 - Detection -   train_loss = 0.08892946264573506
2023-04-20 17:40:55,321 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 17:40:55,321 - Detection -   best_eval_score = 84.88
2023-04-20 17:40:55,321 - Detection -   eval_score = 84.65
2023-04-20 17:40:55,321 - Detection -   train_loss = 0.09206445515155792
2023-04-20 17:40:56,234 - Detection - ***** Epoch: 38: Eval results *****
2023-04-20 17:40:56,234 - Detection -   best_eval_score = 84.88
2023-04-20 17:40:56,234 - Detection -   eval_score = 85.55
2023-04-20 17:40:56,234 - Detection -   train_loss = 0.08477214723825455
2023-04-20 17:40:57,160 - Detection - ***** Epoch: 39: Eval results *****
2023-04-20 17:40:57,160 - Detection -   best_eval_score = 85.55
2023-04-20 17:40:57,160 - Detection -   eval_score = 85.55
2023-04-20 17:40:57,161 - Detection -   train_loss = 0.07800806100879397
2023-04-20 17:40:58,073 - Detection - ***** Epoch: 40: Eval results *****
2023-04-20 17:40:58,073 - Detection -   best_eval_score = 85.55
2023-04-20 17:40:58,073 - Detection -   eval_score = 85.78
2023-04-20 17:40:58,073 - Detection -   train_loss = 0.07208848318883351
2023-04-20 17:40:59,003 - Detection - ***** Epoch: 41: Eval results *****
2023-04-20 17:40:59,004 - Detection -   best_eval_score = 85.78
2023-04-20 17:40:59,004 - Detection -   eval_score = 85.78
2023-04-20 17:40:59,004 - Detection -   train_loss = 0.07100911598120417
2023-04-20 17:40:59,916 - Detection - ***** Epoch: 42: Eval results *****
2023-04-20 17:40:59,916 - Detection -   best_eval_score = 85.78
2023-04-20 17:40:59,916 - Detection -   eval_score = 86.0
2023-04-20 17:40:59,916 - Detection -   train_loss = 0.07037826095308576
2023-04-20 17:41:00,937 - Detection - ***** Epoch: 43: Eval results *****
2023-04-20 17:41:00,937 - Detection -   best_eval_score = 86.0
2023-04-20 17:41:00,937 - Detection -   eval_score = 85.55
2023-04-20 17:41:00,938 - Detection -   train_loss = 0.06600143015384674
2023-04-20 17:41:01,849 - Detection - ***** Epoch: 44: Eval results *****
2023-04-20 17:41:01,849 - Detection -   best_eval_score = 86.0
2023-04-20 17:41:01,849 - Detection -   eval_score = 85.33
2023-04-20 17:41:01,849 - Detection -   train_loss = 0.06570791240249362
2023-04-20 17:41:02,758 - Detection - ***** Epoch: 45: Eval results *****
2023-04-20 17:41:02,759 - Detection -   best_eval_score = 86.0
2023-04-20 17:41:02,759 - Detection -   eval_score = 85.1
2023-04-20 17:41:02,759 - Detection -   train_loss = 0.060069607836859565
2023-04-20 17:41:03,677 - Detection - ***** Epoch: 46: Eval results *****
2023-04-20 17:41:03,678 - Detection -   best_eval_score = 86.0
2023-04-20 17:41:03,678 - Detection -   eval_score = 85.1
2023-04-20 17:41:03,678 - Detection -   train_loss = 0.06063538896186011
2023-04-20 17:41:04,596 - Detection - ***** Epoch: 47: Eval results *****
2023-04-20 17:41:04,596 - Detection -   best_eval_score = 86.0
2023-04-20 17:41:04,596 - Detection -   eval_score = 85.33
2023-04-20 17:41:04,596 - Detection -   train_loss = 0.05979673245123455
2023-04-20 17:41:05,507 - Detection - ***** Epoch: 48: Eval results *****
2023-04-20 17:41:05,507 - Detection -   best_eval_score = 86.0
2023-04-20 17:41:05,507 - Detection -   eval_score = 85.55
2023-04-20 17:41:05,507 - Detection -   train_loss = 0.058487465871231895
2023-04-20 17:41:06,444 - Detection - ***** Epoch: 49: Eval results *****
2023-04-20 17:41:06,444 - Detection -   best_eval_score = 86.0
2023-04-20 17:41:06,444 - Detection -   eval_score = 85.78
2023-04-20 17:41:06,444 - Detection -   train_loss = 0.05365612943257604
2023-04-20 17:41:07,356 - Detection - ***** Epoch: 50: Eval results *****
2023-04-20 17:41:07,356 - Detection -   best_eval_score = 86.0
2023-04-20 17:41:07,356 - Detection -   eval_score = 86.0
2023-04-20 17:41:07,356 - Detection -   train_loss = 0.05392106941768101
2023-04-20 17:41:08,265 - Detection - ***** Epoch: 51: Eval results *****
2023-04-20 17:41:08,266 - Detection -   best_eval_score = 86.0
2023-04-20 17:41:08,266 - Detection -   eval_score = 86.23
2023-04-20 17:41:08,266 - Detection -   train_loss = 0.054546626550810676
2023-04-20 17:41:09,191 - Detection - ***** Epoch: 52: Eval results *****
2023-04-20 17:41:09,191 - Detection -   best_eval_score = 86.23
2023-04-20 17:41:09,191 - Detection -   eval_score = 86.46
2023-04-20 17:41:09,191 - Detection -   train_loss = 0.05633611498134477
2023-04-20 17:41:10,108 - Detection - ***** Epoch: 53: Eval results *****
2023-04-20 17:41:10,108 - Detection -   best_eval_score = 86.46
2023-04-20 17:41:10,108 - Detection -   eval_score = 86.23
2023-04-20 17:41:10,108 - Detection -   train_loss = 0.05326908880046436
2023-04-20 17:41:11,016 - Detection - ***** Epoch: 54: Eval results *****
2023-04-20 17:41:11,016 - Detection -   best_eval_score = 86.46
2023-04-20 17:41:11,016 - Detection -   eval_score = 85.78
2023-04-20 17:41:11,016 - Detection -   train_loss = 0.049585913973195214
2023-04-20 17:41:11,931 - Detection - ***** Epoch: 55: Eval results *****
2023-04-20 17:41:11,931 - Detection -   best_eval_score = 86.46
2023-04-20 17:41:11,931 - Detection -   eval_score = 85.55
2023-04-20 17:41:11,931 - Detection -   train_loss = 0.04858686402440071
2023-04-20 17:41:12,841 - Detection - ***** Epoch: 56: Eval results *****
2023-04-20 17:41:12,841 - Detection -   best_eval_score = 86.46
2023-04-20 17:41:12,841 - Detection -   eval_score = 85.78
2023-04-20 17:41:12,841 - Detection -   train_loss = 0.04536637717059681
2023-04-20 17:41:13,751 - Detection - ***** Epoch: 57: Eval results *****
2023-04-20 17:41:13,751 - Detection -   best_eval_score = 86.46
2023-04-20 17:41:13,752 - Detection -   eval_score = 85.78
2023-04-20 17:41:13,752 - Detection -   train_loss = 0.049287404865026474
2023-04-20 17:41:14,660 - Detection - ***** Epoch: 58: Eval results *****
2023-04-20 17:41:14,660 - Detection -   best_eval_score = 86.46
2023-04-20 17:41:14,660 - Detection -   eval_score = 85.78
2023-04-20 17:41:14,660 - Detection -   train_loss = 0.04778548755816051
2023-04-20 17:41:15,578 - Detection - ***** Epoch: 59: Eval results *****
2023-04-20 17:41:15,578 - Detection -   best_eval_score = 86.46
2023-04-20 17:41:15,578 - Detection -   eval_score = 85.55
2023-04-20 17:41:15,578 - Detection -   train_loss = 0.04417571159345763
2023-04-20 17:41:16,485 - Detection - ***** Epoch: 60: Eval results *****
2023-04-20 17:41:16,485 - Detection -   best_eval_score = 86.46
2023-04-20 17:41:16,485 - Detection -   eval_score = 85.78
2023-04-20 17:41:16,485 - Detection -   train_loss = 0.045979567404304235
2023-04-20 17:41:17,395 - Detection - ***** Epoch: 61: Eval results *****
2023-04-20 17:41:17,395 - Detection -   best_eval_score = 86.46
2023-04-20 17:41:17,395 - Detection -   eval_score = 86.0
2023-04-20 17:41:17,395 - Detection -   train_loss = 0.04228027271372931
2023-04-20 17:41:18,300 - Detection - ***** Epoch: 62: Eval results *****
2023-04-20 17:41:18,300 - Detection -   best_eval_score = 86.46
2023-04-20 17:41:18,300 - Detection -   eval_score = 86.23
2023-04-20 17:41:18,300 - Detection -   train_loss = 0.040258007922342846
2023-04-20 17:41:18,300 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_cg_0.25_1.0_bert_3/models
2023-04-20 17:41:18,853 - Detection - Pre-training finished...
2023-04-20 17:41:18,853 - Detection - Training Begin...
2023-04-20 17:41:20,301 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 17:41:20,301 - Detection -   best_eval_score = 0
2023-04-20 17:41:20,301 - Detection -   eval_score = 0.0
2023-04-20 17:41:20,301 - Detection -   train_loss = 9.2670042855399
2023-04-20 17:41:21,247 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 17:41:21,247 - Detection -   best_eval_score = 0
2023-04-20 17:41:21,248 - Detection -   eval_score = 0.0
2023-04-20 17:41:21,248 - Detection -   train_loss = 9.059349196297783
2023-04-20 17:41:22,153 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 17:41:22,153 - Detection -   best_eval_score = 0
2023-04-20 17:41:22,153 - Detection -   eval_score = 0.0
2023-04-20 17:41:22,153 - Detection -   train_loss = 8.930695125034877
2023-04-20 17:41:23,069 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 17:41:23,070 - Detection -   best_eval_score = 0
2023-04-20 17:41:23,070 - Detection -   eval_score = 0.0
2023-04-20 17:41:23,070 - Detection -   train_loss = 8.669092995779854
2023-04-20 17:41:24,003 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 17:41:24,003 - Detection -   best_eval_score = 0
2023-04-20 17:41:24,004 - Detection -   eval_score = 0.0
2023-04-20 17:41:24,004 - Detection -   train_loss = 8.397815568106514
2023-04-20 17:41:24,917 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 17:41:24,917 - Detection -   best_eval_score = 0
2023-04-20 17:41:24,917 - Detection -   eval_score = 0.0
2023-04-20 17:41:24,917 - Detection -   train_loss = 8.109997068132673
2023-04-20 17:41:25,840 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 17:41:25,840 - Detection -   best_eval_score = 0
2023-04-20 17:41:25,840 - Detection -   eval_score = 0.0
2023-04-20 17:41:25,840 - Detection -   train_loss = 7.772359575544085
2023-04-20 17:41:26,750 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 17:41:26,750 - Detection -   best_eval_score = 0
2023-04-20 17:41:26,750 - Detection -   eval_score = 0.0
2023-04-20 17:41:26,750 - Detection -   train_loss = 7.47437926701137
2023-04-20 17:41:27,655 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 17:41:27,655 - Detection -   best_eval_score = 0
2023-04-20 17:41:27,655 - Detection -   eval_score = 0.0
2023-04-20 17:41:27,655 - Detection -   train_loss = 7.175417491367885
2023-04-20 17:41:28,565 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 17:41:28,565 - Detection -   best_eval_score = 0
2023-04-20 17:41:28,565 - Detection -   eval_score = 0.0
2023-04-20 17:41:28,565 - Detection -   train_loss = 6.8371220997401645
2023-04-20 17:41:29,484 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 17:41:29,484 - Detection -   best_eval_score = 0
2023-04-20 17:41:29,484 - Detection -   eval_score = 1.25
2023-04-20 17:41:29,484 - Detection -   train_loss = 6.43938194002424
2023-04-20 17:41:30,415 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 17:41:30,415 - Detection -   best_eval_score = 1.25
2023-04-20 17:41:30,415 - Detection -   eval_score = 1.93
2023-04-20 17:41:30,415 - Detection -   train_loss = 6.088828154972622
2023-04-20 17:41:31,333 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 17:41:31,333 - Detection -   best_eval_score = 1.93
2023-04-20 17:41:31,333 - Detection -   eval_score = 3.73
2023-04-20 17:41:31,333 - Detection -   train_loss = 5.716192517961774
2023-04-20 17:41:32,243 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 17:41:32,243 - Detection -   best_eval_score = 3.73
2023-04-20 17:41:32,243 - Detection -   eval_score = 5.25
2023-04-20 17:41:32,243 - Detection -   train_loss = 5.410305500030518
2023-04-20 17:41:33,163 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 17:41:33,163 - Detection -   best_eval_score = 5.25
2023-04-20 17:41:33,163 - Detection -   eval_score = 6.13
2023-04-20 17:41:33,163 - Detection -   train_loss = 5.013850757053921
2023-04-20 17:41:34,073 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 17:41:34,074 - Detection -   best_eval_score = 6.13
2023-04-20 17:41:34,074 - Detection -   eval_score = 8.98
2023-04-20 17:41:34,074 - Detection -   train_loss = 4.688191005161831
2023-04-20 17:41:34,985 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 17:41:34,985 - Detection -   best_eval_score = 8.98
2023-04-20 17:41:34,985 - Detection -   eval_score = 14.3
2023-04-20 17:41:34,985 - Detection -   train_loss = 4.331118719918387
2023-04-20 17:41:35,933 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 17:41:35,933 - Detection -   best_eval_score = 14.3
2023-04-20 17:41:35,933 - Detection -   eval_score = 18.15
2023-04-20 17:41:35,933 - Detection -   train_loss = 3.9708241053989957
2023-04-20 17:41:36,841 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 17:41:36,841 - Detection -   best_eval_score = 18.15
2023-04-20 17:41:36,841 - Detection -   eval_score = 20.62
2023-04-20 17:41:36,841 - Detection -   train_loss = 3.5864085810525075
2023-04-20 17:41:37,750 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 17:41:37,750 - Detection -   best_eval_score = 20.62
2023-04-20 17:41:37,750 - Detection -   eval_score = 25.33
2023-04-20 17:41:37,750 - Detection -   train_loss = 3.220987456185477
2023-04-20 17:41:38,661 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 17:41:38,661 - Detection -   best_eval_score = 25.33
2023-04-20 17:41:38,661 - Detection -   eval_score = 29.66
2023-04-20 17:41:38,661 - Detection -   train_loss = 2.8678761890956332
2023-04-20 17:41:39,566 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 17:41:39,566 - Detection -   best_eval_score = 29.66
2023-04-20 17:41:39,566 - Detection -   eval_score = 32.73
2023-04-20 17:41:39,566 - Detection -   train_loss = 2.5971841471535817
2023-04-20 17:41:40,468 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 17:41:40,468 - Detection -   best_eval_score = 32.73
2023-04-20 17:41:40,468 - Detection -   eval_score = 37.21
2023-04-20 17:41:40,468 - Detection -   train_loss = 2.315898929323469
2023-04-20 17:41:41,376 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 17:41:41,376 - Detection -   best_eval_score = 37.21
2023-04-20 17:41:41,376 - Detection -   eval_score = 40.83
2023-04-20 17:41:41,376 - Detection -   train_loss = 1.9885337012154716
2023-04-20 17:41:42,276 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 17:41:42,276 - Detection -   best_eval_score = 40.83
2023-04-20 17:41:42,276 - Detection -   eval_score = 44.62
2023-04-20 17:41:42,276 - Detection -   train_loss = 1.7210368428911482
2023-04-20 17:41:43,183 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 17:41:43,183 - Detection -   best_eval_score = 44.62
2023-04-20 17:41:43,183 - Detection -   eval_score = 49.03
2023-04-20 17:41:43,183 - Detection -   train_loss = 1.5346042598996843
2023-04-20 17:41:44,082 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 17:41:44,082 - Detection -   best_eval_score = 49.03
2023-04-20 17:41:44,082 - Detection -   eval_score = 51.24
2023-04-20 17:41:44,082 - Detection -   train_loss = 1.3625472784042358
2023-04-20 17:41:44,985 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 17:41:44,985 - Detection -   best_eval_score = 51.24
2023-04-20 17:41:44,985 - Detection -   eval_score = 53.43
2023-04-20 17:41:44,985 - Detection -   train_loss = 1.231036799294608
2023-04-20 17:41:45,891 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 17:41:45,891 - Detection -   best_eval_score = 53.43
2023-04-20 17:41:45,891 - Detection -   eval_score = 54.89
2023-04-20 17:41:45,891 - Detection -   train_loss = 1.1794178996767317
2023-04-20 17:41:46,798 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 17:41:46,798 - Detection -   best_eval_score = 54.89
2023-04-20 17:41:46,798 - Detection -   eval_score = 56.97
2023-04-20 17:41:46,798 - Detection -   train_loss = 1.077120644705636
2023-04-20 17:41:47,700 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 17:41:47,701 - Detection -   best_eval_score = 56.97
2023-04-20 17:41:47,701 - Detection -   eval_score = 58.58
2023-04-20 17:41:47,701 - Detection -   train_loss = 0.9908390470913478
2023-04-20 17:41:48,611 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 17:41:48,611 - Detection -   best_eval_score = 58.58
2023-04-20 17:41:48,611 - Detection -   eval_score = 60.02
2023-04-20 17:41:48,611 - Detection -   train_loss = 1.0059149946485246
2023-04-20 17:41:49,512 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 17:41:49,513 - Detection -   best_eval_score = 60.02
2023-04-20 17:41:49,513 - Detection -   eval_score = 60.69
2023-04-20 17:41:49,513 - Detection -   train_loss = 0.952032881123679
2023-04-20 17:41:50,427 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 17:41:50,427 - Detection -   best_eval_score = 60.69
2023-04-20 17:41:50,427 - Detection -   eval_score = 61.33
2023-04-20 17:41:50,427 - Detection -   train_loss = 0.9308198605264936
2023-04-20 17:41:51,333 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 17:41:51,333 - Detection -   best_eval_score = 61.33
2023-04-20 17:41:51,333 - Detection -   eval_score = 61.91
2023-04-20 17:41:51,333 - Detection -   train_loss = 0.9250099062919617
2023-04-20 17:41:52,242 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 17:41:52,242 - Detection -   best_eval_score = 61.91
2023-04-20 17:41:52,242 - Detection -   eval_score = 61.91
2023-04-20 17:41:52,242 - Detection -   train_loss = 0.9427437356540135
2023-04-20 17:41:53,140 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 17:41:53,140 - Detection -   best_eval_score = 61.91
2023-04-20 17:41:53,140 - Detection -   eval_score = 62.39
2023-04-20 17:41:53,140 - Detection -   train_loss = 0.9628823229244777
2023-04-20 17:41:54,050 - Detection - ***** Epoch: 38: Eval results *****
2023-04-20 17:41:54,050 - Detection -   best_eval_score = 62.39
2023-04-20 17:41:54,050 - Detection -   eval_score = 62.37
2023-04-20 17:41:54,050 - Detection -   train_loss = 0.9658483011381966
2023-04-20 17:41:54,960 - Detection - ***** Epoch: 39: Eval results *****
2023-04-20 17:41:54,960 - Detection -   best_eval_score = 62.39
2023-04-20 17:41:54,960 - Detection -   eval_score = 62.27
2023-04-20 17:41:54,960 - Detection -   train_loss = 0.9144459877695356
2023-04-20 17:41:55,872 - Detection - ***** Epoch: 40: Eval results *****
2023-04-20 17:41:55,872 - Detection -   best_eval_score = 62.39
2023-04-20 17:41:55,872 - Detection -   eval_score = 61.85
2023-04-20 17:41:55,872 - Detection -   train_loss = 0.9439376762935093
2023-04-20 17:41:56,777 - Detection - ***** Epoch: 41: Eval results *****
2023-04-20 17:41:56,777 - Detection -   best_eval_score = 62.39
2023-04-20 17:41:56,777 - Detection -   eval_score = 61.85
2023-04-20 17:41:56,778 - Detection -   train_loss = 0.9490471993173871
2023-04-20 17:41:57,682 - Detection - ***** Epoch: 42: Eval results *****
2023-04-20 17:41:57,682 - Detection -   best_eval_score = 62.39
2023-04-20 17:41:57,682 - Detection -   eval_score = 62.28
2023-04-20 17:41:57,682 - Detection -   train_loss = 0.9463393007005964
2023-04-20 17:41:58,587 - Detection - ***** Epoch: 43: Eval results *****
2023-04-20 17:41:58,587 - Detection -   best_eval_score = 62.39
2023-04-20 17:41:58,587 - Detection -   eval_score = 62.46
2023-04-20 17:41:58,587 - Detection -   train_loss = 0.9233740993908474
2023-04-20 17:41:59,489 - Detection - ***** Epoch: 44: Eval results *****
2023-04-20 17:41:59,489 - Detection -   best_eval_score = 62.46
2023-04-20 17:41:59,489 - Detection -   eval_score = 62.42
2023-04-20 17:41:59,489 - Detection -   train_loss = 0.949780992099217
2023-04-20 17:42:00,395 - Detection - ***** Epoch: 45: Eval results *****
2023-04-20 17:42:00,395 - Detection -   best_eval_score = 62.46
2023-04-20 17:42:00,395 - Detection -   eval_score = 62.36
2023-04-20 17:42:00,395 - Detection -   train_loss = 0.9504145894731794
2023-04-20 17:42:01,296 - Detection - ***** Epoch: 46: Eval results *****
2023-04-20 17:42:01,297 - Detection -   best_eval_score = 62.46
2023-04-20 17:42:01,297 - Detection -   eval_score = 62.17
2023-04-20 17:42:01,297 - Detection -   train_loss = 0.9075449194226947
2023-04-20 17:42:02,196 - Detection - ***** Epoch: 47: Eval results *****
2023-04-20 17:42:02,196 - Detection -   best_eval_score = 62.46
2023-04-20 17:42:02,196 - Detection -   eval_score = 62.43
2023-04-20 17:42:02,196 - Detection -   train_loss = 0.9198679583413261
2023-04-20 17:42:03,101 - Detection - ***** Epoch: 48: Eval results *****
2023-04-20 17:42:03,101 - Detection -   best_eval_score = 62.46
2023-04-20 17:42:03,102 - Detection -   eval_score = 62.54
2023-04-20 17:42:03,102 - Detection -   train_loss = 0.9694620881761823
2023-04-20 17:42:04,006 - Detection - ***** Epoch: 49: Eval results *****
2023-04-20 17:42:04,006 - Detection -   best_eval_score = 62.54
2023-04-20 17:42:04,006 - Detection -   eval_score = 62.85
2023-04-20 17:42:04,006 - Detection -   train_loss = 0.9304481233869281
2023-04-20 17:42:04,905 - Detection - ***** Epoch: 50: Eval results *****
2023-04-20 17:42:04,905 - Detection -   best_eval_score = 62.85
2023-04-20 17:42:04,905 - Detection -   eval_score = 63.25
2023-04-20 17:42:04,905 - Detection -   train_loss = 0.91903156042099
2023-04-20 17:42:05,845 - Detection - ***** Epoch: 51: Eval results *****
2023-04-20 17:42:05,845 - Detection -   best_eval_score = 63.25
2023-04-20 17:42:05,845 - Detection -   eval_score = 63.12
2023-04-20 17:42:05,845 - Detection -   train_loss = 0.9553445407322475
2023-04-20 17:42:06,752 - Detection - ***** Epoch: 52: Eval results *****
2023-04-20 17:42:06,752 - Detection -   best_eval_score = 63.25
2023-04-20 17:42:06,752 - Detection -   eval_score = 63.2
2023-04-20 17:42:06,752 - Detection -   train_loss = 0.9463634490966797
2023-04-20 17:42:07,655 - Detection - ***** Epoch: 53: Eval results *****
2023-04-20 17:42:07,655 - Detection -   best_eval_score = 63.25
2023-04-20 17:42:07,655 - Detection -   eval_score = 62.59
2023-04-20 17:42:07,655 - Detection -   train_loss = 0.9279313513210842
2023-04-20 17:42:08,562 - Detection - ***** Epoch: 54: Eval results *****
2023-04-20 17:42:08,562 - Detection -   best_eval_score = 63.25
2023-04-20 17:42:08,563 - Detection -   eval_score = 62.5
2023-04-20 17:42:08,563 - Detection -   train_loss = 0.9340040598596845
2023-04-20 17:42:09,466 - Detection - ***** Epoch: 55: Eval results *****
2023-04-20 17:42:09,466 - Detection -   best_eval_score = 63.25
2023-04-20 17:42:09,466 - Detection -   eval_score = 62.21
2023-04-20 17:42:09,466 - Detection -   train_loss = 0.9440370287214007
2023-04-20 17:42:10,366 - Detection - ***** Epoch: 56: Eval results *****
2023-04-20 17:42:10,366 - Detection -   best_eval_score = 63.25
2023-04-20 17:42:10,366 - Detection -   eval_score = 62.21
2023-04-20 17:42:10,366 - Detection -   train_loss = 0.9409842406000409
2023-04-20 17:42:11,269 - Detection - ***** Epoch: 57: Eval results *****
2023-04-20 17:42:11,269 - Detection -   best_eval_score = 63.25
2023-04-20 17:42:11,269 - Detection -   eval_score = 61.63
2023-04-20 17:42:11,269 - Detection -   train_loss = 0.9530688779694694
2023-04-20 17:42:12,168 - Detection - ***** Epoch: 58: Eval results *****
2023-04-20 17:42:12,168 - Detection -   best_eval_score = 63.25
2023-04-20 17:42:12,168 - Detection -   eval_score = 61.84
2023-04-20 17:42:12,168 - Detection -   train_loss = 0.9707317181995937
2023-04-20 17:42:13,072 - Detection - ***** Epoch: 59: Eval results *****
2023-04-20 17:42:13,072 - Detection -   best_eval_score = 63.25
2023-04-20 17:42:13,072 - Detection -   eval_score = 61.75
2023-04-20 17:42:13,072 - Detection -   train_loss = 0.9785980241639274
2023-04-20 17:42:13,972 - Detection - ***** Epoch: 60: Eval results *****
2023-04-20 17:42:13,973 - Detection -   best_eval_score = 63.25
2023-04-20 17:42:13,973 - Detection -   eval_score = 62.52
2023-04-20 17:42:13,973 - Detection -   train_loss = 0.9538885695593697
2023-04-20 17:42:13,974 - Detection - Training Finished...
2023-04-20 17:42:13,975 - Detection - Testing begin...
2023-04-20 17:42:16,259 - Detection - ***** Test: Confusion Matrix *****
2023-04-20 17:42:16,259 - Detection - [[   9    0    0 ...    0    0    6]
 [   0    9    0 ...    0    0   10]
 [   0    0   19 ...    0    0    2]
 ...
 [   0    0    0 ...   10    0   15]
 [   0    0    0 ...    0    8    1]
 [   8    7    9 ...    6    1 2657]]
2023-04-20 17:42:16,259 - Detection - ***** Test results *****
2023-04-20 17:42:16,259 - Detection -   Acc = 82.57
2023-04-20 17:42:16,259 - Detection -   F1 = 50.8293
2023-04-20 17:42:16,259 - Detection -   F1-known = 49.8087
2023-04-20 17:42:16,259 - Detection -   F1-open = 89.6121
2023-04-20 17:42:16,259 - Detection - Testing finished...
2023-04-20 17:42:16,259 - Detection - Results saved in results/results_ADB.csv
2023-04-20 17:42:16,279 - Detection - Open Intent Detection Finished...
