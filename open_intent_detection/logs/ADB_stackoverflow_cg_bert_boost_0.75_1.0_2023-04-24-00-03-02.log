2023-04-24 00:03:02,415 - Detection - Open Intent Detection Begin...
2023-04-24 00:03:02,415 - Detection - Parameters Initialization...
2023-04-24 00:03:02,415 - Detection - ============================== Params ==============================
2023-04-24 00:03:02,415 - Detection - type:	open_intent_detection
2023-04-24 00:03:02,415 - Detection - logger_name:	Detection
2023-04-24 00:03:02,415 - Detection - log_dir:	logs
2023-04-24 00:03:02,415 - Detection - dataset:	stackoverflow_cg
2023-04-24 00:03:02,415 - Detection - known_cls_ratio:	0.75
2023-04-24 00:03:02,416 - Detection - labeled_ratio:	1.0
2023-04-24 00:03:02,416 - Detection - method:	ADB
2023-04-24 00:03:02,416 - Detection - train:	True
2023-04-24 00:03:02,416 - Detection - pretrain:	True
2023-04-24 00:03:02,416 - Detection - save_model:	False
2023-04-24 00:03:02,416 - Detection - backbone:	bert_boost
2023-04-24 00:03:02,416 - Detection - config_file_name:	ADB
2023-04-24 00:03:02,416 - Detection - seed:	6
2023-04-24 00:03:02,416 - Detection - gpu_id:	0
2023-04-24 00:03:02,416 - Detection - pipe_results_path:	pipe_results
2023-04-24 00:03:02,416 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-24 00:03:02,416 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-24 00:03:02,416 - Detection - model_dir:	models
2023-04-24 00:03:02,416 - Detection - load_pretrained_method:	None
2023-04-24 00:03:02,416 - Detection - result_dir:	results
2023-04-24 00:03:02,416 - Detection - results_file_name:	results_ADB-BOOST-F-4.csv
2023-04-24 00:03:02,416 - Detection - save_results:	True
2023-04-24 00:03:02,416 - Detection - loss_fct:	CrossEntropyLoss
2023-04-24 00:03:02,416 - Detection - boost_method:	F-4
2023-04-24 00:03:02,416 - Detection - boost_start_score:	0.0
2023-04-24 00:03:02,416 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.75_1.0_bert_boost_6
2023-04-24 00:03:02,416 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.75_1.0_bert_boost_6/models
2023-04-24 00:03:02,416 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-24 00:03:02,416 - Detection - num_train_epochs:	100
2023-04-24 00:03:02,416 - Detection - num_labels:	None
2023-04-24 00:03:02,416 - Detection - max_seq_length:	None
2023-04-24 00:03:02,416 - Detection - freeze_backbone_parameters:	True
2023-04-24 00:03:02,416 - Detection - feat_dim:	768
2023-04-24 00:03:02,416 - Detection - warmup_proportion:	0.1
2023-04-24 00:03:02,416 - Detection - lr_boundary:	0.05
2023-04-24 00:03:02,416 - Detection - lr:	2e-05
2023-04-24 00:03:02,416 - Detection - activation:	relu
2023-04-24 00:03:02,416 - Detection - train_batch_size:	128
2023-04-24 00:03:02,416 - Detection - eval_batch_size:	64
2023-04-24 00:03:02,416 - Detection - test_batch_size:	64
2023-04-24 00:03:02,416 - Detection - wait_patient:	10
2023-04-24 00:03:02,416 - Detection - ============================== End Params ==============================
2023-04-24 00:03:02,416 - Detection - Data and Model Preparation...
2023-04-24 00:03:02,417 - Detection - The number of known intents is 15
2023-04-24 00:03:02,417 - Detection - Lists of known labels are: ['svn', 'hibernate', 'excel', 'haskell', 'linq', 'bash', 'sharepoint', 'scala', 'drupal', 'oracle', 'osx', 'apache', 'visual-studio', 'ajax', 'spring']
2023-04-24 00:03:02,426 - Detection - Number of labeled training samples = 2012
2023-04-24 00:03:02,426 - Detection - Number of unlabeled training samples = 779
2023-04-24 00:03:02,429 - Detection - Number of evaluation samples = 1076
2023-04-24 00:03:02,434 - Detection - Number of testing samples = 2905
2023-04-24 00:03:06,459 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-24 00:03:08,155 - Detection - Pre-training Begin...
2023-04-24 00:03:10,891 - Detection - ***** Epoch: 1: Eval results *****
2023-04-24 00:03:10,891 - Detection -   best_eval_score = 0
2023-04-24 00:03:10,891 - Detection -   eval_score = 7.99
2023-04-24 00:03:10,891 - Detection -   train_loss = 2.7094583362340927
2023-04-24 00:03:22,341 - Detection - ***** Epoch: 2: Eval results *****
2023-04-24 00:03:22,341 - Detection -   best_eval_score = 7.99
2023-04-24 00:03:22,341 - Detection -   eval_score = 5.86
2023-04-24 00:03:22,341 - Detection -   train_loss = 2.6947500705718994
2023-04-24 00:03:33,603 - Detection - ***** Epoch: 3: Eval results *****
2023-04-24 00:03:33,603 - Detection -   best_eval_score = 7.99
2023-04-24 00:03:33,603 - Detection -   eval_score = 43.03
2023-04-24 00:03:33,603 - Detection -   train_loss = 2.5611800849437714
2023-04-24 00:03:44,994 - Detection - ***** Epoch: 4: Eval results *****
2023-04-24 00:03:44,994 - Detection -   best_eval_score = 43.03
2023-04-24 00:03:44,994 - Detection -   eval_score = 68.77
2023-04-24 00:03:44,994 - Detection -   train_loss = 2.076873853802681
2023-04-24 00:03:56,324 - Detection - ***** Epoch: 5: Eval results *****
2023-04-24 00:03:56,324 - Detection -   best_eval_score = 68.77
2023-04-24 00:03:56,324 - Detection -   eval_score = 77.23
2023-04-24 00:03:56,324 - Detection -   train_loss = 1.434580385684967
2023-04-24 00:04:07,767 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 00:04:07,767 - Detection -   best_eval_score = 77.23
2023-04-24 00:04:07,767 - Detection -   eval_score = 79.09
2023-04-24 00:04:07,767 - Detection -   train_loss = 1.0482860431075096
2023-04-24 00:04:19,262 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 00:04:19,262 - Detection -   best_eval_score = 79.09
2023-04-24 00:04:19,262 - Detection -   eval_score = 80.67
2023-04-24 00:04:19,262 - Detection -   train_loss = 0.8437897227704525
2023-04-24 00:04:30,592 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 00:04:30,593 - Detection -   best_eval_score = 80.67
2023-04-24 00:04:30,593 - Detection -   eval_score = 81.04
2023-04-24 00:04:30,593 - Detection -   train_loss = 0.7423691377043724
2023-04-24 00:04:42,149 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 00:04:42,149 - Detection -   best_eval_score = 81.04
2023-04-24 00:04:42,149 - Detection -   eval_score = 81.23
2023-04-24 00:04:42,149 - Detection -   train_loss = 0.6448246594518423
2023-04-24 00:04:53,500 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 00:04:53,500 - Detection -   best_eval_score = 81.23
2023-04-24 00:04:53,500 - Detection -   eval_score = 81.88
2023-04-24 00:04:53,500 - Detection -   train_loss = 0.5318201947957277
2023-04-24 00:05:05,047 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 00:05:05,047 - Detection -   best_eval_score = 81.88
2023-04-24 00:05:05,047 - Detection -   eval_score = 81.32
2023-04-24 00:05:05,047 - Detection -   train_loss = 0.44583475962281227
2023-04-24 00:05:16,393 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 00:05:16,393 - Detection -   best_eval_score = 81.88
2023-04-24 00:05:16,393 - Detection -   eval_score = 81.6
2023-04-24 00:05:16,393 - Detection -   train_loss = 0.3844430949538946
2023-04-24 00:05:27,908 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 00:05:27,908 - Detection -   best_eval_score = 81.88
2023-04-24 00:05:27,908 - Detection -   eval_score = 81.51
2023-04-24 00:05:27,908 - Detection -   train_loss = 0.3349772226065397
2023-04-24 00:05:39,378 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 00:05:39,378 - Detection -   best_eval_score = 81.88
2023-04-24 00:05:39,378 - Detection -   eval_score = 82.53
2023-04-24 00:05:39,378 - Detection -   train_loss = 0.276530047878623
2023-04-24 00:05:50,769 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 00:05:50,769 - Detection -   best_eval_score = 82.53
2023-04-24 00:05:50,769 - Detection -   eval_score = 81.41
2023-04-24 00:05:50,769 - Detection -   train_loss = 0.24157275259494781
2023-04-24 00:06:02,229 - Detection - ***** Epoch: 16: Eval results *****
2023-04-24 00:06:02,229 - Detection -   best_eval_score = 82.53
2023-04-24 00:06:02,229 - Detection -   eval_score = 81.78
2023-04-24 00:06:02,229 - Detection -   train_loss = 0.1917856279760599
2023-04-24 00:06:13,540 - Detection - ***** Epoch: 17: Eval results *****
2023-04-24 00:06:13,540 - Detection -   best_eval_score = 82.53
2023-04-24 00:06:13,540 - Detection -   eval_score = 82.06
2023-04-24 00:06:13,540 - Detection -   train_loss = 0.17541769798845053
2023-04-24 00:06:25,027 - Detection - ***** Epoch: 18: Eval results *****
2023-04-24 00:06:25,027 - Detection -   best_eval_score = 82.53
2023-04-24 00:06:25,027 - Detection -   eval_score = 82.25
2023-04-24 00:06:25,027 - Detection -   train_loss = 0.15117760840803385
2023-04-24 00:06:36,365 - Detection - ***** Epoch: 19: Eval results *****
2023-04-24 00:06:36,365 - Detection -   best_eval_score = 82.53
2023-04-24 00:06:36,365 - Detection -   eval_score = 82.06
2023-04-24 00:06:36,365 - Detection -   train_loss = 0.1391837545670569
2023-04-24 00:06:47,807 - Detection - ***** Epoch: 20: Eval results *****
2023-04-24 00:06:47,807 - Detection -   best_eval_score = 82.53
2023-04-24 00:06:47,807 - Detection -   eval_score = 82.81
2023-04-24 00:06:47,807 - Detection -   train_loss = 0.127693900372833
2023-04-24 00:06:59,227 - Detection - ***** Epoch: 21: Eval results *****
2023-04-24 00:06:59,227 - Detection -   best_eval_score = 82.81
2023-04-24 00:06:59,227 - Detection -   eval_score = 82.71
2023-04-24 00:06:59,227 - Detection -   train_loss = 0.11186495702713728
2023-04-24 00:07:10,654 - Detection - ***** Epoch: 22: Eval results *****
2023-04-24 00:07:10,654 - Detection -   best_eval_score = 82.81
2023-04-24 00:07:10,654 - Detection -   eval_score = 81.88
2023-04-24 00:07:10,654 - Detection -   train_loss = 0.10908934916369617
2023-04-24 00:07:22,114 - Detection - ***** Epoch: 23: Eval results *****
2023-04-24 00:07:22,114 - Detection -   best_eval_score = 82.81
2023-04-24 00:07:22,114 - Detection -   eval_score = 81.97
2023-04-24 00:07:22,114 - Detection -   train_loss = 0.08320772368460894
2023-04-24 00:07:33,522 - Detection - ***** Epoch: 24: Eval results *****
2023-04-24 00:07:33,522 - Detection -   best_eval_score = 82.81
2023-04-24 00:07:33,522 - Detection -   eval_score = 81.88
2023-04-24 00:07:33,522 - Detection -   train_loss = 0.07597878738306463
2023-04-24 00:07:45,014 - Detection - ***** Epoch: 25: Eval results *****
2023-04-24 00:07:45,014 - Detection -   best_eval_score = 82.81
2023-04-24 00:07:45,014 - Detection -   eval_score = 82.43
2023-04-24 00:07:45,014 - Detection -   train_loss = 0.06564545119181275
2023-04-24 00:07:56,442 - Detection - ***** Epoch: 26: Eval results *****
2023-04-24 00:07:56,443 - Detection -   best_eval_score = 82.81
2023-04-24 00:07:56,443 - Detection -   eval_score = 82.25
2023-04-24 00:07:56,443 - Detection -   train_loss = 0.06177927693352103
2023-04-24 00:08:07,929 - Detection - ***** Epoch: 27: Eval results *****
2023-04-24 00:08:07,929 - Detection -   best_eval_score = 82.81
2023-04-24 00:08:07,929 - Detection -   eval_score = 81.88
2023-04-24 00:08:07,929 - Detection -   train_loss = 0.060897139832377434
2023-04-24 00:08:19,279 - Detection - ***** Epoch: 28: Eval results *****
2023-04-24 00:08:19,279 - Detection -   best_eval_score = 82.81
2023-04-24 00:08:19,279 - Detection -   eval_score = 82.53
2023-04-24 00:08:19,279 - Detection -   train_loss = 0.0602218764834106
2023-04-24 00:08:30,787 - Detection - ***** Epoch: 29: Eval results *****
2023-04-24 00:08:30,787 - Detection -   best_eval_score = 82.81
2023-04-24 00:08:30,787 - Detection -   eval_score = 82.06
2023-04-24 00:08:30,787 - Detection -   train_loss = 0.05951429181732237
2023-04-24 00:08:42,153 - Detection - ***** Epoch: 30: Eval results *****
2023-04-24 00:08:42,153 - Detection -   best_eval_score = 82.81
2023-04-24 00:08:42,153 - Detection -   eval_score = 81.88
2023-04-24 00:08:42,153 - Detection -   train_loss = 0.050715479999780655
2023-04-24 00:08:42,153 - Detection - Pre-training finished...
2023-04-24 00:08:42,154 - Detection - Training Begin...
2023-04-24 00:08:45,372 - Detection - ***** Epoch: 1: Eval results *****
2023-04-24 00:08:45,372 - Detection -   best_eval_score = 0
2023-04-24 00:08:45,372 - Detection -   eval_score = 0.0
2023-04-24 00:08:45,372 - Detection -   train_loss = 12.421367049217224
2023-04-24 00:08:47,381 - Detection - ***** Epoch: 2: Eval results *****
2023-04-24 00:08:47,381 - Detection -   best_eval_score = 0
2023-04-24 00:08:47,382 - Detection -   eval_score = 0.0
2023-04-24 00:08:47,382 - Detection -   train_loss = 11.973809838294983
2023-04-24 00:08:49,390 - Detection - ***** Epoch: 3: Eval results *****
2023-04-24 00:08:49,390 - Detection -   best_eval_score = 0
2023-04-24 00:08:49,390 - Detection -   eval_score = 0.0
2023-04-24 00:08:49,391 - Detection -   train_loss = 11.305960237979889
2023-04-24 00:08:51,400 - Detection - ***** Epoch: 4: Eval results *****
2023-04-24 00:08:51,400 - Detection -   best_eval_score = 0
2023-04-24 00:08:51,400 - Detection -   eval_score = 0.0
2023-04-24 00:08:51,400 - Detection -   train_loss = 10.51050591468811
2023-04-24 00:08:53,415 - Detection - ***** Epoch: 5: Eval results *****
2023-04-24 00:08:53,415 - Detection -   best_eval_score = 0
2023-04-24 00:08:53,415 - Detection -   eval_score = 0.0
2023-04-24 00:08:53,415 - Detection -   train_loss = 9.692101836204529
2023-04-24 00:08:55,429 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 00:08:55,430 - Detection -   best_eval_score = 0
2023-04-24 00:08:55,430 - Detection -   eval_score = 1.03
2023-04-24 00:08:55,430 - Detection -   train_loss = 8.792136549949646
2023-04-24 00:09:06,948 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 00:09:06,948 - Detection -   best_eval_score = 1.03
2023-04-24 00:09:06,948 - Detection -   eval_score = 51.39
2023-04-24 00:09:06,948 - Detection -   train_loss = 7.8649939596652985
2023-04-24 00:09:18,220 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 00:09:18,220 - Detection -   best_eval_score = 51.39
2023-04-24 00:09:18,220 - Detection -   eval_score = 74.43
2023-04-24 00:09:18,220 - Detection -   train_loss = 3.692655548453331
2023-04-24 00:09:29,666 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 00:09:29,666 - Detection -   best_eval_score = 74.43
2023-04-24 00:09:29,667 - Detection -   eval_score = 75.53
2023-04-24 00:09:29,667 - Detection -   train_loss = 1.7341665178537369
2023-04-24 00:09:40,998 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 00:09:40,998 - Detection -   best_eval_score = 75.53
2023-04-24 00:09:40,998 - Detection -   eval_score = 75.7
2023-04-24 00:09:40,998 - Detection -   train_loss = 1.6488910019397736
2023-04-24 00:09:52,204 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 00:09:52,204 - Detection -   best_eval_score = 75.7
2023-04-24 00:09:52,204 - Detection -   eval_score = 75.47
2023-04-24 00:09:52,204 - Detection -   train_loss = 1.6633164063096046
2023-04-24 00:10:03,557 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 00:10:03,558 - Detection -   best_eval_score = 75.7
2023-04-24 00:10:03,558 - Detection -   eval_score = 75.27
2023-04-24 00:10:03,558 - Detection -   train_loss = 1.6303728595376015
2023-04-24 00:10:14,908 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 00:10:14,908 - Detection -   best_eval_score = 75.7
2023-04-24 00:10:14,908 - Detection -   eval_score = 75.33
2023-04-24 00:10:14,908 - Detection -   train_loss = 1.6835112050175667
2023-04-24 00:10:26,320 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 00:10:26,320 - Detection -   best_eval_score = 75.7
2023-04-24 00:10:26,320 - Detection -   eval_score = 75.32
2023-04-24 00:10:26,320 - Detection -   train_loss = 1.6519537717103958
2023-04-24 00:10:37,517 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 00:10:37,517 - Detection -   best_eval_score = 75.7
2023-04-24 00:10:37,517 - Detection -   eval_score = 75.42
2023-04-24 00:10:37,517 - Detection -   train_loss = 1.7009674906730652
2023-04-24 00:10:48,828 - Detection - ***** Epoch: 16: Eval results *****
2023-04-24 00:10:48,828 - Detection -   best_eval_score = 75.7
2023-04-24 00:10:48,828 - Detection -   eval_score = 75.48
2023-04-24 00:10:48,828 - Detection -   train_loss = 1.6890339702367783
2023-04-24 00:11:00,123 - Detection - ***** Epoch: 17: Eval results *****
2023-04-24 00:11:00,124 - Detection -   best_eval_score = 75.7
2023-04-24 00:11:00,124 - Detection -   eval_score = 75.63
2023-04-24 00:11:00,124 - Detection -   train_loss = 1.6590218022465706
2023-04-24 00:11:11,461 - Detection - ***** Epoch: 18: Eval results *****
2023-04-24 00:11:11,461 - Detection -   best_eval_score = 75.7
2023-04-24 00:11:11,461 - Detection -   eval_score = 75.49
2023-04-24 00:11:11,461 - Detection -   train_loss = 1.6823802962899208
2023-04-24 00:11:22,675 - Detection - ***** Epoch: 19: Eval results *****
2023-04-24 00:11:22,675 - Detection -   best_eval_score = 75.7
2023-04-24 00:11:22,675 - Detection -   eval_score = 75.48
2023-04-24 00:11:22,675 - Detection -   train_loss = 1.7004732191562653
2023-04-24 00:11:34,022 - Detection - ***** Epoch: 20: Eval results *****
2023-04-24 00:11:34,022 - Detection -   best_eval_score = 75.7
2023-04-24 00:11:34,022 - Detection -   eval_score = 75.43
2023-04-24 00:11:34,022 - Detection -   train_loss = 1.6658913120627403
2023-04-24 00:11:34,022 - Detection - Training Finished...
2023-04-24 00:11:34,022 - Detection - Testing begin...
2023-04-24 00:11:35,766 - Detection - ***** Test: Confusion Matrix *****
2023-04-24 00:11:35,766 - Detection - [[104   0   0   0   0   0   0   0   0   0   1   2   1   0   0  41]
 [  0  70   0   0   0   0   0   0   0   1   0   0   0   0   2  55]
 [  0   0  91   0   0   0   0   1   0   2   1   0   0   0   0  45]
 [  0   0   2  88   0   0   0   1   0   0   0   0   0   0   0  31]
 [  0   0   0   0  92   0   0   1   0   0   0   0   0   0   0  38]
 [  0   0   0   3   0  85   0   0   1   0   6   0   0   1   0  43]
 [  0   0   2   0   0   0 100   0   0   0   2   0   1   1   0  65]
 [  0   0   0   4   0   0   0  77   0   0   1   0   0   0   0  42]
 [  0   0   0   0   0   0   0   0  98   0   0   1   0   0   0  29]
 [  0   0   0   1   0   0   0   0   0  93   2   0   1   0   0  30]
 [  1   0   1   1   0   1   0   0   0   0 129   2   2   0   0  56]
 [  1   0   0   1   0   1   0   0   1   0   0  94   0   1   0  71]
 [  0   0   1   0   0   0   2   0   0   0   2   0  49   1   0  51]
 [  0   0   0   1   0   0   2   0   0   0   1   2   1 117   0  36]
 [  0   4   0   0   0   0   0   0   0   0   0   0   0   0 106  41]
 [  0   0   5  27   0   1   1  14   2   3 110   3  14   8   2 576]]
2023-04-24 00:11:35,766 - Detection - ***** Test results *****
2023-04-24 00:11:35,766 - Detection -   Acc = 67.78
2023-04-24 00:11:35,766 - Detection -   F1 = 72.9135
2023-04-24 00:11:35,766 - Detection -   F1-known = 73.9648
2023-04-24 00:11:35,766 - Detection -   F1-open = 57.1429
2023-04-24 00:11:35,766 - Detection - Testing finished...
2023-04-24 00:11:35,766 - Detection - Results saved in results/results_ADB-BOOST-F-4.csv
2023-04-24 00:11:35,785 - Detection - Open Intent Detection Finished...
