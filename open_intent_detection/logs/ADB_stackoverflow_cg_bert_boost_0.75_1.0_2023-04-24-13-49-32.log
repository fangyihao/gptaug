2023-04-24 13:49:32,252 - Detection - Open Intent Detection Begin...
2023-04-24 13:49:32,252 - Detection - Parameters Initialization...
2023-04-24 13:49:32,253 - Detection - ============================== Params ==============================
2023-04-24 13:49:32,253 - Detection - type:	open_intent_detection
2023-04-24 13:49:32,253 - Detection - logger_name:	Detection
2023-04-24 13:49:32,253 - Detection - log_dir:	logs
2023-04-24 13:49:32,253 - Detection - dataset:	stackoverflow_cg
2023-04-24 13:49:32,253 - Detection - known_cls_ratio:	0.75
2023-04-24 13:49:32,253 - Detection - labeled_ratio:	1.0
2023-04-24 13:49:32,253 - Detection - method:	ADB
2023-04-24 13:49:32,253 - Detection - train:	True
2023-04-24 13:49:32,253 - Detection - pretrain:	True
2023-04-24 13:49:32,253 - Detection - save_model:	False
2023-04-24 13:49:32,253 - Detection - backbone:	bert_boost
2023-04-24 13:49:32,253 - Detection - config_file_name:	ADB
2023-04-24 13:49:32,253 - Detection - seed:	2
2023-04-24 13:49:32,253 - Detection - gpu_id:	0
2023-04-24 13:49:32,253 - Detection - pipe_results_path:	pipe_results
2023-04-24 13:49:32,253 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-24 13:49:32,253 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-24 13:49:32,253 - Detection - model_dir:	models
2023-04-24 13:49:32,253 - Detection - load_pretrained_method:	None
2023-04-24 13:49:32,253 - Detection - result_dir:	results
2023-04-24 13:49:32,253 - Detection - results_file_name:	results_ADB-BOOST-F-10.csv
2023-04-24 13:49:32,253 - Detection - save_results:	True
2023-04-24 13:49:32,253 - Detection - loss_fct:	CrossEntropyLoss
2023-04-24 13:49:32,253 - Detection - boost_method:	F-10
2023-04-24 13:49:32,253 - Detection - boost_start_score:	0.0
2023-04-24 13:49:32,253 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.75_1.0_bert_boost_2
2023-04-24 13:49:32,253 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.75_1.0_bert_boost_2/models
2023-04-24 13:49:32,253 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-24 13:49:32,253 - Detection - num_train_epochs:	100
2023-04-24 13:49:32,253 - Detection - num_labels:	None
2023-04-24 13:49:32,253 - Detection - max_seq_length:	None
2023-04-24 13:49:32,253 - Detection - freeze_backbone_parameters:	True
2023-04-24 13:49:32,253 - Detection - feat_dim:	768
2023-04-24 13:49:32,253 - Detection - warmup_proportion:	0.1
2023-04-24 13:49:32,253 - Detection - lr_boundary:	0.05
2023-04-24 13:49:32,253 - Detection - lr:	2e-05
2023-04-24 13:49:32,253 - Detection - activation:	relu
2023-04-24 13:49:32,253 - Detection - train_batch_size:	128
2023-04-24 13:49:32,253 - Detection - eval_batch_size:	64
2023-04-24 13:49:32,253 - Detection - test_batch_size:	64
2023-04-24 13:49:32,253 - Detection - wait_patient:	10
2023-04-24 13:49:32,253 - Detection - ============================== End Params ==============================
2023-04-24 13:49:32,253 - Detection - Data and Model Preparation...
2023-04-24 13:49:32,254 - Detection - The number of known intents is 15
2023-04-24 13:49:32,254 - Detection - Lists of known labels are: ['osx', 'drupal', 'visual-studio', 'ajax', 'magento', 'excel', 'cocoa', 'matlab', 'apache', 'svn', 'hibernate', 'spring', 'scala', 'bash', 'oracle']
2023-04-24 13:49:32,264 - Detection - Number of labeled training samples = 2118
2023-04-24 13:49:32,264 - Detection - Number of unlabeled training samples = 673
2023-04-24 13:49:32,267 - Detection - Number of evaluation samples = 1057
2023-04-24 13:49:32,272 - Detection - Number of testing samples = 2905
2023-04-24 13:49:36,312 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-24 13:49:37,986 - Detection - Pre-training Begin...
2023-04-24 13:49:41,293 - Detection - ***** Epoch: 1: Eval results *****
2023-04-24 13:49:41,293 - Detection -   best_eval_score = 0
2023-04-24 13:49:41,293 - Detection -   eval_score = 6.34
2023-04-24 13:49:41,293 - Detection -   train_loss = 2.708436068366556
2023-04-24 13:50:12,332 - Detection - ***** Epoch: 2: Eval results *****
2023-04-24 13:50:12,332 - Detection -   best_eval_score = 6.34
2023-04-24 13:50:12,332 - Detection -   eval_score = 30.46
2023-04-24 13:50:12,332 - Detection -   train_loss = 2.6921624576344207
2023-04-24 13:50:43,553 - Detection - ***** Epoch: 3: Eval results *****
2023-04-24 13:50:43,553 - Detection -   best_eval_score = 30.46
2023-04-24 13:50:43,553 - Detection -   eval_score = 71.05
2023-04-24 13:50:43,553 - Detection -   train_loss = 2.192476090262918
2023-04-24 13:51:14,700 - Detection - ***** Epoch: 4: Eval results *****
2023-04-24 13:51:14,701 - Detection -   best_eval_score = 71.05
2023-04-24 13:51:14,701 - Detection -   eval_score = 77.29
2023-04-24 13:51:14,701 - Detection -   train_loss = 1.2563597174251782
2023-04-24 13:51:45,953 - Detection - ***** Epoch: 5: Eval results *****
2023-04-24 13:51:45,953 - Detection -   best_eval_score = 77.29
2023-04-24 13:51:45,953 - Detection -   eval_score = 78.9
2023-04-24 13:51:45,953 - Detection -   train_loss = 0.8577162588343901
2023-04-24 13:52:17,178 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 13:52:17,178 - Detection -   best_eval_score = 78.9
2023-04-24 13:52:17,178 - Detection -   eval_score = 79.75
2023-04-24 13:52:17,178 - Detection -   train_loss = 0.6864640888045815
2023-04-24 13:52:48,352 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 13:52:48,352 - Detection -   best_eval_score = 79.75
2023-04-24 13:52:48,352 - Detection -   eval_score = 79.56
2023-04-24 13:52:48,352 - Detection -   train_loss = 0.5649458993883694
2023-04-24 13:53:19,503 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 13:53:19,503 - Detection -   best_eval_score = 79.75
2023-04-24 13:53:19,504 - Detection -   eval_score = 80.51
2023-04-24 13:53:19,504 - Detection -   train_loss = 0.4444524190005134
2023-04-24 13:53:50,810 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 13:53:50,810 - Detection -   best_eval_score = 80.51
2023-04-24 13:53:50,810 - Detection -   eval_score = 79.94
2023-04-24 13:53:50,810 - Detection -   train_loss = 0.3548650119234534
2023-04-24 13:54:22,162 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 13:54:22,162 - Detection -   best_eval_score = 80.51
2023-04-24 13:54:22,163 - Detection -   eval_score = 79.38
2023-04-24 13:54:22,163 - Detection -   train_loss = 0.27500280124299664
2023-04-24 13:54:53,394 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 13:54:53,394 - Detection -   best_eval_score = 80.51
2023-04-24 13:54:53,394 - Detection -   eval_score = 80.23
2023-04-24 13:54:53,394 - Detection -   train_loss = 0.20283730941660263
2023-04-24 13:55:24,725 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 13:55:24,725 - Detection -   best_eval_score = 80.51
2023-04-24 13:55:24,725 - Detection -   eval_score = 80.23
2023-04-24 13:55:24,725 - Detection -   train_loss = 0.18455486350199757
2023-04-24 13:55:55,895 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 13:55:55,895 - Detection -   best_eval_score = 80.51
2023-04-24 13:55:55,895 - Detection -   eval_score = 79.56
2023-04-24 13:55:55,895 - Detection -   train_loss = 0.1452075216700049
2023-04-24 13:56:27,088 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 13:56:27,088 - Detection -   best_eval_score = 80.51
2023-04-24 13:56:27,088 - Detection -   eval_score = 80.04
2023-04-24 13:56:27,088 - Detection -   train_loss = 0.1176175957216936
2023-04-24 13:56:58,317 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 13:56:58,317 - Detection -   best_eval_score = 80.51
2023-04-24 13:56:58,317 - Detection -   eval_score = 80.32
2023-04-24 13:56:58,317 - Detection -   train_loss = 0.0964642984463888
2023-04-24 13:57:29,646 - Detection - ***** Epoch: 16: Eval results *****
2023-04-24 13:57:29,646 - Detection -   best_eval_score = 80.51
2023-04-24 13:57:29,646 - Detection -   eval_score = 80.61
2023-04-24 13:57:29,646 - Detection -   train_loss = 0.09778568674536313
2023-04-24 13:58:01,050 - Detection - ***** Epoch: 17: Eval results *****
2023-04-24 13:58:01,050 - Detection -   best_eval_score = 80.61
2023-04-24 13:58:01,050 - Detection -   eval_score = 80.04
2023-04-24 13:58:01,050 - Detection -   train_loss = 0.08418971541173317
2023-04-24 13:58:32,345 - Detection - ***** Epoch: 18: Eval results *****
2023-04-24 13:58:32,345 - Detection -   best_eval_score = 80.61
2023-04-24 13:58:32,345 - Detection -   eval_score = 80.89
2023-04-24 13:58:32,345 - Detection -   train_loss = 0.06859335401917205
2023-04-24 13:59:03,665 - Detection - ***** Epoch: 19: Eval results *****
2023-04-24 13:59:03,666 - Detection -   best_eval_score = 80.89
2023-04-24 13:59:03,666 - Detection -   eval_score = 79.47
2023-04-24 13:59:03,666 - Detection -   train_loss = 0.06605002853800268
2023-04-24 13:59:35,053 - Detection - ***** Epoch: 20: Eval results *****
2023-04-24 13:59:35,053 - Detection -   best_eval_score = 80.89
2023-04-24 13:59:35,053 - Detection -   eval_score = 81.08
2023-04-24 13:59:35,053 - Detection -   train_loss = 0.057161820285460525
2023-04-24 14:00:06,315 - Detection - ***** Epoch: 21: Eval results *****
2023-04-24 14:00:06,315 - Detection -   best_eval_score = 81.08
2023-04-24 14:00:06,315 - Detection -   eval_score = 80.51
2023-04-24 14:00:06,315 - Detection -   train_loss = 0.05345033536500791
2023-04-24 14:00:37,500 - Detection - ***** Epoch: 22: Eval results *****
2023-04-24 14:00:37,500 - Detection -   best_eval_score = 81.08
2023-04-24 14:00:37,500 - Detection -   eval_score = 80.89
2023-04-24 14:00:37,501 - Detection -   train_loss = 0.05775753912680289
2023-04-24 14:01:09,017 - Detection - ***** Epoch: 23: Eval results *****
2023-04-24 14:01:09,018 - Detection -   best_eval_score = 81.08
2023-04-24 14:01:09,018 - Detection -   eval_score = 80.51
2023-04-24 14:01:09,018 - Detection -   train_loss = 0.05078958862406366
2023-04-24 14:01:40,211 - Detection - ***** Epoch: 24: Eval results *****
2023-04-24 14:01:40,211 - Detection -   best_eval_score = 81.08
2023-04-24 14:01:40,211 - Detection -   eval_score = 80.79
2023-04-24 14:01:40,211 - Detection -   train_loss = 0.03608673613737611
2023-04-24 14:02:11,420 - Detection - ***** Epoch: 25: Eval results *****
2023-04-24 14:02:11,420 - Detection -   best_eval_score = 81.08
2023-04-24 14:02:11,420 - Detection -   eval_score = 80.32
2023-04-24 14:02:11,420 - Detection -   train_loss = 0.0334902765119777
2023-04-24 14:02:42,567 - Detection - ***** Epoch: 26: Eval results *****
2023-04-24 14:02:42,567 - Detection -   best_eval_score = 81.08
2023-04-24 14:02:42,567 - Detection -   eval_score = 80.42
2023-04-24 14:02:42,567 - Detection -   train_loss = 0.033014643006026745
2023-04-24 14:03:13,945 - Detection - ***** Epoch: 27: Eval results *****
2023-04-24 14:03:13,945 - Detection -   best_eval_score = 81.08
2023-04-24 14:03:13,945 - Detection -   eval_score = 79.75
2023-04-24 14:03:13,945 - Detection -   train_loss = 0.033526169957921785
2023-04-24 14:03:45,218 - Detection - ***** Epoch: 28: Eval results *****
2023-04-24 14:03:45,218 - Detection -   best_eval_score = 81.08
2023-04-24 14:03:45,218 - Detection -   eval_score = 80.7
2023-04-24 14:03:45,218 - Detection -   train_loss = 0.03014172542401973
2023-04-24 14:04:16,573 - Detection - ***** Epoch: 29: Eval results *****
2023-04-24 14:04:16,573 - Detection -   best_eval_score = 81.08
2023-04-24 14:04:16,574 - Detection -   eval_score = 80.04
2023-04-24 14:04:16,574 - Detection -   train_loss = 0.02918745024020181
2023-04-24 14:04:47,786 - Detection - ***** Epoch: 30: Eval results *****
2023-04-24 14:04:47,787 - Detection -   best_eval_score = 81.08
2023-04-24 14:04:47,787 - Detection -   eval_score = 80.04
2023-04-24 14:04:47,787 - Detection -   train_loss = 0.023178562248016104
2023-04-24 14:04:47,787 - Detection - Pre-training finished...
2023-04-24 14:04:47,787 - Detection - Training Begin...
2023-04-24 14:04:52,306 - Detection - ***** Epoch: 1: Eval results *****
2023-04-24 14:04:52,306 - Detection -   best_eval_score = 0
2023-04-24 14:04:52,306 - Detection -   eval_score = 0.0
2023-04-24 14:04:52,306 - Detection -   train_loss = 13.9589043785544
2023-04-24 14:04:55,124 - Detection - ***** Epoch: 2: Eval results *****
2023-04-24 14:04:55,124 - Detection -   best_eval_score = 0
2023-04-24 14:04:55,124 - Detection -   eval_score = 0.0
2023-04-24 14:04:55,125 - Detection -   train_loss = 13.405532949111041
2023-04-24 14:04:57,945 - Detection - ***** Epoch: 3: Eval results *****
2023-04-24 14:04:57,945 - Detection -   best_eval_score = 0
2023-04-24 14:04:57,945 - Detection -   eval_score = 0.0
2023-04-24 14:04:57,945 - Detection -   train_loss = 12.770772148581113
2023-04-24 14:05:00,769 - Detection - ***** Epoch: 4: Eval results *****
2023-04-24 14:05:00,769 - Detection -   best_eval_score = 0
2023-04-24 14:05:00,769 - Detection -   eval_score = 0.17
2023-04-24 14:05:00,769 - Detection -   train_loss = 11.86624257704791
2023-04-24 14:05:32,013 - Detection - ***** Epoch: 5: Eval results *****
2023-04-24 14:05:32,013 - Detection -   best_eval_score = 0.17
2023-04-24 14:05:32,013 - Detection -   eval_score = 67.98
2023-04-24 14:05:32,013 - Detection -   train_loss = 10.97450901480282
2023-04-24 14:06:03,045 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 14:06:03,045 - Detection -   best_eval_score = 67.98
2023-04-24 14:06:03,045 - Detection -   eval_score = 73.07
2023-04-24 14:06:03,045 - Detection -   train_loss = 2.2444874539094815
2023-04-24 14:06:34,019 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 14:06:34,019 - Detection -   best_eval_score = 73.07
2023-04-24 14:06:34,019 - Detection -   eval_score = 73.18
2023-04-24 14:06:34,019 - Detection -   train_loss = 1.8615903363508337
2023-04-24 14:07:04,969 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 14:07:04,969 - Detection -   best_eval_score = 73.18
2023-04-24 14:07:04,969 - Detection -   eval_score = 73.25
2023-04-24 14:07:04,969 - Detection -   train_loss = 1.8214859681970932
2023-04-24 14:07:36,083 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 14:07:36,083 - Detection -   best_eval_score = 73.25
2023-04-24 14:07:36,083 - Detection -   eval_score = 73.13
2023-04-24 14:07:36,083 - Detection -   train_loss = 1.8431863995159374
2023-04-24 14:08:06,961 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 14:08:06,961 - Detection -   best_eval_score = 73.25
2023-04-24 14:08:06,961 - Detection -   eval_score = 73.12
2023-04-24 14:08:06,961 - Detection -   train_loss = 1.8143533187754013
2023-04-24 14:08:37,915 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 14:08:37,915 - Detection -   best_eval_score = 73.25
2023-04-24 14:08:37,915 - Detection -   eval_score = 73.11
2023-04-24 14:08:37,915 - Detection -   train_loss = 1.849172262584462
2023-04-24 14:09:09,198 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 14:09:09,198 - Detection -   best_eval_score = 73.25
2023-04-24 14:09:09,198 - Detection -   eval_score = 73.11
2023-04-24 14:09:09,198 - Detection -   train_loss = 1.8319392554900225
2023-04-24 14:09:40,060 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 14:09:40,061 - Detection -   best_eval_score = 73.25
2023-04-24 14:09:40,061 - Detection -   eval_score = 73.19
2023-04-24 14:09:40,061 - Detection -   train_loss = 1.8113856245489681
2023-04-24 14:10:11,102 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 14:10:11,102 - Detection -   best_eval_score = 73.25
2023-04-24 14:10:11,102 - Detection -   eval_score = 73.24
2023-04-24 14:10:11,102 - Detection -   train_loss = 1.8803240691914278
2023-04-24 14:10:42,317 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 14:10:42,317 - Detection -   best_eval_score = 73.25
2023-04-24 14:10:42,317 - Detection -   eval_score = 73.17
2023-04-24 14:10:42,317 - Detection -   train_loss = 1.8544349880779492
2023-04-24 14:11:13,220 - Detection - ***** Epoch: 16: Eval results *****
2023-04-24 14:11:13,220 - Detection -   best_eval_score = 73.25
2023-04-24 14:11:13,221 - Detection -   eval_score = 73.12
2023-04-24 14:11:13,221 - Detection -   train_loss = 1.8333002539242016
2023-04-24 14:11:44,161 - Detection - ***** Epoch: 17: Eval results *****
2023-04-24 14:11:44,161 - Detection -   best_eval_score = 73.25
2023-04-24 14:11:44,161 - Detection -   eval_score = 73.2
2023-04-24 14:11:44,161 - Detection -   train_loss = 1.8166996521108292
2023-04-24 14:12:15,146 - Detection - ***** Epoch: 18: Eval results *****
2023-04-24 14:12:15,146 - Detection -   best_eval_score = 73.25
2023-04-24 14:12:15,146 - Detection -   eval_score = 72.9
2023-04-24 14:12:15,146 - Detection -   train_loss = 1.8039947888430428
2023-04-24 14:12:15,146 - Detection - Training Finished...
2023-04-24 14:12:15,146 - Detection - Testing begin...
2023-04-24 14:12:17,542 - Detection - ***** Test: Confusion Matrix *****
2023-04-24 14:12:17,542 - Detection - [[104   0   1   0   0   1  16   0   1   1   0   0   0   0   0  69]
 [  0  98   0   0   0   0   0   0   0   0   0   0   0   0   1  29]
 [  0   0  45   1   0   1   1   0   1   1   0   0   0   0   0  56]
 [  0   0   0 108   0   1   2   0   1   0   0   0   0   1   0  47]
 [  0   1   0   0 100   0   0   0   0   0   0   0   0   0   1  30]
 [  0   0   1   0   0  79   0   0   0   0   0   0   0   0   0  60]
 [ 17   0   0   2   0   1  46   0   0   0   0   0   0   0   0  95]
 [  0   0   0   0   0   1   1 123   0   0   0   0   2   0   1  36]
 [  0   0   0   0   0   0   0   0  99   1   1   0   0   0   0  69]
 [  1   0   2   0   0   0   0   0   1 102   0   0   0   0   0  43]
 [  0   0   0   0   0   0   0   0   0   0  74   2   0   0   2  50]
 [  0   0   0   0   0   0   1   0   1   0   3 104   0   0   0  42]
 [  0   0   0   0   0   0   0   0   0   0   0   0  75   0   0  49]
 [  3   0   0   1   0   0   1   0   0   0   0   0   0  81   0  53]
 [  0   0   0   0   0   0   1   0   0   0   0   0   0   0  97  29]
 [  4   1  13  11   0   9   3   2   5   2   0   0   2   1   0 680]]
2023-04-24 14:12:17,542 - Detection - ***** Test results *****
2023-04-24 14:12:17,543 - Detection -   Acc = 69.36
2023-04-24 14:12:17,543 - Detection -   F1 = 72.2981
2023-04-24 14:12:17,543 - Detection -   F1-known = 72.9398
2023-04-24 14:12:17,543 - Detection -   F1-open = 62.6728
2023-04-24 14:12:17,543 - Detection - Testing finished...
2023-04-24 14:12:17,543 - Detection - Results saved in results/results_ADB-BOOST-F-10.csv
2023-04-24 14:12:17,561 - Detection - Open Intent Detection Finished...
