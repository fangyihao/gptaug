2023-04-20 00:25:28,964 - Detection - Open Intent Detection Begin...
2023-04-20 00:25:28,964 - Detection - Parameters Initialization...
2023-04-20 00:25:28,965 - Detection - ============================== Params ==============================
2023-04-20 00:25:28,965 - Detection - type:	open_intent_detection
2023-04-20 00:25:28,965 - Detection - logger_name:	Detection
2023-04-20 00:25:28,965 - Detection - log_dir:	logs
2023-04-20 00:25:28,965 - Detection - dataset:	stackoverflow_cg
2023-04-20 00:25:28,965 - Detection - known_cls_ratio:	0.5
2023-04-20 00:25:28,965 - Detection - labeled_ratio:	1.0
2023-04-20 00:25:28,965 - Detection - method:	DA-ADB
2023-04-20 00:25:28,965 - Detection - train:	True
2023-04-20 00:25:28,965 - Detection - pretrain:	True
2023-04-20 00:25:28,965 - Detection - save_model:	True
2023-04-20 00:25:28,965 - Detection - backbone:	bert_disaware
2023-04-20 00:25:28,965 - Detection - config_file_name:	DA-ADB
2023-04-20 00:25:28,965 - Detection - seed:	1
2023-04-20 00:25:28,965 - Detection - gpu_id:	0
2023-04-20 00:25:28,965 - Detection - pipe_results_path:	pipe_results
2023-04-20 00:25:28,965 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-20 00:25:28,965 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-20 00:25:28,965 - Detection - model_dir:	models
2023-04-20 00:25:28,965 - Detection - load_pretrained_method:	None
2023-04-20 00:25:28,965 - Detection - result_dir:	results
2023-04-20 00:25:28,965 - Detection - results_file_name:	results_DA-ADB.csv
2023-04-20 00:25:28,965 - Detection - save_results:	True
2023-04-20 00:25:28,965 - Detection - loss_fct:	CrossEntropyLoss
2023-04-20 00:25:28,965 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.5_1.0_bert_disaware_1
2023-04-20 00:25:28,965 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.5_1.0_bert_disaware_1/models
2023-04-20 00:25:28,965 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-20 00:25:28,965 - Detection - num_train_epochs:	100
2023-04-20 00:25:28,965 - Detection - num_labels:	None
2023-04-20 00:25:28,965 - Detection - max_seq_length:	None
2023-04-20 00:25:28,965 - Detection - freeze_backbone_parameters:	True
2023-04-20 00:25:28,965 - Detection - feat_dim:	768
2023-04-20 00:25:28,965 - Detection - warmup_proportion:	0.1
2023-04-20 00:25:28,965 - Detection - scale:	4
2023-04-20 00:25:28,965 - Detection - lr_boundary:	0.05
2023-04-20 00:25:28,965 - Detection - lr:	2e-05
2023-04-20 00:25:28,965 - Detection - activation:	relu
2023-04-20 00:25:28,965 - Detection - train_batch_size:	128
2023-04-20 00:25:28,965 - Detection - eval_batch_size:	64
2023-04-20 00:25:28,965 - Detection - test_batch_size:	64
2023-04-20 00:25:28,965 - Detection - wait_patient:	10
2023-04-20 00:25:28,965 - Detection - ============================== End Params ==============================
2023-04-20 00:25:28,965 - Detection - Data and Model Preparation...
2023-04-20 00:25:28,966 - Detection - The number of known intents is 10
2023-04-20 00:25:28,966 - Detection - Lists of known labels are: ['cocoa', 'spring', 'haskell', 'matlab', 'bash', 'scala', 'drupal', 'svn', 'hibernate', 'apache']
2023-04-20 00:25:28,987 - Detection - Number of labeled training samples = 3910
2023-04-20 00:25:28,987 - Detection - Number of unlabeled training samples = 3907
2023-04-20 00:25:28,991 - Detection - Number of evaluation samples = 934
2023-04-20 00:25:29,001 - Detection - Number of testing samples = 5082
2023-04-20 00:25:36,107 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-20 00:25:36,189 - Detection - Pre-training Begin...
2023-04-20 00:25:44,162 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 00:25:44,162 - Detection -   best_eval_score = 0
2023-04-20 00:25:44,162 - Detection -   eval_score = 4.02
2023-04-20 00:25:44,162 - Detection -   train_loss = 2.306824084251158
2023-04-20 00:25:51,673 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 00:25:51,673 - Detection -   best_eval_score = 4.02
2023-04-20 00:25:51,673 - Detection -   eval_score = 6.98
2023-04-20 00:25:51,673 - Detection -   train_loss = 2.294727586930798
2023-04-20 00:25:59,212 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 00:25:59,212 - Detection -   best_eval_score = 6.98
2023-04-20 00:25:59,212 - Detection -   eval_score = 16.76
2023-04-20 00:25:59,212 - Detection -   train_loss = 2.2775707244873047
2023-04-20 00:26:06,766 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 00:26:06,766 - Detection -   best_eval_score = 16.76
2023-04-20 00:26:06,766 - Detection -   eval_score = 26.52
2023-04-20 00:26:06,766 - Detection -   train_loss = 2.235608523891818
2023-04-20 00:26:14,346 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 00:26:14,346 - Detection -   best_eval_score = 26.52
2023-04-20 00:26:14,346 - Detection -   eval_score = 42.71
2023-04-20 00:26:14,346 - Detection -   train_loss = 2.1142821388859905
2023-04-20 00:26:21,946 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 00:26:21,946 - Detection -   best_eval_score = 42.71
2023-04-20 00:26:21,946 - Detection -   eval_score = 73.17
2023-04-20 00:26:21,946 - Detection -   train_loss = 1.8416137541494062
2023-04-20 00:26:29,571 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 00:26:29,571 - Detection -   best_eval_score = 73.17
2023-04-20 00:26:29,571 - Detection -   eval_score = 83.18
2023-04-20 00:26:29,571 - Detection -   train_loss = 1.4164138686272405
2023-04-20 00:26:37,216 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 00:26:37,216 - Detection -   best_eval_score = 83.18
2023-04-20 00:26:37,216 - Detection -   eval_score = 86.07
2023-04-20 00:26:37,216 - Detection -   train_loss = 1.0893654784848612
2023-04-20 00:26:44,856 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 00:26:44,857 - Detection -   best_eval_score = 86.07
2023-04-20 00:26:44,857 - Detection -   eval_score = 86.69
2023-04-20 00:26:44,857 - Detection -   train_loss = 0.9357964300340221
2023-04-20 00:26:52,490 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 00:26:52,490 - Detection -   best_eval_score = 86.69
2023-04-20 00:26:52,490 - Detection -   eval_score = 87.55
2023-04-20 00:26:52,490 - Detection -   train_loss = 0.8436621581354449
2023-04-20 00:27:00,115 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 00:27:00,116 - Detection -   best_eval_score = 87.55
2023-04-20 00:27:00,116 - Detection -   eval_score = 88.21
2023-04-20 00:27:00,116 - Detection -   train_loss = 0.7916569498277479
2023-04-20 00:27:07,735 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 00:27:07,735 - Detection -   best_eval_score = 88.21
2023-04-20 00:27:07,735 - Detection -   eval_score = 87.57
2023-04-20 00:27:07,735 - Detection -   train_loss = 0.7442206182787495
2023-04-20 00:27:15,443 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 00:27:15,443 - Detection -   best_eval_score = 88.21
2023-04-20 00:27:15,443 - Detection -   eval_score = 88.14
2023-04-20 00:27:15,443 - Detection -   train_loss = 0.7072675420391944
2023-04-20 00:27:23,050 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 00:27:23,050 - Detection -   best_eval_score = 88.21
2023-04-20 00:27:23,050 - Detection -   eval_score = 88.95
2023-04-20 00:27:23,050 - Detection -   train_loss = 0.6766255094159034
2023-04-20 00:27:30,661 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 00:27:30,661 - Detection -   best_eval_score = 88.95
2023-04-20 00:27:30,661 - Detection -   eval_score = 88.75
2023-04-20 00:27:30,661 - Detection -   train_loss = 0.647656133097987
2023-04-20 00:27:38,261 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 00:27:38,261 - Detection -   best_eval_score = 88.95
2023-04-20 00:27:38,261 - Detection -   eval_score = 89.31
2023-04-20 00:27:38,261 - Detection -   train_loss = 0.6292102625293117
2023-04-20 00:27:45,875 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 00:27:45,875 - Detection -   best_eval_score = 89.31
2023-04-20 00:27:45,875 - Detection -   eval_score = 89.18
2023-04-20 00:27:45,875 - Detection -   train_loss = 0.5974203559660143
2023-04-20 00:27:53,482 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 00:27:53,482 - Detection -   best_eval_score = 89.31
2023-04-20 00:27:53,482 - Detection -   eval_score = 88.42
2023-04-20 00:27:53,482 - Detection -   train_loss = 0.5871585492164858
2023-04-20 00:28:01,079 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 00:28:01,080 - Detection -   best_eval_score = 89.31
2023-04-20 00:28:01,080 - Detection -   eval_score = 89.29
2023-04-20 00:28:01,080 - Detection -   train_loss = 0.5631778547840733
2023-04-20 00:28:08,670 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 00:28:08,670 - Detection -   best_eval_score = 89.31
2023-04-20 00:28:08,670 - Detection -   eval_score = 89.41
2023-04-20 00:28:08,670 - Detection -   train_loss = 0.547618902498676
2023-04-20 00:28:16,282 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 00:28:16,283 - Detection -   best_eval_score = 89.41
2023-04-20 00:28:16,283 - Detection -   eval_score = 88.85
2023-04-20 00:28:16,283 - Detection -   train_loss = 0.5342293420145589
2023-04-20 00:28:23,872 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 00:28:23,872 - Detection -   best_eval_score = 89.41
2023-04-20 00:28:23,872 - Detection -   eval_score = 89.26
2023-04-20 00:28:23,872 - Detection -   train_loss = 0.5194725644203925
2023-04-20 00:28:31,460 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 00:28:31,460 - Detection -   best_eval_score = 89.41
2023-04-20 00:28:31,460 - Detection -   eval_score = 89.39
2023-04-20 00:28:31,460 - Detection -   train_loss = 0.506107707177439
2023-04-20 00:28:39,047 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 00:28:39,047 - Detection -   best_eval_score = 89.41
2023-04-20 00:28:39,047 - Detection -   eval_score = 89.27
2023-04-20 00:28:39,047 - Detection -   train_loss = 0.494701023063352
2023-04-20 00:28:46,636 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 00:28:46,636 - Detection -   best_eval_score = 89.41
2023-04-20 00:28:46,637 - Detection -   eval_score = 89.16
2023-04-20 00:28:46,637 - Detection -   train_loss = 0.4790623341837237
2023-04-20 00:28:54,220 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 00:28:54,220 - Detection -   best_eval_score = 89.41
2023-04-20 00:28:54,220 - Detection -   eval_score = 89.27
2023-04-20 00:28:54,220 - Detection -   train_loss = 0.47399854852307227
2023-04-20 00:29:01,806 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 00:29:01,806 - Detection -   best_eval_score = 89.41
2023-04-20 00:29:01,806 - Detection -   eval_score = 88.72
2023-04-20 00:29:01,807 - Detection -   train_loss = 0.4567629723779617
2023-04-20 00:29:09,395 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 00:29:09,395 - Detection -   best_eval_score = 89.41
2023-04-20 00:29:09,395 - Detection -   eval_score = 89.47
2023-04-20 00:29:09,395 - Detection -   train_loss = 0.4494262885662817
2023-04-20 00:29:16,998 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 00:29:16,998 - Detection -   best_eval_score = 89.47
2023-04-20 00:29:16,998 - Detection -   eval_score = 89.28
2023-04-20 00:29:16,998 - Detection -   train_loss = 0.4381711281115009
2023-04-20 00:29:24,591 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 00:29:24,591 - Detection -   best_eval_score = 89.47
2023-04-20 00:29:24,591 - Detection -   eval_score = 88.9
2023-04-20 00:29:24,591 - Detection -   train_loss = 0.4350374648647924
2023-04-20 00:29:32,188 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 00:29:32,188 - Detection -   best_eval_score = 89.47
2023-04-20 00:29:32,188 - Detection -   eval_score = 88.72
2023-04-20 00:29:32,188 - Detection -   train_loss = 0.4268650806719257
2023-04-20 00:29:39,780 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 00:29:39,781 - Detection -   best_eval_score = 89.47
2023-04-20 00:29:39,781 - Detection -   eval_score = 88.73
2023-04-20 00:29:39,781 - Detection -   train_loss = 0.4193271667726578
2023-04-20 00:29:47,371 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 00:29:47,371 - Detection -   best_eval_score = 89.47
2023-04-20 00:29:47,371 - Detection -   eval_score = 88.83
2023-04-20 00:29:47,371 - Detection -   train_loss = 0.40865844295870873
2023-04-20 00:29:55,070 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 00:29:55,070 - Detection -   best_eval_score = 89.47
2023-04-20 00:29:55,070 - Detection -   eval_score = 89.24
2023-04-20 00:29:55,070 - Detection -   train_loss = 0.4100885352780742
2023-04-20 00:30:02,660 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 00:30:02,660 - Detection -   best_eval_score = 89.47
2023-04-20 00:30:02,660 - Detection -   eval_score = 89.06
2023-04-20 00:30:02,660 - Detection -   train_loss = 0.3950922681439307
2023-04-20 00:30:10,254 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 00:30:10,254 - Detection -   best_eval_score = 89.47
2023-04-20 00:30:10,254 - Detection -   eval_score = 88.93
2023-04-20 00:30:10,254 - Detection -   train_loss = 0.3852969600308326
2023-04-20 00:30:17,847 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 00:30:17,847 - Detection -   best_eval_score = 89.47
2023-04-20 00:30:17,847 - Detection -   eval_score = 88.76
2023-04-20 00:30:17,847 - Detection -   train_loss = 0.37932185396071405
2023-04-20 00:30:25,435 - Detection - ***** Epoch: 38: Eval results *****
2023-04-20 00:30:25,435 - Detection -   best_eval_score = 89.47
2023-04-20 00:30:25,435 - Detection -   eval_score = 88.64
2023-04-20 00:30:25,435 - Detection -   train_loss = 0.37867176148199266
2023-04-20 00:30:25,436 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.5_1.0_bert_disaware_1/models
2023-04-20 00:30:25,990 - Detection - Pre-training finished...
2023-04-20 00:30:25,990 - Detection - Training Begin...
2023-04-20 00:30:30,362 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 00:30:30,362 - Detection -   best_eval_score = 0
2023-04-20 00:30:30,362 - Detection -   eval_score = 8.68
2023-04-20 00:30:30,362 - Detection -   train_loss = 4.3997852494639735
2023-04-20 00:30:34,737 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 00:30:34,737 - Detection -   best_eval_score = 8.68
2023-04-20 00:30:34,737 - Detection -   eval_score = 53.04
2023-04-20 00:30:34,737 - Detection -   train_loss = 3.156795117162889
2023-04-20 00:30:39,114 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 00:30:39,114 - Detection -   best_eval_score = 53.04
2023-04-20 00:30:39,114 - Detection -   eval_score = 79.66
2023-04-20 00:30:39,114 - Detection -   train_loss = 1.7557113247532998
2023-04-20 00:30:43,488 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 00:30:43,488 - Detection -   best_eval_score = 79.66
2023-04-20 00:30:43,488 - Detection -   eval_score = 79.86
2023-04-20 00:30:43,488 - Detection -   train_loss = 1.2670986998465754
2023-04-20 00:30:47,865 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 00:30:47,865 - Detection -   best_eval_score = 79.86
2023-04-20 00:30:47,865 - Detection -   eval_score = 79.85
2023-04-20 00:30:47,865 - Detection -   train_loss = 1.2308452283182452
2023-04-20 00:30:52,246 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 00:30:52,247 - Detection -   best_eval_score = 79.86
2023-04-20 00:30:52,247 - Detection -   eval_score = 79.85
2023-04-20 00:30:52,247 - Detection -   train_loss = 1.2452277618069802
2023-04-20 00:30:56,623 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 00:30:56,623 - Detection -   best_eval_score = 79.86
2023-04-20 00:30:56,623 - Detection -   eval_score = 79.79
2023-04-20 00:30:56,623 - Detection -   train_loss = 1.2413107214435455
2023-04-20 00:31:00,999 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 00:31:00,999 - Detection -   best_eval_score = 79.86
2023-04-20 00:31:00,999 - Detection -   eval_score = 79.85
2023-04-20 00:31:00,999 - Detection -   train_loss = 1.2315417162833675
2023-04-20 00:31:05,375 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 00:31:05,375 - Detection -   best_eval_score = 79.86
2023-04-20 00:31:05,375 - Detection -   eval_score = 79.85
2023-04-20 00:31:05,375 - Detection -   train_loss = 1.226939070609308
2023-04-20 00:31:09,750 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 00:31:09,750 - Detection -   best_eval_score = 79.86
2023-04-20 00:31:09,750 - Detection -   eval_score = 79.78
2023-04-20 00:31:09,750 - Detection -   train_loss = 1.2188572922060568
2023-04-20 00:31:14,126 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 00:31:14,126 - Detection -   best_eval_score = 79.86
2023-04-20 00:31:14,126 - Detection -   eval_score = 79.85
2023-04-20 00:31:14,126 - Detection -   train_loss = 1.2336635685736133
2023-04-20 00:31:18,498 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 00:31:18,499 - Detection -   best_eval_score = 79.86
2023-04-20 00:31:18,499 - Detection -   eval_score = 79.8
2023-04-20 00:31:18,499 - Detection -   train_loss = 1.2285515146870767
2023-04-20 00:31:22,874 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 00:31:22,874 - Detection -   best_eval_score = 79.86
2023-04-20 00:31:22,874 - Detection -   eval_score = 79.85
2023-04-20 00:31:22,874 - Detection -   train_loss = 1.2109726340539995
2023-04-20 00:31:27,250 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 00:31:27,250 - Detection -   best_eval_score = 79.86
2023-04-20 00:31:27,250 - Detection -   eval_score = 79.73
2023-04-20 00:31:27,250 - Detection -   train_loss = 1.2336524225050403
2023-04-20 00:31:27,251 - Detection - Training Finished...
2023-04-20 00:31:27,251 - Detection - Testing begin...
2023-04-20 00:31:31,474 - Detection - ***** Test: Confusion Matrix *****
2023-04-20 00:31:31,475 - Detection - [[ 165    0    0    0    0    0    0    0    0    0   71]
 [   1  183    0    0    0    0    0    0    2    0   60]
 [   0    0  207    0    0    0    0    0    0    0   62]
 [   0    0    0  228    0    0    0    0    0    0   47]
 [   2    0    0    0  187    0    0    0    0    0   67]
 [   0    0    0    0    0  200    0    0    0    0   61]
 [   0    0    0    0    0    0  197    0    0    2   38]
 [   0    0    0    0    0    0    0  222    0    1   50]
 [   0    1    0    0    0    0    0    0  212    0   45]
 [   0    0    0    0    1    0    0    1    0  178   65]
 [ 210    1    4    0    9    1    0    4    1   36 2260]]
2023-04-20 00:31:31,475 - Detection - ***** Test results *****
2023-04-20 00:31:31,475 - Detection -   Acc = 83.41
2023-04-20 00:31:31,475 - Detection -   F1 = 83.2224
2023-04-20 00:31:31,475 - Detection -   F1-known = 83.0992
2023-04-20 00:31:31,475 - Detection -   F1-open = 84.4544
2023-04-20 00:31:31,475 - Detection - Testing finished...
2023-04-20 00:31:31,475 - Detection - Results saved in results/results_DA-ADB.csv
2023-04-20 00:31:31,495 - Detection - Open Intent Detection Finished...
