2023-04-24 09:14:19,170 - Detection - Open Intent Detection Begin...
2023-04-24 09:14:19,170 - Detection - Parameters Initialization...
2023-04-24 09:14:19,170 - Detection - ============================== Params ==============================
2023-04-24 09:14:19,171 - Detection - type:	open_intent_detection
2023-04-24 09:14:19,171 - Detection - logger_name:	Detection
2023-04-24 09:14:19,171 - Detection - log_dir:	logs
2023-04-24 09:14:19,171 - Detection - dataset:	stackoverflow_cg
2023-04-24 09:14:19,171 - Detection - known_cls_ratio:	0.25
2023-04-24 09:14:19,171 - Detection - labeled_ratio:	1.0
2023-04-24 09:14:19,171 - Detection - method:	ADB
2023-04-24 09:14:19,171 - Detection - train:	True
2023-04-24 09:14:19,171 - Detection - pretrain:	True
2023-04-24 09:14:19,171 - Detection - save_model:	False
2023-04-24 09:14:19,171 - Detection - backbone:	bert_boost
2023-04-24 09:14:19,171 - Detection - config_file_name:	ADB
2023-04-24 09:14:19,171 - Detection - seed:	3
2023-04-24 09:14:19,171 - Detection - gpu_id:	0
2023-04-24 09:14:19,171 - Detection - pipe_results_path:	pipe_results
2023-04-24 09:14:19,171 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-24 09:14:19,171 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-24 09:14:19,171 - Detection - model_dir:	models
2023-04-24 09:14:19,171 - Detection - load_pretrained_method:	None
2023-04-24 09:14:19,171 - Detection - result_dir:	results
2023-04-24 09:14:19,171 - Detection - results_file_name:	results_ADB-BOOST-F-10.csv
2023-04-24 09:14:19,171 - Detection - save_results:	True
2023-04-24 09:14:19,171 - Detection - loss_fct:	CrossEntropyLoss
2023-04-24 09:14:19,171 - Detection - boost_method:	F-10
2023-04-24 09:14:19,171 - Detection - boost_start_score:	0.0
2023-04-24 09:14:19,171 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.25_1.0_bert_boost_3
2023-04-24 09:14:19,171 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.25_1.0_bert_boost_3/models
2023-04-24 09:14:19,171 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-24 09:14:19,171 - Detection - num_train_epochs:	100
2023-04-24 09:14:19,171 - Detection - num_labels:	None
2023-04-24 09:14:19,171 - Detection - max_seq_length:	None
2023-04-24 09:14:19,171 - Detection - freeze_backbone_parameters:	True
2023-04-24 09:14:19,171 - Detection - feat_dim:	768
2023-04-24 09:14:19,171 - Detection - warmup_proportion:	0.1
2023-04-24 09:14:19,171 - Detection - lr_boundary:	0.05
2023-04-24 09:14:19,171 - Detection - lr:	2e-05
2023-04-24 09:14:19,171 - Detection - activation:	relu
2023-04-24 09:14:19,171 - Detection - train_batch_size:	128
2023-04-24 09:14:19,171 - Detection - eval_batch_size:	64
2023-04-24 09:14:19,171 - Detection - test_batch_size:	64
2023-04-24 09:14:19,171 - Detection - wait_patient:	10
2023-04-24 09:14:19,171 - Detection - ============================== End Params ==============================
2023-04-24 09:14:19,171 - Detection - Data and Model Preparation...
2023-04-24 09:14:19,172 - Detection - The number of known intents is 5
2023-04-24 09:14:19,172 - Detection - Lists of known labels are: ['scala', 'bash', 'apache', 'svn', 'drupal']
2023-04-24 09:14:19,178 - Detection - Number of labeled training samples = 630
2023-04-24 09:14:19,179 - Detection - Number of unlabeled training samples = 2161
2023-04-24 09:14:19,181 - Detection - Number of evaluation samples = 377
2023-04-24 09:14:19,186 - Detection - Number of testing samples = 2905
2023-04-24 09:14:23,186 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-24 09:14:24,830 - Detection - Pre-training Begin...
2023-04-24 09:14:26,216 - Detection - ***** Epoch: 1: Eval results *****
2023-04-24 09:14:26,216 - Detection -   best_eval_score = 0
2023-04-24 09:14:26,216 - Detection -   eval_score = 19.89
2023-04-24 09:14:26,216 - Detection -   train_loss = 1.610513687133789
2023-04-24 09:14:35,945 - Detection - ***** Epoch: 2: Eval results *****
2023-04-24 09:14:35,945 - Detection -   best_eval_score = 19.89
2023-04-24 09:14:35,945 - Detection -   eval_score = 49.6
2023-04-24 09:14:35,945 - Detection -   train_loss = 1.6049654722213744
2023-04-24 09:14:45,505 - Detection - ***** Epoch: 3: Eval results *****
2023-04-24 09:14:45,505 - Detection -   best_eval_score = 49.6
2023-04-24 09:14:45,505 - Detection -   eval_score = 71.09
2023-04-24 09:14:45,505 - Detection -   train_loss = 1.41171395778656
2023-04-24 09:14:55,208 - Detection - ***** Epoch: 4: Eval results *****
2023-04-24 09:14:55,208 - Detection -   best_eval_score = 71.09
2023-04-24 09:14:55,208 - Detection -   eval_score = 84.08
2023-04-24 09:14:55,208 - Detection -   train_loss = 0.8673410415649414
2023-04-24 09:15:04,846 - Detection - ***** Epoch: 5: Eval results *****
2023-04-24 09:15:04,846 - Detection -   best_eval_score = 84.08
2023-04-24 09:15:04,846 - Detection -   eval_score = 87.27
2023-04-24 09:15:04,846 - Detection -   train_loss = 0.5341379821300507
2023-04-24 09:15:14,525 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 09:15:14,525 - Detection -   best_eval_score = 87.27
2023-04-24 09:15:14,525 - Detection -   eval_score = 89.66
2023-04-24 09:15:14,525 - Detection -   train_loss = 0.34715795516967773
2023-04-24 09:15:24,238 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 09:15:24,239 - Detection -   best_eval_score = 89.66
2023-04-24 09:15:24,239 - Detection -   eval_score = 88.86
2023-04-24 09:15:24,239 - Detection -   train_loss = 0.24141919016838073
2023-04-24 09:15:33,865 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 09:15:33,865 - Detection -   best_eval_score = 89.66
2023-04-24 09:15:33,865 - Detection -   eval_score = 88.86
2023-04-24 09:15:33,865 - Detection -   train_loss = 0.1636221170425415
2023-04-24 09:15:43,594 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 09:15:43,595 - Detection -   best_eval_score = 89.66
2023-04-24 09:15:43,595 - Detection -   eval_score = 88.59
2023-04-24 09:15:43,595 - Detection -   train_loss = 0.103097365796566
2023-04-24 09:15:53,179 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 09:15:53,179 - Detection -   best_eval_score = 89.66
2023-04-24 09:15:53,179 - Detection -   eval_score = 89.12
2023-04-24 09:15:53,179 - Detection -   train_loss = 0.08007291033864021
2023-04-24 09:16:02,929 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 09:16:02,929 - Detection -   best_eval_score = 89.66
2023-04-24 09:16:02,929 - Detection -   eval_score = 89.39
2023-04-24 09:16:02,929 - Detection -   train_loss = 0.05273088067770004
2023-04-24 09:16:12,549 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 09:16:12,549 - Detection -   best_eval_score = 89.66
2023-04-24 09:16:12,549 - Detection -   eval_score = 89.66
2023-04-24 09:16:12,549 - Detection -   train_loss = 0.04162511676549911
2023-04-24 09:16:22,204 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 09:16:22,204 - Detection -   best_eval_score = 89.66
2023-04-24 09:16:22,204 - Detection -   eval_score = 88.06
2023-04-24 09:16:22,204 - Detection -   train_loss = 0.02864902690052986
2023-04-24 09:16:31,809 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 09:16:31,809 - Detection -   best_eval_score = 89.66
2023-04-24 09:16:31,809 - Detection -   eval_score = 88.86
2023-04-24 09:16:31,809 - Detection -   train_loss = 0.035143109038472176
2023-04-24 09:16:41,401 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 09:16:41,402 - Detection -   best_eval_score = 89.66
2023-04-24 09:16:41,402 - Detection -   eval_score = 89.66
2023-04-24 09:16:41,402 - Detection -   train_loss = 0.034386268258094786
2023-04-24 09:16:51,099 - Detection - ***** Epoch: 16: Eval results *****
2023-04-24 09:16:51,099 - Detection -   best_eval_score = 89.66
2023-04-24 09:16:51,099 - Detection -   eval_score = 89.66
2023-04-24 09:16:51,099 - Detection -   train_loss = 0.020079960487782954
2023-04-24 09:16:51,099 - Detection - Pre-training finished...
2023-04-24 09:16:51,099 - Detection - Training Begin...
2023-04-24 09:16:52,498 - Detection - ***** Epoch: 1: Eval results *****
2023-04-24 09:16:52,498 - Detection -   best_eval_score = 0
2023-04-24 09:16:52,498 - Detection -   eval_score = 0.0
2023-04-24 09:16:52,498 - Detection -   train_loss = 6.92868013381958
2023-04-24 09:16:53,388 - Detection - ***** Epoch: 2: Eval results *****
2023-04-24 09:16:53,388 - Detection -   best_eval_score = 0
2023-04-24 09:16:53,388 - Detection -   eval_score = 0.0
2023-04-24 09:16:53,388 - Detection -   train_loss = 6.801725387573242
2023-04-24 09:16:54,278 - Detection - ***** Epoch: 3: Eval results *****
2023-04-24 09:16:54,278 - Detection -   best_eval_score = 0
2023-04-24 09:16:54,279 - Detection -   eval_score = 0.0
2023-04-24 09:16:54,279 - Detection -   train_loss = 6.712376689910888
2023-04-24 09:16:55,169 - Detection - ***** Epoch: 4: Eval results *****
2023-04-24 09:16:55,169 - Detection -   best_eval_score = 0
2023-04-24 09:16:55,169 - Detection -   eval_score = 0.0
2023-04-24 09:16:55,169 - Detection -   train_loss = 6.601381015777588
2023-04-24 09:16:56,059 - Detection - ***** Epoch: 5: Eval results *****
2023-04-24 09:16:56,059 - Detection -   best_eval_score = 0
2023-04-24 09:16:56,059 - Detection -   eval_score = 0.0
2023-04-24 09:16:56,059 - Detection -   train_loss = 6.471700191497803
2023-04-24 09:16:56,951 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 09:16:56,951 - Detection -   best_eval_score = 0
2023-04-24 09:16:56,951 - Detection -   eval_score = 0.0
2023-04-24 09:16:56,951 - Detection -   train_loss = 6.296478939056397
2023-04-24 09:16:57,843 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 09:16:57,843 - Detection -   best_eval_score = 0
2023-04-24 09:16:57,843 - Detection -   eval_score = 0.0
2023-04-24 09:16:57,843 - Detection -   train_loss = 6.139616012573242
2023-04-24 09:16:58,735 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 09:16:58,735 - Detection -   best_eval_score = 0
2023-04-24 09:16:58,735 - Detection -   eval_score = 0.0
2023-04-24 09:16:58,735 - Detection -   train_loss = 5.934780693054199
2023-04-24 09:16:59,626 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 09:16:59,626 - Detection -   best_eval_score = 0
2023-04-24 09:16:59,626 - Detection -   eval_score = 0.0
2023-04-24 09:16:59,626 - Detection -   train_loss = 5.706793975830078
2023-04-24 09:17:00,518 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 09:17:00,518 - Detection -   best_eval_score = 0
2023-04-24 09:17:00,518 - Detection -   eval_score = 0.0
2023-04-24 09:17:00,518 - Detection -   train_loss = 5.460334300994873
2023-04-24 09:17:01,410 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 09:17:01,410 - Detection -   best_eval_score = 0
2023-04-24 09:17:01,411 - Detection -   eval_score = 0.0
2023-04-24 09:17:01,411 - Detection -   train_loss = 5.174987506866455
2023-04-24 09:17:02,304 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 09:17:02,304 - Detection -   best_eval_score = 0
2023-04-24 09:17:02,304 - Detection -   eval_score = 0.41
2023-04-24 09:17:02,304 - Detection -   train_loss = 4.950942420959473
2023-04-24 09:17:11,860 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 09:17:11,860 - Detection -   best_eval_score = 0.41
2023-04-24 09:17:11,860 - Detection -   eval_score = 63.65
2023-04-24 09:17:11,860 - Detection -   train_loss = 4.630861091613769
2023-04-24 09:17:21,556 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 09:17:21,556 - Detection -   best_eval_score = 63.65
2023-04-24 09:17:21,556 - Detection -   eval_score = 71.18
2023-04-24 09:17:21,556 - Detection -   train_loss = 1.447799849510193
2023-04-24 09:17:31,135 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 09:17:31,136 - Detection -   best_eval_score = 71.18
2023-04-24 09:17:31,136 - Detection -   eval_score = 71.01
2023-04-24 09:17:31,136 - Detection -   train_loss = 1.1065951466560364
2023-04-24 09:17:40,785 - Detection - ***** Epoch: 16: Eval results *****
2023-04-24 09:17:40,785 - Detection -   best_eval_score = 71.18
2023-04-24 09:17:40,785 - Detection -   eval_score = 71.04
2023-04-24 09:17:40,785 - Detection -   train_loss = 1.0861786365509034
2023-04-24 09:17:50,312 - Detection - ***** Epoch: 17: Eval results *****
2023-04-24 09:17:50,312 - Detection -   best_eval_score = 71.18
2023-04-24 09:17:50,312 - Detection -   eval_score = 70.9
2023-04-24 09:17:50,312 - Detection -   train_loss = 1.0900097608566284
2023-04-24 09:17:59,967 - Detection - ***** Epoch: 18: Eval results *****
2023-04-24 09:17:59,967 - Detection -   best_eval_score = 71.18
2023-04-24 09:17:59,967 - Detection -   eval_score = 71.26
2023-04-24 09:17:59,967 - Detection -   train_loss = 1.07997670173645
2023-04-24 09:18:09,533 - Detection - ***** Epoch: 19: Eval results *****
2023-04-24 09:18:09,533 - Detection -   best_eval_score = 71.26
2023-04-24 09:18:09,533 - Detection -   eval_score = 71.15
2023-04-24 09:18:09,533 - Detection -   train_loss = 1.1031761169433594
2023-04-24 09:18:19,271 - Detection - ***** Epoch: 20: Eval results *****
2023-04-24 09:18:19,271 - Detection -   best_eval_score = 71.26
2023-04-24 09:18:19,271 - Detection -   eval_score = 71.01
2023-04-24 09:18:19,271 - Detection -   train_loss = 1.1316180944442749
2023-04-24 09:18:28,950 - Detection - ***** Epoch: 21: Eval results *****
2023-04-24 09:18:28,950 - Detection -   best_eval_score = 71.26
2023-04-24 09:18:28,950 - Detection -   eval_score = 71.43
2023-04-24 09:18:28,950 - Detection -   train_loss = 1.1053837060928344
2023-04-24 09:18:38,607 - Detection - ***** Epoch: 22: Eval results *****
2023-04-24 09:18:38,607 - Detection -   best_eval_score = 71.43
2023-04-24 09:18:38,607 - Detection -   eval_score = 71.01
2023-04-24 09:18:38,607 - Detection -   train_loss = 1.0763859272003173
2023-04-24 09:18:48,185 - Detection - ***** Epoch: 23: Eval results *****
2023-04-24 09:18:48,185 - Detection -   best_eval_score = 71.43
2023-04-24 09:18:48,185 - Detection -   eval_score = 71.01
2023-04-24 09:18:48,185 - Detection -   train_loss = 1.095010471343994
2023-04-24 09:18:57,763 - Detection - ***** Epoch: 24: Eval results *****
2023-04-24 09:18:57,763 - Detection -   best_eval_score = 71.43
2023-04-24 09:18:57,763 - Detection -   eval_score = 71.04
2023-04-24 09:18:57,763 - Detection -   train_loss = 1.0718919038772583
2023-04-24 09:19:07,400 - Detection - ***** Epoch: 25: Eval results *****
2023-04-24 09:19:07,400 - Detection -   best_eval_score = 71.43
2023-04-24 09:19:07,400 - Detection -   eval_score = 71.04
2023-04-24 09:19:07,400 - Detection -   train_loss = 1.1122938394546509
2023-04-24 09:19:16,941 - Detection - ***** Epoch: 26: Eval results *****
2023-04-24 09:19:16,941 - Detection -   best_eval_score = 71.43
2023-04-24 09:19:16,941 - Detection -   eval_score = 71.01
2023-04-24 09:19:16,941 - Detection -   train_loss = 1.080952000617981
2023-04-24 09:19:26,575 - Detection - ***** Epoch: 27: Eval results *****
2023-04-24 09:19:26,575 - Detection -   best_eval_score = 71.43
2023-04-24 09:19:26,575 - Detection -   eval_score = 71.4
2023-04-24 09:19:26,575 - Detection -   train_loss = 1.0984660863876343
2023-04-24 09:19:36,103 - Detection - ***** Epoch: 28: Eval results *****
2023-04-24 09:19:36,103 - Detection -   best_eval_score = 71.43
2023-04-24 09:19:36,103 - Detection -   eval_score = 71.29
2023-04-24 09:19:36,103 - Detection -   train_loss = 1.1216715812683105
2023-04-24 09:19:45,685 - Detection - ***** Epoch: 29: Eval results *****
2023-04-24 09:19:45,685 - Detection -   best_eval_score = 71.43
2023-04-24 09:19:45,685 - Detection -   eval_score = 71.15
2023-04-24 09:19:45,685 - Detection -   train_loss = 1.11493239402771
2023-04-24 09:19:55,389 - Detection - ***** Epoch: 30: Eval results *****
2023-04-24 09:19:55,389 - Detection -   best_eval_score = 71.43
2023-04-24 09:19:55,389 - Detection -   eval_score = 71.15
2023-04-24 09:19:55,389 - Detection -   train_loss = 1.1096278429031372
2023-04-24 09:20:04,911 - Detection - ***** Epoch: 31: Eval results *****
2023-04-24 09:20:04,911 - Detection -   best_eval_score = 71.43
2023-04-24 09:20:04,911 - Detection -   eval_score = 71.01
2023-04-24 09:20:04,911 - Detection -   train_loss = 1.0923050165176391
2023-04-24 09:20:04,912 - Detection - Training Finished...
2023-04-24 09:20:04,912 - Detection - Testing begin...
2023-04-24 09:20:07,302 - Detection - ***** Test: Confusion Matrix *****
2023-04-24 09:20:07,303 - Detection - [[  91    1    2    0    1   29]
 [   3   90    1    0    6   39]
 [   0    2  112    0    2   54]
 [   0    1    3  109    1   35]
 [   0    1    1    0  110   16]
 [ 190  119  182   33  200 1471]]
2023-04-24 09:20:07,303 - Detection - ***** Test results *****
2023-04-24 09:20:07,303 - Detection -   Acc = 68.26
2023-04-24 09:20:07,303 - Detection -   F1 = 57.3023
2023-04-24 09:20:07,303 - Detection -   F1-known = 53.4358
2023-04-24 09:20:07,303 - Detection -   F1-open = 76.6345
2023-04-24 09:20:07,303 - Detection - Testing finished...
2023-04-24 09:20:07,303 - Detection - Results saved in results/results_ADB-BOOST-F-10.csv
2023-04-24 09:20:07,321 - Detection - Open Intent Detection Finished...
