2023-04-19 18:42:03,353 - Detection - Open Intent Detection Begin...
2023-04-19 18:42:03,353 - Detection - Parameters Initialization...
2023-04-19 18:42:03,353 - Detection - ============================== Params ==============================
2023-04-19 18:42:03,353 - Detection - type:	open_intent_detection
2023-04-19 18:42:03,353 - Detection - logger_name:	Detection
2023-04-19 18:42:03,353 - Detection - log_dir:	logs
2023-04-19 18:42:03,353 - Detection - dataset:	banking_cg
2023-04-19 18:42:03,353 - Detection - known_cls_ratio:	0.25
2023-04-19 18:42:03,353 - Detection - labeled_ratio:	1.0
2023-04-19 18:42:03,353 - Detection - method:	DA-ADB
2023-04-19 18:42:03,353 - Detection - train:	True
2023-04-19 18:42:03,353 - Detection - pretrain:	True
2023-04-19 18:42:03,353 - Detection - save_model:	True
2023-04-19 18:42:03,353 - Detection - backbone:	bert_disaware
2023-04-19 18:42:03,353 - Detection - config_file_name:	DA-ADB
2023-04-19 18:42:03,354 - Detection - seed:	8
2023-04-19 18:42:03,354 - Detection - gpu_id:	0
2023-04-19 18:42:03,354 - Detection - pipe_results_path:	pipe_results
2023-04-19 18:42:03,354 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-19 18:42:03,354 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-19 18:42:03,354 - Detection - model_dir:	models
2023-04-19 18:42:03,354 - Detection - load_pretrained_method:	None
2023-04-19 18:42:03,354 - Detection - result_dir:	results
2023-04-19 18:42:03,354 - Detection - results_file_name:	results_DA-ADB.csv
2023-04-19 18:42:03,354 - Detection - save_results:	True
2023-04-19 18:42:03,354 - Detection - loss_fct:	CrossEntropyLoss
2023-04-19 18:42:03,354 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_cg_0.25_1.0_bert_disaware_8
2023-04-19 18:42:03,354 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_cg_0.25_1.0_bert_disaware_8/models
2023-04-19 18:42:03,354 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-19 18:42:03,354 - Detection - num_train_epochs:	100
2023-04-19 18:42:03,354 - Detection - num_labels:	None
2023-04-19 18:42:03,354 - Detection - max_seq_length:	None
2023-04-19 18:42:03,354 - Detection - freeze_backbone_parameters:	True
2023-04-19 18:42:03,354 - Detection - feat_dim:	768
2023-04-19 18:42:03,354 - Detection - warmup_proportion:	0.1
2023-04-19 18:42:03,354 - Detection - scale:	4
2023-04-19 18:42:03,354 - Detection - lr_boundary:	0.05
2023-04-19 18:42:03,354 - Detection - lr:	2e-05
2023-04-19 18:42:03,354 - Detection - activation:	relu
2023-04-19 18:42:03,354 - Detection - train_batch_size:	128
2023-04-19 18:42:03,354 - Detection - eval_batch_size:	64
2023-04-19 18:42:03,354 - Detection - test_batch_size:	64
2023-04-19 18:42:03,354 - Detection - wait_patient:	10
2023-04-19 18:42:03,354 - Detection - ============================== End Params ==============================
2023-04-19 18:42:03,354 - Detection - Data and Model Preparation...
2023-04-19 18:42:03,355 - Detection - The number of known intents is 19
2023-04-19 18:42:03,355 - Detection - Lists of known labels are: ['getting_spare_card', 'failed_transfer', 'virtual_card_not_working', 'apple_pay_or_google_pay', 'pending_card_payment', 'order_physical_card', 'activate_my_card', 'card_arrival', 'card_payment_fee_charged', 'card_swallowed', 'verify_top_up', 'exchange_rate', 'passcode_forgotten', 'pending_cash_withdrawal', 'topping_up_by_card', 'exchange_charge', 'pin_blocked', 'compromised_card', 'visa_or_mastercard']
2023-04-19 18:42:03,363 - Detection - Number of labeled training samples = 612
2023-04-19 18:42:03,363 - Detection - Number of unlabeled training samples = 2163
2023-04-19 18:42:03,365 - Detection - Number of evaluation samples = 185
2023-04-19 18:42:03,369 - Detection - Number of testing samples = 1896
2023-04-19 18:42:08,843 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-19 18:42:08,926 - Detection - Pre-training Begin...
2023-04-19 18:42:10,928 - Detection - ***** Epoch: 1: Eval results *****
2023-04-19 18:42:10,928 - Detection -   best_eval_score = 0
2023-04-19 18:42:10,928 - Detection -   eval_score = 1.49
2023-04-19 18:42:10,928 - Detection -   train_loss = 2.932811737060547
2023-04-19 18:42:12,422 - Detection - ***** Epoch: 2: Eval results *****
2023-04-19 18:42:12,422 - Detection -   best_eval_score = 1.49
2023-04-19 18:42:12,422 - Detection -   eval_score = 3.22
2023-04-19 18:42:12,422 - Detection -   train_loss = 2.9143452644348145
2023-04-19 18:42:13,920 - Detection - ***** Epoch: 3: Eval results *****
2023-04-19 18:42:13,920 - Detection -   best_eval_score = 3.22
2023-04-19 18:42:13,920 - Detection -   eval_score = 0.89
2023-04-19 18:42:13,920 - Detection -   train_loss = 2.874116039276123
2023-04-19 18:42:15,406 - Detection - ***** Epoch: 4: Eval results *****
2023-04-19 18:42:15,406 - Detection -   best_eval_score = 3.22
2023-04-19 18:42:15,406 - Detection -   eval_score = 0.94
2023-04-19 18:42:15,406 - Detection -   train_loss = 2.8310482025146486
2023-04-19 18:42:16,893 - Detection - ***** Epoch: 5: Eval results *****
2023-04-19 18:42:16,893 - Detection -   best_eval_score = 3.22
2023-04-19 18:42:16,893 - Detection -   eval_score = 0.94
2023-04-19 18:42:16,893 - Detection -   train_loss = 2.7971761226654053
2023-04-19 18:42:18,380 - Detection - ***** Epoch: 6: Eval results *****
2023-04-19 18:42:18,381 - Detection -   best_eval_score = 3.22
2023-04-19 18:42:18,381 - Detection -   eval_score = 0.94
2023-04-19 18:42:18,381 - Detection -   train_loss = 2.7609200477600098
2023-04-19 18:42:19,869 - Detection - ***** Epoch: 7: Eval results *****
2023-04-19 18:42:19,869 - Detection -   best_eval_score = 3.22
2023-04-19 18:42:19,869 - Detection -   eval_score = 2.63
2023-04-19 18:42:19,869 - Detection -   train_loss = 2.730705976486206
2023-04-19 18:42:21,360 - Detection - ***** Epoch: 8: Eval results *****
2023-04-19 18:42:21,360 - Detection -   best_eval_score = 3.22
2023-04-19 18:42:21,360 - Detection -   eval_score = 2.34
2023-04-19 18:42:21,360 - Detection -   train_loss = 2.695619297027588
2023-04-19 18:42:22,850 - Detection - ***** Epoch: 9: Eval results *****
2023-04-19 18:42:22,850 - Detection -   best_eval_score = 3.22
2023-04-19 18:42:22,850 - Detection -   eval_score = 2.52
2023-04-19 18:42:22,850 - Detection -   train_loss = 2.6634895324707033
2023-04-19 18:42:24,341 - Detection - ***** Epoch: 10: Eval results *****
2023-04-19 18:42:24,341 - Detection -   best_eval_score = 3.22
2023-04-19 18:42:24,341 - Detection -   eval_score = 2.62
2023-04-19 18:42:24,341 - Detection -   train_loss = 2.6228281021118165
2023-04-19 18:42:25,834 - Detection - ***** Epoch: 11: Eval results *****
2023-04-19 18:42:25,834 - Detection -   best_eval_score = 3.22
2023-04-19 18:42:25,834 - Detection -   eval_score = 5.53
2023-04-19 18:42:25,834 - Detection -   train_loss = 2.557400941848755
2023-04-19 18:42:27,338 - Detection - ***** Epoch: 12: Eval results *****
2023-04-19 18:42:27,338 - Detection -   best_eval_score = 5.53
2023-04-19 18:42:27,338 - Detection -   eval_score = 6.67
2023-04-19 18:42:27,338 - Detection -   train_loss = 2.4860106468200684
2023-04-19 18:42:28,843 - Detection - ***** Epoch: 13: Eval results *****
2023-04-19 18:42:28,843 - Detection -   best_eval_score = 6.67
2023-04-19 18:42:28,843 - Detection -   eval_score = 12.58
2023-04-19 18:42:28,843 - Detection -   train_loss = 2.3769240379333496
2023-04-19 18:42:30,348 - Detection - ***** Epoch: 14: Eval results *****
2023-04-19 18:42:30,348 - Detection -   best_eval_score = 12.58
2023-04-19 18:42:30,348 - Detection -   eval_score = 16.0
2023-04-19 18:42:30,348 - Detection -   train_loss = 2.2563662052154543
2023-04-19 18:42:31,853 - Detection - ***** Epoch: 15: Eval results *****
2023-04-19 18:42:31,854 - Detection -   best_eval_score = 16.0
2023-04-19 18:42:31,854 - Detection -   eval_score = 19.6
2023-04-19 18:42:31,854 - Detection -   train_loss = 2.1301811218261717
2023-04-19 18:42:33,360 - Detection - ***** Epoch: 16: Eval results *****
2023-04-19 18:42:33,360 - Detection -   best_eval_score = 19.6
2023-04-19 18:42:33,360 - Detection -   eval_score = 29.91
2023-04-19 18:42:33,360 - Detection -   train_loss = 2.002512526512146
2023-04-19 18:42:34,867 - Detection - ***** Epoch: 17: Eval results *****
2023-04-19 18:42:34,868 - Detection -   best_eval_score = 29.91
2023-04-19 18:42:34,868 - Detection -   eval_score = 36.77
2023-04-19 18:42:34,868 - Detection -   train_loss = 1.8577174901962281
2023-04-19 18:42:36,373 - Detection - ***** Epoch: 18: Eval results *****
2023-04-19 18:42:36,373 - Detection -   best_eval_score = 36.77
2023-04-19 18:42:36,373 - Detection -   eval_score = 46.49
2023-04-19 18:42:36,373 - Detection -   train_loss = 1.7503790140151978
2023-04-19 18:42:37,883 - Detection - ***** Epoch: 19: Eval results *****
2023-04-19 18:42:37,883 - Detection -   best_eval_score = 46.49
2023-04-19 18:42:37,883 - Detection -   eval_score = 47.9
2023-04-19 18:42:37,883 - Detection -   train_loss = 1.6340507984161377
2023-04-19 18:42:39,497 - Detection - ***** Epoch: 20: Eval results *****
2023-04-19 18:42:39,497 - Detection -   best_eval_score = 47.9
2023-04-19 18:42:39,497 - Detection -   eval_score = 54.94
2023-04-19 18:42:39,497 - Detection -   train_loss = 1.5479581832885743
2023-04-19 18:42:41,006 - Detection - ***** Epoch: 21: Eval results *****
2023-04-19 18:42:41,006 - Detection -   best_eval_score = 54.94
2023-04-19 18:42:41,006 - Detection -   eval_score = 60.07
2023-04-19 18:42:41,006 - Detection -   train_loss = 1.4700579643249512
2023-04-19 18:42:42,516 - Detection - ***** Epoch: 22: Eval results *****
2023-04-19 18:42:42,516 - Detection -   best_eval_score = 60.07
2023-04-19 18:42:42,516 - Detection -   eval_score = 60.87
2023-04-19 18:42:42,516 - Detection -   train_loss = 1.3972562313079835
2023-04-19 18:42:44,027 - Detection - ***** Epoch: 23: Eval results *****
2023-04-19 18:42:44,028 - Detection -   best_eval_score = 60.87
2023-04-19 18:42:44,028 - Detection -   eval_score = 61.84
2023-04-19 18:42:44,028 - Detection -   train_loss = 1.3558559894561768
2023-04-19 18:42:45,539 - Detection - ***** Epoch: 24: Eval results *****
2023-04-19 18:42:45,539 - Detection -   best_eval_score = 61.84
2023-04-19 18:42:45,539 - Detection -   eval_score = 63.89
2023-04-19 18:42:45,539 - Detection -   train_loss = 1.2933034420013427
2023-04-19 18:42:47,051 - Detection - ***** Epoch: 25: Eval results *****
2023-04-19 18:42:47,051 - Detection -   best_eval_score = 63.89
2023-04-19 18:42:47,051 - Detection -   eval_score = 63.84
2023-04-19 18:42:47,051 - Detection -   train_loss = 1.2496156215667724
2023-04-19 18:42:48,553 - Detection - ***** Epoch: 26: Eval results *****
2023-04-19 18:42:48,554 - Detection -   best_eval_score = 63.89
2023-04-19 18:42:48,554 - Detection -   eval_score = 65.73
2023-04-19 18:42:48,554 - Detection -   train_loss = 1.203974151611328
2023-04-19 18:42:50,067 - Detection - ***** Epoch: 27: Eval results *****
2023-04-19 18:42:50,068 - Detection -   best_eval_score = 65.73
2023-04-19 18:42:50,068 - Detection -   eval_score = 68.17
2023-04-19 18:42:50,068 - Detection -   train_loss = 1.1702759981155395
2023-04-19 18:42:51,583 - Detection - ***** Epoch: 28: Eval results *****
2023-04-19 18:42:51,583 - Detection -   best_eval_score = 68.17
2023-04-19 18:42:51,583 - Detection -   eval_score = 67.53
2023-04-19 18:42:51,583 - Detection -   train_loss = 1.1415120124816895
2023-04-19 18:42:53,085 - Detection - ***** Epoch: 29: Eval results *****
2023-04-19 18:42:53,085 - Detection -   best_eval_score = 68.17
2023-04-19 18:42:53,085 - Detection -   eval_score = 67.42
2023-04-19 18:42:53,085 - Detection -   train_loss = 1.1087491273880006
2023-04-19 18:42:54,588 - Detection - ***** Epoch: 30: Eval results *****
2023-04-19 18:42:54,588 - Detection -   best_eval_score = 68.17
2023-04-19 18:42:54,588 - Detection -   eval_score = 69.25
2023-04-19 18:42:54,588 - Detection -   train_loss = 1.0821521282196045
2023-04-19 18:42:56,102 - Detection - ***** Epoch: 31: Eval results *****
2023-04-19 18:42:56,102 - Detection -   best_eval_score = 69.25
2023-04-19 18:42:56,102 - Detection -   eval_score = 69.81
2023-04-19 18:42:56,102 - Detection -   train_loss = 1.067643165588379
2023-04-19 18:42:57,618 - Detection - ***** Epoch: 32: Eval results *****
2023-04-19 18:42:57,618 - Detection -   best_eval_score = 69.81
2023-04-19 18:42:57,618 - Detection -   eval_score = 69.81
2023-04-19 18:42:57,618 - Detection -   train_loss = 1.044940745830536
2023-04-19 18:42:59,122 - Detection - ***** Epoch: 33: Eval results *****
2023-04-19 18:42:59,122 - Detection -   best_eval_score = 69.81
2023-04-19 18:42:59,122 - Detection -   eval_score = 72.87
2023-04-19 18:42:59,122 - Detection -   train_loss = 1.0232118368148804
2023-04-19 18:43:00,638 - Detection - ***** Epoch: 34: Eval results *****
2023-04-19 18:43:00,639 - Detection -   best_eval_score = 72.87
2023-04-19 18:43:00,639 - Detection -   eval_score = 72.93
2023-04-19 18:43:00,639 - Detection -   train_loss = 1.0029848098754883
2023-04-19 18:43:02,155 - Detection - ***** Epoch: 35: Eval results *****
2023-04-19 18:43:02,155 - Detection -   best_eval_score = 72.93
2023-04-19 18:43:02,155 - Detection -   eval_score = 73.73
2023-04-19 18:43:02,155 - Detection -   train_loss = 0.998000419139862
2023-04-19 18:43:03,673 - Detection - ***** Epoch: 36: Eval results *****
2023-04-19 18:43:03,673 - Detection -   best_eval_score = 73.73
2023-04-19 18:43:03,673 - Detection -   eval_score = 73.57
2023-04-19 18:43:03,673 - Detection -   train_loss = 0.9751765489578247
2023-04-19 18:43:05,181 - Detection - ***** Epoch: 37: Eval results *****
2023-04-19 18:43:05,181 - Detection -   best_eval_score = 73.73
2023-04-19 18:43:05,181 - Detection -   eval_score = 73.57
2023-04-19 18:43:05,181 - Detection -   train_loss = 0.9542869687080383
2023-04-19 18:43:06,688 - Detection - ***** Epoch: 38: Eval results *****
2023-04-19 18:43:06,688 - Detection -   best_eval_score = 73.73
2023-04-19 18:43:06,688 - Detection -   eval_score = 73.09
2023-04-19 18:43:06,688 - Detection -   train_loss = 0.9504436373710632
2023-04-19 18:43:08,196 - Detection - ***** Epoch: 39: Eval results *****
2023-04-19 18:43:08,196 - Detection -   best_eval_score = 73.73
2023-04-19 18:43:08,196 - Detection -   eval_score = 75.1
2023-04-19 18:43:08,196 - Detection -   train_loss = 0.9352853059768677
2023-04-19 18:43:09,716 - Detection - ***** Epoch: 40: Eval results *****
2023-04-19 18:43:09,716 - Detection -   best_eval_score = 75.1
2023-04-19 18:43:09,716 - Detection -   eval_score = 74.47
2023-04-19 18:43:09,716 - Detection -   train_loss = 0.9221107006072998
2023-04-19 18:43:11,225 - Detection - ***** Epoch: 41: Eval results *****
2023-04-19 18:43:11,225 - Detection -   best_eval_score = 75.1
2023-04-19 18:43:11,225 - Detection -   eval_score = 75.34
2023-04-19 18:43:11,225 - Detection -   train_loss = 0.9128396034240722
2023-04-19 18:43:12,744 - Detection - ***** Epoch: 42: Eval results *****
2023-04-19 18:43:12,745 - Detection -   best_eval_score = 75.34
2023-04-19 18:43:12,745 - Detection -   eval_score = 75.23
2023-04-19 18:43:12,745 - Detection -   train_loss = 0.8981172323226929
2023-04-19 18:43:14,254 - Detection - ***** Epoch: 43: Eval results *****
2023-04-19 18:43:14,254 - Detection -   best_eval_score = 75.34
2023-04-19 18:43:14,254 - Detection -   eval_score = 76.75
2023-04-19 18:43:14,254 - Detection -   train_loss = 0.8967366218566895
2023-04-19 18:43:15,774 - Detection - ***** Epoch: 44: Eval results *****
2023-04-19 18:43:15,774 - Detection -   best_eval_score = 76.75
2023-04-19 18:43:15,774 - Detection -   eval_score = 77.92
2023-04-19 18:43:15,774 - Detection -   train_loss = 0.8830097436904907
2023-04-19 18:43:17,292 - Detection - ***** Epoch: 45: Eval results *****
2023-04-19 18:43:17,292 - Detection -   best_eval_score = 77.92
2023-04-19 18:43:17,292 - Detection -   eval_score = 77.92
2023-04-19 18:43:17,292 - Detection -   train_loss = 0.8713050484657288
2023-04-19 18:43:18,797 - Detection - ***** Epoch: 46: Eval results *****
2023-04-19 18:43:18,797 - Detection -   best_eval_score = 77.92
2023-04-19 18:43:18,797 - Detection -   eval_score = 78.5
2023-04-19 18:43:18,797 - Detection -   train_loss = 0.8710877537727356
2023-04-19 18:43:20,315 - Detection - ***** Epoch: 47: Eval results *****
2023-04-19 18:43:20,315 - Detection -   best_eval_score = 78.5
2023-04-19 18:43:20,315 - Detection -   eval_score = 79.23
2023-04-19 18:43:20,315 - Detection -   train_loss = 0.8618717312812805
2023-04-19 18:43:21,833 - Detection - ***** Epoch: 48: Eval results *****
2023-04-19 18:43:21,833 - Detection -   best_eval_score = 79.23
2023-04-19 18:43:21,833 - Detection -   eval_score = 78.61
2023-04-19 18:43:21,833 - Detection -   train_loss = 0.8497075796127319
2023-04-19 18:43:23,339 - Detection - ***** Epoch: 49: Eval results *****
2023-04-19 18:43:23,339 - Detection -   best_eval_score = 79.23
2023-04-19 18:43:23,339 - Detection -   eval_score = 78.61
2023-04-19 18:43:23,339 - Detection -   train_loss = 0.8504552364349365
2023-04-19 18:43:24,844 - Detection - ***** Epoch: 50: Eval results *****
2023-04-19 18:43:24,844 - Detection -   best_eval_score = 79.23
2023-04-19 18:43:24,844 - Detection -   eval_score = 79.23
2023-04-19 18:43:24,844 - Detection -   train_loss = 0.8438732981681824
2023-04-19 18:43:26,352 - Detection - ***** Epoch: 51: Eval results *****
2023-04-19 18:43:26,352 - Detection -   best_eval_score = 79.23
2023-04-19 18:43:26,352 - Detection -   eval_score = 80.6
2023-04-19 18:43:26,352 - Detection -   train_loss = 0.831949770450592
2023-04-19 18:43:27,870 - Detection - ***** Epoch: 52: Eval results *****
2023-04-19 18:43:27,870 - Detection -   best_eval_score = 80.6
2023-04-19 18:43:27,870 - Detection -   eval_score = 80.9
2023-04-19 18:43:27,870 - Detection -   train_loss = 0.8317810535430908
2023-04-19 18:43:29,388 - Detection - ***** Epoch: 53: Eval results *****
2023-04-19 18:43:29,388 - Detection -   best_eval_score = 80.9
2023-04-19 18:43:29,388 - Detection -   eval_score = 81.58
2023-04-19 18:43:29,388 - Detection -   train_loss = 0.8242069244384765
2023-04-19 18:43:30,905 - Detection - ***** Epoch: 54: Eval results *****
2023-04-19 18:43:30,905 - Detection -   best_eval_score = 81.58
2023-04-19 18:43:30,905 - Detection -   eval_score = 82.23
2023-04-19 18:43:30,905 - Detection -   train_loss = 0.8217548131942749
2023-04-19 18:43:32,522 - Detection - ***** Epoch: 55: Eval results *****
2023-04-19 18:43:32,522 - Detection -   best_eval_score = 82.23
2023-04-19 18:43:32,522 - Detection -   eval_score = 80.58
2023-04-19 18:43:32,522 - Detection -   train_loss = 0.8225086808204651
2023-04-19 18:43:34,028 - Detection - ***** Epoch: 56: Eval results *****
2023-04-19 18:43:34,028 - Detection -   best_eval_score = 82.23
2023-04-19 18:43:34,028 - Detection -   eval_score = 82.71
2023-04-19 18:43:34,028 - Detection -   train_loss = 0.8122549057006836
2023-04-19 18:43:35,545 - Detection - ***** Epoch: 57: Eval results *****
2023-04-19 18:43:35,545 - Detection -   best_eval_score = 82.71
2023-04-19 18:43:35,545 - Detection -   eval_score = 82.71
2023-04-19 18:43:35,545 - Detection -   train_loss = 0.8129814505577088
2023-04-19 18:43:37,052 - Detection - ***** Epoch: 58: Eval results *****
2023-04-19 18:43:37,052 - Detection -   best_eval_score = 82.71
2023-04-19 18:43:37,052 - Detection -   eval_score = 82.09
2023-04-19 18:43:37,052 - Detection -   train_loss = 0.8051562905311584
2023-04-19 18:43:38,557 - Detection - ***** Epoch: 59: Eval results *****
2023-04-19 18:43:38,557 - Detection -   best_eval_score = 82.71
2023-04-19 18:43:38,558 - Detection -   eval_score = 82.13
2023-04-19 18:43:38,558 - Detection -   train_loss = 0.8052797555923462
2023-04-19 18:43:40,064 - Detection - ***** Epoch: 60: Eval results *****
2023-04-19 18:43:40,064 - Detection -   best_eval_score = 82.71
2023-04-19 18:43:40,064 - Detection -   eval_score = 82.95
2023-04-19 18:43:40,064 - Detection -   train_loss = 0.7968372702598572
2023-04-19 18:43:41,582 - Detection - ***** Epoch: 61: Eval results *****
2023-04-19 18:43:41,582 - Detection -   best_eval_score = 82.95
2023-04-19 18:43:41,582 - Detection -   eval_score = 83.42
2023-04-19 18:43:41,582 - Detection -   train_loss = 0.7919282078742981
2023-04-19 18:43:43,099 - Detection - ***** Epoch: 62: Eval results *****
2023-04-19 18:43:43,099 - Detection -   best_eval_score = 83.42
2023-04-19 18:43:43,099 - Detection -   eval_score = 83.33
2023-04-19 18:43:43,099 - Detection -   train_loss = 0.7950028419494629
2023-04-19 18:43:44,603 - Detection - ***** Epoch: 63: Eval results *****
2023-04-19 18:43:44,603 - Detection -   best_eval_score = 83.42
2023-04-19 18:43:44,604 - Detection -   eval_score = 83.31
2023-04-19 18:43:44,604 - Detection -   train_loss = 0.786210548877716
2023-04-19 18:43:46,109 - Detection - ***** Epoch: 64: Eval results *****
2023-04-19 18:43:46,109 - Detection -   best_eval_score = 83.42
2023-04-19 18:43:46,109 - Detection -   eval_score = 84.24
2023-04-19 18:43:46,109 - Detection -   train_loss = 0.7856790781021118
2023-04-19 18:43:47,625 - Detection - ***** Epoch: 65: Eval results *****
2023-04-19 18:43:47,625 - Detection -   best_eval_score = 84.24
2023-04-19 18:43:47,625 - Detection -   eval_score = 84.89
2023-04-19 18:43:47,625 - Detection -   train_loss = 0.7824654459953309
2023-04-19 18:43:49,143 - Detection - ***** Epoch: 66: Eval results *****
2023-04-19 18:43:49,143 - Detection -   best_eval_score = 84.89
2023-04-19 18:43:49,143 - Detection -   eval_score = 84.89
2023-04-19 18:43:49,143 - Detection -   train_loss = 0.7774301052093506
2023-04-19 18:43:50,646 - Detection - ***** Epoch: 67: Eval results *****
2023-04-19 18:43:50,646 - Detection -   best_eval_score = 84.89
2023-04-19 18:43:50,646 - Detection -   eval_score = 85.5
2023-04-19 18:43:50,646 - Detection -   train_loss = 0.7782604813575744
2023-04-19 18:43:52,166 - Detection - ***** Epoch: 68: Eval results *****
2023-04-19 18:43:52,166 - Detection -   best_eval_score = 85.5
2023-04-19 18:43:52,166 - Detection -   eval_score = 84.89
2023-04-19 18:43:52,166 - Detection -   train_loss = 0.7796712875366211
2023-04-19 18:43:53,671 - Detection - ***** Epoch: 69: Eval results *****
2023-04-19 18:43:53,671 - Detection -   best_eval_score = 85.5
2023-04-19 18:43:53,671 - Detection -   eval_score = 84.86
2023-04-19 18:43:53,671 - Detection -   train_loss = 0.7801070094108582
2023-04-19 18:43:55,177 - Detection - ***** Epoch: 70: Eval results *****
2023-04-19 18:43:55,178 - Detection -   best_eval_score = 85.5
2023-04-19 18:43:55,178 - Detection -   eval_score = 84.67
2023-04-19 18:43:55,178 - Detection -   train_loss = 0.7763978242874146
2023-04-19 18:43:56,682 - Detection - ***** Epoch: 71: Eval results *****
2023-04-19 18:43:56,682 - Detection -   best_eval_score = 85.5
2023-04-19 18:43:56,683 - Detection -   eval_score = 84.71
2023-04-19 18:43:56,683 - Detection -   train_loss = 0.7745460987091064
2023-04-19 18:43:58,189 - Detection - ***** Epoch: 72: Eval results *****
2023-04-19 18:43:58,189 - Detection -   best_eval_score = 85.5
2023-04-19 18:43:58,189 - Detection -   eval_score = 84.89
2023-04-19 18:43:58,189 - Detection -   train_loss = 0.7693411469459533
2023-04-19 18:43:59,694 - Detection - ***** Epoch: 73: Eval results *****
2023-04-19 18:43:59,694 - Detection -   best_eval_score = 85.5
2023-04-19 18:43:59,694 - Detection -   eval_score = 84.11
2023-04-19 18:43:59,694 - Detection -   train_loss = 0.7720083355903625
2023-04-19 18:44:01,200 - Detection - ***** Epoch: 74: Eval results *****
2023-04-19 18:44:01,200 - Detection -   best_eval_score = 85.5
2023-04-19 18:44:01,201 - Detection -   eval_score = 84.11
2023-04-19 18:44:01,201 - Detection -   train_loss = 0.7716508507728577
2023-04-19 18:44:02,707 - Detection - ***** Epoch: 75: Eval results *****
2023-04-19 18:44:02,708 - Detection -   best_eval_score = 85.5
2023-04-19 18:44:02,708 - Detection -   eval_score = 84.11
2023-04-19 18:44:02,708 - Detection -   train_loss = 0.770490300655365
2023-04-19 18:44:04,212 - Detection - ***** Epoch: 76: Eval results *****
2023-04-19 18:44:04,212 - Detection -   best_eval_score = 85.5
2023-04-19 18:44:04,212 - Detection -   eval_score = 84.89
2023-04-19 18:44:04,212 - Detection -   train_loss = 0.7707850813865662
2023-04-19 18:44:05,716 - Detection - ***** Epoch: 77: Eval results *****
2023-04-19 18:44:05,716 - Detection -   best_eval_score = 85.5
2023-04-19 18:44:05,716 - Detection -   eval_score = 84.89
2023-04-19 18:44:05,717 - Detection -   train_loss = 0.7739478349685669
2023-04-19 18:44:05,717 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_cg_0.25_1.0_bert_disaware_8/models
2023-04-19 18:44:06,264 - Detection - Pre-training finished...
2023-04-19 18:44:06,264 - Detection - Training Begin...
2023-04-19 18:44:07,146 - Detection - ***** Epoch: 1: Eval results *****
2023-04-19 18:44:07,146 - Detection -   best_eval_score = 0
2023-04-19 18:44:07,147 - Detection -   eval_score = 2.86
2023-04-19 18:44:07,147 - Detection -   train_loss = 3.336106538772583
2023-04-19 18:44:08,031 - Detection - ***** Epoch: 2: Eval results *****
2023-04-19 18:44:08,031 - Detection -   best_eval_score = 2.86
2023-04-19 18:44:08,031 - Detection -   eval_score = 5.3
2023-04-19 18:44:08,031 - Detection -   train_loss = 3.2360485076904295
2023-04-19 18:44:08,917 - Detection - ***** Epoch: 3: Eval results *****
2023-04-19 18:44:08,917 - Detection -   best_eval_score = 5.3
2023-04-19 18:44:08,917 - Detection -   eval_score = 5.57
2023-04-19 18:44:08,917 - Detection -   train_loss = 3.0798758029937745
2023-04-19 18:44:09,803 - Detection - ***** Epoch: 4: Eval results *****
2023-04-19 18:44:09,803 - Detection -   best_eval_score = 5.57
2023-04-19 18:44:09,803 - Detection -   eval_score = 7.03
2023-04-19 18:44:09,803 - Detection -   train_loss = 2.932240343093872
2023-04-19 18:44:10,690 - Detection - ***** Epoch: 5: Eval results *****
2023-04-19 18:44:10,691 - Detection -   best_eval_score = 7.03
2023-04-19 18:44:10,691 - Detection -   eval_score = 8.74
2023-04-19 18:44:10,691 - Detection -   train_loss = 2.7869096279144285
2023-04-19 18:44:11,576 - Detection - ***** Epoch: 6: Eval results *****
2023-04-19 18:44:11,576 - Detection -   best_eval_score = 8.74
2023-04-19 18:44:11,576 - Detection -   eval_score = 10.3
2023-04-19 18:44:11,576 - Detection -   train_loss = 2.5659947395324707
2023-04-19 18:44:12,461 - Detection - ***** Epoch: 7: Eval results *****
2023-04-19 18:44:12,461 - Detection -   best_eval_score = 10.3
2023-04-19 18:44:12,461 - Detection -   eval_score = 11.8
2023-04-19 18:44:12,461 - Detection -   train_loss = 2.382359027862549
2023-04-19 18:44:13,347 - Detection - ***** Epoch: 8: Eval results *****
2023-04-19 18:44:13,347 - Detection -   best_eval_score = 11.8
2023-04-19 18:44:13,347 - Detection -   eval_score = 14.9
2023-04-19 18:44:13,347 - Detection -   train_loss = 2.193653917312622
2023-04-19 18:44:14,233 - Detection - ***** Epoch: 9: Eval results *****
2023-04-19 18:44:14,233 - Detection -   best_eval_score = 14.9
2023-04-19 18:44:14,233 - Detection -   eval_score = 23.27
2023-04-19 18:44:14,233 - Detection -   train_loss = 1.9501266717910766
2023-04-19 18:44:15,119 - Detection - ***** Epoch: 10: Eval results *****
2023-04-19 18:44:15,119 - Detection -   best_eval_score = 23.27
2023-04-19 18:44:15,119 - Detection -   eval_score = 31.58
2023-04-19 18:44:15,119 - Detection -   train_loss = 1.7265501260757445
2023-04-19 18:44:16,004 - Detection - ***** Epoch: 11: Eval results *****
2023-04-19 18:44:16,004 - Detection -   best_eval_score = 31.58
2023-04-19 18:44:16,004 - Detection -   eval_score = 36.01
2023-04-19 18:44:16,004 - Detection -   train_loss = 1.4905871152877808
2023-04-19 18:44:16,891 - Detection - ***** Epoch: 12: Eval results *****
2023-04-19 18:44:16,891 - Detection -   best_eval_score = 36.01
2023-04-19 18:44:16,891 - Detection -   eval_score = 44.06
2023-04-19 18:44:16,891 - Detection -   train_loss = 1.27349534034729
2023-04-19 18:44:17,777 - Detection - ***** Epoch: 13: Eval results *****
2023-04-19 18:44:17,777 - Detection -   best_eval_score = 44.06
2023-04-19 18:44:17,777 - Detection -   eval_score = 50.73
2023-04-19 18:44:17,777 - Detection -   train_loss = 1.0818543910980225
2023-04-19 18:44:18,663 - Detection - ***** Epoch: 14: Eval results *****
2023-04-19 18:44:18,663 - Detection -   best_eval_score = 50.73
2023-04-19 18:44:18,663 - Detection -   eval_score = 58.03
2023-04-19 18:44:18,663 - Detection -   train_loss = 0.888452124595642
2023-04-19 18:44:19,548 - Detection - ***** Epoch: 15: Eval results *****
2023-04-19 18:44:19,548 - Detection -   best_eval_score = 58.03
2023-04-19 18:44:19,548 - Detection -   eval_score = 61.78
2023-04-19 18:44:19,548 - Detection -   train_loss = 0.7624347329139709
2023-04-19 18:44:20,433 - Detection - ***** Epoch: 16: Eval results *****
2023-04-19 18:44:20,434 - Detection -   best_eval_score = 61.78
2023-04-19 18:44:20,434 - Detection -   eval_score = 66.31
2023-04-19 18:44:20,434 - Detection -   train_loss = 0.6750969767570496
2023-04-19 18:44:21,319 - Detection - ***** Epoch: 17: Eval results *****
2023-04-19 18:44:21,319 - Detection -   best_eval_score = 66.31
2023-04-19 18:44:21,319 - Detection -   eval_score = 67.71
2023-04-19 18:44:21,319 - Detection -   train_loss = 0.5557001292705536
2023-04-19 18:44:22,205 - Detection - ***** Epoch: 18: Eval results *****
2023-04-19 18:44:22,205 - Detection -   best_eval_score = 67.71
2023-04-19 18:44:22,205 - Detection -   eval_score = 68.24
2023-04-19 18:44:22,205 - Detection -   train_loss = 0.5572094082832336
2023-04-19 18:44:23,090 - Detection - ***** Epoch: 19: Eval results *****
2023-04-19 18:44:23,090 - Detection -   best_eval_score = 68.24
2023-04-19 18:44:23,090 - Detection -   eval_score = 71.43
2023-04-19 18:44:23,090 - Detection -   train_loss = 0.5466943621635437
2023-04-19 18:44:23,976 - Detection - ***** Epoch: 20: Eval results *****
2023-04-19 18:44:23,976 - Detection -   best_eval_score = 71.43
2023-04-19 18:44:23,976 - Detection -   eval_score = 71.43
2023-04-19 18:44:23,976 - Detection -   train_loss = 0.5204380989074707
2023-04-19 18:44:24,860 - Detection - ***** Epoch: 21: Eval results *****
2023-04-19 18:44:24,860 - Detection -   best_eval_score = 71.43
2023-04-19 18:44:24,860 - Detection -   eval_score = 71.43
2023-04-19 18:44:24,860 - Detection -   train_loss = 0.5312791883945465
2023-04-19 18:44:25,745 - Detection - ***** Epoch: 22: Eval results *****
2023-04-19 18:44:25,745 - Detection -   best_eval_score = 71.43
2023-04-19 18:44:25,746 - Detection -   eval_score = 71.43
2023-04-19 18:44:25,746 - Detection -   train_loss = 0.5434460401535034
2023-04-19 18:44:26,631 - Detection - ***** Epoch: 23: Eval results *****
2023-04-19 18:44:26,631 - Detection -   best_eval_score = 71.43
2023-04-19 18:44:26,631 - Detection -   eval_score = 71.43
2023-04-19 18:44:26,631 - Detection -   train_loss = 0.5233489573001862
2023-04-19 18:44:27,516 - Detection - ***** Epoch: 24: Eval results *****
2023-04-19 18:44:27,516 - Detection -   best_eval_score = 71.43
2023-04-19 18:44:27,516 - Detection -   eval_score = 71.43
2023-04-19 18:44:27,516 - Detection -   train_loss = 0.5335647165775299
2023-04-19 18:44:28,402 - Detection - ***** Epoch: 25: Eval results *****
2023-04-19 18:44:28,402 - Detection -   best_eval_score = 71.43
2023-04-19 18:44:28,402 - Detection -   eval_score = 71.43
2023-04-19 18:44:28,402 - Detection -   train_loss = 0.5463557720184327
2023-04-19 18:44:29,287 - Detection - ***** Epoch: 26: Eval results *****
2023-04-19 18:44:29,287 - Detection -   best_eval_score = 71.43
2023-04-19 18:44:29,287 - Detection -   eval_score = 72.01
2023-04-19 18:44:29,287 - Detection -   train_loss = 0.517102575302124
2023-04-19 18:44:30,172 - Detection - ***** Epoch: 27: Eval results *****
2023-04-19 18:44:30,173 - Detection -   best_eval_score = 72.01
2023-04-19 18:44:30,173 - Detection -   eval_score = 72.01
2023-04-19 18:44:30,173 - Detection -   train_loss = 0.518465781211853
2023-04-19 18:44:31,058 - Detection - ***** Epoch: 28: Eval results *****
2023-04-19 18:44:31,058 - Detection -   best_eval_score = 72.01
2023-04-19 18:44:31,058 - Detection -   eval_score = 72.01
2023-04-19 18:44:31,058 - Detection -   train_loss = 0.5226008534431458
2023-04-19 18:44:31,944 - Detection - ***** Epoch: 29: Eval results *****
2023-04-19 18:44:31,944 - Detection -   best_eval_score = 72.01
2023-04-19 18:44:31,944 - Detection -   eval_score = 72.01
2023-04-19 18:44:31,944 - Detection -   train_loss = 0.5227292001247406
2023-04-19 18:44:32,830 - Detection - ***** Epoch: 30: Eval results *****
2023-04-19 18:44:32,830 - Detection -   best_eval_score = 72.01
2023-04-19 18:44:32,830 - Detection -   eval_score = 72.01
2023-04-19 18:44:32,830 - Detection -   train_loss = 0.5170413672924041
2023-04-19 18:44:33,715 - Detection - ***** Epoch: 31: Eval results *****
2023-04-19 18:44:33,716 - Detection -   best_eval_score = 72.01
2023-04-19 18:44:33,716 - Detection -   eval_score = 72.01
2023-04-19 18:44:33,716 - Detection -   train_loss = 0.5414340615272522
2023-04-19 18:44:34,601 - Detection - ***** Epoch: 32: Eval results *****
2023-04-19 18:44:34,601 - Detection -   best_eval_score = 72.01
2023-04-19 18:44:34,601 - Detection -   eval_score = 71.31
2023-04-19 18:44:34,601 - Detection -   train_loss = 0.5340110778808593
2023-04-19 18:44:35,486 - Detection - ***** Epoch: 33: Eval results *****
2023-04-19 18:44:35,486 - Detection -   best_eval_score = 72.01
2023-04-19 18:44:35,486 - Detection -   eval_score = 71.31
2023-04-19 18:44:35,486 - Detection -   train_loss = 0.5228046596050262
2023-04-19 18:44:36,372 - Detection - ***** Epoch: 34: Eval results *****
2023-04-19 18:44:36,372 - Detection -   best_eval_score = 72.01
2023-04-19 18:44:36,372 - Detection -   eval_score = 70.74
2023-04-19 18:44:36,372 - Detection -   train_loss = 0.5055458009243011
2023-04-19 18:44:37,257 - Detection - ***** Epoch: 35: Eval results *****
2023-04-19 18:44:37,257 - Detection -   best_eval_score = 72.01
2023-04-19 18:44:37,257 - Detection -   eval_score = 71.43
2023-04-19 18:44:37,257 - Detection -   train_loss = 0.5422743737697602
2023-04-19 18:44:38,142 - Detection - ***** Epoch: 36: Eval results *****
2023-04-19 18:44:38,142 - Detection -   best_eval_score = 72.01
2023-04-19 18:44:38,142 - Detection -   eval_score = 71.43
2023-04-19 18:44:38,142 - Detection -   train_loss = 0.5092669010162354
2023-04-19 18:44:38,143 - Detection - Training Finished...
2023-04-19 18:44:38,143 - Detection - Testing begin...
2023-04-19 18:44:40,051 - Detection - ***** Test: Confusion Matrix *****
2023-04-19 18:44:40,052 - Detection - [[   2    0    0    0    0    2    0    0    0    0    0    0    0    0
     0    0    0    0    0   25]
 [   0   20    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    7]
 [   0    0    2    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    7]
 [   0    0    0   16    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    6]
 [   0    0    0    0   17    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    9]
 [   3    0    0    0    0    5    0    0    0    0    0    0    0    0
     0    0    0    0    0    7]
 [   0    0    0    0    0    0   26    0    0    0    0    0    0    0
     0    0    0    0    0    5]
 [   0    0    0    0    0    0    0    6    0    0    0    0    0    0
     0    0    0    0    0   18]
 [   0    0    0    0    0    0    0    0   10    0    0    0    0    0
     0    0    0    0    0    7]
 [   0    0    0    0    0    0    0    0    0    9    0    0    0    0
     0    0    0    0    0    8]
 [   0    0    0    0    0    0    0    0    0    0   26    0    0    0
     0    0    0    0    0    3]
 [   0    0    0    0    0    0    0    0    0    0    0   20    0    0
     0    0    0    0    0    2]
 [   0    0    0    0    0    0    0    0    0    0    0    0    8    0
     0    0    0    0    0    8]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0   22
     0    0    0    0    0    7]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     2    0    0    0    0   15]
 [   0    0    0    0    0    0    0    0    0    0    0    1    0    0
     0   17    0    0    0    6]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0   11    0    0   10]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    3    0   15]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0   16    4]
 [   1   42    0    0    6    7    1    4   68    1    0    9    1   40
     0   13    4    0    2 1284]]
2023-04-19 18:44:40,052 - Detection - ***** Test results *****
2023-04-19 18:44:40,052 - Detection -   Acc = 80.27
2023-04-19 18:44:40,052 - Detection -   F1 = 56.134
2023-04-19 18:44:40,052 - Detection -   F1-known = 54.485
2023-04-19 18:44:40,052 - Detection -   F1-open = 87.4659
2023-04-19 18:44:40,052 - Detection - Testing finished...
2023-04-19 18:44:40,052 - Detection - Results saved in results/results_DA-ADB.csv
2023-04-19 18:44:40,071 - Detection - Open Intent Detection Finished...
