2023-04-23 13:10:44,490 - Detection - Open Intent Detection Begin...
2023-04-23 13:10:44,490 - Detection - Parameters Initialization...
2023-04-23 13:10:44,491 - Detection - ============================== Params ==============================
2023-04-23 13:10:44,491 - Detection - type:	open_intent_detection
2023-04-23 13:10:44,491 - Detection - logger_name:	Detection
2023-04-23 13:10:44,491 - Detection - log_dir:	logs
2023-04-23 13:10:44,491 - Detection - dataset:	banking_cg
2023-04-23 13:10:44,491 - Detection - known_cls_ratio:	0.25
2023-04-23 13:10:44,491 - Detection - labeled_ratio:	1.0
2023-04-23 13:10:44,491 - Detection - method:	ADB
2023-04-23 13:10:44,491 - Detection - train:	True
2023-04-23 13:10:44,491 - Detection - pretrain:	True
2023-04-23 13:10:44,491 - Detection - save_model:	False
2023-04-23 13:10:44,491 - Detection - backbone:	bert_boost
2023-04-23 13:10:44,491 - Detection - config_file_name:	ADB
2023-04-23 13:10:44,491 - Detection - seed:	2
2023-04-23 13:10:44,491 - Detection - gpu_id:	0
2023-04-23 13:10:44,491 - Detection - pipe_results_path:	pipe_results
2023-04-23 13:10:44,491 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-23 13:10:44,491 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-23 13:10:44,491 - Detection - model_dir:	models
2023-04-23 13:10:44,491 - Detection - load_pretrained_method:	None
2023-04-23 13:10:44,491 - Detection - result_dir:	results
2023-04-23 13:10:44,491 - Detection - results_file_name:	results_ADB-BOOST-F-10.csv
2023-04-23 13:10:44,491 - Detection - save_results:	True
2023-04-23 13:10:44,491 - Detection - loss_fct:	CrossEntropyLoss
2023-04-23 13:10:44,491 - Detection - boost_method:	F-10
2023-04-23 13:10:44,491 - Detection - boost_start_score:	0.0
2023-04-23 13:10:44,491 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.25_1.0_bert_boost_2
2023-04-23 13:10:44,491 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.25_1.0_bert_boost_2/models
2023-04-23 13:10:44,491 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-23 13:10:44,491 - Detection - num_train_epochs:	100
2023-04-23 13:10:44,491 - Detection - num_labels:	None
2023-04-23 13:10:44,491 - Detection - max_seq_length:	None
2023-04-23 13:10:44,491 - Detection - freeze_backbone_parameters:	True
2023-04-23 13:10:44,491 - Detection - feat_dim:	768
2023-04-23 13:10:44,491 - Detection - warmup_proportion:	0.1
2023-04-23 13:10:44,491 - Detection - lr_boundary:	0.05
2023-04-23 13:10:44,491 - Detection - lr:	2e-05
2023-04-23 13:10:44,491 - Detection - activation:	relu
2023-04-23 13:10:44,491 - Detection - train_batch_size:	128
2023-04-23 13:10:44,491 - Detection - eval_batch_size:	64
2023-04-23 13:10:44,491 - Detection - test_batch_size:	64
2023-04-23 13:10:44,491 - Detection - wait_patient:	10
2023-04-23 13:10:44,491 - Detection - ============================== End Params ==============================
2023-04-23 13:10:44,491 - Detection - Data and Model Preparation...
2023-04-23 13:10:44,492 - Detection - The number of known intents is 19
2023-04-23 13:10:44,492 - Detection - Lists of known labels are: ['direct_debit_payment_not_recognised', 'declined_cash_withdrawal', 'supported_cards_and_currencies', 'pin_blocked', 'verify_top_up', 'compromised_card', 'wrong_exchange_rate_for_cash_withdrawal', 'activate_my_card', 'verify_source_of_funds', 'reverted_card_payment?', 'request_refund', 'transfer_into_account', 'card_delivery_estimate', 'failed_transfer', 'top_up_by_card_charge', 'unable_to_verify_identity', 'disposable_card_limits', 'top_up_by_cash_or_cheque', 'cash_withdrawal_not_recognised']
2023-04-23 13:10:44,500 - Detection - Number of labeled training samples = 680
2023-04-23 13:10:44,500 - Detection - Number of unlabeled training samples = 2092
2023-04-23 13:10:44,502 - Detection - Number of evaluation samples = 209
2023-04-23 13:10:44,506 - Detection - Number of testing samples = 1896
2023-04-23 13:10:48,356 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-23 13:10:50,161 - Detection - Pre-training Begin...
2023-04-23 13:10:51,653 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 13:10:51,653 - Detection -   best_eval_score = 0
2023-04-23 13:10:51,653 - Detection -   eval_score = 4.31
2023-04-23 13:10:51,653 - Detection -   train_loss = 2.9503666162490845
2023-04-23 13:11:04,226 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 13:11:04,226 - Detection -   best_eval_score = 4.31
2023-04-23 13:11:04,226 - Detection -   eval_score = 5.26
2023-04-23 13:11:04,226 - Detection -   train_loss = 2.938445965449015
2023-04-23 13:11:16,769 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 13:11:16,770 - Detection -   best_eval_score = 5.26
2023-04-23 13:11:16,770 - Detection -   eval_score = 36.84
2023-04-23 13:11:16,770 - Detection -   train_loss = 2.6307047605514526
2023-04-23 13:11:29,333 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 13:11:29,333 - Detection -   best_eval_score = 36.84
2023-04-23 13:11:29,333 - Detection -   eval_score = 64.11
2023-04-23 13:11:29,333 - Detection -   train_loss = 1.80456538995107
2023-04-23 13:11:41,910 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 13:11:41,910 - Detection -   best_eval_score = 64.11
2023-04-23 13:11:41,911 - Detection -   eval_score = 80.38
2023-04-23 13:11:41,911 - Detection -   train_loss = 0.96964959303538
2023-04-23 13:11:54,487 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 13:11:54,487 - Detection -   best_eval_score = 80.38
2023-04-23 13:11:54,487 - Detection -   eval_score = 86.12
2023-04-23 13:11:54,487 - Detection -   train_loss = 0.5392328103383383
2023-04-23 13:12:06,999 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 13:12:06,999 - Detection -   best_eval_score = 86.12
2023-04-23 13:12:06,999 - Detection -   eval_score = 88.04
2023-04-23 13:12:06,999 - Detection -   train_loss = 0.330263356367747
2023-04-23 13:12:19,673 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 13:12:19,673 - Detection -   best_eval_score = 88.04
2023-04-23 13:12:19,673 - Detection -   eval_score = 88.52
2023-04-23 13:12:19,673 - Detection -   train_loss = 0.20134894053141275
2023-04-23 13:12:32,173 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 13:12:32,173 - Detection -   best_eval_score = 88.52
2023-04-23 13:12:32,173 - Detection -   eval_score = 88.52
2023-04-23 13:12:32,173 - Detection -   train_loss = 0.14696230491002402
2023-04-23 13:12:44,852 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 13:12:44,852 - Detection -   best_eval_score = 88.52
2023-04-23 13:12:44,852 - Detection -   eval_score = 89.95
2023-04-23 13:12:44,852 - Detection -   train_loss = 0.09352945784727733
2023-04-23 13:12:57,394 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 13:12:57,394 - Detection -   best_eval_score = 89.95
2023-04-23 13:12:57,394 - Detection -   eval_score = 89.0
2023-04-23 13:12:57,394 - Detection -   train_loss = 0.06707241510351498
2023-04-23 13:13:09,872 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 13:13:09,872 - Detection -   best_eval_score = 89.95
2023-04-23 13:13:09,872 - Detection -   eval_score = 89.0
2023-04-23 13:13:09,872 - Detection -   train_loss = 0.05437872372567654
2023-04-23 13:13:22,543 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 13:13:22,543 - Detection -   best_eval_score = 89.95
2023-04-23 13:13:22,543 - Detection -   eval_score = 89.47
2023-04-23 13:13:22,543 - Detection -   train_loss = 0.048103428756197296
2023-04-23 13:13:35,048 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 13:13:35,048 - Detection -   best_eval_score = 89.95
2023-04-23 13:13:35,048 - Detection -   eval_score = 89.0
2023-04-23 13:13:35,048 - Detection -   train_loss = 0.035000234531859555
2023-04-23 13:13:47,657 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 13:13:47,657 - Detection -   best_eval_score = 89.95
2023-04-23 13:13:47,657 - Detection -   eval_score = 89.95
2023-04-23 13:13:47,657 - Detection -   train_loss = 0.02931254419187705
2023-04-23 13:14:00,140 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 13:14:00,140 - Detection -   best_eval_score = 89.95
2023-04-23 13:14:00,140 - Detection -   eval_score = 89.47
2023-04-23 13:14:00,140 - Detection -   train_loss = 0.023824946954846382
2023-04-23 13:14:12,912 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 13:14:12,912 - Detection -   best_eval_score = 89.95
2023-04-23 13:14:12,912 - Detection -   eval_score = 89.0
2023-04-23 13:14:12,912 - Detection -   train_loss = 0.020306776898602646
2023-04-23 13:14:25,637 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 13:14:25,637 - Detection -   best_eval_score = 89.95
2023-04-23 13:14:25,637 - Detection -   eval_score = 89.47
2023-04-23 13:14:25,637 - Detection -   train_loss = 0.018949923881640036
2023-04-23 13:14:38,231 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 13:14:38,231 - Detection -   best_eval_score = 89.95
2023-04-23 13:14:38,231 - Detection -   eval_score = 89.47
2023-04-23 13:14:38,231 - Detection -   train_loss = 0.014287139599521955
2023-04-23 13:14:50,743 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 13:14:50,743 - Detection -   best_eval_score = 89.95
2023-04-23 13:14:50,743 - Detection -   eval_score = 89.47
2023-04-23 13:14:50,743 - Detection -   train_loss = 0.014847788494080305
2023-04-23 13:14:50,743 - Detection - Pre-training finished...
2023-04-23 13:14:50,743 - Detection - Training Begin...
2023-04-23 13:14:52,417 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 13:14:52,418 - Detection -   best_eval_score = 0
2023-04-23 13:14:52,418 - Detection -   eval_score = 0.0
2023-04-23 13:14:52,418 - Detection -   train_loss = 9.386074701944986
2023-04-23 13:14:53,407 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 13:14:53,407 - Detection -   best_eval_score = 0
2023-04-23 13:14:53,408 - Detection -   eval_score = 0.0
2023-04-23 13:14:53,408 - Detection -   train_loss = 9.358956654866537
2023-04-23 13:14:54,398 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 13:14:54,399 - Detection -   best_eval_score = 0
2023-04-23 13:14:54,399 - Detection -   eval_score = 0.0
2023-04-23 13:14:54,399 - Detection -   train_loss = 9.056888262430826
2023-04-23 13:14:55,391 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 13:14:55,391 - Detection -   best_eval_score = 0
2023-04-23 13:14:55,391 - Detection -   eval_score = 0.0
2023-04-23 13:14:55,391 - Detection -   train_loss = 8.847815672556559
2023-04-23 13:14:56,382 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 13:14:56,382 - Detection -   best_eval_score = 0
2023-04-23 13:14:56,382 - Detection -   eval_score = 0.0
2023-04-23 13:14:56,382 - Detection -   train_loss = 8.662048816680908
2023-04-23 13:14:57,373 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 13:14:57,374 - Detection -   best_eval_score = 0
2023-04-23 13:14:57,374 - Detection -   eval_score = 0.0
2023-04-23 13:14:57,374 - Detection -   train_loss = 8.472232977549234
2023-04-23 13:14:58,365 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 13:14:58,365 - Detection -   best_eval_score = 0
2023-04-23 13:14:58,365 - Detection -   eval_score = 0.0
2023-04-23 13:14:58,365 - Detection -   train_loss = 8.260888735453287
2023-04-23 13:14:59,358 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 13:14:59,359 - Detection -   best_eval_score = 0
2023-04-23 13:14:59,359 - Detection -   eval_score = 0.0
2023-04-23 13:14:59,359 - Detection -   train_loss = 7.962583223978679
2023-04-23 13:15:00,353 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 13:15:00,353 - Detection -   best_eval_score = 0
2023-04-23 13:15:00,353 - Detection -   eval_score = 0.0
2023-04-23 13:15:00,353 - Detection -   train_loss = 7.670665740966797
2023-04-23 13:15:01,351 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 13:15:01,351 - Detection -   best_eval_score = 0
2023-04-23 13:15:01,351 - Detection -   eval_score = 0.56
2023-04-23 13:15:01,351 - Detection -   train_loss = 7.362274885177612
2023-04-23 13:15:13,910 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 13:15:13,910 - Detection -   best_eval_score = 0.56
2023-04-23 13:15:13,910 - Detection -   eval_score = 25.76
2023-04-23 13:15:13,910 - Detection -   train_loss = 7.049480199813843
2023-04-23 13:15:27,708 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 13:15:27,708 - Detection -   best_eval_score = 25.76
2023-04-23 13:15:27,708 - Detection -   eval_score = 68.91
2023-04-23 13:15:27,708 - Detection -   train_loss = 3.8511845668156943
2023-04-23 13:15:40,256 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 13:15:40,256 - Detection -   best_eval_score = 68.91
2023-04-23 13:15:40,256 - Detection -   eval_score = 76.11
2023-04-23 13:15:40,256 - Detection -   train_loss = 1.3361377120018005
2023-04-23 13:15:52,658 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 13:15:52,658 - Detection -   best_eval_score = 76.11
2023-04-23 13:15:52,658 - Detection -   eval_score = 76.11
2023-04-23 13:15:52,658 - Detection -   train_loss = 1.1856648921966553
2023-04-23 13:16:05,222 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 13:16:05,223 - Detection -   best_eval_score = 76.11
2023-04-23 13:16:05,223 - Detection -   eval_score = 76.4
2023-04-23 13:16:05,223 - Detection -   train_loss = 1.1434893906116486
2023-04-23 13:16:17,657 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 13:16:17,657 - Detection -   best_eval_score = 76.4
2023-04-23 13:16:17,657 - Detection -   eval_score = 76.4
2023-04-23 13:16:17,657 - Detection -   train_loss = 1.1365710099538167
2023-04-23 13:16:30,076 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 13:16:30,076 - Detection -   best_eval_score = 76.4
2023-04-23 13:16:30,076 - Detection -   eval_score = 75.74
2023-04-23 13:16:30,076 - Detection -   train_loss = 1.1227544049421947
2023-04-23 13:16:42,636 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 13:16:42,637 - Detection -   best_eval_score = 76.4
2023-04-23 13:16:42,637 - Detection -   eval_score = 76.11
2023-04-23 13:16:42,637 - Detection -   train_loss = 1.115159849325816
2023-04-23 13:16:55,057 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 13:16:55,057 - Detection -   best_eval_score = 76.4
2023-04-23 13:16:55,057 - Detection -   eval_score = 76.11
2023-04-23 13:16:55,057 - Detection -   train_loss = 1.1082979838053386
2023-04-23 13:17:07,622 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 13:17:07,622 - Detection -   best_eval_score = 76.4
2023-04-23 13:17:07,622 - Detection -   eval_score = 76.11
2023-04-23 13:17:07,622 - Detection -   train_loss = 1.1433324019114177
2023-04-23 13:17:20,023 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 13:17:20,023 - Detection -   best_eval_score = 76.4
2023-04-23 13:17:20,023 - Detection -   eval_score = 76.11
2023-04-23 13:17:20,023 - Detection -   train_loss = 1.2021132508913677
2023-04-23 13:17:32,538 - Detection - ***** Epoch: 22: Eval results *****
2023-04-23 13:17:32,538 - Detection -   best_eval_score = 76.4
2023-04-23 13:17:32,538 - Detection -   eval_score = 75.68
2023-04-23 13:17:32,538 - Detection -   train_loss = 1.2033146818478901
2023-04-23 13:17:45,023 - Detection - ***** Epoch: 23: Eval results *****
2023-04-23 13:17:45,023 - Detection -   best_eval_score = 76.4
2023-04-23 13:17:45,023 - Detection -   eval_score = 76.11
2023-04-23 13:17:45,023 - Detection -   train_loss = 1.256340503692627
2023-04-23 13:17:57,548 - Detection - ***** Epoch: 24: Eval results *****
2023-04-23 13:17:57,549 - Detection -   best_eval_score = 76.4
2023-04-23 13:17:57,549 - Detection -   eval_score = 76.11
2023-04-23 13:17:57,549 - Detection -   train_loss = 1.1645490328470867
2023-04-23 13:18:11,089 - Detection - ***** Epoch: 25: Eval results *****
2023-04-23 13:18:11,089 - Detection -   best_eval_score = 76.4
2023-04-23 13:18:11,089 - Detection -   eval_score = 76.11
2023-04-23 13:18:11,089 - Detection -   train_loss = 1.1791201829910278
2023-04-23 13:18:11,090 - Detection - Training Finished...
2023-04-23 13:18:11,090 - Detection - Testing begin...
2023-04-23 13:18:12,992 - Detection - ***** Test: Confusion Matrix *****
2023-04-23 13:18:12,992 - Detection - [[   5    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    4    7]
 [   0   31    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    4]
 [   0    0   12    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0   12]
 [   0    0    0    8    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0   13]
 [   0    0    0    0   24    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    5]
 [   0    0    0    0    0    8    0    0    0    0    0    0    0    0
     0    0    0    0    0   10]
 [   0    0    0    0    0    0   25    0    0    0    0    0    0    0
     0    0    0    0    0    3]
 [   0    0    0    0    0    0    0   24    0    0    0    0    0    0
     0    0    0    0    0    7]
 [   0    0    0    0    0    0    0    0   23    0    0    0    0    0
     0    0    0    0    0    3]
 [   0    0    0    0    0    0    0    0    0   26    0    0    0    0
     0    0    0    0    0    9]
 [   0    0    0    0    0    0    0    0    0    0   31    0    0    0
     0    0    0    0    0    5]
 [   0    0    0    0    0    0    0    0    0    0    0   13    0    0
     0    0    0    1    0   13]
 [   0    0    0    0    0    0    0    0    0    0    0    0   10    0
     0    0    0    0    0   13]
 [   0    0    0    0    0    0    0    0    0    0    0    1    0   22
     0    0    0    0    0    4]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
    16    0    0    0    0    3]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0   20    0    0    0   10]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0   17    0    0    4]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0   19    0   12]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0   21   13]
 [   4   23   21    2    0    9   32    1    0   38   11   13    8   45
     9   37   26   12   13 1081]]
2023-04-23 13:18:12,992 - Detection - ***** Test results *****
2023-04-23 13:18:12,992 - Detection -   Acc = 75.74
2023-04-23 13:18:12,992 - Detection -   F1 = 61.3476
2023-04-23 13:18:12,992 - Detection -   F1-known = 60.2267
2023-04-23 13:18:12,992 - Detection -   F1-open = 82.6453
2023-04-23 13:18:12,993 - Detection - Testing finished...
2023-04-23 13:18:12,993 - Detection - Results saved in results/results_ADB-BOOST-F-10.csv
2023-04-23 13:18:13,008 - Detection - Open Intent Detection Finished...
