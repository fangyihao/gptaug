2023-04-20 00:08:35,395 - Detection - Open Intent Detection Begin...
2023-04-20 00:08:35,395 - Detection - Parameters Initialization...
2023-04-20 00:08:35,396 - Detection - ============================== Params ==============================
2023-04-20 00:08:35,396 - Detection - type:	open_intent_detection
2023-04-20 00:08:35,396 - Detection - logger_name:	Detection
2023-04-20 00:08:35,396 - Detection - log_dir:	logs
2023-04-20 00:08:35,396 - Detection - dataset:	stackoverflow_cg
2023-04-20 00:08:35,396 - Detection - known_cls_ratio:	0.25
2023-04-20 00:08:35,396 - Detection - labeled_ratio:	1.0
2023-04-20 00:08:35,396 - Detection - method:	DA-ADB
2023-04-20 00:08:35,396 - Detection - train:	True
2023-04-20 00:08:35,396 - Detection - pretrain:	True
2023-04-20 00:08:35,396 - Detection - save_model:	True
2023-04-20 00:08:35,396 - Detection - backbone:	bert_disaware
2023-04-20 00:08:35,396 - Detection - config_file_name:	DA-ADB
2023-04-20 00:08:35,396 - Detection - seed:	6
2023-04-20 00:08:35,396 - Detection - gpu_id:	0
2023-04-20 00:08:35,396 - Detection - pipe_results_path:	pipe_results
2023-04-20 00:08:35,396 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-20 00:08:35,396 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-20 00:08:35,396 - Detection - model_dir:	models
2023-04-20 00:08:35,396 - Detection - load_pretrained_method:	None
2023-04-20 00:08:35,396 - Detection - result_dir:	results
2023-04-20 00:08:35,396 - Detection - results_file_name:	results_DA-ADB.csv
2023-04-20 00:08:35,396 - Detection - save_results:	True
2023-04-20 00:08:35,396 - Detection - loss_fct:	CrossEntropyLoss
2023-04-20 00:08:35,396 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.25_1.0_bert_disaware_6
2023-04-20 00:08:35,396 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.25_1.0_bert_disaware_6/models
2023-04-20 00:08:35,396 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-20 00:08:35,396 - Detection - num_train_epochs:	100
2023-04-20 00:08:35,396 - Detection - num_labels:	None
2023-04-20 00:08:35,396 - Detection - max_seq_length:	None
2023-04-20 00:08:35,396 - Detection - freeze_backbone_parameters:	True
2023-04-20 00:08:35,396 - Detection - feat_dim:	768
2023-04-20 00:08:35,396 - Detection - warmup_proportion:	0.1
2023-04-20 00:08:35,396 - Detection - scale:	4
2023-04-20 00:08:35,396 - Detection - lr_boundary:	0.05
2023-04-20 00:08:35,396 - Detection - lr:	2e-05
2023-04-20 00:08:35,396 - Detection - activation:	relu
2023-04-20 00:08:35,396 - Detection - train_batch_size:	128
2023-04-20 00:08:35,396 - Detection - eval_batch_size:	64
2023-04-20 00:08:35,396 - Detection - test_batch_size:	64
2023-04-20 00:08:35,396 - Detection - wait_patient:	10
2023-04-20 00:08:35,396 - Detection - ============================== End Params ==============================
2023-04-20 00:08:35,396 - Detection - Data and Model Preparation...
2023-04-20 00:08:35,397 - Detection - The number of known intents is 5
2023-04-20 00:08:35,397 - Detection - Lists of known labels are: ['svn', 'hibernate', 'excel', 'haskell', 'linq']
2023-04-20 00:08:35,416 - Detection - Number of labeled training samples = 1950
2023-04-20 00:08:35,416 - Detection - Number of unlabeled training samples = 5867
2023-04-20 00:08:35,420 - Detection - Number of evaluation samples = 469
2023-04-20 00:08:35,429 - Detection - Number of testing samples = 5082
2023-04-20 00:08:42,357 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-20 00:08:42,440 - Detection - Pre-training Begin...
2023-04-20 00:08:46,680 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 00:08:46,680 - Detection -   best_eval_score = 0
2023-04-20 00:08:46,680 - Detection -   eval_score = 24.92
2023-04-20 00:08:46,680 - Detection -   train_loss = 1.609945185482502
2023-04-20 00:08:50,435 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 00:08:50,435 - Detection -   best_eval_score = 24.92
2023-04-20 00:08:50,435 - Detection -   eval_score = 7.3
2023-04-20 00:08:50,435 - Detection -   train_loss = 1.5992568731307983
2023-04-20 00:08:54,184 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 00:08:54,185 - Detection -   best_eval_score = 24.92
2023-04-20 00:08:54,185 - Detection -   eval_score = 53.94
2023-04-20 00:08:54,185 - Detection -   train_loss = 1.5780686289072037
2023-04-20 00:08:57,946 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 00:08:57,947 - Detection -   best_eval_score = 53.94
2023-04-20 00:08:57,947 - Detection -   eval_score = 63.97
2023-04-20 00:08:57,947 - Detection -   train_loss = 1.5393732860684395
2023-04-20 00:09:01,716 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 00:09:01,716 - Detection -   best_eval_score = 63.97
2023-04-20 00:09:01,716 - Detection -   eval_score = 70.85
2023-04-20 00:09:01,717 - Detection -   train_loss = 1.442253552377224
2023-04-20 00:09:05,494 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 00:09:05,495 - Detection -   best_eval_score = 70.85
2023-04-20 00:09:05,495 - Detection -   eval_score = 85.81
2023-04-20 00:09:05,495 - Detection -   train_loss = 1.2080570608377457
2023-04-20 00:09:09,279 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 00:09:09,279 - Detection -   best_eval_score = 85.81
2023-04-20 00:09:09,279 - Detection -   eval_score = 89.58
2023-04-20 00:09:09,279 - Detection -   train_loss = 0.856328509747982
2023-04-20 00:09:13,072 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 00:09:13,072 - Detection -   best_eval_score = 89.58
2023-04-20 00:09:13,072 - Detection -   eval_score = 91.47
2023-04-20 00:09:13,072 - Detection -   train_loss = 0.579158391803503
2023-04-20 00:09:16,866 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 00:09:16,866 - Detection -   best_eval_score = 91.47
2023-04-20 00:09:16,866 - Detection -   eval_score = 92.99
2023-04-20 00:09:16,866 - Detection -   train_loss = 0.4648255296051502
2023-04-20 00:09:20,665 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 00:09:20,665 - Detection -   best_eval_score = 92.99
2023-04-20 00:09:20,665 - Detection -   eval_score = 93.4
2023-04-20 00:09:20,665 - Detection -   train_loss = 0.3962377794086933
2023-04-20 00:09:24,468 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 00:09:24,468 - Detection -   best_eval_score = 93.4
2023-04-20 00:09:24,469 - Detection -   eval_score = 94.02
2023-04-20 00:09:24,469 - Detection -   train_loss = 0.3595202937722206
2023-04-20 00:09:28,275 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 00:09:28,275 - Detection -   best_eval_score = 94.02
2023-04-20 00:09:28,275 - Detection -   eval_score = 92.31
2023-04-20 00:09:28,275 - Detection -   train_loss = 0.3321556802839041
2023-04-20 00:09:32,074 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 00:09:32,074 - Detection -   best_eval_score = 94.02
2023-04-20 00:09:32,074 - Detection -   eval_score = 93.82
2023-04-20 00:09:32,074 - Detection -   train_loss = 0.30824265256524086
2023-04-20 00:09:35,885 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 00:09:35,885 - Detection -   best_eval_score = 94.02
2023-04-20 00:09:35,885 - Detection -   eval_score = 93.43
2023-04-20 00:09:35,885 - Detection -   train_loss = 0.28413221053779125
2023-04-20 00:09:39,696 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 00:09:39,696 - Detection -   best_eval_score = 94.02
2023-04-20 00:09:39,696 - Detection -   eval_score = 93.03
2023-04-20 00:09:39,696 - Detection -   train_loss = 0.2655760059133172
2023-04-20 00:09:43,512 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 00:09:43,512 - Detection -   best_eval_score = 94.02
2023-04-20 00:09:43,512 - Detection -   eval_score = 93.18
2023-04-20 00:09:43,512 - Detection -   train_loss = 0.25331331696361303
2023-04-20 00:09:47,331 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 00:09:47,331 - Detection -   best_eval_score = 94.02
2023-04-20 00:09:47,331 - Detection -   eval_score = 93.42
2023-04-20 00:09:47,331 - Detection -   train_loss = 0.24278857000172138
2023-04-20 00:09:51,142 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 00:09:51,142 - Detection -   best_eval_score = 94.02
2023-04-20 00:09:51,142 - Detection -   eval_score = 92.99
2023-04-20 00:09:51,142 - Detection -   train_loss = 0.22330480441451073
2023-04-20 00:09:54,950 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 00:09:54,950 - Detection -   best_eval_score = 94.02
2023-04-20 00:09:54,951 - Detection -   eval_score = 92.77
2023-04-20 00:09:54,951 - Detection -   train_loss = 0.2130382852628827
2023-04-20 00:09:58,759 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 00:09:58,759 - Detection -   best_eval_score = 94.02
2023-04-20 00:09:58,759 - Detection -   eval_score = 93.0
2023-04-20 00:09:58,759 - Detection -   train_loss = 0.20547564793378115
2023-04-20 00:10:02,669 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 00:10:02,670 - Detection -   best_eval_score = 94.02
2023-04-20 00:10:02,670 - Detection -   eval_score = 94.08
2023-04-20 00:10:02,670 - Detection -   train_loss = 0.19313952047377825
2023-04-20 00:10:06,483 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 00:10:06,484 - Detection -   best_eval_score = 94.08
2023-04-20 00:10:06,484 - Detection -   eval_score = 93.66
2023-04-20 00:10:06,484 - Detection -   train_loss = 0.19284783583134413
2023-04-20 00:10:10,295 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 00:10:10,295 - Detection -   best_eval_score = 94.08
2023-04-20 00:10:10,295 - Detection -   eval_score = 93.42
2023-04-20 00:10:10,295 - Detection -   train_loss = 0.178683714941144
2023-04-20 00:10:14,107 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 00:10:14,107 - Detection -   best_eval_score = 94.08
2023-04-20 00:10:14,107 - Detection -   eval_score = 93.21
2023-04-20 00:10:14,107 - Detection -   train_loss = 0.17037288192659616
2023-04-20 00:10:17,915 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 00:10:17,915 - Detection -   best_eval_score = 94.08
2023-04-20 00:10:17,915 - Detection -   eval_score = 93.43
2023-04-20 00:10:17,915 - Detection -   train_loss = 0.1696839826181531
2023-04-20 00:10:21,717 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 00:10:21,717 - Detection -   best_eval_score = 94.08
2023-04-20 00:10:21,717 - Detection -   eval_score = 93.22
2023-04-20 00:10:21,717 - Detection -   train_loss = 0.16133711952716112
2023-04-20 00:10:25,519 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 00:10:25,520 - Detection -   best_eval_score = 94.08
2023-04-20 00:10:25,520 - Detection -   eval_score = 93.47
2023-04-20 00:10:25,520 - Detection -   train_loss = 0.15797675866633654
2023-04-20 00:10:29,319 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 00:10:29,319 - Detection -   best_eval_score = 94.08
2023-04-20 00:10:29,319 - Detection -   eval_score = 92.76
2023-04-20 00:10:29,319 - Detection -   train_loss = 0.1560366228222847
2023-04-20 00:10:33,116 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 00:10:33,116 - Detection -   best_eval_score = 94.08
2023-04-20 00:10:33,116 - Detection -   eval_score = 93.41
2023-04-20 00:10:33,116 - Detection -   train_loss = 0.14890332240611315
2023-04-20 00:10:36,921 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 00:10:36,921 - Detection -   best_eval_score = 94.08
2023-04-20 00:10:36,921 - Detection -   eval_score = 94.07
2023-04-20 00:10:36,921 - Detection -   train_loss = 0.14615409821271896
2023-04-20 00:10:40,722 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 00:10:40,723 - Detection -   best_eval_score = 94.08
2023-04-20 00:10:40,723 - Detection -   eval_score = 93.43
2023-04-20 00:10:40,723 - Detection -   train_loss = 0.14190439507365227
2023-04-20 00:10:40,723 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.25_1.0_bert_disaware_6/models
2023-04-20 00:10:41,268 - Detection - Pre-training finished...
2023-04-20 00:10:41,268 - Detection - Training Begin...
2023-04-20 00:10:43,454 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 00:10:43,454 - Detection -   best_eval_score = 0
2023-04-20 00:10:43,454 - Detection -   eval_score = 8.53
2023-04-20 00:10:43,454 - Detection -   train_loss = 4.11245384812355
2023-04-20 00:10:45,643 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 00:10:45,643 - Detection -   best_eval_score = 8.53
2023-04-20 00:10:45,643 - Detection -   eval_score = 20.18
2023-04-20 00:10:45,643 - Detection -   train_loss = 3.6776285469532013
2023-04-20 00:10:47,833 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 00:10:47,833 - Detection -   best_eval_score = 20.18
2023-04-20 00:10:47,833 - Detection -   eval_score = 31.77
2023-04-20 00:10:47,833 - Detection -   train_loss = 3.0694681257009506
2023-04-20 00:10:50,025 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 00:10:50,025 - Detection -   best_eval_score = 31.77
2023-04-20 00:10:50,025 - Detection -   eval_score = 49.3
2023-04-20 00:10:50,025 - Detection -   train_loss = 2.3626031652092934
2023-04-20 00:10:52,216 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 00:10:52,216 - Detection -   best_eval_score = 49.3
2023-04-20 00:10:52,216 - Detection -   eval_score = 73.44
2023-04-20 00:10:52,216 - Detection -   train_loss = 1.6752517223358154
2023-04-20 00:10:54,406 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 00:10:54,406 - Detection -   best_eval_score = 73.44
2023-04-20 00:10:54,406 - Detection -   eval_score = 75.96
2023-04-20 00:10:54,406 - Detection -   train_loss = 1.1491374894976616
2023-04-20 00:10:56,595 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 00:10:56,596 - Detection -   best_eval_score = 75.96
2023-04-20 00:10:56,596 - Detection -   eval_score = 75.85
2023-04-20 00:10:56,596 - Detection -   train_loss = 0.970753476023674
2023-04-20 00:10:58,785 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 00:10:58,785 - Detection -   best_eval_score = 75.96
2023-04-20 00:10:58,785 - Detection -   eval_score = 76.04
2023-04-20 00:10:58,785 - Detection -   train_loss = 0.9127692617475986
2023-04-20 00:11:00,977 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 00:11:00,977 - Detection -   best_eval_score = 76.04
2023-04-20 00:11:00,977 - Detection -   eval_score = 75.96
2023-04-20 00:11:00,977 - Detection -   train_loss = 0.9288358762860298
2023-04-20 00:11:03,165 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 00:11:03,165 - Detection -   best_eval_score = 76.04
2023-04-20 00:11:03,165 - Detection -   eval_score = 75.96
2023-04-20 00:11:03,165 - Detection -   train_loss = 0.8981499634683132
2023-04-20 00:11:05,354 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 00:11:05,355 - Detection -   best_eval_score = 76.04
2023-04-20 00:11:05,355 - Detection -   eval_score = 75.96
2023-04-20 00:11:05,355 - Detection -   train_loss = 0.9002842009067535
2023-04-20 00:11:07,545 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 00:11:07,545 - Detection -   best_eval_score = 76.04
2023-04-20 00:11:07,545 - Detection -   eval_score = 75.96
2023-04-20 00:11:07,545 - Detection -   train_loss = 0.9116828739643097
2023-04-20 00:11:09,736 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 00:11:09,736 - Detection -   best_eval_score = 76.04
2023-04-20 00:11:09,736 - Detection -   eval_score = 76.04
2023-04-20 00:11:09,736 - Detection -   train_loss = 0.9225595705211163
2023-04-20 00:11:11,927 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 00:11:11,927 - Detection -   best_eval_score = 76.04
2023-04-20 00:11:11,927 - Detection -   eval_score = 75.96
2023-04-20 00:11:11,927 - Detection -   train_loss = 0.9137251861393452
2023-04-20 00:11:14,119 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 00:11:14,119 - Detection -   best_eval_score = 76.04
2023-04-20 00:11:14,119 - Detection -   eval_score = 76.04
2023-04-20 00:11:14,119 - Detection -   train_loss = 0.8960986025631428
2023-04-20 00:11:16,309 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 00:11:16,309 - Detection -   best_eval_score = 76.04
2023-04-20 00:11:16,309 - Detection -   eval_score = 76.04
2023-04-20 00:11:16,309 - Detection -   train_loss = 0.9170349203050137
2023-04-20 00:11:18,496 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 00:11:18,497 - Detection -   best_eval_score = 76.04
2023-04-20 00:11:18,497 - Detection -   eval_score = 76.04
2023-04-20 00:11:18,497 - Detection -   train_loss = 0.910889882594347
2023-04-20 00:11:20,684 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 00:11:20,684 - Detection -   best_eval_score = 76.04
2023-04-20 00:11:20,684 - Detection -   eval_score = 75.96
2023-04-20 00:11:20,684 - Detection -   train_loss = 0.9399343878030777
2023-04-20 00:11:20,685 - Detection - Training Finished...
2023-04-20 00:11:20,685 - Detection - Testing begin...
2023-04-20 00:11:24,909 - Detection - ***** Test: Confusion Matrix *****
2023-04-20 00:11:24,910 - Detection - [[ 227    0    0    2    0   44]
 [   0  217    0    0    0   41]
 [   0    0  177    2    0   52]
 [   0    0    0  226    0   43]
 [   0    0    0    2  206   42]
 [  17   26   11  280    0 3467]]
2023-04-20 00:11:24,910 - Detection - ***** Test results *****
2023-04-20 00:11:24,910 - Detection -   Acc = 88.94
2023-04-20 00:11:24,910 - Detection -   F1 = 83.2883
2023-04-20 00:11:24,910 - Detection -   F1-known = 81.4307
2023-04-20 00:11:24,910 - Detection -   F1-open = 92.5768
2023-04-20 00:11:24,910 - Detection - Testing finished...
2023-04-20 00:11:24,910 - Detection - Results saved in results/results_DA-ADB.csv
2023-04-20 00:11:24,930 - Detection - Open Intent Detection Finished...
