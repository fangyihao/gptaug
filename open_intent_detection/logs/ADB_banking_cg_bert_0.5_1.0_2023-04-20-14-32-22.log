2023-04-20 14:32:22,006 - Detection - Open Intent Detection Begin...
2023-04-20 14:32:22,006 - Detection - Parameters Initialization...
2023-04-20 14:32:22,006 - Detection - ============================== Params ==============================
2023-04-20 14:32:22,006 - Detection - type:	open_intent_detection
2023-04-20 14:32:22,007 - Detection - logger_name:	Detection
2023-04-20 14:32:22,007 - Detection - log_dir:	logs
2023-04-20 14:32:22,007 - Detection - dataset:	banking_cg
2023-04-20 14:32:22,007 - Detection - known_cls_ratio:	0.5
2023-04-20 14:32:22,007 - Detection - labeled_ratio:	1.0
2023-04-20 14:32:22,007 - Detection - method:	ADB
2023-04-20 14:32:22,007 - Detection - train:	True
2023-04-20 14:32:22,007 - Detection - pretrain:	True
2023-04-20 14:32:22,007 - Detection - save_model:	True
2023-04-20 14:32:22,007 - Detection - backbone:	bert
2023-04-20 14:32:22,007 - Detection - config_file_name:	ADB
2023-04-20 14:32:22,007 - Detection - seed:	8
2023-04-20 14:32:22,007 - Detection - gpu_id:	0
2023-04-20 14:32:22,007 - Detection - pipe_results_path:	pipe_results
2023-04-20 14:32:22,007 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-20 14:32:22,007 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-20 14:32:22,007 - Detection - model_dir:	models
2023-04-20 14:32:22,007 - Detection - load_pretrained_method:	None
2023-04-20 14:32:22,007 - Detection - result_dir:	results
2023-04-20 14:32:22,007 - Detection - results_file_name:	results_ADB.csv
2023-04-20 14:32:22,007 - Detection - save_results:	True
2023-04-20 14:32:22,007 - Detection - loss_fct:	CrossEntropyLoss
2023-04-20 14:32:22,007 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.5_1.0_bert_8
2023-04-20 14:32:22,007 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.5_1.0_bert_8/models
2023-04-20 14:32:22,007 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-20 14:32:22,007 - Detection - num_train_epochs:	100
2023-04-20 14:32:22,007 - Detection - num_labels:	None
2023-04-20 14:32:22,007 - Detection - max_seq_length:	None
2023-04-20 14:32:22,007 - Detection - freeze_backbone_parameters:	True
2023-04-20 14:32:22,007 - Detection - feat_dim:	768
2023-04-20 14:32:22,007 - Detection - warmup_proportion:	0.1
2023-04-20 14:32:22,007 - Detection - lr_boundary:	0.05
2023-04-20 14:32:22,007 - Detection - lr:	2e-05
2023-04-20 14:32:22,007 - Detection - activation:	relu
2023-04-20 14:32:22,007 - Detection - train_batch_size:	128
2023-04-20 14:32:22,007 - Detection - eval_batch_size:	64
2023-04-20 14:32:22,007 - Detection - test_batch_size:	64
2023-04-20 14:32:22,007 - Detection - wait_patient:	10
2023-04-20 14:32:22,007 - Detection - ============================== End Params ==============================
2023-04-20 14:32:22,007 - Detection - Data and Model Preparation...
2023-04-20 14:32:22,008 - Detection - The number of known intents is 38
2023-04-20 14:32:22,008 - Detection - Lists of known labels are: ['getting_spare_card', 'failed_transfer', 'virtual_card_not_working', 'apple_pay_or_google_pay', 'pending_card_payment', 'order_physical_card', 'activate_my_card', 'card_arrival', 'card_payment_fee_charged', 'card_swallowed', 'verify_top_up', 'exchange_rate', 'passcode_forgotten', 'pending_cash_withdrawal', 'topping_up_by_card', 'exchange_charge', 'pin_blocked', 'compromised_card', 'visa_or_mastercard', 'exchange_via_app', 'card_acceptance', 'wrong_amount_of_cash_received', 'country_support', 'top_up_by_card_charge', 'contactless_not_working', 'transfer_fee_charged', 'disposable_card_limits', 'balance_not_updated_after_bank_transfer', 'verify_source_of_funds', 'unable_to_verify_identity', 'supported_cards_and_currencies', 'Refund_not_showing_up', 'card_about_to_expire', 'get_physical_card', 'extra_charge_on_statement', 'request_refund', 'why_verify_identity', 'cash_withdrawal_not_recognised']
2023-04-20 14:32:22,018 - Detection - Number of labeled training samples = 1278
2023-04-20 14:32:22,018 - Detection - Number of unlabeled training samples = 1495
2023-04-20 14:32:22,020 - Detection - Number of evaluation samples = 388
2023-04-20 14:32:22,025 - Detection - Number of testing samples = 1896
2023-04-20 14:32:25,889 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-20 14:32:27,595 - Detection - Pre-training Begin...
2023-04-20 14:32:29,985 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 14:32:29,985 - Detection -   best_eval_score = 0
2023-04-20 14:32:29,985 - Detection -   eval_score = 2.58
2023-04-20 14:32:29,985 - Detection -   train_loss = 3.6258004903793335
2023-04-20 14:32:31,891 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 14:32:31,891 - Detection -   best_eval_score = 2.58
2023-04-20 14:32:31,891 - Detection -   eval_score = 4.64
2023-04-20 14:32:31,891 - Detection -   train_loss = 3.6114253997802734
2023-04-20 14:32:33,802 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 14:32:33,803 - Detection -   best_eval_score = 4.64
2023-04-20 14:32:33,803 - Detection -   eval_score = 4.9
2023-04-20 14:32:33,803 - Detection -   train_loss = 3.579747772216797
2023-04-20 14:32:35,713 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 14:32:35,713 - Detection -   best_eval_score = 4.9
2023-04-20 14:32:35,713 - Detection -   eval_score = 6.7
2023-04-20 14:32:35,713 - Detection -   train_loss = 3.5358432054519655
2023-04-20 14:32:37,628 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 14:32:37,628 - Detection -   best_eval_score = 6.7
2023-04-20 14:32:37,628 - Detection -   eval_score = 6.7
2023-04-20 14:32:37,628 - Detection -   train_loss = 3.4725033044815063
2023-04-20 14:32:39,532 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 14:32:39,532 - Detection -   best_eval_score = 6.7
2023-04-20 14:32:39,532 - Detection -   eval_score = 8.76
2023-04-20 14:32:39,532 - Detection -   train_loss = 3.3680702209472657
2023-04-20 14:32:41,449 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 14:32:41,450 - Detection -   best_eval_score = 8.76
2023-04-20 14:32:41,450 - Detection -   eval_score = 13.92
2023-04-20 14:32:41,450 - Detection -   train_loss = 3.2120092630386354
2023-04-20 14:32:43,373 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 14:32:43,373 - Detection -   best_eval_score = 13.92
2023-04-20 14:32:43,373 - Detection -   eval_score = 21.39
2023-04-20 14:32:43,373 - Detection -   train_loss = 2.9552260398864747
2023-04-20 14:32:45,316 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 14:32:45,317 - Detection -   best_eval_score = 21.39
2023-04-20 14:32:45,317 - Detection -   eval_score = 28.87
2023-04-20 14:32:45,317 - Detection -   train_loss = 2.605501174926758
2023-04-20 14:32:47,281 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 14:32:47,281 - Detection -   best_eval_score = 28.87
2023-04-20 14:32:47,281 - Detection -   eval_score = 37.89
2023-04-20 14:32:47,281 - Detection -   train_loss = 2.238717293739319
2023-04-20 14:32:49,261 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 14:32:49,261 - Detection -   best_eval_score = 37.89
2023-04-20 14:32:49,261 - Detection -   eval_score = 44.07
2023-04-20 14:32:49,261 - Detection -   train_loss = 1.8934603214263916
2023-04-20 14:32:51,253 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 14:32:51,253 - Detection -   best_eval_score = 44.07
2023-04-20 14:32:51,253 - Detection -   eval_score = 53.87
2023-04-20 14:32:51,253 - Detection -   train_loss = 1.5991819143295287
2023-04-20 14:32:53,253 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 14:32:53,253 - Detection -   best_eval_score = 53.87
2023-04-20 14:32:53,254 - Detection -   eval_score = 58.76
2023-04-20 14:32:53,254 - Detection -   train_loss = 1.3614673495292664
2023-04-20 14:32:55,265 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 14:32:55,265 - Detection -   best_eval_score = 58.76
2023-04-20 14:32:55,265 - Detection -   eval_score = 61.86
2023-04-20 14:32:55,265 - Detection -   train_loss = 1.167586326599121
2023-04-20 14:32:57,388 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 14:32:57,388 - Detection -   best_eval_score = 61.86
2023-04-20 14:32:57,388 - Detection -   eval_score = 65.98
2023-04-20 14:32:57,388 - Detection -   train_loss = 1.0094398736953736
2023-04-20 14:32:59,414 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 14:32:59,414 - Detection -   best_eval_score = 65.98
2023-04-20 14:32:59,415 - Detection -   eval_score = 69.59
2023-04-20 14:32:59,415 - Detection -   train_loss = 0.8863887965679169
2023-04-20 14:33:01,442 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 14:33:01,442 - Detection -   best_eval_score = 69.59
2023-04-20 14:33:01,442 - Detection -   eval_score = 71.13
2023-04-20 14:33:01,442 - Detection -   train_loss = 0.7894502341747284
2023-04-20 14:33:03,472 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 14:33:03,472 - Detection -   best_eval_score = 71.13
2023-04-20 14:33:03,472 - Detection -   eval_score = 72.94
2023-04-20 14:33:03,472 - Detection -   train_loss = 0.7001445174217225
2023-04-20 14:33:05,514 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 14:33:05,515 - Detection -   best_eval_score = 72.94
2023-04-20 14:33:05,515 - Detection -   eval_score = 73.71
2023-04-20 14:33:05,515 - Detection -   train_loss = 0.6375454843044281
2023-04-20 14:33:07,556 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 14:33:07,556 - Detection -   best_eval_score = 73.71
2023-04-20 14:33:07,556 - Detection -   eval_score = 76.55
2023-04-20 14:33:07,556 - Detection -   train_loss = 0.5724961996078491
2023-04-20 14:33:09,599 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 14:33:09,599 - Detection -   best_eval_score = 76.55
2023-04-20 14:33:09,599 - Detection -   eval_score = 77.32
2023-04-20 14:33:09,599 - Detection -   train_loss = 0.5190358966588974
2023-04-20 14:33:11,644 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 14:33:11,644 - Detection -   best_eval_score = 77.32
2023-04-20 14:33:11,644 - Detection -   eval_score = 79.12
2023-04-20 14:33:11,644 - Detection -   train_loss = 0.47572432160377504
2023-04-20 14:33:13,694 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 14:33:13,694 - Detection -   best_eval_score = 79.12
2023-04-20 14:33:13,694 - Detection -   eval_score = 80.41
2023-04-20 14:33:13,694 - Detection -   train_loss = 0.4323454350233078
2023-04-20 14:33:15,741 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 14:33:15,741 - Detection -   best_eval_score = 80.41
2023-04-20 14:33:15,742 - Detection -   eval_score = 79.9
2023-04-20 14:33:15,742 - Detection -   train_loss = 0.39811381995677947
2023-04-20 14:33:17,783 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 14:33:17,784 - Detection -   best_eval_score = 80.41
2023-04-20 14:33:17,784 - Detection -   eval_score = 80.67
2023-04-20 14:33:17,784 - Detection -   train_loss = 0.3673556536436081
2023-04-20 14:33:19,835 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 14:33:19,835 - Detection -   best_eval_score = 80.67
2023-04-20 14:33:19,835 - Detection -   eval_score = 80.15
2023-04-20 14:33:19,835 - Detection -   train_loss = 0.34317336678504945
2023-04-20 14:33:21,879 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 14:33:21,879 - Detection -   best_eval_score = 80.67
2023-04-20 14:33:21,879 - Detection -   eval_score = 81.44
2023-04-20 14:33:21,879 - Detection -   train_loss = 0.32341077029705045
2023-04-20 14:33:23,931 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 14:33:23,931 - Detection -   best_eval_score = 81.44
2023-04-20 14:33:23,931 - Detection -   eval_score = 80.93
2023-04-20 14:33:23,931 - Detection -   train_loss = 0.306317126750946
2023-04-20 14:33:25,976 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 14:33:25,976 - Detection -   best_eval_score = 81.44
2023-04-20 14:33:25,976 - Detection -   eval_score = 82.22
2023-04-20 14:33:25,976 - Detection -   train_loss = 0.2766922786831856
2023-04-20 14:33:28,029 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 14:33:28,029 - Detection -   best_eval_score = 82.22
2023-04-20 14:33:28,029 - Detection -   eval_score = 80.93
2023-04-20 14:33:28,029 - Detection -   train_loss = 0.2549054652452469
2023-04-20 14:33:30,073 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 14:33:30,073 - Detection -   best_eval_score = 82.22
2023-04-20 14:33:30,074 - Detection -   eval_score = 81.96
2023-04-20 14:33:30,074 - Detection -   train_loss = 0.24374690800905227
2023-04-20 14:33:32,118 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 14:33:32,118 - Detection -   best_eval_score = 82.22
2023-04-20 14:33:32,118 - Detection -   eval_score = 81.7
2023-04-20 14:33:32,118 - Detection -   train_loss = 0.22544468343257903
2023-04-20 14:33:34,159 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 14:33:34,159 - Detection -   best_eval_score = 82.22
2023-04-20 14:33:34,159 - Detection -   eval_score = 81.7
2023-04-20 14:33:34,159 - Detection -   train_loss = 0.22158313691616058
2023-04-20 14:33:36,204 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 14:33:36,204 - Detection -   best_eval_score = 82.22
2023-04-20 14:33:36,204 - Detection -   eval_score = 81.7
2023-04-20 14:33:36,204 - Detection -   train_loss = 0.21009760051965715
2023-04-20 14:33:38,237 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 14:33:38,237 - Detection -   best_eval_score = 82.22
2023-04-20 14:33:38,237 - Detection -   eval_score = 81.7
2023-04-20 14:33:38,237 - Detection -   train_loss = 0.1964378610253334
2023-04-20 14:33:40,269 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 14:33:40,269 - Detection -   best_eval_score = 82.22
2023-04-20 14:33:40,269 - Detection -   eval_score = 82.99
2023-04-20 14:33:40,269 - Detection -   train_loss = 0.18593675196170806
2023-04-20 14:33:42,315 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 14:33:42,316 - Detection -   best_eval_score = 82.99
2023-04-20 14:33:42,316 - Detection -   eval_score = 82.47
2023-04-20 14:33:42,316 - Detection -   train_loss = 0.17932596653699875
2023-04-20 14:33:44,355 - Detection - ***** Epoch: 38: Eval results *****
2023-04-20 14:33:44,355 - Detection -   best_eval_score = 82.99
2023-04-20 14:33:44,355 - Detection -   eval_score = 82.73
2023-04-20 14:33:44,355 - Detection -   train_loss = 0.16981664448976516
2023-04-20 14:33:46,390 - Detection - ***** Epoch: 39: Eval results *****
2023-04-20 14:33:46,390 - Detection -   best_eval_score = 82.99
2023-04-20 14:33:46,390 - Detection -   eval_score = 82.22
2023-04-20 14:33:46,390 - Detection -   train_loss = 0.16071411669254304
2023-04-20 14:33:48,436 - Detection - ***** Epoch: 40: Eval results *****
2023-04-20 14:33:48,436 - Detection -   best_eval_score = 82.99
2023-04-20 14:33:48,436 - Detection -   eval_score = 82.22
2023-04-20 14:33:48,436 - Detection -   train_loss = 0.15595898032188416
2023-04-20 14:33:50,478 - Detection - ***** Epoch: 41: Eval results *****
2023-04-20 14:33:50,479 - Detection -   best_eval_score = 82.99
2023-04-20 14:33:50,479 - Detection -   eval_score = 82.73
2023-04-20 14:33:50,479 - Detection -   train_loss = 0.15022328943014146
2023-04-20 14:33:52,513 - Detection - ***** Epoch: 42: Eval results *****
2023-04-20 14:33:52,513 - Detection -   best_eval_score = 82.99
2023-04-20 14:33:52,513 - Detection -   eval_score = 83.76
2023-04-20 14:33:52,513 - Detection -   train_loss = 0.13882217556238174
2023-04-20 14:33:54,567 - Detection - ***** Epoch: 43: Eval results *****
2023-04-20 14:33:54,567 - Detection -   best_eval_score = 83.76
2023-04-20 14:33:54,567 - Detection -   eval_score = 83.51
2023-04-20 14:33:54,567 - Detection -   train_loss = 0.13816662430763244
2023-04-20 14:33:56,604 - Detection - ***** Epoch: 44: Eval results *****
2023-04-20 14:33:56,604 - Detection -   best_eval_score = 83.76
2023-04-20 14:33:56,604 - Detection -   eval_score = 82.99
2023-04-20 14:33:56,604 - Detection -   train_loss = 0.13004331067204475
2023-04-20 14:33:58,642 - Detection - ***** Epoch: 45: Eval results *****
2023-04-20 14:33:58,642 - Detection -   best_eval_score = 83.76
2023-04-20 14:33:58,642 - Detection -   eval_score = 83.51
2023-04-20 14:33:58,642 - Detection -   train_loss = 0.1281283289194107
2023-04-20 14:34:00,689 - Detection - ***** Epoch: 46: Eval results *****
2023-04-20 14:34:00,689 - Detection -   best_eval_score = 83.76
2023-04-20 14:34:00,689 - Detection -   eval_score = 83.51
2023-04-20 14:34:00,689 - Detection -   train_loss = 0.1267641954123974
2023-04-20 14:34:02,722 - Detection - ***** Epoch: 47: Eval results *****
2023-04-20 14:34:02,722 - Detection -   best_eval_score = 83.76
2023-04-20 14:34:02,722 - Detection -   eval_score = 83.51
2023-04-20 14:34:02,722 - Detection -   train_loss = 0.12197190374135972
2023-04-20 14:34:04,758 - Detection - ***** Epoch: 48: Eval results *****
2023-04-20 14:34:04,758 - Detection -   best_eval_score = 83.76
2023-04-20 14:34:04,758 - Detection -   eval_score = 83.76
2023-04-20 14:34:04,758 - Detection -   train_loss = 0.11938495412468911
2023-04-20 14:34:06,791 - Detection - ***** Epoch: 49: Eval results *****
2023-04-20 14:34:06,792 - Detection -   best_eval_score = 83.76
2023-04-20 14:34:06,792 - Detection -   eval_score = 84.02
2023-04-20 14:34:06,792 - Detection -   train_loss = 0.11091367229819298
2023-04-20 14:34:08,844 - Detection - ***** Epoch: 50: Eval results *****
2023-04-20 14:34:08,844 - Detection -   best_eval_score = 84.02
2023-04-20 14:34:08,844 - Detection -   eval_score = 83.76
2023-04-20 14:34:08,844 - Detection -   train_loss = 0.10996147096157075
2023-04-20 14:34:10,883 - Detection - ***** Epoch: 51: Eval results *****
2023-04-20 14:34:10,883 - Detection -   best_eval_score = 84.02
2023-04-20 14:34:10,883 - Detection -   eval_score = 83.25
2023-04-20 14:34:10,883 - Detection -   train_loss = 0.1063090831041336
2023-04-20 14:34:12,929 - Detection - ***** Epoch: 52: Eval results *****
2023-04-20 14:34:12,929 - Detection -   best_eval_score = 84.02
2023-04-20 14:34:12,929 - Detection -   eval_score = 84.28
2023-04-20 14:34:12,930 - Detection -   train_loss = 0.10207072645425797
2023-04-20 14:34:14,974 - Detection - ***** Epoch: 53: Eval results *****
2023-04-20 14:34:14,974 - Detection -   best_eval_score = 84.28
2023-04-20 14:34:14,975 - Detection -   eval_score = 83.25
2023-04-20 14:34:14,975 - Detection -   train_loss = 0.10156613066792489
2023-04-20 14:34:17,020 - Detection - ***** Epoch: 54: Eval results *****
2023-04-20 14:34:17,020 - Detection -   best_eval_score = 84.28
2023-04-20 14:34:17,020 - Detection -   eval_score = 84.02
2023-04-20 14:34:17,020 - Detection -   train_loss = 0.10025468543171882
2023-04-20 14:34:19,063 - Detection - ***** Epoch: 55: Eval results *****
2023-04-20 14:34:19,063 - Detection -   best_eval_score = 84.28
2023-04-20 14:34:19,063 - Detection -   eval_score = 83.76
2023-04-20 14:34:19,063 - Detection -   train_loss = 0.09791790619492531
2023-04-20 14:34:21,107 - Detection - ***** Epoch: 56: Eval results *****
2023-04-20 14:34:21,107 - Detection -   best_eval_score = 84.28
2023-04-20 14:34:21,107 - Detection -   eval_score = 83.76
2023-04-20 14:34:21,107 - Detection -   train_loss = 0.09181853905320167
2023-04-20 14:34:23,144 - Detection - ***** Epoch: 57: Eval results *****
2023-04-20 14:34:23,145 - Detection -   best_eval_score = 84.28
2023-04-20 14:34:23,145 - Detection -   eval_score = 83.76
2023-04-20 14:34:23,145 - Detection -   train_loss = 0.09482268765568733
2023-04-20 14:34:25,181 - Detection - ***** Epoch: 58: Eval results *****
2023-04-20 14:34:25,181 - Detection -   best_eval_score = 84.28
2023-04-20 14:34:25,181 - Detection -   eval_score = 83.76
2023-04-20 14:34:25,181 - Detection -   train_loss = 0.08665832355618477
2023-04-20 14:34:27,216 - Detection - ***** Epoch: 59: Eval results *****
2023-04-20 14:34:27,216 - Detection -   best_eval_score = 84.28
2023-04-20 14:34:27,216 - Detection -   eval_score = 83.51
2023-04-20 14:34:27,216 - Detection -   train_loss = 0.08764976114034653
2023-04-20 14:34:29,254 - Detection - ***** Epoch: 60: Eval results *****
2023-04-20 14:34:29,254 - Detection -   best_eval_score = 84.28
2023-04-20 14:34:29,254 - Detection -   eval_score = 83.25
2023-04-20 14:34:29,254 - Detection -   train_loss = 0.08457413874566555
2023-04-20 14:34:31,286 - Detection - ***** Epoch: 61: Eval results *****
2023-04-20 14:34:31,286 - Detection -   best_eval_score = 84.28
2023-04-20 14:34:31,286 - Detection -   eval_score = 82.99
2023-04-20 14:34:31,286 - Detection -   train_loss = 0.08449478298425675
2023-04-20 14:34:33,321 - Detection - ***** Epoch: 62: Eval results *****
2023-04-20 14:34:33,321 - Detection -   best_eval_score = 84.28
2023-04-20 14:34:33,321 - Detection -   eval_score = 83.25
2023-04-20 14:34:33,321 - Detection -   train_loss = 0.080563835054636
2023-04-20 14:34:33,322 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.5_1.0_bert_8/models
2023-04-20 14:34:33,860 - Detection - Pre-training finished...
2023-04-20 14:34:33,861 - Detection - Training Begin...
2023-04-20 14:34:37,237 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 14:34:37,237 - Detection -   best_eval_score = 0
2023-04-20 14:34:37,237 - Detection -   eval_score = 0.0
2023-04-20 14:34:37,237 - Detection -   train_loss = 11.095951080322266
2023-04-20 14:34:39,243 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 14:34:39,243 - Detection -   best_eval_score = 0
2023-04-20 14:34:39,243 - Detection -   eval_score = 0.0
2023-04-20 14:34:39,243 - Detection -   train_loss = 10.822335910797118
2023-04-20 14:34:41,252 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 14:34:41,252 - Detection -   best_eval_score = 0
2023-04-20 14:34:41,253 - Detection -   eval_score = 0.0
2023-04-20 14:34:41,253 - Detection -   train_loss = 10.478230667114257
2023-04-20 14:34:43,269 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 14:34:43,269 - Detection -   best_eval_score = 0
2023-04-20 14:34:43,269 - Detection -   eval_score = 0.0
2023-04-20 14:34:43,269 - Detection -   train_loss = 10.086914539337158
2023-04-20 14:34:45,283 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 14:34:45,283 - Detection -   best_eval_score = 0
2023-04-20 14:34:45,283 - Detection -   eval_score = 0.0
2023-04-20 14:34:45,283 - Detection -   train_loss = 9.621761798858643
2023-04-20 14:34:47,299 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 14:34:47,299 - Detection -   best_eval_score = 0
2023-04-20 14:34:47,299 - Detection -   eval_score = 0.0
2023-04-20 14:34:47,299 - Detection -   train_loss = 9.206399536132812
2023-04-20 14:34:49,314 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 14:34:49,314 - Detection -   best_eval_score = 0
2023-04-20 14:34:49,314 - Detection -   eval_score = 0.28
2023-04-20 14:34:49,314 - Detection -   train_loss = 8.739988613128663
2023-04-20 14:34:51,327 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 14:34:51,327 - Detection -   best_eval_score = 0.28
2023-04-20 14:34:51,327 - Detection -   eval_score = 0.54
2023-04-20 14:34:51,327 - Detection -   train_loss = 8.250174427032471
2023-04-20 14:34:53,344 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 14:34:53,344 - Detection -   best_eval_score = 0.54
2023-04-20 14:34:53,344 - Detection -   eval_score = 2.06
2023-04-20 14:34:53,344 - Detection -   train_loss = 7.706250524520874
2023-04-20 14:34:55,361 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 14:34:55,361 - Detection -   best_eval_score = 2.06
2023-04-20 14:34:55,361 - Detection -   eval_score = 5.05
2023-04-20 14:34:55,361 - Detection -   train_loss = 7.2196940898895265
2023-04-20 14:34:57,373 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 14:34:57,373 - Detection -   best_eval_score = 5.05
2023-04-20 14:34:57,373 - Detection -   eval_score = 7.7
2023-04-20 14:34:57,373 - Detection -   train_loss = 6.6687774658203125
2023-04-20 14:34:59,387 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 14:34:59,388 - Detection -   best_eval_score = 7.7
2023-04-20 14:34:59,388 - Detection -   eval_score = 11.09
2023-04-20 14:34:59,388 - Detection -   train_loss = 6.237406921386719
2023-04-20 14:35:01,492 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 14:35:01,492 - Detection -   best_eval_score = 11.09
2023-04-20 14:35:01,492 - Detection -   eval_score = 15.57
2023-04-20 14:35:01,492 - Detection -   train_loss = 5.703729438781738
2023-04-20 14:35:03,507 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 14:35:03,507 - Detection -   best_eval_score = 15.57
2023-04-20 14:35:03,507 - Detection -   eval_score = 22.52
2023-04-20 14:35:03,507 - Detection -   train_loss = 5.219083261489868
2023-04-20 14:35:05,515 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 14:35:05,515 - Detection -   best_eval_score = 22.52
2023-04-20 14:35:05,515 - Detection -   eval_score = 28.79
2023-04-20 14:35:05,515 - Detection -   train_loss = 4.717102861404419
2023-04-20 14:35:07,529 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 14:35:07,529 - Detection -   best_eval_score = 28.79
2023-04-20 14:35:07,529 - Detection -   eval_score = 34.08
2023-04-20 14:35:07,529 - Detection -   train_loss = 4.2529576301574705
2023-04-20 14:35:09,538 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 14:35:09,538 - Detection -   best_eval_score = 34.08
2023-04-20 14:35:09,538 - Detection -   eval_score = 40.3
2023-04-20 14:35:09,538 - Detection -   train_loss = 3.776652383804321
2023-04-20 14:35:11,550 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 14:35:11,550 - Detection -   best_eval_score = 40.3
2023-04-20 14:35:11,550 - Detection -   eval_score = 44.27
2023-04-20 14:35:11,550 - Detection -   train_loss = 3.2996381759643554
2023-04-20 14:35:13,565 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 14:35:13,565 - Detection -   best_eval_score = 44.27
2023-04-20 14:35:13,565 - Detection -   eval_score = 52.02
2023-04-20 14:35:13,565 - Detection -   train_loss = 2.856437611579895
2023-04-20 14:35:15,576 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 14:35:15,576 - Detection -   best_eval_score = 52.02
2023-04-20 14:35:15,576 - Detection -   eval_score = 55.08
2023-04-20 14:35:15,576 - Detection -   train_loss = 2.4010750532150267
2023-04-20 14:35:17,586 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 14:35:17,586 - Detection -   best_eval_score = 55.08
2023-04-20 14:35:17,586 - Detection -   eval_score = 61.58
2023-04-20 14:35:17,586 - Detection -   train_loss = 2.088283360004425
2023-04-20 14:35:19,592 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 14:35:19,592 - Detection -   best_eval_score = 61.58
2023-04-20 14:35:19,592 - Detection -   eval_score = 64.58
2023-04-20 14:35:19,592 - Detection -   train_loss = 1.8336580991744995
2023-04-20 14:35:21,602 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 14:35:21,603 - Detection -   best_eval_score = 64.58
2023-04-20 14:35:21,603 - Detection -   eval_score = 66.11
2023-04-20 14:35:21,603 - Detection -   train_loss = 1.612088644504547
2023-04-20 14:35:23,615 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 14:35:23,615 - Detection -   best_eval_score = 66.11
2023-04-20 14:35:23,615 - Detection -   eval_score = 68.04
2023-04-20 14:35:23,615 - Detection -   train_loss = 1.4665371537208558
2023-04-20 14:35:25,625 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 14:35:25,625 - Detection -   best_eval_score = 68.04
2023-04-20 14:35:25,625 - Detection -   eval_score = 69.13
2023-04-20 14:35:25,625 - Detection -   train_loss = 1.371900749206543
2023-04-20 14:35:27,633 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 14:35:27,633 - Detection -   best_eval_score = 69.13
2023-04-20 14:35:27,633 - Detection -   eval_score = 70.35
2023-04-20 14:35:27,633 - Detection -   train_loss = 1.3027650594711304
2023-04-20 14:35:29,644 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 14:35:29,645 - Detection -   best_eval_score = 70.35
2023-04-20 14:35:29,645 - Detection -   eval_score = 71.48
2023-04-20 14:35:29,645 - Detection -   train_loss = 1.2819543361663819
2023-04-20 14:35:31,652 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 14:35:31,653 - Detection -   best_eval_score = 71.48
2023-04-20 14:35:31,653 - Detection -   eval_score = 71.44
2023-04-20 14:35:31,653 - Detection -   train_loss = 1.2337625622749329
2023-04-20 14:35:33,658 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 14:35:33,658 - Detection -   best_eval_score = 71.48
2023-04-20 14:35:33,658 - Detection -   eval_score = 71.37
2023-04-20 14:35:33,658 - Detection -   train_loss = 1.2640686869621276
2023-04-20 14:35:35,666 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 14:35:35,666 - Detection -   best_eval_score = 71.48
2023-04-20 14:35:35,666 - Detection -   eval_score = 72.35
2023-04-20 14:35:35,666 - Detection -   train_loss = 1.254253911972046
2023-04-20 14:35:37,679 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 14:35:37,679 - Detection -   best_eval_score = 72.35
2023-04-20 14:35:37,679 - Detection -   eval_score = 72.35
2023-04-20 14:35:37,679 - Detection -   train_loss = 1.2552826881408692
2023-04-20 14:35:39,687 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 14:35:39,687 - Detection -   best_eval_score = 72.35
2023-04-20 14:35:39,687 - Detection -   eval_score = 72.55
2023-04-20 14:35:39,687 - Detection -   train_loss = 1.2572372674942016
2023-04-20 14:35:41,696 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 14:35:41,697 - Detection -   best_eval_score = 72.55
2023-04-20 14:35:41,697 - Detection -   eval_score = 72.55
2023-04-20 14:35:41,697 - Detection -   train_loss = 1.2406339406967164
2023-04-20 14:35:43,749 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 14:35:43,749 - Detection -   best_eval_score = 72.55
2023-04-20 14:35:43,750 - Detection -   eval_score = 72.27
2023-04-20 14:35:43,750 - Detection -   train_loss = 1.2274704694747924
2023-04-20 14:35:45,759 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 14:35:45,759 - Detection -   best_eval_score = 72.55
2023-04-20 14:35:45,759 - Detection -   eval_score = 72.51
2023-04-20 14:35:45,759 - Detection -   train_loss = 1.2453389167785645
2023-04-20 14:35:47,778 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 14:35:47,778 - Detection -   best_eval_score = 72.55
2023-04-20 14:35:47,778 - Detection -   eval_score = 72.4
2023-04-20 14:35:47,778 - Detection -   train_loss = 1.2145660996437073
2023-04-20 14:35:49,787 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 14:35:49,787 - Detection -   best_eval_score = 72.55
2023-04-20 14:35:49,787 - Detection -   eval_score = 72.22
2023-04-20 14:35:49,787 - Detection -   train_loss = 1.2404590845108032
2023-04-20 14:35:51,794 - Detection - ***** Epoch: 38: Eval results *****
2023-04-20 14:35:51,794 - Detection -   best_eval_score = 72.55
2023-04-20 14:35:51,794 - Detection -   eval_score = 72.32
2023-04-20 14:35:51,794 - Detection -   train_loss = 1.2463210940361023
2023-04-20 14:35:53,794 - Detection - ***** Epoch: 39: Eval results *****
2023-04-20 14:35:53,794 - Detection -   best_eval_score = 72.55
2023-04-20 14:35:53,794 - Detection -   eval_score = 72.25
2023-04-20 14:35:53,794 - Detection -   train_loss = 1.2666726589202881
2023-04-20 14:35:55,798 - Detection - ***** Epoch: 40: Eval results *****
2023-04-20 14:35:55,798 - Detection -   best_eval_score = 72.55
2023-04-20 14:35:55,798 - Detection -   eval_score = 72.38
2023-04-20 14:35:55,798 - Detection -   train_loss = 1.2307169675827025
2023-04-20 14:35:57,814 - Detection - ***** Epoch: 41: Eval results *****
2023-04-20 14:35:57,814 - Detection -   best_eval_score = 72.55
2023-04-20 14:35:57,814 - Detection -   eval_score = 72.42
2023-04-20 14:35:57,814 - Detection -   train_loss = 1.2742194533348083
2023-04-20 14:35:59,829 - Detection - ***** Epoch: 42: Eval results *****
2023-04-20 14:35:59,829 - Detection -   best_eval_score = 72.55
2023-04-20 14:35:59,829 - Detection -   eval_score = 72.42
2023-04-20 14:35:59,829 - Detection -   train_loss = 1.2145903706550598
2023-04-20 14:35:59,831 - Detection - Training Finished...
2023-04-20 14:35:59,831 - Detection - Testing begin...
2023-04-20 14:36:01,921 - Detection - ***** Test: Confusion Matrix *****
2023-04-20 14:36:01,921 - Detection - [[  3   0   0 ...   0   0  13]
 [  0  19   0 ...   0   0   8]
 [  0   0   2 ...   0   0   6]
 ...
 [  0   0   0 ...  16   0   1]
 [  0   0   0 ...   0  17  13]
 [  0  31   1 ...  10  12 697]]
2023-04-20 14:36:01,921 - Detection - ***** Test results *****
2023-04-20 14:36:01,921 - Detection -   Acc = 67.41
2023-04-20 14:36:01,921 - Detection -   F1 = 61.2051
2023-04-20 14:36:01,921 - Detection -   F1-known = 60.9287
2023-04-20 14:36:01,921 - Detection -   F1-open = 71.7078
2023-04-20 14:36:01,921 - Detection - Testing finished...
2023-04-20 14:36:01,921 - Detection - Results saved in results/results_ADB.csv
2023-04-20 14:36:01,941 - Detection - Open Intent Detection Finished...
