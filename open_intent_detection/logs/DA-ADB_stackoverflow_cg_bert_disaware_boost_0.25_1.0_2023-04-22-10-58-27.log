2023-04-22 10:58:27,443 - Detection - Open Intent Detection Begin...
2023-04-22 10:58:27,443 - Detection - Parameters Initialization...
2023-04-22 10:58:27,443 - Detection - ============================== Params ==============================
2023-04-22 10:58:27,443 - Detection - type:	open_intent_detection
2023-04-22 10:58:27,443 - Detection - logger_name:	Detection
2023-04-22 10:58:27,443 - Detection - log_dir:	logs
2023-04-22 10:58:27,443 - Detection - dataset:	stackoverflow_cg
2023-04-22 10:58:27,443 - Detection - known_cls_ratio:	0.25
2023-04-22 10:58:27,443 - Detection - labeled_ratio:	1.0
2023-04-22 10:58:27,443 - Detection - method:	DA-ADB
2023-04-22 10:58:27,443 - Detection - train:	True
2023-04-22 10:58:27,443 - Detection - pretrain:	True
2023-04-22 10:58:27,443 - Detection - save_model:	False
2023-04-22 10:58:27,443 - Detection - backbone:	bert_disaware_boost
2023-04-22 10:58:27,443 - Detection - config_file_name:	DA-ADB
2023-04-22 10:58:27,443 - Detection - seed:	8
2023-04-22 10:58:27,443 - Detection - gpu_id:	0
2023-04-22 10:58:27,443 - Detection - pipe_results_path:	pipe_results
2023-04-22 10:58:27,443 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-22 10:58:27,443 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-22 10:58:27,443 - Detection - model_dir:	models
2023-04-22 10:58:27,443 - Detection - load_pretrained_method:	None
2023-04-22 10:58:27,443 - Detection - result_dir:	results
2023-04-22 10:58:27,443 - Detection - results_file_name:	results_DA-ADB-BOOST.csv
2023-04-22 10:58:27,443 - Detection - save_results:	True
2023-04-22 10:58:27,444 - Detection - loss_fct:	CrossEntropyLoss
2023-04-22 10:58:27,444 - Detection - boost_method:	F-10
2023-04-22 10:58:27,444 - Detection - boost_start_score:	0.0
2023-04-22 10:58:27,444 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.25_1.0_bert_disaware_boost_8
2023-04-22 10:58:27,444 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.25_1.0_bert_disaware_boost_8/models
2023-04-22 10:58:27,444 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-22 10:58:27,444 - Detection - num_train_epochs:	100
2023-04-22 10:58:27,444 - Detection - num_labels:	None
2023-04-22 10:58:27,444 - Detection - max_seq_length:	None
2023-04-22 10:58:27,444 - Detection - freeze_backbone_parameters:	True
2023-04-22 10:58:27,444 - Detection - feat_dim:	768
2023-04-22 10:58:27,444 - Detection - warmup_proportion:	0.1
2023-04-22 10:58:27,444 - Detection - scale:	4
2023-04-22 10:58:27,444 - Detection - lr_boundary:	0.05
2023-04-22 10:58:27,444 - Detection - lr:	2e-05
2023-04-22 10:58:27,444 - Detection - activation:	relu
2023-04-22 10:58:27,444 - Detection - train_batch_size:	128
2023-04-22 10:58:27,444 - Detection - eval_batch_size:	64
2023-04-22 10:58:27,444 - Detection - test_batch_size:	64
2023-04-22 10:58:27,444 - Detection - wait_patient:	10
2023-04-22 10:58:27,444 - Detection - ============================== End Params ==============================
2023-04-22 10:58:27,444 - Detection - Data and Model Preparation...
2023-04-22 10:58:27,444 - Detection - The number of known intents is 5
2023-04-22 10:58:27,445 - Detection - Lists of known labels are: ['hibernate', 'oracle', 'haskell', 'sharepoint', 'visual-studio']
2023-04-22 10:58:27,451 - Detection - Number of labeled training samples = 720
2023-04-22 10:58:27,451 - Detection - Number of unlabeled training samples = 2071
2023-04-22 10:58:27,454 - Detection - Number of evaluation samples = 319
2023-04-22 10:58:27,459 - Detection - Number of testing samples = 2905
2023-04-22 10:58:32,955 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-22 10:58:33,035 - Detection - Pre-training Begin...
2023-04-22 10:58:35,083 - Detection - ***** Epoch: 1: Eval results *****
2023-04-22 10:58:35,083 - Detection -   best_eval_score = 0
2023-04-22 10:58:35,083 - Detection -   eval_score = 5.25
2023-04-22 10:58:35,083 - Detection -   train_loss = 1.6058540145556133
2023-04-22 10:58:46,642 - Detection - ***** Epoch: 2: Eval results *****
2023-04-22 10:58:46,642 - Detection -   best_eval_score = 5.25
2023-04-22 10:58:46,642 - Detection -   eval_score = 4.65
2023-04-22 10:58:46,642 - Detection -   train_loss = 1.5937480131785076
2023-04-22 10:58:58,066 - Detection - ***** Epoch: 3: Eval results *****
2023-04-22 10:58:58,066 - Detection -   best_eval_score = 5.25
2023-04-22 10:58:58,066 - Detection -   eval_score = 58.32
2023-04-22 10:58:58,066 - Detection -   train_loss = 1.5060383677482605
2023-04-22 10:59:10,640 - Detection - ***** Epoch: 4: Eval results *****
2023-04-22 10:59:10,640 - Detection -   best_eval_score = 58.32
2023-04-22 10:59:10,640 - Detection -   eval_score = 76.58
2023-04-22 10:59:10,640 - Detection -   train_loss = 1.2248784899711609
2023-04-22 10:59:22,076 - Detection - ***** Epoch: 5: Eval results *****
2023-04-22 10:59:22,076 - Detection -   best_eval_score = 76.58
2023-04-22 10:59:22,076 - Detection -   eval_score = 81.28
2023-04-22 10:59:22,076 - Detection -   train_loss = 0.8499241471290588
2023-04-22 10:59:33,688 - Detection - ***** Epoch: 6: Eval results *****
2023-04-22 10:59:33,688 - Detection -   best_eval_score = 81.28
2023-04-22 10:59:33,688 - Detection -   eval_score = 82.35
2023-04-22 10:59:33,688 - Detection -   train_loss = 0.5952298641204834
2023-04-22 10:59:45,192 - Detection - ***** Epoch: 7: Eval results *****
2023-04-22 10:59:45,192 - Detection -   best_eval_score = 82.35
2023-04-22 10:59:45,193 - Detection -   eval_score = 82.59
2023-04-22 10:59:45,193 - Detection -   train_loss = 0.47635571161905926
2023-04-22 10:59:56,773 - Detection - ***** Epoch: 8: Eval results *****
2023-04-22 10:59:56,773 - Detection -   best_eval_score = 82.59
2023-04-22 10:59:56,773 - Detection -   eval_score = 83.29
2023-04-22 10:59:56,773 - Detection -   train_loss = 0.37523818016052246
2023-04-22 11:00:08,393 - Detection - ***** Epoch: 9: Eval results *****
2023-04-22 11:00:08,394 - Detection -   best_eval_score = 83.29
2023-04-22 11:00:08,394 - Detection -   eval_score = 82.32
2023-04-22 11:00:08,394 - Detection -   train_loss = 0.29859763383865356
2023-04-22 11:00:19,875 - Detection - ***** Epoch: 10: Eval results *****
2023-04-22 11:00:19,875 - Detection -   best_eval_score = 83.29
2023-04-22 11:00:19,875 - Detection -   eval_score = 84.14
2023-04-22 11:00:19,875 - Detection -   train_loss = 0.2497228259841601
2023-04-22 11:00:31,487 - Detection - ***** Epoch: 11: Eval results *****
2023-04-22 11:00:31,487 - Detection -   best_eval_score = 84.14
2023-04-22 11:00:31,487 - Detection -   eval_score = 82.87
2023-04-22 11:00:31,487 - Detection -   train_loss = 0.20715889831384024
2023-04-22 11:00:42,926 - Detection - ***** Epoch: 12: Eval results *****
2023-04-22 11:00:42,926 - Detection -   best_eval_score = 84.14
2023-04-22 11:00:42,926 - Detection -   eval_score = 83.58
2023-04-22 11:00:42,926 - Detection -   train_loss = 0.17078237483898798
2023-04-22 11:00:54,374 - Detection - ***** Epoch: 13: Eval results *****
2023-04-22 11:00:54,374 - Detection -   best_eval_score = 84.14
2023-04-22 11:00:54,374 - Detection -   eval_score = 81.91
2023-04-22 11:00:54,374 - Detection -   train_loss = 0.15843359380960464
2023-04-22 11:01:06,024 - Detection - ***** Epoch: 14: Eval results *****
2023-04-22 11:01:06,024 - Detection -   best_eval_score = 84.14
2023-04-22 11:01:06,024 - Detection -   eval_score = 83.55
2023-04-22 11:01:06,025 - Detection -   train_loss = 0.1490145449837049
2023-04-22 11:01:17,524 - Detection - ***** Epoch: 15: Eval results *****
2023-04-22 11:01:17,524 - Detection -   best_eval_score = 84.14
2023-04-22 11:01:17,524 - Detection -   eval_score = 83.32
2023-04-22 11:01:17,524 - Detection -   train_loss = 0.13978980481624603
2023-04-22 11:01:28,985 - Detection - ***** Epoch: 16: Eval results *****
2023-04-22 11:01:28,985 - Detection -   best_eval_score = 84.14
2023-04-22 11:01:28,985 - Detection -   eval_score = 83.39
2023-04-22 11:01:28,985 - Detection -   train_loss = 0.12794896215200424
2023-04-22 11:01:40,519 - Detection - ***** Epoch: 17: Eval results *****
2023-04-22 11:01:40,519 - Detection -   best_eval_score = 84.14
2023-04-22 11:01:40,519 - Detection -   eval_score = 83.56
2023-04-22 11:01:40,519 - Detection -   train_loss = 0.11553447445233662
2023-04-22 11:01:51,957 - Detection - ***** Epoch: 18: Eval results *****
2023-04-22 11:01:51,957 - Detection -   best_eval_score = 84.14
2023-04-22 11:01:51,957 - Detection -   eval_score = 83.35
2023-04-22 11:01:51,957 - Detection -   train_loss = 0.1068982866903146
2023-04-22 11:02:03,510 - Detection - ***** Epoch: 19: Eval results *****
2023-04-22 11:02:03,510 - Detection -   best_eval_score = 84.14
2023-04-22 11:02:03,510 - Detection -   eval_score = 84.81
2023-04-22 11:02:03,510 - Detection -   train_loss = 0.11393844584623973
2023-04-22 11:02:14,950 - Detection - ***** Epoch: 20: Eval results *****
2023-04-22 11:02:14,950 - Detection -   best_eval_score = 84.81
2023-04-22 11:02:14,951 - Detection -   eval_score = 83.0
2023-04-22 11:02:14,951 - Detection -   train_loss = 0.10487990702191989
2023-04-22 11:02:26,523 - Detection - ***** Epoch: 21: Eval results *****
2023-04-22 11:02:26,523 - Detection -   best_eval_score = 84.81
2023-04-22 11:02:26,523 - Detection -   eval_score = 83.3
2023-04-22 11:02:26,523 - Detection -   train_loss = 0.09541604047020276
2023-04-22 11:02:37,984 - Detection - ***** Epoch: 22: Eval results *****
2023-04-22 11:02:37,984 - Detection -   best_eval_score = 84.81
2023-04-22 11:02:37,984 - Detection -   eval_score = 83.53
2023-04-22 11:02:37,984 - Detection -   train_loss = 0.09467360749840736
2023-04-22 11:02:49,574 - Detection - ***** Epoch: 23: Eval results *****
2023-04-22 11:02:49,574 - Detection -   best_eval_score = 84.81
2023-04-22 11:02:49,574 - Detection -   eval_score = 84.42
2023-04-22 11:02:49,574 - Detection -   train_loss = 0.09082373480002086
2023-04-22 11:03:01,054 - Detection - ***** Epoch: 24: Eval results *****
2023-04-22 11:03:01,054 - Detection -   best_eval_score = 84.81
2023-04-22 11:03:01,054 - Detection -   eval_score = 84.15
2023-04-22 11:03:01,054 - Detection -   train_loss = 0.09228842705488205
2023-04-22 11:03:12,665 - Detection - ***** Epoch: 25: Eval results *****
2023-04-22 11:03:12,665 - Detection -   best_eval_score = 84.81
2023-04-22 11:03:12,665 - Detection -   eval_score = 84.03
2023-04-22 11:03:12,665 - Detection -   train_loss = 0.08478992680708568
2023-04-22 11:03:24,691 - Detection - ***** Epoch: 26: Eval results *****
2023-04-22 11:03:24,691 - Detection -   best_eval_score = 84.81
2023-04-22 11:03:24,691 - Detection -   eval_score = 83.69
2023-04-22 11:03:24,691 - Detection -   train_loss = 0.07766314099232356
2023-04-22 11:03:36,276 - Detection - ***** Epoch: 27: Eval results *****
2023-04-22 11:03:36,276 - Detection -   best_eval_score = 84.81
2023-04-22 11:03:36,276 - Detection -   eval_score = 83.39
2023-04-22 11:03:36,276 - Detection -   train_loss = 0.08119652420282364
2023-04-22 11:03:47,758 - Detection - ***** Epoch: 28: Eval results *****
2023-04-22 11:03:47,758 - Detection -   best_eval_score = 84.81
2023-04-22 11:03:47,758 - Detection -   eval_score = 84.41
2023-04-22 11:03:47,758 - Detection -   train_loss = 0.08040239537755649
2023-04-22 11:03:59,640 - Detection - ***** Epoch: 29: Eval results *****
2023-04-22 11:03:59,640 - Detection -   best_eval_score = 84.81
2023-04-22 11:03:59,640 - Detection -   eval_score = 83.43
2023-04-22 11:03:59,640 - Detection -   train_loss = 0.0809722716609637
2023-04-22 11:03:59,641 - Detection - Pre-training finished...
2023-04-22 11:03:59,641 - Detection - Training Begin...
2023-04-22 11:04:00,577 - Detection - ***** Epoch: 1: Eval results *****
2023-04-22 11:04:00,577 - Detection -   best_eval_score = 0
2023-04-22 11:04:00,577 - Detection -   eval_score = 6.06
2023-04-22 11:04:00,577 - Detection -   train_loss = 4.853162844975789
2023-04-22 11:04:11,688 - Detection - ***** Epoch: 2: Eval results *****
2023-04-22 11:04:11,688 - Detection -   best_eval_score = 6.06
2023-04-22 11:04:11,688 - Detection -   eval_score = 47.04
2023-04-22 11:04:11,688 - Detection -   train_loss = 4.681906064351399
2023-04-22 11:04:22,568 - Detection - ***** Epoch: 3: Eval results *****
2023-04-22 11:04:22,568 - Detection -   best_eval_score = 47.04
2023-04-22 11:04:22,568 - Detection -   eval_score = 59.35
2023-04-22 11:04:22,568 - Detection -   train_loss = 1.9348647991816204
2023-04-22 11:04:33,381 - Detection - ***** Epoch: 4: Eval results *****
2023-04-22 11:04:33,382 - Detection -   best_eval_score = 59.35
2023-04-22 11:04:33,382 - Detection -   eval_score = 58.83
2023-04-22 11:04:33,382 - Detection -   train_loss = 1.1591757734616597
2023-04-22 11:04:44,311 - Detection - ***** Epoch: 5: Eval results *****
2023-04-22 11:04:44,311 - Detection -   best_eval_score = 59.35
2023-04-22 11:04:44,311 - Detection -   eval_score = 58.67
2023-04-22 11:04:44,311 - Detection -   train_loss = 1.1325253943602245
2023-04-22 11:04:55,089 - Detection - ***** Epoch: 6: Eval results *****
2023-04-22 11:04:55,089 - Detection -   best_eval_score = 59.35
2023-04-22 11:04:55,089 - Detection -   eval_score = 58.83
2023-04-22 11:04:55,089 - Detection -   train_loss = 1.1290292938550313
2023-04-22 11:05:05,905 - Detection - ***** Epoch: 7: Eval results *****
2023-04-22 11:05:05,905 - Detection -   best_eval_score = 59.35
2023-04-22 11:05:05,905 - Detection -   eval_score = 58.83
2023-04-22 11:05:05,905 - Detection -   train_loss = 1.161819597085317
2023-04-22 11:05:16,916 - Detection - ***** Epoch: 8: Eval results *****
2023-04-22 11:05:16,917 - Detection -   best_eval_score = 59.35
2023-04-22 11:05:16,917 - Detection -   eval_score = 58.7
2023-04-22 11:05:16,917 - Detection -   train_loss = 1.1141010920206706
2023-04-22 11:05:27,743 - Detection - ***** Epoch: 9: Eval results *****
2023-04-22 11:05:27,744 - Detection -   best_eval_score = 59.35
2023-04-22 11:05:27,744 - Detection -   eval_score = 58.98
2023-04-22 11:05:27,744 - Detection -   train_loss = 1.1896222233772278
2023-04-22 11:05:38,536 - Detection - ***** Epoch: 10: Eval results *****
2023-04-22 11:05:38,536 - Detection -   best_eval_score = 59.35
2023-04-22 11:05:38,536 - Detection -   eval_score = 59.07
2023-04-22 11:05:38,536 - Detection -   train_loss = 1.093414843082428
2023-04-22 11:05:49,425 - Detection - ***** Epoch: 11: Eval results *****
2023-04-22 11:05:49,425 - Detection -   best_eval_score = 59.35
2023-04-22 11:05:49,425 - Detection -   eval_score = 59.19
2023-04-22 11:05:49,425 - Detection -   train_loss = 1.1041738986968994
2023-04-22 11:06:00,207 - Detection - ***** Epoch: 12: Eval results *****
2023-04-22 11:06:00,207 - Detection -   best_eval_score = 59.35
2023-04-22 11:06:00,207 - Detection -   eval_score = 58.83
2023-04-22 11:06:00,207 - Detection -   train_loss = 1.212249716122945
2023-04-22 11:06:11,281 - Detection - ***** Epoch: 13: Eval results *****
2023-04-22 11:06:11,282 - Detection -   best_eval_score = 59.35
2023-04-22 11:06:11,282 - Detection -   eval_score = 59.01
2023-04-22 11:06:11,282 - Detection -   train_loss = 1.1086636185646057
2023-04-22 11:06:11,282 - Detection - Training Finished...
2023-04-22 11:06:11,282 - Detection - Testing begin...
2023-04-22 11:06:13,700 - Detection - ***** Test: Confusion Matrix *****
2023-04-22 11:06:13,700 - Detection - [[  86    3    4    0    0   35]
 [   0   94    4    1    1   27]
 [   0    0   39    0    1   82]
 [   0    0    1  128    2   40]
 [   0    1    2    3   46   54]
 [  16    7  238   69   88 1833]]
2023-04-22 11:06:13,700 - Detection - ***** Test results *****
2023-04-22 11:06:13,700 - Detection -   Acc = 76.63
2023-04-22 11:06:13,700 - Detection -   F1 = 61.0309
2023-04-22 11:06:13,700 - Detection -   F1-known = 56.2727
2023-04-22 11:06:13,700 - Detection -   F1-open = 84.8218
2023-04-22 11:06:13,700 - Detection - Testing finished...
2023-04-22 11:06:13,700 - Detection - Results saved in results/results_DA-ADB-BOOST.csv
2023-04-22 11:06:13,719 - Detection - Open Intent Detection Finished...
