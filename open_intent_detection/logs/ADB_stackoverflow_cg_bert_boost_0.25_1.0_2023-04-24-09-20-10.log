2023-04-24 09:20:10,900 - Detection - Open Intent Detection Begin...
2023-04-24 09:20:10,900 - Detection - Parameters Initialization...
2023-04-24 09:20:10,901 - Detection - ============================== Params ==============================
2023-04-24 09:20:10,901 - Detection - type:	open_intent_detection
2023-04-24 09:20:10,901 - Detection - logger_name:	Detection
2023-04-24 09:20:10,901 - Detection - log_dir:	logs
2023-04-24 09:20:10,901 - Detection - dataset:	stackoverflow_cg
2023-04-24 09:20:10,901 - Detection - known_cls_ratio:	0.25
2023-04-24 09:20:10,901 - Detection - labeled_ratio:	1.0
2023-04-24 09:20:10,901 - Detection - method:	ADB
2023-04-24 09:20:10,901 - Detection - train:	True
2023-04-24 09:20:10,901 - Detection - pretrain:	True
2023-04-24 09:20:10,901 - Detection - save_model:	False
2023-04-24 09:20:10,901 - Detection - backbone:	bert_boost
2023-04-24 09:20:10,901 - Detection - config_file_name:	ADB
2023-04-24 09:20:10,901 - Detection - seed:	4
2023-04-24 09:20:10,901 - Detection - gpu_id:	0
2023-04-24 09:20:10,901 - Detection - pipe_results_path:	pipe_results
2023-04-24 09:20:10,901 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-24 09:20:10,901 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-24 09:20:10,901 - Detection - model_dir:	models
2023-04-24 09:20:10,901 - Detection - load_pretrained_method:	None
2023-04-24 09:20:10,901 - Detection - result_dir:	results
2023-04-24 09:20:10,901 - Detection - results_file_name:	results_ADB-BOOST-F-10.csv
2023-04-24 09:20:10,901 - Detection - save_results:	True
2023-04-24 09:20:10,901 - Detection - loss_fct:	CrossEntropyLoss
2023-04-24 09:20:10,901 - Detection - boost_method:	F-10
2023-04-24 09:20:10,901 - Detection - boost_start_score:	0.0
2023-04-24 09:20:10,901 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.25_1.0_bert_boost_4
2023-04-24 09:20:10,901 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.25_1.0_bert_boost_4/models
2023-04-24 09:20:10,901 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-24 09:20:10,901 - Detection - num_train_epochs:	100
2023-04-24 09:20:10,901 - Detection - num_labels:	None
2023-04-24 09:20:10,901 - Detection - max_seq_length:	None
2023-04-24 09:20:10,901 - Detection - freeze_backbone_parameters:	True
2023-04-24 09:20:10,901 - Detection - feat_dim:	768
2023-04-24 09:20:10,901 - Detection - warmup_proportion:	0.1
2023-04-24 09:20:10,901 - Detection - lr_boundary:	0.05
2023-04-24 09:20:10,901 - Detection - lr:	2e-05
2023-04-24 09:20:10,901 - Detection - activation:	relu
2023-04-24 09:20:10,901 - Detection - train_batch_size:	128
2023-04-24 09:20:10,901 - Detection - eval_batch_size:	64
2023-04-24 09:20:10,901 - Detection - test_batch_size:	64
2023-04-24 09:20:10,901 - Detection - wait_patient:	10
2023-04-24 09:20:10,902 - Detection - ============================== End Params ==============================
2023-04-24 09:20:10,902 - Detection - Data and Model Preparation...
2023-04-24 09:20:10,902 - Detection - The number of known intents is 5
2023-04-24 09:20:10,902 - Detection - Lists of known labels are: ['wordpress', 'cocoa', 'visual-studio', 'haskell', 'qt']
2023-04-24 09:20:10,910 - Detection - Number of labeled training samples = 861
2023-04-24 09:20:10,910 - Detection - Number of unlabeled training samples = 1930
2023-04-24 09:20:10,912 - Detection - Number of evaluation samples = 320
2023-04-24 09:20:10,918 - Detection - Number of testing samples = 2905
2023-04-24 09:20:14,817 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-24 09:20:16,479 - Detection - Pre-training Begin...
2023-04-24 09:20:18,039 - Detection - ***** Epoch: 1: Eval results *****
2023-04-24 09:20:18,039 - Detection -   best_eval_score = 0
2023-04-24 09:20:18,039 - Detection -   eval_score = 24.06
2023-04-24 09:20:18,040 - Detection -   train_loss = 1.6034260647637504
2023-04-24 09:20:30,948 - Detection - ***** Epoch: 2: Eval results *****
2023-04-24 09:20:30,948 - Detection -   best_eval_score = 24.06
2023-04-24 09:20:30,948 - Detection -   eval_score = 36.56
2023-04-24 09:20:30,948 - Detection -   train_loss = 1.5910477808543615
2023-04-24 09:20:43,895 - Detection - ***** Epoch: 3: Eval results *****
2023-04-24 09:20:43,895 - Detection -   best_eval_score = 36.56
2023-04-24 09:20:43,895 - Detection -   eval_score = 77.19
2023-04-24 09:20:43,895 - Detection -   train_loss = 1.2681134939193726
2023-04-24 09:20:56,682 - Detection - ***** Epoch: 4: Eval results *****
2023-04-24 09:20:56,682 - Detection -   best_eval_score = 77.19
2023-04-24 09:20:56,682 - Detection -   eval_score = 83.75
2023-04-24 09:20:56,682 - Detection -   train_loss = 0.5894981920719147
2023-04-24 09:21:09,617 - Detection - ***** Epoch: 5: Eval results *****
2023-04-24 09:21:09,617 - Detection -   best_eval_score = 83.75
2023-04-24 09:21:09,617 - Detection -   eval_score = 84.69
2023-04-24 09:21:09,617 - Detection -   train_loss = 0.37796083092689514
2023-04-24 09:21:22,433 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 09:21:22,433 - Detection -   best_eval_score = 84.69
2023-04-24 09:21:22,433 - Detection -   eval_score = 85.62
2023-04-24 09:21:22,433 - Detection -   train_loss = 0.2662983515432903
2023-04-24 09:21:35,359 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 09:21:35,359 - Detection -   best_eval_score = 85.62
2023-04-24 09:21:35,359 - Detection -   eval_score = 86.25
2023-04-24 09:21:35,359 - Detection -   train_loss = 0.1832331738301686
2023-04-24 09:21:48,256 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 09:21:48,256 - Detection -   best_eval_score = 86.25
2023-04-24 09:21:48,256 - Detection -   eval_score = 86.56
2023-04-24 09:21:48,256 - Detection -   train_loss = 0.11354127206972667
2023-04-24 09:22:01,046 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 09:22:01,046 - Detection -   best_eval_score = 86.56
2023-04-24 09:22:01,046 - Detection -   eval_score = 86.56
2023-04-24 09:22:01,046 - Detection -   train_loss = 0.0991778059729508
2023-04-24 09:22:13,957 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 09:22:13,957 - Detection -   best_eval_score = 86.56
2023-04-24 09:22:13,957 - Detection -   eval_score = 87.5
2023-04-24 09:22:13,957 - Detection -   train_loss = 0.057609068495886664
2023-04-24 09:22:26,798 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 09:22:26,798 - Detection -   best_eval_score = 87.5
2023-04-24 09:22:26,798 - Detection -   eval_score = 87.19
2023-04-24 09:22:26,798 - Detection -   train_loss = 0.04745281221611159
2023-04-24 09:22:39,739 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 09:22:39,739 - Detection -   best_eval_score = 87.5
2023-04-24 09:22:39,739 - Detection -   eval_score = 87.19
2023-04-24 09:22:39,739 - Detection -   train_loss = 0.039454219596726556
2023-04-24 09:22:52,732 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 09:22:52,732 - Detection -   best_eval_score = 87.5
2023-04-24 09:22:52,732 - Detection -   eval_score = 87.19
2023-04-24 09:22:52,732 - Detection -   train_loss = 0.040276799350976944
2023-04-24 09:23:05,558 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 09:23:05,558 - Detection -   best_eval_score = 87.5
2023-04-24 09:23:05,558 - Detection -   eval_score = 86.88
2023-04-24 09:23:05,558 - Detection -   train_loss = 0.01893070885645492
2023-04-24 09:23:18,499 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 09:23:18,499 - Detection -   best_eval_score = 87.5
2023-04-24 09:23:18,499 - Detection -   eval_score = 87.5
2023-04-24 09:23:18,499 - Detection -   train_loss = 0.030516773728387698
2023-04-24 09:23:31,309 - Detection - ***** Epoch: 16: Eval results *****
2023-04-24 09:23:31,310 - Detection -   best_eval_score = 87.5
2023-04-24 09:23:31,310 - Detection -   eval_score = 86.25
2023-04-24 09:23:31,310 - Detection -   train_loss = 0.023867206647992134
2023-04-24 09:23:44,280 - Detection - ***** Epoch: 17: Eval results *****
2023-04-24 09:23:44,280 - Detection -   best_eval_score = 87.5
2023-04-24 09:23:44,280 - Detection -   eval_score = 86.88
2023-04-24 09:23:44,280 - Detection -   train_loss = 0.014241462440362998
2023-04-24 09:23:57,104 - Detection - ***** Epoch: 18: Eval results *****
2023-04-24 09:23:57,104 - Detection -   best_eval_score = 87.5
2023-04-24 09:23:57,104 - Detection -   eval_score = 87.19
2023-04-24 09:23:57,104 - Detection -   train_loss = 0.01736376674047538
2023-04-24 09:24:10,145 - Detection - ***** Epoch: 19: Eval results *****
2023-04-24 09:24:10,145 - Detection -   best_eval_score = 87.5
2023-04-24 09:24:10,145 - Detection -   eval_score = 86.88
2023-04-24 09:24:10,145 - Detection -   train_loss = 0.010009205767086573
2023-04-24 09:24:22,991 - Detection - ***** Epoch: 20: Eval results *****
2023-04-24 09:24:22,991 - Detection -   best_eval_score = 87.5
2023-04-24 09:24:22,991 - Detection -   eval_score = 86.56
2023-04-24 09:24:22,991 - Detection -   train_loss = 0.016663676859544858
2023-04-24 09:24:22,991 - Detection - Pre-training finished...
2023-04-24 09:24:22,992 - Detection - Training Begin...
2023-04-24 09:24:24,739 - Detection - ***** Epoch: 1: Eval results *****
2023-04-24 09:24:24,739 - Detection -   best_eval_score = 0
2023-04-24 09:24:24,739 - Detection -   eval_score = 0.0
2023-04-24 09:24:24,739 - Detection -   train_loss = 7.9807000160217285
2023-04-24 09:24:25,791 - Detection - ***** Epoch: 2: Eval results *****
2023-04-24 09:24:25,792 - Detection -   best_eval_score = 0
2023-04-24 09:24:25,792 - Detection -   eval_score = 0.0
2023-04-24 09:24:25,792 - Detection -   train_loss = 7.798728329794748
2023-04-24 09:24:26,845 - Detection - ***** Epoch: 3: Eval results *****
2023-04-24 09:24:26,845 - Detection -   best_eval_score = 0
2023-04-24 09:24:26,845 - Detection -   eval_score = 0.0
2023-04-24 09:24:26,845 - Detection -   train_loss = 7.486104556492397
2023-04-24 09:24:27,899 - Detection - ***** Epoch: 4: Eval results *****
2023-04-24 09:24:27,899 - Detection -   best_eval_score = 0
2023-04-24 09:24:27,899 - Detection -   eval_score = 0.0
2023-04-24 09:24:27,899 - Detection -   train_loss = 7.312911578587124
2023-04-24 09:24:28,952 - Detection - ***** Epoch: 5: Eval results *****
2023-04-24 09:24:28,952 - Detection -   best_eval_score = 0
2023-04-24 09:24:28,952 - Detection -   eval_score = 0.0
2023-04-24 09:24:28,952 - Detection -   train_loss = 7.021813188280378
2023-04-24 09:24:30,006 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 09:24:30,006 - Detection -   best_eval_score = 0
2023-04-24 09:24:30,006 - Detection -   eval_score = 0.0
2023-04-24 09:24:30,006 - Detection -   train_loss = 6.674294131142752
2023-04-24 09:24:31,060 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 09:24:31,060 - Detection -   best_eval_score = 0
2023-04-24 09:24:31,060 - Detection -   eval_score = 0.0
2023-04-24 09:24:31,060 - Detection -   train_loss = 6.32263149533953
2023-04-24 09:24:32,116 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 09:24:32,116 - Detection -   best_eval_score = 0
2023-04-24 09:24:32,116 - Detection -   eval_score = 1.81
2023-04-24 09:24:32,116 - Detection -   train_loss = 5.95011602129255
2023-04-24 09:24:44,984 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 09:24:44,984 - Detection -   best_eval_score = 1.81
2023-04-24 09:24:44,984 - Detection -   eval_score = 62.61
2023-04-24 09:24:44,984 - Detection -   train_loss = 5.568318775721958
2023-04-24 09:24:57,997 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 09:24:57,998 - Detection -   best_eval_score = 62.61
2023-04-24 09:24:57,998 - Detection -   eval_score = 68.13
2023-04-24 09:24:57,998 - Detection -   train_loss = 1.6072956153324671
2023-04-24 09:25:10,749 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 09:25:10,749 - Detection -   best_eval_score = 68.13
2023-04-24 09:25:10,749 - Detection -   eval_score = 68.13
2023-04-24 09:25:10,749 - Detection -   train_loss = 1.3118879624775477
2023-04-24 09:25:23,648 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 09:25:23,648 - Detection -   best_eval_score = 68.13
2023-04-24 09:25:23,648 - Detection -   eval_score = 68.13
2023-04-24 09:25:23,648 - Detection -   train_loss = 1.3027979646410262
2023-04-24 09:25:36,652 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 09:25:36,652 - Detection -   best_eval_score = 68.13
2023-04-24 09:25:36,652 - Detection -   eval_score = 68.13
2023-04-24 09:25:36,652 - Detection -   train_loss = 1.2997972454343523
2023-04-24 09:25:49,483 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 09:25:49,483 - Detection -   best_eval_score = 68.13
2023-04-24 09:25:49,483 - Detection -   eval_score = 68.01
2023-04-24 09:25:49,483 - Detection -   train_loss = 1.2876207487923759
2023-04-24 09:26:02,503 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 09:26:02,503 - Detection -   best_eval_score = 68.13
2023-04-24 09:26:02,503 - Detection -   eval_score = 68.13
2023-04-24 09:26:02,503 - Detection -   train_loss = 1.3423971959522791
2023-04-24 09:26:15,356 - Detection - ***** Epoch: 16: Eval results *****
2023-04-24 09:26:15,356 - Detection -   best_eval_score = 68.13
2023-04-24 09:26:15,356 - Detection -   eval_score = 67.93
2023-04-24 09:26:15,356 - Detection -   train_loss = 1.3172145741326469
2023-04-24 09:26:28,166 - Detection - ***** Epoch: 17: Eval results *****
2023-04-24 09:26:28,166 - Detection -   best_eval_score = 68.13
2023-04-24 09:26:28,166 - Detection -   eval_score = 68.13
2023-04-24 09:26:28,167 - Detection -   train_loss = 1.2780429465430123
2023-04-24 09:26:40,924 - Detection - ***** Epoch: 18: Eval results *****
2023-04-24 09:26:40,924 - Detection -   best_eval_score = 68.13
2023-04-24 09:26:40,924 - Detection -   eval_score = 68.29
2023-04-24 09:26:40,924 - Detection -   train_loss = 1.2906080654689245
2023-04-24 09:26:53,830 - Detection - ***** Epoch: 19: Eval results *****
2023-04-24 09:26:53,830 - Detection -   best_eval_score = 68.29
2023-04-24 09:26:53,830 - Detection -   eval_score = 68.46
2023-04-24 09:26:53,830 - Detection -   train_loss = 1.3041503088814872
2023-04-24 09:27:06,754 - Detection - ***** Epoch: 20: Eval results *****
2023-04-24 09:27:06,754 - Detection -   best_eval_score = 68.46
2023-04-24 09:27:06,754 - Detection -   eval_score = 68.29
2023-04-24 09:27:06,754 - Detection -   train_loss = 1.3529330832617623
2023-04-24 09:27:19,502 - Detection - ***** Epoch: 21: Eval results *****
2023-04-24 09:27:19,502 - Detection -   best_eval_score = 68.46
2023-04-24 09:27:19,502 - Detection -   eval_score = 67.93
2023-04-24 09:27:19,502 - Detection -   train_loss = 1.3078022343771798
2023-04-24 09:27:32,333 - Detection - ***** Epoch: 22: Eval results *****
2023-04-24 09:27:32,333 - Detection -   best_eval_score = 68.46
2023-04-24 09:27:32,333 - Detection -   eval_score = 67.93
2023-04-24 09:27:32,333 - Detection -   train_loss = 1.2839249883379256
2023-04-24 09:27:45,099 - Detection - ***** Epoch: 23: Eval results *****
2023-04-24 09:27:45,099 - Detection -   best_eval_score = 68.46
2023-04-24 09:27:45,099 - Detection -   eval_score = 67.93
2023-04-24 09:27:45,099 - Detection -   train_loss = 1.336118255342756
2023-04-24 09:27:58,179 - Detection - ***** Epoch: 24: Eval results *****
2023-04-24 09:27:58,180 - Detection -   best_eval_score = 68.46
2023-04-24 09:27:58,180 - Detection -   eval_score = 68.13
2023-04-24 09:27:58,180 - Detection -   train_loss = 1.3570922102246965
2023-04-24 09:28:10,980 - Detection - ***** Epoch: 25: Eval results *****
2023-04-24 09:28:10,980 - Detection -   best_eval_score = 68.46
2023-04-24 09:28:10,980 - Detection -   eval_score = 68.08
2023-04-24 09:28:10,980 - Detection -   train_loss = 1.214573792048863
2023-04-24 09:28:23,887 - Detection - ***** Epoch: 26: Eval results *****
2023-04-24 09:28:23,888 - Detection -   best_eval_score = 68.46
2023-04-24 09:28:23,888 - Detection -   eval_score = 68.13
2023-04-24 09:28:23,888 - Detection -   train_loss = 1.3026258775166102
2023-04-24 09:28:36,928 - Detection - ***** Epoch: 27: Eval results *****
2023-04-24 09:28:36,928 - Detection -   best_eval_score = 68.46
2023-04-24 09:28:36,928 - Detection -   eval_score = 68.13
2023-04-24 09:28:36,928 - Detection -   train_loss = 1.2842552661895752
2023-04-24 09:28:49,662 - Detection - ***** Epoch: 28: Eval results *****
2023-04-24 09:28:49,662 - Detection -   best_eval_score = 68.46
2023-04-24 09:28:49,662 - Detection -   eval_score = 68.29
2023-04-24 09:28:49,662 - Detection -   train_loss = 1.3091493930135454
2023-04-24 09:29:02,673 - Detection - ***** Epoch: 29: Eval results *****
2023-04-24 09:29:02,673 - Detection -   best_eval_score = 68.46
2023-04-24 09:29:02,673 - Detection -   eval_score = 68.13
2023-04-24 09:29:02,673 - Detection -   train_loss = 1.2875729628971644
2023-04-24 09:29:02,673 - Detection - Training Finished...
2023-04-24 09:29:02,673 - Detection - Testing begin...
2023-04-24 09:29:05,069 - Detection - ***** Test: Confusion Matrix *****
2023-04-24 09:29:05,069 - Detection - [[ 117    0    1    0    0   19]
 [   0   97    0    5    3   56]
 [   1    4   52    2    0   47]
 [   0    0    2   89    0   31]
 [   0    3    0    1  152   16]
 [  35  292   71  214    4 1591]]
2023-04-24 09:29:05,069 - Detection - ***** Test results *****
2023-04-24 09:29:05,069 - Detection -   Acc = 72.22
2023-04-24 09:29:05,069 - Detection -   F1 = 62.2516
2023-04-24 09:29:05,069 - Detection -   F1-known = 58.6596
2023-04-24 09:29:05,069 - Detection -   F1-open = 80.2117
2023-04-24 09:29:05,069 - Detection - Testing finished...
2023-04-24 09:29:05,069 - Detection - Results saved in results/results_ADB-BOOST-F-10.csv
2023-04-24 09:29:05,088 - Detection - Open Intent Detection Finished...
