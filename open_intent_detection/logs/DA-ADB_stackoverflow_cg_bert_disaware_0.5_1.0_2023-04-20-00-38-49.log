2023-04-20 00:38:49,931 - Detection - Open Intent Detection Begin...
2023-04-20 00:38:49,932 - Detection - Parameters Initialization...
2023-04-20 00:38:49,932 - Detection - ============================== Params ==============================
2023-04-20 00:38:49,932 - Detection - type:	open_intent_detection
2023-04-20 00:38:49,932 - Detection - logger_name:	Detection
2023-04-20 00:38:49,932 - Detection - log_dir:	logs
2023-04-20 00:38:49,932 - Detection - dataset:	stackoverflow_cg
2023-04-20 00:38:49,932 - Detection - known_cls_ratio:	0.5
2023-04-20 00:38:49,932 - Detection - labeled_ratio:	1.0
2023-04-20 00:38:49,932 - Detection - method:	DA-ADB
2023-04-20 00:38:49,932 - Detection - train:	True
2023-04-20 00:38:49,932 - Detection - pretrain:	True
2023-04-20 00:38:49,932 - Detection - save_model:	True
2023-04-20 00:38:49,932 - Detection - backbone:	bert_disaware
2023-04-20 00:38:49,932 - Detection - config_file_name:	DA-ADB
2023-04-20 00:38:49,932 - Detection - seed:	3
2023-04-20 00:38:49,932 - Detection - gpu_id:	0
2023-04-20 00:38:49,932 - Detection - pipe_results_path:	pipe_results
2023-04-20 00:38:49,932 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-20 00:38:49,932 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-20 00:38:49,932 - Detection - model_dir:	models
2023-04-20 00:38:49,932 - Detection - load_pretrained_method:	None
2023-04-20 00:38:49,933 - Detection - result_dir:	results
2023-04-20 00:38:49,933 - Detection - results_file_name:	results_DA-ADB.csv
2023-04-20 00:38:49,933 - Detection - save_results:	True
2023-04-20 00:38:49,933 - Detection - loss_fct:	CrossEntropyLoss
2023-04-20 00:38:49,933 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.5_1.0_bert_disaware_3
2023-04-20 00:38:49,933 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.5_1.0_bert_disaware_3/models
2023-04-20 00:38:49,933 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-20 00:38:49,933 - Detection - num_train_epochs:	100
2023-04-20 00:38:49,933 - Detection - num_labels:	None
2023-04-20 00:38:49,933 - Detection - max_seq_length:	None
2023-04-20 00:38:49,933 - Detection - freeze_backbone_parameters:	True
2023-04-20 00:38:49,933 - Detection - feat_dim:	768
2023-04-20 00:38:49,933 - Detection - warmup_proportion:	0.1
2023-04-20 00:38:49,933 - Detection - scale:	4
2023-04-20 00:38:49,933 - Detection - lr_boundary:	0.05
2023-04-20 00:38:49,933 - Detection - lr:	2e-05
2023-04-20 00:38:49,933 - Detection - activation:	relu
2023-04-20 00:38:49,933 - Detection - train_batch_size:	128
2023-04-20 00:38:49,933 - Detection - eval_batch_size:	64
2023-04-20 00:38:49,933 - Detection - test_batch_size:	64
2023-04-20 00:38:49,933 - Detection - wait_patient:	10
2023-04-20 00:38:49,933 - Detection - ============================== End Params ==============================
2023-04-20 00:38:49,933 - Detection - Data and Model Preparation...
2023-04-20 00:38:49,933 - Detection - The number of known intents is 10
2023-04-20 00:38:49,934 - Detection - Lists of known labels are: ['scala', 'bash', 'apache', 'svn', 'drupal', 'spring', 'haskell', 'hibernate', 'sharepoint', 'osx']
2023-04-20 00:38:49,955 - Detection - Number of labeled training samples = 3872
2023-04-20 00:38:49,955 - Detection - Number of unlabeled training samples = 3945
2023-04-20 00:38:49,958 - Detection - Number of evaluation samples = 938
2023-04-20 00:38:49,968 - Detection - Number of testing samples = 5082
2023-04-20 00:38:56,975 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-20 00:38:57,059 - Detection - Pre-training Begin...
2023-04-20 00:39:04,994 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 00:39:04,994 - Detection -   best_eval_score = 0
2023-04-20 00:39:04,994 - Detection -   eval_score = 4.57
2023-04-20 00:39:04,994 - Detection -   train_loss = 2.3100728681010585
2023-04-20 00:39:12,447 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 00:39:12,447 - Detection -   best_eval_score = 4.57
2023-04-20 00:39:12,447 - Detection -   eval_score = 4.0
2023-04-20 00:39:12,447 - Detection -   train_loss = 2.295293761837867
2023-04-20 00:39:19,915 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 00:39:19,915 - Detection -   best_eval_score = 4.57
2023-04-20 00:39:19,915 - Detection -   eval_score = 15.31
2023-04-20 00:39:19,915 - Detection -   train_loss = 2.278172577581098
2023-04-20 00:39:27,415 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 00:39:27,415 - Detection -   best_eval_score = 15.31
2023-04-20 00:39:27,415 - Detection -   eval_score = 38.76
2023-04-20 00:39:27,415 - Detection -   train_loss = 2.234651488642539
2023-04-20 00:39:34,938 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 00:39:34,939 - Detection -   best_eval_score = 38.76
2023-04-20 00:39:34,939 - Detection -   eval_score = 56.1
2023-04-20 00:39:34,939 - Detection -   train_loss = 2.0991493425061627
2023-04-20 00:39:42,487 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 00:39:42,487 - Detection -   best_eval_score = 56.1
2023-04-20 00:39:42,487 - Detection -   eval_score = 72.85
2023-04-20 00:39:42,487 - Detection -   train_loss = 1.8105838644889094
2023-04-20 00:39:50,054 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 00:39:50,054 - Detection -   best_eval_score = 72.85
2023-04-20 00:39:50,054 - Detection -   eval_score = 82.6
2023-04-20 00:39:50,054 - Detection -   train_loss = 1.3709653077587005
2023-04-20 00:39:57,633 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 00:39:57,633 - Detection -   best_eval_score = 82.6
2023-04-20 00:39:57,633 - Detection -   eval_score = 84.43
2023-04-20 00:39:57,633 - Detection -   train_loss = 1.0740824264864768
2023-04-20 00:40:05,217 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 00:40:05,218 - Detection -   best_eval_score = 84.43
2023-04-20 00:40:05,218 - Detection -   eval_score = 85.83
2023-04-20 00:40:05,218 - Detection -   train_loss = 0.9350744697355455
2023-04-20 00:40:12,803 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 00:40:12,803 - Detection -   best_eval_score = 85.83
2023-04-20 00:40:12,803 - Detection -   eval_score = 85.93
2023-04-20 00:40:12,803 - Detection -   train_loss = 0.8553239953133368
2023-04-20 00:40:20,370 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 00:40:20,370 - Detection -   best_eval_score = 85.93
2023-04-20 00:40:20,370 - Detection -   eval_score = 87.59
2023-04-20 00:40:20,370 - Detection -   train_loss = 0.7896631013962531
2023-04-20 00:40:27,930 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 00:40:27,930 - Detection -   best_eval_score = 87.59
2023-04-20 00:40:27,930 - Detection -   eval_score = 87.74
2023-04-20 00:40:27,930 - Detection -   train_loss = 0.7556751274293468
2023-04-20 00:40:35,593 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 00:40:35,593 - Detection -   best_eval_score = 87.74
2023-04-20 00:40:35,593 - Detection -   eval_score = 88.15
2023-04-20 00:40:35,593 - Detection -   train_loss = 0.7270065988263776
2023-04-20 00:40:43,150 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 00:40:43,150 - Detection -   best_eval_score = 88.15
2023-04-20 00:40:43,150 - Detection -   eval_score = 88.23
2023-04-20 00:40:43,150 - Detection -   train_loss = 0.6907785477176789
2023-04-20 00:40:50,703 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 00:40:50,703 - Detection -   best_eval_score = 88.23
2023-04-20 00:40:50,703 - Detection -   eval_score = 88.76
2023-04-20 00:40:50,703 - Detection -   train_loss = 0.6593904764421524
2023-04-20 00:40:58,253 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 00:40:58,253 - Detection -   best_eval_score = 88.76
2023-04-20 00:40:58,253 - Detection -   eval_score = 88.4
2023-04-20 00:40:58,253 - Detection -   train_loss = 0.6436833085552338
2023-04-20 00:41:05,795 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 00:41:05,795 - Detection -   best_eval_score = 88.76
2023-04-20 00:41:05,795 - Detection -   eval_score = 88.97
2023-04-20 00:41:05,795 - Detection -   train_loss = 0.620820366567181
2023-04-20 00:41:13,343 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 00:41:13,343 - Detection -   best_eval_score = 88.97
2023-04-20 00:41:13,343 - Detection -   eval_score = 88.75
2023-04-20 00:41:13,343 - Detection -   train_loss = 0.600709613292448
2023-04-20 00:41:20,878 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 00:41:20,878 - Detection -   best_eval_score = 88.97
2023-04-20 00:41:20,878 - Detection -   eval_score = 88.3
2023-04-20 00:41:20,878 - Detection -   train_loss = 0.5884178357739602
2023-04-20 00:41:28,416 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 00:41:28,416 - Detection -   best_eval_score = 88.97
2023-04-20 00:41:28,416 - Detection -   eval_score = 89.26
2023-04-20 00:41:28,416 - Detection -   train_loss = 0.5677123223581622
2023-04-20 00:41:35,958 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 00:41:35,958 - Detection -   best_eval_score = 89.26
2023-04-20 00:41:35,958 - Detection -   eval_score = 89.18
2023-04-20 00:41:35,958 - Detection -   train_loss = 0.5509758678174788
2023-04-20 00:41:43,489 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 00:41:43,489 - Detection -   best_eval_score = 89.26
2023-04-20 00:41:43,489 - Detection -   eval_score = 89.16
2023-04-20 00:41:43,489 - Detection -   train_loss = 0.5337772532816856
2023-04-20 00:41:51,020 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 00:41:51,020 - Detection -   best_eval_score = 89.26
2023-04-20 00:41:51,020 - Detection -   eval_score = 89.11
2023-04-20 00:41:51,020 - Detection -   train_loss = 0.5280484057241871
2023-04-20 00:41:58,544 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 00:41:58,544 - Detection -   best_eval_score = 89.26
2023-04-20 00:41:58,544 - Detection -   eval_score = 89.06
2023-04-20 00:41:58,544 - Detection -   train_loss = 0.5143046811703713
2023-04-20 00:42:06,074 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 00:42:06,074 - Detection -   best_eval_score = 89.26
2023-04-20 00:42:06,074 - Detection -   eval_score = 89.07
2023-04-20 00:42:06,075 - Detection -   train_loss = 0.5012257003015087
2023-04-20 00:42:13,604 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 00:42:13,604 - Detection -   best_eval_score = 89.26
2023-04-20 00:42:13,604 - Detection -   eval_score = 89.63
2023-04-20 00:42:13,604 - Detection -   train_loss = 0.49479492825846516
2023-04-20 00:42:21,149 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 00:42:21,149 - Detection -   best_eval_score = 89.63
2023-04-20 00:42:21,149 - Detection -   eval_score = 89.44
2023-04-20 00:42:21,149 - Detection -   train_loss = 0.48075882850154755
2023-04-20 00:42:28,677 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 00:42:28,677 - Detection -   best_eval_score = 89.63
2023-04-20 00:42:28,677 - Detection -   eval_score = 89.42
2023-04-20 00:42:28,677 - Detection -   train_loss = 0.4730720539246836
2023-04-20 00:42:36,204 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 00:42:36,204 - Detection -   best_eval_score = 89.63
2023-04-20 00:42:36,204 - Detection -   eval_score = 89.19
2023-04-20 00:42:36,204 - Detection -   train_loss = 0.4619357999294035
2023-04-20 00:42:43,737 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 00:42:43,737 - Detection -   best_eval_score = 89.63
2023-04-20 00:42:43,737 - Detection -   eval_score = 89.19
2023-04-20 00:42:43,737 - Detection -   train_loss = 0.4624174814070425
2023-04-20 00:42:51,263 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 00:42:51,263 - Detection -   best_eval_score = 89.63
2023-04-20 00:42:51,263 - Detection -   eval_score = 88.99
2023-04-20 00:42:51,263 - Detection -   train_loss = 0.4487846637925794
2023-04-20 00:42:58,788 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 00:42:58,788 - Detection -   best_eval_score = 89.63
2023-04-20 00:42:58,788 - Detection -   eval_score = 88.88
2023-04-20 00:42:58,788 - Detection -   train_loss = 0.43967477640798014
2023-04-20 00:43:06,421 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 00:43:06,421 - Detection -   best_eval_score = 89.63
2023-04-20 00:43:06,421 - Detection -   eval_score = 89.03
2023-04-20 00:43:06,421 - Detection -   train_loss = 0.4328014139206179
2023-04-20 00:43:13,945 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 00:43:13,945 - Detection -   best_eval_score = 89.63
2023-04-20 00:43:13,945 - Detection -   eval_score = 89.16
2023-04-20 00:43:13,945 - Detection -   train_loss = 0.4262101006123327
2023-04-20 00:43:21,471 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 00:43:21,471 - Detection -   best_eval_score = 89.63
2023-04-20 00:43:21,471 - Detection -   eval_score = 89.42
2023-04-20 00:43:21,471 - Detection -   train_loss = 0.41475196903751743
2023-04-20 00:43:29,002 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 00:43:29,003 - Detection -   best_eval_score = 89.63
2023-04-20 00:43:29,003 - Detection -   eval_score = 89.16
2023-04-20 00:43:29,003 - Detection -   train_loss = 0.41118903890732794
2023-04-20 00:43:29,003 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.5_1.0_bert_disaware_3/models
2023-04-20 00:43:29,548 - Detection - Pre-training finished...
2023-04-20 00:43:29,549 - Detection - Training Begin...
2023-04-20 00:43:33,889 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 00:43:33,890 - Detection -   best_eval_score = 0
2023-04-20 00:43:33,890 - Detection -   eval_score = 8.58
2023-04-20 00:43:33,890 - Detection -   train_loss = 4.3864376698770835
2023-04-20 00:43:38,231 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 00:43:38,231 - Detection -   best_eval_score = 8.58
2023-04-20 00:43:38,231 - Detection -   eval_score = 47.15
2023-04-20 00:43:38,231 - Detection -   train_loss = 3.1039592104573406
2023-04-20 00:43:42,573 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 00:43:42,573 - Detection -   best_eval_score = 47.15
2023-04-20 00:43:42,574 - Detection -   eval_score = 79.04
2023-04-20 00:43:42,574 - Detection -   train_loss = 1.6965193171654978
2023-04-20 00:43:46,916 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 00:43:46,916 - Detection -   best_eval_score = 79.04
2023-04-20 00:43:46,916 - Detection -   eval_score = 79.49
2023-04-20 00:43:46,916 - Detection -   train_loss = 1.223682697742216
2023-04-20 00:43:51,258 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 00:43:51,258 - Detection -   best_eval_score = 79.49
2023-04-20 00:43:51,258 - Detection -   eval_score = 79.36
2023-04-20 00:43:51,258 - Detection -   train_loss = 1.2019794294911046
2023-04-20 00:43:55,601 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 00:43:55,601 - Detection -   best_eval_score = 79.49
2023-04-20 00:43:55,601 - Detection -   eval_score = 79.43
2023-04-20 00:43:55,601 - Detection -   train_loss = 1.229829930490063
2023-04-20 00:43:59,943 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 00:43:59,943 - Detection -   best_eval_score = 79.49
2023-04-20 00:43:59,943 - Detection -   eval_score = 79.41
2023-04-20 00:43:59,943 - Detection -   train_loss = 1.2106394133260172
2023-04-20 00:44:04,288 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 00:44:04,288 - Detection -   best_eval_score = 79.49
2023-04-20 00:44:04,288 - Detection -   eval_score = 79.41
2023-04-20 00:44:04,288 - Detection -   train_loss = 1.2235594180322462
2023-04-20 00:44:08,631 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 00:44:08,631 - Detection -   best_eval_score = 79.49
2023-04-20 00:44:08,631 - Detection -   eval_score = 79.41
2023-04-20 00:44:08,631 - Detection -   train_loss = 1.234623662887081
2023-04-20 00:44:12,973 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 00:44:12,974 - Detection -   best_eval_score = 79.49
2023-04-20 00:44:12,974 - Detection -   eval_score = 79.41
2023-04-20 00:44:12,974 - Detection -   train_loss = 1.1953293488871666
2023-04-20 00:44:17,316 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 00:44:17,316 - Detection -   best_eval_score = 79.49
2023-04-20 00:44:17,316 - Detection -   eval_score = 79.43
2023-04-20 00:44:17,316 - Detection -   train_loss = 1.2124458051496936
2023-04-20 00:44:21,659 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 00:44:21,659 - Detection -   best_eval_score = 79.49
2023-04-20 00:44:21,659 - Detection -   eval_score = 79.47
2023-04-20 00:44:21,659 - Detection -   train_loss = 1.2134047227521096
2023-04-20 00:44:26,001 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 00:44:26,001 - Detection -   best_eval_score = 79.49
2023-04-20 00:44:26,001 - Detection -   eval_score = 79.43
2023-04-20 00:44:26,001 - Detection -   train_loss = 1.226392363348315
2023-04-20 00:44:30,345 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 00:44:30,345 - Detection -   best_eval_score = 79.49
2023-04-20 00:44:30,345 - Detection -   eval_score = 79.35
2023-04-20 00:44:30,345 - Detection -   train_loss = 1.2002530636325959
2023-04-20 00:44:30,346 - Detection - Training Finished...
2023-04-20 00:44:30,346 - Detection - Testing begin...
2023-04-20 00:44:34,569 - Detection - ***** Test: Confusion Matrix *****
2023-04-20 00:44:34,569 - Detection - [[ 199    0    0    0    0    0    0    0    0    1   61]
 [   0  182    0    0    0    0    0    0    0    5   69]
 [   0    0  171    1    0    0    0    1    0    0   72]
 [   0    0    0  221    0    0    0    0    0    2   50]
 [   0    0    2    0  197    0    0    0    1    0   37]
 [   0    0    0    0    0  177    0    2    0    1   66]
 [   0    0    0    0    0    0  208    0    0    1   60]
 [   0    0    0    0    0    1    0  212    0    0   45]
 [   0    0    0    0    0    0    0    0  205    0   57]
 [   0    0    2    1    0    0    0    0    0  219   61]
 [   2    6   29    2    0    0   14    2    4  208 2225]]
2023-04-20 00:44:34,569 - Detection - ***** Test results *****
2023-04-20 00:44:34,569 - Detection -   Acc = 82.96
2023-04-20 00:44:34,569 - Detection -   F1 = 83.005
2023-04-20 00:44:34,569 - Detection -   F1-known = 82.9013
2023-04-20 00:44:34,569 - Detection -   F1-open = 84.0415
2023-04-20 00:44:34,569 - Detection - Testing finished...
2023-04-20 00:44:34,569 - Detection - Results saved in results/results_DA-ADB.csv
2023-04-20 00:44:34,589 - Detection - Open Intent Detection Finished...
