2023-04-04 22:10:14,963 - Detection - Open Intent Detection Begin...
2023-04-04 22:10:14,963 - Detection - Parameters Initialization...
2023-04-04 22:10:14,964 - Detection - ============================== Params ==============================
2023-04-04 22:10:14,964 - Detection - type:	open_intent_detection
2023-04-04 22:10:14,964 - Detection - logger_name:	Detection
2023-04-04 22:10:14,964 - Detection - log_dir:	logs
2023-04-04 22:10:14,964 - Detection - dataset:	banking
2023-04-04 22:10:14,964 - Detection - known_cls_ratio:	0.25
2023-04-04 22:10:14,964 - Detection - labeled_ratio:	1.0
2023-04-04 22:10:14,964 - Detection - method:	DA-ADB
2023-04-04 22:10:14,964 - Detection - train:	True
2023-04-04 22:10:14,964 - Detection - pretrain:	True
2023-04-04 22:10:14,964 - Detection - save_model:	True
2023-04-04 22:10:14,964 - Detection - backbone:	bert_disaware
2023-04-04 22:10:14,964 - Detection - config_file_name:	DA-ADB
2023-04-04 22:10:14,964 - Detection - seed:	3
2023-04-04 22:10:14,964 - Detection - gpu_id:	0
2023-04-04 22:10:14,964 - Detection - pipe_results_path:	pipe_results
2023-04-04 22:10:14,964 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-04 22:10:14,964 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-04 22:10:14,964 - Detection - model_dir:	models
2023-04-04 22:10:14,964 - Detection - load_pretrained_method:	None
2023-04-04 22:10:14,964 - Detection - result_dir:	results
2023-04-04 22:10:14,964 - Detection - results_file_name:	results_DA-ADB.csv
2023-04-04 22:10:14,964 - Detection - save_results:	True
2023-04-04 22:10:14,964 - Detection - loss_fct:	CrossEntropyLoss
2023-04-04 22:10:14,964 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_0.25_1.0_bert_disaware_3
2023-04-04 22:10:14,964 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_0.25_1.0_bert_disaware_3/models
2023-04-04 22:10:14,964 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-04 22:10:14,964 - Detection - num_train_epochs:	100
2023-04-04 22:10:14,964 - Detection - num_labels:	None
2023-04-04 22:10:14,964 - Detection - max_seq_length:	None
2023-04-04 22:10:14,964 - Detection - freeze_backbone_parameters:	True
2023-04-04 22:10:14,964 - Detection - feat_dim:	768
2023-04-04 22:10:14,964 - Detection - warmup_proportion:	0.1
2023-04-04 22:10:14,964 - Detection - scale:	4
2023-04-04 22:10:14,964 - Detection - lr_boundary:	0.05
2023-04-04 22:10:14,964 - Detection - lr:	2e-05
2023-04-04 22:10:14,964 - Detection - activation:	relu
2023-04-04 22:10:14,964 - Detection - train_batch_size:	128
2023-04-04 22:10:14,964 - Detection - eval_batch_size:	64
2023-04-04 22:10:14,964 - Detection - test_batch_size:	64
2023-04-04 22:10:14,964 - Detection - wait_patient:	10
2023-04-04 22:10:14,964 - Detection - ============================== End Params ==============================
2023-04-04 22:10:14,964 - Detection - Data and Model Preparation...
2023-04-04 22:10:14,965 - Detection - The number of known intents is 19
2023-04-04 22:10:14,965 - Detection - Lists of known labels are: ['edit_personal_details', 'exchange_charge', 'compromised_card', 'top_up_limits', 'beneficiary_not_allowed', 'balance_not_updated_after_bank_transfer', 'request_refund', 'cancel_transfer', 'card_arrival', 'declined_cash_withdrawal', 'verify_source_of_funds', 'supported_cards_and_currencies', 'card_delivery_estimate', 'country_support', 'passcode_forgotten', 'verify_my_identity', 'card_payment_fee_charged', 'wrong_amount_of_cash_received', 'atm_support']
2023-04-04 22:10:14,990 - Detection - Number of labeled training samples = 2295
2023-04-04 22:10:14,990 - Detection - Number of unlabeled training samples = 6708
2023-04-04 22:10:14,992 - Detection - Number of evaluation samples = 255
2023-04-04 22:10:14,999 - Detection - Number of testing samples = 3080
2023-04-04 22:10:23,528 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-04 22:10:23,609 - Detection - Pre-training Begin...
2023-04-04 22:10:29,304 - Detection - ***** Epoch: 1: Eval results *****
2023-04-04 22:10:29,304 - Detection -   best_eval_score = 0
2023-04-04 22:10:29,304 - Detection -   eval_score = 1.6
2023-04-04 22:10:29,304 - Detection -   train_loss = 2.9429089228312173
2023-04-04 22:10:34,411 - Detection - ***** Epoch: 2: Eval results *****
2023-04-04 22:10:34,411 - Detection -   best_eval_score = 1.6
2023-04-04 22:10:34,411 - Detection -   eval_score = 3.04
2023-04-04 22:10:34,411 - Detection -   train_loss = 2.921851250860426
2023-04-04 22:10:39,523 - Detection - ***** Epoch: 3: Eval results *****
2023-04-04 22:10:39,523 - Detection -   best_eval_score = 3.04
2023-04-04 22:10:39,523 - Detection -   eval_score = 3.46
2023-04-04 22:10:39,523 - Detection -   train_loss = 2.901240110397339
2023-04-04 22:10:44,654 - Detection - ***** Epoch: 4: Eval results *****
2023-04-04 22:10:44,654 - Detection -   best_eval_score = 3.46
2023-04-04 22:10:44,654 - Detection -   eval_score = 6.51
2023-04-04 22:10:44,654 - Detection -   train_loss = 2.87870458761851
2023-04-04 22:10:49,779 - Detection - ***** Epoch: 5: Eval results *****
2023-04-04 22:10:49,779 - Detection -   best_eval_score = 6.51
2023-04-04 22:10:49,779 - Detection -   eval_score = 16.14
2023-04-04 22:10:49,779 - Detection -   train_loss = 2.8398480547799005
2023-04-04 22:10:54,910 - Detection - ***** Epoch: 6: Eval results *****
2023-04-04 22:10:54,911 - Detection -   best_eval_score = 16.14
2023-04-04 22:10:54,911 - Detection -   eval_score = 31.14
2023-04-04 22:10:54,911 - Detection -   train_loss = 2.756508946418762
2023-04-04 22:11:00,052 - Detection - ***** Epoch: 7: Eval results *****
2023-04-04 22:11:00,052 - Detection -   best_eval_score = 31.14
2023-04-04 22:11:00,052 - Detection -   eval_score = 55.25
2023-04-04 22:11:00,052 - Detection -   train_loss = 2.5671938127941556
2023-04-04 22:11:05,204 - Detection - ***** Epoch: 8: Eval results *****
2023-04-04 22:11:05,204 - Detection -   best_eval_score = 55.25
2023-04-04 22:11:05,204 - Detection -   eval_score = 75.01
2023-04-04 22:11:05,204 - Detection -   train_loss = 2.2476369274987116
2023-04-04 22:11:10,364 - Detection - ***** Epoch: 9: Eval results *****
2023-04-04 22:11:10,364 - Detection -   best_eval_score = 75.01
2023-04-04 22:11:10,364 - Detection -   eval_score = 82.48
2023-04-04 22:11:10,364 - Detection -   train_loss = 1.8705870178010728
2023-04-04 22:11:15,529 - Detection - ***** Epoch: 10: Eval results *****
2023-04-04 22:11:15,529 - Detection -   best_eval_score = 82.48
2023-04-04 22:11:15,529 - Detection -   eval_score = 87.86
2023-04-04 22:11:15,529 - Detection -   train_loss = 1.5865367253621419
2023-04-04 22:11:20,700 - Detection - ***** Epoch: 11: Eval results *****
2023-04-04 22:11:20,701 - Detection -   best_eval_score = 87.86
2023-04-04 22:11:20,701 - Detection -   eval_score = 91.88
2023-04-04 22:11:20,701 - Detection -   train_loss = 1.3778956002659268
2023-04-04 22:11:25,876 - Detection - ***** Epoch: 12: Eval results *****
2023-04-04 22:11:25,876 - Detection -   best_eval_score = 91.88
2023-04-04 22:11:25,876 - Detection -   eval_score = 94.04
2023-04-04 22:11:25,876 - Detection -   train_loss = 1.2392119434144762
2023-04-04 22:11:31,057 - Detection - ***** Epoch: 13: Eval results *****
2023-04-04 22:11:31,057 - Detection -   best_eval_score = 94.04
2023-04-04 22:11:31,057 - Detection -   eval_score = 94.6
2023-04-04 22:11:31,057 - Detection -   train_loss = 1.1343312793307834
2023-04-04 22:11:36,237 - Detection - ***** Epoch: 14: Eval results *****
2023-04-04 22:11:36,237 - Detection -   best_eval_score = 94.6
2023-04-04 22:11:36,237 - Detection -   eval_score = 96.36
2023-04-04 22:11:36,237 - Detection -   train_loss = 1.0625926653544109
2023-04-04 22:11:41,425 - Detection - ***** Epoch: 15: Eval results *****
2023-04-04 22:11:41,426 - Detection -   best_eval_score = 96.36
2023-04-04 22:11:41,426 - Detection -   eval_score = 96.36
2023-04-04 22:11:41,426 - Detection -   train_loss = 1.0029762155479856
2023-04-04 22:11:46,599 - Detection - ***** Epoch: 16: Eval results *****
2023-04-04 22:11:46,599 - Detection -   best_eval_score = 96.36
2023-04-04 22:11:46,599 - Detection -   eval_score = 96.67
2023-04-04 22:11:46,599 - Detection -   train_loss = 0.9566832482814789
2023-04-04 22:11:51,787 - Detection - ***** Epoch: 17: Eval results *****
2023-04-04 22:11:51,787 - Detection -   best_eval_score = 96.67
2023-04-04 22:11:51,787 - Detection -   eval_score = 96.67
2023-04-04 22:11:51,787 - Detection -   train_loss = 0.9180690348148346
2023-04-04 22:11:56,960 - Detection - ***** Epoch: 18: Eval results *****
2023-04-04 22:11:56,961 - Detection -   best_eval_score = 96.67
2023-04-04 22:11:56,961 - Detection -   eval_score = 97.09
2023-04-04 22:11:56,961 - Detection -   train_loss = 0.8843291964795854
2023-04-04 22:12:02,250 - Detection - ***** Epoch: 19: Eval results *****
2023-04-04 22:12:02,250 - Detection -   best_eval_score = 97.09
2023-04-04 22:12:02,250 - Detection -   eval_score = 97.09
2023-04-04 22:12:02,250 - Detection -   train_loss = 0.8501571781105466
2023-04-04 22:12:07,426 - Detection - ***** Epoch: 20: Eval results *****
2023-04-04 22:12:07,426 - Detection -   best_eval_score = 97.09
2023-04-04 22:12:07,426 - Detection -   eval_score = 97.52
2023-04-04 22:12:07,426 - Detection -   train_loss = 0.8285749389065636
2023-04-04 22:12:12,612 - Detection - ***** Epoch: 21: Eval results *****
2023-04-04 22:12:12,612 - Detection -   best_eval_score = 97.52
2023-04-04 22:12:12,612 - Detection -   eval_score = 97.52
2023-04-04 22:12:12,612 - Detection -   train_loss = 0.8052124314837985
2023-04-04 22:12:17,784 - Detection - ***** Epoch: 22: Eval results *****
2023-04-04 22:12:17,784 - Detection -   best_eval_score = 97.52
2023-04-04 22:12:17,784 - Detection -   eval_score = 97.99
2023-04-04 22:12:17,784 - Detection -   train_loss = 0.7828370398945279
2023-04-04 22:12:22,966 - Detection - ***** Epoch: 23: Eval results *****
2023-04-04 22:12:22,966 - Detection -   best_eval_score = 97.99
2023-04-04 22:12:22,966 - Detection -   eval_score = 97.99
2023-04-04 22:12:22,966 - Detection -   train_loss = 0.7646102242999606
2023-04-04 22:12:28,140 - Detection - ***** Epoch: 24: Eval results *****
2023-04-04 22:12:28,140 - Detection -   best_eval_score = 97.99
2023-04-04 22:12:28,141 - Detection -   eval_score = 97.56
2023-04-04 22:12:28,141 - Detection -   train_loss = 0.7509069475862715
2023-04-04 22:12:33,316 - Detection - ***** Epoch: 25: Eval results *****
2023-04-04 22:12:33,316 - Detection -   best_eval_score = 97.99
2023-04-04 22:12:33,316 - Detection -   eval_score = 97.52
2023-04-04 22:12:33,316 - Detection -   train_loss = 0.7328143782085843
2023-04-04 22:12:38,488 - Detection - ***** Epoch: 26: Eval results *****
2023-04-04 22:12:38,488 - Detection -   best_eval_score = 97.99
2023-04-04 22:12:38,488 - Detection -   eval_score = 97.52
2023-04-04 22:12:38,488 - Detection -   train_loss = 0.7208959526485867
2023-04-04 22:12:43,656 - Detection - ***** Epoch: 27: Eval results *****
2023-04-04 22:12:43,656 - Detection -   best_eval_score = 97.99
2023-04-04 22:12:43,656 - Detection -   eval_score = 97.99
2023-04-04 22:12:43,656 - Detection -   train_loss = 0.7055162919892205
2023-04-04 22:12:48,823 - Detection - ***** Epoch: 28: Eval results *****
2023-04-04 22:12:48,824 - Detection -   best_eval_score = 97.99
2023-04-04 22:12:48,824 - Detection -   eval_score = 97.99
2023-04-04 22:12:48,824 - Detection -   train_loss = 0.6927865412500169
2023-04-04 22:12:53,992 - Detection - ***** Epoch: 29: Eval results *****
2023-04-04 22:12:53,992 - Detection -   best_eval_score = 97.99
2023-04-04 22:12:53,992 - Detection -   eval_score = 97.52
2023-04-04 22:12:53,992 - Detection -   train_loss = 0.6819868485132853
2023-04-04 22:12:59,160 - Detection - ***** Epoch: 30: Eval results *****
2023-04-04 22:12:59,160 - Detection -   best_eval_score = 97.99
2023-04-04 22:12:59,161 - Detection -   eval_score = 97.99
2023-04-04 22:12:59,161 - Detection -   train_loss = 0.6698127488295237
2023-04-04 22:13:04,326 - Detection - ***** Epoch: 31: Eval results *****
2023-04-04 22:13:04,326 - Detection -   best_eval_score = 97.99
2023-04-04 22:13:04,326 - Detection -   eval_score = 97.99
2023-04-04 22:13:04,326 - Detection -   train_loss = 0.6620326439539591
2023-04-04 22:13:09,495 - Detection - ***** Epoch: 32: Eval results *****
2023-04-04 22:13:09,495 - Detection -   best_eval_score = 97.99
2023-04-04 22:13:09,495 - Detection -   eval_score = 97.99
2023-04-04 22:13:09,495 - Detection -   train_loss = 0.6570396025975546
2023-04-04 22:13:09,495 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_0.25_1.0_bert_disaware_3/models
2023-04-04 22:13:10,044 - Detection - Pre-training finished...
2023-04-04 22:13:10,045 - Detection - Training Begin...
2023-04-04 22:13:12,902 - Detection - ***** Epoch: 1: Eval results *****
2023-04-04 22:13:12,903 - Detection -   best_eval_score = 0
2023-04-04 22:13:12,903 - Detection -   eval_score = 8.42
2023-04-04 22:13:12,903 - Detection -   train_loss = 3.2242853111690946
2023-04-04 22:13:15,757 - Detection - ***** Epoch: 2: Eval results *****
2023-04-04 22:13:15,757 - Detection -   best_eval_score = 8.42
2023-04-04 22:13:15,757 - Detection -   eval_score = 25.42
2023-04-04 22:13:15,757 - Detection -   train_loss = 2.6426715188556247
2023-04-04 22:13:18,612 - Detection - ***** Epoch: 3: Eval results *****
2023-04-04 22:13:18,612 - Detection -   best_eval_score = 25.42
2023-04-04 22:13:18,612 - Detection -   eval_score = 53.62
2023-04-04 22:13:18,612 - Detection -   train_loss = 1.922125882572598
2023-04-04 22:13:21,466 - Detection - ***** Epoch: 4: Eval results *****
2023-04-04 22:13:21,466 - Detection -   best_eval_score = 53.62
2023-04-04 22:13:21,466 - Detection -   eval_score = 84.32
2023-04-04 22:13:21,466 - Detection -   train_loss = 1.1659816172387865
2023-04-04 22:13:24,320 - Detection - ***** Epoch: 5: Eval results *****
2023-04-04 22:13:24,320 - Detection -   best_eval_score = 84.32
2023-04-04 22:13:24,320 - Detection -   eval_score = 88.9
2023-04-04 22:13:24,320 - Detection -   train_loss = 0.6739607685142093
2023-04-04 22:13:27,174 - Detection - ***** Epoch: 6: Eval results *****
2023-04-04 22:13:27,174 - Detection -   best_eval_score = 88.9
2023-04-04 22:13:27,174 - Detection -   eval_score = 88.81
2023-04-04 22:13:27,174 - Detection -   train_loss = 0.5873345567120446
2023-04-04 22:13:30,029 - Detection - ***** Epoch: 7: Eval results *****
2023-04-04 22:13:30,029 - Detection -   best_eval_score = 88.9
2023-04-04 22:13:30,029 - Detection -   eval_score = 88.6
2023-04-04 22:13:30,029 - Detection -   train_loss = 0.5799220088455412
2023-04-04 22:13:32,883 - Detection - ***** Epoch: 8: Eval results *****
2023-04-04 22:13:32,883 - Detection -   best_eval_score = 88.9
2023-04-04 22:13:32,883 - Detection -   eval_score = 88.63
2023-04-04 22:13:32,883 - Detection -   train_loss = 0.5791965689924028
2023-04-04 22:13:35,737 - Detection - ***** Epoch: 9: Eval results *****
2023-04-04 22:13:35,737 - Detection -   best_eval_score = 88.9
2023-04-04 22:13:35,737 - Detection -   eval_score = 88.87
2023-04-04 22:13:35,737 - Detection -   train_loss = 0.5952064659860399
2023-04-04 22:13:38,590 - Detection - ***** Epoch: 10: Eval results *****
2023-04-04 22:13:38,591 - Detection -   best_eval_score = 88.9
2023-04-04 22:13:38,591 - Detection -   eval_score = 88.66
2023-04-04 22:13:38,591 - Detection -   train_loss = 0.5876033902168274
2023-04-04 22:13:41,445 - Detection - ***** Epoch: 11: Eval results *****
2023-04-04 22:13:41,445 - Detection -   best_eval_score = 88.9
2023-04-04 22:13:41,445 - Detection -   eval_score = 88.68
2023-04-04 22:13:41,445 - Detection -   train_loss = 0.5948675009939406
2023-04-04 22:13:44,299 - Detection - ***** Epoch: 12: Eval results *****
2023-04-04 22:13:44,299 - Detection -   best_eval_score = 88.9
2023-04-04 22:13:44,299 - Detection -   eval_score = 88.45
2023-04-04 22:13:44,299 - Detection -   train_loss = 0.5869712697135078
2023-04-04 22:13:47,154 - Detection - ***** Epoch: 13: Eval results *****
2023-04-04 22:13:47,154 - Detection -   best_eval_score = 88.9
2023-04-04 22:13:47,154 - Detection -   eval_score = 88.86
2023-04-04 22:13:47,154 - Detection -   train_loss = 0.5770249201191796
2023-04-04 22:13:50,007 - Detection - ***** Epoch: 14: Eval results *****
2023-04-04 22:13:50,007 - Detection -   best_eval_score = 88.9
2023-04-04 22:13:50,007 - Detection -   eval_score = 88.45
2023-04-04 22:13:50,007 - Detection -   train_loss = 0.5890301797125075
2023-04-04 22:13:52,861 - Detection - ***** Epoch: 15: Eval results *****
2023-04-04 22:13:52,861 - Detection -   best_eval_score = 88.9
2023-04-04 22:13:52,861 - Detection -   eval_score = 88.45
2023-04-04 22:13:52,861 - Detection -   train_loss = 0.5805635816521115
2023-04-04 22:13:52,862 - Detection - Training Finished...
2023-04-04 22:13:52,862 - Detection - Testing begin...
2023-04-04 22:13:55,947 - Detection - ***** Test: Confusion Matrix *****
2023-04-04 22:13:55,947 - Detection - [[  38    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    2]
 [   0   39    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    1]
 [   0    0   24    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0   16]
 [   0    0    0   36    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    4]
 [   0    0    0    0   31    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    9]
 [   0    0    0    0    0   33    0    0    0    0    0    0    0    0
     0    0    0    0    0    7]
 [   0    0    0    0    0    0   33    0    0    0    0    0    0    0
     0    0    0    0    0    7]
 [   0    0    0    0    0    0    0   35    0    0    0    0    0    0
     0    0    0    0    0    5]
 [   0    0    0    0    0    0    0    0   29    0    0    0    5    0
     0    0    0    0    0    6]
 [   0    0    0    0    0    0    0    0    0   34    0    0    0    0
     0    0    0    0    0    6]
 [   0    0    0    0    0    0    0    0    0    0   40    0    0    0
     0    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0   32    0    0
     0    0    0    0    0    8]
 [   0    0    0    0    0    0    0    0    2    0    0    0   34    0
     0    0    0    0    0    4]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0   34
     0    0    0    0    0    6]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
    39    0    0    0    0    1]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0   38    0    0    0    2]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0   36    0    0    4]
 [   0    0    0    0    0    0    0    0    0    1    0    0    0    0
     0    0    0   30    0    9]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0   33    7]
 [   0   53   14   33   23   43   37    2   14   21    0   29    4    3
     0   64   90    1    0 1889]]
2023-04-04 22:13:55,947 - Detection - ***** Test results *****
2023-04-04 22:13:55,947 - Detection -   Acc = 82.37
2023-04-04 22:13:55,947 - Detection -   F1 = 74.435
2023-04-04 22:13:55,947 - Detection -   F1-known = 73.7423
2023-04-04 22:13:55,948 - Detection -   F1-open = 87.5956
2023-04-04 22:13:55,948 - Detection - Testing finished...
2023-04-04 22:13:55,948 - Detection - Results saved in results/results_DA-ADB.csv
2023-04-04 22:13:55,964 - Detection - Open Intent Detection Finished...
