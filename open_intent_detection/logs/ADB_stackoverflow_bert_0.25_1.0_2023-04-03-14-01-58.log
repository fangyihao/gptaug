2023-04-03 14:01:58,765 - Detection - Open Intent Detection Begin...
2023-04-03 14:01:58,765 - Detection - Parameters Initialization...
2023-04-03 14:01:58,765 - Detection - ============================== Params ==============================
2023-04-03 14:01:58,765 - Detection - type:	open_intent_detection
2023-04-03 14:01:58,765 - Detection - logger_name:	Detection
2023-04-03 14:01:58,765 - Detection - log_dir:	logs
2023-04-03 14:01:58,765 - Detection - dataset:	stackoverflow
2023-04-03 14:01:58,765 - Detection - known_cls_ratio:	0.25
2023-04-03 14:01:58,765 - Detection - labeled_ratio:	1.0
2023-04-03 14:01:58,765 - Detection - method:	ADB
2023-04-03 14:01:58,765 - Detection - train:	True
2023-04-03 14:01:58,765 - Detection - pretrain:	True
2023-04-03 14:01:58,766 - Detection - save_model:	True
2023-04-03 14:01:58,766 - Detection - backbone:	bert
2023-04-03 14:01:58,766 - Detection - config_file_name:	ADB
2023-04-03 14:01:58,766 - Detection - seed:	0
2023-04-03 14:01:58,766 - Detection - gpu_id:	0
2023-04-03 14:01:58,766 - Detection - pipe_results_path:	pipe_results
2023-04-03 14:01:58,766 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-03 14:01:58,766 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-03 14:01:58,766 - Detection - model_dir:	models
2023-04-03 14:01:58,766 - Detection - load_pretrained_method:	None
2023-04-03 14:01:58,766 - Detection - result_dir:	results
2023-04-03 14:01:58,766 - Detection - results_file_name:	results_ADB.csv
2023-04-03 14:01:58,766 - Detection - save_results:	True
2023-04-03 14:01:58,766 - Detection - loss_fct:	CrossEntropyLoss
2023-04-03 14:01:58,766 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_0.25_1.0_bert_0
2023-04-03 14:01:58,766 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_0.25_1.0_bert_0/models
2023-04-03 14:01:58,766 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-03 14:01:58,766 - Detection - num_train_epochs:	100
2023-04-03 14:01:58,766 - Detection - num_labels:	None
2023-04-03 14:01:58,766 - Detection - max_seq_length:	None
2023-04-03 14:01:58,766 - Detection - freeze_backbone_parameters:	True
2023-04-03 14:01:58,766 - Detection - feat_dim:	768
2023-04-03 14:01:58,766 - Detection - warmup_proportion:	0.1
2023-04-03 14:01:58,766 - Detection - lr_boundary:	0.05
2023-04-03 14:01:58,766 - Detection - lr:	2e-05
2023-04-03 14:01:58,766 - Detection - activation:	relu
2023-04-03 14:01:58,766 - Detection - train_batch_size:	128
2023-04-03 14:01:58,766 - Detection - eval_batch_size:	64
2023-04-03 14:01:58,766 - Detection - test_batch_size:	64
2023-04-03 14:01:58,766 - Detection - wait_patient:	10
2023-04-03 14:01:58,766 - Detection - ============================== End Params ==============================
2023-04-03 14:01:58,766 - Detection - Data and Model Preparation...
2023-04-03 14:01:58,767 - Detection - The number of known intents is 5
2023-04-03 14:01:58,767 - Detection - Lists of known labels are: ['visual-studio', 'apache', 'wordpress', 'linq', 'matlab']
2023-04-03 14:01:58,799 - Detection - Number of labeled training samples = 3000
2023-04-03 14:01:58,799 - Detection - Number of unlabeled training samples = 9000
2023-04-03 14:01:58,803 - Detection - Number of evaluation samples = 500
2023-04-03 14:01:58,814 - Detection - Number of testing samples = 6000
2023-04-03 14:02:06,270 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-03 14:02:07,923 - Detection - Pre-training Begin...
2023-04-03 14:02:11,577 - Detection - ***** Epoch: 1: Eval results *****
2023-04-03 14:02:11,578 - Detection -   best_eval_score = 0
2023-04-03 14:02:11,578 - Detection -   eval_score = 27.6
2023-04-03 14:02:11,578 - Detection -   train_loss = 1.6112000743548076
2023-04-03 14:02:14,735 - Detection - ***** Epoch: 2: Eval results *****
2023-04-03 14:02:14,735 - Detection -   best_eval_score = 27.6
2023-04-03 14:02:14,735 - Detection -   eval_score = 65.2
2023-04-03 14:02:14,735 - Detection -   train_loss = 1.55917323132356
2023-04-03 14:02:17,902 - Detection - ***** Epoch: 3: Eval results *****
2023-04-03 14:02:17,902 - Detection -   best_eval_score = 65.2
2023-04-03 14:02:17,902 - Detection -   eval_score = 75.4
2023-04-03 14:02:17,902 - Detection -   train_loss = 1.423315942287445
2023-04-03 14:02:21,073 - Detection - ***** Epoch: 4: Eval results *****
2023-04-03 14:02:21,073 - Detection -   best_eval_score = 75.4
2023-04-03 14:02:21,073 - Detection -   eval_score = 86.6
2023-04-03 14:02:21,073 - Detection -   train_loss = 1.054066424568494
2023-04-03 14:02:24,247 - Detection - ***** Epoch: 5: Eval results *****
2023-04-03 14:02:24,247 - Detection -   best_eval_score = 86.6
2023-04-03 14:02:24,247 - Detection -   eval_score = 89.6
2023-04-03 14:02:24,247 - Detection -   train_loss = 0.5295763884981474
2023-04-03 14:02:27,426 - Detection - ***** Epoch: 6: Eval results *****
2023-04-03 14:02:27,426 - Detection -   best_eval_score = 89.6
2023-04-03 14:02:27,426 - Detection -   eval_score = 90.2
2023-04-03 14:02:27,426 - Detection -   train_loss = 0.2870641102393468
2023-04-03 14:02:30,611 - Detection - ***** Epoch: 7: Eval results *****
2023-04-03 14:02:30,611 - Detection -   best_eval_score = 90.2
2023-04-03 14:02:30,611 - Detection -   eval_score = 91.4
2023-04-03 14:02:30,611 - Detection -   train_loss = 0.22083736459414163
2023-04-03 14:02:33,799 - Detection - ***** Epoch: 8: Eval results *****
2023-04-03 14:02:33,800 - Detection -   best_eval_score = 91.4
2023-04-03 14:02:33,800 - Detection -   eval_score = 91.6
2023-04-03 14:02:33,800 - Detection -   train_loss = 0.19349415227770805
2023-04-03 14:02:36,990 - Detection - ***** Epoch: 9: Eval results *****
2023-04-03 14:02:36,990 - Detection -   best_eval_score = 91.6
2023-04-03 14:02:36,990 - Detection -   eval_score = 91.4
2023-04-03 14:02:36,990 - Detection -   train_loss = 0.16920634700606266
2023-04-03 14:02:40,176 - Detection - ***** Epoch: 10: Eval results *****
2023-04-03 14:02:40,176 - Detection -   best_eval_score = 91.6
2023-04-03 14:02:40,176 - Detection -   eval_score = 92.2
2023-04-03 14:02:40,176 - Detection -   train_loss = 0.1535795877377192
2023-04-03 14:02:43,373 - Detection - ***** Epoch: 11: Eval results *****
2023-04-03 14:02:43,373 - Detection -   best_eval_score = 92.2
2023-04-03 14:02:43,373 - Detection -   eval_score = 92.0
2023-04-03 14:02:43,373 - Detection -   train_loss = 0.136996577338626
2023-04-03 14:02:46,565 - Detection - ***** Epoch: 12: Eval results *****
2023-04-03 14:02:46,565 - Detection -   best_eval_score = 92.2
2023-04-03 14:02:46,565 - Detection -   eval_score = 93.4
2023-04-03 14:02:46,565 - Detection -   train_loss = 0.11814640136435628
2023-04-03 14:02:49,768 - Detection - ***** Epoch: 13: Eval results *****
2023-04-03 14:02:49,769 - Detection -   best_eval_score = 93.4
2023-04-03 14:02:49,769 - Detection -   eval_score = 93.2
2023-04-03 14:02:49,769 - Detection -   train_loss = 0.11293266620486975
2023-04-03 14:02:52,965 - Detection - ***** Epoch: 14: Eval results *****
2023-04-03 14:02:52,965 - Detection -   best_eval_score = 93.4
2023-04-03 14:02:52,965 - Detection -   eval_score = 93.0
2023-04-03 14:02:52,965 - Detection -   train_loss = 0.09589279621529083
2023-04-03 14:02:56,263 - Detection - ***** Epoch: 15: Eval results *****
2023-04-03 14:02:56,263 - Detection -   best_eval_score = 93.4
2023-04-03 14:02:56,263 - Detection -   eval_score = 93.8
2023-04-03 14:02:56,263 - Detection -   train_loss = 0.0900539771343271
2023-04-03 14:02:59,474 - Detection - ***** Epoch: 16: Eval results *****
2023-04-03 14:02:59,474 - Detection -   best_eval_score = 93.8
2023-04-03 14:02:59,474 - Detection -   eval_score = 93.4
2023-04-03 14:02:59,474 - Detection -   train_loss = 0.08027219818904996
2023-04-03 14:03:02,678 - Detection - ***** Epoch: 17: Eval results *****
2023-04-03 14:03:02,678 - Detection -   best_eval_score = 93.8
2023-04-03 14:03:02,678 - Detection -   eval_score = 93.6
2023-04-03 14:03:02,678 - Detection -   train_loss = 0.07027656414235632
2023-04-03 14:03:05,888 - Detection - ***** Epoch: 18: Eval results *****
2023-04-03 14:03:05,888 - Detection -   best_eval_score = 93.8
2023-04-03 14:03:05,888 - Detection -   eval_score = 93.4
2023-04-03 14:03:05,888 - Detection -   train_loss = 0.06893981853500009
2023-04-03 14:03:09,104 - Detection - ***** Epoch: 19: Eval results *****
2023-04-03 14:03:09,104 - Detection -   best_eval_score = 93.8
2023-04-03 14:03:09,104 - Detection -   eval_score = 93.2
2023-04-03 14:03:09,104 - Detection -   train_loss = 0.06031312382159134
2023-04-03 14:03:12,315 - Detection - ***** Epoch: 20: Eval results *****
2023-04-03 14:03:12,316 - Detection -   best_eval_score = 93.8
2023-04-03 14:03:12,316 - Detection -   eval_score = 93.2
2023-04-03 14:03:12,316 - Detection -   train_loss = 0.0677486405087014
2023-04-03 14:03:15,529 - Detection - ***** Epoch: 21: Eval results *****
2023-04-03 14:03:15,529 - Detection -   best_eval_score = 93.8
2023-04-03 14:03:15,529 - Detection -   eval_score = 93.2
2023-04-03 14:03:15,529 - Detection -   train_loss = 0.050837567929799356
2023-04-03 14:03:18,741 - Detection - ***** Epoch: 22: Eval results *****
2023-04-03 14:03:18,741 - Detection -   best_eval_score = 93.8
2023-04-03 14:03:18,741 - Detection -   eval_score = 93.6
2023-04-03 14:03:18,741 - Detection -   train_loss = 0.04911049106158316
2023-04-03 14:03:21,952 - Detection - ***** Epoch: 23: Eval results *****
2023-04-03 14:03:21,953 - Detection -   best_eval_score = 93.8
2023-04-03 14:03:21,953 - Detection -   eval_score = 93.6
2023-04-03 14:03:21,953 - Detection -   train_loss = 0.04332097969017923
2023-04-03 14:03:25,162 - Detection - ***** Epoch: 24: Eval results *****
2023-04-03 14:03:25,162 - Detection -   best_eval_score = 93.8
2023-04-03 14:03:25,162 - Detection -   eval_score = 93.6
2023-04-03 14:03:25,162 - Detection -   train_loss = 0.04334862631124755
2023-04-03 14:03:28,374 - Detection - ***** Epoch: 25: Eval results *****
2023-04-03 14:03:28,374 - Detection -   best_eval_score = 93.8
2023-04-03 14:03:28,374 - Detection -   eval_score = 93.4
2023-04-03 14:03:28,374 - Detection -   train_loss = 0.040313748021920524
2023-04-03 14:03:28,374 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_0.25_1.0_bert_0/models
2023-04-03 14:03:28,919 - Detection - Pre-training finished...
2023-04-03 14:03:28,919 - Detection - Training Begin...
2023-04-03 14:03:34,521 - Detection - ***** Epoch: 1: Eval results *****
2023-04-03 14:03:34,521 - Detection -   best_eval_score = 0
2023-04-03 14:03:34,521 - Detection -   eval_score = 7.11
2023-04-03 14:03:34,521 - Detection -   train_loss = 5.96137410402298
2023-04-03 14:03:37,692 - Detection - ***** Epoch: 2: Eval results *****
2023-04-03 14:03:37,692 - Detection -   best_eval_score = 7.11
2023-04-03 14:03:37,692 - Detection -   eval_score = 37.54
2023-04-03 14:03:37,692 - Detection -   train_loss = 4.962553163369496
2023-04-03 14:03:40,861 - Detection - ***** Epoch: 3: Eval results *****
2023-04-03 14:03:40,861 - Detection -   best_eval_score = 37.54
2023-04-03 14:03:40,861 - Detection -   eval_score = 63.2
2023-04-03 14:03:40,861 - Detection -   train_loss = 3.7506028910477958
2023-04-03 14:03:44,031 - Detection - ***** Epoch: 4: Eval results *****
2023-04-03 14:03:44,032 - Detection -   best_eval_score = 63.2
2023-04-03 14:03:44,032 - Detection -   eval_score = 73.3
2023-04-03 14:03:44,032 - Detection -   train_loss = 2.491973196466764
2023-04-03 14:03:47,200 - Detection - ***** Epoch: 5: Eval results *****
2023-04-03 14:03:47,200 - Detection -   best_eval_score = 73.3
2023-04-03 14:03:47,200 - Detection -   eval_score = 74.88
2023-04-03 14:03:47,200 - Detection -   train_loss = 1.4631799459457397
2023-04-03 14:03:50,368 - Detection - ***** Epoch: 6: Eval results *****
2023-04-03 14:03:50,368 - Detection -   best_eval_score = 74.88
2023-04-03 14:03:50,368 - Detection -   eval_score = 75.0
2023-04-03 14:03:50,368 - Detection -   train_loss = 1.166799691816171
2023-04-03 14:03:53,537 - Detection - ***** Epoch: 7: Eval results *****
2023-04-03 14:03:53,537 - Detection -   best_eval_score = 75.0
2023-04-03 14:03:53,537 - Detection -   eval_score = 74.9
2023-04-03 14:03:53,537 - Detection -   train_loss = 1.1682099054257076
2023-04-03 14:03:56,708 - Detection - ***** Epoch: 8: Eval results *****
2023-04-03 14:03:56,709 - Detection -   best_eval_score = 75.0
2023-04-03 14:03:56,709 - Detection -   eval_score = 75.0
2023-04-03 14:03:56,709 - Detection -   train_loss = 1.148182953397433
2023-04-03 14:03:59,878 - Detection - ***** Epoch: 9: Eval results *****
2023-04-03 14:03:59,878 - Detection -   best_eval_score = 75.0
2023-04-03 14:03:59,878 - Detection -   eval_score = 74.9
2023-04-03 14:03:59,878 - Detection -   train_loss = 1.1576267282168071
2023-04-03 14:04:03,046 - Detection - ***** Epoch: 10: Eval results *****
2023-04-03 14:04:03,046 - Detection -   best_eval_score = 75.0
2023-04-03 14:04:03,046 - Detection -   eval_score = 74.9
2023-04-03 14:04:03,046 - Detection -   train_loss = 1.145049440364043
2023-04-03 14:04:06,213 - Detection - ***** Epoch: 11: Eval results *****
2023-04-03 14:04:06,213 - Detection -   best_eval_score = 75.0
2023-04-03 14:04:06,214 - Detection -   eval_score = 75.0
2023-04-03 14:04:06,214 - Detection -   train_loss = 1.1308637609084446
2023-04-03 14:04:09,381 - Detection - ***** Epoch: 12: Eval results *****
2023-04-03 14:04:09,381 - Detection -   best_eval_score = 75.0
2023-04-03 14:04:09,381 - Detection -   eval_score = 74.9
2023-04-03 14:04:09,381 - Detection -   train_loss = 1.1528214265902836
2023-04-03 14:04:12,549 - Detection - ***** Epoch: 13: Eval results *****
2023-04-03 14:04:12,550 - Detection -   best_eval_score = 75.0
2023-04-03 14:04:12,550 - Detection -   eval_score = 74.9
2023-04-03 14:04:12,550 - Detection -   train_loss = 1.1528497785329819
2023-04-03 14:04:15,716 - Detection - ***** Epoch: 14: Eval results *****
2023-04-03 14:04:15,716 - Detection -   best_eval_score = 75.0
2023-04-03 14:04:15,716 - Detection -   eval_score = 74.9
2023-04-03 14:04:15,716 - Detection -   train_loss = 1.1443740079800289
2023-04-03 14:04:18,885 - Detection - ***** Epoch: 15: Eval results *****
2023-04-03 14:04:18,885 - Detection -   best_eval_score = 75.0
2023-04-03 14:04:18,885 - Detection -   eval_score = 74.9
2023-04-03 14:04:18,885 - Detection -   train_loss = 1.167510449886322
2023-04-03 14:04:22,054 - Detection - ***** Epoch: 16: Eval results *****
2023-04-03 14:04:22,054 - Detection -   best_eval_score = 75.0
2023-04-03 14:04:22,054 - Detection -   eval_score = 75.0
2023-04-03 14:04:22,054 - Detection -   train_loss = 1.1534380887945492
2023-04-03 14:04:22,055 - Detection - Training Finished...
2023-04-03 14:04:22,055 - Detection - Testing begin...
2023-04-03 14:04:27,034 - Detection - ***** Test: Confusion Matrix *****
2023-04-03 14:04:27,034 - Detection - [[ 242    1    0    0    0   57]
 [   1  231    1    0    0   67]
 [   0    2  265    1    0   32]
 [   0    0    0  262    0   38]
 [   0    0    0    0  259   41]
 [ 227  135   13   70    7 4048]]
2023-04-03 14:04:27,034 - Detection - ***** Test results *****
2023-04-03 14:04:27,034 - Detection -   Acc = 88.45
2023-04-03 14:04:27,034 - Detection -   F1 = 81.6551
2023-04-03 14:04:27,034 - Detection -   F1-known = 79.5505
2023-04-03 14:04:27,034 - Detection -   F1-open = 92.1781
2023-04-03 14:04:27,034 - Detection - Testing finished...
2023-04-03 14:04:27,034 - Detection - Results saved in results/results_ADB.csv
2023-04-03 14:04:27,052 - Detection - Open Intent Detection Finished...
