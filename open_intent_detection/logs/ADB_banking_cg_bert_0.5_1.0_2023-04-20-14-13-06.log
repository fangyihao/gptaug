2023-04-20 14:13:06,703 - Detection - Open Intent Detection Begin...
2023-04-20 14:13:06,703 - Detection - Parameters Initialization...
2023-04-20 14:13:06,703 - Detection - ============================== Params ==============================
2023-04-20 14:13:06,703 - Detection - type:	open_intent_detection
2023-04-20 14:13:06,703 - Detection - logger_name:	Detection
2023-04-20 14:13:06,703 - Detection - log_dir:	logs
2023-04-20 14:13:06,703 - Detection - dataset:	banking_cg
2023-04-20 14:13:06,703 - Detection - known_cls_ratio:	0.5
2023-04-20 14:13:06,703 - Detection - labeled_ratio:	1.0
2023-04-20 14:13:06,703 - Detection - method:	ADB
2023-04-20 14:13:06,703 - Detection - train:	True
2023-04-20 14:13:06,703 - Detection - pretrain:	True
2023-04-20 14:13:06,703 - Detection - save_model:	True
2023-04-20 14:13:06,703 - Detection - backbone:	bert
2023-04-20 14:13:06,703 - Detection - config_file_name:	ADB
2023-04-20 14:13:06,703 - Detection - seed:	3
2023-04-20 14:13:06,703 - Detection - gpu_id:	0
2023-04-20 14:13:06,703 - Detection - pipe_results_path:	pipe_results
2023-04-20 14:13:06,703 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-20 14:13:06,703 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-20 14:13:06,704 - Detection - model_dir:	models
2023-04-20 14:13:06,704 - Detection - load_pretrained_method:	None
2023-04-20 14:13:06,704 - Detection - result_dir:	results
2023-04-20 14:13:06,704 - Detection - results_file_name:	results_ADB.csv
2023-04-20 14:13:06,704 - Detection - save_results:	True
2023-04-20 14:13:06,704 - Detection - loss_fct:	CrossEntropyLoss
2023-04-20 14:13:06,704 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.5_1.0_bert_3
2023-04-20 14:13:06,704 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.5_1.0_bert_3/models
2023-04-20 14:13:06,704 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-20 14:13:06,704 - Detection - num_train_epochs:	100
2023-04-20 14:13:06,704 - Detection - num_labels:	None
2023-04-20 14:13:06,704 - Detection - max_seq_length:	None
2023-04-20 14:13:06,704 - Detection - freeze_backbone_parameters:	True
2023-04-20 14:13:06,704 - Detection - feat_dim:	768
2023-04-20 14:13:06,704 - Detection - warmup_proportion:	0.1
2023-04-20 14:13:06,704 - Detection - lr_boundary:	0.05
2023-04-20 14:13:06,704 - Detection - lr:	2e-05
2023-04-20 14:13:06,704 - Detection - activation:	relu
2023-04-20 14:13:06,704 - Detection - train_batch_size:	128
2023-04-20 14:13:06,704 - Detection - eval_batch_size:	64
2023-04-20 14:13:06,704 - Detection - test_batch_size:	64
2023-04-20 14:13:06,704 - Detection - wait_patient:	10
2023-04-20 14:13:06,704 - Detection - ============================== End Params ==============================
2023-04-20 14:13:06,704 - Detection - Data and Model Preparation...
2023-04-20 14:13:06,704 - Detection - The number of known intents is 38
2023-04-20 14:13:06,705 - Detection - Lists of known labels are: ['edit_personal_details', 'exchange_charge', 'compromised_card', 'top_up_limits', 'beneficiary_not_allowed', 'balance_not_updated_after_bank_transfer', 'request_refund', 'cancel_transfer', 'card_arrival', 'declined_cash_withdrawal', 'verify_source_of_funds', 'supported_cards_and_currencies', 'card_delivery_estimate', 'country_support', 'passcode_forgotten', 'verify_my_identity', 'card_payment_fee_charged', 'wrong_amount_of_cash_received', 'atm_support', 'card_acceptance', 'unable_to_verify_identity', 'pending_transfer', 'extra_charge_on_statement', 'top_up_by_cash_or_cheque', 'reverted_card_payment?', 'failed_transfer', 'transfer_not_received_by_recipient', 'lost_or_stolen_phone', 'pending_top_up', 'transfer_fee_charged', 'pin_blocked', 'topping_up_by_card', 'card_payment_wrong_exchange_rate', 'exchange_via_app', 'visa_or_mastercard', 'declined_transfer', 'top_up_reverted', 'transfer_timing']
2023-04-20 14:13:06,714 - Detection - Number of labeled training samples = 1445
2023-04-20 14:13:06,715 - Detection - Number of unlabeled training samples = 1328
2023-04-20 14:13:06,716 - Detection - Number of evaluation samples = 425
2023-04-20 14:13:06,722 - Detection - Number of testing samples = 1896
2023-04-20 14:13:10,883 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-20 14:13:12,520 - Detection - Pre-training Begin...
2023-04-20 14:13:15,131 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 14:13:15,131 - Detection -   best_eval_score = 0
2023-04-20 14:13:15,131 - Detection -   eval_score = 1.88
2023-04-20 14:13:15,131 - Detection -   train_loss = 3.6475802063941956
2023-04-20 14:13:17,269 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 14:13:17,269 - Detection -   best_eval_score = 1.88
2023-04-20 14:13:17,270 - Detection -   eval_score = 4.24
2023-04-20 14:13:17,270 - Detection -   train_loss = 3.6290422876675925
2023-04-20 14:13:19,415 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 14:13:19,415 - Detection -   best_eval_score = 4.24
2023-04-20 14:13:19,415 - Detection -   eval_score = 7.29
2023-04-20 14:13:19,415 - Detection -   train_loss = 3.5940969586372375
2023-04-20 14:13:21,561 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 14:13:21,561 - Detection -   best_eval_score = 7.29
2023-04-20 14:13:21,561 - Detection -   eval_score = 9.65
2023-04-20 14:13:21,561 - Detection -   train_loss = 3.5513392289479575
2023-04-20 14:13:23,713 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 14:13:23,713 - Detection -   best_eval_score = 9.65
2023-04-20 14:13:23,713 - Detection -   eval_score = 9.65
2023-04-20 14:13:23,713 - Detection -   train_loss = 3.4825480580329895
2023-04-20 14:13:25,855 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 14:13:25,856 - Detection -   best_eval_score = 9.65
2023-04-20 14:13:25,856 - Detection -   eval_score = 12.71
2023-04-20 14:13:25,856 - Detection -   train_loss = 3.3630495270093284
2023-04-20 14:13:28,013 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 14:13:28,013 - Detection -   best_eval_score = 12.71
2023-04-20 14:13:28,013 - Detection -   eval_score = 19.53
2023-04-20 14:13:28,013 - Detection -   train_loss = 3.1526810924212136
2023-04-20 14:13:30,189 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 14:13:30,189 - Detection -   best_eval_score = 19.53
2023-04-20 14:13:30,189 - Detection -   eval_score = 25.88
2023-04-20 14:13:30,189 - Detection -   train_loss = 2.8198206623395285
2023-04-20 14:13:32,390 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 14:13:32,390 - Detection -   best_eval_score = 25.88
2023-04-20 14:13:32,390 - Detection -   eval_score = 33.65
2023-04-20 14:13:32,390 - Detection -   train_loss = 2.4305724104245505
2023-04-20 14:13:34,608 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 14:13:34,608 - Detection -   best_eval_score = 33.65
2023-04-20 14:13:34,608 - Detection -   eval_score = 43.06
2023-04-20 14:13:34,608 - Detection -   train_loss = 2.0641757945219674
2023-04-20 14:13:36,842 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 14:13:36,842 - Detection -   best_eval_score = 43.06
2023-04-20 14:13:36,842 - Detection -   eval_score = 49.88
2023-04-20 14:13:36,842 - Detection -   train_loss = 1.755912681420644
2023-04-20 14:13:39,093 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 14:13:39,093 - Detection -   best_eval_score = 49.88
2023-04-20 14:13:39,093 - Detection -   eval_score = 56.94
2023-04-20 14:13:39,093 - Detection -   train_loss = 1.4971231520175934
2023-04-20 14:13:41,359 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 14:13:41,359 - Detection -   best_eval_score = 56.94
2023-04-20 14:13:41,359 - Detection -   eval_score = 58.59
2023-04-20 14:13:41,359 - Detection -   train_loss = 1.2830169995625813
2023-04-20 14:13:43,623 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 14:13:43,623 - Detection -   best_eval_score = 58.59
2023-04-20 14:13:43,623 - Detection -   eval_score = 62.82
2023-04-20 14:13:43,623 - Detection -   train_loss = 1.100147505601247
2023-04-20 14:13:46,003 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 14:13:46,003 - Detection -   best_eval_score = 62.82
2023-04-20 14:13:46,003 - Detection -   eval_score = 64.47
2023-04-20 14:13:46,003 - Detection -   train_loss = 0.9709540357192358
2023-04-20 14:13:48,292 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 14:13:48,292 - Detection -   best_eval_score = 64.47
2023-04-20 14:13:48,292 - Detection -   eval_score = 66.82
2023-04-20 14:13:48,292 - Detection -   train_loss = 0.8857242266337076
2023-04-20 14:13:50,585 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 14:13:50,585 - Detection -   best_eval_score = 66.82
2023-04-20 14:13:50,585 - Detection -   eval_score = 68.47
2023-04-20 14:13:50,585 - Detection -   train_loss = 0.787531798084577
2023-04-20 14:13:52,879 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 14:13:52,880 - Detection -   best_eval_score = 68.47
2023-04-20 14:13:52,880 - Detection -   eval_score = 69.65
2023-04-20 14:13:52,880 - Detection -   train_loss = 0.700022836526235
2023-04-20 14:13:55,183 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 14:13:55,183 - Detection -   best_eval_score = 69.65
2023-04-20 14:13:55,183 - Detection -   eval_score = 69.88
2023-04-20 14:13:55,183 - Detection -   train_loss = 0.6415085792541504
2023-04-20 14:13:57,494 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 14:13:57,494 - Detection -   best_eval_score = 69.88
2023-04-20 14:13:57,494 - Detection -   eval_score = 71.53
2023-04-20 14:13:57,494 - Detection -   train_loss = 0.5830322727560997
2023-04-20 14:13:59,796 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 14:13:59,796 - Detection -   best_eval_score = 71.53
2023-04-20 14:13:59,796 - Detection -   eval_score = 72.0
2023-04-20 14:13:59,796 - Detection -   train_loss = 0.5464179192980131
2023-04-20 14:14:02,091 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 14:14:02,091 - Detection -   best_eval_score = 72.0
2023-04-20 14:14:02,091 - Detection -   eval_score = 73.18
2023-04-20 14:14:02,091 - Detection -   train_loss = 0.4988815312584241
2023-04-20 14:14:04,398 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 14:14:04,399 - Detection -   best_eval_score = 73.18
2023-04-20 14:14:04,399 - Detection -   eval_score = 73.18
2023-04-20 14:14:04,399 - Detection -   train_loss = 0.46694116791089374
2023-04-20 14:14:06,696 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 14:14:06,696 - Detection -   best_eval_score = 73.18
2023-04-20 14:14:06,696 - Detection -   eval_score = 74.59
2023-04-20 14:14:06,696 - Detection -   train_loss = 0.43546905865271884
2023-04-20 14:14:09,001 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 14:14:09,002 - Detection -   best_eval_score = 74.59
2023-04-20 14:14:09,002 - Detection -   eval_score = 75.29
2023-04-20 14:14:09,002 - Detection -   train_loss = 0.41383712738752365
2023-04-20 14:14:11,301 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 14:14:11,301 - Detection -   best_eval_score = 75.29
2023-04-20 14:14:11,301 - Detection -   eval_score = 76.0
2023-04-20 14:14:11,301 - Detection -   train_loss = 0.38337837159633636
2023-04-20 14:14:13,606 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 14:14:13,606 - Detection -   best_eval_score = 76.0
2023-04-20 14:14:13,606 - Detection -   eval_score = 75.76
2023-04-20 14:14:13,606 - Detection -   train_loss = 0.36217742413282394
2023-04-20 14:14:15,901 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 14:14:15,901 - Detection -   best_eval_score = 76.0
2023-04-20 14:14:15,901 - Detection -   eval_score = 77.18
2023-04-20 14:14:15,901 - Detection -   train_loss = 0.3411870673298836
2023-04-20 14:14:18,201 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 14:14:18,201 - Detection -   best_eval_score = 77.18
2023-04-20 14:14:18,201 - Detection -   eval_score = 76.71
2023-04-20 14:14:18,201 - Detection -   train_loss = 0.326150036106507
2023-04-20 14:14:20,499 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 14:14:20,499 - Detection -   best_eval_score = 77.18
2023-04-20 14:14:20,499 - Detection -   eval_score = 77.18
2023-04-20 14:14:20,499 - Detection -   train_loss = 0.3088094964623451
2023-04-20 14:14:22,788 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 14:14:22,788 - Detection -   best_eval_score = 77.18
2023-04-20 14:14:22,788 - Detection -   eval_score = 77.41
2023-04-20 14:14:22,788 - Detection -   train_loss = 0.2931313216686249
2023-04-20 14:14:25,086 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 14:14:25,087 - Detection -   best_eval_score = 77.41
2023-04-20 14:14:25,087 - Detection -   eval_score = 77.41
2023-04-20 14:14:25,087 - Detection -   train_loss = 0.2811701335012913
2023-04-20 14:14:27,380 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 14:14:27,381 - Detection -   best_eval_score = 77.41
2023-04-20 14:14:27,381 - Detection -   eval_score = 78.35
2023-04-20 14:14:27,381 - Detection -   train_loss = 0.2640901878476143
2023-04-20 14:14:29,691 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 14:14:29,691 - Detection -   best_eval_score = 78.35
2023-04-20 14:14:29,692 - Detection -   eval_score = 78.12
2023-04-20 14:14:29,692 - Detection -   train_loss = 0.2530002308388551
2023-04-20 14:14:31,990 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 14:14:31,990 - Detection -   best_eval_score = 78.35
2023-04-20 14:14:31,991 - Detection -   eval_score = 78.12
2023-04-20 14:14:31,991 - Detection -   train_loss = 0.2509678478042285
2023-04-20 14:14:34,289 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 14:14:34,289 - Detection -   best_eval_score = 78.35
2023-04-20 14:14:34,289 - Detection -   eval_score = 78.59
2023-04-20 14:14:34,289 - Detection -   train_loss = 0.22464066371321678
2023-04-20 14:14:36,587 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 14:14:36,587 - Detection -   best_eval_score = 78.59
2023-04-20 14:14:36,587 - Detection -   eval_score = 78.35
2023-04-20 14:14:36,587 - Detection -   train_loss = 0.23045931880672774
2023-04-20 14:14:38,881 - Detection - ***** Epoch: 38: Eval results *****
2023-04-20 14:14:38,881 - Detection -   best_eval_score = 78.59
2023-04-20 14:14:38,881 - Detection -   eval_score = 78.12
2023-04-20 14:14:38,881 - Detection -   train_loss = 0.2092400590578715
2023-04-20 14:14:41,176 - Detection - ***** Epoch: 39: Eval results *****
2023-04-20 14:14:41,176 - Detection -   best_eval_score = 78.59
2023-04-20 14:14:41,177 - Detection -   eval_score = 78.59
2023-04-20 14:14:41,177 - Detection -   train_loss = 0.1984996385872364
2023-04-20 14:14:43,467 - Detection - ***** Epoch: 40: Eval results *****
2023-04-20 14:14:43,467 - Detection -   best_eval_score = 78.59
2023-04-20 14:14:43,468 - Detection -   eval_score = 78.12
2023-04-20 14:14:43,468 - Detection -   train_loss = 0.2109583057463169
2023-04-20 14:14:45,761 - Detection - ***** Epoch: 41: Eval results *****
2023-04-20 14:14:45,761 - Detection -   best_eval_score = 78.59
2023-04-20 14:14:45,761 - Detection -   eval_score = 78.35
2023-04-20 14:14:45,761 - Detection -   train_loss = 0.19496978943546614
2023-04-20 14:14:48,046 - Detection - ***** Epoch: 42: Eval results *****
2023-04-20 14:14:48,046 - Detection -   best_eval_score = 78.59
2023-04-20 14:14:48,046 - Detection -   eval_score = 78.59
2023-04-20 14:14:48,046 - Detection -   train_loss = 0.19385095437367758
2023-04-20 14:14:50,335 - Detection - ***** Epoch: 43: Eval results *****
2023-04-20 14:14:50,335 - Detection -   best_eval_score = 78.59
2023-04-20 14:14:50,335 - Detection -   eval_score = 78.82
2023-04-20 14:14:50,335 - Detection -   train_loss = 0.17793565491835275
2023-04-20 14:14:52,634 - Detection - ***** Epoch: 44: Eval results *****
2023-04-20 14:14:52,635 - Detection -   best_eval_score = 78.82
2023-04-20 14:14:52,635 - Detection -   eval_score = 78.59
2023-04-20 14:14:52,635 - Detection -   train_loss = 0.17313560470938683
2023-04-20 14:14:54,930 - Detection - ***** Epoch: 45: Eval results *****
2023-04-20 14:14:54,930 - Detection -   best_eval_score = 78.82
2023-04-20 14:14:54,930 - Detection -   eval_score = 78.82
2023-04-20 14:14:54,930 - Detection -   train_loss = 0.16837198163072267
2023-04-20 14:14:57,222 - Detection - ***** Epoch: 46: Eval results *****
2023-04-20 14:14:57,223 - Detection -   best_eval_score = 78.82
2023-04-20 14:14:57,223 - Detection -   eval_score = 79.06
2023-04-20 14:14:57,223 - Detection -   train_loss = 0.16030082354942957
2023-04-20 14:14:59,524 - Detection - ***** Epoch: 47: Eval results *****
2023-04-20 14:14:59,525 - Detection -   best_eval_score = 79.06
2023-04-20 14:14:59,525 - Detection -   eval_score = 79.06
2023-04-20 14:14:59,525 - Detection -   train_loss = 0.15360670164227486
2023-04-20 14:15:01,828 - Detection - ***** Epoch: 48: Eval results *****
2023-04-20 14:15:01,828 - Detection -   best_eval_score = 79.06
2023-04-20 14:15:01,828 - Detection -   eval_score = 78.82
2023-04-20 14:15:01,828 - Detection -   train_loss = 0.15410858144362768
2023-04-20 14:15:04,123 - Detection - ***** Epoch: 49: Eval results *****
2023-04-20 14:15:04,123 - Detection -   best_eval_score = 79.06
2023-04-20 14:15:04,123 - Detection -   eval_score = 79.29
2023-04-20 14:15:04,123 - Detection -   train_loss = 0.1499584193030993
2023-04-20 14:15:06,431 - Detection - ***** Epoch: 50: Eval results *****
2023-04-20 14:15:06,431 - Detection -   best_eval_score = 79.29
2023-04-20 14:15:06,431 - Detection -   eval_score = 78.59
2023-04-20 14:15:06,431 - Detection -   train_loss = 0.14566799625754356
2023-04-20 14:15:08,725 - Detection - ***** Epoch: 51: Eval results *****
2023-04-20 14:15:08,725 - Detection -   best_eval_score = 79.29
2023-04-20 14:15:08,725 - Detection -   eval_score = 79.53
2023-04-20 14:15:08,725 - Detection -   train_loss = 0.13964100616673628
2023-04-20 14:15:11,035 - Detection - ***** Epoch: 52: Eval results *****
2023-04-20 14:15:11,035 - Detection -   best_eval_score = 79.53
2023-04-20 14:15:11,035 - Detection -   eval_score = 80.0
2023-04-20 14:15:11,035 - Detection -   train_loss = 0.13517295010387897
2023-04-20 14:15:13,335 - Detection - ***** Epoch: 53: Eval results *****
2023-04-20 14:15:13,335 - Detection -   best_eval_score = 80.0
2023-04-20 14:15:13,335 - Detection -   eval_score = 78.82
2023-04-20 14:15:13,335 - Detection -   train_loss = 0.13432408248384795
2023-04-20 14:15:15,715 - Detection - ***** Epoch: 54: Eval results *****
2023-04-20 14:15:15,715 - Detection -   best_eval_score = 80.0
2023-04-20 14:15:15,715 - Detection -   eval_score = 79.53
2023-04-20 14:15:15,715 - Detection -   train_loss = 0.12492399476468563
2023-04-20 14:15:17,998 - Detection - ***** Epoch: 55: Eval results *****
2023-04-20 14:15:17,998 - Detection -   best_eval_score = 80.0
2023-04-20 14:15:17,998 - Detection -   eval_score = 79.06
2023-04-20 14:15:17,998 - Detection -   train_loss = 0.12760688426593939
2023-04-20 14:15:20,285 - Detection - ***** Epoch: 56: Eval results *****
2023-04-20 14:15:20,285 - Detection -   best_eval_score = 80.0
2023-04-20 14:15:20,285 - Detection -   eval_score = 80.0
2023-04-20 14:15:20,285 - Detection -   train_loss = 0.12339992510775726
2023-04-20 14:15:22,562 - Detection - ***** Epoch: 57: Eval results *****
2023-04-20 14:15:22,562 - Detection -   best_eval_score = 80.0
2023-04-20 14:15:22,562 - Detection -   eval_score = 80.0
2023-04-20 14:15:22,562 - Detection -   train_loss = 0.12073255144059658
2023-04-20 14:15:24,841 - Detection - ***** Epoch: 58: Eval results *****
2023-04-20 14:15:24,842 - Detection -   best_eval_score = 80.0
2023-04-20 14:15:24,842 - Detection -   eval_score = 80.0
2023-04-20 14:15:24,842 - Detection -   train_loss = 0.11810575984418392
2023-04-20 14:15:27,116 - Detection - ***** Epoch: 59: Eval results *****
2023-04-20 14:15:27,116 - Detection -   best_eval_score = 80.0
2023-04-20 14:15:27,116 - Detection -   eval_score = 80.24
2023-04-20 14:15:27,116 - Detection -   train_loss = 0.11349109498163064
2023-04-20 14:15:29,411 - Detection - ***** Epoch: 60: Eval results *****
2023-04-20 14:15:29,411 - Detection -   best_eval_score = 80.24
2023-04-20 14:15:29,411 - Detection -   eval_score = 80.0
2023-04-20 14:15:29,411 - Detection -   train_loss = 0.12172310799360275
2023-04-20 14:15:31,698 - Detection - ***** Epoch: 61: Eval results *****
2023-04-20 14:15:31,698 - Detection -   best_eval_score = 80.24
2023-04-20 14:15:31,698 - Detection -   eval_score = 80.47
2023-04-20 14:15:31,698 - Detection -   train_loss = 0.11094728919366996
2023-04-20 14:15:33,992 - Detection - ***** Epoch: 62: Eval results *****
2023-04-20 14:15:33,992 - Detection -   best_eval_score = 80.47
2023-04-20 14:15:33,992 - Detection -   eval_score = 80.0
2023-04-20 14:15:33,992 - Detection -   train_loss = 0.109093451872468
2023-04-20 14:15:36,266 - Detection - ***** Epoch: 63: Eval results *****
2023-04-20 14:15:36,266 - Detection -   best_eval_score = 80.47
2023-04-20 14:15:36,266 - Detection -   eval_score = 79.76
2023-04-20 14:15:36,266 - Detection -   train_loss = 0.10708624869585037
2023-04-20 14:15:38,547 - Detection - ***** Epoch: 64: Eval results *****
2023-04-20 14:15:38,547 - Detection -   best_eval_score = 80.47
2023-04-20 14:15:38,547 - Detection -   eval_score = 80.0
2023-04-20 14:15:38,547 - Detection -   train_loss = 0.1052666852871577
2023-04-20 14:15:40,819 - Detection - ***** Epoch: 65: Eval results *****
2023-04-20 14:15:40,819 - Detection -   best_eval_score = 80.47
2023-04-20 14:15:40,819 - Detection -   eval_score = 79.76
2023-04-20 14:15:40,819 - Detection -   train_loss = 0.11140674725174904
2023-04-20 14:15:43,090 - Detection - ***** Epoch: 66: Eval results *****
2023-04-20 14:15:43,090 - Detection -   best_eval_score = 80.47
2023-04-20 14:15:43,090 - Detection -   eval_score = 79.76
2023-04-20 14:15:43,090 - Detection -   train_loss = 0.09989993336300056
2023-04-20 14:15:45,364 - Detection - ***** Epoch: 67: Eval results *****
2023-04-20 14:15:45,364 - Detection -   best_eval_score = 80.47
2023-04-20 14:15:45,364 - Detection -   eval_score = 79.76
2023-04-20 14:15:45,364 - Detection -   train_loss = 0.1016148030757904
2023-04-20 14:15:47,634 - Detection - ***** Epoch: 68: Eval results *****
2023-04-20 14:15:47,634 - Detection -   best_eval_score = 80.47
2023-04-20 14:15:47,634 - Detection -   eval_score = 79.76
2023-04-20 14:15:47,634 - Detection -   train_loss = 0.09859576759239037
2023-04-20 14:15:49,909 - Detection - ***** Epoch: 69: Eval results *****
2023-04-20 14:15:49,909 - Detection -   best_eval_score = 80.47
2023-04-20 14:15:49,909 - Detection -   eval_score = 79.76
2023-04-20 14:15:49,909 - Detection -   train_loss = 0.10156060382723808
2023-04-20 14:15:52,181 - Detection - ***** Epoch: 70: Eval results *****
2023-04-20 14:15:52,181 - Detection -   best_eval_score = 80.47
2023-04-20 14:15:52,181 - Detection -   eval_score = 79.53
2023-04-20 14:15:52,181 - Detection -   train_loss = 0.09538663551211357
2023-04-20 14:15:54,458 - Detection - ***** Epoch: 71: Eval results *****
2023-04-20 14:15:54,458 - Detection -   best_eval_score = 80.47
2023-04-20 14:15:54,458 - Detection -   eval_score = 79.76
2023-04-20 14:15:54,458 - Detection -   train_loss = 0.10236275258163612
2023-04-20 14:15:54,458 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.5_1.0_bert_3/models
2023-04-20 14:15:55,002 - Detection - Pre-training finished...
2023-04-20 14:15:55,002 - Detection - Training Begin...
2023-04-20 14:15:58,774 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 14:15:58,774 - Detection -   best_eval_score = 0
2023-04-20 14:15:58,774 - Detection -   eval_score = 0.0
2023-04-20 14:15:58,774 - Detection -   train_loss = 11.618962208429972
2023-04-20 14:16:01,016 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 14:16:01,016 - Detection -   best_eval_score = 0
2023-04-20 14:16:01,016 - Detection -   eval_score = 0.0
2023-04-20 14:16:01,016 - Detection -   train_loss = 11.115516265233358
2023-04-20 14:16:03,258 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 14:16:03,258 - Detection -   best_eval_score = 0
2023-04-20 14:16:03,258 - Detection -   eval_score = 0.0
2023-04-20 14:16:03,258 - Detection -   train_loss = 10.828489065170288
2023-04-20 14:16:05,504 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 14:16:05,504 - Detection -   best_eval_score = 0
2023-04-20 14:16:05,504 - Detection -   eval_score = 0.0
2023-04-20 14:16:05,504 - Detection -   train_loss = 10.309512933095297
2023-04-20 14:16:07,755 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 14:16:07,755 - Detection -   best_eval_score = 0
2023-04-20 14:16:07,755 - Detection -   eval_score = 0.0
2023-04-20 14:16:07,755 - Detection -   train_loss = 9.822402397791544
2023-04-20 14:16:10,002 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 14:16:10,002 - Detection -   best_eval_score = 0
2023-04-20 14:16:10,002 - Detection -   eval_score = 0.39
2023-04-20 14:16:10,002 - Detection -   train_loss = 9.217655420303345
2023-04-20 14:16:12,254 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 14:16:12,254 - Detection -   best_eval_score = 0.39
2023-04-20 14:16:12,254 - Detection -   eval_score = 1.67
2023-04-20 14:16:12,254 - Detection -   train_loss = 8.635396798451742
2023-04-20 14:16:14,510 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 14:16:14,511 - Detection -   best_eval_score = 1.67
2023-04-20 14:16:14,511 - Detection -   eval_score = 4.09
2023-04-20 14:16:14,511 - Detection -   train_loss = 8.074056267738342
2023-04-20 14:16:16,764 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 14:16:16,764 - Detection -   best_eval_score = 4.09
2023-04-20 14:16:16,764 - Detection -   eval_score = 5.84
2023-04-20 14:16:16,764 - Detection -   train_loss = 7.462214112281799
2023-04-20 14:16:19,023 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 14:16:19,023 - Detection -   best_eval_score = 5.84
2023-04-20 14:16:19,023 - Detection -   eval_score = 9.85
2023-04-20 14:16:19,023 - Detection -   train_loss = 6.8859580755233765
2023-04-20 14:16:21,274 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 14:16:21,274 - Detection -   best_eval_score = 9.85
2023-04-20 14:16:21,274 - Detection -   eval_score = 13.36
2023-04-20 14:16:21,274 - Detection -   train_loss = 6.271557251612346
2023-04-20 14:16:23,528 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 14:16:23,528 - Detection -   best_eval_score = 13.36
2023-04-20 14:16:23,528 - Detection -   eval_score = 20.73
2023-04-20 14:16:23,528 - Detection -   train_loss = 5.630534728368123
2023-04-20 14:16:25,779 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 14:16:25,779 - Detection -   best_eval_score = 20.73
2023-04-20 14:16:25,779 - Detection -   eval_score = 25.71
2023-04-20 14:16:25,779 - Detection -   train_loss = 5.100505948066711
2023-04-20 14:16:28,032 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 14:16:28,032 - Detection -   best_eval_score = 25.71
2023-04-20 14:16:28,032 - Detection -   eval_score = 32.2
2023-04-20 14:16:28,032 - Detection -   train_loss = 4.554597576459249
2023-04-20 14:16:30,282 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 14:16:30,282 - Detection -   best_eval_score = 32.2
2023-04-20 14:16:30,282 - Detection -   eval_score = 38.17
2023-04-20 14:16:30,282 - Detection -   train_loss = 3.975065847237905
2023-04-20 14:16:32,532 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 14:16:32,532 - Detection -   best_eval_score = 38.17
2023-04-20 14:16:32,532 - Detection -   eval_score = 44.11
2023-04-20 14:16:32,532 - Detection -   train_loss = 3.420206069946289
2023-04-20 14:16:34,785 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 14:16:34,785 - Detection -   best_eval_score = 44.11
2023-04-20 14:16:34,785 - Detection -   eval_score = 48.87
2023-04-20 14:16:34,785 - Detection -   train_loss = 2.919049620628357
2023-04-20 14:16:37,041 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 14:16:37,041 - Detection -   best_eval_score = 48.87
2023-04-20 14:16:37,041 - Detection -   eval_score = 54.91
2023-04-20 14:16:37,041 - Detection -   train_loss = 2.4620237350463867
2023-04-20 14:16:39,286 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 14:16:39,287 - Detection -   best_eval_score = 54.91
2023-04-20 14:16:39,287 - Detection -   eval_score = 59.51
2023-04-20 14:16:39,287 - Detection -   train_loss = 2.034849484761556
2023-04-20 14:16:41,535 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 14:16:41,535 - Detection -   best_eval_score = 59.51
2023-04-20 14:16:41,535 - Detection -   eval_score = 62.61
2023-04-20 14:16:41,535 - Detection -   train_loss = 1.7832032640775044
2023-04-20 14:16:43,785 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 14:16:43,786 - Detection -   best_eval_score = 62.61
2023-04-20 14:16:43,786 - Detection -   eval_score = 64.0
2023-04-20 14:16:43,786 - Detection -   train_loss = 1.5864102641741435
2023-04-20 14:16:46,026 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 14:16:46,026 - Detection -   best_eval_score = 64.0
2023-04-20 14:16:46,026 - Detection -   eval_score = 64.36
2023-04-20 14:16:46,026 - Detection -   train_loss = 1.409016211827596
2023-04-20 14:16:48,274 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 14:16:48,275 - Detection -   best_eval_score = 64.36
2023-04-20 14:16:48,275 - Detection -   eval_score = 66.17
2023-04-20 14:16:48,275 - Detection -   train_loss = 1.3406072954336803
2023-04-20 14:16:50,522 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 14:16:50,522 - Detection -   best_eval_score = 66.17
2023-04-20 14:16:50,522 - Detection -   eval_score = 66.49
2023-04-20 14:16:50,522 - Detection -   train_loss = 1.3453627328077953
2023-04-20 14:16:52,771 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 14:16:52,771 - Detection -   best_eval_score = 66.49
2023-04-20 14:16:52,771 - Detection -   eval_score = 67.66
2023-04-20 14:16:52,771 - Detection -   train_loss = 1.3180186649163563
2023-04-20 14:16:55,016 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 14:16:55,016 - Detection -   best_eval_score = 67.66
2023-04-20 14:16:55,016 - Detection -   eval_score = 67.96
2023-04-20 14:16:55,016 - Detection -   train_loss = 1.2976774672667186
2023-04-20 14:16:57,266 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 14:16:57,266 - Detection -   best_eval_score = 67.96
2023-04-20 14:16:57,266 - Detection -   eval_score = 68.17
2023-04-20 14:16:57,266 - Detection -   train_loss = 1.3241649667421977
2023-04-20 14:16:59,514 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 14:16:59,514 - Detection -   best_eval_score = 68.17
2023-04-20 14:16:59,514 - Detection -   eval_score = 68.63
2023-04-20 14:16:59,514 - Detection -   train_loss = 1.3029844065507252
2023-04-20 14:17:01,760 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 14:17:01,760 - Detection -   best_eval_score = 68.63
2023-04-20 14:17:01,760 - Detection -   eval_score = 68.63
2023-04-20 14:17:01,760 - Detection -   train_loss = 1.3030587236086528
2023-04-20 14:17:04,012 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 14:17:04,012 - Detection -   best_eval_score = 68.63
2023-04-20 14:17:04,012 - Detection -   eval_score = 68.57
2023-04-20 14:17:04,012 - Detection -   train_loss = 1.3466399510701497
2023-04-20 14:17:06,254 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 14:17:06,254 - Detection -   best_eval_score = 68.63
2023-04-20 14:17:06,254 - Detection -   eval_score = 68.84
2023-04-20 14:17:06,254 - Detection -   train_loss = 1.315260688463847
2023-04-20 14:17:08,502 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 14:17:08,502 - Detection -   best_eval_score = 68.84
2023-04-20 14:17:08,502 - Detection -   eval_score = 68.76
2023-04-20 14:17:08,502 - Detection -   train_loss = 1.300196458896001
2023-04-20 14:17:10,750 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 14:17:10,750 - Detection -   best_eval_score = 68.84
2023-04-20 14:17:10,750 - Detection -   eval_score = 68.48
2023-04-20 14:17:10,750 - Detection -   train_loss = 1.2870318591594696
2023-04-20 14:17:12,997 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 14:17:12,997 - Detection -   best_eval_score = 68.84
2023-04-20 14:17:12,997 - Detection -   eval_score = 68.75
2023-04-20 14:17:12,997 - Detection -   train_loss = 1.2579755286375682
2023-04-20 14:17:15,242 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 14:17:15,242 - Detection -   best_eval_score = 68.84
2023-04-20 14:17:15,242 - Detection -   eval_score = 68.32
2023-04-20 14:17:15,242 - Detection -   train_loss = 1.282213677962621
2023-04-20 14:17:17,482 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 14:17:17,482 - Detection -   best_eval_score = 68.84
2023-04-20 14:17:17,482 - Detection -   eval_score = 68.54
2023-04-20 14:17:17,482 - Detection -   train_loss = 1.27147376537323
2023-04-20 14:17:19,726 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 14:17:19,726 - Detection -   best_eval_score = 68.84
2023-04-20 14:17:19,726 - Detection -   eval_score = 68.65
2023-04-20 14:17:19,727 - Detection -   train_loss = 1.3062134087085724
2023-04-20 14:17:21,977 - Detection - ***** Epoch: 38: Eval results *****
2023-04-20 14:17:21,977 - Detection -   best_eval_score = 68.84
2023-04-20 14:17:21,977 - Detection -   eval_score = 68.36
2023-04-20 14:17:21,977 - Detection -   train_loss = 1.2453042070070903
2023-04-20 14:17:24,222 - Detection - ***** Epoch: 39: Eval results *****
2023-04-20 14:17:24,222 - Detection -   best_eval_score = 68.84
2023-04-20 14:17:24,223 - Detection -   eval_score = 68.17
2023-04-20 14:17:24,223 - Detection -   train_loss = 1.2915396988391876
2023-04-20 14:17:26,469 - Detection - ***** Epoch: 40: Eval results *****
2023-04-20 14:17:26,469 - Detection -   best_eval_score = 68.84
2023-04-20 14:17:26,469 - Detection -   eval_score = 68.17
2023-04-20 14:17:26,469 - Detection -   train_loss = 1.3385764360427856
2023-04-20 14:17:28,719 - Detection - ***** Epoch: 41: Eval results *****
2023-04-20 14:17:28,719 - Detection -   best_eval_score = 68.84
2023-04-20 14:17:28,719 - Detection -   eval_score = 68.2
2023-04-20 14:17:28,719 - Detection -   train_loss = 1.2854255338509877
2023-04-20 14:17:28,720 - Detection - Training Finished...
2023-04-20 14:17:28,720 - Detection - Testing begin...
2023-04-20 14:17:30,787 - Detection - ***** Test: Confusion Matrix *****
2023-04-20 14:17:30,787 - Detection - [[ 20   0   0 ...   0   0   7]
 [  0  21   0 ...   0   0   3]
 [  0   0   7 ...   0   0  11]
 ...
 [  0   0   0 ...  21   0   5]
 [  0   0   0 ...   0  16   6]
 [  0  19  12 ...  27   1 645]]
2023-04-20 14:17:30,787 - Detection - ***** Test results *****
2023-04-20 14:17:30,788 - Detection -   Acc = 64.98
2023-04-20 14:17:30,788 - Detection -   F1 = 59.1405
2023-04-20 14:17:30,788 - Detection -   F1-known = 58.8786
2023-04-20 14:17:30,788 - Detection -   F1-open = 69.0948
2023-04-20 14:17:30,788 - Detection - Testing finished...
2023-04-20 14:17:30,788 - Detection - Results saved in results/results_ADB.csv
2023-04-20 14:17:30,808 - Detection - Open Intent Detection Finished...
