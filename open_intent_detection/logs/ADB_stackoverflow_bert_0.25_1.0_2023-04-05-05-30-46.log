2023-04-05 05:30:46,246 - Detection - Open Intent Detection Begin...
2023-04-05 05:30:46,246 - Detection - Parameters Initialization...
2023-04-05 05:30:46,246 - Detection - ============================== Params ==============================
2023-04-05 05:30:46,246 - Detection - type:	open_intent_detection
2023-04-05 05:30:46,246 - Detection - logger_name:	Detection
2023-04-05 05:30:46,246 - Detection - log_dir:	logs
2023-04-05 05:30:46,247 - Detection - dataset:	stackoverflow
2023-04-05 05:30:46,247 - Detection - known_cls_ratio:	0.25
2023-04-05 05:30:46,247 - Detection - labeled_ratio:	1.0
2023-04-05 05:30:46,247 - Detection - method:	ADB
2023-04-05 05:30:46,247 - Detection - train:	True
2023-04-05 05:30:46,247 - Detection - pretrain:	True
2023-04-05 05:30:46,247 - Detection - save_model:	True
2023-04-05 05:30:46,247 - Detection - backbone:	bert
2023-04-05 05:30:46,247 - Detection - config_file_name:	ADB
2023-04-05 05:30:46,247 - Detection - seed:	1
2023-04-05 05:30:46,247 - Detection - gpu_id:	0
2023-04-05 05:30:46,247 - Detection - pipe_results_path:	pipe_results
2023-04-05 05:30:46,247 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-05 05:30:46,247 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-05 05:30:46,247 - Detection - model_dir:	models
2023-04-05 05:30:46,247 - Detection - load_pretrained_method:	None
2023-04-05 05:30:46,247 - Detection - result_dir:	results
2023-04-05 05:30:46,247 - Detection - results_file_name:	results_ADB.csv
2023-04-05 05:30:46,247 - Detection - save_results:	True
2023-04-05 05:30:46,247 - Detection - loss_fct:	CrossEntropyLoss
2023-04-05 05:30:46,247 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_0.25_1.0_bert_1
2023-04-05 05:30:46,247 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_0.25_1.0_bert_1/models
2023-04-05 05:30:46,247 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-05 05:30:46,247 - Detection - num_train_epochs:	100
2023-04-05 05:30:46,247 - Detection - num_labels:	None
2023-04-05 05:30:46,247 - Detection - max_seq_length:	None
2023-04-05 05:30:46,247 - Detection - freeze_backbone_parameters:	True
2023-04-05 05:30:46,247 - Detection - feat_dim:	768
2023-04-05 05:30:46,247 - Detection - warmup_proportion:	0.1
2023-04-05 05:30:46,247 - Detection - lr_boundary:	0.05
2023-04-05 05:30:46,247 - Detection - lr:	2e-05
2023-04-05 05:30:46,247 - Detection - activation:	relu
2023-04-05 05:30:46,247 - Detection - train_batch_size:	128
2023-04-05 05:30:46,247 - Detection - eval_batch_size:	64
2023-04-05 05:30:46,247 - Detection - test_batch_size:	64
2023-04-05 05:30:46,247 - Detection - wait_patient:	10
2023-04-05 05:30:46,247 - Detection - ============================== End Params ==============================
2023-04-05 05:30:46,247 - Detection - Data and Model Preparation...
2023-04-05 05:30:46,248 - Detection - The number of known intents is 5
2023-04-05 05:30:46,248 - Detection - Lists of known labels are: ['cocoa', 'spring', 'haskell', 'matlab', 'bash']
2023-04-05 05:30:46,276 - Detection - Number of labeled training samples = 3000
2023-04-05 05:30:46,276 - Detection - Number of unlabeled training samples = 9000
2023-04-05 05:30:46,280 - Detection - Number of evaluation samples = 500
2023-04-05 05:30:46,291 - Detection - Number of testing samples = 6000
2023-04-05 05:30:53,748 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-05 05:30:55,446 - Detection - Pre-training Begin...
2023-04-05 05:30:59,203 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 05:30:59,203 - Detection -   best_eval_score = 0
2023-04-05 05:30:59,203 - Detection -   eval_score = 39.4
2023-04-05 05:30:59,203 - Detection -   train_loss = 1.6064126193523407
2023-04-05 05:31:02,468 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 05:31:02,468 - Detection -   best_eval_score = 39.4
2023-04-05 05:31:02,468 - Detection -   eval_score = 53.0
2023-04-05 05:31:02,468 - Detection -   train_loss = 1.5705311795075734
2023-04-05 05:31:05,742 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 05:31:05,742 - Detection -   best_eval_score = 53.0
2023-04-05 05:31:05,742 - Detection -   eval_score = 67.2
2023-04-05 05:31:05,742 - Detection -   train_loss = 1.4860299477974575
2023-04-05 05:31:09,023 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 05:31:09,024 - Detection -   best_eval_score = 67.2
2023-04-05 05:31:09,024 - Detection -   eval_score = 80.4
2023-04-05 05:31:09,024 - Detection -   train_loss = 1.2722011059522629
2023-04-05 05:31:12,351 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 05:31:12,351 - Detection -   best_eval_score = 80.4
2023-04-05 05:31:12,351 - Detection -   eval_score = 86.6
2023-04-05 05:31:12,351 - Detection -   train_loss = 0.8605837027231852
2023-04-05 05:31:15,758 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 05:31:15,758 - Detection -   best_eval_score = 86.6
2023-04-05 05:31:15,758 - Detection -   eval_score = 87.2
2023-04-05 05:31:15,758 - Detection -   train_loss = 0.5093026459217072
2023-04-05 05:31:19,225 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 05:31:19,225 - Detection -   best_eval_score = 87.2
2023-04-05 05:31:19,225 - Detection -   eval_score = 88.0
2023-04-05 05:31:19,225 - Detection -   train_loss = 0.36154163380463916
2023-04-05 05:31:22,731 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 05:31:22,731 - Detection -   best_eval_score = 88.0
2023-04-05 05:31:22,731 - Detection -   eval_score = 87.6
2023-04-05 05:31:22,731 - Detection -   train_loss = 0.31357006914913654
2023-04-05 05:31:26,225 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 05:31:26,225 - Detection -   best_eval_score = 88.0
2023-04-05 05:31:26,225 - Detection -   eval_score = 88.8
2023-04-05 05:31:26,225 - Detection -   train_loss = 0.26704387180507183
2023-04-05 05:31:29,720 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 05:31:29,720 - Detection -   best_eval_score = 88.8
2023-04-05 05:31:29,720 - Detection -   eval_score = 87.8
2023-04-05 05:31:29,721 - Detection -   train_loss = 0.2377004399895668
2023-04-05 05:31:33,216 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 05:31:33,216 - Detection -   best_eval_score = 88.8
2023-04-05 05:31:33,216 - Detection -   eval_score = 89.2
2023-04-05 05:31:33,216 - Detection -   train_loss = 0.2186633882423242
2023-04-05 05:31:36,718 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 05:31:36,718 - Detection -   best_eval_score = 89.2
2023-04-05 05:31:36,718 - Detection -   eval_score = 88.2
2023-04-05 05:31:36,718 - Detection -   train_loss = 0.20807500649243593
2023-04-05 05:31:40,214 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 05:31:40,214 - Detection -   best_eval_score = 89.2
2023-04-05 05:31:40,214 - Detection -   eval_score = 88.6
2023-04-05 05:31:40,214 - Detection -   train_loss = 0.19734388465682665
2023-04-05 05:31:43,698 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 05:31:43,698 - Detection -   best_eval_score = 89.2
2023-04-05 05:31:43,698 - Detection -   eval_score = 88.4
2023-04-05 05:31:43,698 - Detection -   train_loss = 0.1857821081454555
2023-04-05 05:31:47,181 - Detection - ***** Epoch: 15: Eval results *****
2023-04-05 05:31:47,181 - Detection -   best_eval_score = 89.2
2023-04-05 05:31:47,181 - Detection -   eval_score = 88.8
2023-04-05 05:31:47,181 - Detection -   train_loss = 0.16362219955772161
2023-04-05 05:31:50,681 - Detection - ***** Epoch: 16: Eval results *****
2023-04-05 05:31:50,681 - Detection -   best_eval_score = 89.2
2023-04-05 05:31:50,681 - Detection -   eval_score = 90.2
2023-04-05 05:31:50,681 - Detection -   train_loss = 0.1533335940912366
2023-04-05 05:31:54,276 - Detection - ***** Epoch: 17: Eval results *****
2023-04-05 05:31:54,276 - Detection -   best_eval_score = 90.2
2023-04-05 05:31:54,277 - Detection -   eval_score = 89.4
2023-04-05 05:31:54,277 - Detection -   train_loss = 0.1284089400433004
2023-04-05 05:31:57,788 - Detection - ***** Epoch: 18: Eval results *****
2023-04-05 05:31:57,788 - Detection -   best_eval_score = 90.2
2023-04-05 05:31:57,788 - Detection -   eval_score = 89.6
2023-04-05 05:31:57,788 - Detection -   train_loss = 0.12374633954217036
2023-04-05 05:32:01,287 - Detection - ***** Epoch: 19: Eval results *****
2023-04-05 05:32:01,287 - Detection -   best_eval_score = 90.2
2023-04-05 05:32:01,287 - Detection -   eval_score = 89.6
2023-04-05 05:32:01,287 - Detection -   train_loss = 0.11238213426743944
2023-04-05 05:32:04,780 - Detection - ***** Epoch: 20: Eval results *****
2023-04-05 05:32:04,780 - Detection -   best_eval_score = 90.2
2023-04-05 05:32:04,780 - Detection -   eval_score = 89.0
2023-04-05 05:32:04,781 - Detection -   train_loss = 0.10751562876005967
2023-04-05 05:32:08,267 - Detection - ***** Epoch: 21: Eval results *****
2023-04-05 05:32:08,267 - Detection -   best_eval_score = 90.2
2023-04-05 05:32:08,267 - Detection -   eval_score = 90.2
2023-04-05 05:32:08,267 - Detection -   train_loss = 0.09640219171221058
2023-04-05 05:32:11,762 - Detection - ***** Epoch: 22: Eval results *****
2023-04-05 05:32:11,762 - Detection -   best_eval_score = 90.2
2023-04-05 05:32:11,762 - Detection -   eval_score = 89.6
2023-04-05 05:32:11,762 - Detection -   train_loss = 0.09470520028844476
2023-04-05 05:32:15,245 - Detection - ***** Epoch: 23: Eval results *****
2023-04-05 05:32:15,245 - Detection -   best_eval_score = 90.2
2023-04-05 05:32:15,245 - Detection -   eval_score = 90.6
2023-04-05 05:32:15,245 - Detection -   train_loss = 0.08793135996287067
2023-04-05 05:32:18,741 - Detection - ***** Epoch: 24: Eval results *****
2023-04-05 05:32:18,742 - Detection -   best_eval_score = 90.6
2023-04-05 05:32:18,742 - Detection -   eval_score = 89.6
2023-04-05 05:32:18,742 - Detection -   train_loss = 0.08192167694990833
2023-04-05 05:32:22,243 - Detection - ***** Epoch: 25: Eval results *****
2023-04-05 05:32:22,243 - Detection -   best_eval_score = 90.6
2023-04-05 05:32:22,243 - Detection -   eval_score = 89.0
2023-04-05 05:32:22,243 - Detection -   train_loss = 0.07072141176710527
2023-04-05 05:32:25,731 - Detection - ***** Epoch: 26: Eval results *****
2023-04-05 05:32:25,731 - Detection -   best_eval_score = 90.6
2023-04-05 05:32:25,731 - Detection -   eval_score = 89.4
2023-04-05 05:32:25,731 - Detection -   train_loss = 0.06764427262047927
2023-04-05 05:32:29,215 - Detection - ***** Epoch: 27: Eval results *****
2023-04-05 05:32:29,215 - Detection -   best_eval_score = 90.6
2023-04-05 05:32:29,215 - Detection -   eval_score = 90.0
2023-04-05 05:32:29,215 - Detection -   train_loss = 0.06406986294314265
2023-04-05 05:32:32,711 - Detection - ***** Epoch: 28: Eval results *****
2023-04-05 05:32:32,711 - Detection -   best_eval_score = 90.6
2023-04-05 05:32:32,711 - Detection -   eval_score = 90.0
2023-04-05 05:32:32,711 - Detection -   train_loss = 0.059437310633560024
2023-04-05 05:32:36,196 - Detection - ***** Epoch: 29: Eval results *****
2023-04-05 05:32:36,196 - Detection -   best_eval_score = 90.6
2023-04-05 05:32:36,196 - Detection -   eval_score = 89.4
2023-04-05 05:32:36,196 - Detection -   train_loss = 0.05159043714714547
2023-04-05 05:32:39,688 - Detection - ***** Epoch: 30: Eval results *****
2023-04-05 05:32:39,688 - Detection -   best_eval_score = 90.6
2023-04-05 05:32:39,688 - Detection -   eval_score = 90.6
2023-04-05 05:32:39,688 - Detection -   train_loss = 0.05514860261852542
2023-04-05 05:32:43,178 - Detection - ***** Epoch: 31: Eval results *****
2023-04-05 05:32:43,178 - Detection -   best_eval_score = 90.6
2023-04-05 05:32:43,178 - Detection -   eval_score = 90.0
2023-04-05 05:32:43,178 - Detection -   train_loss = 0.04904430041400095
2023-04-05 05:32:46,666 - Detection - ***** Epoch: 32: Eval results *****
2023-04-05 05:32:46,666 - Detection -   best_eval_score = 90.6
2023-04-05 05:32:46,667 - Detection -   eval_score = 90.6
2023-04-05 05:32:46,667 - Detection -   train_loss = 0.04464294877834618
2023-04-05 05:32:50,151 - Detection - ***** Epoch: 33: Eval results *****
2023-04-05 05:32:50,151 - Detection -   best_eval_score = 90.6
2023-04-05 05:32:50,151 - Detection -   eval_score = 89.6
2023-04-05 05:32:50,151 - Detection -   train_loss = 0.045009687232474484
2023-04-05 05:32:50,151 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_0.25_1.0_bert_1/models
2023-04-05 05:32:50,696 - Detection - Pre-training finished...
2023-04-05 05:32:50,697 - Detection - Training Begin...
2023-04-05 05:32:56,792 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 05:32:56,792 - Detection -   best_eval_score = 0
2023-04-05 05:32:56,792 - Detection -   eval_score = 4.06
2023-04-05 05:32:56,792 - Detection -   train_loss = 6.835446000099182
2023-04-05 05:33:00,256 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 05:33:00,256 - Detection -   best_eval_score = 4.06
2023-04-05 05:33:00,256 - Detection -   eval_score = 26.75
2023-04-05 05:33:00,256 - Detection -   train_loss = 5.841651022434235
2023-04-05 05:33:03,710 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 05:33:03,710 - Detection -   best_eval_score = 26.75
2023-04-05 05:33:03,710 - Detection -   eval_score = 50.4
2023-04-05 05:33:03,710 - Detection -   train_loss = 4.746790210405986
2023-04-05 05:33:07,167 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 05:33:07,167 - Detection -   best_eval_score = 50.4
2023-04-05 05:33:07,167 - Detection -   eval_score = 57.73
2023-04-05 05:33:07,167 - Detection -   train_loss = 3.4216898878415427
2023-04-05 05:33:10,614 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 05:33:10,614 - Detection -   best_eval_score = 57.73
2023-04-05 05:33:10,614 - Detection -   eval_score = 68.67
2023-04-05 05:33:10,614 - Detection -   train_loss = 2.2726538429657617
2023-04-05 05:33:14,058 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 05:33:14,058 - Detection -   best_eval_score = 68.67
2023-04-05 05:33:14,059 - Detection -   eval_score = 71.14
2023-04-05 05:33:14,059 - Detection -   train_loss = 1.6137155493100483
2023-04-05 05:33:17,513 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 05:33:17,513 - Detection -   best_eval_score = 71.14
2023-04-05 05:33:17,513 - Detection -   eval_score = 71.87
2023-04-05 05:33:17,513 - Detection -   train_loss = 1.3869238644838333
2023-04-05 05:33:20,968 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 05:33:20,968 - Detection -   best_eval_score = 71.87
2023-04-05 05:33:20,968 - Detection -   eval_score = 71.99
2023-04-05 05:33:20,969 - Detection -   train_loss = 1.3529022336006165
2023-04-05 05:33:24,411 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 05:33:24,412 - Detection -   best_eval_score = 71.99
2023-04-05 05:33:24,412 - Detection -   eval_score = 71.77
2023-04-05 05:33:24,412 - Detection -   train_loss = 1.356003647049268
2023-04-05 05:33:27,857 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 05:33:27,858 - Detection -   best_eval_score = 71.99
2023-04-05 05:33:27,858 - Detection -   eval_score = 71.88
2023-04-05 05:33:27,858 - Detection -   train_loss = 1.3711000432570775
2023-04-05 05:33:31,304 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 05:33:31,304 - Detection -   best_eval_score = 71.99
2023-04-05 05:33:31,304 - Detection -   eval_score = 71.99
2023-04-05 05:33:31,304 - Detection -   train_loss = 1.3539482454458873
2023-04-05 05:33:34,749 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 05:33:34,749 - Detection -   best_eval_score = 71.99
2023-04-05 05:33:34,749 - Detection -   eval_score = 71.88
2023-04-05 05:33:34,749 - Detection -   train_loss = 1.371545414129893
2023-04-05 05:33:38,191 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 05:33:38,191 - Detection -   best_eval_score = 71.99
2023-04-05 05:33:38,191 - Detection -   eval_score = 71.99
2023-04-05 05:33:38,191 - Detection -   train_loss = 1.3435168862342834
2023-04-05 05:33:41,640 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 05:33:41,640 - Detection -   best_eval_score = 71.99
2023-04-05 05:33:41,641 - Detection -   eval_score = 71.88
2023-04-05 05:33:41,641 - Detection -   train_loss = 1.3632365465164185
2023-04-05 05:33:45,086 - Detection - ***** Epoch: 15: Eval results *****
2023-04-05 05:33:45,086 - Detection -   best_eval_score = 71.99
2023-04-05 05:33:45,086 - Detection -   eval_score = 71.77
2023-04-05 05:33:45,086 - Detection -   train_loss = 1.3534429669380188
2023-04-05 05:33:48,528 - Detection - ***** Epoch: 16: Eval results *****
2023-04-05 05:33:48,528 - Detection -   best_eval_score = 71.99
2023-04-05 05:33:48,529 - Detection -   eval_score = 71.88
2023-04-05 05:33:48,529 - Detection -   train_loss = 1.3781144469976425
2023-04-05 05:33:51,975 - Detection - ***** Epoch: 17: Eval results *****
2023-04-05 05:33:51,975 - Detection -   best_eval_score = 71.99
2023-04-05 05:33:51,975 - Detection -   eval_score = 71.99
2023-04-05 05:33:51,975 - Detection -   train_loss = 1.3930706828832626
2023-04-05 05:33:55,416 - Detection - ***** Epoch: 18: Eval results *****
2023-04-05 05:33:55,416 - Detection -   best_eval_score = 71.99
2023-04-05 05:33:55,416 - Detection -   eval_score = 71.77
2023-04-05 05:33:55,416 - Detection -   train_loss = 1.353762758274873
2023-04-05 05:33:55,417 - Detection - Training Finished...
2023-04-05 05:33:55,417 - Detection - Testing begin...
2023-04-05 05:34:00,826 - Detection - ***** Test: Confusion Matrix *****
2023-04-05 05:34:00,826 - Detection - [[ 226    0    0    0    1   73]
 [   1  250    0    0    0   49]
 [   0    0  239    0    1   60]
 [   0    0    1  256    0   43]
 [   4    0    1    1  227   67]
 [ 399   72   32    2  138 3857]]
2023-04-05 05:34:00,826 - Detection - ***** Test results *****
2023-04-05 05:34:00,826 - Detection -   Acc = 84.25
2023-04-05 05:34:00,826 - Detection -   F1 = 76.876
2023-04-05 05:34:00,826 - Detection -   F1-known = 74.4133
2023-04-05 05:34:00,826 - Detection -   F1-open = 89.1895
2023-04-05 05:34:00,826 - Detection - Testing finished...
2023-04-05 05:34:00,826 - Detection - Results saved in results/results_ADB.csv
2023-04-05 05:34:00,846 - Detection - Open Intent Detection Finished...
