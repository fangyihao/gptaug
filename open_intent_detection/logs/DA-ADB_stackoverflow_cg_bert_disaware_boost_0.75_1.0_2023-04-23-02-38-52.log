2023-04-23 02:38:52,372 - Detection - Open Intent Detection Begin...
2023-04-23 02:38:52,372 - Detection - Parameters Initialization...
2023-04-23 02:38:52,373 - Detection - ============================== Params ==============================
2023-04-23 02:38:52,373 - Detection - type:	open_intent_detection
2023-04-23 02:38:52,373 - Detection - logger_name:	Detection
2023-04-23 02:38:52,373 - Detection - log_dir:	logs
2023-04-23 02:38:52,373 - Detection - dataset:	stackoverflow_cg
2023-04-23 02:38:52,373 - Detection - known_cls_ratio:	0.75
2023-04-23 02:38:52,373 - Detection - labeled_ratio:	1.0
2023-04-23 02:38:52,373 - Detection - method:	DA-ADB
2023-04-23 02:38:52,373 - Detection - train:	True
2023-04-23 02:38:52,373 - Detection - pretrain:	True
2023-04-23 02:38:52,373 - Detection - save_model:	False
2023-04-23 02:38:52,373 - Detection - backbone:	bert_disaware_boost
2023-04-23 02:38:52,373 - Detection - config_file_name:	DA-ADB
2023-04-23 02:38:52,373 - Detection - seed:	5
2023-04-23 02:38:52,373 - Detection - gpu_id:	0
2023-04-23 02:38:52,373 - Detection - pipe_results_path:	pipe_results
2023-04-23 02:38:52,373 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-23 02:38:52,373 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-23 02:38:52,373 - Detection - model_dir:	models
2023-04-23 02:38:52,373 - Detection - load_pretrained_method:	None
2023-04-23 02:38:52,373 - Detection - result_dir:	results
2023-04-23 02:38:52,373 - Detection - results_file_name:	results_DA-ADB-BOOST-F-4.csv
2023-04-23 02:38:52,373 - Detection - save_results:	True
2023-04-23 02:38:52,373 - Detection - loss_fct:	CrossEntropyLoss
2023-04-23 02:38:52,373 - Detection - boost_method:	F-4
2023-04-23 02:38:52,373 - Detection - boost_start_score:	0.0
2023-04-23 02:38:52,373 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.75_1.0_bert_disaware_boost_5
2023-04-23 02:38:52,373 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.75_1.0_bert_disaware_boost_5/models
2023-04-23 02:38:52,373 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-23 02:38:52,373 - Detection - num_train_epochs:	100
2023-04-23 02:38:52,373 - Detection - num_labels:	None
2023-04-23 02:38:52,373 - Detection - max_seq_length:	None
2023-04-23 02:38:52,373 - Detection - freeze_backbone_parameters:	True
2023-04-23 02:38:52,373 - Detection - feat_dim:	768
2023-04-23 02:38:52,373 - Detection - warmup_proportion:	0.1
2023-04-23 02:38:52,373 - Detection - scale:	4
2023-04-23 02:38:52,373 - Detection - lr_boundary:	0.05
2023-04-23 02:38:52,373 - Detection - lr:	2e-05
2023-04-23 02:38:52,373 - Detection - activation:	relu
2023-04-23 02:38:52,373 - Detection - train_batch_size:	128
2023-04-23 02:38:52,373 - Detection - eval_batch_size:	64
2023-04-23 02:38:52,373 - Detection - test_batch_size:	64
2023-04-23 02:38:52,373 - Detection - wait_patient:	10
2023-04-23 02:38:52,373 - Detection - ============================== End Params ==============================
2023-04-23 02:38:52,373 - Detection - Data and Model Preparation...
2023-04-23 02:38:52,374 - Detection - The number of known intents is 15
2023-04-23 02:38:52,374 - Detection - Lists of known labels are: ['bash', 'excel', 'svn', 'wordpress', 'osx', 'apache', 'oracle', 'matlab', 'qt', 'visual-studio', 'hibernate', 'drupal', 'linq', 'magento', 'ajax']
2023-04-23 02:38:52,384 - Detection - Number of labeled training samples = 2003
2023-04-23 02:38:52,384 - Detection - Number of unlabeled training samples = 788
2023-04-23 02:38:52,386 - Detection - Number of evaluation samples = 1071
2023-04-23 02:38:52,392 - Detection - Number of testing samples = 2905
2023-04-23 02:38:58,092 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-23 02:38:58,206 - Detection - Pre-training Begin...
2023-04-23 02:39:02,154 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 02:39:02,154 - Detection -   best_eval_score = 0
2023-04-23 02:39:02,154 - Detection -   eval_score = 2.79
2023-04-23 02:39:02,154 - Detection -   train_loss = 2.712770566344261
2023-04-23 02:39:14,752 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 02:39:14,752 - Detection -   best_eval_score = 2.79
2023-04-23 02:39:14,752 - Detection -   eval_score = 1.25
2023-04-23 02:39:14,752 - Detection -   train_loss = 2.695267766714096
2023-04-23 02:39:27,186 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 02:39:27,186 - Detection -   best_eval_score = 2.79
2023-04-23 02:39:27,186 - Detection -   eval_score = 11.76
2023-04-23 02:39:27,186 - Detection -   train_loss = 2.647822290658951
2023-04-23 02:39:39,790 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 02:39:39,790 - Detection -   best_eval_score = 11.76
2023-04-23 02:39:39,790 - Detection -   eval_score = 44.4
2023-04-23 02:39:39,790 - Detection -   train_loss = 2.5066315084695816
2023-04-23 02:39:52,308 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 02:39:52,308 - Detection -   best_eval_score = 44.4
2023-04-23 02:39:52,309 - Detection -   eval_score = 76.28
2023-04-23 02:39:52,309 - Detection -   train_loss = 2.1305088698863983
2023-04-23 02:40:04,823 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 02:40:04,824 - Detection -   best_eval_score = 76.28
2023-04-23 02:40:04,824 - Detection -   eval_score = 81.88
2023-04-23 02:40:04,824 - Detection -   train_loss = 1.6303740069270134
2023-04-23 02:40:17,461 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 02:40:17,461 - Detection -   best_eval_score = 81.88
2023-04-23 02:40:17,461 - Detection -   eval_score = 81.74
2023-04-23 02:40:17,461 - Detection -   train_loss = 1.3331422060728073
2023-04-23 02:40:29,928 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 02:40:29,928 - Detection -   best_eval_score = 81.88
2023-04-23 02:40:29,928 - Detection -   eval_score = 82.79
2023-04-23 02:40:29,928 - Detection -   train_loss = 1.209439903497696
2023-04-23 02:40:42,601 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 02:40:42,602 - Detection -   best_eval_score = 82.79
2023-04-23 02:40:42,602 - Detection -   eval_score = 82.81
2023-04-23 02:40:42,602 - Detection -   train_loss = 1.1115290969610214
2023-04-23 02:40:55,098 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 02:40:55,098 - Detection -   best_eval_score = 82.81
2023-04-23 02:40:55,098 - Detection -   eval_score = 83.02
2023-04-23 02:40:55,098 - Detection -   train_loss = 1.024044655263424
2023-04-23 02:41:07,743 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 02:41:07,743 - Detection -   best_eval_score = 83.02
2023-04-23 02:41:07,743 - Detection -   eval_score = 83.94
2023-04-23 02:41:07,743 - Detection -   train_loss = 0.95383295789361
2023-04-23 02:41:20,464 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 02:41:20,464 - Detection -   best_eval_score = 83.94
2023-04-23 02:41:20,464 - Detection -   eval_score = 83.37
2023-04-23 02:41:20,464 - Detection -   train_loss = 0.8870603069663048
2023-04-23 02:41:33,081 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 02:41:33,081 - Detection -   best_eval_score = 83.94
2023-04-23 02:41:33,081 - Detection -   eval_score = 83.5
2023-04-23 02:41:33,081 - Detection -   train_loss = 0.8433835208415985
2023-04-23 02:41:45,804 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 02:41:45,804 - Detection -   best_eval_score = 83.94
2023-04-23 02:41:45,804 - Detection -   eval_score = 83.0
2023-04-23 02:41:45,804 - Detection -   train_loss = 0.8004339635372162
2023-04-23 02:41:58,309 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 02:41:58,309 - Detection -   best_eval_score = 83.94
2023-04-23 02:41:58,309 - Detection -   eval_score = 83.64
2023-04-23 02:41:58,309 - Detection -   train_loss = 0.7509180828928947
2023-04-23 02:42:10,954 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 02:42:10,954 - Detection -   best_eval_score = 83.94
2023-04-23 02:42:10,954 - Detection -   eval_score = 83.39
2023-04-23 02:42:10,954 - Detection -   train_loss = 0.7016781158745289
2023-04-23 02:42:23,576 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 02:42:23,576 - Detection -   best_eval_score = 83.94
2023-04-23 02:42:23,576 - Detection -   eval_score = 83.76
2023-04-23 02:42:23,577 - Detection -   train_loss = 0.6672261320054531
2023-04-23 02:42:36,243 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 02:42:36,244 - Detection -   best_eval_score = 83.94
2023-04-23 02:42:36,244 - Detection -   eval_score = 83.15
2023-04-23 02:42:36,244 - Detection -   train_loss = 0.6383007988333702
2023-04-23 02:42:48,912 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 02:42:48,912 - Detection -   best_eval_score = 83.94
2023-04-23 02:42:48,912 - Detection -   eval_score = 83.0
2023-04-23 02:42:48,912 - Detection -   train_loss = 0.6207432560622692
2023-04-23 02:43:01,440 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 02:43:01,440 - Detection -   best_eval_score = 83.94
2023-04-23 02:43:01,440 - Detection -   eval_score = 83.72
2023-04-23 02:43:01,441 - Detection -   train_loss = 0.5958267971873283
2023-04-23 02:43:14,052 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 02:43:14,052 - Detection -   best_eval_score = 83.94
2023-04-23 02:43:14,052 - Detection -   eval_score = 84.31
2023-04-23 02:43:14,052 - Detection -   train_loss = 0.5616847388446331
2023-04-23 02:43:26,636 - Detection - ***** Epoch: 22: Eval results *****
2023-04-23 02:43:26,636 - Detection -   best_eval_score = 84.31
2023-04-23 02:43:26,636 - Detection -   eval_score = 84.72
2023-04-23 02:43:26,636 - Detection -   train_loss = 0.541497377678752
2023-04-23 02:43:39,274 - Detection - ***** Epoch: 23: Eval results *****
2023-04-23 02:43:39,274 - Detection -   best_eval_score = 84.72
2023-04-23 02:43:39,274 - Detection -   eval_score = 84.13
2023-04-23 02:43:39,274 - Detection -   train_loss = 0.5277065895497799
2023-04-23 02:43:51,773 - Detection - ***** Epoch: 24: Eval results *****
2023-04-23 02:43:51,773 - Detection -   best_eval_score = 84.72
2023-04-23 02:43:51,773 - Detection -   eval_score = 83.76
2023-04-23 02:43:51,773 - Detection -   train_loss = 0.5040510967373848
2023-04-23 02:44:04,454 - Detection - ***** Epoch: 25: Eval results *****
2023-04-23 02:44:04,454 - Detection -   best_eval_score = 84.72
2023-04-23 02:44:04,454 - Detection -   eval_score = 83.79
2023-04-23 02:44:04,454 - Detection -   train_loss = 0.4943680763244629
2023-04-23 02:44:16,922 - Detection - ***** Epoch: 26: Eval results *****
2023-04-23 02:44:16,922 - Detection -   best_eval_score = 84.72
2023-04-23 02:44:16,922 - Detection -   eval_score = 84.0
2023-04-23 02:44:16,922 - Detection -   train_loss = 0.4835291039198637
2023-04-23 02:44:29,629 - Detection - ***** Epoch: 27: Eval results *****
2023-04-23 02:44:29,629 - Detection -   best_eval_score = 84.72
2023-04-23 02:44:29,629 - Detection -   eval_score = 83.99
2023-04-23 02:44:29,629 - Detection -   train_loss = 0.4653270933777094
2023-04-23 02:44:42,148 - Detection - ***** Epoch: 28: Eval results *****
2023-04-23 02:44:42,148 - Detection -   best_eval_score = 84.72
2023-04-23 02:44:42,148 - Detection -   eval_score = 84.24
2023-04-23 02:44:42,148 - Detection -   train_loss = 0.4527028053998947
2023-04-23 02:44:54,612 - Detection - ***** Epoch: 29: Eval results *****
2023-04-23 02:44:54,612 - Detection -   best_eval_score = 84.72
2023-04-23 02:44:54,612 - Detection -   eval_score = 84.53
2023-04-23 02:44:54,612 - Detection -   train_loss = 0.43710394762456417
2023-04-23 02:45:07,278 - Detection - ***** Epoch: 30: Eval results *****
2023-04-23 02:45:07,278 - Detection -   best_eval_score = 84.72
2023-04-23 02:45:07,278 - Detection -   eval_score = 84.33
2023-04-23 02:45:07,278 - Detection -   train_loss = 0.430993577465415
2023-04-23 02:45:19,797 - Detection - ***** Epoch: 31: Eval results *****
2023-04-23 02:45:19,797 - Detection -   best_eval_score = 84.72
2023-04-23 02:45:19,797 - Detection -   eval_score = 84.31
2023-04-23 02:45:19,797 - Detection -   train_loss = 0.4187433775514364
2023-04-23 02:45:32,456 - Detection - ***** Epoch: 32: Eval results *****
2023-04-23 02:45:32,457 - Detection -   best_eval_score = 84.72
2023-04-23 02:45:32,457 - Detection -   eval_score = 84.39
2023-04-23 02:45:32,457 - Detection -   train_loss = 0.41206628642976284
2023-04-23 02:45:32,457 - Detection - Pre-training finished...
2023-04-23 02:45:32,457 - Detection - Training Begin...
2023-04-23 02:45:34,459 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 02:45:34,459 - Detection -   best_eval_score = 0
2023-04-23 02:45:34,459 - Detection -   eval_score = 0.54
2023-04-23 02:45:34,459 - Detection -   train_loss = 4.840650141239166
2023-04-23 02:45:45,646 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 02:45:45,646 - Detection -   best_eval_score = 0.54
2023-04-23 02:45:45,646 - Detection -   eval_score = 74.83
2023-04-23 02:45:45,646 - Detection -   train_loss = 4.277315825223923
2023-04-23 02:45:56,933 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 02:45:56,933 - Detection -   best_eval_score = 74.83
2023-04-23 02:45:56,933 - Detection -   eval_score = 77.59
2023-04-23 02:45:56,933 - Detection -   train_loss = 1.2326596677303314
2023-04-23 02:46:08,111 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 02:46:08,112 - Detection -   best_eval_score = 77.59
2023-04-23 02:46:08,112 - Detection -   eval_score = 77.77
2023-04-23 02:46:08,112 - Detection -   train_loss = 1.1919346675276756
2023-04-23 02:46:19,407 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 02:46:19,407 - Detection -   best_eval_score = 77.77
2023-04-23 02:46:19,407 - Detection -   eval_score = 77.72
2023-04-23 02:46:19,407 - Detection -   train_loss = 1.190025296062231
2023-04-23 02:46:30,756 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 02:46:30,756 - Detection -   best_eval_score = 77.77
2023-04-23 02:46:30,756 - Detection -   eval_score = 77.59
2023-04-23 02:46:30,756 - Detection -   train_loss = 1.2013816758990288
2023-04-23 02:46:42,078 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 02:46:42,079 - Detection -   best_eval_score = 77.77
2023-04-23 02:46:42,079 - Detection -   eval_score = 77.4
2023-04-23 02:46:42,079 - Detection -   train_loss = 1.2298414334654808
2023-04-23 02:46:53,444 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 02:46:53,444 - Detection -   best_eval_score = 77.77
2023-04-23 02:46:53,444 - Detection -   eval_score = 77.54
2023-04-23 02:46:53,444 - Detection -   train_loss = 1.2146583013236523
2023-04-23 02:47:04,613 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 02:47:04,613 - Detection -   best_eval_score = 77.77
2023-04-23 02:47:04,613 - Detection -   eval_score = 77.66
2023-04-23 02:47:04,613 - Detection -   train_loss = 1.1928419917821884
2023-04-23 02:47:15,928 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 02:47:15,928 - Detection -   best_eval_score = 77.77
2023-04-23 02:47:15,928 - Detection -   eval_score = 77.48
2023-04-23 02:47:15,928 - Detection -   train_loss = 1.1914469823241234
2023-04-23 02:47:27,077 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 02:47:27,078 - Detection -   best_eval_score = 77.77
2023-04-23 02:47:27,078 - Detection -   eval_score = 77.7
2023-04-23 02:47:27,078 - Detection -   train_loss = 1.2230994626879692
2023-04-23 02:47:38,386 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 02:47:38,387 - Detection -   best_eval_score = 77.77
2023-04-23 02:47:38,387 - Detection -   eval_score = 77.72
2023-04-23 02:47:38,387 - Detection -   train_loss = 1.1734458394348621
2023-04-23 02:47:49,691 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 02:47:49,691 - Detection -   best_eval_score = 77.77
2023-04-23 02:47:49,691 - Detection -   eval_score = 77.77
2023-04-23 02:47:49,692 - Detection -   train_loss = 1.1900851801037788
2023-04-23 02:48:00,962 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 02:48:00,962 - Detection -   best_eval_score = 77.77
2023-04-23 02:48:00,962 - Detection -   eval_score = 77.39
2023-04-23 02:48:00,962 - Detection -   train_loss = 1.1976867318153381
2023-04-23 02:48:00,962 - Detection - Training Finished...
2023-04-23 02:48:00,962 - Detection - Testing begin...
2023-04-23 02:48:02,714 - Detection - ***** Test: Confusion Matrix *****
2023-04-23 02:48:02,714 - Detection - [[ 87   0   0   0   1   0   0   0   0   0   0   0   0   0   1  50]
 [  0  92   0   0   0   0   0   0   0   0   0   0   0   0   0  48]
 [  0   0 110   0   0   2   0   0   0   0   0   1   0   0   0  36]
 [  0   0   0 111   0   1   0   0   0   0   0   1   0   0   0  24]
 [  0   1   1   0  80   1   0   0   2   0   0   0   0   0   0 108]
 [  1   0   1   1   0  94   0   0   0   0   0   2   0   0   0  71]
 [  0   0   0   0   0   1  93   0   0   0   0   0   0   0   0  33]
 [  1   0   0   0   2   0   0 133   0   0   0   0   0   0   0  28]
 [  0   0   0   0   0   0   0   0 155   0   0   0   0   0   0  17]
 [  0   0   0   0   1   0   0   0   0  36   0   0   0   0   1  68]
 [  0   0   0   0   0   0   1   0   0   0  85   0   0   0   0  42]
 [  0   0   0   0   0   1   0   0   0   0   0 103   0   0   0  24]
 [  0   0   0   0   0   0   0   0   0   0   0   0 105   0   0  26]
 [  0   0   0   0   0   0   0   0   1   0   0   0   0 106   0  25]
 [  0   0   0   2   0   1   0   0   0   0   1   0   0   0 118  38]
 [  1   3   0   2  79   4   2   1   3   3  15   0   0   0   2 614]]
2023-04-23 02:48:02,714 - Detection - ***** Test results *****
2023-04-23 02:48:02,714 - Detection -   Acc = 73.05
2023-04-23 02:48:02,715 - Detection -   F1 = 77.5215
2023-04-23 02:48:02,715 - Detection -   F1-known = 78.557
2023-04-23 02:48:02,715 - Detection -   F1-open = 61.9889
2023-04-23 02:48:02,715 - Detection - Testing finished...
2023-04-23 02:48:02,715 - Detection - Results saved in results/results_DA-ADB-BOOST-F-4.csv
2023-04-23 02:48:02,734 - Detection - Open Intent Detection Finished...
