2023-04-20 19:55:36,624 - Detection - Open Intent Detection Begin...
2023-04-20 19:55:36,625 - Detection - Parameters Initialization...
2023-04-20 19:55:36,625 - Detection - ============================== Params ==============================
2023-04-20 19:55:36,625 - Detection - type:	open_intent_detection
2023-04-20 19:55:36,625 - Detection - logger_name:	Detection
2023-04-20 19:55:36,625 - Detection - log_dir:	logs
2023-04-20 19:55:36,625 - Detection - dataset:	stackoverflow_cg
2023-04-20 19:55:36,625 - Detection - known_cls_ratio:	0.5
2023-04-20 19:55:36,625 - Detection - labeled_ratio:	1.0
2023-04-20 19:55:36,625 - Detection - method:	ADB
2023-04-20 19:55:36,625 - Detection - train:	True
2023-04-20 19:55:36,625 - Detection - pretrain:	True
2023-04-20 19:55:36,625 - Detection - save_model:	True
2023-04-20 19:55:36,625 - Detection - backbone:	bert
2023-04-20 19:55:36,625 - Detection - config_file_name:	ADB
2023-04-20 19:55:36,625 - Detection - seed:	5
2023-04-20 19:55:36,625 - Detection - gpu_id:	0
2023-04-20 19:55:36,625 - Detection - pipe_results_path:	pipe_results
2023-04-20 19:55:36,625 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-20 19:55:36,625 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-20 19:55:36,625 - Detection - model_dir:	models
2023-04-20 19:55:36,625 - Detection - load_pretrained_method:	None
2023-04-20 19:55:36,625 - Detection - result_dir:	results
2023-04-20 19:55:36,625 - Detection - results_file_name:	results_ADB.csv
2023-04-20 19:55:36,625 - Detection - save_results:	True
2023-04-20 19:55:36,625 - Detection - loss_fct:	CrossEntropyLoss
2023-04-20 19:55:36,625 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.5_1.0_bert_5
2023-04-20 19:55:36,625 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.5_1.0_bert_5/models
2023-04-20 19:55:36,625 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-20 19:55:36,625 - Detection - num_train_epochs:	100
2023-04-20 19:55:36,625 - Detection - num_labels:	None
2023-04-20 19:55:36,625 - Detection - max_seq_length:	None
2023-04-20 19:55:36,625 - Detection - freeze_backbone_parameters:	True
2023-04-20 19:55:36,625 - Detection - feat_dim:	768
2023-04-20 19:55:36,625 - Detection - warmup_proportion:	0.1
2023-04-20 19:55:36,625 - Detection - lr_boundary:	0.05
2023-04-20 19:55:36,625 - Detection - lr:	2e-05
2023-04-20 19:55:36,625 - Detection - activation:	relu
2023-04-20 19:55:36,625 - Detection - train_batch_size:	128
2023-04-20 19:55:36,626 - Detection - eval_batch_size:	64
2023-04-20 19:55:36,626 - Detection - test_batch_size:	64
2023-04-20 19:55:36,626 - Detection - wait_patient:	10
2023-04-20 19:55:36,626 - Detection - ============================== End Params ==============================
2023-04-20 19:55:36,626 - Detection - Data and Model Preparation...
2023-04-20 19:55:36,626 - Detection - The number of known intents is 10
2023-04-20 19:55:36,626 - Detection - Lists of known labels are: ['bash', 'excel', 'svn', 'wordpress', 'osx', 'apache', 'oracle', 'matlab', 'qt', 'visual-studio']
2023-04-20 19:55:36,634 - Detection - Number of labeled training samples = 1366
2023-04-20 19:55:36,634 - Detection - Number of unlabeled training samples = 1425
2023-04-20 19:55:36,637 - Detection - Number of evaluation samples = 715
2023-04-20 19:55:36,642 - Detection - Number of testing samples = 2905
2023-04-20 19:55:40,608 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-20 19:55:42,276 - Detection - Pre-training Begin...
2023-04-20 19:55:44,704 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 19:55:44,704 - Detection -   best_eval_score = 0
2023-04-20 19:55:44,704 - Detection -   eval_score = 9.65
2023-04-20 19:55:44,704 - Detection -   train_loss = 2.299378980289806
2023-04-20 19:55:46,650 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 19:55:46,650 - Detection -   best_eval_score = 9.65
2023-04-20 19:55:46,650 - Detection -   eval_score = 5.87
2023-04-20 19:55:46,650 - Detection -   train_loss = 2.283777128566395
2023-04-20 19:55:48,580 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 19:55:48,580 - Detection -   best_eval_score = 9.65
2023-04-20 19:55:48,580 - Detection -   eval_score = 6.15
2023-04-20 19:55:48,580 - Detection -   train_loss = 2.2531058354811235
2023-04-20 19:55:50,512 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 19:55:50,512 - Detection -   best_eval_score = 9.65
2023-04-20 19:55:50,512 - Detection -   eval_score = 7.69
2023-04-20 19:55:50,512 - Detection -   train_loss = 2.206555041399869
2023-04-20 19:55:52,450 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 19:55:52,450 - Detection -   best_eval_score = 9.65
2023-04-20 19:55:52,450 - Detection -   eval_score = 20.42
2023-04-20 19:55:52,450 - Detection -   train_loss = 2.124815355647694
2023-04-20 19:55:54,396 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 19:55:54,396 - Detection -   best_eval_score = 20.42
2023-04-20 19:55:54,396 - Detection -   eval_score = 40.0
2023-04-20 19:55:54,396 - Detection -   train_loss = 1.976772048256614
2023-04-20 19:55:56,341 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 19:55:56,341 - Detection -   best_eval_score = 40.0
2023-04-20 19:55:56,341 - Detection -   eval_score = 59.16
2023-04-20 19:55:56,341 - Detection -   train_loss = 1.7177272276444868
2023-04-20 19:55:58,287 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 19:55:58,288 - Detection -   best_eval_score = 59.16
2023-04-20 19:55:58,288 - Detection -   eval_score = 71.47
2023-04-20 19:55:58,288 - Detection -   train_loss = 1.3913842764767734
2023-04-20 19:56:00,241 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 19:56:00,241 - Detection -   best_eval_score = 71.47
2023-04-20 19:56:00,241 - Detection -   eval_score = 77.34
2023-04-20 19:56:00,241 - Detection -   train_loss = 1.0779357877644626
2023-04-20 19:56:02,194 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 19:56:02,194 - Detection -   best_eval_score = 77.34
2023-04-20 19:56:02,194 - Detection -   eval_score = 80.28
2023-04-20 19:56:02,194 - Detection -   train_loss = 0.8685699267820879
2023-04-20 19:56:04,150 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 19:56:04,150 - Detection -   best_eval_score = 80.28
2023-04-20 19:56:04,150 - Detection -   eval_score = 80.7
2023-04-20 19:56:04,150 - Detection -   train_loss = 0.7283244512297891
2023-04-20 19:56:06,217 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 19:56:06,217 - Detection -   best_eval_score = 80.7
2023-04-20 19:56:06,217 - Detection -   eval_score = 81.54
2023-04-20 19:56:06,217 - Detection -   train_loss = 0.6508728265762329
2023-04-20 19:56:08,179 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 19:56:08,179 - Detection -   best_eval_score = 81.54
2023-04-20 19:56:08,179 - Detection -   eval_score = 80.42
2023-04-20 19:56:08,179 - Detection -   train_loss = 0.592650828036395
2023-04-20 19:56:10,140 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 19:56:10,140 - Detection -   best_eval_score = 81.54
2023-04-20 19:56:10,140 - Detection -   eval_score = 82.38
2023-04-20 19:56:10,140 - Detection -   train_loss = 0.5471648194573142
2023-04-20 19:56:12,128 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 19:56:12,128 - Detection -   best_eval_score = 82.38
2023-04-20 19:56:12,128 - Detection -   eval_score = 82.38
2023-04-20 19:56:12,128 - Detection -   train_loss = 0.48508901487697254
2023-04-20 19:56:14,109 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 19:56:14,109 - Detection -   best_eval_score = 82.38
2023-04-20 19:56:14,109 - Detection -   eval_score = 83.22
2023-04-20 19:56:14,109 - Detection -   train_loss = 0.46172255819494074
2023-04-20 19:56:16,109 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 19:56:16,109 - Detection -   best_eval_score = 83.22
2023-04-20 19:56:16,109 - Detection -   eval_score = 82.8
2023-04-20 19:56:16,109 - Detection -   train_loss = 0.4272726367820393
2023-04-20 19:56:18,109 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 19:56:18,110 - Detection -   best_eval_score = 83.22
2023-04-20 19:56:18,110 - Detection -   eval_score = 83.08
2023-04-20 19:56:18,110 - Detection -   train_loss = 0.39932551167228003
2023-04-20 19:56:20,115 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 19:56:20,115 - Detection -   best_eval_score = 83.22
2023-04-20 19:56:20,115 - Detection -   eval_score = 83.78
2023-04-20 19:56:20,115 - Detection -   train_loss = 0.3702617585659027
2023-04-20 19:56:22,133 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 19:56:22,133 - Detection -   best_eval_score = 83.78
2023-04-20 19:56:22,133 - Detection -   eval_score = 83.22
2023-04-20 19:56:22,133 - Detection -   train_loss = 0.3427071354605935
2023-04-20 19:56:24,144 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 19:56:24,145 - Detection -   best_eval_score = 83.78
2023-04-20 19:56:24,145 - Detection -   eval_score = 83.78
2023-04-20 19:56:24,145 - Detection -   train_loss = 0.32182210412892426
2023-04-20 19:56:26,164 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 19:56:26,164 - Detection -   best_eval_score = 83.78
2023-04-20 19:56:26,164 - Detection -   eval_score = 83.5
2023-04-20 19:56:26,164 - Detection -   train_loss = 0.2910069647160443
2023-04-20 19:56:28,192 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 19:56:28,192 - Detection -   best_eval_score = 83.78
2023-04-20 19:56:28,192 - Detection -   eval_score = 83.64
2023-04-20 19:56:28,192 - Detection -   train_loss = 0.2803167592395436
2023-04-20 19:56:30,230 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 19:56:30,230 - Detection -   best_eval_score = 83.78
2023-04-20 19:56:30,230 - Detection -   eval_score = 83.36
2023-04-20 19:56:30,230 - Detection -   train_loss = 0.24992070685733447
2023-04-20 19:56:32,327 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 19:56:32,328 - Detection -   best_eval_score = 83.78
2023-04-20 19:56:32,328 - Detection -   eval_score = 83.64
2023-04-20 19:56:32,328 - Detection -   train_loss = 0.23016032712026077
2023-04-20 19:56:34,423 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 19:56:34,424 - Detection -   best_eval_score = 83.78
2023-04-20 19:56:34,424 - Detection -   eval_score = 83.64
2023-04-20 19:56:34,424 - Detection -   train_loss = 0.22995827008377423
2023-04-20 19:56:36,465 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 19:56:36,465 - Detection -   best_eval_score = 83.78
2023-04-20 19:56:36,465 - Detection -   eval_score = 83.78
2023-04-20 19:56:36,465 - Detection -   train_loss = 0.21505841477350754
2023-04-20 19:56:38,497 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 19:56:38,497 - Detection -   best_eval_score = 83.78
2023-04-20 19:56:38,497 - Detection -   eval_score = 83.5
2023-04-20 19:56:38,497 - Detection -   train_loss = 0.19578787007115103
2023-04-20 19:56:40,525 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 19:56:40,525 - Detection -   best_eval_score = 83.78
2023-04-20 19:56:40,525 - Detection -   eval_score = 83.78
2023-04-20 19:56:40,525 - Detection -   train_loss = 0.17414665628563275
2023-04-20 19:56:40,525 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.5_1.0_bert_5/models
2023-04-20 19:56:41,063 - Detection - Pre-training finished...
2023-04-20 19:56:41,063 - Detection - Training Begin...
2023-04-20 19:56:44,292 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 19:56:44,292 - Detection -   best_eval_score = 0
2023-04-20 19:56:44,292 - Detection -   eval_score = 0.0
2023-04-20 19:56:44,292 - Detection -   train_loss = 7.741033120588823
2023-04-20 19:56:46,319 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 19:56:46,319 - Detection -   best_eval_score = 0
2023-04-20 19:56:46,319 - Detection -   eval_score = 0.0
2023-04-20 19:56:46,319 - Detection -   train_loss = 7.356513500213623
2023-04-20 19:56:48,350 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 19:56:48,350 - Detection -   best_eval_score = 0
2023-04-20 19:56:48,350 - Detection -   eval_score = 0.0
2023-04-20 19:56:48,350 - Detection -   train_loss = 6.91421331058849
2023-04-20 19:56:50,364 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 19:56:50,364 - Detection -   best_eval_score = 0
2023-04-20 19:56:50,364 - Detection -   eval_score = 0.0
2023-04-20 19:56:50,364 - Detection -   train_loss = 6.40127420425415
2023-04-20 19:56:52,401 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 19:56:52,401 - Detection -   best_eval_score = 0
2023-04-20 19:56:52,401 - Detection -   eval_score = 2.38
2023-04-20 19:56:52,401 - Detection -   train_loss = 5.879640405828303
2023-04-20 19:56:54,413 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 19:56:54,413 - Detection -   best_eval_score = 2.38
2023-04-20 19:56:54,413 - Detection -   eval_score = 7.76
2023-04-20 19:56:54,413 - Detection -   train_loss = 5.296616510911421
2023-04-20 19:56:56,467 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 19:56:56,467 - Detection -   best_eval_score = 7.76
2023-04-20 19:56:56,467 - Detection -   eval_score = 15.08
2023-04-20 19:56:56,467 - Detection -   train_loss = 4.714497306130149
2023-04-20 19:56:58,493 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 19:56:58,493 - Detection -   best_eval_score = 15.08
2023-04-20 19:56:58,493 - Detection -   eval_score = 33.66
2023-04-20 19:56:58,493 - Detection -   train_loss = 4.0797320712696425
2023-04-20 19:57:00,493 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 19:57:00,493 - Detection -   best_eval_score = 33.66
2023-04-20 19:57:00,493 - Detection -   eval_score = 53.49
2023-04-20 19:57:00,493 - Detection -   train_loss = 3.507832071997903
2023-04-20 19:57:02,481 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 19:57:02,481 - Detection -   best_eval_score = 53.49
2023-04-20 19:57:02,481 - Detection -   eval_score = 65.76
2023-04-20 19:57:02,481 - Detection -   train_loss = 2.9398341178894043
2023-04-20 19:57:04,476 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 19:57:04,476 - Detection -   best_eval_score = 65.76
2023-04-20 19:57:04,476 - Detection -   eval_score = 71.36
2023-04-20 19:57:04,476 - Detection -   train_loss = 2.3352902802554043
2023-04-20 19:57:06,480 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 19:57:06,480 - Detection -   best_eval_score = 71.36
2023-04-20 19:57:06,480 - Detection -   eval_score = 73.8
2023-04-20 19:57:06,480 - Detection -   train_loss = 1.92009990865534
2023-04-20 19:57:08,492 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 19:57:08,492 - Detection -   best_eval_score = 73.8
2023-04-20 19:57:08,492 - Detection -   eval_score = 74.85
2023-04-20 19:57:08,492 - Detection -   train_loss = 1.5758260596882214
2023-04-20 19:57:10,543 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 19:57:10,543 - Detection -   best_eval_score = 74.85
2023-04-20 19:57:10,543 - Detection -   eval_score = 75.37
2023-04-20 19:57:10,543 - Detection -   train_loss = 1.5325355638157239
2023-04-20 19:57:12,573 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 19:57:12,573 - Detection -   best_eval_score = 75.37
2023-04-20 19:57:12,573 - Detection -   eval_score = 75.53
2023-04-20 19:57:12,573 - Detection -   train_loss = 1.4654188806360418
2023-04-20 19:57:14,566 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 19:57:14,566 - Detection -   best_eval_score = 75.53
2023-04-20 19:57:14,566 - Detection -   eval_score = 75.48
2023-04-20 19:57:14,566 - Detection -   train_loss = 1.4441882480274548
2023-04-20 19:57:16,556 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 19:57:16,556 - Detection -   best_eval_score = 75.53
2023-04-20 19:57:16,556 - Detection -   eval_score = 75.44
2023-04-20 19:57:16,556 - Detection -   train_loss = 1.4824720512736926
2023-04-20 19:57:18,551 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 19:57:18,551 - Detection -   best_eval_score = 75.53
2023-04-20 19:57:18,552 - Detection -   eval_score = 75.47
2023-04-20 19:57:18,552 - Detection -   train_loss = 1.4446396936069836
2023-04-20 19:57:20,546 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 19:57:20,546 - Detection -   best_eval_score = 75.53
2023-04-20 19:57:20,546 - Detection -   eval_score = 75.38
2023-04-20 19:57:20,546 - Detection -   train_loss = 1.463087417862632
2023-04-20 19:57:22,550 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 19:57:22,550 - Detection -   best_eval_score = 75.53
2023-04-20 19:57:22,550 - Detection -   eval_score = 75.35
2023-04-20 19:57:22,550 - Detection -   train_loss = 1.4479815634814175
2023-04-20 19:57:24,553 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 19:57:24,553 - Detection -   best_eval_score = 75.53
2023-04-20 19:57:24,553 - Detection -   eval_score = 75.35
2023-04-20 19:57:24,553 - Detection -   train_loss = 1.437099120833657
2023-04-20 19:57:26,557 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 19:57:26,557 - Detection -   best_eval_score = 75.53
2023-04-20 19:57:26,557 - Detection -   eval_score = 75.4
2023-04-20 19:57:26,557 - Detection -   train_loss = 1.4651775034991177
2023-04-20 19:57:28,558 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 19:57:28,558 - Detection -   best_eval_score = 75.53
2023-04-20 19:57:28,558 - Detection -   eval_score = 75.4
2023-04-20 19:57:28,558 - Detection -   train_loss = 1.449524771083485
2023-04-20 19:57:30,560 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 19:57:30,560 - Detection -   best_eval_score = 75.53
2023-04-20 19:57:30,560 - Detection -   eval_score = 75.44
2023-04-20 19:57:30,560 - Detection -   train_loss = 1.458614240993153
2023-04-20 19:57:32,559 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 19:57:32,560 - Detection -   best_eval_score = 75.53
2023-04-20 19:57:32,560 - Detection -   eval_score = 75.44
2023-04-20 19:57:32,560 - Detection -   train_loss = 1.4640883749181575
2023-04-20 19:57:32,561 - Detection - Training Finished...
2023-04-20 19:57:32,561 - Detection - Testing begin...
2023-04-20 19:57:35,148 - Detection - ***** Test: Confusion Matrix *****
2023-04-20 19:57:35,148 - Detection - [[  84    1    0    1    5    1    0    1    0    0   46]
 [   0   90    0    0    3    0    0    0    0    0   47]
 [   0    0  111    0    0    1    1    0    0    2   34]
 [   1    0    0  111    0    2    0    0    0    0   23]
 [   0    1    0    0  145    3    1    0    2    0   41]
 [   2    0    2    1    0  103    0    0    0    0   62]
 [   0    1    0    0    1    1  103    0    0    0   21]
 [   0    0    0    0    2    0    0  135    0    0   27]
 [   1    0    0    0    0    0    0    0  154    0   17]
 [   0    0    1    0    5    1    2    0    0   38   59]
 [   5   12    5    3  134   57   41    6    4    7 1134]]
2023-04-20 19:57:35,148 - Detection - ***** Test results *****
2023-04-20 19:57:35,148 - Detection -   Acc = 76.01
2023-04-20 19:57:35,148 - Detection -   F1 = 74.5405
2023-04-20 19:57:35,148 - Detection -   F1-known = 74.2248
2023-04-20 19:57:35,148 - Detection -   F1-open = 77.6978
2023-04-20 19:57:35,148 - Detection - Testing finished...
2023-04-20 19:57:35,148 - Detection - Results saved in results/results_ADB.csv
2023-04-20 19:57:35,168 - Detection - Open Intent Detection Finished...
