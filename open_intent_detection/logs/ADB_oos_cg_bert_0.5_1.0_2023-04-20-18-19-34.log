2023-04-20 18:19:34,773 - Detection - Open Intent Detection Begin...
2023-04-20 18:19:34,773 - Detection - Parameters Initialization...
2023-04-20 18:19:34,773 - Detection - ============================== Params ==============================
2023-04-20 18:19:34,773 - Detection - type:	open_intent_detection
2023-04-20 18:19:34,773 - Detection - logger_name:	Detection
2023-04-20 18:19:34,773 - Detection - log_dir:	logs
2023-04-20 18:19:34,773 - Detection - dataset:	oos_cg
2023-04-20 18:19:34,773 - Detection - known_cls_ratio:	0.5
2023-04-20 18:19:34,773 - Detection - labeled_ratio:	1.0
2023-04-20 18:19:34,773 - Detection - method:	ADB
2023-04-20 18:19:34,773 - Detection - train:	True
2023-04-20 18:19:34,773 - Detection - pretrain:	True
2023-04-20 18:19:34,773 - Detection - save_model:	True
2023-04-20 18:19:34,773 - Detection - backbone:	bert
2023-04-20 18:19:34,773 - Detection - config_file_name:	ADB
2023-04-20 18:19:34,773 - Detection - seed:	7
2023-04-20 18:19:34,774 - Detection - gpu_id:	0
2023-04-20 18:19:34,774 - Detection - pipe_results_path:	pipe_results
2023-04-20 18:19:34,774 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-20 18:19:34,774 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-20 18:19:34,774 - Detection - model_dir:	models
2023-04-20 18:19:34,774 - Detection - load_pretrained_method:	None
2023-04-20 18:19:34,774 - Detection - result_dir:	results
2023-04-20 18:19:34,774 - Detection - results_file_name:	results_ADB.csv
2023-04-20 18:19:34,774 - Detection - save_results:	True
2023-04-20 18:19:34,774 - Detection - loss_fct:	CrossEntropyLoss
2023-04-20 18:19:34,774 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_cg_0.5_1.0_bert_7
2023-04-20 18:19:34,774 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_cg_0.5_1.0_bert_7/models
2023-04-20 18:19:34,774 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-20 18:19:34,774 - Detection - num_train_epochs:	100
2023-04-20 18:19:34,774 - Detection - num_labels:	None
2023-04-20 18:19:34,774 - Detection - max_seq_length:	None
2023-04-20 18:19:34,774 - Detection - freeze_backbone_parameters:	True
2023-04-20 18:19:34,774 - Detection - feat_dim:	768
2023-04-20 18:19:34,774 - Detection - warmup_proportion:	0.1
2023-04-20 18:19:34,774 - Detection - lr_boundary:	0.05
2023-04-20 18:19:34,774 - Detection - lr:	2e-05
2023-04-20 18:19:34,774 - Detection - activation:	relu
2023-04-20 18:19:34,774 - Detection - train_batch_size:	128
2023-04-20 18:19:34,774 - Detection - eval_batch_size:	64
2023-04-20 18:19:34,774 - Detection - test_batch_size:	64
2023-04-20 18:19:34,774 - Detection - wait_patient:	10
2023-04-20 18:19:34,774 - Detection - ============================== End Params ==============================
2023-04-20 18:19:34,774 - Detection - Data and Model Preparation...
2023-04-20 18:19:34,775 - Detection - The number of known intents is 75
2023-04-20 18:19:34,775 - Detection - Lists of known labels are: ['yes', 'payday', 'expiration_date', 'maybe', 'rollover_401k', 'find_phone', 'how_old_are_you', 'reminder', 'calculator', 'how_busy', 'nutrition_info', 'pin_change', 'damaged_card', 'schedule_meeting', 'credit_limit', 'meeting_schedule', 'schedule_maintenance', 'user_name', 'fun_fact', 'distance', 'order_status', 'thank_you', 'last_maintenance', 'text', 'transactions', 'vaccines', 'replacement_card_duration', 'order', 'restaurant_reservation', 'weather', 'todo_list', 'oil_change_when', 'change_language', 'w2', 'next_holiday', 'freeze_account', 'directions', 'are_you_a_bot', 'car_rental', 'restaurant_reviews', 'tire_change', 'no', 'travel_alert', 'sync_device', 'reminder_update', 'goodbye', 'make_call', 'jump_start', 'shopping_list', 'credit_limit_change', 'application_status', 'exchange_rate', 'taxes', 'calendar_update', 'reset_settings', 'order_checks', 'international_fees', 'income', 'confirm_reservation', 'bill_due', 'flip_coin', 'play_music', 'routing', 'pto_request_status', 'interest_rate', 'cancel', 'tire_pressure', 'change_accent', 'calories', 'travel_suggestion', 'smart_home', 'calendar', 'rewards_balance', 'gas', 'insurance_change']
2023-04-20 18:19:34,787 - Detection - Number of labeled training samples = 1904
2023-04-20 18:19:34,787 - Detection - Number of unlabeled training samples = 1779
2023-04-20 18:19:34,791 - Detection - Number of evaluation samples = 849
2023-04-20 18:19:34,800 - Detection - Number of testing samples = 3632
2023-04-20 18:19:38,847 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-20 18:19:40,513 - Detection - Pre-training Begin...
2023-04-20 18:19:42,884 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 18:19:42,884 - Detection -   best_eval_score = 0
2023-04-20 18:19:42,884 - Detection -   eval_score = 2.47
2023-04-20 18:19:42,884 - Detection -   train_loss = 4.322384707132975
2023-04-20 18:19:44,677 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 18:19:44,677 - Detection -   best_eval_score = 2.47
2023-04-20 18:19:44,677 - Detection -   eval_score = 4.0
2023-04-20 18:19:44,677 - Detection -   train_loss = 4.302252070109049
2023-04-20 18:19:46,485 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 18:19:46,485 - Detection -   best_eval_score = 4.0
2023-04-20 18:19:46,486 - Detection -   eval_score = 7.07
2023-04-20 18:19:46,486 - Detection -   train_loss = 4.264063358306885
2023-04-20 18:19:48,289 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 18:19:48,289 - Detection -   best_eval_score = 7.07
2023-04-20 18:19:48,289 - Detection -   eval_score = 10.13
2023-04-20 18:19:48,289 - Detection -   train_loss = 4.202506192525228
2023-04-20 18:19:50,097 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 18:19:50,097 - Detection -   best_eval_score = 10.13
2023-04-20 18:19:50,097 - Detection -   eval_score = 10.6
2023-04-20 18:19:50,097 - Detection -   train_loss = 4.096266651153565
2023-04-20 18:19:52,018 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 18:19:52,018 - Detection -   best_eval_score = 10.6
2023-04-20 18:19:52,018 - Detection -   eval_score = 10.72
2023-04-20 18:19:52,018 - Detection -   train_loss = 3.900983969370524
2023-04-20 18:19:53,846 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 18:19:53,846 - Detection -   best_eval_score = 10.72
2023-04-20 18:19:53,846 - Detection -   eval_score = 13.43
2023-04-20 18:19:53,846 - Detection -   train_loss = 3.561494016647339
2023-04-20 18:19:55,669 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 18:19:55,669 - Detection -   best_eval_score = 13.43
2023-04-20 18:19:55,669 - Detection -   eval_score = 17.31
2023-04-20 18:19:55,669 - Detection -   train_loss = 3.1059960683186847
2023-04-20 18:19:57,508 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 18:19:57,508 - Detection -   best_eval_score = 17.31
2023-04-20 18:19:57,508 - Detection -   eval_score = 21.91
2023-04-20 18:19:57,508 - Detection -   train_loss = 2.623135201136271
2023-04-20 18:19:59,362 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 18:19:59,362 - Detection -   best_eval_score = 21.91
2023-04-20 18:19:59,362 - Detection -   eval_score = 28.39
2023-04-20 18:19:59,362 - Detection -   train_loss = 2.1671228249867758
2023-04-20 18:20:01,236 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 18:20:01,236 - Detection -   best_eval_score = 28.39
2023-04-20 18:20:01,236 - Detection -   eval_score = 38.52
2023-04-20 18:20:01,236 - Detection -   train_loss = 1.7811744292577107
2023-04-20 18:20:03,120 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 18:20:03,121 - Detection -   best_eval_score = 38.52
2023-04-20 18:20:03,121 - Detection -   eval_score = 45.7
2023-04-20 18:20:03,121 - Detection -   train_loss = 1.4642058531443278
2023-04-20 18:20:05,011 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 18:20:05,011 - Detection -   best_eval_score = 45.7
2023-04-20 18:20:05,011 - Detection -   eval_score = 51.0
2023-04-20 18:20:05,011 - Detection -   train_loss = 1.2183801174163817
2023-04-20 18:20:06,915 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 18:20:06,915 - Detection -   best_eval_score = 51.0
2023-04-20 18:20:06,916 - Detection -   eval_score = 54.89
2023-04-20 18:20:06,916 - Detection -   train_loss = 1.0316294749577841
2023-04-20 18:20:08,819 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 18:20:08,819 - Detection -   best_eval_score = 54.89
2023-04-20 18:20:08,819 - Detection -   eval_score = 57.13
2023-04-20 18:20:08,819 - Detection -   train_loss = 0.8867438634236654
2023-04-20 18:20:10,743 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 18:20:10,743 - Detection -   best_eval_score = 57.13
2023-04-20 18:20:10,743 - Detection -   eval_score = 58.54
2023-04-20 18:20:10,743 - Detection -   train_loss = 0.7588765462239583
2023-04-20 18:20:12,666 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 18:20:12,666 - Detection -   best_eval_score = 58.54
2023-04-20 18:20:12,667 - Detection -   eval_score = 60.07
2023-04-20 18:20:12,667 - Detection -   train_loss = 0.6635108272234599
2023-04-20 18:20:14,598 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 18:20:14,598 - Detection -   best_eval_score = 60.07
2023-04-20 18:20:14,598 - Detection -   eval_score = 63.25
2023-04-20 18:20:14,598 - Detection -   train_loss = 0.5836297353108724
2023-04-20 18:20:16,534 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 18:20:16,534 - Detection -   best_eval_score = 63.25
2023-04-20 18:20:16,534 - Detection -   eval_score = 63.72
2023-04-20 18:20:16,534 - Detection -   train_loss = 0.5216304858525594
2023-04-20 18:20:18,480 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 18:20:18,480 - Detection -   best_eval_score = 63.72
2023-04-20 18:20:18,480 - Detection -   eval_score = 66.55
2023-04-20 18:20:18,480 - Detection -   train_loss = 0.46330291628837583
2023-04-20 18:20:20,423 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 18:20:20,423 - Detection -   best_eval_score = 66.55
2023-04-20 18:20:20,423 - Detection -   eval_score = 66.31
2023-04-20 18:20:20,423 - Detection -   train_loss = 0.42448853254318236
2023-04-20 18:20:22,349 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 18:20:22,349 - Detection -   best_eval_score = 66.55
2023-04-20 18:20:22,349 - Detection -   eval_score = 67.96
2023-04-20 18:20:22,349 - Detection -   train_loss = 0.3944051722685496
2023-04-20 18:20:24,285 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 18:20:24,285 - Detection -   best_eval_score = 67.96
2023-04-20 18:20:24,285 - Detection -   eval_score = 69.14
2023-04-20 18:20:24,285 - Detection -   train_loss = 0.35281306703885396
2023-04-20 18:20:26,225 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 18:20:26,225 - Detection -   best_eval_score = 69.14
2023-04-20 18:20:26,225 - Detection -   eval_score = 68.79
2023-04-20 18:20:26,225 - Detection -   train_loss = 0.3239737113316854
2023-04-20 18:20:28,165 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 18:20:28,165 - Detection -   best_eval_score = 69.14
2023-04-20 18:20:28,165 - Detection -   eval_score = 70.55
2023-04-20 18:20:28,165 - Detection -   train_loss = 0.29569074710210164
2023-04-20 18:20:30,111 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 18:20:30,111 - Detection -   best_eval_score = 70.55
2023-04-20 18:20:30,111 - Detection -   eval_score = 71.14
2023-04-20 18:20:30,111 - Detection -   train_loss = 0.27979087034861244
2023-04-20 18:20:32,050 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 18:20:32,050 - Detection -   best_eval_score = 71.14
2023-04-20 18:20:32,051 - Detection -   eval_score = 71.85
2023-04-20 18:20:32,051 - Detection -   train_loss = 0.26050570209821067
2023-04-20 18:20:34,000 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 18:20:34,000 - Detection -   best_eval_score = 71.85
2023-04-20 18:20:34,000 - Detection -   eval_score = 72.44
2023-04-20 18:20:34,000 - Detection -   train_loss = 0.24433449606100718
2023-04-20 18:20:35,942 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 18:20:35,942 - Detection -   best_eval_score = 72.44
2023-04-20 18:20:35,942 - Detection -   eval_score = 72.32
2023-04-20 18:20:35,942 - Detection -   train_loss = 0.22811284065246581
2023-04-20 18:20:37,860 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 18:20:37,860 - Detection -   best_eval_score = 72.44
2023-04-20 18:20:37,860 - Detection -   eval_score = 73.38
2023-04-20 18:20:37,860 - Detection -   train_loss = 0.20805091957251232
2023-04-20 18:20:39,918 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 18:20:39,918 - Detection -   best_eval_score = 73.38
2023-04-20 18:20:39,918 - Detection -   eval_score = 72.44
2023-04-20 18:20:39,918 - Detection -   train_loss = 0.2039937525987625
2023-04-20 18:20:41,838 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 18:20:41,838 - Detection -   best_eval_score = 73.38
2023-04-20 18:20:41,838 - Detection -   eval_score = 73.14
2023-04-20 18:20:41,838 - Detection -   train_loss = 0.18629408876101175
2023-04-20 18:20:43,774 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 18:20:43,774 - Detection -   best_eval_score = 73.38
2023-04-20 18:20:43,774 - Detection -   eval_score = 74.2
2023-04-20 18:20:43,774 - Detection -   train_loss = 0.17868580122788746
2023-04-20 18:20:45,719 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 18:20:45,719 - Detection -   best_eval_score = 74.2
2023-04-20 18:20:45,719 - Detection -   eval_score = 73.85
2023-04-20 18:20:45,719 - Detection -   train_loss = 0.1665713369846344
2023-04-20 18:20:47,666 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 18:20:47,666 - Detection -   best_eval_score = 74.2
2023-04-20 18:20:47,666 - Detection -   eval_score = 74.56
2023-04-20 18:20:47,666 - Detection -   train_loss = 0.16188895603020986
2023-04-20 18:20:49,663 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 18:20:49,663 - Detection -   best_eval_score = 74.56
2023-04-20 18:20:49,663 - Detection -   eval_score = 73.97
2023-04-20 18:20:49,663 - Detection -   train_loss = 0.15248187134663263
2023-04-20 18:20:51,608 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 18:20:51,609 - Detection -   best_eval_score = 74.56
2023-04-20 18:20:51,609 - Detection -   eval_score = 74.32
2023-04-20 18:20:51,609 - Detection -   train_loss = 0.1464151069521904
2023-04-20 18:20:53,570 - Detection - ***** Epoch: 38: Eval results *****
2023-04-20 18:20:53,570 - Detection -   best_eval_score = 74.56
2023-04-20 18:20:53,570 - Detection -   eval_score = 74.79
2023-04-20 18:20:53,570 - Detection -   train_loss = 0.13969440907239913
2023-04-20 18:20:55,529 - Detection - ***** Epoch: 39: Eval results *****
2023-04-20 18:20:55,529 - Detection -   best_eval_score = 74.79
2023-04-20 18:20:55,529 - Detection -   eval_score = 74.79
2023-04-20 18:20:55,529 - Detection -   train_loss = 0.13451591581106187
2023-04-20 18:20:57,523 - Detection - ***** Epoch: 40: Eval results *****
2023-04-20 18:20:57,523 - Detection -   best_eval_score = 74.79
2023-04-20 18:20:57,523 - Detection -   eval_score = 74.44
2023-04-20 18:20:57,523 - Detection -   train_loss = 0.12716212024291357
2023-04-20 18:20:59,477 - Detection - ***** Epoch: 41: Eval results *****
2023-04-20 18:20:59,477 - Detection -   best_eval_score = 74.79
2023-04-20 18:20:59,477 - Detection -   eval_score = 74.56
2023-04-20 18:20:59,477 - Detection -   train_loss = 0.1229151447614034
2023-04-20 18:21:01,448 - Detection - ***** Epoch: 42: Eval results *****
2023-04-20 18:21:01,449 - Detection -   best_eval_score = 74.79
2023-04-20 18:21:01,449 - Detection -   eval_score = 74.79
2023-04-20 18:21:01,449 - Detection -   train_loss = 0.12129551619291305
2023-04-20 18:21:03,386 - Detection - ***** Epoch: 43: Eval results *****
2023-04-20 18:21:03,386 - Detection -   best_eval_score = 74.79
2023-04-20 18:21:03,386 - Detection -   eval_score = 74.79
2023-04-20 18:21:03,386 - Detection -   train_loss = 0.11380105962355931
2023-04-20 18:21:05,311 - Detection - ***** Epoch: 44: Eval results *****
2023-04-20 18:21:05,311 - Detection -   best_eval_score = 74.79
2023-04-20 18:21:05,311 - Detection -   eval_score = 74.68
2023-04-20 18:21:05,311 - Detection -   train_loss = 0.10895804266134898
2023-04-20 18:21:07,243 - Detection - ***** Epoch: 45: Eval results *****
2023-04-20 18:21:07,243 - Detection -   best_eval_score = 74.79
2023-04-20 18:21:07,243 - Detection -   eval_score = 75.03
2023-04-20 18:21:07,243 - Detection -   train_loss = 0.10630894949038823
2023-04-20 18:21:09,207 - Detection - ***** Epoch: 46: Eval results *****
2023-04-20 18:21:09,207 - Detection -   best_eval_score = 75.03
2023-04-20 18:21:09,207 - Detection -   eval_score = 75.27
2023-04-20 18:21:09,207 - Detection -   train_loss = 0.10264930327733358
2023-04-20 18:21:11,139 - Detection - ***** Epoch: 47: Eval results *****
2023-04-20 18:21:11,139 - Detection -   best_eval_score = 75.27
2023-04-20 18:21:11,139 - Detection -   eval_score = 75.03
2023-04-20 18:21:11,139 - Detection -   train_loss = 0.1019344319899877
2023-04-20 18:21:13,053 - Detection - ***** Epoch: 48: Eval results *****
2023-04-20 18:21:13,053 - Detection -   best_eval_score = 75.27
2023-04-20 18:21:13,053 - Detection -   eval_score = 75.38
2023-04-20 18:21:13,053 - Detection -   train_loss = 0.09517909735441207
2023-04-20 18:21:15,037 - Detection - ***** Epoch: 49: Eval results *****
2023-04-20 18:21:15,037 - Detection -   best_eval_score = 75.38
2023-04-20 18:21:15,037 - Detection -   eval_score = 75.62
2023-04-20 18:21:15,037 - Detection -   train_loss = 0.09627131621042888
2023-04-20 18:21:16,969 - Detection - ***** Epoch: 50: Eval results *****
2023-04-20 18:21:16,969 - Detection -   best_eval_score = 75.62
2023-04-20 18:21:16,969 - Detection -   eval_score = 75.97
2023-04-20 18:21:16,969 - Detection -   train_loss = 0.09467468609412512
2023-04-20 18:21:18,899 - Detection - ***** Epoch: 51: Eval results *****
2023-04-20 18:21:18,899 - Detection -   best_eval_score = 75.97
2023-04-20 18:21:18,899 - Detection -   eval_score = 75.27
2023-04-20 18:21:18,899 - Detection -   train_loss = 0.08945359289646149
2023-04-20 18:21:20,828 - Detection - ***** Epoch: 52: Eval results *****
2023-04-20 18:21:20,828 - Detection -   best_eval_score = 75.97
2023-04-20 18:21:20,828 - Detection -   eval_score = 75.5
2023-04-20 18:21:20,828 - Detection -   train_loss = 0.08673323939243953
2023-04-20 18:21:22,775 - Detection - ***** Epoch: 53: Eval results *****
2023-04-20 18:21:22,776 - Detection -   best_eval_score = 75.97
2023-04-20 18:21:22,776 - Detection -   eval_score = 75.27
2023-04-20 18:21:22,776 - Detection -   train_loss = 0.08528415461381277
2023-04-20 18:21:24,723 - Detection - ***** Epoch: 54: Eval results *****
2023-04-20 18:21:24,723 - Detection -   best_eval_score = 75.97
2023-04-20 18:21:24,723 - Detection -   eval_score = 75.62
2023-04-20 18:21:24,724 - Detection -   train_loss = 0.08180653254191081
2023-04-20 18:21:26,699 - Detection - ***** Epoch: 55: Eval results *****
2023-04-20 18:21:26,699 - Detection -   best_eval_score = 75.97
2023-04-20 18:21:26,699 - Detection -   eval_score = 75.38
2023-04-20 18:21:26,699 - Detection -   train_loss = 0.0782647356390953
2023-04-20 18:21:28,617 - Detection - ***** Epoch: 56: Eval results *****
2023-04-20 18:21:28,617 - Detection -   best_eval_score = 75.97
2023-04-20 18:21:28,617 - Detection -   eval_score = 75.62
2023-04-20 18:21:28,617 - Detection -   train_loss = 0.07600226054588953
2023-04-20 18:21:30,632 - Detection - ***** Epoch: 57: Eval results *****
2023-04-20 18:21:30,632 - Detection -   best_eval_score = 75.97
2023-04-20 18:21:30,632 - Detection -   eval_score = 75.74
2023-04-20 18:21:30,632 - Detection -   train_loss = 0.07811493302385013
2023-04-20 18:21:32,630 - Detection - ***** Epoch: 58: Eval results *****
2023-04-20 18:21:32,630 - Detection -   best_eval_score = 75.97
2023-04-20 18:21:32,630 - Detection -   eval_score = 75.38
2023-04-20 18:21:32,630 - Detection -   train_loss = 0.08023978198568026
2023-04-20 18:21:34,584 - Detection - ***** Epoch: 59: Eval results *****
2023-04-20 18:21:34,584 - Detection -   best_eval_score = 75.97
2023-04-20 18:21:34,585 - Detection -   eval_score = 75.5
2023-04-20 18:21:34,585 - Detection -   train_loss = 0.07146379575133324
2023-04-20 18:21:36,482 - Detection - ***** Epoch: 60: Eval results *****
2023-04-20 18:21:36,482 - Detection -   best_eval_score = 75.97
2023-04-20 18:21:36,482 - Detection -   eval_score = 76.09
2023-04-20 18:21:36,482 - Detection -   train_loss = 0.07299702689051628
2023-04-20 18:21:38,418 - Detection - ***** Epoch: 61: Eval results *****
2023-04-20 18:21:38,418 - Detection -   best_eval_score = 76.09
2023-04-20 18:21:38,418 - Detection -   eval_score = 76.21
2023-04-20 18:21:38,418 - Detection -   train_loss = 0.07053222333391508
2023-04-20 18:21:40,506 - Detection - ***** Epoch: 62: Eval results *****
2023-04-20 18:21:40,506 - Detection -   best_eval_score = 76.21
2023-04-20 18:21:40,506 - Detection -   eval_score = 75.97
2023-04-20 18:21:40,506 - Detection -   train_loss = 0.0694957472383976
2023-04-20 18:21:42,515 - Detection - ***** Epoch: 63: Eval results *****
2023-04-20 18:21:42,515 - Detection -   best_eval_score = 76.21
2023-04-20 18:21:42,515 - Detection -   eval_score = 75.85
2023-04-20 18:21:42,515 - Detection -   train_loss = 0.07286276295781136
2023-04-20 18:21:44,553 - Detection - ***** Epoch: 64: Eval results *****
2023-04-20 18:21:44,553 - Detection -   best_eval_score = 76.21
2023-04-20 18:21:44,553 - Detection -   eval_score = 75.62
2023-04-20 18:21:44,553 - Detection -   train_loss = 0.0687662089864413
2023-04-20 18:21:46,504 - Detection - ***** Epoch: 65: Eval results *****
2023-04-20 18:21:46,504 - Detection -   best_eval_score = 76.21
2023-04-20 18:21:46,504 - Detection -   eval_score = 75.5
2023-04-20 18:21:46,504 - Detection -   train_loss = 0.06911434059341749
2023-04-20 18:21:48,430 - Detection - ***** Epoch: 66: Eval results *****
2023-04-20 18:21:48,430 - Detection -   best_eval_score = 76.21
2023-04-20 18:21:48,430 - Detection -   eval_score = 75.62
2023-04-20 18:21:48,430 - Detection -   train_loss = 0.0634853906929493
2023-04-20 18:21:50,364 - Detection - ***** Epoch: 67: Eval results *****
2023-04-20 18:21:50,364 - Detection -   best_eval_score = 76.21
2023-04-20 18:21:50,365 - Detection -   eval_score = 75.85
2023-04-20 18:21:50,365 - Detection -   train_loss = 0.06502897863586744
2023-04-20 18:21:52,326 - Detection - ***** Epoch: 68: Eval results *****
2023-04-20 18:21:52,326 - Detection -   best_eval_score = 76.21
2023-04-20 18:21:52,326 - Detection -   eval_score = 75.97
2023-04-20 18:21:52,326 - Detection -   train_loss = 0.06855643416444461
2023-04-20 18:21:54,296 - Detection - ***** Epoch: 69: Eval results *****
2023-04-20 18:21:54,296 - Detection -   best_eval_score = 76.21
2023-04-20 18:21:54,296 - Detection -   eval_score = 75.97
2023-04-20 18:21:54,296 - Detection -   train_loss = 0.06374562482039134
2023-04-20 18:21:56,211 - Detection - ***** Epoch: 70: Eval results *****
2023-04-20 18:21:56,211 - Detection -   best_eval_score = 76.21
2023-04-20 18:21:56,212 - Detection -   eval_score = 75.97
2023-04-20 18:21:56,212 - Detection -   train_loss = 0.06220315620303154
2023-04-20 18:21:58,151 - Detection - ***** Epoch: 71: Eval results *****
2023-04-20 18:21:58,152 - Detection -   best_eval_score = 76.21
2023-04-20 18:21:58,152 - Detection -   eval_score = 75.97
2023-04-20 18:21:58,152 - Detection -   train_loss = 0.05934370309114456
2023-04-20 18:21:58,152 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_cg_0.5_1.0_bert_7/models
2023-04-20 18:21:58,693 - Detection - Pre-training finished...
2023-04-20 18:21:58,693 - Detection - Training Begin...
2023-04-20 18:22:01,801 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 18:22:01,802 - Detection -   best_eval_score = 0
2023-04-20 18:22:01,802 - Detection -   eval_score = 0.0
2023-04-20 18:22:01,802 - Detection -   train_loss = 12.022301419576008
2023-04-20 18:22:03,681 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 18:22:03,681 - Detection -   best_eval_score = 0
2023-04-20 18:22:03,681 - Detection -   eval_score = 0.0
2023-04-20 18:22:03,681 - Detection -   train_loss = 11.591270701090496
2023-04-20 18:22:05,562 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 18:22:05,562 - Detection -   best_eval_score = 0
2023-04-20 18:22:05,562 - Detection -   eval_score = 0.0
2023-04-20 18:22:05,562 - Detection -   train_loss = 11.134251912434896
2023-04-20 18:22:07,462 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 18:22:07,463 - Detection -   best_eval_score = 0
2023-04-20 18:22:07,463 - Detection -   eval_score = 0.0
2023-04-20 18:22:07,463 - Detection -   train_loss = 10.543476676940918
2023-04-20 18:22:09,358 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 18:22:09,358 - Detection -   best_eval_score = 0
2023-04-20 18:22:09,358 - Detection -   eval_score = 0.31
2023-04-20 18:22:09,358 - Detection -   train_loss = 9.854747200012207
2023-04-20 18:22:11,263 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 18:22:11,263 - Detection -   best_eval_score = 0.31
2023-04-20 18:22:11,263 - Detection -   eval_score = 1.47
2023-04-20 18:22:11,263 - Detection -   train_loss = 9.22061996459961
2023-04-20 18:22:13,238 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 18:22:13,238 - Detection -   best_eval_score = 1.47
2023-04-20 18:22:13,238 - Detection -   eval_score = 1.75
2023-04-20 18:22:13,238 - Detection -   train_loss = 8.483666356404623
2023-04-20 18:22:15,160 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 18:22:15,160 - Detection -   best_eval_score = 1.75
2023-04-20 18:22:15,160 - Detection -   eval_score = 2.24
2023-04-20 18:22:15,160 - Detection -   train_loss = 7.788328615824382
2023-04-20 18:22:17,099 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 18:22:17,099 - Detection -   best_eval_score = 2.24
2023-04-20 18:22:17,099 - Detection -   eval_score = 2.87
2023-04-20 18:22:17,099 - Detection -   train_loss = 7.074977684020996
2023-04-20 18:22:19,049 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 18:22:19,049 - Detection -   best_eval_score = 2.87
2023-04-20 18:22:19,049 - Detection -   eval_score = 5.04
2023-04-20 18:22:19,049 - Detection -   train_loss = 6.4240769704182945
2023-04-20 18:22:21,047 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 18:22:21,047 - Detection -   best_eval_score = 5.04
2023-04-20 18:22:21,047 - Detection -   eval_score = 7.98
2023-04-20 18:22:21,047 - Detection -   train_loss = 5.728726100921631
2023-04-20 18:22:23,021 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 18:22:23,021 - Detection -   best_eval_score = 7.98
2023-04-20 18:22:23,021 - Detection -   eval_score = 12.15
2023-04-20 18:22:23,021 - Detection -   train_loss = 5.072215398152669
2023-04-20 18:22:24,947 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 18:22:24,947 - Detection -   best_eval_score = 12.15
2023-04-20 18:22:24,947 - Detection -   eval_score = 16.34
2023-04-20 18:22:24,947 - Detection -   train_loss = 4.409629901250203
2023-04-20 18:22:26,850 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 18:22:26,850 - Detection -   best_eval_score = 16.34
2023-04-20 18:22:26,850 - Detection -   eval_score = 22.22
2023-04-20 18:22:26,850 - Detection -   train_loss = 3.7546804110209147
2023-04-20 18:22:28,755 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 18:22:28,755 - Detection -   best_eval_score = 22.22
2023-04-20 18:22:28,755 - Detection -   eval_score = 27.53
2023-04-20 18:22:28,755 - Detection -   train_loss = 3.1820343017578123
2023-04-20 18:22:30,632 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 18:22:30,632 - Detection -   best_eval_score = 27.53
2023-04-20 18:22:30,632 - Detection -   eval_score = 33.98
2023-04-20 18:22:30,632 - Detection -   train_loss = 2.6464066982269285
2023-04-20 18:22:32,579 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 18:22:32,579 - Detection -   best_eval_score = 33.98
2023-04-20 18:22:32,579 - Detection -   eval_score = 37.62
2023-04-20 18:22:32,579 - Detection -   train_loss = 2.224234390258789
2023-04-20 18:22:34,517 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 18:22:34,517 - Detection -   best_eval_score = 37.62
2023-04-20 18:22:34,517 - Detection -   eval_score = 42.09
2023-04-20 18:22:34,517 - Detection -   train_loss = 1.854775309562683
2023-04-20 18:22:36,448 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 18:22:36,448 - Detection -   best_eval_score = 42.09
2023-04-20 18:22:36,448 - Detection -   eval_score = 45.99
2023-04-20 18:22:36,448 - Detection -   train_loss = 1.594845136006673
2023-04-20 18:22:38,391 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 18:22:38,391 - Detection -   best_eval_score = 45.99
2023-04-20 18:22:38,391 - Detection -   eval_score = 48.89
2023-04-20 18:22:38,391 - Detection -   train_loss = 1.4424904743830362
2023-04-20 18:22:40,283 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 18:22:40,283 - Detection -   best_eval_score = 48.89
2023-04-20 18:22:40,283 - Detection -   eval_score = 50.99
2023-04-20 18:22:40,283 - Detection -   train_loss = 1.3743279059727986
2023-04-20 18:22:42,272 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 18:22:42,272 - Detection -   best_eval_score = 50.99
2023-04-20 18:22:42,272 - Detection -   eval_score = 52.65
2023-04-20 18:22:42,272 - Detection -   train_loss = 1.2981264511744182
2023-04-20 18:22:44,144 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 18:22:44,144 - Detection -   best_eval_score = 52.65
2023-04-20 18:22:44,144 - Detection -   eval_score = 54.22
2023-04-20 18:22:44,144 - Detection -   train_loss = 1.2481027921040853
2023-04-20 18:22:46,089 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 18:22:46,089 - Detection -   best_eval_score = 54.22
2023-04-20 18:22:46,089 - Detection -   eval_score = 55.15
2023-04-20 18:22:46,089 - Detection -   train_loss = 1.2369826952616374
2023-04-20 18:22:47,975 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 18:22:47,976 - Detection -   best_eval_score = 55.15
2023-04-20 18:22:47,976 - Detection -   eval_score = 55.5
2023-04-20 18:22:47,976 - Detection -   train_loss = 1.1949843645095826
2023-04-20 18:22:49,872 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 18:22:49,872 - Detection -   best_eval_score = 55.5
2023-04-20 18:22:49,873 - Detection -   eval_score = 55.86
2023-04-20 18:22:49,873 - Detection -   train_loss = 1.2373990615208943
2023-04-20 18:22:51,825 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 18:22:51,825 - Detection -   best_eval_score = 55.86
2023-04-20 18:22:51,825 - Detection -   eval_score = 56.16
2023-04-20 18:22:51,825 - Detection -   train_loss = 1.204116447766622
2023-04-20 18:22:53,802 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 18:22:53,802 - Detection -   best_eval_score = 56.16
2023-04-20 18:22:53,802 - Detection -   eval_score = 56.59
2023-04-20 18:22:53,802 - Detection -   train_loss = 1.193884587287903
2023-04-20 18:22:55,809 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 18:22:55,809 - Detection -   best_eval_score = 56.59
2023-04-20 18:22:55,809 - Detection -   eval_score = 56.77
2023-04-20 18:22:55,809 - Detection -   train_loss = 1.20078284740448
2023-04-20 18:22:57,808 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 18:22:57,809 - Detection -   best_eval_score = 56.77
2023-04-20 18:22:57,809 - Detection -   eval_score = 56.75
2023-04-20 18:22:57,809 - Detection -   train_loss = 1.2132488171259561
2023-04-20 18:22:59,675 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 18:22:59,676 - Detection -   best_eval_score = 56.77
2023-04-20 18:22:59,676 - Detection -   eval_score = 56.79
2023-04-20 18:22:59,676 - Detection -   train_loss = 1.1853981177012125
2023-04-20 18:23:01,554 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 18:23:01,554 - Detection -   best_eval_score = 56.79
2023-04-20 18:23:01,554 - Detection -   eval_score = 56.77
2023-04-20 18:23:01,554 - Detection -   train_loss = 1.1998087962468464
2023-04-20 18:23:03,563 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 18:23:03,563 - Detection -   best_eval_score = 56.79
2023-04-20 18:23:03,563 - Detection -   eval_score = 56.6
2023-04-20 18:23:03,563 - Detection -   train_loss = 1.18236794869105
2023-04-20 18:23:05,441 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 18:23:05,442 - Detection -   best_eval_score = 56.79
2023-04-20 18:23:05,442 - Detection -   eval_score = 57.3
2023-04-20 18:23:05,442 - Detection -   train_loss = 1.1887789964675903
2023-04-20 18:23:07,307 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 18:23:07,307 - Detection -   best_eval_score = 57.3
2023-04-20 18:23:07,307 - Detection -   eval_score = 57.13
2023-04-20 18:23:07,307 - Detection -   train_loss = 1.2249675194422405
2023-04-20 18:23:09,189 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 18:23:09,189 - Detection -   best_eval_score = 57.3
2023-04-20 18:23:09,189 - Detection -   eval_score = 56.81
2023-04-20 18:23:09,189 - Detection -   train_loss = 1.1939079364140828
2023-04-20 18:23:11,077 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 18:23:11,077 - Detection -   best_eval_score = 57.3
2023-04-20 18:23:11,077 - Detection -   eval_score = 56.94
2023-04-20 18:23:11,077 - Detection -   train_loss = 1.2259592851003012
2023-04-20 18:23:12,948 - Detection - ***** Epoch: 38: Eval results *****
2023-04-20 18:23:12,948 - Detection -   best_eval_score = 57.3
2023-04-20 18:23:12,948 - Detection -   eval_score = 56.69
2023-04-20 18:23:12,948 - Detection -   train_loss = 1.179201058546702
2023-04-20 18:23:14,820 - Detection - ***** Epoch: 39: Eval results *****
2023-04-20 18:23:14,820 - Detection -   best_eval_score = 57.3
2023-04-20 18:23:14,820 - Detection -   eval_score = 56.78
2023-04-20 18:23:14,820 - Detection -   train_loss = 1.2220498164494833
2023-04-20 18:23:16,691 - Detection - ***** Epoch: 40: Eval results *****
2023-04-20 18:23:16,691 - Detection -   best_eval_score = 57.3
2023-04-20 18:23:16,691 - Detection -   eval_score = 56.48
2023-04-20 18:23:16,691 - Detection -   train_loss = 1.2116702556610108
2023-04-20 18:23:18,592 - Detection - ***** Epoch: 41: Eval results *****
2023-04-20 18:23:18,592 - Detection -   best_eval_score = 57.3
2023-04-20 18:23:18,592 - Detection -   eval_score = 56.76
2023-04-20 18:23:18,592 - Detection -   train_loss = 1.2466928243637085
2023-04-20 18:23:20,470 - Detection - ***** Epoch: 42: Eval results *****
2023-04-20 18:23:20,470 - Detection -   best_eval_score = 57.3
2023-04-20 18:23:20,470 - Detection -   eval_score = 57.29
2023-04-20 18:23:20,470 - Detection -   train_loss = 1.196000631650289
2023-04-20 18:23:22,341 - Detection - ***** Epoch: 43: Eval results *****
2023-04-20 18:23:22,341 - Detection -   best_eval_score = 57.3
2023-04-20 18:23:22,341 - Detection -   eval_score = 56.89
2023-04-20 18:23:22,341 - Detection -   train_loss = 1.2007409493128458
2023-04-20 18:23:24,208 - Detection - ***** Epoch: 44: Eval results *****
2023-04-20 18:23:24,208 - Detection -   best_eval_score = 57.3
2023-04-20 18:23:24,208 - Detection -   eval_score = 57.4
2023-04-20 18:23:24,208 - Detection -   train_loss = 1.1902650117874145
2023-04-20 18:23:26,087 - Detection - ***** Epoch: 45: Eval results *****
2023-04-20 18:23:26,087 - Detection -   best_eval_score = 57.4
2023-04-20 18:23:26,087 - Detection -   eval_score = 56.68
2023-04-20 18:23:26,087 - Detection -   train_loss = 1.185226861635844
2023-04-20 18:23:27,961 - Detection - ***** Epoch: 46: Eval results *****
2023-04-20 18:23:27,961 - Detection -   best_eval_score = 57.4
2023-04-20 18:23:27,961 - Detection -   eval_score = 56.8
2023-04-20 18:23:27,962 - Detection -   train_loss = 1.2125207662582398
2023-04-20 18:23:29,828 - Detection - ***** Epoch: 47: Eval results *****
2023-04-20 18:23:29,828 - Detection -   best_eval_score = 57.4
2023-04-20 18:23:29,828 - Detection -   eval_score = 56.53
2023-04-20 18:23:29,828 - Detection -   train_loss = 1.2082354863484701
2023-04-20 18:23:31,704 - Detection - ***** Epoch: 48: Eval results *****
2023-04-20 18:23:31,704 - Detection -   best_eval_score = 57.4
2023-04-20 18:23:31,704 - Detection -   eval_score = 56.42
2023-04-20 18:23:31,704 - Detection -   train_loss = 1.2100688695907593
2023-04-20 18:23:33,575 - Detection - ***** Epoch: 49: Eval results *****
2023-04-20 18:23:33,575 - Detection -   best_eval_score = 57.4
2023-04-20 18:23:33,575 - Detection -   eval_score = 56.85
2023-04-20 18:23:33,575 - Detection -   train_loss = 1.2021495978037515
2023-04-20 18:23:35,450 - Detection - ***** Epoch: 50: Eval results *****
2023-04-20 18:23:35,450 - Detection -   best_eval_score = 57.4
2023-04-20 18:23:35,451 - Detection -   eval_score = 57.0
2023-04-20 18:23:35,451 - Detection -   train_loss = 1.2148333311080932
2023-04-20 18:23:37,314 - Detection - ***** Epoch: 51: Eval results *****
2023-04-20 18:23:37,314 - Detection -   best_eval_score = 57.4
2023-04-20 18:23:37,314 - Detection -   eval_score = 57.21
2023-04-20 18:23:37,314 - Detection -   train_loss = 1.2368034919102986
2023-04-20 18:23:39,181 - Detection - ***** Epoch: 52: Eval results *****
2023-04-20 18:23:39,182 - Detection -   best_eval_score = 57.4
2023-04-20 18:23:39,182 - Detection -   eval_score = 57.05
2023-04-20 18:23:39,182 - Detection -   train_loss = 1.1563912073771159
2023-04-20 18:23:41,047 - Detection - ***** Epoch: 53: Eval results *****
2023-04-20 18:23:41,047 - Detection -   best_eval_score = 57.4
2023-04-20 18:23:41,047 - Detection -   eval_score = 56.8
2023-04-20 18:23:41,047 - Detection -   train_loss = 1.1998693068822226
2023-04-20 18:23:42,918 - Detection - ***** Epoch: 54: Eval results *****
2023-04-20 18:23:42,918 - Detection -   best_eval_score = 57.4
2023-04-20 18:23:42,918 - Detection -   eval_score = 57.03
2023-04-20 18:23:42,918 - Detection -   train_loss = 1.2342297633488972
2023-04-20 18:23:42,920 - Detection - Training Finished...
2023-04-20 18:23:42,920 - Detection - Testing begin...
2023-04-20 18:23:45,165 - Detection - ***** Test: Confusion Matrix *****
2023-04-20 18:23:45,166 - Detection - [[  10    0    0 ...    0    0    6]
 [   0    4    0 ...    0    0    6]
 [   0    0   16 ...    0    0    1]
 ...
 [   0    0    0 ...    8    0    8]
 [   0    0    0 ...    0    8    3]
 [   0    0    0 ...   18    3 2125]]
2023-04-20 18:23:45,166 - Detection - ***** Test results *****
2023-04-20 18:23:45,166 - Detection -   Acc = 74.83
2023-04-20 18:23:45,166 - Detection -   F1 = 50.3681
2023-04-20 18:23:45,166 - Detection -   F1-known = 49.9233
2023-04-20 18:23:45,166 - Detection -   F1-open = 83.7273
2023-04-20 18:23:45,166 - Detection - Testing finished...
2023-04-20 18:23:45,166 - Detection - Results saved in results/results_ADB.csv
2023-04-20 18:23:45,186 - Detection - Open Intent Detection Finished...
