2023-04-05 01:35:14,151 - Detection - Open Intent Detection Begin...
2023-04-05 01:35:14,152 - Detection - Parameters Initialization...
2023-04-05 01:35:14,152 - Detection - ============================== Params ==============================
2023-04-05 01:35:14,152 - Detection - type:	open_intent_detection
2023-04-05 01:35:14,152 - Detection - logger_name:	Detection
2023-04-05 01:35:14,152 - Detection - log_dir:	logs
2023-04-05 01:35:14,152 - Detection - dataset:	oos
2023-04-05 01:35:14,152 - Detection - known_cls_ratio:	0.25
2023-04-05 01:35:14,152 - Detection - labeled_ratio:	1.0
2023-04-05 01:35:14,152 - Detection - method:	ADB
2023-04-05 01:35:14,152 - Detection - train:	True
2023-04-05 01:35:14,152 - Detection - pretrain:	True
2023-04-05 01:35:14,152 - Detection - save_model:	True
2023-04-05 01:35:14,152 - Detection - backbone:	bert
2023-04-05 01:35:14,152 - Detection - config_file_name:	ADB
2023-04-05 01:35:14,152 - Detection - seed:	0
2023-04-05 01:35:14,152 - Detection - gpu_id:	0
2023-04-05 01:35:14,152 - Detection - pipe_results_path:	pipe_results
2023-04-05 01:35:14,152 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-05 01:35:14,152 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-05 01:35:14,152 - Detection - model_dir:	models
2023-04-05 01:35:14,152 - Detection - load_pretrained_method:	None
2023-04-05 01:35:14,152 - Detection - result_dir:	results
2023-04-05 01:35:14,152 - Detection - results_file_name:	results_ADB.csv
2023-04-05 01:35:14,152 - Detection - save_results:	True
2023-04-05 01:35:14,152 - Detection - loss_fct:	CrossEntropyLoss
2023-04-05 01:35:14,152 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_0.25_1.0_bert_0
2023-04-05 01:35:14,152 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_0.25_1.0_bert_0/models
2023-04-05 01:35:14,152 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-05 01:35:14,152 - Detection - num_train_epochs:	100
2023-04-05 01:35:14,152 - Detection - num_labels:	None
2023-04-05 01:35:14,152 - Detection - max_seq_length:	None
2023-04-05 01:35:14,153 - Detection - freeze_backbone_parameters:	True
2023-04-05 01:35:14,153 - Detection - feat_dim:	768
2023-04-05 01:35:14,153 - Detection - warmup_proportion:	0.1
2023-04-05 01:35:14,153 - Detection - lr_boundary:	0.05
2023-04-05 01:35:14,153 - Detection - lr:	2e-05
2023-04-05 01:35:14,153 - Detection - activation:	relu
2023-04-05 01:35:14,153 - Detection - train_batch_size:	128
2023-04-05 01:35:14,153 - Detection - eval_batch_size:	64
2023-04-05 01:35:14,153 - Detection - test_batch_size:	64
2023-04-05 01:35:14,153 - Detection - wait_patient:	10
2023-04-05 01:35:14,153 - Detection - ============================== End Params ==============================
2023-04-05 01:35:14,153 - Detection - Data and Model Preparation...
2023-04-05 01:35:14,153 - Detection - The number of known intents is 38
2023-04-05 01:35:14,153 - Detection - Lists of known labels are: ['spelling', 'jump_start', 'date', 'routing', 'bill_balance', 'reset_settings', 'expiration_date', 'play_music', 'no', 'min_payment', 'travel_suggestion', 'how_busy', 'new_card', 'income', 'last_maintenance', 'distance', 'oil_change_how', 'pto_request_status', 'freeze_account', 'cancel_reservation', 'time', 'maybe', 'change_user_name', 'bill_due', 'todo_list', 'change_language', 'food_last', 'replacement_card_duration', 'redeem_rewards', 'confirm_reservation', 'user_name', 'payday', 'cook_time', 'todo_list_update', 'travel_alert', 'interest_rate', 'card_declined', 'pay_bill']
2023-04-05 01:35:14,192 - Detection - Number of labeled training samples = 3800
2023-04-05 01:35:14,192 - Detection - Number of unlabeled training samples = 11200
2023-04-05 01:35:14,198 - Detection - Number of evaluation samples = 760
2023-04-05 01:35:14,209 - Detection - Number of testing samples = 5700
2023-04-05 01:35:21,418 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-05 01:35:23,072 - Detection - Pre-training Begin...
2023-04-05 01:35:26,571 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 01:35:26,571 - Detection -   best_eval_score = 0
2023-04-05 01:35:26,571 - Detection -   eval_score = 5.53
2023-04-05 01:35:26,571 - Detection -   train_loss = 3.6340087175369264
2023-04-05 01:35:29,527 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 01:35:29,527 - Detection -   best_eval_score = 5.53
2023-04-05 01:35:29,527 - Detection -   eval_score = 17.5
2023-04-05 01:35:29,527 - Detection -   train_loss = 3.602588748931885
2023-04-05 01:35:32,488 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 01:35:32,488 - Detection -   best_eval_score = 17.5
2023-04-05 01:35:32,488 - Detection -   eval_score = 45.26
2023-04-05 01:35:32,488 - Detection -   train_loss = 3.531331729888916
2023-04-05 01:35:35,456 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 01:35:35,456 - Detection -   best_eval_score = 45.26
2023-04-05 01:35:35,456 - Detection -   eval_score = 59.34
2023-04-05 01:35:35,456 - Detection -   train_loss = 3.342646829287211
2023-04-05 01:35:38,546 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 01:35:38,546 - Detection -   best_eval_score = 59.34
2023-04-05 01:35:38,546 - Detection -   eval_score = 73.95
2023-04-05 01:35:38,546 - Detection -   train_loss = 2.8549190044403074
2023-04-05 01:35:41,586 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 01:35:41,586 - Detection -   best_eval_score = 73.95
2023-04-05 01:35:41,586 - Detection -   eval_score = 82.5
2023-04-05 01:35:41,587 - Detection -   train_loss = 2.099055767059326
2023-04-05 01:35:44,682 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 01:35:44,682 - Detection -   best_eval_score = 82.5
2023-04-05 01:35:44,682 - Detection -   eval_score = 89.74
2023-04-05 01:35:44,682 - Detection -   train_loss = 1.3856297254562377
2023-04-05 01:35:47,819 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 01:35:47,819 - Detection -   best_eval_score = 89.74
2023-04-05 01:35:47,819 - Detection -   eval_score = 93.29
2023-04-05 01:35:47,819 - Detection -   train_loss = 0.893679557243983
2023-04-05 01:35:50,987 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 01:35:50,987 - Detection -   best_eval_score = 93.29
2023-04-05 01:35:50,987 - Detection -   eval_score = 94.61
2023-04-05 01:35:50,987 - Detection -   train_loss = 0.5955710341533025
2023-04-05 01:35:54,170 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 01:35:54,170 - Detection -   best_eval_score = 94.61
2023-04-05 01:35:54,170 - Detection -   eval_score = 96.18
2023-04-05 01:35:54,170 - Detection -   train_loss = 0.41683394809563956
2023-04-05 01:35:57,340 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 01:35:57,340 - Detection -   best_eval_score = 96.18
2023-04-05 01:35:57,340 - Detection -   eval_score = 96.71
2023-04-05 01:35:57,340 - Detection -   train_loss = 0.3008687471350034
2023-04-05 01:36:00,511 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 01:36:00,511 - Detection -   best_eval_score = 96.71
2023-04-05 01:36:00,511 - Detection -   eval_score = 96.58
2023-04-05 01:36:00,511 - Detection -   train_loss = 0.2313088203469912
2023-04-05 01:36:03,677 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 01:36:03,677 - Detection -   best_eval_score = 96.71
2023-04-05 01:36:03,678 - Detection -   eval_score = 96.18
2023-04-05 01:36:03,678 - Detection -   train_loss = 0.18895373990138373
2023-04-05 01:36:06,837 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 01:36:06,837 - Detection -   best_eval_score = 96.71
2023-04-05 01:36:06,837 - Detection -   eval_score = 96.58
2023-04-05 01:36:06,837 - Detection -   train_loss = 0.1615783785780271
2023-04-05 01:36:10,000 - Detection - ***** Epoch: 15: Eval results *****
2023-04-05 01:36:10,000 - Detection -   best_eval_score = 96.71
2023-04-05 01:36:10,000 - Detection -   eval_score = 96.97
2023-04-05 01:36:10,000 - Detection -   train_loss = 0.13517550577720006
2023-04-05 01:36:13,175 - Detection - ***** Epoch: 16: Eval results *****
2023-04-05 01:36:13,175 - Detection -   best_eval_score = 96.97
2023-04-05 01:36:13,175 - Detection -   eval_score = 97.24
2023-04-05 01:36:13,175 - Detection -   train_loss = 0.11720841551820436
2023-04-05 01:36:16,343 - Detection - ***** Epoch: 17: Eval results *****
2023-04-05 01:36:16,343 - Detection -   best_eval_score = 97.24
2023-04-05 01:36:16,343 - Detection -   eval_score = 96.97
2023-04-05 01:36:16,343 - Detection -   train_loss = 0.10299294417103132
2023-04-05 01:36:19,511 - Detection - ***** Epoch: 18: Eval results *****
2023-04-05 01:36:19,511 - Detection -   best_eval_score = 97.24
2023-04-05 01:36:19,511 - Detection -   eval_score = 97.24
2023-04-05 01:36:19,511 - Detection -   train_loss = 0.09511240099867185
2023-04-05 01:36:22,669 - Detection - ***** Epoch: 19: Eval results *****
2023-04-05 01:36:22,669 - Detection -   best_eval_score = 97.24
2023-04-05 01:36:22,669 - Detection -   eval_score = 97.11
2023-04-05 01:36:22,670 - Detection -   train_loss = 0.08621923426787058
2023-04-05 01:36:25,832 - Detection - ***** Epoch: 20: Eval results *****
2023-04-05 01:36:25,832 - Detection -   best_eval_score = 97.24
2023-04-05 01:36:25,832 - Detection -   eval_score = 97.63
2023-04-05 01:36:25,832 - Detection -   train_loss = 0.07924021246532599
2023-04-05 01:36:29,009 - Detection - ***** Epoch: 21: Eval results *****
2023-04-05 01:36:29,009 - Detection -   best_eval_score = 97.63
2023-04-05 01:36:29,009 - Detection -   eval_score = 97.37
2023-04-05 01:36:29,009 - Detection -   train_loss = 0.07303068997959296
2023-04-05 01:36:32,176 - Detection - ***** Epoch: 22: Eval results *****
2023-04-05 01:36:32,176 - Detection -   best_eval_score = 97.63
2023-04-05 01:36:32,176 - Detection -   eval_score = 97.24
2023-04-05 01:36:32,176 - Detection -   train_loss = 0.06456781116624673
2023-04-05 01:36:35,337 - Detection - ***** Epoch: 23: Eval results *****
2023-04-05 01:36:35,337 - Detection -   best_eval_score = 97.63
2023-04-05 01:36:35,338 - Detection -   eval_score = 97.5
2023-04-05 01:36:35,338 - Detection -   train_loss = 0.06276008201142153
2023-04-05 01:36:38,497 - Detection - ***** Epoch: 24: Eval results *****
2023-04-05 01:36:38,497 - Detection -   best_eval_score = 97.63
2023-04-05 01:36:38,497 - Detection -   eval_score = 97.76
2023-04-05 01:36:38,497 - Detection -   train_loss = 0.055065034454067546
2023-04-05 01:36:41,663 - Detection - ***** Epoch: 25: Eval results *****
2023-04-05 01:36:41,663 - Detection -   best_eval_score = 97.76
2023-04-05 01:36:41,663 - Detection -   eval_score = 97.5
2023-04-05 01:36:41,663 - Detection -   train_loss = 0.05099622756242752
2023-04-05 01:36:44,824 - Detection - ***** Epoch: 26: Eval results *****
2023-04-05 01:36:44,824 - Detection -   best_eval_score = 97.76
2023-04-05 01:36:44,825 - Detection -   eval_score = 97.5
2023-04-05 01:36:44,825 - Detection -   train_loss = 0.050889225552479427
2023-04-05 01:36:47,987 - Detection - ***** Epoch: 27: Eval results *****
2023-04-05 01:36:47,987 - Detection -   best_eval_score = 97.76
2023-04-05 01:36:47,987 - Detection -   eval_score = 97.76
2023-04-05 01:36:47,987 - Detection -   train_loss = 0.045376220780114336
2023-04-05 01:36:51,153 - Detection - ***** Epoch: 28: Eval results *****
2023-04-05 01:36:51,153 - Detection -   best_eval_score = 97.76
2023-04-05 01:36:51,153 - Detection -   eval_score = 97.63
2023-04-05 01:36:51,153 - Detection -   train_loss = 0.04596843309700489
2023-04-05 01:36:54,315 - Detection - ***** Epoch: 29: Eval results *****
2023-04-05 01:36:54,315 - Detection -   best_eval_score = 97.76
2023-04-05 01:36:54,315 - Detection -   eval_score = 97.5
2023-04-05 01:36:54,315 - Detection -   train_loss = 0.039751818589866164
2023-04-05 01:36:57,486 - Detection - ***** Epoch: 30: Eval results *****
2023-04-05 01:36:57,487 - Detection -   best_eval_score = 97.76
2023-04-05 01:36:57,487 - Detection -   eval_score = 97.37
2023-04-05 01:36:57,487 - Detection -   train_loss = 0.038510278115669885
2023-04-05 01:37:00,644 - Detection - ***** Epoch: 31: Eval results *****
2023-04-05 01:37:00,644 - Detection -   best_eval_score = 97.76
2023-04-05 01:37:00,644 - Detection -   eval_score = 97.5
2023-04-05 01:37:00,644 - Detection -   train_loss = 0.03610632562388976
2023-04-05 01:37:03,820 - Detection - ***** Epoch: 32: Eval results *****
2023-04-05 01:37:03,820 - Detection -   best_eval_score = 97.76
2023-04-05 01:37:03,820 - Detection -   eval_score = 97.24
2023-04-05 01:37:03,820 - Detection -   train_loss = 0.03612268430491288
2023-04-05 01:37:06,986 - Detection - ***** Epoch: 33: Eval results *****
2023-04-05 01:37:06,986 - Detection -   best_eval_score = 97.76
2023-04-05 01:37:06,986 - Detection -   eval_score = 97.5
2023-04-05 01:37:06,986 - Detection -   train_loss = 0.030928924245138965
2023-04-05 01:37:10,158 - Detection - ***** Epoch: 34: Eval results *****
2023-04-05 01:37:10,158 - Detection -   best_eval_score = 97.76
2023-04-05 01:37:10,158 - Detection -   eval_score = 97.24
2023-04-05 01:37:10,158 - Detection -   train_loss = 0.03167953994125128
2023-04-05 01:37:10,159 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_0.25_1.0_bert_0/models
2023-04-05 01:37:10,701 - Detection - Pre-training finished...
2023-04-05 01:37:10,701 - Detection - Training Begin...
2023-04-05 01:37:16,148 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 01:37:16,148 - Detection -   best_eval_score = 0
2023-04-05 01:37:16,148 - Detection -   eval_score = 0.0
2023-04-05 01:37:16,148 - Detection -   train_loss = 9.925532086690266
2023-04-05 01:37:19,353 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 01:37:19,353 - Detection -   best_eval_score = 0
2023-04-05 01:37:19,353 - Detection -   eval_score = 2.7
2023-04-05 01:37:19,353 - Detection -   train_loss = 8.829214382171632
2023-04-05 01:37:22,461 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 01:37:22,462 - Detection -   best_eval_score = 2.7
2023-04-05 01:37:22,462 - Detection -   eval_score = 25.64
2023-04-05 01:37:22,462 - Detection -   train_loss = 7.433248615264892
2023-04-05 01:37:25,569 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 01:37:25,569 - Detection -   best_eval_score = 25.64
2023-04-05 01:37:25,569 - Detection -   eval_score = 56.33
2023-04-05 01:37:25,570 - Detection -   train_loss = 5.914781936009725
2023-04-05 01:37:28,678 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 01:37:28,678 - Detection -   best_eval_score = 56.33
2023-04-05 01:37:28,678 - Detection -   eval_score = 73.69
2023-04-05 01:37:28,678 - Detection -   train_loss = 4.42180008093516
2023-04-05 01:37:31,784 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 01:37:31,784 - Detection -   best_eval_score = 73.69
2023-04-05 01:37:31,784 - Detection -   eval_score = 85.16
2023-04-05 01:37:31,785 - Detection -   train_loss = 2.980701128641764
2023-04-05 01:37:34,894 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 01:37:34,894 - Detection -   best_eval_score = 85.16
2023-04-05 01:37:34,894 - Detection -   eval_score = 89.39
2023-04-05 01:37:34,894 - Detection -   train_loss = 1.834347665309906
2023-04-05 01:37:38,003 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 01:37:38,003 - Detection -   best_eval_score = 89.39
2023-04-05 01:37:38,003 - Detection -   eval_score = 91.44
2023-04-05 01:37:38,003 - Detection -   train_loss = 1.2582199295361838
2023-04-05 01:37:41,109 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 01:37:41,109 - Detection -   best_eval_score = 91.44
2023-04-05 01:37:41,109 - Detection -   eval_score = 91.79
2023-04-05 01:37:41,109 - Detection -   train_loss = 1.1330835004647573
2023-04-05 01:37:44,211 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 01:37:44,212 - Detection -   best_eval_score = 91.79
2023-04-05 01:37:44,212 - Detection -   eval_score = 91.94
2023-04-05 01:37:44,212 - Detection -   train_loss = 1.1484546820322672
2023-04-05 01:37:47,321 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 01:37:47,321 - Detection -   best_eval_score = 91.94
2023-04-05 01:37:47,321 - Detection -   eval_score = 91.87
2023-04-05 01:37:47,321 - Detection -   train_loss = 1.1048641145229339
2023-04-05 01:37:50,429 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 01:37:50,429 - Detection -   best_eval_score = 91.94
2023-04-05 01:37:50,429 - Detection -   eval_score = 91.87
2023-04-05 01:37:50,429 - Detection -   train_loss = 1.1261972904205322
2023-04-05 01:37:53,531 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 01:37:53,531 - Detection -   best_eval_score = 91.94
2023-04-05 01:37:53,531 - Detection -   eval_score = 91.87
2023-04-05 01:37:53,531 - Detection -   train_loss = 1.1347159008185068
2023-04-05 01:37:56,629 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 01:37:56,629 - Detection -   best_eval_score = 91.94
2023-04-05 01:37:56,629 - Detection -   eval_score = 91.79
2023-04-05 01:37:56,629 - Detection -   train_loss = 1.1348031202952067
2023-04-05 01:37:59,738 - Detection - ***** Epoch: 15: Eval results *****
2023-04-05 01:37:59,739 - Detection -   best_eval_score = 91.94
2023-04-05 01:37:59,739 - Detection -   eval_score = 91.87
2023-04-05 01:37:59,739 - Detection -   train_loss = 1.1268717646598816
2023-04-05 01:38:02,845 - Detection - ***** Epoch: 16: Eval results *****
2023-04-05 01:38:02,846 - Detection -   best_eval_score = 91.94
2023-04-05 01:38:02,846 - Detection -   eval_score = 91.94
2023-04-05 01:38:02,846 - Detection -   train_loss = 1.1322412411371867
2023-04-05 01:38:05,948 - Detection - ***** Epoch: 17: Eval results *****
2023-04-05 01:38:05,948 - Detection -   best_eval_score = 91.94
2023-04-05 01:38:05,948 - Detection -   eval_score = 91.87
2023-04-05 01:38:05,948 - Detection -   train_loss = 1.1437664290269216
2023-04-05 01:38:09,050 - Detection - ***** Epoch: 18: Eval results *****
2023-04-05 01:38:09,050 - Detection -   best_eval_score = 91.94
2023-04-05 01:38:09,050 - Detection -   eval_score = 91.94
2023-04-05 01:38:09,050 - Detection -   train_loss = 1.1359825273354849
2023-04-05 01:38:12,155 - Detection - ***** Epoch: 19: Eval results *****
2023-04-05 01:38:12,155 - Detection -   best_eval_score = 91.94
2023-04-05 01:38:12,155 - Detection -   eval_score = 91.79
2023-04-05 01:38:12,155 - Detection -   train_loss = 1.1621165414651236
2023-04-05 01:38:15,259 - Detection - ***** Epoch: 20: Eval results *****
2023-04-05 01:38:15,259 - Detection -   best_eval_score = 91.94
2023-04-05 01:38:15,259 - Detection -   eval_score = 91.86
2023-04-05 01:38:15,259 - Detection -   train_loss = 1.1260390738646189
2023-04-05 01:38:15,260 - Detection - Training Finished...
2023-04-05 01:38:15,260 - Detection - Testing begin...
2023-04-05 01:38:18,764 - Detection - ***** Test: Confusion Matrix *****
2023-04-05 01:38:18,765 - Detection - [[  26    0    0 ...    0    0    4]
 [   0   30    0 ...    0    0    0]
 [   0    0   27 ...    0    0    3]
 ...
 [   0    0    0 ...   24    0    5]
 [   0    0    0 ...    0   26    3]
 [  13   10    5 ...   18    4 4017]]
2023-04-05 01:38:18,765 - Detection - ***** Test results *****
2023-04-05 01:38:18,765 - Detection -   Acc = 88.33
2023-04-05 01:38:18,765 - Detection -   F1 = 77.1776
2023-04-05 01:38:18,765 - Detection -   F1-known = 76.7745
2023-04-05 01:38:18,765 - Detection -   F1-open = 92.4937
2023-04-05 01:38:18,765 - Detection - Testing finished...
2023-04-05 01:38:18,765 - Detection - Results saved in results/results_ADB.csv
2023-04-05 01:38:18,785 - Detection - Open Intent Detection Finished...
