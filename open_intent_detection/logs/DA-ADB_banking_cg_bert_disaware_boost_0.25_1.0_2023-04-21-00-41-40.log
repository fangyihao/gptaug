2023-04-21 00:41:40,024 - Detection - Open Intent Detection Begin...
2023-04-21 00:41:40,024 - Detection - Parameters Initialization...
2023-04-21 00:41:40,025 - Detection - ============================== Params ==============================
2023-04-21 00:41:40,025 - Detection - type:	open_intent_detection
2023-04-21 00:41:40,025 - Detection - logger_name:	Detection
2023-04-21 00:41:40,025 - Detection - log_dir:	logs
2023-04-21 00:41:40,025 - Detection - dataset:	banking_cg
2023-04-21 00:41:40,025 - Detection - known_cls_ratio:	0.25
2023-04-21 00:41:40,025 - Detection - labeled_ratio:	1.0
2023-04-21 00:41:40,025 - Detection - method:	DA-ADB
2023-04-21 00:41:40,025 - Detection - train:	True
2023-04-21 00:41:40,025 - Detection - pretrain:	True
2023-04-21 00:41:40,025 - Detection - save_model:	False
2023-04-21 00:41:40,025 - Detection - backbone:	bert_disaware_boost
2023-04-21 00:41:40,025 - Detection - config_file_name:	DA-ADB
2023-04-21 00:41:40,025 - Detection - seed:	6
2023-04-21 00:41:40,025 - Detection - gpu_id:	0
2023-04-21 00:41:40,025 - Detection - pipe_results_path:	pipe_results
2023-04-21 00:41:40,025 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-21 00:41:40,025 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-21 00:41:40,025 - Detection - model_dir:	models
2023-04-21 00:41:40,025 - Detection - load_pretrained_method:	None
2023-04-21 00:41:40,025 - Detection - result_dir:	results
2023-04-21 00:41:40,025 - Detection - results_file_name:	results_DA-ADB-BOOST.csv
2023-04-21 00:41:40,025 - Detection - save_results:	True
2023-04-21 00:41:40,025 - Detection - loss_fct:	CrossEntropyLoss
2023-04-21 00:41:40,025 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_cg_0.25_1.0_bert_disaware_boost_6
2023-04-21 00:41:40,025 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_cg_0.25_1.0_bert_disaware_boost_6/models
2023-04-21 00:41:40,025 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-21 00:41:40,025 - Detection - num_train_epochs:	100
2023-04-21 00:41:40,025 - Detection - num_labels:	None
2023-04-21 00:41:40,025 - Detection - max_seq_length:	None
2023-04-21 00:41:40,025 - Detection - freeze_backbone_parameters:	True
2023-04-21 00:41:40,025 - Detection - feat_dim:	768
2023-04-21 00:41:40,025 - Detection - warmup_proportion:	0.1
2023-04-21 00:41:40,025 - Detection - scale:	4
2023-04-21 00:41:40,025 - Detection - lr_boundary:	0.05
2023-04-21 00:41:40,025 - Detection - lr:	2e-05
2023-04-21 00:41:40,025 - Detection - activation:	relu
2023-04-21 00:41:40,025 - Detection - train_batch_size:	128
2023-04-21 00:41:40,025 - Detection - eval_batch_size:	64
2023-04-21 00:41:40,025 - Detection - test_batch_size:	64
2023-04-21 00:41:40,025 - Detection - wait_patient:	10
2023-04-21 00:41:40,025 - Detection - ============================== End Params ==============================
2023-04-21 00:41:40,025 - Detection - Data and Model Preparation...
2023-04-21 00:41:40,026 - Detection - The number of known intents is 19
2023-04-21 00:41:40,026 - Detection - Lists of known labels are: ['direct_debit_payment_not_recognised', 'exchange_via_app', 'compromised_card', 'top_up_by_cash_or_cheque', 'top_up_by_bank_transfer_charge', 'transfer_not_received_by_recipient', 'pending_cash_withdrawal', 'card_payment_not_recognised', 'Refund_not_showing_up', 'top_up_failed', 'get_disposable_virtual_card', 'pending_card_payment', 'getting_spare_card', 'card_delivery_estimate', 'get_physical_card', 'transfer_fee_charged', 'cash_withdrawal_charge', 'card_arrival', 'exchange_charge']
2023-04-21 00:41:40,034 - Detection - Number of labeled training samples = 758
2023-04-21 00:41:40,034 - Detection - Number of unlabeled training samples = 2014
2023-04-21 00:41:40,036 - Detection - Number of evaluation samples = 217
2023-04-21 00:41:40,040 - Detection - Number of testing samples = 1896
2023-04-21 00:41:45,405 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-21 00:41:45,487 - Detection - Pre-training Begin...
2023-04-21 00:41:47,798 - Detection - ***** Epoch: 1: Eval results *****
2023-04-21 00:41:47,798 - Detection -   best_eval_score = 0
2023-04-21 00:41:47,798 - Detection -   eval_score = 0.47
2023-04-21 00:41:47,798 - Detection -   train_loss = 2.952306946118673
2023-04-21 00:42:02,462 - Detection - ***** Epoch: 2: Eval results *****
2023-04-21 00:42:02,462 - Detection -   best_eval_score = 0.47
2023-04-21 00:42:02,462 - Detection -   eval_score = 2.14
2023-04-21 00:42:02,462 - Detection -   train_loss = 2.931735316912333
2023-04-21 00:42:17,103 - Detection - ***** Epoch: 3: Eval results *****
2023-04-21 00:42:17,103 - Detection -   best_eval_score = 2.14
2023-04-21 00:42:17,103 - Detection -   eval_score = 5.79
2023-04-21 00:42:17,103 - Detection -   train_loss = 2.7765721480051675
2023-04-21 00:42:31,937 - Detection - ***** Epoch: 4: Eval results *****
2023-04-21 00:42:31,937 - Detection -   best_eval_score = 5.79
2023-04-21 00:42:31,937 - Detection -   eval_score = 15.64
2023-04-21 00:42:31,938 - Detection -   train_loss = 2.624298652013143
2023-04-21 00:42:46,656 - Detection - ***** Epoch: 5: Eval results *****
2023-04-21 00:42:46,656 - Detection -   best_eval_score = 15.64
2023-04-21 00:42:46,656 - Detection -   eval_score = 32.52
2023-04-21 00:42:46,656 - Detection -   train_loss = 2.327929377555847
2023-04-21 00:43:01,568 - Detection - ***** Epoch: 6: Eval results *****
2023-04-21 00:43:01,568 - Detection -   best_eval_score = 32.52
2023-04-21 00:43:01,568 - Detection -   eval_score = 46.31
2023-04-21 00:43:01,568 - Detection -   train_loss = 1.9446783661842346
2023-04-21 00:43:16,316 - Detection - ***** Epoch: 7: Eval results *****
2023-04-21 00:43:16,317 - Detection -   best_eval_score = 46.31
2023-04-21 00:43:16,317 - Detection -   eval_score = 60.7
2023-04-21 00:43:16,317 - Detection -   train_loss = 1.576052228609721
2023-04-21 00:43:31,144 - Detection - ***** Epoch: 8: Eval results *****
2023-04-21 00:43:31,144 - Detection -   best_eval_score = 60.7
2023-04-21 00:43:31,144 - Detection -   eval_score = 74.1
2023-04-21 00:43:31,144 - Detection -   train_loss = 1.2535479068756104
2023-04-21 00:43:45,962 - Detection - ***** Epoch: 9: Eval results *****
2023-04-21 00:43:45,962 - Detection -   best_eval_score = 74.1
2023-04-21 00:43:45,962 - Detection -   eval_score = 73.59
2023-04-21 00:43:45,962 - Detection -   train_loss = 1.0307660301526387
2023-04-21 00:44:00,644 - Detection - ***** Epoch: 10: Eval results *****
2023-04-21 00:44:00,644 - Detection -   best_eval_score = 74.1
2023-04-21 00:44:00,644 - Detection -   eval_score = 76.55
2023-04-21 00:44:00,644 - Detection -   train_loss = 0.9037600258986155
2023-04-21 00:44:15,461 - Detection - ***** Epoch: 11: Eval results *****
2023-04-21 00:44:15,461 - Detection -   best_eval_score = 76.55
2023-04-21 00:44:15,461 - Detection -   eval_score = 78.2
2023-04-21 00:44:15,461 - Detection -   train_loss = 0.8092531661192576
2023-04-21 00:44:30,173 - Detection - ***** Epoch: 12: Eval results *****
2023-04-21 00:44:30,173 - Detection -   best_eval_score = 78.2
2023-04-21 00:44:30,173 - Detection -   eval_score = 79.2
2023-04-21 00:44:30,173 - Detection -   train_loss = 0.7400946120421091
2023-04-21 00:44:45,037 - Detection - ***** Epoch: 13: Eval results *****
2023-04-21 00:44:45,037 - Detection -   best_eval_score = 79.2
2023-04-21 00:44:45,037 - Detection -   eval_score = 82.62
2023-04-21 00:44:45,037 - Detection -   train_loss = 0.6853238344192505
2023-04-21 00:44:59,785 - Detection - ***** Epoch: 14: Eval results *****
2023-04-21 00:44:59,785 - Detection -   best_eval_score = 82.62
2023-04-21 00:44:59,785 - Detection -   eval_score = 82.64
2023-04-21 00:44:59,785 - Detection -   train_loss = 0.6506969432036082
2023-04-21 00:45:14,695 - Detection - ***** Epoch: 15: Eval results *****
2023-04-21 00:45:14,695 - Detection -   best_eval_score = 82.64
2023-04-21 00:45:14,695 - Detection -   eval_score = 81.78
2023-04-21 00:45:14,695 - Detection -   train_loss = 0.6173212826251984
2023-04-21 00:45:29,377 - Detection - ***** Epoch: 16: Eval results *****
2023-04-21 00:45:29,377 - Detection -   best_eval_score = 82.64
2023-04-21 00:45:29,377 - Detection -   eval_score = 83.32
2023-04-21 00:45:29,377 - Detection -   train_loss = 0.589393417040507
2023-04-21 00:45:44,211 - Detection - ***** Epoch: 17: Eval results *****
2023-04-21 00:45:44,212 - Detection -   best_eval_score = 83.32
2023-04-21 00:45:44,212 - Detection -   eval_score = 84.72
2023-04-21 00:45:44,212 - Detection -   train_loss = 0.5622944633165995
2023-04-21 00:45:58,987 - Detection - ***** Epoch: 18: Eval results *****
2023-04-21 00:45:58,987 - Detection -   best_eval_score = 84.72
2023-04-21 00:45:58,987 - Detection -   eval_score = 84.79
2023-04-21 00:45:58,987 - Detection -   train_loss = 0.5388048787911733
2023-04-21 00:46:13,837 - Detection - ***** Epoch: 19: Eval results *****
2023-04-21 00:46:13,837 - Detection -   best_eval_score = 84.79
2023-04-21 00:46:13,837 - Detection -   eval_score = 83.32
2023-04-21 00:46:13,837 - Detection -   train_loss = 0.525146966179212
2023-04-21 00:46:28,638 - Detection - ***** Epoch: 20: Eval results *****
2023-04-21 00:46:28,639 - Detection -   best_eval_score = 84.79
2023-04-21 00:46:28,639 - Detection -   eval_score = 86.45
2023-04-21 00:46:28,639 - Detection -   train_loss = 0.5125365753968557
2023-04-21 00:46:43,331 - Detection - ***** Epoch: 21: Eval results *****
2023-04-21 00:46:43,331 - Detection -   best_eval_score = 86.45
2023-04-21 00:46:43,331 - Detection -   eval_score = 84.93
2023-04-21 00:46:43,331 - Detection -   train_loss = 0.5010673602422079
2023-04-21 00:46:58,182 - Detection - ***** Epoch: 22: Eval results *****
2023-04-21 00:46:58,182 - Detection -   best_eval_score = 86.45
2023-04-21 00:46:58,182 - Detection -   eval_score = 85.73
2023-04-21 00:46:58,182 - Detection -   train_loss = 0.4920746684074402
2023-04-21 00:47:12,933 - Detection - ***** Epoch: 23: Eval results *****
2023-04-21 00:47:12,933 - Detection -   best_eval_score = 86.45
2023-04-21 00:47:12,933 - Detection -   eval_score = 85.96
2023-04-21 00:47:12,933 - Detection -   train_loss = 0.47817033032576245
2023-04-21 00:47:27,783 - Detection - ***** Epoch: 24: Eval results *****
2023-04-21 00:47:27,783 - Detection -   best_eval_score = 86.45
2023-04-21 00:47:27,783 - Detection -   eval_score = 85.73
2023-04-21 00:47:27,783 - Detection -   train_loss = 0.4683866699536641
2023-04-21 00:47:42,506 - Detection - ***** Epoch: 25: Eval results *****
2023-04-21 00:47:42,506 - Detection -   best_eval_score = 86.45
2023-04-21 00:47:42,506 - Detection -   eval_score = 85.73
2023-04-21 00:47:42,506 - Detection -   train_loss = 0.4602952152490616
2023-04-21 00:47:57,399 - Detection - ***** Epoch: 26: Eval results *****
2023-04-21 00:47:57,399 - Detection -   best_eval_score = 86.45
2023-04-21 00:47:57,399 - Detection -   eval_score = 85.73
2023-04-21 00:47:57,399 - Detection -   train_loss = 0.4526207447052002
2023-04-21 00:48:12,088 - Detection - ***** Epoch: 27: Eval results *****
2023-04-21 00:48:12,088 - Detection -   best_eval_score = 86.45
2023-04-21 00:48:12,088 - Detection -   eval_score = 84.84
2023-04-21 00:48:12,088 - Detection -   train_loss = 0.4461967796087265
2023-04-21 00:48:27,027 - Detection - ***** Epoch: 28: Eval results *****
2023-04-21 00:48:27,028 - Detection -   best_eval_score = 86.45
2023-04-21 00:48:27,028 - Detection -   eval_score = 86.45
2023-04-21 00:48:27,028 - Detection -   train_loss = 0.43934834996859234
2023-04-21 00:48:41,768 - Detection - ***** Epoch: 29: Eval results *****
2023-04-21 00:48:41,768 - Detection -   best_eval_score = 86.45
2023-04-21 00:48:41,768 - Detection -   eval_score = 85.73
2023-04-21 00:48:41,768 - Detection -   train_loss = 0.43536466856797534
2023-04-21 00:48:56,611 - Detection - ***** Epoch: 30: Eval results *****
2023-04-21 00:48:56,612 - Detection -   best_eval_score = 86.45
2023-04-21 00:48:56,612 - Detection -   eval_score = 85.73
2023-04-21 00:48:56,612 - Detection -   train_loss = 0.43600907425085705
2023-04-21 00:48:56,612 - Detection - Pre-training finished...
2023-04-21 00:48:56,612 - Detection - Training Begin...
2023-04-21 00:48:57,687 - Detection - ***** Epoch: 1: Eval results *****
2023-04-21 00:48:57,687 - Detection -   best_eval_score = 0
2023-04-21 00:48:57,687 - Detection -   eval_score = 2.35
2023-04-21 00:48:57,687 - Detection -   train_loss = 3.4280837774276733
2023-04-21 00:49:11,538 - Detection - ***** Epoch: 2: Eval results *****
2023-04-21 00:49:11,538 - Detection -   best_eval_score = 2.35
2023-04-21 00:49:11,538 - Detection -   eval_score = 59.23
2023-04-21 00:49:11,538 - Detection -   train_loss = 3.2540401220321655
2023-04-21 00:49:25,618 - Detection - ***** Epoch: 3: Eval results *****
2023-04-21 00:49:25,618 - Detection -   best_eval_score = 59.23
2023-04-21 00:49:25,618 - Detection -   eval_score = 62.3
2023-04-21 00:49:25,618 - Detection -   train_loss = 0.6622553865114847
2023-04-21 00:49:39,470 - Detection - ***** Epoch: 4: Eval results *****
2023-04-21 00:49:39,470 - Detection -   best_eval_score = 62.3
2023-04-21 00:49:39,471 - Detection -   eval_score = 61.91
2023-04-21 00:49:39,471 - Detection -   train_loss = 0.5848039587338766
2023-04-21 00:49:53,505 - Detection - ***** Epoch: 5: Eval results *****
2023-04-21 00:49:53,505 - Detection -   best_eval_score = 62.3
2023-04-21 00:49:53,505 - Detection -   eval_score = 61.91
2023-04-21 00:49:53,505 - Detection -   train_loss = 0.556228240331014
2023-04-21 00:50:07,538 - Detection - ***** Epoch: 6: Eval results *****
2023-04-21 00:50:07,538 - Detection -   best_eval_score = 62.3
2023-04-21 00:50:07,538 - Detection -   eval_score = 61.91
2023-04-21 00:50:07,538 - Detection -   train_loss = 0.5771737893422445
2023-04-21 00:50:21,397 - Detection - ***** Epoch: 7: Eval results *****
2023-04-21 00:50:21,397 - Detection -   best_eval_score = 62.3
2023-04-21 00:50:21,397 - Detection -   eval_score = 62.44
2023-04-21 00:50:21,397 - Detection -   train_loss = 0.5639775594075521
2023-04-21 00:50:35,343 - Detection - ***** Epoch: 8: Eval results *****
2023-04-21 00:50:35,344 - Detection -   best_eval_score = 62.44
2023-04-21 00:50:35,344 - Detection -   eval_score = 61.91
2023-04-21 00:50:35,344 - Detection -   train_loss = 0.56608447432518
2023-04-21 00:50:49,266 - Detection - ***** Epoch: 9: Eval results *****
2023-04-21 00:50:49,266 - Detection -   best_eval_score = 62.44
2023-04-21 00:50:49,266 - Detection -   eval_score = 62.44
2023-04-21 00:50:49,266 - Detection -   train_loss = 0.5982131063938141
2023-04-21 00:51:03,258 - Detection - ***** Epoch: 10: Eval results *****
2023-04-21 00:51:03,258 - Detection -   best_eval_score = 62.44
2023-04-21 00:51:03,258 - Detection -   eval_score = 61.91
2023-04-21 00:51:03,258 - Detection -   train_loss = 0.5696237782637278
2023-04-21 00:51:17,188 - Detection - ***** Epoch: 11: Eval results *****
2023-04-21 00:51:17,188 - Detection -   best_eval_score = 62.44
2023-04-21 00:51:17,188 - Detection -   eval_score = 62.44
2023-04-21 00:51:17,188 - Detection -   train_loss = 0.5511921048164368
2023-04-21 00:51:31,193 - Detection - ***** Epoch: 12: Eval results *****
2023-04-21 00:51:31,193 - Detection -   best_eval_score = 62.44
2023-04-21 00:51:31,193 - Detection -   eval_score = 61.91
2023-04-21 00:51:31,193 - Detection -   train_loss = 0.5795538524786631
2023-04-21 00:51:45,012 - Detection - ***** Epoch: 13: Eval results *****
2023-04-21 00:51:45,012 - Detection -   best_eval_score = 62.44
2023-04-21 00:51:45,012 - Detection -   eval_score = 62.44
2023-04-21 00:51:45,012 - Detection -   train_loss = 0.563807358344396
2023-04-21 00:51:58,858 - Detection - ***** Epoch: 14: Eval results *****
2023-04-21 00:51:58,858 - Detection -   best_eval_score = 62.44
2023-04-21 00:51:58,858 - Detection -   eval_score = 62.44
2023-04-21 00:51:58,858 - Detection -   train_loss = 0.5714960197607676
2023-04-21 00:52:12,812 - Detection - ***** Epoch: 15: Eval results *****
2023-04-21 00:52:12,812 - Detection -   best_eval_score = 62.44
2023-04-21 00:52:12,812 - Detection -   eval_score = 62.44
2023-04-21 00:52:12,812 - Detection -   train_loss = 0.5426249504089355
2023-04-21 00:52:26,801 - Detection - ***** Epoch: 16: Eval results *****
2023-04-21 00:52:26,801 - Detection -   best_eval_score = 62.44
2023-04-21 00:52:26,801 - Detection -   eval_score = 61.96
2023-04-21 00:52:26,801 - Detection -   train_loss = 0.5770025700330734
2023-04-21 00:52:40,643 - Detection - ***** Epoch: 17: Eval results *****
2023-04-21 00:52:40,643 - Detection -   best_eval_score = 62.44
2023-04-21 00:52:40,643 - Detection -   eval_score = 61.91
2023-04-21 00:52:40,643 - Detection -   train_loss = 0.5690142512321472
2023-04-21 00:52:40,643 - Detection - Training Finished...
2023-04-21 00:52:40,643 - Detection - Testing begin...
2023-04-21 00:52:42,536 - Detection - ***** Test: Confusion Matrix *****
2023-04-21 00:52:42,536 - Detection - [[   6    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0   10]
 [   0   18    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    4]
 [   0    0    1    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0   17]
 [   0    0    0   12    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0   19]
 [   0    0    0    0    1    0    0    0    0    0    0    0    0    0
     0    0    0    0    0   19]
 [   0    0    0    0    0   12    0    0    0    0    0    1    0    0
     0    0    0    0    0   14]
 [   0    0    0    0    0    0   21    0    0    0    0    0    0    0
     0    0    1    0    0    7]
 [   0    0    0    0    0    0    0    7    0    0    0    0    0    0
     0    0    0    0    0   13]
 [   0    0    0    0    0    0    0    0   24    0    0    0    0    0
     0    0    0    0    0    4]
 [   0    0    0    0    0    0    0    0    0   27    0    0    0    0
     0    0    0    0    0    3]
 [   0    0    0    0    0    0    0    0    0    0   14    0    0    0
     0    0    0    0    0    9]
 [   0    0    0    0    0    0    0    0    0    0    0   16    0    0
     0    0    0    0    0   10]
 [   0    0    0    0    0    0    0    0    0    0    0    0    6    0
     0    0    0    0    0   23]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    4
     0    0    0    5    0   14]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
    13    0    0    0    0    5]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0   24    0    0    0    9]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0   30    0    0    4]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    1
     0    0    0    2    0   21]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0   17    7]
 [   0   20    0   10    0   62   26    1   27   30   12    2    4    0
    16    1    8   17   13 1172]]
2023-04-21 00:52:42,536 - Detection - ***** Test results *****
2023-04-21 00:52:42,536 - Detection -   Acc = 75.26
2023-04-21 00:52:42,536 - Detection -   F1 = 49.7229
2023-04-21 00:52:42,536 - Detection -   F1-known = 47.9417
2023-04-21 00:52:42,536 - Detection -   F1-open = 83.5651
2023-04-21 00:52:42,536 - Detection - Testing finished...
2023-04-21 00:52:42,536 - Detection - Results saved in results/results_DA-ADB-BOOST.csv
2023-04-21 00:52:42,556 - Detection - Open Intent Detection Finished...
