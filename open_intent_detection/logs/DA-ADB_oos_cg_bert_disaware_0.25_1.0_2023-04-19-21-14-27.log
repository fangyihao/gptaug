2023-04-19 21:14:27,400 - Detection - Open Intent Detection Begin...
2023-04-19 21:14:27,401 - Detection - Parameters Initialization...
2023-04-19 21:14:27,401 - Detection - ============================== Params ==============================
2023-04-19 21:14:27,401 - Detection - type:	open_intent_detection
2023-04-19 21:14:27,401 - Detection - logger_name:	Detection
2023-04-19 21:14:27,401 - Detection - log_dir:	logs
2023-04-19 21:14:27,401 - Detection - dataset:	oos_cg
2023-04-19 21:14:27,401 - Detection - known_cls_ratio:	0.25
2023-04-19 21:14:27,401 - Detection - labeled_ratio:	1.0
2023-04-19 21:14:27,401 - Detection - method:	DA-ADB
2023-04-19 21:14:27,401 - Detection - train:	True
2023-04-19 21:14:27,401 - Detection - pretrain:	True
2023-04-19 21:14:27,401 - Detection - save_model:	True
2023-04-19 21:14:27,401 - Detection - backbone:	bert_disaware
2023-04-19 21:14:27,401 - Detection - config_file_name:	DA-ADB
2023-04-19 21:14:27,401 - Detection - seed:	0
2023-04-19 21:14:27,401 - Detection - gpu_id:	0
2023-04-19 21:14:27,401 - Detection - pipe_results_path:	pipe_results
2023-04-19 21:14:27,401 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-19 21:14:27,401 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-19 21:14:27,401 - Detection - model_dir:	models
2023-04-19 21:14:27,401 - Detection - load_pretrained_method:	None
2023-04-19 21:14:27,401 - Detection - result_dir:	results
2023-04-19 21:14:27,401 - Detection - results_file_name:	results_DA-ADB.csv
2023-04-19 21:14:27,401 - Detection - save_results:	True
2023-04-19 21:14:27,401 - Detection - loss_fct:	CrossEntropyLoss
2023-04-19 21:14:27,401 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_oos_cg_0.25_1.0_bert_disaware_0
2023-04-19 21:14:27,401 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_oos_cg_0.25_1.0_bert_disaware_0/models
2023-04-19 21:14:27,401 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-19 21:14:27,401 - Detection - num_train_epochs:	100
2023-04-19 21:14:27,401 - Detection - num_labels:	None
2023-04-19 21:14:27,401 - Detection - max_seq_length:	None
2023-04-19 21:14:27,401 - Detection - freeze_backbone_parameters:	True
2023-04-19 21:14:27,401 - Detection - feat_dim:	768
2023-04-19 21:14:27,401 - Detection - warmup_proportion:	0.1
2023-04-19 21:14:27,401 - Detection - scale:	4
2023-04-19 21:14:27,401 - Detection - lr_boundary:	0.05
2023-04-19 21:14:27,401 - Detection - lr:	2e-05
2023-04-19 21:14:27,401 - Detection - activation:	relu
2023-04-19 21:14:27,401 - Detection - train_batch_size:	128
2023-04-19 21:14:27,401 - Detection - eval_batch_size:	64
2023-04-19 21:14:27,401 - Detection - test_batch_size:	64
2023-04-19 21:14:27,401 - Detection - wait_patient:	10
2023-04-19 21:14:27,401 - Detection - ============================== End Params ==============================
2023-04-19 21:14:27,401 - Detection - Data and Model Preparation...
2023-04-19 21:14:27,402 - Detection - The number of known intents is 38
2023-04-19 21:14:27,402 - Detection - Lists of known labels are: ['spelling', 'jump_start', 'date', 'routing', 'bill_balance', 'reset_settings', 'expiration_date', 'play_music', 'no', 'min_payment', 'travel_suggestion', 'how_busy', 'new_card', 'income', 'last_maintenance', 'distance', 'oil_change_how', 'pto_request_status', 'freeze_account', 'cancel_reservation', 'time', 'maybe', 'change_user_name', 'bill_due', 'todo_list', 'change_language', 'food_last', 'replacement_card_duration', 'redeem_rewards', 'confirm_reservation', 'user_name', 'payday', 'cook_time', 'todo_list_update', 'travel_alert', 'interest_rate', 'card_declined', 'pay_bill']
2023-04-19 21:14:27,412 - Detection - Number of labeled training samples = 978
2023-04-19 21:14:27,412 - Detection - Number of unlabeled training samples = 2705
2023-04-19 21:14:27,415 - Detection - Number of evaluation samples = 386
2023-04-19 21:14:27,422 - Detection - Number of testing samples = 3632
2023-04-19 21:14:32,972 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-19 21:14:33,054 - Detection - Pre-training Begin...
2023-04-19 21:14:34,972 - Detection - ***** Epoch: 1: Eval results *****
2023-04-19 21:14:34,972 - Detection -   best_eval_score = 0
2023-04-19 21:14:34,972 - Detection -   eval_score = 0.15
2023-04-19 21:14:34,972 - Detection -   train_loss = 3.64817613363266
2023-04-19 21:14:36,394 - Detection - ***** Epoch: 2: Eval results *****
2023-04-19 21:14:36,394 - Detection -   best_eval_score = 0.15
2023-04-19 21:14:36,394 - Detection -   eval_score = 0.35
2023-04-19 21:14:36,394 - Detection -   train_loss = 3.6267094910144806
2023-04-19 21:14:37,818 - Detection - ***** Epoch: 3: Eval results *****
2023-04-19 21:14:37,818 - Detection -   best_eval_score = 0.35
2023-04-19 21:14:37,818 - Detection -   eval_score = 0.08
2023-04-19 21:14:37,818 - Detection -   train_loss = 3.584003984928131
2023-04-19 21:14:39,232 - Detection - ***** Epoch: 4: Eval results *****
2023-04-19 21:14:39,232 - Detection -   best_eval_score = 0.35
2023-04-19 21:14:39,232 - Detection -   eval_score = 0.19
2023-04-19 21:14:39,233 - Detection -   train_loss = 3.53739270567894
2023-04-19 21:14:40,647 - Detection - ***** Epoch: 5: Eval results *****
2023-04-19 21:14:40,648 - Detection -   best_eval_score = 0.35
2023-04-19 21:14:40,648 - Detection -   eval_score = 0.26
2023-04-19 21:14:40,648 - Detection -   train_loss = 3.497279018163681
2023-04-19 21:14:42,064 - Detection - ***** Epoch: 6: Eval results *****
2023-04-19 21:14:42,064 - Detection -   best_eval_score = 0.35
2023-04-19 21:14:42,064 - Detection -   eval_score = 1.76
2023-04-19 21:14:42,065 - Detection -   train_loss = 3.454718679189682
2023-04-19 21:14:43,493 - Detection - ***** Epoch: 7: Eval results *****
2023-04-19 21:14:43,493 - Detection -   best_eval_score = 1.76
2023-04-19 21:14:43,493 - Detection -   eval_score = 3.88
2023-04-19 21:14:43,493 - Detection -   train_loss = 3.381998896598816
2023-04-19 21:14:44,923 - Detection - ***** Epoch: 8: Eval results *****
2023-04-19 21:14:44,923 - Detection -   best_eval_score = 3.88
2023-04-19 21:14:44,923 - Detection -   eval_score = 5.96
2023-04-19 21:14:44,923 - Detection -   train_loss = 3.2741929590702057
2023-04-19 21:14:46,351 - Detection - ***** Epoch: 9: Eval results *****
2023-04-19 21:14:46,351 - Detection -   best_eval_score = 5.96
2023-04-19 21:14:46,351 - Detection -   eval_score = 8.81
2023-04-19 21:14:46,351 - Detection -   train_loss = 3.125873029232025
2023-04-19 21:14:47,884 - Detection - ***** Epoch: 10: Eval results *****
2023-04-19 21:14:47,884 - Detection -   best_eval_score = 8.81
2023-04-19 21:14:47,884 - Detection -   eval_score = 10.95
2023-04-19 21:14:47,884 - Detection -   train_loss = 2.9549012184143066
2023-04-19 21:14:49,317 - Detection - ***** Epoch: 11: Eval results *****
2023-04-19 21:14:49,317 - Detection -   best_eval_score = 10.95
2023-04-19 21:14:49,317 - Detection -   eval_score = 15.1
2023-04-19 21:14:49,317 - Detection -   train_loss = 2.7677323818206787
2023-04-19 21:14:50,750 - Detection - ***** Epoch: 12: Eval results *****
2023-04-19 21:14:50,750 - Detection -   best_eval_score = 15.1
2023-04-19 21:14:50,750 - Detection -   eval_score = 20.67
2023-04-19 21:14:50,750 - Detection -   train_loss = 2.5737428069114685
2023-04-19 21:14:52,183 - Detection - ***** Epoch: 13: Eval results *****
2023-04-19 21:14:52,183 - Detection -   best_eval_score = 20.67
2023-04-19 21:14:52,183 - Detection -   eval_score = 27.32
2023-04-19 21:14:52,183 - Detection -   train_loss = 2.387597918510437
2023-04-19 21:14:53,618 - Detection - ***** Epoch: 14: Eval results *****
2023-04-19 21:14:53,618 - Detection -   best_eval_score = 27.32
2023-04-19 21:14:53,618 - Detection -   eval_score = 30.33
2023-04-19 21:14:53,618 - Detection -   train_loss = 2.2320207059383392
2023-04-19 21:14:55,052 - Detection - ***** Epoch: 15: Eval results *****
2023-04-19 21:14:55,052 - Detection -   best_eval_score = 30.33
2023-04-19 21:14:55,052 - Detection -   eval_score = 35.64
2023-04-19 21:14:55,052 - Detection -   train_loss = 2.105606183409691
2023-04-19 21:14:56,489 - Detection - ***** Epoch: 16: Eval results *****
2023-04-19 21:14:56,489 - Detection -   best_eval_score = 35.64
2023-04-19 21:14:56,489 - Detection -   eval_score = 37.26
2023-04-19 21:14:56,489 - Detection -   train_loss = 1.9984606057405472
2023-04-19 21:14:57,925 - Detection - ***** Epoch: 17: Eval results *****
2023-04-19 21:14:57,925 - Detection -   best_eval_score = 37.26
2023-04-19 21:14:57,925 - Detection -   eval_score = 41.55
2023-04-19 21:14:57,925 - Detection -   train_loss = 1.9131821990013123
2023-04-19 21:14:59,361 - Detection - ***** Epoch: 18: Eval results *****
2023-04-19 21:14:59,361 - Detection -   best_eval_score = 41.55
2023-04-19 21:14:59,361 - Detection -   eval_score = 45.92
2023-04-19 21:14:59,361 - Detection -   train_loss = 1.8435321897268295
2023-04-19 21:15:00,799 - Detection - ***** Epoch: 19: Eval results *****
2023-04-19 21:15:00,799 - Detection -   best_eval_score = 45.92
2023-04-19 21:15:00,799 - Detection -   eval_score = 47.67
2023-04-19 21:15:00,799 - Detection -   train_loss = 1.7658800333738327
2023-04-19 21:15:02,236 - Detection - ***** Epoch: 20: Eval results *****
2023-04-19 21:15:02,236 - Detection -   best_eval_score = 47.67
2023-04-19 21:15:02,236 - Detection -   eval_score = 49.33
2023-04-19 21:15:02,236 - Detection -   train_loss = 1.7122808694839478
2023-04-19 21:15:03,674 - Detection - ***** Epoch: 21: Eval results *****
2023-04-19 21:15:03,674 - Detection -   best_eval_score = 49.33
2023-04-19 21:15:03,674 - Detection -   eval_score = 51.64
2023-04-19 21:15:03,674 - Detection -   train_loss = 1.6736561805009842
2023-04-19 21:15:05,119 - Detection - ***** Epoch: 22: Eval results *****
2023-04-19 21:15:05,119 - Detection -   best_eval_score = 51.64
2023-04-19 21:15:05,119 - Detection -   eval_score = 52.72
2023-04-19 21:15:05,119 - Detection -   train_loss = 1.630196526646614
2023-04-19 21:15:06,560 - Detection - ***** Epoch: 23: Eval results *****
2023-04-19 21:15:06,560 - Detection -   best_eval_score = 52.72
2023-04-19 21:15:06,561 - Detection -   eval_score = 54.72
2023-04-19 21:15:06,561 - Detection -   train_loss = 1.5993821024894714
2023-04-19 21:15:08,003 - Detection - ***** Epoch: 24: Eval results *****
2023-04-19 21:15:08,003 - Detection -   best_eval_score = 54.72
2023-04-19 21:15:08,003 - Detection -   eval_score = 56.36
2023-04-19 21:15:08,003 - Detection -   train_loss = 1.5609238296747208
2023-04-19 21:15:09,445 - Detection - ***** Epoch: 25: Eval results *****
2023-04-19 21:15:09,446 - Detection -   best_eval_score = 56.36
2023-04-19 21:15:09,446 - Detection -   eval_score = 57.11
2023-04-19 21:15:09,446 - Detection -   train_loss = 1.5283312052488327
2023-04-19 21:15:10,888 - Detection - ***** Epoch: 26: Eval results *****
2023-04-19 21:15:10,888 - Detection -   best_eval_score = 57.11
2023-04-19 21:15:10,888 - Detection -   eval_score = 58.68
2023-04-19 21:15:10,888 - Detection -   train_loss = 1.5039400160312653
2023-04-19 21:15:12,332 - Detection - ***** Epoch: 27: Eval results *****
2023-04-19 21:15:12,332 - Detection -   best_eval_score = 58.68
2023-04-19 21:15:12,332 - Detection -   eval_score = 59.7
2023-04-19 21:15:12,332 - Detection -   train_loss = 1.4753910154104233
2023-04-19 21:15:13,777 - Detection - ***** Epoch: 28: Eval results *****
2023-04-19 21:15:13,777 - Detection -   best_eval_score = 59.7
2023-04-19 21:15:13,777 - Detection -   eval_score = 60.31
2023-04-19 21:15:13,777 - Detection -   train_loss = 1.4470713585615158
2023-04-19 21:15:15,222 - Detection - ***** Epoch: 29: Eval results *****
2023-04-19 21:15:15,222 - Detection -   best_eval_score = 60.31
2023-04-19 21:15:15,222 - Detection -   eval_score = 61.04
2023-04-19 21:15:15,222 - Detection -   train_loss = 1.4316374957561493
2023-04-19 21:15:16,669 - Detection - ***** Epoch: 30: Eval results *****
2023-04-19 21:15:16,670 - Detection -   best_eval_score = 61.04
2023-04-19 21:15:16,670 - Detection -   eval_score = 61.29
2023-04-19 21:15:16,670 - Detection -   train_loss = 1.4142824709415436
2023-04-19 21:15:18,116 - Detection - ***** Epoch: 31: Eval results *****
2023-04-19 21:15:18,116 - Detection -   best_eval_score = 61.29
2023-04-19 21:15:18,116 - Detection -   eval_score = 61.49
2023-04-19 21:15:18,116 - Detection -   train_loss = 1.3958831876516342
2023-04-19 21:15:19,563 - Detection - ***** Epoch: 32: Eval results *****
2023-04-19 21:15:19,563 - Detection -   best_eval_score = 61.49
2023-04-19 21:15:19,563 - Detection -   eval_score = 62.29
2023-04-19 21:15:19,563 - Detection -   train_loss = 1.3741372227668762
2023-04-19 21:15:21,110 - Detection - ***** Epoch: 33: Eval results *****
2023-04-19 21:15:21,110 - Detection -   best_eval_score = 62.29
2023-04-19 21:15:21,110 - Detection -   eval_score = 62.39
2023-04-19 21:15:21,110 - Detection -   train_loss = 1.3603554666042328
2023-04-19 21:15:22,558 - Detection - ***** Epoch: 34: Eval results *****
2023-04-19 21:15:22,558 - Detection -   best_eval_score = 62.39
2023-04-19 21:15:22,558 - Detection -   eval_score = 63.16
2023-04-19 21:15:22,558 - Detection -   train_loss = 1.3456331640481949
2023-04-19 21:15:24,003 - Detection - ***** Epoch: 35: Eval results *****
2023-04-19 21:15:24,003 - Detection -   best_eval_score = 63.16
2023-04-19 21:15:24,003 - Detection -   eval_score = 62.95
2023-04-19 21:15:24,003 - Detection -   train_loss = 1.3353272825479507
2023-04-19 21:15:25,437 - Detection - ***** Epoch: 36: Eval results *****
2023-04-19 21:15:25,437 - Detection -   best_eval_score = 63.16
2023-04-19 21:15:25,437 - Detection -   eval_score = 63.08
2023-04-19 21:15:25,437 - Detection -   train_loss = 1.3256426900625229
2023-04-19 21:15:26,872 - Detection - ***** Epoch: 37: Eval results *****
2023-04-19 21:15:26,872 - Detection -   best_eval_score = 63.16
2023-04-19 21:15:26,872 - Detection -   eval_score = 63.24
2023-04-19 21:15:26,873 - Detection -   train_loss = 1.3103312999010086
2023-04-19 21:15:28,321 - Detection - ***** Epoch: 38: Eval results *****
2023-04-19 21:15:28,321 - Detection -   best_eval_score = 63.24
2023-04-19 21:15:28,321 - Detection -   eval_score = 63.48
2023-04-19 21:15:28,321 - Detection -   train_loss = 1.2979396432638168
2023-04-19 21:15:29,771 - Detection - ***** Epoch: 39: Eval results *****
2023-04-19 21:15:29,771 - Detection -   best_eval_score = 63.48
2023-04-19 21:15:29,771 - Detection -   eval_score = 63.97
2023-04-19 21:15:29,771 - Detection -   train_loss = 1.2901554554700851
2023-04-19 21:15:31,224 - Detection - ***** Epoch: 40: Eval results *****
2023-04-19 21:15:31,224 - Detection -   best_eval_score = 63.97
2023-04-19 21:15:31,224 - Detection -   eval_score = 64.68
2023-04-19 21:15:31,224 - Detection -   train_loss = 1.2788114696741104
2023-04-19 21:15:32,675 - Detection - ***** Epoch: 41: Eval results *****
2023-04-19 21:15:32,675 - Detection -   best_eval_score = 64.68
2023-04-19 21:15:32,675 - Detection -   eval_score = 64.85
2023-04-19 21:15:32,675 - Detection -   train_loss = 1.2701705247163773
2023-04-19 21:15:34,127 - Detection - ***** Epoch: 42: Eval results *****
2023-04-19 21:15:34,127 - Detection -   best_eval_score = 64.85
2023-04-19 21:15:34,127 - Detection -   eval_score = 64.73
2023-04-19 21:15:34,127 - Detection -   train_loss = 1.2644817978143692
2023-04-19 21:15:35,568 - Detection - ***** Epoch: 43: Eval results *****
2023-04-19 21:15:35,568 - Detection -   best_eval_score = 64.85
2023-04-19 21:15:35,568 - Detection -   eval_score = 64.83
2023-04-19 21:15:35,568 - Detection -   train_loss = 1.2483409196138382
2023-04-19 21:15:37,007 - Detection - ***** Epoch: 44: Eval results *****
2023-04-19 21:15:37,007 - Detection -   best_eval_score = 64.85
2023-04-19 21:15:37,007 - Detection -   eval_score = 65.93
2023-04-19 21:15:37,007 - Detection -   train_loss = 1.2440061271190643
2023-04-19 21:15:38,460 - Detection - ***** Epoch: 45: Eval results *****
2023-04-19 21:15:38,460 - Detection -   best_eval_score = 65.93
2023-04-19 21:15:38,460 - Detection -   eval_score = 66.87
2023-04-19 21:15:38,460 - Detection -   train_loss = 1.2348010390996933
2023-04-19 21:15:39,909 - Detection - ***** Epoch: 46: Eval results *****
2023-04-19 21:15:39,909 - Detection -   best_eval_score = 66.87
2023-04-19 21:15:39,909 - Detection -   eval_score = 66.66
2023-04-19 21:15:39,909 - Detection -   train_loss = 1.228762224316597
2023-04-19 21:15:41,345 - Detection - ***** Epoch: 47: Eval results *****
2023-04-19 21:15:41,346 - Detection -   best_eval_score = 66.87
2023-04-19 21:15:41,346 - Detection -   eval_score = 66.42
2023-04-19 21:15:41,346 - Detection -   train_loss = 1.2170040607452393
2023-04-19 21:15:42,785 - Detection - ***** Epoch: 48: Eval results *****
2023-04-19 21:15:42,785 - Detection -   best_eval_score = 66.87
2023-04-19 21:15:42,785 - Detection -   eval_score = 66.34
2023-04-19 21:15:42,785 - Detection -   train_loss = 1.213404655456543
2023-04-19 21:15:44,224 - Detection - ***** Epoch: 49: Eval results *****
2023-04-19 21:15:44,224 - Detection -   best_eval_score = 66.87
2023-04-19 21:15:44,224 - Detection -   eval_score = 66.82
2023-04-19 21:15:44,224 - Detection -   train_loss = 1.204151213169098
2023-04-19 21:15:45,662 - Detection - ***** Epoch: 50: Eval results *****
2023-04-19 21:15:45,662 - Detection -   best_eval_score = 66.87
2023-04-19 21:15:45,663 - Detection -   eval_score = 66.82
2023-04-19 21:15:45,663 - Detection -   train_loss = 1.1987517327070236
2023-04-19 21:15:47,100 - Detection - ***** Epoch: 51: Eval results *****
2023-04-19 21:15:47,100 - Detection -   best_eval_score = 66.87
2023-04-19 21:15:47,100 - Detection -   eval_score = 67.1
2023-04-19 21:15:47,100 - Detection -   train_loss = 1.1917968094348907
2023-04-19 21:15:48,550 - Detection - ***** Epoch: 52: Eval results *****
2023-04-19 21:15:48,550 - Detection -   best_eval_score = 67.1
2023-04-19 21:15:48,550 - Detection -   eval_score = 67.55
2023-04-19 21:15:48,550 - Detection -   train_loss = 1.1911612451076508
2023-04-19 21:15:50,000 - Detection - ***** Epoch: 53: Eval results *****
2023-04-19 21:15:50,000 - Detection -   best_eval_score = 67.55
2023-04-19 21:15:50,000 - Detection -   eval_score = 67.21
2023-04-19 21:15:50,000 - Detection -   train_loss = 1.1902315765619278
2023-04-19 21:15:51,438 - Detection - ***** Epoch: 54: Eval results *****
2023-04-19 21:15:51,438 - Detection -   best_eval_score = 67.55
2023-04-19 21:15:51,438 - Detection -   eval_score = 67.31
2023-04-19 21:15:51,438 - Detection -   train_loss = 1.1803525537252426
2023-04-19 21:15:52,876 - Detection - ***** Epoch: 55: Eval results *****
2023-04-19 21:15:52,876 - Detection -   best_eval_score = 67.55
2023-04-19 21:15:52,876 - Detection -   eval_score = 68.04
2023-04-19 21:15:52,876 - Detection -   train_loss = 1.171846717596054
2023-04-19 21:15:54,322 - Detection - ***** Epoch: 56: Eval results *****
2023-04-19 21:15:54,322 - Detection -   best_eval_score = 68.04
2023-04-19 21:15:54,322 - Detection -   eval_score = 68.34
2023-04-19 21:15:54,322 - Detection -   train_loss = 1.1694564670324326
2023-04-19 21:15:55,768 - Detection - ***** Epoch: 57: Eval results *****
2023-04-19 21:15:55,768 - Detection -   best_eval_score = 68.34
2023-04-19 21:15:55,768 - Detection -   eval_score = 67.87
2023-04-19 21:15:55,768 - Detection -   train_loss = 1.1657842546701431
2023-04-19 21:15:57,203 - Detection - ***** Epoch: 58: Eval results *****
2023-04-19 21:15:57,204 - Detection -   best_eval_score = 68.34
2023-04-19 21:15:57,204 - Detection -   eval_score = 68.63
2023-04-19 21:15:57,204 - Detection -   train_loss = 1.1642342954874039
2023-04-19 21:15:58,653 - Detection - ***** Epoch: 59: Eval results *****
2023-04-19 21:15:58,653 - Detection -   best_eval_score = 68.63
2023-04-19 21:15:58,653 - Detection -   eval_score = 69.46
2023-04-19 21:15:58,653 - Detection -   train_loss = 1.1606542468070984
2023-04-19 21:16:00,100 - Detection - ***** Epoch: 60: Eval results *****
2023-04-19 21:16:00,100 - Detection -   best_eval_score = 69.46
2023-04-19 21:16:00,100 - Detection -   eval_score = 69.31
2023-04-19 21:16:00,100 - Detection -   train_loss = 1.1586286574602127
2023-04-19 21:16:01,534 - Detection - ***** Epoch: 61: Eval results *****
2023-04-19 21:16:01,534 - Detection -   best_eval_score = 69.46
2023-04-19 21:16:01,534 - Detection -   eval_score = 69.36
2023-04-19 21:16:01,534 - Detection -   train_loss = 1.1557123214006424
2023-04-19 21:16:02,969 - Detection - ***** Epoch: 62: Eval results *****
2023-04-19 21:16:02,969 - Detection -   best_eval_score = 69.46
2023-04-19 21:16:02,969 - Detection -   eval_score = 70.19
2023-04-19 21:16:02,969 - Detection -   train_loss = 1.1462190598249435
2023-04-19 21:16:04,415 - Detection - ***** Epoch: 63: Eval results *****
2023-04-19 21:16:04,415 - Detection -   best_eval_score = 70.19
2023-04-19 21:16:04,415 - Detection -   eval_score = 70.5
2023-04-19 21:16:04,415 - Detection -   train_loss = 1.1449039280414581
2023-04-19 21:16:05,862 - Detection - ***** Epoch: 64: Eval results *****
2023-04-19 21:16:05,862 - Detection -   best_eval_score = 70.5
2023-04-19 21:16:05,862 - Detection -   eval_score = 70.78
2023-04-19 21:16:05,862 - Detection -   train_loss = 1.1448381692171097
2023-04-19 21:16:07,310 - Detection - ***** Epoch: 65: Eval results *****
2023-04-19 21:16:07,310 - Detection -   best_eval_score = 70.78
2023-04-19 21:16:07,310 - Detection -   eval_score = 70.82
2023-04-19 21:16:07,310 - Detection -   train_loss = 1.1363484561443329
2023-04-19 21:16:08,757 - Detection - ***** Epoch: 66: Eval results *****
2023-04-19 21:16:08,757 - Detection -   best_eval_score = 70.82
2023-04-19 21:16:08,757 - Detection -   eval_score = 70.79
2023-04-19 21:16:08,757 - Detection -   train_loss = 1.1352386772632599
2023-04-19 21:16:10,294 - Detection - ***** Epoch: 67: Eval results *****
2023-04-19 21:16:10,294 - Detection -   best_eval_score = 70.82
2023-04-19 21:16:10,294 - Detection -   eval_score = 70.79
2023-04-19 21:16:10,294 - Detection -   train_loss = 1.1301223784685135
2023-04-19 21:16:11,730 - Detection - ***** Epoch: 68: Eval results *****
2023-04-19 21:16:11,730 - Detection -   best_eval_score = 70.82
2023-04-19 21:16:11,730 - Detection -   eval_score = 70.98
2023-04-19 21:16:11,730 - Detection -   train_loss = 1.1338859051465988
2023-04-19 21:16:13,176 - Detection - ***** Epoch: 69: Eval results *****
2023-04-19 21:16:13,176 - Detection -   best_eval_score = 70.98
2023-04-19 21:16:13,176 - Detection -   eval_score = 70.98
2023-04-19 21:16:13,176 - Detection -   train_loss = 1.1343244165182114
2023-04-19 21:16:14,611 - Detection - ***** Epoch: 70: Eval results *****
2023-04-19 21:16:14,612 - Detection -   best_eval_score = 70.98
2023-04-19 21:16:14,612 - Detection -   eval_score = 70.81
2023-04-19 21:16:14,612 - Detection -   train_loss = 1.1333521008491516
2023-04-19 21:16:16,046 - Detection - ***** Epoch: 71: Eval results *****
2023-04-19 21:16:16,046 - Detection -   best_eval_score = 70.98
2023-04-19 21:16:16,046 - Detection -   eval_score = 70.8
2023-04-19 21:16:16,046 - Detection -   train_loss = 1.126354455947876
2023-04-19 21:16:17,480 - Detection - ***** Epoch: 72: Eval results *****
2023-04-19 21:16:17,480 - Detection -   best_eval_score = 70.98
2023-04-19 21:16:17,480 - Detection -   eval_score = 71.31
2023-04-19 21:16:17,480 - Detection -   train_loss = 1.1219332367181778
2023-04-19 21:16:18,925 - Detection - ***** Epoch: 73: Eval results *****
2023-04-19 21:16:18,925 - Detection -   best_eval_score = 71.31
2023-04-19 21:16:18,926 - Detection -   eval_score = 71.31
2023-04-19 21:16:18,926 - Detection -   train_loss = 1.1251571625471115
2023-04-19 21:16:20,361 - Detection - ***** Epoch: 74: Eval results *****
2023-04-19 21:16:20,361 - Detection -   best_eval_score = 71.31
2023-04-19 21:16:20,361 - Detection -   eval_score = 70.61
2023-04-19 21:16:20,361 - Detection -   train_loss = 1.118392989039421
2023-04-19 21:16:21,796 - Detection - ***** Epoch: 75: Eval results *****
2023-04-19 21:16:21,796 - Detection -   best_eval_score = 71.31
2023-04-19 21:16:21,796 - Detection -   eval_score = 71.11
2023-04-19 21:16:21,796 - Detection -   train_loss = 1.1159566938877106
2023-04-19 21:16:23,231 - Detection - ***** Epoch: 76: Eval results *****
2023-04-19 21:16:23,231 - Detection -   best_eval_score = 71.31
2023-04-19 21:16:23,231 - Detection -   eval_score = 71.49
2023-04-19 21:16:23,231 - Detection -   train_loss = 1.1208484768867493
2023-04-19 21:16:24,677 - Detection - ***** Epoch: 77: Eval results *****
2023-04-19 21:16:24,677 - Detection -   best_eval_score = 71.49
2023-04-19 21:16:24,677 - Detection -   eval_score = 71.49
2023-04-19 21:16:24,677 - Detection -   train_loss = 1.1131832152605057
2023-04-19 21:16:26,111 - Detection - ***** Epoch: 78: Eval results *****
2023-04-19 21:16:26,111 - Detection -   best_eval_score = 71.49
2023-04-19 21:16:26,111 - Detection -   eval_score = 71.49
2023-04-19 21:16:26,111 - Detection -   train_loss = 1.1167356818914413
2023-04-19 21:16:27,546 - Detection - ***** Epoch: 79: Eval results *****
2023-04-19 21:16:27,546 - Detection -   best_eval_score = 71.49
2023-04-19 21:16:27,546 - Detection -   eval_score = 71.63
2023-04-19 21:16:27,546 - Detection -   train_loss = 1.113871082663536
2023-04-19 21:16:28,996 - Detection - ***** Epoch: 80: Eval results *****
2023-04-19 21:16:28,996 - Detection -   best_eval_score = 71.63
2023-04-19 21:16:28,996 - Detection -   eval_score = 71.63
2023-04-19 21:16:28,996 - Detection -   train_loss = 1.1103066802024841
2023-04-19 21:16:30,431 - Detection - ***** Epoch: 81: Eval results *****
2023-04-19 21:16:30,431 - Detection -   best_eval_score = 71.63
2023-04-19 21:16:30,431 - Detection -   eval_score = 71.3
2023-04-19 21:16:30,431 - Detection -   train_loss = 1.1115298867225647
2023-04-19 21:16:31,867 - Detection - ***** Epoch: 82: Eval results *****
2023-04-19 21:16:31,867 - Detection -   best_eval_score = 71.63
2023-04-19 21:16:31,867 - Detection -   eval_score = 71.3
2023-04-19 21:16:31,867 - Detection -   train_loss = 1.1101226508617401
2023-04-19 21:16:33,304 - Detection - ***** Epoch: 83: Eval results *****
2023-04-19 21:16:33,304 - Detection -   best_eval_score = 71.63
2023-04-19 21:16:33,304 - Detection -   eval_score = 71.3
2023-04-19 21:16:33,304 - Detection -   train_loss = 1.11496402323246
2023-04-19 21:16:34,739 - Detection - ***** Epoch: 84: Eval results *****
2023-04-19 21:16:34,740 - Detection -   best_eval_score = 71.63
2023-04-19 21:16:34,740 - Detection -   eval_score = 71.63
2023-04-19 21:16:34,740 - Detection -   train_loss = 1.1108674257993698
2023-04-19 21:16:36,175 - Detection - ***** Epoch: 85: Eval results *****
2023-04-19 21:16:36,175 - Detection -   best_eval_score = 71.63
2023-04-19 21:16:36,175 - Detection -   eval_score = 71.63
2023-04-19 21:16:36,175 - Detection -   train_loss = 1.1096557080745697
2023-04-19 21:16:37,610 - Detection - ***** Epoch: 86: Eval results *****
2023-04-19 21:16:37,610 - Detection -   best_eval_score = 71.63
2023-04-19 21:16:37,610 - Detection -   eval_score = 71.63
2023-04-19 21:16:37,610 - Detection -   train_loss = 1.110261783003807
2023-04-19 21:16:39,047 - Detection - ***** Epoch: 87: Eval results *****
2023-04-19 21:16:39,047 - Detection -   best_eval_score = 71.63
2023-04-19 21:16:39,047 - Detection -   eval_score = 71.63
2023-04-19 21:16:39,047 - Detection -   train_loss = 1.1088856309652328
2023-04-19 21:16:40,483 - Detection - ***** Epoch: 88: Eval results *****
2023-04-19 21:16:40,483 - Detection -   best_eval_score = 71.63
2023-04-19 21:16:40,483 - Detection -   eval_score = 71.63
2023-04-19 21:16:40,483 - Detection -   train_loss = 1.1105621010065079
2023-04-19 21:16:41,918 - Detection - ***** Epoch: 89: Eval results *****
2023-04-19 21:16:41,919 - Detection -   best_eval_score = 71.63
2023-04-19 21:16:41,919 - Detection -   eval_score = 71.63
2023-04-19 21:16:41,919 - Detection -   train_loss = 1.1113944947719574
2023-04-19 21:16:41,919 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_oos_cg_0.25_1.0_bert_disaware_0/models
2023-04-19 21:16:42,468 - Detection - Pre-training finished...
2023-04-19 21:16:42,468 - Detection - Training Begin...
2023-04-19 21:16:43,323 - Detection - ***** Epoch: 1: Eval results *****
2023-04-19 21:16:43,323 - Detection -   best_eval_score = 0
2023-04-19 21:16:43,323 - Detection -   eval_score = 0.0
2023-04-19 21:16:43,323 - Detection -   train_loss = 3.039245456457138
2023-04-19 21:16:44,181 - Detection - ***** Epoch: 2: Eval results *****
2023-04-19 21:16:44,181 - Detection -   best_eval_score = 0
2023-04-19 21:16:44,181 - Detection -   eval_score = 0.51
2023-04-19 21:16:44,181 - Detection -   train_loss = 2.80527001619339
2023-04-19 21:16:45,037 - Detection - ***** Epoch: 3: Eval results *****
2023-04-19 21:16:45,037 - Detection -   best_eval_score = 0.51
2023-04-19 21:16:45,037 - Detection -   eval_score = 2.33
2023-04-19 21:16:45,037 - Detection -   train_loss = 2.5749293863773346
2023-04-19 21:16:45,894 - Detection - ***** Epoch: 4: Eval results *****
2023-04-19 21:16:45,895 - Detection -   best_eval_score = 2.33
2023-04-19 21:16:45,895 - Detection -   eval_score = 4.33
2023-04-19 21:16:45,895 - Detection -   train_loss = 2.3580737709999084
2023-04-19 21:16:46,751 - Detection - ***** Epoch: 5: Eval results *****
2023-04-19 21:16:46,751 - Detection -   best_eval_score = 4.33
2023-04-19 21:16:46,751 - Detection -   eval_score = 5.71
2023-04-19 21:16:46,751 - Detection -   train_loss = 2.0462813079357147
2023-04-19 21:16:47,608 - Detection - ***** Epoch: 6: Eval results *****
2023-04-19 21:16:47,608 - Detection -   best_eval_score = 5.71
2023-04-19 21:16:47,608 - Detection -   eval_score = 7.24
2023-04-19 21:16:47,608 - Detection -   train_loss = 1.7455715090036392
2023-04-19 21:16:48,466 - Detection - ***** Epoch: 7: Eval results *****
2023-04-19 21:16:48,467 - Detection -   best_eval_score = 7.24
2023-04-19 21:16:48,467 - Detection -   eval_score = 11.31
2023-04-19 21:16:48,467 - Detection -   train_loss = 1.4184406846761703
2023-04-19 21:16:49,324 - Detection - ***** Epoch: 8: Eval results *****
2023-04-19 21:16:49,324 - Detection -   best_eval_score = 11.31
2023-04-19 21:16:49,324 - Detection -   eval_score = 18.44
2023-04-19 21:16:49,324 - Detection -   train_loss = 1.0995955765247345
2023-04-19 21:16:50,181 - Detection - ***** Epoch: 9: Eval results *****
2023-04-19 21:16:50,181 - Detection -   best_eval_score = 18.44
2023-04-19 21:16:50,181 - Detection -   eval_score = 21.33
2023-04-19 21:16:50,181 - Detection -   train_loss = 0.8468186780810356
2023-04-19 21:16:51,037 - Detection - ***** Epoch: 10: Eval results *****
2023-04-19 21:16:51,038 - Detection -   best_eval_score = 21.33
2023-04-19 21:16:51,038 - Detection -   eval_score = 25.6
2023-04-19 21:16:51,038 - Detection -   train_loss = 0.6370272487401962
2023-04-19 21:16:51,895 - Detection - ***** Epoch: 11: Eval results *****
2023-04-19 21:16:51,895 - Detection -   best_eval_score = 25.6
2023-04-19 21:16:51,895 - Detection -   eval_score = 29.81
2023-04-19 21:16:51,895 - Detection -   train_loss = 0.5218564569950104
2023-04-19 21:16:52,754 - Detection - ***** Epoch: 12: Eval results *****
2023-04-19 21:16:52,754 - Detection -   best_eval_score = 29.81
2023-04-19 21:16:52,754 - Detection -   eval_score = 31.27
2023-04-19 21:16:52,754 - Detection -   train_loss = 0.4660189412534237
2023-04-19 21:16:53,611 - Detection - ***** Epoch: 13: Eval results *****
2023-04-19 21:16:53,611 - Detection -   best_eval_score = 31.27
2023-04-19 21:16:53,611 - Detection -   eval_score = 31.47
2023-04-19 21:16:53,611 - Detection -   train_loss = 0.4793679229915142
2023-04-19 21:16:54,468 - Detection - ***** Epoch: 14: Eval results *****
2023-04-19 21:16:54,468 - Detection -   best_eval_score = 31.47
2023-04-19 21:16:54,468 - Detection -   eval_score = 31.0
2023-04-19 21:16:54,468 - Detection -   train_loss = 0.4545644484460354
2023-04-19 21:16:55,324 - Detection - ***** Epoch: 15: Eval results *****
2023-04-19 21:16:55,324 - Detection -   best_eval_score = 31.47
2023-04-19 21:16:55,324 - Detection -   eval_score = 31.46
2023-04-19 21:16:55,324 - Detection -   train_loss = 0.4661596529185772
2023-04-19 21:16:56,181 - Detection - ***** Epoch: 16: Eval results *****
2023-04-19 21:16:56,182 - Detection -   best_eval_score = 31.47
2023-04-19 21:16:56,182 - Detection -   eval_score = 29.86
2023-04-19 21:16:56,182 - Detection -   train_loss = 0.4495859406888485
2023-04-19 21:16:57,039 - Detection - ***** Epoch: 17: Eval results *****
2023-04-19 21:16:57,039 - Detection -   best_eval_score = 31.47
2023-04-19 21:16:57,039 - Detection -   eval_score = 30.03
2023-04-19 21:16:57,039 - Detection -   train_loss = 0.47365373000502586
2023-04-19 21:16:57,896 - Detection - ***** Epoch: 18: Eval results *****
2023-04-19 21:16:57,896 - Detection -   best_eval_score = 31.47
2023-04-19 21:16:57,896 - Detection -   eval_score = 30.44
2023-04-19 21:16:57,896 - Detection -   train_loss = 0.45816659927368164
2023-04-19 21:16:58,753 - Detection - ***** Epoch: 19: Eval results *****
2023-04-19 21:16:58,753 - Detection -   best_eval_score = 31.47
2023-04-19 21:16:58,753 - Detection -   eval_score = 31.18
2023-04-19 21:16:58,753 - Detection -   train_loss = 0.4521505646407604
2023-04-19 21:16:59,609 - Detection - ***** Epoch: 20: Eval results *****
2023-04-19 21:16:59,609 - Detection -   best_eval_score = 31.47
2023-04-19 21:16:59,609 - Detection -   eval_score = 30.28
2023-04-19 21:16:59,609 - Detection -   train_loss = 0.4400850720703602
2023-04-19 21:17:00,467 - Detection - ***** Epoch: 21: Eval results *****
2023-04-19 21:17:00,467 - Detection -   best_eval_score = 31.47
2023-04-19 21:17:00,467 - Detection -   eval_score = 30.96
2023-04-19 21:17:00,467 - Detection -   train_loss = 0.4446413666009903
2023-04-19 21:17:01,326 - Detection - ***** Epoch: 22: Eval results *****
2023-04-19 21:17:01,326 - Detection -   best_eval_score = 31.47
2023-04-19 21:17:01,326 - Detection -   eval_score = 30.39
2023-04-19 21:17:01,326 - Detection -   train_loss = 0.4462186358869076
2023-04-19 21:17:02,184 - Detection - ***** Epoch: 23: Eval results *****
2023-04-19 21:17:02,184 - Detection -   best_eval_score = 31.47
2023-04-19 21:17:02,184 - Detection -   eval_score = 30.29
2023-04-19 21:17:02,184 - Detection -   train_loss = 0.4569772854447365
2023-04-19 21:17:02,185 - Detection - Training Finished...
2023-04-19 21:17:02,185 - Detection - Testing begin...
2023-04-19 21:17:04,260 - Detection - ***** Test: Confusion Matrix *****
2023-04-19 21:17:04,261 - Detection - [[   4    0    0 ...    0    0   11]
 [   0    2    0 ...    0    0    9]
 [   0    0    5 ...    0    0   10]
 ...
 [   0    0    0 ...    0    0    9]
 [   0    0    0 ...    0    0    6]
 [   1    0    0 ...    1    0 2973]]
2023-04-19 21:17:04,261 - Detection - ***** Test results *****
2023-04-19 21:17:04,261 - Detection -   Acc = 86.62
2023-04-19 21:17:04,261 - Detection -   F1 = 35.4287
2023-04-19 21:17:04,261 - Detection -   F1-known = 33.9257
2023-04-19 21:17:04,261 - Detection -   F1-open = 92.5447
2023-04-19 21:17:04,261 - Detection - Testing finished...
2023-04-19 21:17:04,261 - Detection - Results saved in results/results_DA-ADB.csv
2023-04-19 21:17:04,280 - Detection - Open Intent Detection Finished...
