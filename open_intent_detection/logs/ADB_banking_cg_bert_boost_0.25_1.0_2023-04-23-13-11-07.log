2023-04-23 13:11:07,370 - Detection - Open Intent Detection Begin...
2023-04-23 13:11:07,370 - Detection - Parameters Initialization...
2023-04-23 13:11:07,370 - Detection - ============================== Params ==============================
2023-04-23 13:11:07,370 - Detection - type:	open_intent_detection
2023-04-23 13:11:07,370 - Detection - logger_name:	Detection
2023-04-23 13:11:07,370 - Detection - log_dir:	logs
2023-04-23 13:11:07,370 - Detection - dataset:	banking_cg
2023-04-23 13:11:07,370 - Detection - known_cls_ratio:	0.25
2023-04-23 13:11:07,370 - Detection - labeled_ratio:	1.0
2023-04-23 13:11:07,370 - Detection - method:	ADB
2023-04-23 13:11:07,370 - Detection - train:	True
2023-04-23 13:11:07,370 - Detection - pretrain:	True
2023-04-23 13:11:07,370 - Detection - save_model:	False
2023-04-23 13:11:07,370 - Detection - backbone:	bert_boost
2023-04-23 13:11:07,370 - Detection - config_file_name:	ADB
2023-04-23 13:11:07,370 - Detection - seed:	4
2023-04-23 13:11:07,370 - Detection - gpu_id:	0
2023-04-23 13:11:07,370 - Detection - pipe_results_path:	pipe_results
2023-04-23 13:11:07,370 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-23 13:11:07,370 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-23 13:11:07,370 - Detection - model_dir:	models
2023-04-23 13:11:07,370 - Detection - load_pretrained_method:	None
2023-04-23 13:11:07,370 - Detection - result_dir:	results
2023-04-23 13:11:07,370 - Detection - results_file_name:	results_ADB-BOOST-F-4.csv
2023-04-23 13:11:07,370 - Detection - save_results:	True
2023-04-23 13:11:07,370 - Detection - loss_fct:	CrossEntropyLoss
2023-04-23 13:11:07,370 - Detection - boost_method:	F-4
2023-04-23 13:11:07,370 - Detection - boost_start_score:	0.0
2023-04-23 13:11:07,370 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.25_1.0_bert_boost_4
2023-04-23 13:11:07,370 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.25_1.0_bert_boost_4/models
2023-04-23 13:11:07,370 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-23 13:11:07,370 - Detection - num_train_epochs:	100
2023-04-23 13:11:07,370 - Detection - num_labels:	None
2023-04-23 13:11:07,370 - Detection - max_seq_length:	None
2023-04-23 13:11:07,370 - Detection - freeze_backbone_parameters:	True
2023-04-23 13:11:07,371 - Detection - feat_dim:	768
2023-04-23 13:11:07,371 - Detection - warmup_proportion:	0.1
2023-04-23 13:11:07,371 - Detection - lr_boundary:	0.05
2023-04-23 13:11:07,371 - Detection - lr:	2e-05
2023-04-23 13:11:07,371 - Detection - activation:	relu
2023-04-23 13:11:07,371 - Detection - train_batch_size:	128
2023-04-23 13:11:07,371 - Detection - eval_batch_size:	64
2023-04-23 13:11:07,371 - Detection - test_batch_size:	64
2023-04-23 13:11:07,371 - Detection - wait_patient:	10
2023-04-23 13:11:07,371 - Detection - ============================== End Params ==============================
2023-04-23 13:11:07,371 - Detection - Data and Model Preparation...
2023-04-23 13:11:07,371 - Detection - The number of known intents is 19
2023-04-23 13:11:07,371 - Detection - Lists of known labels are: ['pending_transfer', 'transfer_not_received_by_recipient', 'top_up_limits', 'pending_top_up', 'card_linking', 'declined_card_payment', 'visa_or_mastercard', 'contactless_not_working', 'direct_debit_payment_not_recognised', 'atm_support', 'card_swallowed', 'why_verify_identity', 'lost_or_stolen_phone', 'automatic_top_up', 'fiat_currency_support', 'pending_cash_withdrawal', 'getting_virtual_card', 'cash_withdrawal_charge', 'card_about_to_expire']
2023-04-23 13:11:07,379 - Detection - Number of labeled training samples = 691
2023-04-23 13:11:07,379 - Detection - Number of unlabeled training samples = 2081
2023-04-23 13:11:07,381 - Detection - Number of evaluation samples = 192
2023-04-23 13:11:07,385 - Detection - Number of testing samples = 1896
2023-04-23 13:11:11,285 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-23 13:11:13,003 - Detection - Pre-training Begin...
2023-04-23 13:11:14,418 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 13:11:14,419 - Detection -   best_eval_score = 0
2023-04-23 13:11:14,419 - Detection -   eval_score = 5.73
2023-04-23 13:11:14,419 - Detection -   train_loss = 2.9470240672429404
2023-04-23 13:11:19,220 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 13:11:19,220 - Detection -   best_eval_score = 5.73
2023-04-23 13:11:19,220 - Detection -   eval_score = 5.21
2023-04-23 13:11:19,220 - Detection -   train_loss = 2.9361592133839927
2023-04-23 13:11:24,035 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 13:11:24,035 - Detection -   best_eval_score = 5.73
2023-04-23 13:11:24,035 - Detection -   eval_score = 7.29
2023-04-23 13:11:24,035 - Detection -   train_loss = 2.7966114282608032
2023-04-23 13:11:28,901 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 13:11:28,901 - Detection -   best_eval_score = 7.29
2023-04-23 13:11:28,901 - Detection -   eval_score = 50.0
2023-04-23 13:11:28,901 - Detection -   train_loss = 2.559204856554667
2023-04-23 13:11:33,658 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 13:11:33,658 - Detection -   best_eval_score = 50.0
2023-04-23 13:11:33,658 - Detection -   eval_score = 68.23
2023-04-23 13:11:33,658 - Detection -   train_loss = 2.0126004020373025
2023-04-23 13:11:38,502 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 13:11:38,502 - Detection -   best_eval_score = 68.23
2023-04-23 13:11:38,502 - Detection -   eval_score = 80.21
2023-04-23 13:11:38,502 - Detection -   train_loss = 1.277568479379018
2023-04-23 13:11:43,250 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 13:11:43,251 - Detection -   best_eval_score = 80.21
2023-04-23 13:11:43,251 - Detection -   eval_score = 83.85
2023-04-23 13:11:43,251 - Detection -   train_loss = 0.7535053292910258
2023-04-23 13:11:48,203 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 13:11:48,203 - Detection -   best_eval_score = 83.85
2023-04-23 13:11:48,203 - Detection -   eval_score = 90.1
2023-04-23 13:11:48,203 - Detection -   train_loss = 0.4856025477250417
2023-04-23 13:11:52,973 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 13:11:52,974 - Detection -   best_eval_score = 90.1
2023-04-23 13:11:52,974 - Detection -   eval_score = 91.15
2023-04-23 13:11:52,974 - Detection -   train_loss = 0.3220003843307495
2023-04-23 13:11:57,780 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 13:11:57,780 - Detection -   best_eval_score = 91.15
2023-04-23 13:11:57,780 - Detection -   eval_score = 90.62
2023-04-23 13:11:57,780 - Detection -   train_loss = 0.21394981692234674
2023-04-23 13:12:02,516 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 13:12:02,517 - Detection -   best_eval_score = 91.15
2023-04-23 13:12:02,517 - Detection -   eval_score = 92.71
2023-04-23 13:12:02,517 - Detection -   train_loss = 0.16190600643555322
2023-04-23 13:12:07,403 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 13:12:07,404 - Detection -   best_eval_score = 92.71
2023-04-23 13:12:07,404 - Detection -   eval_score = 91.67
2023-04-23 13:12:07,404 - Detection -   train_loss = 0.11355134348074596
2023-04-23 13:12:12,181 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 13:12:12,181 - Detection -   best_eval_score = 92.71
2023-04-23 13:12:12,181 - Detection -   eval_score = 91.15
2023-04-23 13:12:12,181 - Detection -   train_loss = 0.09488768751422565
2023-04-23 13:12:16,962 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 13:12:16,962 - Detection -   best_eval_score = 92.71
2023-04-23 13:12:16,962 - Detection -   eval_score = 90.1
2023-04-23 13:12:16,962 - Detection -   train_loss = 0.07471977733075619
2023-04-23 13:12:21,729 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 13:12:21,729 - Detection -   best_eval_score = 92.71
2023-04-23 13:12:21,729 - Detection -   eval_score = 92.19
2023-04-23 13:12:21,729 - Detection -   train_loss = 0.05733660732706388
2023-04-23 13:12:26,493 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 13:12:26,493 - Detection -   best_eval_score = 92.71
2023-04-23 13:12:26,493 - Detection -   eval_score = 92.71
2023-04-23 13:12:26,493 - Detection -   train_loss = 0.051972756162285805
2023-04-23 13:12:31,422 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 13:12:31,422 - Detection -   best_eval_score = 92.71
2023-04-23 13:12:31,422 - Detection -   eval_score = 92.19
2023-04-23 13:12:31,422 - Detection -   train_loss = 0.04101060330867767
2023-04-23 13:12:36,192 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 13:12:36,192 - Detection -   best_eval_score = 92.71
2023-04-23 13:12:36,192 - Detection -   eval_score = 92.71
2023-04-23 13:12:36,192 - Detection -   train_loss = 0.03876824459681908
2023-04-23 13:12:40,959 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 13:12:40,959 - Detection -   best_eval_score = 92.71
2023-04-23 13:12:40,959 - Detection -   eval_score = 92.19
2023-04-23 13:12:40,959 - Detection -   train_loss = 0.033965040308733783
2023-04-23 13:12:45,739 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 13:12:45,739 - Detection -   best_eval_score = 92.71
2023-04-23 13:12:45,739 - Detection -   eval_score = 92.19
2023-04-23 13:12:45,739 - Detection -   train_loss = 0.029996486380696297
2023-04-23 13:12:50,620 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 13:12:50,620 - Detection -   best_eval_score = 92.71
2023-04-23 13:12:50,620 - Detection -   eval_score = 92.71
2023-04-23 13:12:50,620 - Detection -   train_loss = 0.025538374359409016
2023-04-23 13:12:50,621 - Detection - Pre-training finished...
2023-04-23 13:12:50,621 - Detection - Training Begin...
2023-04-23 13:12:51,797 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 13:12:51,797 - Detection -   best_eval_score = 0
2023-04-23 13:12:51,797 - Detection -   eval_score = 0.0
2023-04-23 13:12:51,797 - Detection -   train_loss = 8.449295043945312
2023-04-23 13:12:52,479 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 13:12:52,479 - Detection -   best_eval_score = 0
2023-04-23 13:12:52,479 - Detection -   eval_score = 0.0
2023-04-23 13:12:52,479 - Detection -   train_loss = 8.205884059270224
2023-04-23 13:12:53,162 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 13:12:53,162 - Detection -   best_eval_score = 0
2023-04-23 13:12:53,163 - Detection -   eval_score = 0.0
2023-04-23 13:12:53,163 - Detection -   train_loss = 8.089020649592081
2023-04-23 13:12:53,845 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 13:12:53,845 - Detection -   best_eval_score = 0
2023-04-23 13:12:53,845 - Detection -   eval_score = 0.0
2023-04-23 13:12:53,845 - Detection -   train_loss = 7.801820993423462
2023-04-23 13:12:54,530 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 13:12:54,530 - Detection -   best_eval_score = 0
2023-04-23 13:12:54,530 - Detection -   eval_score = 0.0
2023-04-23 13:12:54,530 - Detection -   train_loss = 7.5981316566467285
2023-04-23 13:12:55,214 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 13:12:55,214 - Detection -   best_eval_score = 0
2023-04-23 13:12:55,214 - Detection -   eval_score = 0.67
2023-04-23 13:12:55,214 - Detection -   train_loss = 7.404547691345215
2023-04-23 13:12:59,983 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 13:12:59,983 - Detection -   best_eval_score = 0.67
2023-04-23 13:12:59,984 - Detection -   eval_score = 5.68
2023-04-23 13:12:59,984 - Detection -   train_loss = 7.103987852732341
2023-04-23 13:13:04,726 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 13:13:04,726 - Detection -   best_eval_score = 5.68
2023-04-23 13:13:04,727 - Detection -   eval_score = 23.45
2023-04-23 13:13:04,727 - Detection -   train_loss = 5.7377854983011884
2023-04-23 13:13:09,480 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 13:13:09,480 - Detection -   best_eval_score = 23.45
2023-04-23 13:13:09,480 - Detection -   eval_score = 50.3
2023-04-23 13:13:09,480 - Detection -   train_loss = 4.2494871616363525
2023-04-23 13:13:14,230 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 13:13:14,230 - Detection -   best_eval_score = 50.3
2023-04-23 13:13:14,230 - Detection -   eval_score = 67.68
2023-04-23 13:13:14,230 - Detection -   train_loss = 2.8995996713638306
2023-04-23 13:13:19,083 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 13:13:19,083 - Detection -   best_eval_score = 67.68
2023-04-23 13:13:19,083 - Detection -   eval_score = 74.33
2023-04-23 13:13:19,083 - Detection -   train_loss = 1.7105645140012105
2023-04-23 13:13:23,849 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 13:13:23,849 - Detection -   best_eval_score = 74.33
2023-04-23 13:13:23,849 - Detection -   eval_score = 77.16
2023-04-23 13:13:23,849 - Detection -   train_loss = 1.1682619055112202
2023-04-23 13:13:28,578 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 13:13:28,578 - Detection -   best_eval_score = 77.16
2023-04-23 13:13:28,578 - Detection -   eval_score = 77.96
2023-04-23 13:13:28,578 - Detection -   train_loss = 1.0635628898938496
2023-04-23 13:13:33,374 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 13:13:33,374 - Detection -   best_eval_score = 77.96
2023-04-23 13:13:33,374 - Detection -   eval_score = 77.48
2023-04-23 13:13:33,374 - Detection -   train_loss = 1.0633286436398823
2023-04-23 13:13:38,230 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 13:13:38,230 - Detection -   best_eval_score = 77.96
2023-04-23 13:13:38,230 - Detection -   eval_score = 77.48
2023-04-23 13:13:38,230 - Detection -   train_loss = 1.1680925488471985
2023-04-23 13:13:42,989 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 13:13:42,989 - Detection -   best_eval_score = 77.96
2023-04-23 13:13:42,989 - Detection -   eval_score = 77.96
2023-04-23 13:13:42,989 - Detection -   train_loss = 1.1008805731932323
2023-04-23 13:13:47,768 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 13:13:47,768 - Detection -   best_eval_score = 77.96
2023-04-23 13:13:47,768 - Detection -   eval_score = 77.48
2023-04-23 13:13:47,768 - Detection -   train_loss = 1.1101806163787842
2023-04-23 13:13:52,538 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 13:13:52,538 - Detection -   best_eval_score = 77.96
2023-04-23 13:13:52,538 - Detection -   eval_score = 77.48
2023-04-23 13:13:52,538 - Detection -   train_loss = 1.1427594423294067
2023-04-23 13:13:57,305 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 13:13:57,305 - Detection -   best_eval_score = 77.96
2023-04-23 13:13:57,305 - Detection -   eval_score = 77.96
2023-04-23 13:13:57,305 - Detection -   train_loss = 1.1562276482582092
2023-04-23 13:14:02,191 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 13:14:02,191 - Detection -   best_eval_score = 77.96
2023-04-23 13:14:02,191 - Detection -   eval_score = 77.48
2023-04-23 13:14:02,191 - Detection -   train_loss = 1.1129888892173767
2023-04-23 13:14:06,932 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 13:14:06,932 - Detection -   best_eval_score = 77.96
2023-04-23 13:14:06,932 - Detection -   eval_score = 77.48
2023-04-23 13:14:06,932 - Detection -   train_loss = 1.1467067003250122
2023-04-23 13:14:11,681 - Detection - ***** Epoch: 22: Eval results *****
2023-04-23 13:14:11,681 - Detection -   best_eval_score = 77.96
2023-04-23 13:14:11,681 - Detection -   eval_score = 77.48
2023-04-23 13:14:11,681 - Detection -   train_loss = 1.1166312992572784
2023-04-23 13:14:16,458 - Detection - ***** Epoch: 23: Eval results *****
2023-04-23 13:14:16,458 - Detection -   best_eval_score = 77.96
2023-04-23 13:14:16,458 - Detection -   eval_score = 76.62
2023-04-23 13:14:16,458 - Detection -   train_loss = 1.080228825410207
2023-04-23 13:14:16,458 - Detection - Training Finished...
2023-04-23 13:14:16,458 - Detection - Testing begin...
2023-04-23 13:14:17,749 - Detection - ***** Test: Confusion Matrix *****
2023-04-23 13:14:17,749 - Detection - [[  19   13    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    2]
 [   6   14    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    7]
 [   0    0   18    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    1]
 [   0    0    0   13    0    0    0    0    0    0    0    0    0    0
     0    1    0    0    0   11]
 [   0    0    0    0   24    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    4]
 [   0    0    0    0    0   21    0    0    0    0    0    0    0    0
     0    0    0    0    0   11]
 [   0    0    0    0    0    0   16    0    0    0    0    0    0    0
     0    0    0    0    0    4]
 [   0    0    0    0    0    0    0   17    0    0    0    0    0    0
     0    0    0    0    0    3]
 [   0    0    0    0    0    0    0    0    5    0    0    0    0    0
     0    0    0    0    0   11]
 [   0    0    0    0    0    0    0    0    0   18    0    0    0    0
     0    0    0    0    0    2]
 [   0    0    0    0    0    0    0    0    0    0    8    0    0    0
     0    0    0    0    0    9]
 [   0    0    0    0    0    0    0    0    0    0    0   21    0    0
     0    0    0    0    0    1]
 [   0    0    0    0    0    0    0    0    0    0    0    0   17    0
     0    0    0    0    0    7]
 [   0    0    2    0    0    0    0    0    0    0    0    0    0   12
     0    0    0    0    0   10]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
    16    0    0    0    0    7]
 [   0    0    0    1    0    0    0    0    0    0    0    0    0    0
     0   20    0    0    0    8]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0   15    0    0    6]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0   27    0    7]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0   28    3]
 [  25   45    4   44   18   29    5    2   23    1    0   37    1    6
    68   18    8    7    0 1089]]
2023-04-23 13:14:17,749 - Detection - ***** Test results *****
2023-04-23 13:14:17,750 - Detection -   Acc = 74.79
2023-04-23 13:14:17,750 - Detection -   F1 = 62.8587
2023-04-23 13:14:17,750 - Detection -   F1-known = 61.8134
2023-04-23 13:14:17,750 - Detection -   F1-open = 82.7193
2023-04-23 13:14:17,750 - Detection - Testing finished...
2023-04-23 13:14:17,750 - Detection - Results saved in results/results_ADB-BOOST-F-4.csv
2023-04-23 13:14:17,766 - Detection - Open Intent Detection Finished...
