2023-04-20 20:24:51,416 - Detection - Open Intent Detection Begin...
2023-04-20 20:24:51,416 - Detection - Parameters Initialization...
2023-04-20 20:24:51,416 - Detection - ============================== Params ==============================
2023-04-20 20:24:51,416 - Detection - type:	open_intent_detection
2023-04-20 20:24:51,416 - Detection - logger_name:	Detection
2023-04-20 20:24:51,416 - Detection - log_dir:	logs
2023-04-20 20:24:51,416 - Detection - dataset:	stackoverflow_cg
2023-04-20 20:24:51,416 - Detection - known_cls_ratio:	0.75
2023-04-20 20:24:51,416 - Detection - labeled_ratio:	1.0
2023-04-20 20:24:51,416 - Detection - method:	ADB
2023-04-20 20:24:51,417 - Detection - train:	True
2023-04-20 20:24:51,417 - Detection - pretrain:	True
2023-04-20 20:24:51,417 - Detection - save_model:	True
2023-04-20 20:24:51,417 - Detection - backbone:	bert
2023-04-20 20:24:51,417 - Detection - config_file_name:	ADB
2023-04-20 20:24:51,417 - Detection - seed:	4
2023-04-20 20:24:51,417 - Detection - gpu_id:	0
2023-04-20 20:24:51,417 - Detection - pipe_results_path:	pipe_results
2023-04-20 20:24:51,417 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-20 20:24:51,417 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-20 20:24:51,417 - Detection - model_dir:	models
2023-04-20 20:24:51,417 - Detection - load_pretrained_method:	None
2023-04-20 20:24:51,417 - Detection - result_dir:	results
2023-04-20 20:24:51,417 - Detection - results_file_name:	results_ADB.csv
2023-04-20 20:24:51,417 - Detection - save_results:	True
2023-04-20 20:24:51,417 - Detection - loss_fct:	CrossEntropyLoss
2023-04-20 20:24:51,417 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.75_1.0_bert_4
2023-04-20 20:24:51,417 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.75_1.0_bert_4/models
2023-04-20 20:24:51,417 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-20 20:24:51,417 - Detection - num_train_epochs:	100
2023-04-20 20:24:51,417 - Detection - num_labels:	None
2023-04-20 20:24:51,417 - Detection - max_seq_length:	None
2023-04-20 20:24:51,417 - Detection - freeze_backbone_parameters:	True
2023-04-20 20:24:51,417 - Detection - feat_dim:	768
2023-04-20 20:24:51,417 - Detection - warmup_proportion:	0.1
2023-04-20 20:24:51,417 - Detection - lr_boundary:	0.05
2023-04-20 20:24:51,417 - Detection - lr:	2e-05
2023-04-20 20:24:51,417 - Detection - activation:	relu
2023-04-20 20:24:51,417 - Detection - train_batch_size:	128
2023-04-20 20:24:51,417 - Detection - eval_batch_size:	64
2023-04-20 20:24:51,417 - Detection - test_batch_size:	64
2023-04-20 20:24:51,417 - Detection - wait_patient:	10
2023-04-20 20:24:51,417 - Detection - ============================== End Params ==============================
2023-04-20 20:24:51,417 - Detection - Data and Model Preparation...
2023-04-20 20:24:51,418 - Detection - The number of known intents is 15
2023-04-20 20:24:51,418 - Detection - Lists of known labels are: ['wordpress', 'cocoa', 'visual-studio', 'haskell', 'qt', 'drupal', 'ajax', 'svn', 'osx', 'oracle', 'sharepoint', 'matlab', 'magento', 'bash', 'spring']
2023-04-20 20:24:51,427 - Detection - Number of labeled training samples = 2172
2023-04-20 20:24:51,427 - Detection - Number of unlabeled training samples = 619
2023-04-20 20:24:51,430 - Detection - Number of evaluation samples = 1054
2023-04-20 20:24:51,435 - Detection - Number of testing samples = 2905
2023-04-20 20:24:55,525 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-20 20:24:57,153 - Detection - Pre-training Begin...
2023-04-20 20:25:00,588 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 20:25:00,588 - Detection -   best_eval_score = 0
2023-04-20 20:25:00,588 - Detection -   eval_score = 6.93
2023-04-20 20:25:00,588 - Detection -   train_loss = 2.7132636939778045
2023-04-20 20:25:03,543 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 20:25:03,543 - Detection -   best_eval_score = 6.93
2023-04-20 20:25:03,543 - Detection -   eval_score = 4.74
2023-04-20 20:25:03,543 - Detection -   train_loss = 2.6966106751385857
2023-04-20 20:25:06,486 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 20:25:06,486 - Detection -   best_eval_score = 6.93
2023-04-20 20:25:06,486 - Detection -   eval_score = 4.93
2023-04-20 20:25:06,486 - Detection -   train_loss = 2.6671327001908245
2023-04-20 20:25:09,434 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 20:25:09,434 - Detection -   best_eval_score = 6.93
2023-04-20 20:25:09,434 - Detection -   eval_score = 7.12
2023-04-20 20:25:09,434 - Detection -   train_loss = 2.62747823490816
2023-04-20 20:25:12,404 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 20:25:12,404 - Detection -   best_eval_score = 7.12
2023-04-20 20:25:12,404 - Detection -   eval_score = 14.8
2023-04-20 20:25:12,404 - Detection -   train_loss = 2.552141778609332
2023-04-20 20:25:15,375 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 20:25:15,375 - Detection -   best_eval_score = 14.8
2023-04-20 20:25:15,375 - Detection -   eval_score = 27.04
2023-04-20 20:25:15,375 - Detection -   train_loss = 2.404804650474997
2023-04-20 20:25:18,360 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 20:25:18,360 - Detection -   best_eval_score = 27.04
2023-04-20 20:25:18,360 - Detection -   eval_score = 38.8
2023-04-20 20:25:18,360 - Detection -   train_loss = 2.1523883903727814
2023-04-20 20:25:21,340 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 20:25:21,340 - Detection -   best_eval_score = 38.8
2023-04-20 20:25:21,340 - Detection -   eval_score = 57.12
2023-04-20 20:25:21,340 - Detection -   train_loss = 1.840760869138381
2023-04-20 20:25:24,335 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 20:25:24,335 - Detection -   best_eval_score = 57.12
2023-04-20 20:25:24,335 - Detection -   eval_score = 71.54
2023-04-20 20:25:24,335 - Detection -   train_loss = 1.4908784417545093
2023-04-20 20:25:27,361 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 20:25:27,361 - Detection -   best_eval_score = 71.54
2023-04-20 20:25:27,361 - Detection -   eval_score = 76.09
2023-04-20 20:25:27,361 - Detection -   train_loss = 1.1908427126267378
2023-04-20 20:25:30,504 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 20:25:30,504 - Detection -   best_eval_score = 76.09
2023-04-20 20:25:30,504 - Detection -   eval_score = 77.8
2023-04-20 20:25:30,504 - Detection -   train_loss = 1.0029844922177933
2023-04-20 20:25:33,577 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 20:25:33,577 - Detection -   best_eval_score = 77.8
2023-04-20 20:25:33,577 - Detection -   eval_score = 79.32
2023-04-20 20:25:33,577 - Detection -   train_loss = 0.8591081079314736
2023-04-20 20:25:36,653 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 20:25:36,653 - Detection -   best_eval_score = 79.32
2023-04-20 20:25:36,653 - Detection -   eval_score = 79.22
2023-04-20 20:25:36,653 - Detection -   train_loss = 0.7932068214696997
2023-04-20 20:25:39,743 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 20:25:39,743 - Detection -   best_eval_score = 79.32
2023-04-20 20:25:39,743 - Detection -   eval_score = 79.41
2023-04-20 20:25:39,743 - Detection -   train_loss = 0.7366800483535317
2023-04-20 20:25:42,839 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 20:25:42,839 - Detection -   best_eval_score = 79.41
2023-04-20 20:25:42,839 - Detection -   eval_score = 79.22
2023-04-20 20:25:42,839 - Detection -   train_loss = 0.6670171057476717
2023-04-20 20:25:45,936 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 20:25:45,936 - Detection -   best_eval_score = 79.41
2023-04-20 20:25:45,936 - Detection -   eval_score = 80.46
2023-04-20 20:25:45,936 - Detection -   train_loss = 0.6345384646864498
2023-04-20 20:25:49,043 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 20:25:49,043 - Detection -   best_eval_score = 80.46
2023-04-20 20:25:49,043 - Detection -   eval_score = 79.79
2023-04-20 20:25:49,043 - Detection -   train_loss = 0.6010254165705513
2023-04-20 20:25:52,145 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 20:25:52,145 - Detection -   best_eval_score = 80.46
2023-04-20 20:25:52,145 - Detection -   eval_score = 79.79
2023-04-20 20:25:52,145 - Detection -   train_loss = 0.5691096537253436
2023-04-20 20:25:55,236 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 20:25:55,236 - Detection -   best_eval_score = 80.46
2023-04-20 20:25:55,236 - Detection -   eval_score = 80.36
2023-04-20 20:25:55,236 - Detection -   train_loss = 0.538051212535185
2023-04-20 20:25:58,325 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 20:25:58,326 - Detection -   best_eval_score = 80.46
2023-04-20 20:25:58,326 - Detection -   eval_score = 80.46
2023-04-20 20:25:58,326 - Detection -   train_loss = 0.5097514776622548
2023-04-20 20:26:01,429 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 20:26:01,429 - Detection -   best_eval_score = 80.46
2023-04-20 20:26:01,429 - Detection -   eval_score = 80.46
2023-04-20 20:26:01,429 - Detection -   train_loss = 0.4818323973347159
2023-04-20 20:26:04,518 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 20:26:04,518 - Detection -   best_eval_score = 80.46
2023-04-20 20:26:04,518 - Detection -   eval_score = 79.98
2023-04-20 20:26:04,518 - Detection -   train_loss = 0.45732076378429637
2023-04-20 20:26:07,611 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 20:26:07,611 - Detection -   best_eval_score = 80.46
2023-04-20 20:26:07,611 - Detection -   eval_score = 80.17
2023-04-20 20:26:07,611 - Detection -   train_loss = 0.4365585796973285
2023-04-20 20:26:10,694 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 20:26:10,694 - Detection -   best_eval_score = 80.46
2023-04-20 20:26:10,694 - Detection -   eval_score = 80.46
2023-04-20 20:26:10,694 - Detection -   train_loss = 0.4200814629302305
2023-04-20 20:26:13,784 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 20:26:13,784 - Detection -   best_eval_score = 80.46
2023-04-20 20:26:13,784 - Detection -   eval_score = 79.89
2023-04-20 20:26:13,784 - Detection -   train_loss = 0.3938833369928248
2023-04-20 20:26:16,860 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 20:26:16,860 - Detection -   best_eval_score = 80.46
2023-04-20 20:26:16,860 - Detection -   eval_score = 79.51
2023-04-20 20:26:16,860 - Detection -   train_loss = 0.3752937351956087
2023-04-20 20:26:16,860 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.75_1.0_bert_4/models
2023-04-20 20:26:17,395 - Detection - Pre-training finished...
2023-04-20 20:26:17,396 - Detection - Training Begin...
2023-04-20 20:26:22,286 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 20:26:22,286 - Detection -   best_eval_score = 0
2023-04-20 20:26:22,286 - Detection -   eval_score = 0.0
2023-04-20 20:26:22,286 - Detection -   train_loss = 8.690025161294376
2023-04-20 20:26:25,339 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 20:26:25,340 - Detection -   best_eval_score = 0
2023-04-20 20:26:25,340 - Detection -   eval_score = 0.0
2023-04-20 20:26:25,340 - Detection -   train_loss = 8.123156771940344
2023-04-20 20:26:28,389 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 20:26:28,389 - Detection -   best_eval_score = 0
2023-04-20 20:26:28,389 - Detection -   eval_score = 2.41
2023-04-20 20:26:28,389 - Detection -   train_loss = 7.407251778770895
2023-04-20 20:26:31,435 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 20:26:31,436 - Detection -   best_eval_score = 2.41
2023-04-20 20:26:31,436 - Detection -   eval_score = 6.51
2023-04-20 20:26:31,436 - Detection -   train_loss = 6.556052404291489
2023-04-20 20:26:34,491 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 20:26:34,491 - Detection -   best_eval_score = 6.51
2023-04-20 20:26:34,491 - Detection -   eval_score = 9.32
2023-04-20 20:26:34,491 - Detection -   train_loss = 5.68249688428991
2023-04-20 20:26:37,536 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 20:26:37,536 - Detection -   best_eval_score = 9.32
2023-04-20 20:26:37,536 - Detection -   eval_score = 22.5
2023-04-20 20:26:37,536 - Detection -   train_loss = 4.753147517933565
2023-04-20 20:26:40,646 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 20:26:40,646 - Detection -   best_eval_score = 22.5
2023-04-20 20:26:40,646 - Detection -   eval_score = 45.43
2023-04-20 20:26:40,646 - Detection -   train_loss = 3.8372947889215805
2023-04-20 20:26:43,799 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 20:26:43,799 - Detection -   best_eval_score = 45.43
2023-04-20 20:26:43,799 - Detection -   eval_score = 61.53
2023-04-20 20:26:43,799 - Detection -   train_loss = 2.969963887158562
2023-04-20 20:26:46,907 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 20:26:46,907 - Detection -   best_eval_score = 61.53
2023-04-20 20:26:46,907 - Detection -   eval_score = 72.91
2023-04-20 20:26:46,907 - Detection -   train_loss = 2.2301807052948894
2023-04-20 20:26:50,012 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 20:26:50,012 - Detection -   best_eval_score = 72.91
2023-04-20 20:26:50,012 - Detection -   eval_score = 76.07
2023-04-20 20:26:50,012 - Detection -   train_loss = 1.7796288518344654
2023-04-20 20:26:53,049 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 20:26:53,049 - Detection -   best_eval_score = 76.07
2023-04-20 20:26:53,049 - Detection -   eval_score = 76.71
2023-04-20 20:26:53,049 - Detection -   train_loss = 1.591143383699305
2023-04-20 20:26:56,095 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 20:26:56,095 - Detection -   best_eval_score = 76.71
2023-04-20 20:26:56,095 - Detection -   eval_score = 76.53
2023-04-20 20:26:56,095 - Detection -   train_loss = 1.579996613895192
2023-04-20 20:26:59,140 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 20:26:59,140 - Detection -   best_eval_score = 76.71
2023-04-20 20:26:59,140 - Detection -   eval_score = 76.52
2023-04-20 20:26:59,140 - Detection -   train_loss = 1.5716391661587883
2023-04-20 20:27:02,182 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 20:27:02,182 - Detection -   best_eval_score = 76.71
2023-04-20 20:27:02,182 - Detection -   eval_score = 76.46
2023-04-20 20:27:02,182 - Detection -   train_loss = 1.5514941145392025
2023-04-20 20:27:05,217 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 20:27:05,217 - Detection -   best_eval_score = 76.71
2023-04-20 20:27:05,217 - Detection -   eval_score = 76.64
2023-04-20 20:27:05,218 - Detection -   train_loss = 1.5614860268200146
2023-04-20 20:27:08,259 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 20:27:08,259 - Detection -   best_eval_score = 76.71
2023-04-20 20:27:08,259 - Detection -   eval_score = 76.56
2023-04-20 20:27:08,259 - Detection -   train_loss = 1.5598766383002787
2023-04-20 20:27:11,299 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 20:27:11,299 - Detection -   best_eval_score = 76.71
2023-04-20 20:27:11,299 - Detection -   eval_score = 76.55
2023-04-20 20:27:11,299 - Detection -   train_loss = 1.573557222590727
2023-04-20 20:27:14,333 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 20:27:14,334 - Detection -   best_eval_score = 76.71
2023-04-20 20:27:14,334 - Detection -   eval_score = 76.42
2023-04-20 20:27:14,334 - Detection -   train_loss = 1.568941403837765
2023-04-20 20:27:17,372 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 20:27:17,372 - Detection -   best_eval_score = 76.71
2023-04-20 20:27:17,372 - Detection -   eval_score = 76.58
2023-04-20 20:27:17,372 - Detection -   train_loss = 1.568689178018009
2023-04-20 20:27:20,406 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 20:27:20,406 - Detection -   best_eval_score = 76.71
2023-04-20 20:27:20,406 - Detection -   eval_score = 76.57
2023-04-20 20:27:20,406 - Detection -   train_loss = 1.573635557118584
2023-04-20 20:27:23,442 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 20:27:23,442 - Detection -   best_eval_score = 76.71
2023-04-20 20:27:23,442 - Detection -   eval_score = 76.54
2023-04-20 20:27:23,442 - Detection -   train_loss = 1.5523978822371538
2023-04-20 20:27:23,443 - Detection - Training Finished...
2023-04-20 20:27:23,443 - Detection - Testing begin...
2023-04-20 20:27:25,989 - Detection - ***** Test: Confusion Matrix *****
2023-04-20 20:27:25,989 - Detection - [[110   0   0   1   0   1   0   0   0   0   0   0   0   0   0  25]
 [  0  87   0   0   2   1   1   0  15   1   0   0   0   0   3  51]
 [  0   4  37   0   0   1   2   1   2   1   3   0   0   0   0  55]
 [  0   0   0  86   0   0   0   0   1   0   0   1   0   0   0  34]
 [  0   1   0   1 154   0   0   0   0   0   0   0   0   0   0  16]
 [  0   0   0   1   0  93   1   0   0   0   0   0   0   0   0  33]
 [  1   2   1   1   0   0 119   0   1   0   3   0   0   0   0  32]
 [  0   1   3   2   0   1   0 114   1   0   0   0   0   0   0  27]
 [  0  26   0   1   2   0   0   0 130   1   0   0   0   0   0  33]
 [  0   1   0   1   0   0   0   0   0  94   0   0   0   0   0  31]
 [  0   0   1   0   0   0   1   0   1   0 116   0   0   0   0  52]
 [  0   2   0   2   0   0   0   0   1   0   0 134   0   0   0  25]
 [  0   0   0   0   1   1   0   0   0   0   0   0 101   0   0  29]
 [  1   1   0   6   0   0   1   0   7   0   1   1   0  82   0  39]
 [  0   1   0   0   0   0   0   0   1   0   0   0   0   0 122  27]
 [  2  11   6  50   0   4  41   1   2  20   4   1   0   2  11 538]]
2023-04-20 20:27:25,989 - Detection - ***** Test results *****
2023-04-20 20:27:25,990 - Detection -   Acc = 72.87
2023-04-20 20:27:25,990 - Detection -   F1 = 75.8813
2023-04-20 20:27:25,990 - Detection -   F1-known = 76.8175
2023-04-20 20:27:25,990 - Detection -   F1-open = 61.8391
2023-04-20 20:27:25,990 - Detection - Testing finished...
2023-04-20 20:27:25,990 - Detection - Results saved in results/results_ADB.csv
2023-04-20 20:27:26,010 - Detection - Open Intent Detection Finished...
