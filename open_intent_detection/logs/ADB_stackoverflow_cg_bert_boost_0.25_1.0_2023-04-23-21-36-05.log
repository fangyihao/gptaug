2023-04-23 21:36:05,530 - Detection - Open Intent Detection Begin...
2023-04-23 21:36:05,530 - Detection - Parameters Initialization...
2023-04-23 21:36:05,530 - Detection - ============================== Params ==============================
2023-04-23 21:36:05,530 - Detection - type:	open_intent_detection
2023-04-23 21:36:05,530 - Detection - logger_name:	Detection
2023-04-23 21:36:05,530 - Detection - log_dir:	logs
2023-04-23 21:36:05,530 - Detection - dataset:	stackoverflow_cg
2023-04-23 21:36:05,530 - Detection - known_cls_ratio:	0.25
2023-04-23 21:36:05,530 - Detection - labeled_ratio:	1.0
2023-04-23 21:36:05,530 - Detection - method:	ADB
2023-04-23 21:36:05,530 - Detection - train:	True
2023-04-23 21:36:05,530 - Detection - pretrain:	True
2023-04-23 21:36:05,530 - Detection - save_model:	False
2023-04-23 21:36:05,530 - Detection - backbone:	bert_boost
2023-04-23 21:36:05,530 - Detection - config_file_name:	ADB
2023-04-23 21:36:05,530 - Detection - seed:	2
2023-04-23 21:36:05,530 - Detection - gpu_id:	0
2023-04-23 21:36:05,530 - Detection - pipe_results_path:	pipe_results
2023-04-23 21:36:05,530 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-23 21:36:05,530 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-23 21:36:05,530 - Detection - model_dir:	models
2023-04-23 21:36:05,530 - Detection - load_pretrained_method:	None
2023-04-23 21:36:05,530 - Detection - result_dir:	results
2023-04-23 21:36:05,530 - Detection - results_file_name:	results_ADB-BOOST-F-4.csv
2023-04-23 21:36:05,530 - Detection - save_results:	True
2023-04-23 21:36:05,530 - Detection - loss_fct:	CrossEntropyLoss
2023-04-23 21:36:05,530 - Detection - boost_method:	F-4
2023-04-23 21:36:05,530 - Detection - boost_start_score:	0.0
2023-04-23 21:36:05,530 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.25_1.0_bert_boost_2
2023-04-23 21:36:05,531 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.25_1.0_bert_boost_2/models
2023-04-23 21:36:05,531 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-23 21:36:05,531 - Detection - num_train_epochs:	100
2023-04-23 21:36:05,531 - Detection - num_labels:	None
2023-04-23 21:36:05,531 - Detection - max_seq_length:	None
2023-04-23 21:36:05,531 - Detection - freeze_backbone_parameters:	True
2023-04-23 21:36:05,531 - Detection - feat_dim:	768
2023-04-23 21:36:05,531 - Detection - warmup_proportion:	0.1
2023-04-23 21:36:05,531 - Detection - lr_boundary:	0.05
2023-04-23 21:36:05,531 - Detection - lr:	2e-05
2023-04-23 21:36:05,531 - Detection - activation:	relu
2023-04-23 21:36:05,531 - Detection - train_batch_size:	128
2023-04-23 21:36:05,531 - Detection - eval_batch_size:	64
2023-04-23 21:36:05,531 - Detection - test_batch_size:	64
2023-04-23 21:36:05,531 - Detection - wait_patient:	10
2023-04-23 21:36:05,531 - Detection - ============================== End Params ==============================
2023-04-23 21:36:05,531 - Detection - Data and Model Preparation...
2023-04-23 21:36:05,531 - Detection - The number of known intents is 5
2023-04-23 21:36:05,531 - Detection - Lists of known labels are: ['osx', 'drupal', 'visual-studio', 'ajax', 'magento']
2023-04-23 21:36:05,538 - Detection - Number of labeled training samples = 741
2023-04-23 21:36:05,538 - Detection - Number of unlabeled training samples = 2050
2023-04-23 21:36:05,541 - Detection - Number of evaluation samples = 343
2023-04-23 21:36:05,546 - Detection - Number of testing samples = 2905
2023-04-23 21:36:09,404 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-23 21:36:11,115 - Detection - Pre-training Begin...
2023-04-23 21:36:12,590 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 21:36:12,590 - Detection -   best_eval_score = 0
2023-04-23 21:36:12,590 - Detection -   eval_score = 24.2
2023-04-23 21:36:12,591 - Detection -   train_loss = 1.6107641458511353
2023-04-23 21:36:17,048 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 21:36:17,048 - Detection -   best_eval_score = 24.2
2023-04-23 21:36:17,048 - Detection -   eval_score = 13.41
2023-04-23 21:36:17,048 - Detection -   train_loss = 1.6031570037206013
2023-04-23 21:36:21,592 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 21:36:21,592 - Detection -   best_eval_score = 24.2
2023-04-23 21:36:21,592 - Detection -   eval_score = 39.94
2023-04-23 21:36:21,592 - Detection -   train_loss = 1.5138209263483684
2023-04-23 21:36:26,013 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 21:36:26,013 - Detection -   best_eval_score = 39.94
2023-04-23 21:36:26,013 - Detection -   eval_score = 65.01
2023-04-23 21:36:26,013 - Detection -   train_loss = 1.3255509336789448
2023-04-23 21:36:30,472 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 21:36:30,472 - Detection -   best_eval_score = 65.01
2023-04-23 21:36:30,472 - Detection -   eval_score = 77.84
2023-04-23 21:36:30,472 - Detection -   train_loss = 0.9714732964833578
2023-04-23 21:36:34,924 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 21:36:34,924 - Detection -   best_eval_score = 77.84
2023-04-23 21:36:34,924 - Detection -   eval_score = 84.26
2023-04-23 21:36:34,924 - Detection -   train_loss = 0.6610944271087646
2023-04-23 21:36:39,523 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 21:36:39,523 - Detection -   best_eval_score = 84.26
2023-04-23 21:36:39,523 - Detection -   eval_score = 85.71
2023-04-23 21:36:39,523 - Detection -   train_loss = 0.4625428120295207
2023-04-23 21:36:43,951 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 21:36:43,951 - Detection -   best_eval_score = 85.71
2023-04-23 21:36:43,951 - Detection -   eval_score = 83.67
2023-04-23 21:36:43,951 - Detection -   train_loss = 0.3548577328523
2023-04-23 21:36:48,352 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 21:36:48,352 - Detection -   best_eval_score = 85.71
2023-04-23 21:36:48,352 - Detection -   eval_score = 85.71
2023-04-23 21:36:48,352 - Detection -   train_loss = 0.2938275734583537
2023-04-23 21:36:52,910 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 21:36:52,911 - Detection -   best_eval_score = 85.71
2023-04-23 21:36:52,911 - Detection -   eval_score = 85.71
2023-04-23 21:36:52,911 - Detection -   train_loss = 0.22186781714359918
2023-04-23 21:36:57,327 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 21:36:57,328 - Detection -   best_eval_score = 85.71
2023-04-23 21:36:57,328 - Detection -   eval_score = 86.01
2023-04-23 21:36:57,328 - Detection -   train_loss = 0.16895095010598501
2023-04-23 21:37:01,781 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 21:37:01,781 - Detection -   best_eval_score = 86.01
2023-04-23 21:37:01,781 - Detection -   eval_score = 86.3
2023-04-23 21:37:01,781 - Detection -   train_loss = 0.164113017419974
2023-04-23 21:37:06,213 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 21:37:06,213 - Detection -   best_eval_score = 86.3
2023-04-23 21:37:06,214 - Detection -   eval_score = 85.71
2023-04-23 21:37:06,214 - Detection -   train_loss = 0.10203100989262263
2023-04-23 21:37:10,656 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 21:37:10,656 - Detection -   best_eval_score = 86.3
2023-04-23 21:37:10,656 - Detection -   eval_score = 86.3
2023-04-23 21:37:10,656 - Detection -   train_loss = 0.08123285261293252
2023-04-23 21:37:15,115 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 21:37:15,115 - Detection -   best_eval_score = 86.3
2023-04-23 21:37:15,115 - Detection -   eval_score = 86.88
2023-04-23 21:37:15,115 - Detection -   train_loss = 0.0692979513357083
2023-04-23 21:37:19,551 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 21:37:19,551 - Detection -   best_eval_score = 86.88
2023-04-23 21:37:19,551 - Detection -   eval_score = 85.42
2023-04-23 21:37:19,551 - Detection -   train_loss = 0.05133573276301225
2023-04-23 21:37:23,996 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 21:37:23,996 - Detection -   best_eval_score = 86.88
2023-04-23 21:37:23,996 - Detection -   eval_score = 86.88
2023-04-23 21:37:23,997 - Detection -   train_loss = 0.04654320670912663
2023-04-23 21:37:28,443 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 21:37:28,444 - Detection -   best_eval_score = 86.88
2023-04-23 21:37:28,444 - Detection -   eval_score = 86.01
2023-04-23 21:37:28,444 - Detection -   train_loss = 0.04924622302254041
2023-04-23 21:37:33,036 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 21:37:33,036 - Detection -   best_eval_score = 86.88
2023-04-23 21:37:33,036 - Detection -   eval_score = 86.59
2023-04-23 21:37:33,036 - Detection -   train_loss = 0.03539823709676663
2023-04-23 21:37:37,481 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 21:37:37,481 - Detection -   best_eval_score = 86.88
2023-04-23 21:37:37,481 - Detection -   eval_score = 85.71
2023-04-23 21:37:37,481 - Detection -   train_loss = 0.030986556162436802
2023-04-23 21:37:41,941 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 21:37:41,941 - Detection -   best_eval_score = 86.88
2023-04-23 21:37:41,941 - Detection -   eval_score = 87.17
2023-04-23 21:37:41,941 - Detection -   train_loss = 0.028382643746833008
2023-04-23 21:37:46,394 - Detection - ***** Epoch: 22: Eval results *****
2023-04-23 21:37:46,394 - Detection -   best_eval_score = 87.17
2023-04-23 21:37:46,394 - Detection -   eval_score = 86.59
2023-04-23 21:37:46,394 - Detection -   train_loss = 0.029077250510454178
2023-04-23 21:37:50,820 - Detection - ***** Epoch: 23: Eval results *****
2023-04-23 21:37:50,820 - Detection -   best_eval_score = 87.17
2023-04-23 21:37:50,820 - Detection -   eval_score = 86.3
2023-04-23 21:37:50,820 - Detection -   train_loss = 0.020929227583110332
2023-04-23 21:37:55,380 - Detection - ***** Epoch: 24: Eval results *****
2023-04-23 21:37:55,380 - Detection -   best_eval_score = 87.17
2023-04-23 21:37:55,380 - Detection -   eval_score = 86.01
2023-04-23 21:37:55,380 - Detection -   train_loss = 0.027025746802488964
2023-04-23 21:37:59,837 - Detection - ***** Epoch: 25: Eval results *****
2023-04-23 21:37:59,837 - Detection -   best_eval_score = 87.17
2023-04-23 21:37:59,837 - Detection -   eval_score = 86.3
2023-04-23 21:37:59,837 - Detection -   train_loss = 0.029411799429605406
2023-04-23 21:38:04,318 - Detection - ***** Epoch: 26: Eval results *****
2023-04-23 21:38:04,318 - Detection -   best_eval_score = 87.17
2023-04-23 21:38:04,318 - Detection -   eval_score = 87.17
2023-04-23 21:38:04,318 - Detection -   train_loss = 0.015981214431424935
2023-04-23 21:38:08,763 - Detection - ***** Epoch: 27: Eval results *****
2023-04-23 21:38:08,763 - Detection -   best_eval_score = 87.17
2023-04-23 21:38:08,763 - Detection -   eval_score = 86.3
2023-04-23 21:38:08,763 - Detection -   train_loss = 0.01693877282862862
2023-04-23 21:38:13,313 - Detection - ***** Epoch: 28: Eval results *****
2023-04-23 21:38:13,313 - Detection -   best_eval_score = 87.17
2023-04-23 21:38:13,313 - Detection -   eval_score = 86.59
2023-04-23 21:38:13,313 - Detection -   train_loss = 0.01739156028876702
2023-04-23 21:38:17,734 - Detection - ***** Epoch: 29: Eval results *****
2023-04-23 21:38:17,734 - Detection -   best_eval_score = 87.17
2023-04-23 21:38:17,734 - Detection -   eval_score = 86.3
2023-04-23 21:38:17,734 - Detection -   train_loss = 0.02035001665353775
2023-04-23 21:38:22,157 - Detection - ***** Epoch: 30: Eval results *****
2023-04-23 21:38:22,157 - Detection -   best_eval_score = 87.17
2023-04-23 21:38:22,158 - Detection -   eval_score = 86.01
2023-04-23 21:38:22,158 - Detection -   train_loss = 0.012841118887687722
2023-04-23 21:38:26,573 - Detection - ***** Epoch: 31: Eval results *****
2023-04-23 21:38:26,573 - Detection -   best_eval_score = 87.17
2023-04-23 21:38:26,573 - Detection -   eval_score = 85.71
2023-04-23 21:38:26,573 - Detection -   train_loss = 0.013443052613486847
2023-04-23 21:38:26,573 - Detection - Pre-training finished...
2023-04-23 21:38:26,573 - Detection - Training Begin...
2023-04-23 21:38:27,729 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 21:38:27,729 - Detection -   best_eval_score = 0
2023-04-23 21:38:27,730 - Detection -   eval_score = 0.0
2023-04-23 21:38:27,730 - Detection -   train_loss = 8.105817794799805
2023-04-23 21:38:28,436 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 21:38:28,436 - Detection -   best_eval_score = 0
2023-04-23 21:38:28,436 - Detection -   eval_score = 0.0
2023-04-23 21:38:28,436 - Detection -   train_loss = 7.867348829905192
2023-04-23 21:38:29,143 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 21:38:29,143 - Detection -   best_eval_score = 0
2023-04-23 21:38:29,143 - Detection -   eval_score = 0.0
2023-04-23 21:38:29,143 - Detection -   train_loss = 7.607733964920044
2023-04-23 21:38:29,851 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 21:38:29,852 - Detection -   best_eval_score = 0
2023-04-23 21:38:29,852 - Detection -   eval_score = 0.0
2023-04-23 21:38:29,852 - Detection -   train_loss = 7.3734376430511475
2023-04-23 21:38:30,560 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 21:38:30,560 - Detection -   best_eval_score = 0
2023-04-23 21:38:30,560 - Detection -   eval_score = 0.0
2023-04-23 21:38:30,560 - Detection -   train_loss = 7.107378244400024
2023-04-23 21:38:31,269 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 21:38:31,270 - Detection -   best_eval_score = 0
2023-04-23 21:38:31,270 - Detection -   eval_score = 0.0
2023-04-23 21:38:31,270 - Detection -   train_loss = 6.900484482447307
2023-04-23 21:38:31,980 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 21:38:31,980 - Detection -   best_eval_score = 0
2023-04-23 21:38:31,980 - Detection -   eval_score = 1.27
2023-04-23 21:38:31,980 - Detection -   train_loss = 6.549794832865397
2023-04-23 21:38:36,406 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 21:38:36,406 - Detection -   best_eval_score = 1.27
2023-04-23 21:38:36,406 - Detection -   eval_score = 20.68
2023-04-23 21:38:36,406 - Detection -   train_loss = 6.259639263153076
2023-04-23 21:38:40,916 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 21:38:40,917 - Detection -   best_eval_score = 20.68
2023-04-23 21:38:40,917 - Detection -   eval_score = 49.02
2023-04-23 21:38:40,917 - Detection -   train_loss = 4.679974476496379
2023-04-23 21:38:45,355 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 21:38:45,355 - Detection -   best_eval_score = 49.02
2023-04-23 21:38:45,355 - Detection -   eval_score = 65.99
2023-04-23 21:38:45,355 - Detection -   train_loss = 3.086022893587748
2023-04-23 21:38:49,759 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 21:38:49,759 - Detection -   best_eval_score = 65.99
2023-04-23 21:38:49,759 - Detection -   eval_score = 69.15
2023-04-23 21:38:49,759 - Detection -   train_loss = 1.7884007493654888
2023-04-23 21:38:54,269 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 21:38:54,270 - Detection -   best_eval_score = 69.15
2023-04-23 21:38:54,270 - Detection -   eval_score = 69.25
2023-04-23 21:38:54,270 - Detection -   train_loss = 1.2473735610644023
2023-04-23 21:38:58,670 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 21:38:58,670 - Detection -   best_eval_score = 69.25
2023-04-23 21:38:58,670 - Detection -   eval_score = 69.13
2023-04-23 21:38:58,670 - Detection -   train_loss = 1.2320340474446614
2023-04-23 21:39:03,199 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 21:39:03,199 - Detection -   best_eval_score = 69.25
2023-04-23 21:39:03,199 - Detection -   eval_score = 69.4
2023-04-23 21:39:03,199 - Detection -   train_loss = 1.2612646023432414
2023-04-23 21:39:07,596 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 21:39:07,596 - Detection -   best_eval_score = 69.4
2023-04-23 21:39:07,596 - Detection -   eval_score = 69.4
2023-04-23 21:39:07,596 - Detection -   train_loss = 1.2217753529548645
2023-04-23 21:39:11,996 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 21:39:11,996 - Detection -   best_eval_score = 69.4
2023-04-23 21:39:11,996 - Detection -   eval_score = 69.28
2023-04-23 21:39:11,996 - Detection -   train_loss = 1.211386501789093
2023-04-23 21:39:16,434 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 21:39:16,434 - Detection -   best_eval_score = 69.4
2023-04-23 21:39:16,434 - Detection -   eval_score = 69.13
2023-04-23 21:39:16,434 - Detection -   train_loss = 1.242756466070811
2023-04-23 21:39:20,939 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 21:39:20,940 - Detection -   best_eval_score = 69.4
2023-04-23 21:39:20,940 - Detection -   eval_score = 69.13
2023-04-23 21:39:20,940 - Detection -   train_loss = 1.2772436738014221
2023-04-23 21:39:25,361 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 21:39:25,361 - Detection -   best_eval_score = 69.4
2023-04-23 21:39:25,361 - Detection -   eval_score = 69.13
2023-04-23 21:39:25,361 - Detection -   train_loss = 1.2696248094240825
2023-04-23 21:39:29,780 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 21:39:29,780 - Detection -   best_eval_score = 69.4
2023-04-23 21:39:29,780 - Detection -   eval_score = 69.4
2023-04-23 21:39:29,780 - Detection -   train_loss = 1.3172038793563843
2023-04-23 21:39:34,181 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 21:39:34,181 - Detection -   best_eval_score = 69.4
2023-04-23 21:39:34,182 - Detection -   eval_score = 69.4
2023-04-23 21:39:34,182 - Detection -   train_loss = 1.3044794797897339
2023-04-23 21:39:38,619 - Detection - ***** Epoch: 22: Eval results *****
2023-04-23 21:39:38,620 - Detection -   best_eval_score = 69.4
2023-04-23 21:39:38,620 - Detection -   eval_score = 69.13
2023-04-23 21:39:38,620 - Detection -   train_loss = 1.2486570676167805
2023-04-23 21:39:43,115 - Detection - ***** Epoch: 23: Eval results *****
2023-04-23 21:39:43,115 - Detection -   best_eval_score = 69.4
2023-04-23 21:39:43,115 - Detection -   eval_score = 69.4
2023-04-23 21:39:43,115 - Detection -   train_loss = 1.264083166917165
2023-04-23 21:39:47,642 - Detection - ***** Epoch: 24: Eval results *****
2023-04-23 21:39:47,642 - Detection -   best_eval_score = 69.4
2023-04-23 21:39:47,642 - Detection -   eval_score = 69.13
2023-04-23 21:39:47,642 - Detection -   train_loss = 1.260330617427826
2023-04-23 21:39:47,642 - Detection - Training Finished...
2023-04-23 21:39:47,642 - Detection - Testing begin...
2023-04-23 21:39:49,387 - Detection - ***** Test: Confusion Matrix *****
2023-04-23 21:39:49,387 - Detection - [[ 141    1    3    0    0   48]
 [   0  102    0    0    0   26]
 [   3    0   45    3    0   55]
 [   0    0    0  121    0   39]
 [   1    0    0    1  106   24]
 [ 243   33   97  114    3 1696]]
2023-04-23 21:39:49,387 - Detection - ***** Test results *****
2023-04-23 21:39:49,387 - Detection -   Acc = 76.11
2023-04-23 21:39:49,387 - Detection -   F1 = 65.5907
2023-04-23 21:39:49,387 - Detection -   F1-known = 62.0569
2023-04-23 21:39:49,387 - Detection -   F1-open = 83.2597
2023-04-23 21:39:49,387 - Detection - Testing finished...
2023-04-23 21:39:49,387 - Detection - Results saved in results/results_ADB-BOOST-F-4.csv
2023-04-23 21:39:49,406 - Detection - Open Intent Detection Finished...
