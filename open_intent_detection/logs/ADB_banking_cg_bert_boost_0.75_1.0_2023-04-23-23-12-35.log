2023-04-23 23:12:35,093 - Detection - Open Intent Detection Begin...
2023-04-23 23:12:35,093 - Detection - Parameters Initialization...
2023-04-23 23:12:35,094 - Detection - ============================== Params ==============================
2023-04-23 23:12:35,094 - Detection - type:	open_intent_detection
2023-04-23 23:12:35,094 - Detection - logger_name:	Detection
2023-04-23 23:12:35,094 - Detection - log_dir:	logs
2023-04-23 23:12:35,094 - Detection - dataset:	banking_cg
2023-04-23 23:12:35,094 - Detection - known_cls_ratio:	0.75
2023-04-23 23:12:35,094 - Detection - labeled_ratio:	1.0
2023-04-23 23:12:35,094 - Detection - method:	ADB
2023-04-23 23:12:35,094 - Detection - train:	True
2023-04-23 23:12:35,094 - Detection - pretrain:	True
2023-04-23 23:12:35,094 - Detection - save_model:	False
2023-04-23 23:12:35,094 - Detection - backbone:	bert_boost
2023-04-23 23:12:35,094 - Detection - config_file_name:	ADB
2023-04-23 23:12:35,094 - Detection - seed:	9
2023-04-23 23:12:35,094 - Detection - gpu_id:	0
2023-04-23 23:12:35,094 - Detection - pipe_results_path:	pipe_results
2023-04-23 23:12:35,094 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-23 23:12:35,094 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-23 23:12:35,094 - Detection - model_dir:	models
2023-04-23 23:12:35,094 - Detection - load_pretrained_method:	None
2023-04-23 23:12:35,094 - Detection - result_dir:	results
2023-04-23 23:12:35,094 - Detection - results_file_name:	results_ADB-BOOST-F-10.csv
2023-04-23 23:12:35,094 - Detection - save_results:	True
2023-04-23 23:12:35,094 - Detection - loss_fct:	CrossEntropyLoss
2023-04-23 23:12:35,094 - Detection - boost_method:	F-10
2023-04-23 23:12:35,094 - Detection - boost_start_score:	0.0
2023-04-23 23:12:35,094 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.75_1.0_bert_boost_9
2023-04-23 23:12:35,094 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.75_1.0_bert_boost_9/models
2023-04-23 23:12:35,094 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-23 23:12:35,094 - Detection - num_train_epochs:	100
2023-04-23 23:12:35,094 - Detection - num_labels:	None
2023-04-23 23:12:35,094 - Detection - max_seq_length:	None
2023-04-23 23:12:35,094 - Detection - freeze_backbone_parameters:	True
2023-04-23 23:12:35,094 - Detection - feat_dim:	768
2023-04-23 23:12:35,094 - Detection - warmup_proportion:	0.1
2023-04-23 23:12:35,094 - Detection - lr_boundary:	0.05
2023-04-23 23:12:35,094 - Detection - lr:	2e-05
2023-04-23 23:12:35,094 - Detection - activation:	relu
2023-04-23 23:12:35,094 - Detection - train_batch_size:	128
2023-04-23 23:12:35,094 - Detection - eval_batch_size:	64
2023-04-23 23:12:35,094 - Detection - test_batch_size:	64
2023-04-23 23:12:35,094 - Detection - wait_patient:	10
2023-04-23 23:12:35,094 - Detection - ============================== End Params ==============================
2023-04-23 23:12:35,094 - Detection - Data and Model Preparation...
2023-04-23 23:12:35,095 - Detection - The number of known intents is 58
2023-04-23 23:12:35,095 - Detection - Lists of known labels are: ['card_payment_not_recognised', 'cash_withdrawal_charge', 'declined_transfer', 'exchange_via_app', 'cash_withdrawal_not_recognised', 'declined_card_payment', 'pending_transfer', 'country_support', 'verify_top_up', 'apple_pay_or_google_pay', 'reverted_card_payment?', 'top_up_reverted', 'passcode_forgotten', 'balance_not_updated_after_bank_transfer', 'card_linking', 'lost_or_stolen_phone', 'failed_transfer', 'card_not_working', 'top_up_by_card_charge', 'balance_not_updated_after_cheque_or_cash_deposit', 'compromised_card', 'exchange_charge', 'top_up_by_cash_or_cheque', 'order_physical_card', 'age_limit', 'terminate_account', 'pin_blocked', 'edit_personal_details', 'declined_cash_withdrawal', 'get_physical_card', 'beneficiary_not_allowed', 'disposable_card_limits', 'receiving_money', 'contactless_not_working', 'automatic_top_up', 'getting_virtual_card', 'pending_top_up', 'card_about_to_expire', 'transfer_timing', 'wrong_exchange_rate_for_cash_withdrawal', 'atm_support', 'pending_cash_withdrawal', 'visa_or_mastercard', 'transaction_charged_twice', 'pending_card_payment', 'unable_to_verify_identity', 'card_delivery_estimate', 'verify_my_identity', 'card_payment_fee_charged', 'cancel_transfer', 'get_disposable_virtual_card', 'card_swallowed', 'fiat_currency_support', 'card_acceptance', 'extra_charge_on_statement', 'activate_my_card', 'virtual_card_not_working', 'card_payment_wrong_exchange_rate']
2023-04-23 23:12:35,106 - Detection - Number of labeled training samples = 2039
2023-04-23 23:12:35,106 - Detection - Number of unlabeled training samples = 733
2023-04-23 23:12:35,108 - Detection - Number of evaluation samples = 610
2023-04-23 23:12:35,113 - Detection - Number of testing samples = 1896
2023-04-23 23:12:38,988 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-23 23:12:40,654 - Detection - Pre-training Begin...
2023-04-23 23:12:44,087 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 23:12:44,087 - Detection -   best_eval_score = 0
2023-04-23 23:12:44,087 - Detection -   eval_score = 2.62
2023-04-23 23:12:44,087 - Detection -   train_loss = 4.056984156370163
2023-04-23 23:13:20,449 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 23:13:20,449 - Detection -   best_eval_score = 2.62
2023-04-23 23:13:20,449 - Detection -   eval_score = 13.61
2023-04-23 23:13:20,449 - Detection -   train_loss = 4.039435863494873
2023-04-23 23:13:57,199 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 23:13:57,199 - Detection -   best_eval_score = 13.61
2023-04-23 23:13:57,199 - Detection -   eval_score = 35.41
2023-04-23 23:13:57,199 - Detection -   train_loss = 3.580116882920265
2023-04-23 23:14:33,615 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 23:14:33,615 - Detection -   best_eval_score = 35.41
2023-04-23 23:14:33,615 - Detection -   eval_score = 54.59
2023-04-23 23:14:33,615 - Detection -   train_loss = 2.4981289952993393
2023-04-23 23:15:10,062 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 23:15:10,062 - Detection -   best_eval_score = 54.59
2023-04-23 23:15:10,062 - Detection -   eval_score = 66.72
2023-04-23 23:15:10,062 - Detection -   train_loss = 1.6289082169532776
2023-04-23 23:15:46,665 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 23:15:46,665 - Detection -   best_eval_score = 66.72
2023-04-23 23:15:46,665 - Detection -   eval_score = 73.11
2023-04-23 23:15:46,665 - Detection -   train_loss = 1.0818583443760872
2023-04-23 23:16:23,096 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 23:16:23,096 - Detection -   best_eval_score = 73.11
2023-04-23 23:16:23,096 - Detection -   eval_score = 75.9
2023-04-23 23:16:23,096 - Detection -   train_loss = 0.7415739856660366
2023-04-23 23:16:59,686 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 23:16:59,686 - Detection -   best_eval_score = 75.9
2023-04-23 23:16:59,686 - Detection -   eval_score = 79.67
2023-04-23 23:16:59,686 - Detection -   train_loss = 0.5382428858429193
2023-04-23 23:17:36,200 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 23:17:36,200 - Detection -   best_eval_score = 79.67
2023-04-23 23:17:36,200 - Detection -   eval_score = 79.02
2023-04-23 23:17:36,200 - Detection -   train_loss = 0.39317332953214645
2023-04-23 23:18:12,791 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 23:18:12,791 - Detection -   best_eval_score = 79.67
2023-04-23 23:18:12,791 - Detection -   eval_score = 80.98
2023-04-23 23:18:12,791 - Detection -   train_loss = 0.28386621084064245
2023-04-23 23:18:49,233 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 23:18:49,234 - Detection -   best_eval_score = 80.98
2023-04-23 23:18:49,234 - Detection -   eval_score = 81.15
2023-04-23 23:18:49,234 - Detection -   train_loss = 0.2118115508928895
2023-04-23 23:19:25,742 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 23:19:25,742 - Detection -   best_eval_score = 81.15
2023-04-23 23:19:25,742 - Detection -   eval_score = 81.15
2023-04-23 23:19:25,742 - Detection -   train_loss = 0.15542159415781498
2023-04-23 23:20:02,136 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 23:20:02,136 - Detection -   best_eval_score = 81.15
2023-04-23 23:20:02,136 - Detection -   eval_score = 82.13
2023-04-23 23:20:02,136 - Detection -   train_loss = 0.12518671015277505
2023-04-23 23:20:38,824 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 23:20:38,824 - Detection -   best_eval_score = 82.13
2023-04-23 23:20:38,824 - Detection -   eval_score = 82.3
2023-04-23 23:20:38,824 - Detection -   train_loss = 0.0967231560498476
2023-04-23 23:21:15,231 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 23:21:15,231 - Detection -   best_eval_score = 82.3
2023-04-23 23:21:15,231 - Detection -   eval_score = 82.3
2023-04-23 23:21:15,231 - Detection -   train_loss = 0.07995657972060144
2023-04-23 23:21:51,767 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 23:21:51,767 - Detection -   best_eval_score = 82.3
2023-04-23 23:21:51,767 - Detection -   eval_score = 81.8
2023-04-23 23:21:51,767 - Detection -   train_loss = 0.06466849683783948
2023-04-23 23:22:28,333 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 23:22:28,333 - Detection -   best_eval_score = 82.3
2023-04-23 23:22:28,333 - Detection -   eval_score = 82.46
2023-04-23 23:22:28,333 - Detection -   train_loss = 0.049608269706368446
2023-04-23 23:23:05,003 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 23:23:05,003 - Detection -   best_eval_score = 82.46
2023-04-23 23:23:05,003 - Detection -   eval_score = 81.64
2023-04-23 23:23:05,003 - Detection -   train_loss = 0.04427469102665782
2023-04-23 23:23:41,460 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 23:23:41,460 - Detection -   best_eval_score = 82.46
2023-04-23 23:23:41,460 - Detection -   eval_score = 82.13
2023-04-23 23:23:41,460 - Detection -   train_loss = 0.038191212341189384
2023-04-23 23:24:18,056 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 23:24:18,056 - Detection -   best_eval_score = 82.46
2023-04-23 23:24:18,056 - Detection -   eval_score = 81.64
2023-04-23 23:24:18,056 - Detection -   train_loss = 0.03487279172986746
2023-04-23 23:24:54,488 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 23:24:54,488 - Detection -   best_eval_score = 82.46
2023-04-23 23:24:54,488 - Detection -   eval_score = 82.13
2023-04-23 23:24:54,488 - Detection -   train_loss = 0.03333710238803178
2023-04-23 23:25:30,925 - Detection - ***** Epoch: 22: Eval results *****
2023-04-23 23:25:30,925 - Detection -   best_eval_score = 82.46
2023-04-23 23:25:30,925 - Detection -   eval_score = 82.3
2023-04-23 23:25:30,925 - Detection -   train_loss = 0.024515196564607322
2023-04-23 23:26:07,394 - Detection - ***** Epoch: 23: Eval results *****
2023-04-23 23:26:07,394 - Detection -   best_eval_score = 82.46
2023-04-23 23:26:07,394 - Detection -   eval_score = 82.46
2023-04-23 23:26:07,394 - Detection -   train_loss = 0.02226742310449481
2023-04-23 23:26:43,993 - Detection - ***** Epoch: 24: Eval results *****
2023-04-23 23:26:43,993 - Detection -   best_eval_score = 82.46
2023-04-23 23:26:43,993 - Detection -   eval_score = 81.64
2023-04-23 23:26:43,993 - Detection -   train_loss = 0.01770953752566129
2023-04-23 23:27:20,388 - Detection - ***** Epoch: 25: Eval results *****
2023-04-23 23:27:20,388 - Detection -   best_eval_score = 82.46
2023-04-23 23:27:20,388 - Detection -   eval_score = 82.3
2023-04-23 23:27:20,388 - Detection -   train_loss = 0.01960591523675248
2023-04-23 23:27:56,947 - Detection - ***** Epoch: 26: Eval results *****
2023-04-23 23:27:56,947 - Detection -   best_eval_score = 82.46
2023-04-23 23:27:56,947 - Detection -   eval_score = 81.97
2023-04-23 23:27:56,947 - Detection -   train_loss = 0.01675422745756805
2023-04-23 23:28:33,354 - Detection - ***** Epoch: 27: Eval results *****
2023-04-23 23:28:33,354 - Detection -   best_eval_score = 82.46
2023-04-23 23:28:33,354 - Detection -   eval_score = 82.3
2023-04-23 23:28:33,354 - Detection -   train_loss = 0.012993963551707566
2023-04-23 23:28:33,355 - Detection - Pre-training finished...
2023-04-23 23:28:33,355 - Detection - Training Begin...
2023-04-23 23:28:38,387 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 23:28:38,387 - Detection -   best_eval_score = 0
2023-04-23 23:28:38,387 - Detection -   eval_score = 0.0
2023-04-23 23:28:38,387 - Detection -   train_loss = 14.874454319477081
2023-04-23 23:28:41,384 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 23:28:41,384 - Detection -   best_eval_score = 0
2023-04-23 23:28:41,384 - Detection -   eval_score = 0.0
2023-04-23 23:28:41,384 - Detection -   train_loss = 14.438062846660614
2023-04-23 23:28:44,397 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 23:28:44,397 - Detection -   best_eval_score = 0
2023-04-23 23:28:44,397 - Detection -   eval_score = 0.0
2023-04-23 23:28:44,397 - Detection -   train_loss = 13.836785018444061
2023-04-23 23:28:47,413 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 23:28:47,413 - Detection -   best_eval_score = 0
2023-04-23 23:28:47,413 - Detection -   eval_score = 0.0
2023-04-23 23:28:47,413 - Detection -   train_loss = 13.204921782016754
2023-04-23 23:28:50,433 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 23:28:50,433 - Detection -   best_eval_score = 0
2023-04-23 23:28:50,434 - Detection -   eval_score = 0.0
2023-04-23 23:28:50,434 - Detection -   train_loss = 12.442371785640717
2023-04-23 23:28:53,457 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 23:28:53,457 - Detection -   best_eval_score = 0
2023-04-23 23:28:53,458 - Detection -   eval_score = 0.0
2023-04-23 23:28:53,458 - Detection -   train_loss = 11.701498091220856
2023-04-23 23:28:56,471 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 23:28:56,471 - Detection -   best_eval_score = 0
2023-04-23 23:28:56,471 - Detection -   eval_score = 0.0
2023-04-23 23:28:56,471 - Detection -   train_loss = 10.92299884557724
2023-04-23 23:28:59,491 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 23:28:59,491 - Detection -   best_eval_score = 0
2023-04-23 23:28:59,491 - Detection -   eval_score = 1.56
2023-04-23 23:28:59,491 - Detection -   train_loss = 10.175453662872314
2023-04-23 23:29:35,879 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 23:29:35,879 - Detection -   best_eval_score = 1.56
2023-04-23 23:29:35,879 - Detection -   eval_score = 60.42
2023-04-23 23:29:35,879 - Detection -   train_loss = 9.389684975147247
2023-04-23 23:30:12,028 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 23:30:12,028 - Detection -   best_eval_score = 60.42
2023-04-23 23:30:12,028 - Detection -   eval_score = 73.08
2023-04-23 23:30:12,028 - Detection -   train_loss = 2.1567977517843246
2023-04-23 23:30:48,221 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 23:30:48,221 - Detection -   best_eval_score = 73.08
2023-04-23 23:30:48,221 - Detection -   eval_score = 73.91
2023-04-23 23:30:48,221 - Detection -   train_loss = 1.5466554537415504
2023-04-23 23:31:24,624 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 23:31:24,625 - Detection -   best_eval_score = 73.91
2023-04-23 23:31:24,625 - Detection -   eval_score = 74.43
2023-04-23 23:31:24,625 - Detection -   train_loss = 1.5129628032445908
2023-04-23 23:32:00,831 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 23:32:00,831 - Detection -   best_eval_score = 74.43
2023-04-23 23:32:00,831 - Detection -   eval_score = 74.19
2023-04-23 23:32:00,831 - Detection -   train_loss = 1.536474123597145
2023-04-23 23:32:36,947 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 23:32:36,947 - Detection -   best_eval_score = 74.43
2023-04-23 23:32:36,947 - Detection -   eval_score = 74.14
2023-04-23 23:32:36,947 - Detection -   train_loss = 1.5017899572849274
2023-04-23 23:33:13,065 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 23:33:13,065 - Detection -   best_eval_score = 74.43
2023-04-23 23:33:13,065 - Detection -   eval_score = 74.06
2023-04-23 23:33:13,065 - Detection -   train_loss = 1.5289067402482033
2023-04-23 23:33:49,586 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 23:33:49,586 - Detection -   best_eval_score = 74.43
2023-04-23 23:33:49,586 - Detection -   eval_score = 74.38
2023-04-23 23:33:49,586 - Detection -   train_loss = 1.5199252590537071
2023-04-23 23:34:25,846 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 23:34:25,847 - Detection -   best_eval_score = 74.43
2023-04-23 23:34:25,847 - Detection -   eval_score = 74.06
2023-04-23 23:34:25,847 - Detection -   train_loss = 1.5312180742621422
2023-04-23 23:35:02,011 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 23:35:02,011 - Detection -   best_eval_score = 74.43
2023-04-23 23:35:02,011 - Detection -   eval_score = 74.1
2023-04-23 23:35:02,011 - Detection -   train_loss = 1.5543437823653221
2023-04-23 23:35:38,151 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 23:35:38,151 - Detection -   best_eval_score = 74.43
2023-04-23 23:35:38,151 - Detection -   eval_score = 74.33
2023-04-23 23:35:38,152 - Detection -   train_loss = 1.4901737123727798
2023-04-23 23:36:14,368 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 23:36:14,368 - Detection -   best_eval_score = 74.43
2023-04-23 23:36:14,368 - Detection -   eval_score = 74.22
2023-04-23 23:36:14,368 - Detection -   train_loss = 1.5187309235334396
2023-04-23 23:36:50,749 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 23:36:50,749 - Detection -   best_eval_score = 74.43
2023-04-23 23:36:50,749 - Detection -   eval_score = 73.88
2023-04-23 23:36:50,749 - Detection -   train_loss = 1.5484423115849495
2023-04-23 23:37:27,050 - Detection - ***** Epoch: 22: Eval results *****
2023-04-23 23:37:27,051 - Detection -   best_eval_score = 74.43
2023-04-23 23:37:27,051 - Detection -   eval_score = 72.91
2023-04-23 23:37:27,051 - Detection -   train_loss = 1.551151342689991
2023-04-23 23:37:27,051 - Detection - Training Finished...
2023-04-23 23:37:27,051 - Detection - Testing begin...
2023-04-23 23:37:28,973 - Detection - ***** Test: Confusion Matrix *****
2023-04-23 23:37:28,973 - Detection - [[ 12   0   0 ...   0   0   7]
 [  0  29   0 ...   0   0   3]
 [  0   0  10 ...   0   0   8]
 ...
 [  0   0   0 ...   4   0   4]
 [  0   0   0 ...   0  16   3]
 [  2   0   1 ...   0   0 319]]
2023-04-23 23:37:28,973 - Detection - ***** Test results *****
2023-04-23 23:37:28,973 - Detection -   Acc = 66.03
2023-04-23 23:37:28,973 - Detection -   F1 = 68.7232
2023-04-23 23:37:28,973 - Detection -   F1-known = 68.9687
2023-04-23 23:37:28,973 - Detection -   F1-open = 54.4833
2023-04-23 23:37:28,973 - Detection - Testing finished...
2023-04-23 23:37:28,973 - Detection - Results saved in results/results_ADB-BOOST-F-10.csv
2023-04-23 23:37:28,993 - Detection - Open Intent Detection Finished...
