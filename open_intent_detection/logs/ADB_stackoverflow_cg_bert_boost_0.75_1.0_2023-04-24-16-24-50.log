2023-04-24 16:24:50,994 - Detection - Open Intent Detection Begin...
2023-04-24 16:24:50,994 - Detection - Parameters Initialization...
2023-04-24 16:24:50,994 - Detection - ============================== Params ==============================
2023-04-24 16:24:50,994 - Detection - type:	open_intent_detection
2023-04-24 16:24:50,994 - Detection - logger_name:	Detection
2023-04-24 16:24:50,994 - Detection - log_dir:	logs
2023-04-24 16:24:50,994 - Detection - dataset:	stackoverflow_cg
2023-04-24 16:24:50,994 - Detection - known_cls_ratio:	0.75
2023-04-24 16:24:50,994 - Detection - labeled_ratio:	1.0
2023-04-24 16:24:50,994 - Detection - method:	ADB
2023-04-24 16:24:50,994 - Detection - train:	True
2023-04-24 16:24:50,994 - Detection - pretrain:	True
2023-04-24 16:24:50,994 - Detection - save_model:	False
2023-04-24 16:24:50,994 - Detection - backbone:	bert_boost
2023-04-24 16:24:50,994 - Detection - config_file_name:	ADB
2023-04-24 16:24:50,994 - Detection - seed:	9
2023-04-24 16:24:50,994 - Detection - gpu_id:	0
2023-04-24 16:24:50,994 - Detection - pipe_results_path:	pipe_results
2023-04-24 16:24:50,994 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-24 16:24:50,994 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-24 16:24:50,994 - Detection - model_dir:	models
2023-04-24 16:24:50,994 - Detection - load_pretrained_method:	None
2023-04-24 16:24:50,994 - Detection - result_dir:	results
2023-04-24 16:24:50,994 - Detection - results_file_name:	results_ADB-BOOST-F-10.csv
2023-04-24 16:24:50,995 - Detection - save_results:	True
2023-04-24 16:24:50,995 - Detection - loss_fct:	CrossEntropyLoss
2023-04-24 16:24:50,995 - Detection - boost_method:	F-10
2023-04-24 16:24:50,995 - Detection - boost_start_score:	0.0
2023-04-24 16:24:50,995 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.75_1.0_bert_boost_9
2023-04-24 16:24:50,995 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.75_1.0_bert_boost_9/models
2023-04-24 16:24:50,995 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-24 16:24:50,995 - Detection - num_train_epochs:	100
2023-04-24 16:24:50,995 - Detection - num_labels:	None
2023-04-24 16:24:50,995 - Detection - max_seq_length:	None
2023-04-24 16:24:50,995 - Detection - freeze_backbone_parameters:	True
2023-04-24 16:24:50,995 - Detection - feat_dim:	768
2023-04-24 16:24:50,995 - Detection - warmup_proportion:	0.1
2023-04-24 16:24:50,995 - Detection - lr_boundary:	0.05
2023-04-24 16:24:50,995 - Detection - lr:	2e-05
2023-04-24 16:24:50,995 - Detection - activation:	relu
2023-04-24 16:24:50,995 - Detection - train_batch_size:	128
2023-04-24 16:24:50,995 - Detection - eval_batch_size:	64
2023-04-24 16:24:50,995 - Detection - test_batch_size:	64
2023-04-24 16:24:50,995 - Detection - wait_patient:	10
2023-04-24 16:24:50,995 - Detection - ============================== End Params ==============================
2023-04-24 16:24:50,995 - Detection - Data and Model Preparation...
2023-04-24 16:24:50,995 - Detection - The number of known intents is 15
2023-04-24 16:24:50,996 - Detection - Lists of known labels are: ['cocoa', 'haskell', 'hibernate', 'excel', 'spring', 'sharepoint', 'bash', 'drupal', 'magento', 'matlab', 'visual-studio', 'oracle', 'scala', 'ajax', 'osx']
2023-04-24 16:24:51,005 - Detection - Number of labeled training samples = 2125
2023-04-24 16:24:51,005 - Detection - Number of unlabeled training samples = 666
2023-04-24 16:24:51,008 - Detection - Number of evaluation samples = 1048
2023-04-24 16:24:51,013 - Detection - Number of testing samples = 2905
2023-04-24 16:27:26,415 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-24 16:27:28,088 - Detection - Pre-training Begin...
2023-04-24 16:27:31,275 - Detection - ***** Epoch: 1: Eval results *****
2023-04-24 16:27:31,275 - Detection -   best_eval_score = 0
2023-04-24 16:27:31,275 - Detection -   eval_score = 8.97
2023-04-24 16:27:31,275 - Detection -   train_loss = 2.699966318467084
2023-04-24 16:28:38,010 - Detection - ***** Epoch: 2: Eval results *****
2023-04-24 16:28:38,010 - Detection -   best_eval_score = 8.97
2023-04-24 16:28:38,010 - Detection -   eval_score = 29.39
2023-04-24 16:28:38,010 - Detection -   train_loss = 2.6800388308132397
2023-04-24 16:29:42,695 - Detection - ***** Epoch: 3: Eval results *****
2023-04-24 16:29:42,695 - Detection -   best_eval_score = 29.39
2023-04-24 16:29:42,695 - Detection -   eval_score = 71.37
2023-04-24 16:29:42,695 - Detection -   train_loss = 2.1788879843319164
2023-04-24 16:30:47,887 - Detection - ***** Epoch: 4: Eval results *****
2023-04-24 16:30:47,887 - Detection -   best_eval_score = 71.37
2023-04-24 16:30:47,887 - Detection -   eval_score = 77.48
2023-04-24 16:30:47,887 - Detection -   train_loss = 1.3283607889624203
2023-04-24 16:31:52,163 - Detection - ***** Epoch: 5: Eval results *****
2023-04-24 16:31:52,163 - Detection -   best_eval_score = 77.48
2023-04-24 16:31:52,163 - Detection -   eval_score = 78.44
2023-04-24 16:31:52,163 - Detection -   train_loss = 0.9499931615941665
2023-04-24 16:32:56,479 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 16:32:56,480 - Detection -   best_eval_score = 78.44
2023-04-24 16:32:56,480 - Detection -   eval_score = 79.29
2023-04-24 16:32:56,480 - Detection -   train_loss = 0.7654051465146682
2023-04-24 16:34:01,835 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 16:34:01,835 - Detection -   best_eval_score = 79.29
2023-04-24 16:34:01,835 - Detection -   eval_score = 79.48
2023-04-24 16:34:01,835 - Detection -   train_loss = 0.6370805922676536
2023-04-24 16:35:06,104 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 16:35:06,105 - Detection -   best_eval_score = 79.48
2023-04-24 16:35:06,105 - Detection -   eval_score = 79.1
2023-04-24 16:35:06,105 - Detection -   train_loss = 0.5407114169176888
2023-04-24 16:36:08,226 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 16:36:08,227 - Detection -   best_eval_score = 79.48
2023-04-24 16:36:08,227 - Detection -   eval_score = 78.05
2023-04-24 16:36:08,227 - Detection -   train_loss = 0.4754902702920577
2023-04-24 16:37:12,368 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 16:37:12,368 - Detection -   best_eval_score = 79.48
2023-04-24 16:37:12,368 - Detection -   eval_score = 78.72
2023-04-24 16:37:12,368 - Detection -   train_loss = 0.35833413635983186
2023-04-24 16:38:17,002 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 16:38:17,002 - Detection -   best_eval_score = 79.48
2023-04-24 16:38:17,002 - Detection -   eval_score = 78.53
2023-04-24 16:38:17,002 - Detection -   train_loss = 0.27264922769630656
2023-04-24 16:39:20,474 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 16:39:20,474 - Detection -   best_eval_score = 79.48
2023-04-24 16:39:20,474 - Detection -   eval_score = 78.72
2023-04-24 16:39:20,474 - Detection -   train_loss = 0.2350234494489782
2023-04-24 16:40:25,123 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 16:40:25,123 - Detection -   best_eval_score = 79.48
2023-04-24 16:40:25,123 - Detection -   eval_score = 78.15
2023-04-24 16:40:25,123 - Detection -   train_loss = 0.1914909087559756
2023-04-24 16:41:29,829 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 16:41:29,829 - Detection -   best_eval_score = 79.48
2023-04-24 16:41:29,829 - Detection -   eval_score = 78.15
2023-04-24 16:41:29,829 - Detection -   train_loss = 0.17542812534991434
2023-04-24 16:42:34,003 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 16:42:34,003 - Detection -   best_eval_score = 79.48
2023-04-24 16:42:34,003 - Detection -   eval_score = 78.05
2023-04-24 16:42:34,003 - Detection -   train_loss = 0.13465015984633388
2023-04-24 16:43:37,773 - Detection - ***** Epoch: 16: Eval results *****
2023-04-24 16:43:37,773 - Detection -   best_eval_score = 79.48
2023-04-24 16:43:37,773 - Detection -   eval_score = 78.34
2023-04-24 16:43:37,773 - Detection -   train_loss = 0.11759492404320661
2023-04-24 16:44:40,882 - Detection - ***** Epoch: 17: Eval results *****
2023-04-24 16:44:40,882 - Detection -   best_eval_score = 79.48
2023-04-24 16:44:40,882 - Detection -   eval_score = 79.01
2023-04-24 16:44:40,882 - Detection -   train_loss = 0.11097266941386111
2023-04-24 16:44:40,883 - Detection - Pre-training finished...
2023-04-24 16:44:40,883 - Detection - Training Begin...
2023-04-24 16:44:45,290 - Detection - ***** Epoch: 1: Eval results *****
2023-04-24 16:44:45,290 - Detection -   best_eval_score = 0
2023-04-24 16:44:45,290 - Detection -   eval_score = 0.0
2023-04-24 16:44:45,290 - Detection -   train_loss = 9.861304395339069
2023-04-24 16:44:48,034 - Detection - ***** Epoch: 2: Eval results *****
2023-04-24 16:44:48,034 - Detection -   best_eval_score = 0
2023-04-24 16:44:48,034 - Detection -   eval_score = 0.0
2023-04-24 16:44:48,034 - Detection -   train_loss = 9.34395554486443
2023-04-24 16:44:50,780 - Detection - ***** Epoch: 3: Eval results *****
2023-04-24 16:44:50,780 - Detection -   best_eval_score = 0
2023-04-24 16:44:50,780 - Detection -   eval_score = 0.0
2023-04-24 16:44:50,780 - Detection -   train_loss = 8.700121094198789
2023-04-24 16:44:53,529 - Detection - ***** Epoch: 4: Eval results *****
2023-04-24 16:44:53,529 - Detection -   best_eval_score = 0
2023-04-24 16:44:53,529 - Detection -   eval_score = 0.18
2023-04-24 16:44:53,529 - Detection -   train_loss = 7.832657000597785
2023-04-24 16:45:55,879 - Detection - ***** Epoch: 5: Eval results *****
2023-04-24 16:45:55,879 - Detection -   best_eval_score = 0.18
2023-04-24 16:45:55,879 - Detection -   eval_score = 73.44
2023-04-24 16:45:55,879 - Detection -   train_loss = 6.908512592315674
2023-04-24 16:46:59,003 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 16:46:59,003 - Detection -   best_eval_score = 73.44
2023-04-24 16:46:59,003 - Detection -   eval_score = 73.33
2023-04-24 16:46:59,003 - Detection -   train_loss = 1.6197532555636238
2023-04-24 16:48:03,223 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 16:48:03,223 - Detection -   best_eval_score = 73.44
2023-04-24 16:48:03,223 - Detection -   eval_score = 73.38
2023-04-24 16:48:03,223 - Detection -   train_loss = 1.6054908738416784
2023-04-24 16:49:08,136 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 16:49:08,136 - Detection -   best_eval_score = 73.44
2023-04-24 16:49:08,136 - Detection -   eval_score = 73.41
2023-04-24 16:49:08,137 - Detection -   train_loss = 1.599762061062981
2023-04-24 16:50:12,507 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 16:50:12,507 - Detection -   best_eval_score = 73.44
2023-04-24 16:50:12,507 - Detection -   eval_score = 73.36
2023-04-24 16:50:12,508 - Detection -   train_loss = 1.5768128703622257
2023-04-24 16:51:16,027 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 16:51:16,027 - Detection -   best_eval_score = 73.44
2023-04-24 16:51:16,027 - Detection -   eval_score = 73.47
2023-04-24 16:51:16,027 - Detection -   train_loss = 1.5904344320297241
2023-04-24 16:52:21,681 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 16:52:21,681 - Detection -   best_eval_score = 73.47
2023-04-24 16:52:21,682 - Detection -   eval_score = 73.3
2023-04-24 16:52:21,682 - Detection -   train_loss = 1.5825747041141285
2023-04-24 16:53:26,626 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 16:53:26,626 - Detection -   best_eval_score = 73.47
2023-04-24 16:53:26,626 - Detection -   eval_score = 73.49
2023-04-24 16:53:26,626 - Detection -   train_loss = 1.6079725097207462
2023-04-24 16:54:31,480 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 16:54:31,480 - Detection -   best_eval_score = 73.49
2023-04-24 16:54:31,480 - Detection -   eval_score = 73.62
2023-04-24 16:54:31,480 - Detection -   train_loss = 1.6068663176368265
2023-04-24 16:55:36,394 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 16:55:36,394 - Detection -   best_eval_score = 73.62
2023-04-24 16:55:36,394 - Detection -   eval_score = 73.43
2023-04-24 16:55:36,394 - Detection -   train_loss = 1.6282406975241268
2023-04-24 16:56:40,877 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 16:56:40,878 - Detection -   best_eval_score = 73.62
2023-04-24 16:56:40,878 - Detection -   eval_score = 73.47
2023-04-24 16:56:40,878 - Detection -   train_loss = 1.6072571067249073
2023-04-24 16:57:45,387 - Detection - ***** Epoch: 16: Eval results *****
2023-04-24 16:57:45,387 - Detection -   best_eval_score = 73.62
2023-04-24 16:57:45,387 - Detection -   eval_score = 73.51
2023-04-24 16:57:45,387 - Detection -   train_loss = 1.6061134759117575
2023-04-24 16:58:50,724 - Detection - ***** Epoch: 17: Eval results *****
2023-04-24 16:58:50,724 - Detection -   best_eval_score = 73.62
2023-04-24 16:58:50,725 - Detection -   eval_score = 73.82
2023-04-24 16:58:50,725 - Detection -   train_loss = 1.602916114470538
2023-04-24 16:59:54,178 - Detection - ***** Epoch: 18: Eval results *****
2023-04-24 16:59:54,178 - Detection -   best_eval_score = 73.82
2023-04-24 16:59:54,178 - Detection -   eval_score = 73.42
2023-04-24 16:59:54,178 - Detection -   train_loss = 1.5970311866087072
2023-04-24 17:00:57,403 - Detection - ***** Epoch: 19: Eval results *****
2023-04-24 17:00:57,403 - Detection -   best_eval_score = 73.82
2023-04-24 17:00:57,403 - Detection -   eval_score = 73.15
2023-04-24 17:00:57,403 - Detection -   train_loss = 1.6172155562569113
2023-04-24 17:01:59,464 - Detection - ***** Epoch: 20: Eval results *****
2023-04-24 17:01:59,464 - Detection -   best_eval_score = 73.82
2023-04-24 17:01:59,464 - Detection -   eval_score = 73.09
2023-04-24 17:01:59,464 - Detection -   train_loss = 1.593225170584286
2023-04-24 17:03:02,198 - Detection - ***** Epoch: 21: Eval results *****
2023-04-24 17:03:02,198 - Detection -   best_eval_score = 73.82
2023-04-24 17:03:02,198 - Detection -   eval_score = 73.57
2023-04-24 17:03:02,199 - Detection -   train_loss = 1.5505888672435986
2023-04-24 17:04:05,586 - Detection - ***** Epoch: 22: Eval results *****
2023-04-24 17:04:05,586 - Detection -   best_eval_score = 73.82
2023-04-24 17:04:05,587 - Detection -   eval_score = 73.4
2023-04-24 17:04:05,587 - Detection -   train_loss = 1.6085189791286694
2023-04-24 17:05:07,599 - Detection - ***** Epoch: 23: Eval results *****
2023-04-24 17:05:07,599 - Detection -   best_eval_score = 73.82
2023-04-24 17:05:07,599 - Detection -   eval_score = 73.37
2023-04-24 17:05:07,599 - Detection -   train_loss = 1.6065238293479471
2023-04-24 17:06:09,744 - Detection - ***** Epoch: 24: Eval results *****
2023-04-24 17:06:09,744 - Detection -   best_eval_score = 73.82
2023-04-24 17:06:09,744 - Detection -   eval_score = 73.65
2023-04-24 17:06:09,744 - Detection -   train_loss = 1.5886695525225472
2023-04-24 17:07:12,628 - Detection - ***** Epoch: 25: Eval results *****
2023-04-24 17:07:12,628 - Detection -   best_eval_score = 73.82
2023-04-24 17:07:12,628 - Detection -   eval_score = 73.61
2023-04-24 17:07:12,628 - Detection -   train_loss = 1.6143166598151713
2023-04-24 17:08:14,734 - Detection - ***** Epoch: 26: Eval results *****
2023-04-24 17:08:14,734 - Detection -   best_eval_score = 73.82
2023-04-24 17:08:14,734 - Detection -   eval_score = 73.53
2023-04-24 17:08:14,734 - Detection -   train_loss = 1.6066751269733204
2023-04-24 17:09:17,781 - Detection - ***** Epoch: 27: Eval results *****
2023-04-24 17:09:17,781 - Detection -   best_eval_score = 73.82
2023-04-24 17:09:17,781 - Detection -   eval_score = 73.46
2023-04-24 17:09:17,781 - Detection -   train_loss = 1.5825523418538712
2023-04-24 17:09:17,781 - Detection - Training Finished...
2023-04-24 17:09:17,781 - Detection - Testing begin...
2023-04-24 17:09:20,119 - Detection - ***** Test: Confusion Matrix *****
2023-04-24 17:09:20,119 - Detection - [[ 78   0   0   0   2   0   0   0   0   0   1   1   0   1  28  50]
 [  0  84   0   1   0   0   0   0   0   2   0   0   1   0   2  32]
 [  1   0  78   0   4   0   0   0   0   0   0   3   0   0   0  42]
 [  5   2   0  81   0   0   1   0   0   0   0   1   0   0   2  48]
 [  1   0   5   0 114   0   0   0   0   0   0   0   1   1   2  27]
 [  0   0   1   1   1 110   1   0   0   0   1   0   0   2   1  53]
 [  6   3   0   0   0   1  85   1   0   0   0   0   0   1   4  38]
 [  0   1   0   0   0   0   0  95   0   0   0   0   0   1   0  31]
 [  0   0   0   0   0   0   0   3 100   0   0   0   0   0   0  29]
 [  1   1   0   0   0   0   0   0   0 129   0   0   0   0   1  32]
 [  3   2   0   0   0   3   0   0   0   0  40   0   0   3   4  51]
 [  1   1   0   1   0   1   0   0   0   0   0  88   0   0   0  35]
 [  1   7   0   0   0   0   0   0   0   0   0   0  80   0   0  36]
 [  4   0   0   1   0   3   1   1   0   0   1   0   0 115   1  33]
 [ 34   2   0   1   0   0   1   1   0   0   1   1   0   0 125  27]
 [ 23  27   1   9   0   9  23  20   0   0  15   3   1  42  32 554]]
2023-04-24 17:09:20,119 - Detection - ***** Test results *****
2023-04-24 17:09:20,119 - Detection -   Acc = 67.33
2023-04-24 17:09:20,120 - Detection -   F1 = 70.6448
2023-04-24 17:09:20,120 - Detection -   F1-known = 71.4191
2023-04-24 17:09:20,120 - Detection -   F1-open = 59.0304
2023-04-24 17:09:20,120 - Detection - Testing finished...
2023-04-24 17:09:20,120 - Detection - Results saved in results/results_ADB-BOOST-F-10.csv
2023-04-24 17:09:20,138 - Detection - Open Intent Detection Finished...
