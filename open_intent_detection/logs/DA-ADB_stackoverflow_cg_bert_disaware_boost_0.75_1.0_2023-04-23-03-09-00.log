2023-04-23 03:09:00,180 - Detection - Open Intent Detection Begin...
2023-04-23 03:09:00,180 - Detection - Parameters Initialization...
2023-04-23 03:09:00,181 - Detection - ============================== Params ==============================
2023-04-23 03:09:00,181 - Detection - type:	open_intent_detection
2023-04-23 03:09:00,181 - Detection - logger_name:	Detection
2023-04-23 03:09:00,181 - Detection - log_dir:	logs
2023-04-23 03:09:00,181 - Detection - dataset:	stackoverflow_cg
2023-04-23 03:09:00,181 - Detection - known_cls_ratio:	0.75
2023-04-23 03:09:00,181 - Detection - labeled_ratio:	1.0
2023-04-23 03:09:00,181 - Detection - method:	DA-ADB
2023-04-23 03:09:00,181 - Detection - train:	True
2023-04-23 03:09:00,181 - Detection - pretrain:	True
2023-04-23 03:09:00,181 - Detection - save_model:	False
2023-04-23 03:09:00,181 - Detection - backbone:	bert_disaware_boost
2023-04-23 03:09:00,181 - Detection - config_file_name:	DA-ADB
2023-04-23 03:09:00,181 - Detection - seed:	8
2023-04-23 03:09:00,181 - Detection - gpu_id:	0
2023-04-23 03:09:00,181 - Detection - pipe_results_path:	pipe_results
2023-04-23 03:09:00,181 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-23 03:09:00,181 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-23 03:09:00,181 - Detection - model_dir:	models
2023-04-23 03:09:00,181 - Detection - load_pretrained_method:	None
2023-04-23 03:09:00,181 - Detection - result_dir:	results
2023-04-23 03:09:00,181 - Detection - results_file_name:	results_DA-ADB-BOOST-F-4.csv
2023-04-23 03:09:00,181 - Detection - save_results:	True
2023-04-23 03:09:00,181 - Detection - loss_fct:	CrossEntropyLoss
2023-04-23 03:09:00,181 - Detection - boost_method:	F-4
2023-04-23 03:09:00,181 - Detection - boost_start_score:	0.0
2023-04-23 03:09:00,181 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.75_1.0_bert_disaware_boost_8
2023-04-23 03:09:00,181 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.75_1.0_bert_disaware_boost_8/models
2023-04-23 03:09:00,181 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-23 03:09:00,181 - Detection - num_train_epochs:	100
2023-04-23 03:09:00,181 - Detection - num_labels:	None
2023-04-23 03:09:00,181 - Detection - max_seq_length:	None
2023-04-23 03:09:00,181 - Detection - freeze_backbone_parameters:	True
2023-04-23 03:09:00,181 - Detection - feat_dim:	768
2023-04-23 03:09:00,181 - Detection - warmup_proportion:	0.1
2023-04-23 03:09:00,181 - Detection - scale:	4
2023-04-23 03:09:00,181 - Detection - lr_boundary:	0.05
2023-04-23 03:09:00,181 - Detection - lr:	2e-05
2023-04-23 03:09:00,181 - Detection - activation:	relu
2023-04-23 03:09:00,181 - Detection - train_batch_size:	128
2023-04-23 03:09:00,181 - Detection - eval_batch_size:	64
2023-04-23 03:09:00,181 - Detection - test_batch_size:	64
2023-04-23 03:09:00,181 - Detection - wait_patient:	10
2023-04-23 03:09:00,181 - Detection - ============================== End Params ==============================
2023-04-23 03:09:00,181 - Detection - Data and Model Preparation...
2023-04-23 03:09:00,182 - Detection - The number of known intents is 15
2023-04-23 03:09:00,182 - Detection - Lists of known labels are: ['hibernate', 'oracle', 'haskell', 'sharepoint', 'visual-studio', 'drupal', 'osx', 'bash', 'qt', 'apache', 'spring', 'ajax', 'scala', 'wordpress', 'linq']
2023-04-23 03:09:00,192 - Detection - Number of labeled training samples = 2092
2023-04-23 03:09:00,192 - Detection - Number of unlabeled training samples = 699
2023-04-23 03:09:00,194 - Detection - Number of evaluation samples = 1072
2023-04-23 03:09:00,200 - Detection - Number of testing samples = 2905
2023-04-23 03:09:05,908 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-23 03:09:06,022 - Detection - Pre-training Begin...
2023-04-23 03:09:10,071 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 03:09:10,071 - Detection -   best_eval_score = 0
2023-04-23 03:09:10,071 - Detection -   eval_score = 1.55
2023-04-23 03:09:10,071 - Detection -   train_loss = 2.7083061863394344
2023-04-23 03:09:23,157 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 03:09:23,158 - Detection -   best_eval_score = 1.55
2023-04-23 03:09:23,158 - Detection -   eval_score = 1.39
2023-04-23 03:09:23,158 - Detection -   train_loss = 2.6979775569018196
2023-04-23 03:09:36,119 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 03:09:36,119 - Detection -   best_eval_score = 1.55
2023-04-23 03:09:36,120 - Detection -   eval_score = 13.36
2023-04-23 03:09:36,120 - Detection -   train_loss = 2.6514608299030975
2023-04-23 03:09:49,246 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 03:09:49,246 - Detection -   best_eval_score = 13.36
2023-04-23 03:09:49,246 - Detection -   eval_score = 39.91
2023-04-23 03:09:49,246 - Detection -   train_loss = 2.519096248290118
2023-04-23 03:10:02,363 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 03:10:02,363 - Detection -   best_eval_score = 39.91
2023-04-23 03:10:02,363 - Detection -   eval_score = 74.92
2023-04-23 03:10:02,363 - Detection -   train_loss = 2.1787480186013615
2023-04-23 03:10:15,433 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 03:10:15,433 - Detection -   best_eval_score = 74.92
2023-04-23 03:10:15,433 - Detection -   eval_score = 79.93
2023-04-23 03:10:15,433 - Detection -   train_loss = 1.694616668364581
2023-04-23 03:10:28,521 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 03:10:28,522 - Detection -   best_eval_score = 79.93
2023-04-23 03:10:28,522 - Detection -   eval_score = 80.42
2023-04-23 03:10:28,522 - Detection -   train_loss = 1.4232137834324556
2023-04-23 03:10:41,608 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 03:10:41,608 - Detection -   best_eval_score = 80.42
2023-04-23 03:10:41,608 - Detection -   eval_score = 80.82
2023-04-23 03:10:41,608 - Detection -   train_loss = 1.2638625888263477
2023-04-23 03:10:54,790 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 03:10:54,790 - Detection -   best_eval_score = 80.82
2023-04-23 03:10:54,790 - Detection -   eval_score = 81.73
2023-04-23 03:10:54,790 - Detection -   train_loss = 1.1615179005791159
2023-04-23 03:11:07,883 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 03:11:07,884 - Detection -   best_eval_score = 81.73
2023-04-23 03:11:07,884 - Detection -   eval_score = 82.63
2023-04-23 03:11:07,884 - Detection -   train_loss = 1.0812943297273971
2023-04-23 03:11:20,907 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 03:11:20,907 - Detection -   best_eval_score = 82.63
2023-04-23 03:11:20,908 - Detection -   eval_score = 82.85
2023-04-23 03:11:20,908 - Detection -   train_loss = 1.0085924653445972
2023-04-23 03:11:34,108 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 03:11:34,108 - Detection -   best_eval_score = 82.85
2023-04-23 03:11:34,108 - Detection -   eval_score = 82.37
2023-04-23 03:11:34,108 - Detection -   train_loss = 0.9388714748270371
2023-04-23 03:11:47,214 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 03:11:47,214 - Detection -   best_eval_score = 82.85
2023-04-23 03:11:47,214 - Detection -   eval_score = 82.38
2023-04-23 03:11:47,214 - Detection -   train_loss = 0.8818171409999623
2023-04-23 03:12:00,397 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 03:12:00,397 - Detection -   best_eval_score = 82.85
2023-04-23 03:12:00,398 - Detection -   eval_score = 81.47
2023-04-23 03:12:00,398 - Detection -   train_loss = 0.8285123285125283
2023-04-23 03:12:13,446 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 03:12:13,446 - Detection -   best_eval_score = 82.85
2023-04-23 03:12:13,446 - Detection -   eval_score = 81.5
2023-04-23 03:12:13,446 - Detection -   train_loss = 0.8169355988502502
2023-04-23 03:12:26,632 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 03:12:26,632 - Detection -   best_eval_score = 82.85
2023-04-23 03:12:26,632 - Detection -   eval_score = 81.14
2023-04-23 03:12:26,632 - Detection -   train_loss = 0.7571744463023018
2023-04-23 03:12:39,778 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 03:12:39,778 - Detection -   best_eval_score = 82.85
2023-04-23 03:12:39,778 - Detection -   eval_score = 81.6
2023-04-23 03:12:39,778 - Detection -   train_loss = 0.7157563742469338
2023-04-23 03:12:52,810 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 03:12:52,810 - Detection -   best_eval_score = 82.85
2023-04-23 03:12:52,810 - Detection -   eval_score = 82.72
2023-04-23 03:12:52,810 - Detection -   train_loss = 0.6898920641225927
2023-04-23 03:13:06,010 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 03:13:06,010 - Detection -   best_eval_score = 82.85
2023-04-23 03:13:06,010 - Detection -   eval_score = 82.15
2023-04-23 03:13:06,010 - Detection -   train_loss = 0.6544595746433034
2023-04-23 03:13:19,023 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 03:13:19,023 - Detection -   best_eval_score = 82.85
2023-04-23 03:13:19,023 - Detection -   eval_score = 82.04
2023-04-23 03:13:19,023 - Detection -   train_loss = 0.63392073617262
2023-04-23 03:13:32,218 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 03:13:32,218 - Detection -   best_eval_score = 82.85
2023-04-23 03:13:32,218 - Detection -   eval_score = 81.81
2023-04-23 03:13:32,218 - Detection -   train_loss = 0.6016033011324265
2023-04-23 03:13:32,218 - Detection - Pre-training finished...
2023-04-23 03:13:32,219 - Detection - Training Begin...
2023-04-23 03:13:34,275 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 03:13:34,275 - Detection -   best_eval_score = 0
2023-04-23 03:13:34,275 - Detection -   eval_score = 1.08
2023-04-23 03:13:34,275 - Detection -   train_loss = 4.287965522092931
2023-04-23 03:13:45,976 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 03:13:45,976 - Detection -   best_eval_score = 1.08
2023-04-23 03:13:45,976 - Detection -   eval_score = 67.72
2023-04-23 03:13:45,976 - Detection -   train_loss = 3.7548668805290673
2023-04-23 03:13:57,810 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 03:13:57,810 - Detection -   best_eval_score = 67.72
2023-04-23 03:13:57,810 - Detection -   eval_score = 77.51
2023-04-23 03:13:57,810 - Detection -   train_loss = 0.9676253445008222
2023-04-23 03:14:09,564 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 03:14:09,564 - Detection -   best_eval_score = 77.51
2023-04-23 03:14:09,564 - Detection -   eval_score = 77.48
2023-04-23 03:14:09,564 - Detection -   train_loss = 0.9599200276767507
2023-04-23 03:14:21,256 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 03:14:21,256 - Detection -   best_eval_score = 77.51
2023-04-23 03:14:21,256 - Detection -   eval_score = 77.19
2023-04-23 03:14:21,256 - Detection -   train_loss = 0.9409366320161259
2023-04-23 03:14:33,053 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 03:14:33,054 - Detection -   best_eval_score = 77.51
2023-04-23 03:14:33,054 - Detection -   eval_score = 77.53
2023-04-23 03:14:33,054 - Detection -   train_loss = 0.9512971289017621
2023-04-23 03:14:44,696 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 03:14:44,696 - Detection -   best_eval_score = 77.53
2023-04-23 03:14:44,696 - Detection -   eval_score = 77.58
2023-04-23 03:14:44,696 - Detection -   train_loss = 0.9583540839307448
2023-04-23 03:14:56,560 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 03:14:56,561 - Detection -   best_eval_score = 77.58
2023-04-23 03:14:56,561 - Detection -   eval_score = 77.22
2023-04-23 03:14:56,561 - Detection -   train_loss = 0.9342860474305994
2023-04-23 03:15:08,221 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 03:15:08,222 - Detection -   best_eval_score = 77.58
2023-04-23 03:15:08,222 - Detection -   eval_score = 77.37
2023-04-23 03:15:08,222 - Detection -   train_loss = 0.9388336188652936
2023-04-23 03:15:19,968 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 03:15:19,968 - Detection -   best_eval_score = 77.58
2023-04-23 03:15:19,968 - Detection -   eval_score = 77.42
2023-04-23 03:15:19,968 - Detection -   train_loss = 0.9607700565282036
2023-04-23 03:15:31,578 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 03:15:31,578 - Detection -   best_eval_score = 77.58
2023-04-23 03:15:31,578 - Detection -   eval_score = 77.65
2023-04-23 03:15:31,578 - Detection -   train_loss = 0.958679241292617
2023-04-23 03:15:43,366 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 03:15:43,366 - Detection -   best_eval_score = 77.65
2023-04-23 03:15:43,366 - Detection -   eval_score = 77.24
2023-04-23 03:15:43,366 - Detection -   train_loss = 0.9409137753879323
2023-04-23 03:15:54,967 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 03:15:54,967 - Detection -   best_eval_score = 77.65
2023-04-23 03:15:54,967 - Detection -   eval_score = 77.5
2023-04-23 03:15:54,967 - Detection -   train_loss = 0.9490287128616782
2023-04-23 03:16:06,699 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 03:16:06,699 - Detection -   best_eval_score = 77.65
2023-04-23 03:16:06,699 - Detection -   eval_score = 77.32
2023-04-23 03:16:06,699 - Detection -   train_loss = 0.9372757778448217
2023-04-23 03:16:18,446 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 03:16:18,446 - Detection -   best_eval_score = 77.65
2023-04-23 03:16:18,446 - Detection -   eval_score = 77.38
2023-04-23 03:16:18,446 - Detection -   train_loss = 0.940513502149021
2023-04-23 03:16:30,066 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 03:16:30,066 - Detection -   best_eval_score = 77.65
2023-04-23 03:16:30,066 - Detection -   eval_score = 77.89
2023-04-23 03:16:30,066 - Detection -   train_loss = 0.9516344806727242
2023-04-23 03:16:41,868 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 03:16:41,868 - Detection -   best_eval_score = 77.89
2023-04-23 03:16:41,868 - Detection -   eval_score = 77.41
2023-04-23 03:16:41,868 - Detection -   train_loss = 0.9530497543952045
2023-04-23 03:16:53,511 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 03:16:53,511 - Detection -   best_eval_score = 77.89
2023-04-23 03:16:53,511 - Detection -   eval_score = 77.62
2023-04-23 03:16:53,511 - Detection -   train_loss = 0.9473235116285437
2023-04-23 03:17:05,330 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 03:17:05,330 - Detection -   best_eval_score = 77.89
2023-04-23 03:17:05,330 - Detection -   eval_score = 77.73
2023-04-23 03:17:05,330 - Detection -   train_loss = 0.9446220257702995
2023-04-23 03:17:17,075 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 03:17:17,075 - Detection -   best_eval_score = 77.89
2023-04-23 03:17:17,075 - Detection -   eval_score = 77.41
2023-04-23 03:17:17,075 - Detection -   train_loss = 0.9513215492753422
2023-04-23 03:17:28,773 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 03:17:28,773 - Detection -   best_eval_score = 77.89
2023-04-23 03:17:28,773 - Detection -   eval_score = 76.8
2023-04-23 03:17:28,773 - Detection -   train_loss = 0.9119536876678467
2023-04-23 03:17:40,520 - Detection - ***** Epoch: 22: Eval results *****
2023-04-23 03:17:40,520 - Detection -   best_eval_score = 77.89
2023-04-23 03:17:40,521 - Detection -   eval_score = 77.54
2023-04-23 03:17:40,521 - Detection -   train_loss = 0.9269777045530432
2023-04-23 03:17:52,143 - Detection - ***** Epoch: 23: Eval results *****
2023-04-23 03:17:52,144 - Detection -   best_eval_score = 77.89
2023-04-23 03:17:52,144 - Detection -   eval_score = 77.72
2023-04-23 03:17:52,144 - Detection -   train_loss = 0.9289846315103418
2023-04-23 03:18:03,899 - Detection - ***** Epoch: 24: Eval results *****
2023-04-23 03:18:03,899 - Detection -   best_eval_score = 77.89
2023-04-23 03:18:03,899 - Detection -   eval_score = 77.83
2023-04-23 03:18:03,899 - Detection -   train_loss = 0.944886302246767
2023-04-23 03:18:15,503 - Detection - ***** Epoch: 25: Eval results *****
2023-04-23 03:18:15,503 - Detection -   best_eval_score = 77.89
2023-04-23 03:18:15,503 - Detection -   eval_score = 77.85
2023-04-23 03:18:15,503 - Detection -   train_loss = 0.9372651892549851
2023-04-23 03:18:27,210 - Detection - ***** Epoch: 26: Eval results *****
2023-04-23 03:18:27,210 - Detection -   best_eval_score = 77.89
2023-04-23 03:18:27,210 - Detection -   eval_score = 77.1
2023-04-23 03:18:27,210 - Detection -   train_loss = 0.9417527878985685
2023-04-23 03:18:27,210 - Detection - Training Finished...
2023-04-23 03:18:27,210 - Detection - Testing begin...
2023-04-23 03:18:28,958 - Detection - ***** Test: Confusion Matrix *****
2023-04-23 03:18:28,958 - Detection - [[ 84   3   3   0   0   1   2   0   0   1   2   0   0   0   0  32]
 [  0 100   4   1   0   0   1   0   0   1   0   0   0   0   0  20]
 [  0   0  76   1   0   0   2   1   0   0   0   0   1   0   0  41]
 [  0   0   0 128   4   0   1   1   0   0   0   1   0   0   0  36]
 [  0   1   2   2  41   0  13   1   0   0   0   3   0   0   0  43]
 [  0   0   0   2   0 102   0   0   0   2   0   1   0   0   0  21]
 [  0   1   1   0   0   1 118   0   2   1   0   0   0   0   0  69]
 [  0   0  10   0   0   0   5  94   0   0   0   1   0   0   0  29]
 [  0   0   2   0   0   1   3   1 153   1   0   0   0   0   0  11]
 [  0   0   1   0   0   1   0   0   0 109   0   1   0   1   0  57]
 [  1   0   1   0   0   0   1   0   0   2 111   0   0   0   0  35]
 [  0   0   2   1   0   0   2   0   0   1   0 125   0   2   0  27]
 [  0   0  10   0   0   0   0   0   0   0   0   0  90   0   0  24]
 [  0   0   0   1   0   2   0   0   0   1   0   1   0 113   0  19]
 [  0   2   5   0   0   0   0   0   0   0   0   0   1   0 105  18]
 [  1   2 113   7   9   7 132  38   5   8   1   9   9   0   1 404]]
2023-04-23 03:18:28,958 - Detection - ***** Test results *****
2023-04-23 03:18:28,958 - Detection -   Acc = 67.23
2023-04-23 03:18:28,958 - Detection -   F1 = 73.8118
2023-04-23 03:18:28,958 - Detection -   F1-known = 75.432
2023-04-23 03:18:28,958 - Detection -   F1-open = 49.5098
2023-04-23 03:18:28,958 - Detection - Testing finished...
2023-04-23 03:18:28,958 - Detection - Results saved in results/results_DA-ADB-BOOST-F-4.csv
2023-04-23 03:18:28,977 - Detection - Open Intent Detection Finished...
