2023-04-23 00:27:54,494 - Detection - Open Intent Detection Begin...
2023-04-23 00:27:54,494 - Detection - Parameters Initialization...
2023-04-23 00:27:54,495 - Detection - ============================== Params ==============================
2023-04-23 00:27:54,495 - Detection - type:	open_intent_detection
2023-04-23 00:27:54,495 - Detection - logger_name:	Detection
2023-04-23 00:27:54,495 - Detection - log_dir:	logs
2023-04-23 00:27:54,495 - Detection - dataset:	stackoverflow_cg
2023-04-23 00:27:54,495 - Detection - known_cls_ratio:	0.5
2023-04-23 00:27:54,495 - Detection - labeled_ratio:	1.0
2023-04-23 00:27:54,495 - Detection - method:	DA-ADB
2023-04-23 00:27:54,495 - Detection - train:	True
2023-04-23 00:27:54,495 - Detection - pretrain:	True
2023-04-23 00:27:54,495 - Detection - save_model:	False
2023-04-23 00:27:54,495 - Detection - backbone:	bert_disaware_boost
2023-04-23 00:27:54,495 - Detection - config_file_name:	DA-ADB
2023-04-23 00:27:54,495 - Detection - seed:	2
2023-04-23 00:27:54,495 - Detection - gpu_id:	0
2023-04-23 00:27:54,495 - Detection - pipe_results_path:	pipe_results
2023-04-23 00:27:54,495 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-23 00:27:54,495 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-23 00:27:54,495 - Detection - model_dir:	models
2023-04-23 00:27:54,495 - Detection - load_pretrained_method:	None
2023-04-23 00:27:54,495 - Detection - result_dir:	results
2023-04-23 00:27:54,495 - Detection - results_file_name:	results_DA-ADB-BOOST-F-4.csv
2023-04-23 00:27:54,495 - Detection - save_results:	True
2023-04-23 00:27:54,495 - Detection - loss_fct:	CrossEntropyLoss
2023-04-23 00:27:54,495 - Detection - boost_method:	F-4
2023-04-23 00:27:54,495 - Detection - boost_start_score:	0.0
2023-04-23 00:27:54,495 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.5_1.0_bert_disaware_boost_2
2023-04-23 00:27:54,495 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.5_1.0_bert_disaware_boost_2/models
2023-04-23 00:27:54,495 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-23 00:27:54,495 - Detection - num_train_epochs:	100
2023-04-23 00:27:54,495 - Detection - num_labels:	None
2023-04-23 00:27:54,495 - Detection - max_seq_length:	None
2023-04-23 00:27:54,495 - Detection - freeze_backbone_parameters:	True
2023-04-23 00:27:54,495 - Detection - feat_dim:	768
2023-04-23 00:27:54,495 - Detection - warmup_proportion:	0.1
2023-04-23 00:27:54,495 - Detection - scale:	4
2023-04-23 00:27:54,495 - Detection - lr_boundary:	0.05
2023-04-23 00:27:54,495 - Detection - lr:	2e-05
2023-04-23 00:27:54,495 - Detection - activation:	relu
2023-04-23 00:27:54,495 - Detection - train_batch_size:	128
2023-04-23 00:27:54,495 - Detection - eval_batch_size:	64
2023-04-23 00:27:54,495 - Detection - test_batch_size:	64
2023-04-23 00:27:54,495 - Detection - wait_patient:	10
2023-04-23 00:27:54,495 - Detection - ============================== End Params ==============================
2023-04-23 00:27:54,495 - Detection - Data and Model Preparation...
2023-04-23 00:27:54,496 - Detection - The number of known intents is 10
2023-04-23 00:27:54,496 - Detection - Lists of known labels are: ['osx', 'drupal', 'visual-studio', 'ajax', 'magento', 'excel', 'cocoa', 'matlab', 'apache', 'svn']
2023-04-23 00:27:54,504 - Detection - Number of labeled training samples = 1471
2023-04-23 00:27:54,504 - Detection - Number of unlabeled training samples = 1320
2023-04-23 00:27:54,507 - Detection - Number of evaluation samples = 707
2023-04-23 00:27:54,512 - Detection - Number of testing samples = 2905
2023-04-23 00:28:00,006 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-23 00:28:00,119 - Detection - Pre-training Begin...
2023-04-23 00:28:03,166 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 00:28:03,166 - Detection -   best_eval_score = 0
2023-04-23 00:28:03,166 - Detection -   eval_score = 3.03
2023-04-23 00:28:03,166 - Detection -   train_loss = 2.3172274033228555
2023-04-23 00:28:12,517 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 00:28:12,517 - Detection -   best_eval_score = 3.03
2023-04-23 00:28:12,518 - Detection -   eval_score = 1.71
2023-04-23 00:28:12,518 - Detection -   train_loss = 2.286662459373474
2023-04-23 00:28:21,774 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 00:28:21,774 - Detection -   best_eval_score = 3.03
2023-04-23 00:28:21,774 - Detection -   eval_score = 6.33
2023-04-23 00:28:21,774 - Detection -   train_loss = 2.2402817408243814
2023-04-23 00:28:31,140 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 00:28:31,140 - Detection -   best_eval_score = 6.33
2023-04-23 00:28:31,140 - Detection -   eval_score = 25.06
2023-04-23 00:28:31,140 - Detection -   train_loss = 2.1472882827123008
2023-04-23 00:28:40,415 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 00:28:40,415 - Detection -   best_eval_score = 25.06
2023-04-23 00:28:40,415 - Detection -   eval_score = 70.59
2023-04-23 00:28:40,415 - Detection -   train_loss = 1.9058004021644592
2023-04-23 00:28:49,649 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 00:28:49,649 - Detection -   best_eval_score = 70.59
2023-04-23 00:28:49,649 - Detection -   eval_score = 77.25
2023-04-23 00:28:49,649 - Detection -   train_loss = 1.4417685866355896
2023-04-23 00:28:58,987 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 00:28:58,987 - Detection -   best_eval_score = 77.25
2023-04-23 00:28:58,987 - Detection -   eval_score = 78.86
2023-04-23 00:28:58,987 - Detection -   train_loss = 1.135287304719289
2023-04-23 00:29:08,292 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 00:29:08,292 - Detection -   best_eval_score = 78.86
2023-04-23 00:29:08,292 - Detection -   eval_score = 80.23
2023-04-23 00:29:08,292 - Detection -   train_loss = 0.9852757056554159
2023-04-23 00:29:17,717 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 00:29:17,717 - Detection -   best_eval_score = 80.23
2023-04-23 00:29:17,717 - Detection -   eval_score = 81.69
2023-04-23 00:29:17,717 - Detection -   train_loss = 0.9028998414675394
2023-04-23 00:29:27,014 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 00:29:27,014 - Detection -   best_eval_score = 81.69
2023-04-23 00:29:27,014 - Detection -   eval_score = 81.21
2023-04-23 00:29:27,014 - Detection -   train_loss = 0.8185661087433497
2023-04-23 00:29:36,395 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 00:29:36,395 - Detection -   best_eval_score = 81.69
2023-04-23 00:29:36,395 - Detection -   eval_score = 80.86
2023-04-23 00:29:36,395 - Detection -   train_loss = 0.7450256645679474
2023-04-23 00:29:45,657 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 00:29:45,657 - Detection -   best_eval_score = 81.69
2023-04-23 00:29:45,657 - Detection -   eval_score = 78.96
2023-04-23 00:29:45,657 - Detection -   train_loss = 0.7004956404368082
2023-04-23 00:29:55,076 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 00:29:55,076 - Detection -   best_eval_score = 81.69
2023-04-23 00:29:55,076 - Detection -   eval_score = 81.42
2023-04-23 00:29:55,076 - Detection -   train_loss = 0.6620269666115443
2023-04-23 00:30:04,338 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 00:30:04,338 - Detection -   best_eval_score = 81.69
2023-04-23 00:30:04,338 - Detection -   eval_score = 81.22
2023-04-23 00:30:04,339 - Detection -   train_loss = 0.6029635320107142
2023-04-23 00:30:13,606 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 00:30:13,606 - Detection -   best_eval_score = 81.69
2023-04-23 00:30:13,606 - Detection -   eval_score = 82.77
2023-04-23 00:30:13,606 - Detection -   train_loss = 0.5601027011871338
2023-04-23 00:30:22,971 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 00:30:22,971 - Detection -   best_eval_score = 82.77
2023-04-23 00:30:22,971 - Detection -   eval_score = 81.46
2023-04-23 00:30:22,971 - Detection -   train_loss = 0.512616274257501
2023-04-23 00:30:32,308 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 00:30:32,308 - Detection -   best_eval_score = 82.77
2023-04-23 00:30:32,308 - Detection -   eval_score = 81.34
2023-04-23 00:30:32,308 - Detection -   train_loss = 0.4997025604049365
2023-04-23 00:30:41,718 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 00:30:41,718 - Detection -   best_eval_score = 82.77
2023-04-23 00:30:41,718 - Detection -   eval_score = 81.36
2023-04-23 00:30:41,718 - Detection -   train_loss = 0.46900902688503265
2023-04-23 00:30:50,979 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 00:30:50,979 - Detection -   best_eval_score = 82.77
2023-04-23 00:30:50,979 - Detection -   eval_score = 80.66
2023-04-23 00:30:50,980 - Detection -   train_loss = 0.44040530920028687
2023-04-23 00:31:00,287 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 00:31:00,287 - Detection -   best_eval_score = 82.77
2023-04-23 00:31:00,287 - Detection -   eval_score = 80.97
2023-04-23 00:31:00,287 - Detection -   train_loss = 0.4227624163031578
2023-04-23 00:31:09,667 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 00:31:09,667 - Detection -   best_eval_score = 82.77
2023-04-23 00:31:09,667 - Detection -   eval_score = 79.78
2023-04-23 00:31:09,667 - Detection -   train_loss = 0.41747868557771045
2023-04-23 00:31:18,915 - Detection - ***** Epoch: 22: Eval results *****
2023-04-23 00:31:18,915 - Detection -   best_eval_score = 82.77
2023-04-23 00:31:18,915 - Detection -   eval_score = 80.8
2023-04-23 00:31:18,915 - Detection -   train_loss = 0.39353596915801364
2023-04-23 00:31:28,219 - Detection - ***** Epoch: 23: Eval results *****
2023-04-23 00:31:28,220 - Detection -   best_eval_score = 82.77
2023-04-23 00:31:28,220 - Detection -   eval_score = 82.09
2023-04-23 00:31:28,220 - Detection -   train_loss = 0.3725104133288066
2023-04-23 00:31:37,559 - Detection - ***** Epoch: 24: Eval results *****
2023-04-23 00:31:37,559 - Detection -   best_eval_score = 82.77
2023-04-23 00:31:37,559 - Detection -   eval_score = 82.03
2023-04-23 00:31:37,559 - Detection -   train_loss = 0.36057350039482117
2023-04-23 00:31:46,886 - Detection - ***** Epoch: 25: Eval results *****
2023-04-23 00:31:46,887 - Detection -   best_eval_score = 82.77
2023-04-23 00:31:46,887 - Detection -   eval_score = 82.77
2023-04-23 00:31:46,887 - Detection -   train_loss = 0.3399771948655446
2023-04-23 00:31:46,887 - Detection - Pre-training finished...
2023-04-23 00:31:46,887 - Detection - Training Begin...
2023-04-23 00:31:48,315 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 00:31:48,316 - Detection -   best_eval_score = 0
2023-04-23 00:31:48,316 - Detection -   eval_score = 0.0
2023-04-23 00:31:48,316 - Detection -   train_loss = 4.736364285151164
2023-04-23 00:31:49,744 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 00:31:49,745 - Detection -   best_eval_score = 0
2023-04-23 00:31:49,745 - Detection -   eval_score = 1.65
2023-04-23 00:31:49,745 - Detection -   train_loss = 4.411592562993367
2023-04-23 00:31:58,177 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 00:31:58,177 - Detection -   best_eval_score = 1.65
2023-04-23 00:31:58,177 - Detection -   eval_score = 50.36
2023-04-23 00:31:58,177 - Detection -   train_loss = 3.949596345424652
2023-04-23 00:32:06,510 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 00:32:06,510 - Detection -   best_eval_score = 50.36
2023-04-23 00:32:06,510 - Detection -   eval_score = 72.06
2023-04-23 00:32:06,510 - Detection -   train_loss = 1.3208324015140533
2023-04-23 00:32:14,968 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 00:32:14,969 - Detection -   best_eval_score = 72.06
2023-04-23 00:32:14,969 - Detection -   eval_score = 71.36
2023-04-23 00:32:14,969 - Detection -   train_loss = 1.025055542588234
2023-04-23 00:32:23,248 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 00:32:23,248 - Detection -   best_eval_score = 72.06
2023-04-23 00:32:23,248 - Detection -   eval_score = 71.72
2023-04-23 00:32:23,248 - Detection -   train_loss = 1.0440874348084133
2023-04-23 00:32:31,648 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 00:32:31,648 - Detection -   best_eval_score = 72.06
2023-04-23 00:32:31,648 - Detection -   eval_score = 70.75
2023-04-23 00:32:31,648 - Detection -   train_loss = 1.0163194984197617
2023-04-23 00:32:40,093 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 00:32:40,093 - Detection -   best_eval_score = 72.06
2023-04-23 00:32:40,093 - Detection -   eval_score = 70.88
2023-04-23 00:32:40,093 - Detection -   train_loss = 1.0213049252827961
2023-04-23 00:32:48,412 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 00:32:48,413 - Detection -   best_eval_score = 72.06
2023-04-23 00:32:48,413 - Detection -   eval_score = 71.83
2023-04-23 00:32:48,413 - Detection -   train_loss = 1.0258879711230595
2023-04-23 00:32:56,856 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 00:32:56,856 - Detection -   best_eval_score = 72.06
2023-04-23 00:32:56,856 - Detection -   eval_score = 70.75
2023-04-23 00:32:56,856 - Detection -   train_loss = 1.0205852289994557
2023-04-23 00:33:05,143 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 00:33:05,143 - Detection -   best_eval_score = 72.06
2023-04-23 00:33:05,143 - Detection -   eval_score = 71.57
2023-04-23 00:33:05,144 - Detection -   train_loss = 1.0220233450333278
2023-04-23 00:33:13,547 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 00:33:13,547 - Detection -   best_eval_score = 72.06
2023-04-23 00:33:13,547 - Detection -   eval_score = 71.64
2023-04-23 00:33:13,547 - Detection -   train_loss = 1.0043148845434189
2023-04-23 00:33:21,930 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 00:33:21,930 - Detection -   best_eval_score = 72.06
2023-04-23 00:33:21,930 - Detection -   eval_score = 71.76
2023-04-23 00:33:21,930 - Detection -   train_loss = 1.039179841677348
2023-04-23 00:33:30,242 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 00:33:30,242 - Detection -   best_eval_score = 72.06
2023-04-23 00:33:30,242 - Detection -   eval_score = 71.76
2023-04-23 00:33:30,242 - Detection -   train_loss = 1.0379119515419006
2023-04-23 00:33:30,242 - Detection - Training Finished...
2023-04-23 00:33:30,242 - Detection - Testing begin...
2023-04-23 00:33:31,993 - Detection - ***** Test: Confusion Matrix *****
2023-04-23 00:33:31,993 - Detection - [[ 106    0    1    1    0    1   20    0    2    1   61]
 [   0  101    0    1    0    0    0    0    3    0   23]
 [   2    0   45    1    0    1    2    0    0    1   54]
 [   1    0    0   84    0    0    0    0    4    0   71]
 [   0    0    0    0  106    0    1    0    2    0   23]
 [   0    1    0    2    0   91    2    0    1    0   43]
 [  19    1    0    0    0    0   92    0    3    0   46]
 [   1    0    0    1    0    0    2  135    0    0   25]
 [   1    1    0    0    0    0    1    0   94    2   71]
 [   0    0    2    0    0    0    0    0    2  111   34]
 [  77    2    9   20    0   10   47    7   30    0 1200]]
2023-04-23 00:33:31,993 - Detection - ***** Test results *****
2023-04-23 00:33:31,993 - Detection -   Acc = 74.53
2023-04-23 00:33:31,993 - Detection -   F1 = 71.6563
2023-04-23 00:33:31,993 - Detection -   F1-known = 70.9608
2023-04-23 00:33:31,993 - Detection -   F1-open = 78.6112
2023-04-23 00:33:31,993 - Detection - Testing finished...
2023-04-23 00:33:31,993 - Detection - Results saved in results/results_DA-ADB-BOOST-F-4.csv
2023-04-23 00:33:32,012 - Detection - Open Intent Detection Finished...
