2023-04-04 22:06:27,315 - Detection - Open Intent Detection Begin...
2023-04-04 22:06:27,315 - Detection - Parameters Initialization...
2023-04-04 22:06:27,315 - Detection - ============================== Params ==============================
2023-04-04 22:06:27,315 - Detection - type:	open_intent_detection
2023-04-04 22:06:27,315 - Detection - logger_name:	Detection
2023-04-04 22:06:27,315 - Detection - log_dir:	logs
2023-04-04 22:06:27,315 - Detection - dataset:	banking
2023-04-04 22:06:27,315 - Detection - known_cls_ratio:	0.25
2023-04-04 22:06:27,315 - Detection - labeled_ratio:	1.0
2023-04-04 22:06:27,315 - Detection - method:	DA-ADB
2023-04-04 22:06:27,315 - Detection - train:	True
2023-04-04 22:06:27,315 - Detection - pretrain:	True
2023-04-04 22:06:27,315 - Detection - save_model:	True
2023-04-04 22:06:27,315 - Detection - backbone:	bert_disaware
2023-04-04 22:06:27,315 - Detection - config_file_name:	DA-ADB
2023-04-04 22:06:27,315 - Detection - seed:	2
2023-04-04 22:06:27,316 - Detection - gpu_id:	0
2023-04-04 22:06:27,316 - Detection - pipe_results_path:	pipe_results
2023-04-04 22:06:27,316 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-04 22:06:27,316 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-04 22:06:27,316 - Detection - model_dir:	models
2023-04-04 22:06:27,316 - Detection - load_pretrained_method:	None
2023-04-04 22:06:27,316 - Detection - result_dir:	results
2023-04-04 22:06:27,316 - Detection - results_file_name:	results_DA-ADB.csv
2023-04-04 22:06:27,316 - Detection - save_results:	True
2023-04-04 22:06:27,316 - Detection - loss_fct:	CrossEntropyLoss
2023-04-04 22:06:27,316 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_0.25_1.0_bert_disaware_2
2023-04-04 22:06:27,316 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_0.25_1.0_bert_disaware_2/models
2023-04-04 22:06:27,316 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-04 22:06:27,316 - Detection - num_train_epochs:	100
2023-04-04 22:06:27,316 - Detection - num_labels:	None
2023-04-04 22:06:27,316 - Detection - max_seq_length:	None
2023-04-04 22:06:27,316 - Detection - freeze_backbone_parameters:	True
2023-04-04 22:06:27,316 - Detection - feat_dim:	768
2023-04-04 22:06:27,316 - Detection - warmup_proportion:	0.1
2023-04-04 22:06:27,316 - Detection - scale:	4
2023-04-04 22:06:27,316 - Detection - lr_boundary:	0.05
2023-04-04 22:06:27,316 - Detection - lr:	2e-05
2023-04-04 22:06:27,316 - Detection - activation:	relu
2023-04-04 22:06:27,316 - Detection - train_batch_size:	128
2023-04-04 22:06:27,316 - Detection - eval_batch_size:	64
2023-04-04 22:06:27,316 - Detection - test_batch_size:	64
2023-04-04 22:06:27,316 - Detection - wait_patient:	10
2023-04-04 22:06:27,316 - Detection - ============================== End Params ==============================
2023-04-04 22:06:27,316 - Detection - Data and Model Preparation...
2023-04-04 22:06:27,317 - Detection - The number of known intents is 19
2023-04-04 22:06:27,317 - Detection - Lists of known labels are: ['direct_debit_payment_not_recognised', 'declined_cash_withdrawal', 'supported_cards_and_currencies', 'pin_blocked', 'verify_top_up', 'compromised_card', 'wrong_exchange_rate_for_cash_withdrawal', 'activate_my_card', 'verify_source_of_funds', 'reverted_card_payment?', 'request_refund', 'transfer_into_account', 'card_delivery_estimate', 'failed_transfer', 'top_up_by_card_charge', 'unable_to_verify_identity', 'disposable_card_limits', 'top_up_by_cash_or_cheque', 'cash_withdrawal_not_recognised']
2023-04-04 22:06:27,343 - Detection - Number of labeled training samples = 2296
2023-04-04 22:06:27,343 - Detection - Number of unlabeled training samples = 6707
2023-04-04 22:06:27,345 - Detection - Number of evaluation samples = 253
2023-04-04 22:06:27,352 - Detection - Number of testing samples = 3080
2023-04-04 22:06:36,158 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-04 22:06:36,239 - Detection - Pre-training Begin...
2023-04-04 22:06:41,934 - Detection - ***** Epoch: 1: Eval results *****
2023-04-04 22:06:41,935 - Detection -   best_eval_score = 0
2023-04-04 22:06:41,935 - Detection -   eval_score = 2.55
2023-04-04 22:06:41,935 - Detection -   train_loss = 2.9410971800486245
2023-04-04 22:06:47,029 - Detection - ***** Epoch: 2: Eval results *****
2023-04-04 22:06:47,029 - Detection -   best_eval_score = 2.55
2023-04-04 22:06:47,029 - Detection -   eval_score = 1.14
2023-04-04 22:06:47,029 - Detection -   train_loss = 2.923558857705858
2023-04-04 22:06:52,121 - Detection - ***** Epoch: 3: Eval results *****
2023-04-04 22:06:52,121 - Detection -   best_eval_score = 2.55
2023-04-04 22:06:52,121 - Detection -   eval_score = 5.64
2023-04-04 22:06:52,121 - Detection -   train_loss = 2.9019941223992243
2023-04-04 22:06:57,238 - Detection - ***** Epoch: 4: Eval results *****
2023-04-04 22:06:57,238 - Detection -   best_eval_score = 5.64
2023-04-04 22:06:57,239 - Detection -   eval_score = 6.72
2023-04-04 22:06:57,239 - Detection -   train_loss = 2.877018597390917
2023-04-04 22:07:02,360 - Detection - ***** Epoch: 5: Eval results *****
2023-04-04 22:07:02,360 - Detection -   best_eval_score = 6.72
2023-04-04 22:07:02,360 - Detection -   eval_score = 16.06
2023-04-04 22:07:02,360 - Detection -   train_loss = 2.8332742320166693
2023-04-04 22:07:07,491 - Detection - ***** Epoch: 6: Eval results *****
2023-04-04 22:07:07,491 - Detection -   best_eval_score = 16.06
2023-04-04 22:07:07,491 - Detection -   eval_score = 41.03
2023-04-04 22:07:07,491 - Detection -   train_loss = 2.735110388861762
2023-04-04 22:07:12,628 - Detection - ***** Epoch: 7: Eval results *****
2023-04-04 22:07:12,628 - Detection -   best_eval_score = 41.03
2023-04-04 22:07:12,628 - Detection -   eval_score = 68.1
2023-04-04 22:07:12,628 - Detection -   train_loss = 2.535108380847507
2023-04-04 22:07:17,786 - Detection - ***** Epoch: 8: Eval results *****
2023-04-04 22:07:17,786 - Detection -   best_eval_score = 68.1
2023-04-04 22:07:17,786 - Detection -   eval_score = 81.43
2023-04-04 22:07:17,786 - Detection -   train_loss = 2.2054473095470004
2023-04-04 22:07:22,942 - Detection - ***** Epoch: 9: Eval results *****
2023-04-04 22:07:22,942 - Detection -   best_eval_score = 81.43
2023-04-04 22:07:22,943 - Detection -   eval_score = 91.26
2023-04-04 22:07:22,944 - Detection -   train_loss = 1.8370877703030903
2023-04-04 22:07:28,107 - Detection - ***** Epoch: 10: Eval results *****
2023-04-04 22:07:28,107 - Detection -   best_eval_score = 91.26
2023-04-04 22:07:28,107 - Detection -   eval_score = 91.67
2023-04-04 22:07:28,107 - Detection -   train_loss = 1.5468349787924025
2023-04-04 22:07:33,273 - Detection - ***** Epoch: 11: Eval results *****
2023-04-04 22:07:33,273 - Detection -   best_eval_score = 91.67
2023-04-04 22:07:33,273 - Detection -   eval_score = 93.28
2023-04-04 22:07:33,273 - Detection -   train_loss = 1.3446164793438382
2023-04-04 22:07:38,444 - Detection - ***** Epoch: 12: Eval results *****
2023-04-04 22:07:38,444 - Detection -   best_eval_score = 93.28
2023-04-04 22:07:38,444 - Detection -   eval_score = 93.38
2023-04-04 22:07:38,444 - Detection -   train_loss = 1.2110612127516005
2023-04-04 22:07:43,618 - Detection - ***** Epoch: 13: Eval results *****
2023-04-04 22:07:43,618 - Detection -   best_eval_score = 93.38
2023-04-04 22:07:43,618 - Detection -   eval_score = 94.0
2023-04-04 22:07:43,618 - Detection -   train_loss = 1.1202810539139643
2023-04-04 22:07:48,795 - Detection - ***** Epoch: 14: Eval results *****
2023-04-04 22:07:48,795 - Detection -   best_eval_score = 94.0
2023-04-04 22:07:48,795 - Detection -   eval_score = 95.25
2023-04-04 22:07:48,795 - Detection -   train_loss = 1.0411373443073697
2023-04-04 22:07:53,974 - Detection - ***** Epoch: 15: Eval results *****
2023-04-04 22:07:53,974 - Detection -   best_eval_score = 95.25
2023-04-04 22:07:53,974 - Detection -   eval_score = 95.25
2023-04-04 22:07:53,974 - Detection -   train_loss = 0.9895214802689023
2023-04-04 22:07:59,152 - Detection - ***** Epoch: 16: Eval results *****
2023-04-04 22:07:59,152 - Detection -   best_eval_score = 95.25
2023-04-04 22:07:59,152 - Detection -   eval_score = 95.67
2023-04-04 22:07:59,152 - Detection -   train_loss = 0.9389446874459585
2023-04-04 22:08:04,339 - Detection - ***** Epoch: 17: Eval results *****
2023-04-04 22:08:04,339 - Detection -   best_eval_score = 95.67
2023-04-04 22:08:04,339 - Detection -   eval_score = 96.0
2023-04-04 22:08:04,339 - Detection -   train_loss = 0.9007866415712569
2023-04-04 22:08:09,534 - Detection - ***** Epoch: 18: Eval results *****
2023-04-04 22:08:09,534 - Detection -   best_eval_score = 96.0
2023-04-04 22:08:09,534 - Detection -   eval_score = 95.67
2023-04-04 22:08:09,534 - Detection -   train_loss = 0.8712505367067125
2023-04-04 22:08:14,803 - Detection - ***** Epoch: 19: Eval results *****
2023-04-04 22:08:14,803 - Detection -   best_eval_score = 96.0
2023-04-04 22:08:14,803 - Detection -   eval_score = 95.99
2023-04-04 22:08:14,803 - Detection -   train_loss = 0.8440142439471351
2023-04-04 22:08:19,973 - Detection - ***** Epoch: 20: Eval results *****
2023-04-04 22:08:19,973 - Detection -   best_eval_score = 96.0
2023-04-04 22:08:19,973 - Detection -   eval_score = 95.99
2023-04-04 22:08:19,973 - Detection -   train_loss = 0.8182728423012627
2023-04-04 22:08:25,140 - Detection - ***** Epoch: 21: Eval results *****
2023-04-04 22:08:25,141 - Detection -   best_eval_score = 96.0
2023-04-04 22:08:25,141 - Detection -   eval_score = 96.43
2023-04-04 22:08:25,141 - Detection -   train_loss = 0.794596897231208
2023-04-04 22:08:30,317 - Detection - ***** Epoch: 22: Eval results *****
2023-04-04 22:08:30,318 - Detection -   best_eval_score = 96.43
2023-04-04 22:08:30,318 - Detection -   eval_score = 96.54
2023-04-04 22:08:30,318 - Detection -   train_loss = 0.7740832136736976
2023-04-04 22:08:35,496 - Detection - ***** Epoch: 23: Eval results *****
2023-04-04 22:08:35,496 - Detection -   best_eval_score = 96.54
2023-04-04 22:08:35,496 - Detection -   eval_score = 96.43
2023-04-04 22:08:35,496 - Detection -   train_loss = 0.7512752778000302
2023-04-04 22:08:40,662 - Detection - ***** Epoch: 24: Eval results *****
2023-04-04 22:08:40,662 - Detection -   best_eval_score = 96.54
2023-04-04 22:08:40,662 - Detection -   eval_score = 96.43
2023-04-04 22:08:40,662 - Detection -   train_loss = 0.7367764446470473
2023-04-04 22:08:45,823 - Detection - ***** Epoch: 25: Eval results *****
2023-04-04 22:08:45,823 - Detection -   best_eval_score = 96.54
2023-04-04 22:08:45,823 - Detection -   eval_score = 96.43
2023-04-04 22:08:45,823 - Detection -   train_loss = 0.7197624511188931
2023-04-04 22:08:50,988 - Detection - ***** Epoch: 26: Eval results *****
2023-04-04 22:08:50,988 - Detection -   best_eval_score = 96.54
2023-04-04 22:08:50,988 - Detection -   eval_score = 96.43
2023-04-04 22:08:50,988 - Detection -   train_loss = 0.7096118827660879
2023-04-04 22:08:56,154 - Detection - ***** Epoch: 27: Eval results *****
2023-04-04 22:08:56,154 - Detection -   best_eval_score = 96.54
2023-04-04 22:08:56,154 - Detection -   eval_score = 96.43
2023-04-04 22:08:56,154 - Detection -   train_loss = 0.6952677269776663
2023-04-04 22:09:01,317 - Detection - ***** Epoch: 28: Eval results *****
2023-04-04 22:09:01,317 - Detection -   best_eval_score = 96.54
2023-04-04 22:09:01,317 - Detection -   eval_score = 96.43
2023-04-04 22:09:01,317 - Detection -   train_loss = 0.6829697920216454
2023-04-04 22:09:06,477 - Detection - ***** Epoch: 29: Eval results *****
2023-04-04 22:09:06,477 - Detection -   best_eval_score = 96.54
2023-04-04 22:09:06,477 - Detection -   eval_score = 96.43
2023-04-04 22:09:06,477 - Detection -   train_loss = 0.6747960944970449
2023-04-04 22:09:11,639 - Detection - ***** Epoch: 30: Eval results *****
2023-04-04 22:09:11,639 - Detection -   best_eval_score = 96.54
2023-04-04 22:09:11,639 - Detection -   eval_score = 96.43
2023-04-04 22:09:11,639 - Detection -   train_loss = 0.6605115135510763
2023-04-04 22:09:16,800 - Detection - ***** Epoch: 31: Eval results *****
2023-04-04 22:09:16,800 - Detection -   best_eval_score = 96.54
2023-04-04 22:09:16,800 - Detection -   eval_score = 96.43
2023-04-04 22:09:16,800 - Detection -   train_loss = 0.6515624721844991
2023-04-04 22:09:21,958 - Detection - ***** Epoch: 32: Eval results *****
2023-04-04 22:09:21,958 - Detection -   best_eval_score = 96.54
2023-04-04 22:09:21,958 - Detection -   eval_score = 96.43
2023-04-04 22:09:21,958 - Detection -   train_loss = 0.6462523440519968
2023-04-04 22:09:21,959 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_0.25_1.0_bert_disaware_2/models
2023-04-04 22:09:22,516 - Detection - Pre-training finished...
2023-04-04 22:09:22,516 - Detection - Training Begin...
2023-04-04 22:09:25,373 - Detection - ***** Epoch: 1: Eval results *****
2023-04-04 22:09:25,373 - Detection -   best_eval_score = 0
2023-04-04 22:09:25,373 - Detection -   eval_score = 23.37
2023-04-04 22:09:25,373 - Detection -   train_loss = 2.8484645817014904
2023-04-04 22:09:28,228 - Detection - ***** Epoch: 2: Eval results *****
2023-04-04 22:09:28,229 - Detection -   best_eval_score = 23.37
2023-04-04 22:09:28,229 - Detection -   eval_score = 39.21
2023-04-04 22:09:28,229 - Detection -   train_loss = 2.2384579843944974
2023-04-04 22:09:31,085 - Detection - ***** Epoch: 3: Eval results *****
2023-04-04 22:09:31,085 - Detection -   best_eval_score = 39.21
2023-04-04 22:09:31,085 - Detection -   eval_score = 63.04
2023-04-04 22:09:31,085 - Detection -   train_loss = 1.5759234362178378
2023-04-04 22:09:33,943 - Detection - ***** Epoch: 4: Eval results *****
2023-04-04 22:09:33,943 - Detection -   best_eval_score = 63.04
2023-04-04 22:09:33,943 - Detection -   eval_score = 79.97
2023-04-04 22:09:33,943 - Detection -   train_loss = 0.9984848996003469
2023-04-04 22:09:36,801 - Detection - ***** Epoch: 5: Eval results *****
2023-04-04 22:09:36,801 - Detection -   best_eval_score = 79.97
2023-04-04 22:09:36,801 - Detection -   eval_score = 86.53
2023-04-04 22:09:36,801 - Detection -   train_loss = 0.6952957544061873
2023-04-04 22:09:39,659 - Detection - ***** Epoch: 6: Eval results *****
2023-04-04 22:09:39,659 - Detection -   best_eval_score = 86.53
2023-04-04 22:09:39,659 - Detection -   eval_score = 87.32
2023-04-04 22:09:39,659 - Detection -   train_loss = 0.6013292007976108
2023-04-04 22:09:42,516 - Detection - ***** Epoch: 7: Eval results *****
2023-04-04 22:09:42,516 - Detection -   best_eval_score = 87.32
2023-04-04 22:09:42,516 - Detection -   eval_score = 87.14
2023-04-04 22:09:42,516 - Detection -   train_loss = 0.6003795895311568
2023-04-04 22:09:45,373 - Detection - ***** Epoch: 8: Eval results *****
2023-04-04 22:09:45,373 - Detection -   best_eval_score = 87.32
2023-04-04 22:09:45,373 - Detection -   eval_score = 86.77
2023-04-04 22:09:45,373 - Detection -   train_loss = 0.5998695492744446
2023-04-04 22:09:48,229 - Detection - ***** Epoch: 9: Eval results *****
2023-04-04 22:09:48,229 - Detection -   best_eval_score = 87.32
2023-04-04 22:09:48,229 - Detection -   eval_score = 87.32
2023-04-04 22:09:48,229 - Detection -   train_loss = 0.6004747963613934
2023-04-04 22:09:51,086 - Detection - ***** Epoch: 10: Eval results *****
2023-04-04 22:09:51,086 - Detection -   best_eval_score = 87.32
2023-04-04 22:09:51,086 - Detection -   eval_score = 87.32
2023-04-04 22:09:51,086 - Detection -   train_loss = 0.5991861886448331
2023-04-04 22:09:53,943 - Detection - ***** Epoch: 11: Eval results *****
2023-04-04 22:09:53,943 - Detection -   best_eval_score = 87.32
2023-04-04 22:09:53,943 - Detection -   eval_score = 87.32
2023-04-04 22:09:53,943 - Detection -   train_loss = 0.6006343960762024
2023-04-04 22:09:56,800 - Detection - ***** Epoch: 12: Eval results *****
2023-04-04 22:09:56,800 - Detection -   best_eval_score = 87.32
2023-04-04 22:09:56,800 - Detection -   eval_score = 87.32
2023-04-04 22:09:56,800 - Detection -   train_loss = 0.594917259282536
2023-04-04 22:09:59,660 - Detection - ***** Epoch: 13: Eval results *****
2023-04-04 22:09:59,660 - Detection -   best_eval_score = 87.32
2023-04-04 22:09:59,660 - Detection -   eval_score = 87.08
2023-04-04 22:09:59,660 - Detection -   train_loss = 0.5945170289940305
2023-04-04 22:10:02,521 - Detection - ***** Epoch: 14: Eval results *****
2023-04-04 22:10:02,521 - Detection -   best_eval_score = 87.32
2023-04-04 22:10:02,521 - Detection -   eval_score = 87.14
2023-04-04 22:10:02,521 - Detection -   train_loss = 0.6154225220282873
2023-04-04 22:10:05,376 - Detection - ***** Epoch: 15: Eval results *****
2023-04-04 22:10:05,376 - Detection -   best_eval_score = 87.32
2023-04-04 22:10:05,376 - Detection -   eval_score = 87.14
2023-04-04 22:10:05,377 - Detection -   train_loss = 0.6073764562606812
2023-04-04 22:10:08,231 - Detection - ***** Epoch: 16: Eval results *****
2023-04-04 22:10:08,231 - Detection -   best_eval_score = 87.32
2023-04-04 22:10:08,231 - Detection -   eval_score = 87.32
2023-04-04 22:10:08,231 - Detection -   train_loss = 0.6156460725598865
2023-04-04 22:10:08,232 - Detection - Training Finished...
2023-04-04 22:10:08,232 - Detection - Testing begin...
2023-04-04 22:10:11,319 - Detection - ***** Test: Confusion Matrix *****
2023-04-04 22:10:11,319 - Detection - [[  29    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    1   10]
 [   0   36    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    4]
 [   0    0   31    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    9]
 [   0    0    0   31    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    9]
 [   0    0    0    0   39    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    1]
 [   0    0    0    0    0   29    0    0    0    0    0    0    0    0
     0    0    0    0    0   11]
 [   0    0    0    0    0    0   31    0    0    0    0    0    0    0
     1    0    0    0    0    8]
 [   0    0    0    0    0    0    0   35    0    0    0    0    0    0
     0    0    0    0    0    5]
 [   0    0    0    0    0    0    0    0   40    0    0    0    0    0
     0    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0   31    0    0    0    0
     0    0    0    0    0    9]
 [   0    0    0    0    0    0    0    0    0    0   34    0    0    0
     0    0    0    0    0    6]
 [   0    0    0    0    0    0    0    0    0    0    0   29    0    1
     0    0    0    0    0   10]
 [   0    0    0    0    0    0    0    0    0    0    0    0   36    0
     0    0    0    0    0    4]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0   35
     0    0    0    0    0    5]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
    36    0    0    0    0    4]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0   36    0    0    0    4]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0   35    0    0    5]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0   31    0    9]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0   35    5]
 [   3   34   54   50    2   17   71    5    0   42   34    2   14   85
    26   74   44    3    9 1751]]
2023-04-04 22:10:11,319 - Detection - ***** Test results *****
2023-04-04 22:10:11,319 - Detection -   Acc = 77.6
2023-04-04 22:10:11,320 - Detection -   F1 = 69.5606
2023-04-04 22:10:11,320 - Detection -   F1-known = 68.8217
2023-04-04 22:10:11,320 - Detection -   F1-open = 83.5999
2023-04-04 22:10:11,320 - Detection - Testing finished...
2023-04-04 22:10:11,320 - Detection - Results saved in results/results_DA-ADB.csv
2023-04-04 22:10:11,336 - Detection - Open Intent Detection Finished...
