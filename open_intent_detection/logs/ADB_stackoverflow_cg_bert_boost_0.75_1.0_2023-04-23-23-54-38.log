2023-04-23 23:54:38,746 - Detection - Open Intent Detection Begin...
2023-04-23 23:54:38,746 - Detection - Parameters Initialization...
2023-04-23 23:54:38,746 - Detection - ============================== Params ==============================
2023-04-23 23:54:38,746 - Detection - type:	open_intent_detection
2023-04-23 23:54:38,746 - Detection - logger_name:	Detection
2023-04-23 23:54:38,746 - Detection - log_dir:	logs
2023-04-23 23:54:38,746 - Detection - dataset:	stackoverflow_cg
2023-04-23 23:54:38,746 - Detection - known_cls_ratio:	0.75
2023-04-23 23:54:38,746 - Detection - labeled_ratio:	1.0
2023-04-23 23:54:38,746 - Detection - method:	ADB
2023-04-23 23:54:38,746 - Detection - train:	True
2023-04-23 23:54:38,746 - Detection - pretrain:	True
2023-04-23 23:54:38,746 - Detection - save_model:	False
2023-04-23 23:54:38,746 - Detection - backbone:	bert_boost
2023-04-23 23:54:38,746 - Detection - config_file_name:	ADB
2023-04-23 23:54:38,747 - Detection - seed:	5
2023-04-23 23:54:38,747 - Detection - gpu_id:	0
2023-04-23 23:54:38,747 - Detection - pipe_results_path:	pipe_results
2023-04-23 23:54:38,747 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-23 23:54:38,747 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-23 23:54:38,747 - Detection - model_dir:	models
2023-04-23 23:54:38,747 - Detection - load_pretrained_method:	None
2023-04-23 23:54:38,747 - Detection - result_dir:	results
2023-04-23 23:54:38,747 - Detection - results_file_name:	results_ADB-BOOST-F-4.csv
2023-04-23 23:54:38,747 - Detection - save_results:	True
2023-04-23 23:54:38,747 - Detection - loss_fct:	CrossEntropyLoss
2023-04-23 23:54:38,747 - Detection - boost_method:	F-4
2023-04-23 23:54:38,747 - Detection - boost_start_score:	0.0
2023-04-23 23:54:38,747 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.75_1.0_bert_boost_5
2023-04-23 23:54:38,747 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.75_1.0_bert_boost_5/models
2023-04-23 23:54:38,747 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-23 23:54:38,747 - Detection - num_train_epochs:	100
2023-04-23 23:54:38,747 - Detection - num_labels:	None
2023-04-23 23:54:38,747 - Detection - max_seq_length:	None
2023-04-23 23:54:38,747 - Detection - freeze_backbone_parameters:	True
2023-04-23 23:54:38,747 - Detection - feat_dim:	768
2023-04-23 23:54:38,747 - Detection - warmup_proportion:	0.1
2023-04-23 23:54:38,747 - Detection - lr_boundary:	0.05
2023-04-23 23:54:38,747 - Detection - lr:	2e-05
2023-04-23 23:54:38,747 - Detection - activation:	relu
2023-04-23 23:54:38,747 - Detection - train_batch_size:	128
2023-04-23 23:54:38,747 - Detection - eval_batch_size:	64
2023-04-23 23:54:38,747 - Detection - test_batch_size:	64
2023-04-23 23:54:38,747 - Detection - wait_patient:	10
2023-04-23 23:54:38,747 - Detection - ============================== End Params ==============================
2023-04-23 23:54:38,747 - Detection - Data and Model Preparation...
2023-04-23 23:54:38,747 - Detection - The number of known intents is 15
2023-04-23 23:54:38,748 - Detection - Lists of known labels are: ['bash', 'excel', 'svn', 'wordpress', 'osx', 'apache', 'oracle', 'matlab', 'qt', 'visual-studio', 'hibernate', 'drupal', 'linq', 'magento', 'ajax']
2023-04-23 23:54:38,757 - Detection - Number of labeled training samples = 2003
2023-04-23 23:54:38,757 - Detection - Number of unlabeled training samples = 788
2023-04-23 23:54:38,759 - Detection - Number of evaluation samples = 1071
2023-04-23 23:54:38,765 - Detection - Number of testing samples = 2905
2023-04-23 23:54:45,367 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-23 23:54:47,078 - Detection - Pre-training Begin...
2023-04-23 23:54:49,809 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 23:54:49,809 - Detection -   best_eval_score = 0
2023-04-23 23:54:49,809 - Detection -   eval_score = 11.58
2023-04-23 23:54:49,809 - Detection -   train_loss = 2.7112233638763428
2023-04-23 23:55:01,712 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 23:55:01,712 - Detection -   best_eval_score = 11.58
2023-04-23 23:55:01,712 - Detection -   eval_score = 9.34
2023-04-23 23:55:01,712 - Detection -   train_loss = 2.6951326429843903
2023-04-23 23:55:13,477 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 23:55:13,477 - Detection -   best_eval_score = 11.58
2023-04-23 23:55:13,477 - Detection -   eval_score = 37.44
2023-04-23 23:55:13,477 - Detection -   train_loss = 2.5454157888889313
2023-04-23 23:55:24,868 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 23:55:24,868 - Detection -   best_eval_score = 37.44
2023-04-23 23:55:24,868 - Detection -   eval_score = 71.43
2023-04-23 23:55:24,868 - Detection -   train_loss = 2.0097095668315887
2023-04-23 23:55:36,167 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 23:55:36,167 - Detection -   best_eval_score = 71.43
2023-04-23 23:55:36,167 - Detection -   eval_score = 80.02
2023-04-23 23:55:36,167 - Detection -   train_loss = 1.2892808839678764
2023-04-23 23:55:47,455 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 23:55:47,455 - Detection -   best_eval_score = 80.02
2023-04-23 23:55:47,455 - Detection -   eval_score = 81.42
2023-04-23 23:55:47,455 - Detection -   train_loss = 0.9042088016867638
2023-04-23 23:55:59,107 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 23:55:59,107 - Detection -   best_eval_score = 81.42
2023-04-23 23:55:59,107 - Detection -   eval_score = 82.45
2023-04-23 23:55:59,107 - Detection -   train_loss = 0.7371569536626339
2023-04-23 23:56:10,932 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 23:56:10,932 - Detection -   best_eval_score = 82.45
2023-04-23 23:56:10,932 - Detection -   eval_score = 83.38
2023-04-23 23:56:10,932 - Detection -   train_loss = 0.6102567054331303
2023-04-23 23:56:22,383 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 23:56:22,383 - Detection -   best_eval_score = 83.38
2023-04-23 23:56:22,383 - Detection -   eval_score = 83.38
2023-04-23 23:56:22,383 - Detection -   train_loss = 0.5209739319980145
2023-04-23 23:56:33,647 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 23:56:33,647 - Detection -   best_eval_score = 83.38
2023-04-23 23:56:33,647 - Detection -   eval_score = 83.57
2023-04-23 23:56:33,647 - Detection -   train_loss = 0.42265187203884125
2023-04-23 23:56:45,089 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 23:56:45,089 - Detection -   best_eval_score = 83.57
2023-04-23 23:56:45,089 - Detection -   eval_score = 83.57
2023-04-23 23:56:45,089 - Detection -   train_loss = 0.34688493981957436
2023-04-23 23:56:56,498 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 23:56:56,498 - Detection -   best_eval_score = 83.57
2023-04-23 23:56:56,498 - Detection -   eval_score = 83.57
2023-04-23 23:56:56,498 - Detection -   train_loss = 0.2722860989160836
2023-04-23 23:57:08,116 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 23:57:08,117 - Detection -   best_eval_score = 83.57
2023-04-23 23:57:08,117 - Detection -   eval_score = 83.66
2023-04-23 23:57:08,117 - Detection -   train_loss = 0.25730961095541716
2023-04-23 23:57:19,532 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 23:57:19,532 - Detection -   best_eval_score = 83.66
2023-04-23 23:57:19,532 - Detection -   eval_score = 83.19
2023-04-23 23:57:19,532 - Detection -   train_loss = 0.20779827516525984
2023-04-23 23:57:30,808 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 23:57:30,808 - Detection -   best_eval_score = 83.66
2023-04-23 23:57:30,808 - Detection -   eval_score = 83.19
2023-04-23 23:57:30,808 - Detection -   train_loss = 0.17078935913741589
2023-04-23 23:57:42,181 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 23:57:42,181 - Detection -   best_eval_score = 83.66
2023-04-23 23:57:42,181 - Detection -   eval_score = 83.75
2023-04-23 23:57:42,181 - Detection -   train_loss = 0.14520199038088322
2023-04-23 23:57:53,444 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 23:57:53,444 - Detection -   best_eval_score = 83.75
2023-04-23 23:57:53,444 - Detection -   eval_score = 83.19
2023-04-23 23:57:53,444 - Detection -   train_loss = 0.12867926782928407
2023-04-23 23:58:05,038 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 23:58:05,038 - Detection -   best_eval_score = 83.75
2023-04-23 23:58:05,038 - Detection -   eval_score = 83.47
2023-04-23 23:58:05,038 - Detection -   train_loss = 0.12183227459900081
2023-04-23 23:58:16,543 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 23:58:16,543 - Detection -   best_eval_score = 83.75
2023-04-23 23:58:16,543 - Detection -   eval_score = 83.47
2023-04-23 23:58:16,543 - Detection -   train_loss = 0.10289533901959658
2023-04-23 23:58:27,814 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 23:58:27,814 - Detection -   best_eval_score = 83.75
2023-04-23 23:58:27,814 - Detection -   eval_score = 83.19
2023-04-23 23:58:27,814 - Detection -   train_loss = 0.11213123775087297
2023-04-23 23:58:39,195 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 23:58:39,195 - Detection -   best_eval_score = 83.75
2023-04-23 23:58:39,195 - Detection -   eval_score = 83.29
2023-04-23 23:58:39,195 - Detection -   train_loss = 0.09001393988728523
2023-04-23 23:58:50,517 - Detection - ***** Epoch: 22: Eval results *****
2023-04-23 23:58:50,517 - Detection -   best_eval_score = 83.75
2023-04-23 23:58:50,517 - Detection -   eval_score = 83.57
2023-04-23 23:58:50,517 - Detection -   train_loss = 0.06856580567546189
2023-04-23 23:59:01,900 - Detection - ***** Epoch: 23: Eval results *****
2023-04-23 23:59:01,900 - Detection -   best_eval_score = 83.75
2023-04-23 23:59:01,900 - Detection -   eval_score = 83.57
2023-04-23 23:59:01,900 - Detection -   train_loss = 0.0684525326360017
2023-04-23 23:59:13,168 - Detection - ***** Epoch: 24: Eval results *****
2023-04-23 23:59:13,168 - Detection -   best_eval_score = 83.75
2023-04-23 23:59:13,168 - Detection -   eval_score = 83.66
2023-04-23 23:59:13,168 - Detection -   train_loss = 0.055198844289407134
2023-04-23 23:59:24,535 - Detection - ***** Epoch: 25: Eval results *****
2023-04-23 23:59:24,535 - Detection -   best_eval_score = 83.75
2023-04-23 23:59:24,535 - Detection -   eval_score = 83.47
2023-04-23 23:59:24,535 - Detection -   train_loss = 0.06190590304322541
2023-04-23 23:59:35,837 - Detection - ***** Epoch: 26: Eval results *****
2023-04-23 23:59:35,837 - Detection -   best_eval_score = 83.75
2023-04-23 23:59:35,837 - Detection -   eval_score = 83.57
2023-04-23 23:59:35,837 - Detection -   train_loss = 0.05699896067380905
2023-04-23 23:59:35,837 - Detection - Pre-training finished...
2023-04-23 23:59:35,838 - Detection - Training Begin...
2023-04-23 23:59:39,053 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 23:59:39,053 - Detection -   best_eval_score = 0
2023-04-23 23:59:39,053 - Detection -   eval_score = 0.0
2023-04-23 23:59:39,053 - Detection -   train_loss = 11.04778003692627
2023-04-23 23:59:41,061 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 23:59:41,061 - Detection -   best_eval_score = 0
2023-04-23 23:59:41,061 - Detection -   eval_score = 0.0
2023-04-23 23:59:41,061 - Detection -   train_loss = 10.489072620868683
2023-04-23 23:59:43,067 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 23:59:43,067 - Detection -   best_eval_score = 0
2023-04-23 23:59:43,067 - Detection -   eval_score = 0.0
2023-04-23 23:59:43,067 - Detection -   train_loss = 9.845239579677582
2023-04-23 23:59:45,075 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 23:59:45,075 - Detection -   best_eval_score = 0
2023-04-23 23:59:45,075 - Detection -   eval_score = 0.18
2023-04-23 23:59:45,075 - Detection -   train_loss = 9.01390916109085
2023-04-23 23:59:56,439 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 23:59:56,439 - Detection -   best_eval_score = 0.18
2023-04-23 23:59:56,439 - Detection -   eval_score = 50.13
2023-04-23 23:59:56,439 - Detection -   train_loss = 8.19796073436737
2023-04-24 00:00:07,778 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 00:00:07,779 - Detection -   best_eval_score = 50.13
2023-04-24 00:00:07,779 - Detection -   eval_score = 76.76
2023-04-24 00:00:07,779 - Detection -   train_loss = 4.0520279705524445
2023-04-24 00:00:19,015 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 00:00:19,015 - Detection -   best_eval_score = 76.76
2023-04-24 00:00:19,015 - Detection -   eval_score = 77.99
2023-04-24 00:00:19,015 - Detection -   train_loss = 1.7550066486001015
2023-04-24 00:00:30,379 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 00:00:30,379 - Detection -   best_eval_score = 77.99
2023-04-24 00:00:30,379 - Detection -   eval_score = 77.98
2023-04-24 00:00:30,379 - Detection -   train_loss = 1.6386424005031586
2023-04-24 00:00:41,619 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 00:00:41,620 - Detection -   best_eval_score = 77.99
2023-04-24 00:00:41,620 - Detection -   eval_score = 77.88
2023-04-24 00:00:41,620 - Detection -   train_loss = 1.6685345023870468
2023-04-24 00:00:52,957 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 00:00:52,957 - Detection -   best_eval_score = 77.99
2023-04-24 00:00:52,957 - Detection -   eval_score = 77.9
2023-04-24 00:00:52,957 - Detection -   train_loss = 1.6553737074136734
2023-04-24 00:01:04,183 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 00:01:04,183 - Detection -   best_eval_score = 77.99
2023-04-24 00:01:04,183 - Detection -   eval_score = 78.0
2023-04-24 00:01:04,183 - Detection -   train_loss = 1.6984938383102417
2023-04-24 00:01:15,482 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 00:01:15,482 - Detection -   best_eval_score = 78.0
2023-04-24 00:01:15,482 - Detection -   eval_score = 77.95
2023-04-24 00:01:15,482 - Detection -   train_loss = 1.6936328038573265
2023-04-24 00:01:26,700 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 00:01:26,700 - Detection -   best_eval_score = 78.0
2023-04-24 00:01:26,700 - Detection -   eval_score = 77.93
2023-04-24 00:01:26,700 - Detection -   train_loss = 1.669020988047123
2023-04-24 00:01:38,011 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 00:01:38,011 - Detection -   best_eval_score = 78.0
2023-04-24 00:01:38,011 - Detection -   eval_score = 77.7
2023-04-24 00:01:38,011 - Detection -   train_loss = 1.655418485403061
2023-04-24 00:01:49,273 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 00:01:49,273 - Detection -   best_eval_score = 78.0
2023-04-24 00:01:49,273 - Detection -   eval_score = 77.9
2023-04-24 00:01:49,273 - Detection -   train_loss = 1.661671832203865
2023-04-24 00:02:00,521 - Detection - ***** Epoch: 16: Eval results *****
2023-04-24 00:02:00,521 - Detection -   best_eval_score = 78.0
2023-04-24 00:02:00,521 - Detection -   eval_score = 77.95
2023-04-24 00:02:00,521 - Detection -   train_loss = 1.6855090633034706
2023-04-24 00:02:11,786 - Detection - ***** Epoch: 17: Eval results *****
2023-04-24 00:02:11,786 - Detection -   best_eval_score = 78.0
2023-04-24 00:02:11,786 - Detection -   eval_score = 78.0
2023-04-24 00:02:11,786 - Detection -   train_loss = 1.7133413553237915
2023-04-24 00:02:23,076 - Detection - ***** Epoch: 18: Eval results *****
2023-04-24 00:02:23,076 - Detection -   best_eval_score = 78.0
2023-04-24 00:02:23,076 - Detection -   eval_score = 77.79
2023-04-24 00:02:23,076 - Detection -   train_loss = 1.6659964472055435
2023-04-24 00:02:34,423 - Detection - ***** Epoch: 19: Eval results *****
2023-04-24 00:02:34,423 - Detection -   best_eval_score = 78.0
2023-04-24 00:02:34,423 - Detection -   eval_score = 77.93
2023-04-24 00:02:34,423 - Detection -   train_loss = 1.6684992909431458
2023-04-24 00:02:45,620 - Detection - ***** Epoch: 20: Eval results *****
2023-04-24 00:02:45,620 - Detection -   best_eval_score = 78.0
2023-04-24 00:02:45,620 - Detection -   eval_score = 77.82
2023-04-24 00:02:45,620 - Detection -   train_loss = 1.675047516822815
2023-04-24 00:02:56,947 - Detection - ***** Epoch: 21: Eval results *****
2023-04-24 00:02:56,947 - Detection -   best_eval_score = 78.0
2023-04-24 00:02:56,947 - Detection -   eval_score = 77.9
2023-04-24 00:02:56,947 - Detection -   train_loss = 1.6854538321495056
2023-04-24 00:02:56,947 - Detection - Training Finished...
2023-04-24 00:02:56,947 - Detection - Testing begin...
2023-04-24 00:02:58,700 - Detection - ***** Test: Confusion Matrix *****
2023-04-24 00:02:58,700 - Detection - [[ 87   0   0   0   5   1   0   1   0   0   0   1   0   0   1  43]
 [  0  92   0   0   0   0   0   0   0   0   0   0   0   0   0  48]
 [  1   0 103   0   1   2   0   0   0   2   0   0   0   0   0  40]
 [  1   0   0 104   0   1   0   0   0   0   0   2   0   0   0  29]
 [  0   1   2   1 133   1   0   0   2   1   0   0   0   0   1  51]
 [  1   0   2   1   1  89   0   0   0   0   0   0   0   0   2  74]
 [  0   0   0   0   0   0  94   0   0   0   0   0   0   0   0  33]
 [  0   0   0   0   1   0   0 133   0   0   0   0   0   0   1  29]
 [  1   0   0   0   0   0   0   0 151   0   0   0   0   0   0  20]
 [  0   1   0   0   1   0   0   0   0  43   0   0   0   0   1  60]
 [  0   0   0   0   1   0   2   0   0   0  79   0   0   0   0  46]
 [  0   0   0   0   0   0   0   0   0   0   0  97   0   1   0  30]
 [  0   0   0   0   0   0   0   0   0   0   0   0 101   0   0  30]
 [  0   0   0   0   0   0   0   0   1   0   0   0   0  98   0  33]
 [  0   0   0   1   0   0   0   0   0   1   0   0   0   0 111  47]
 [  2   4   0   0 108   1   3   3   2   8  17   2   0   0  14 565]]
2023-04-24 00:02:58,700 - Detection - ***** Test results *****
2023-04-24 00:02:58,700 - Detection -   Acc = 71.6
2023-04-24 00:02:58,700 - Detection -   F1 = 76.5311
2023-04-24 00:02:58,700 - Detection -   F1-known = 77.6828
2023-04-24 00:02:58,701 - Detection -   F1-open = 59.2554
2023-04-24 00:02:58,701 - Detection - Testing finished...
2023-04-24 00:02:58,701 - Detection - Results saved in results/results_ADB-BOOST-F-4.csv
2023-04-24 00:02:58,720 - Detection - Open Intent Detection Finished...
