2023-04-22 15:35:04,269 - Detection - Open Intent Detection Begin...
2023-04-22 15:35:04,269 - Detection - Parameters Initialization...
2023-04-22 15:35:04,269 - Detection - ============================== Params ==============================
2023-04-22 15:35:04,269 - Detection - type:	open_intent_detection
2023-04-22 15:35:04,269 - Detection - logger_name:	Detection
2023-04-22 15:35:04,269 - Detection - log_dir:	logs
2023-04-22 15:35:04,269 - Detection - dataset:	stackoverflow_cg
2023-04-22 15:35:04,270 - Detection - known_cls_ratio:	0.75
2023-04-22 15:35:04,270 - Detection - labeled_ratio:	1.0
2023-04-22 15:35:04,270 - Detection - method:	DA-ADB
2023-04-22 15:35:04,270 - Detection - train:	True
2023-04-22 15:35:04,270 - Detection - pretrain:	True
2023-04-22 15:35:04,270 - Detection - save_model:	False
2023-04-22 15:35:04,270 - Detection - backbone:	bert_disaware_boost
2023-04-22 15:35:04,270 - Detection - config_file_name:	DA-ADB
2023-04-22 15:35:04,270 - Detection - seed:	3
2023-04-22 15:35:04,270 - Detection - gpu_id:	0
2023-04-22 15:35:04,270 - Detection - pipe_results_path:	pipe_results
2023-04-22 15:35:04,270 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-22 15:35:04,270 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-22 15:35:04,270 - Detection - model_dir:	models
2023-04-22 15:35:04,270 - Detection - load_pretrained_method:	None
2023-04-22 15:35:04,270 - Detection - result_dir:	results
2023-04-22 15:35:04,270 - Detection - results_file_name:	results_DA-ADB-BOOST.csv
2023-04-22 15:35:04,270 - Detection - save_results:	True
2023-04-22 15:35:04,270 - Detection - loss_fct:	CrossEntropyLoss
2023-04-22 15:35:04,270 - Detection - boost_method:	F-10
2023-04-22 15:35:04,270 - Detection - boost_start_score:	0.0
2023-04-22 15:35:04,270 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.75_1.0_bert_disaware_boost_3
2023-04-22 15:35:04,270 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.75_1.0_bert_disaware_boost_3/models
2023-04-22 15:35:04,270 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-22 15:35:04,270 - Detection - num_train_epochs:	100
2023-04-22 15:35:04,270 - Detection - num_labels:	None
2023-04-22 15:35:04,270 - Detection - max_seq_length:	None
2023-04-22 15:35:04,270 - Detection - freeze_backbone_parameters:	True
2023-04-22 15:35:04,270 - Detection - feat_dim:	768
2023-04-22 15:35:04,270 - Detection - warmup_proportion:	0.1
2023-04-22 15:35:04,270 - Detection - scale:	4
2023-04-22 15:35:04,270 - Detection - lr_boundary:	0.05
2023-04-22 15:35:04,270 - Detection - lr:	2e-05
2023-04-22 15:35:04,270 - Detection - activation:	relu
2023-04-22 15:35:04,270 - Detection - train_batch_size:	128
2023-04-22 15:35:04,270 - Detection - eval_batch_size:	64
2023-04-22 15:35:04,270 - Detection - test_batch_size:	64
2023-04-22 15:35:04,270 - Detection - wait_patient:	10
2023-04-22 15:35:04,270 - Detection - ============================== End Params ==============================
2023-04-22 15:35:04,270 - Detection - Data and Model Preparation...
2023-04-22 15:35:04,271 - Detection - The number of known intents is 15
2023-04-22 15:35:04,271 - Detection - Lists of known labels are: ['scala', 'bash', 'apache', 'svn', 'drupal', 'spring', 'haskell', 'hibernate', 'sharepoint', 'osx', 'magento', 'oracle', 'wordpress', 'visual-studio', 'qt']
2023-04-22 15:35:04,281 - Detection - Number of labeled training samples = 2057
2023-04-22 15:35:04,281 - Detection - Number of unlabeled training samples = 734
2023-04-22 15:35:04,283 - Detection - Number of evaluation samples = 1061
2023-04-22 15:35:04,290 - Detection - Number of testing samples = 2905
2023-04-22 15:35:09,929 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-22 15:35:10,010 - Detection - Pre-training Begin...
2023-04-22 15:35:14,937 - Detection - ***** Epoch: 1: Eval results *****
2023-04-22 15:35:14,938 - Detection -   best_eval_score = 0
2023-04-22 15:35:14,938 - Detection -   eval_score = 1.24
2023-04-22 15:35:14,938 - Detection -   train_loss = 2.720661626142614
2023-04-22 15:35:47,145 - Detection - ***** Epoch: 2: Eval results *****
2023-04-22 15:35:47,145 - Detection -   best_eval_score = 1.24
2023-04-22 15:35:47,145 - Detection -   eval_score = 5.17
2023-04-22 15:35:47,145 - Detection -   train_loss = 2.7028434416827034
2023-04-22 15:36:19,587 - Detection - ***** Epoch: 3: Eval results *****
2023-04-22 15:36:19,587 - Detection -   best_eval_score = 5.17
2023-04-22 15:36:19,587 - Detection -   eval_score = 43.73
2023-04-22 15:36:19,587 - Detection -   train_loss = 2.5783386370714974
2023-04-22 15:36:51,914 - Detection - ***** Epoch: 4: Eval results *****
2023-04-22 15:36:51,915 - Detection -   best_eval_score = 43.73
2023-04-22 15:36:51,915 - Detection -   eval_score = 75.19
2023-04-22 15:36:51,915 - Detection -   train_loss = 2.225840414271635
2023-04-22 15:37:24,364 - Detection - ***** Epoch: 5: Eval results *****
2023-04-22 15:37:24,364 - Detection -   best_eval_score = 75.19
2023-04-22 15:37:24,364 - Detection -   eval_score = 81.22
2023-04-22 15:37:24,364 - Detection -   train_loss = 1.6504036118002499
2023-04-22 15:37:56,610 - Detection - ***** Epoch: 6: Eval results *****
2023-04-22 15:37:56,610 - Detection -   best_eval_score = 81.22
2023-04-22 15:37:56,610 - Detection -   eval_score = 82.28
2023-04-22 15:37:56,610 - Detection -   train_loss = 1.3112745705772848
2023-04-22 15:38:28,925 - Detection - ***** Epoch: 7: Eval results *****
2023-04-22 15:38:28,925 - Detection -   best_eval_score = 82.28
2023-04-22 15:38:28,925 - Detection -   eval_score = 82.86
2023-04-22 15:38:28,925 - Detection -   train_loss = 1.1418795515509212
2023-04-22 15:39:01,246 - Detection - ***** Epoch: 8: Eval results *****
2023-04-22 15:39:01,247 - Detection -   best_eval_score = 82.86
2023-04-22 15:39:01,247 - Detection -   eval_score = 82.78
2023-04-22 15:39:01,247 - Detection -   train_loss = 1.0397303490077747
2023-04-22 15:39:33,685 - Detection - ***** Epoch: 9: Eval results *****
2023-04-22 15:39:33,685 - Detection -   best_eval_score = 82.86
2023-04-22 15:39:33,685 - Detection -   eval_score = 83.61
2023-04-22 15:39:33,685 - Detection -   train_loss = 0.9149842016837176
2023-04-22 15:40:06,423 - Detection - ***** Epoch: 10: Eval results *****
2023-04-22 15:40:06,423 - Detection -   best_eval_score = 83.61
2023-04-22 15:40:06,423 - Detection -   eval_score = 82.88
2023-04-22 15:40:06,423 - Detection -   train_loss = 0.8499807715415955
2023-04-22 15:40:39,172 - Detection - ***** Epoch: 11: Eval results *****
2023-04-22 15:40:39,172 - Detection -   best_eval_score = 83.61
2023-04-22 15:40:39,172 - Detection -   eval_score = 84.36
2023-04-22 15:40:39,172 - Detection -   train_loss = 0.7462146001703599
2023-04-22 15:41:11,584 - Detection - ***** Epoch: 12: Eval results *****
2023-04-22 15:41:11,584 - Detection -   best_eval_score = 84.36
2023-04-22 15:41:11,585 - Detection -   eval_score = 84.39
2023-04-22 15:41:11,585 - Detection -   train_loss = 0.6744487355737125
2023-04-22 15:41:44,040 - Detection - ***** Epoch: 13: Eval results *****
2023-04-22 15:41:44,041 - Detection -   best_eval_score = 84.39
2023-04-22 15:41:44,041 - Detection -   eval_score = 83.66
2023-04-22 15:41:44,041 - Detection -   train_loss = 0.6271972375757554
2023-04-22 15:42:16,300 - Detection - ***** Epoch: 14: Eval results *****
2023-04-22 15:42:16,300 - Detection -   best_eval_score = 84.39
2023-04-22 15:42:16,300 - Detection -   eval_score = 82.25
2023-04-22 15:42:16,300 - Detection -   train_loss = 0.5885527589741875
2023-04-22 15:42:48,676 - Detection - ***** Epoch: 15: Eval results *****
2023-04-22 15:42:48,676 - Detection -   best_eval_score = 84.39
2023-04-22 15:42:48,676 - Detection -   eval_score = 82.18
2023-04-22 15:42:48,676 - Detection -   train_loss = 0.5964060040081248
2023-04-22 15:43:20,928 - Detection - ***** Epoch: 16: Eval results *****
2023-04-22 15:43:20,928 - Detection -   best_eval_score = 84.39
2023-04-22 15:43:20,928 - Detection -   eval_score = 82.74
2023-04-22 15:43:20,928 - Detection -   train_loss = 0.5370263404705945
2023-04-22 15:43:53,252 - Detection - ***** Epoch: 17: Eval results *****
2023-04-22 15:43:53,252 - Detection -   best_eval_score = 84.39
2023-04-22 15:43:53,252 - Detection -   eval_score = 83.7
2023-04-22 15:43:53,252 - Detection -   train_loss = 0.47775210001889395
2023-04-22 15:44:25,477 - Detection - ***** Epoch: 18: Eval results *****
2023-04-22 15:44:25,477 - Detection -   best_eval_score = 84.39
2023-04-22 15:44:25,477 - Detection -   eval_score = 83.7
2023-04-22 15:44:25,477 - Detection -   train_loss = 0.45295725324574637
2023-04-22 15:44:57,776 - Detection - ***** Epoch: 19: Eval results *****
2023-04-22 15:44:57,776 - Detection -   best_eval_score = 84.39
2023-04-22 15:44:57,776 - Detection -   eval_score = 83.12
2023-04-22 15:44:57,776 - Detection -   train_loss = 0.4350866640315336
2023-04-22 15:45:33,055 - Detection - ***** Epoch: 20: Eval results *****
2023-04-22 15:45:33,055 - Detection -   best_eval_score = 84.39
2023-04-22 15:45:33,055 - Detection -   eval_score = 82.69
2023-04-22 15:45:33,055 - Detection -   train_loss = 0.42601287540267496
2023-04-22 15:46:05,614 - Detection - ***** Epoch: 21: Eval results *****
2023-04-22 15:46:05,614 - Detection -   best_eval_score = 84.39
2023-04-22 15:46:05,614 - Detection -   eval_score = 83.27
2023-04-22 15:46:05,614 - Detection -   train_loss = 0.42304695704404044
2023-04-22 15:46:37,942 - Detection - ***** Epoch: 22: Eval results *****
2023-04-22 15:46:37,942 - Detection -   best_eval_score = 84.39
2023-04-22 15:46:37,942 - Detection -   eval_score = 83.07
2023-04-22 15:46:37,942 - Detection -   train_loss = 0.39114899495068717
2023-04-22 15:46:37,943 - Detection - Pre-training finished...
2023-04-22 15:46:37,943 - Detection - Training Begin...
2023-04-22 15:46:40,736 - Detection - ***** Epoch: 1: Eval results *****
2023-04-22 15:46:40,736 - Detection -   best_eval_score = 0
2023-04-22 15:46:40,736 - Detection -   eval_score = 0.0
2023-04-22 15:46:40,736 - Detection -   train_loss = 4.706309809404261
2023-04-22 15:46:43,537 - Detection - ***** Epoch: 2: Eval results *****
2023-04-22 15:46:43,537 - Detection -   best_eval_score = 0
2023-04-22 15:46:43,537 - Detection -   eval_score = 1.91
2023-04-22 15:46:43,537 - Detection -   train_loss = 4.229761109632604
2023-04-22 15:47:13,999 - Detection - ***** Epoch: 3: Eval results *****
2023-04-22 15:47:13,999 - Detection -   best_eval_score = 1.91
2023-04-22 15:47:13,999 - Detection -   eval_score = 71.96
2023-04-22 15:47:13,999 - Detection -   train_loss = 3.4974438302657185
2023-04-22 15:47:44,634 - Detection - ***** Epoch: 4: Eval results *****
2023-04-22 15:47:44,634 - Detection -   best_eval_score = 71.96
2023-04-22 15:47:44,634 - Detection -   eval_score = 72.46
2023-04-22 15:47:44,634 - Detection -   train_loss = 1.0477854504304773
2023-04-22 15:48:15,072 - Detection - ***** Epoch: 5: Eval results *****
2023-04-22 15:48:15,073 - Detection -   best_eval_score = 72.46
2023-04-22 15:48:15,073 - Detection -   eval_score = 72.16
2023-04-22 15:48:15,073 - Detection -   train_loss = 1.0609383512945736
2023-04-22 15:48:45,470 - Detection - ***** Epoch: 6: Eval results *****
2023-04-22 15:48:45,470 - Detection -   best_eval_score = 72.46
2023-04-22 15:48:45,470 - Detection -   eval_score = 72.17
2023-04-22 15:48:45,470 - Detection -   train_loss = 1.0588245146414812
2023-04-22 15:49:15,851 - Detection - ***** Epoch: 7: Eval results *****
2023-04-22 15:49:15,851 - Detection -   best_eval_score = 72.46
2023-04-22 15:49:15,851 - Detection -   eval_score = 71.1
2023-04-22 15:49:15,851 - Detection -   train_loss = 1.064704632057863
2023-04-22 15:49:46,317 - Detection - ***** Epoch: 8: Eval results *****
2023-04-22 15:49:46,317 - Detection -   best_eval_score = 72.46
2023-04-22 15:49:46,317 - Detection -   eval_score = 72.38
2023-04-22 15:49:46,317 - Detection -   train_loss = 1.106513871866114
2023-04-22 15:50:17,133 - Detection - ***** Epoch: 9: Eval results *****
2023-04-22 15:50:17,133 - Detection -   best_eval_score = 72.46
2023-04-22 15:50:17,133 - Detection -   eval_score = 72.84
2023-04-22 15:50:17,133 - Detection -   train_loss = 1.0616144748295055
2023-04-22 15:50:47,574 - Detection - ***** Epoch: 10: Eval results *****
2023-04-22 15:50:47,574 - Detection -   best_eval_score = 72.84
2023-04-22 15:50:47,574 - Detection -   eval_score = 72.08
2023-04-22 15:50:47,574 - Detection -   train_loss = 1.0757579908651465
2023-04-22 15:51:18,045 - Detection - ***** Epoch: 11: Eval results *****
2023-04-22 15:51:18,045 - Detection -   best_eval_score = 72.84
2023-04-22 15:51:18,045 - Detection -   eval_score = 72.09
2023-04-22 15:51:18,045 - Detection -   train_loss = 1.077117639429429
2023-04-22 15:51:48,373 - Detection - ***** Epoch: 12: Eval results *****
2023-04-22 15:51:48,373 - Detection -   best_eval_score = 72.84
2023-04-22 15:51:48,374 - Detection -   eval_score = 72.27
2023-04-22 15:51:48,374 - Detection -   train_loss = 1.0962278948110693
2023-04-22 15:52:18,781 - Detection - ***** Epoch: 13: Eval results *****
2023-04-22 15:52:18,781 - Detection -   best_eval_score = 72.84
2023-04-22 15:52:18,782 - Detection -   eval_score = 72.43
2023-04-22 15:52:18,782 - Detection -   train_loss = 1.0926046336398405
2023-04-22 15:52:49,318 - Detection - ***** Epoch: 14: Eval results *****
2023-04-22 15:52:49,318 - Detection -   best_eval_score = 72.84
2023-04-22 15:52:49,318 - Detection -   eval_score = 71.97
2023-04-22 15:52:49,318 - Detection -   train_loss = 1.0391503502340877
2023-04-22 15:53:19,805 - Detection - ***** Epoch: 15: Eval results *****
2023-04-22 15:53:19,805 - Detection -   best_eval_score = 72.84
2023-04-22 15:53:19,805 - Detection -   eval_score = 72.52
2023-04-22 15:53:19,805 - Detection -   train_loss = 1.0671833683462704
2023-04-22 15:53:50,382 - Detection - ***** Epoch: 16: Eval results *****
2023-04-22 15:53:50,382 - Detection -   best_eval_score = 72.84
2023-04-22 15:53:50,382 - Detection -   eval_score = 72.71
2023-04-22 15:53:50,382 - Detection -   train_loss = 1.0938130792449503
2023-04-22 15:54:20,881 - Detection - ***** Epoch: 17: Eval results *****
2023-04-22 15:54:20,881 - Detection -   best_eval_score = 72.84
2023-04-22 15:54:20,881 - Detection -   eval_score = 71.98
2023-04-22 15:54:20,881 - Detection -   train_loss = 1.110841551247765
2023-04-22 15:54:51,645 - Detection - ***** Epoch: 18: Eval results *****
2023-04-22 15:54:51,645 - Detection -   best_eval_score = 72.84
2023-04-22 15:54:51,645 - Detection -   eval_score = 72.22
2023-04-22 15:54:51,645 - Detection -   train_loss = 1.0539352613336899
2023-04-22 15:55:22,124 - Detection - ***** Epoch: 19: Eval results *****
2023-04-22 15:55:22,124 - Detection -   best_eval_score = 72.84
2023-04-22 15:55:22,124 - Detection -   eval_score = 71.63
2023-04-22 15:55:22,124 - Detection -   train_loss = 1.036771949599771
2023-04-22 15:55:22,124 - Detection - Training Finished...
2023-04-22 15:55:22,124 - Detection - Testing begin...
2023-04-22 15:55:24,546 - Detection - ***** Test: Confusion Matrix *****
2023-04-22 15:55:24,547 - Detection - [[ 74   0   0   0   0   1   6   0   0   0   0   0   0   0   0  43]
 [  0  72   0   0   2   0   4   0   0   1   0   0   0   0   0  60]
 [  0   0  81   1   2   0   0   0   0   0   0   0   1   0   0  85]
 [  0   0   1 107   2   0   0   0   0   1   0   0   0   2   1  35]
 [  0   0   1   0  92   0   0   0   0   0   0   0   0   0   0  35]
 [  0   0   0   0   0  67   1   3   0   0   0   0   0   0   0  80]
 [  0   0   0   0   0   0  73   0   0   0   0   0   0   0   0  49]
 [  0   0   0   0   1   2   0  84   0   1   0   1   0   0   0  39]
 [  0   0   0   0   0   0   0   0 124   0   0   0   0   5   0  42]
 [  0   0   1   0   1   0   0   0   0 109   0   0   0   1   3  78]
 [  0   0   0   0   0   0   0   0   0   0 107   0   0   0   1  24]
 [  0   0   1   0   0   0   3   0   0   0   0  75   0   0   0  48]
 [  0   0   1   0   1   0   0   0   0   0   0   0 113   0   0  22]
 [  0   0   1   0   0   0   0   0   1   3   0   0   0  45   0  56]
 [  0   0   0   0   0   0   1   0   0   0   0   0   0   0 155  16]
 [ 12   0  11   0   0   0  86   1   4  75   0   6   2  32   3 524]]
2023-04-22 15:55:24,547 - Detection - ***** Test results *****
2023-04-22 15:55:24,547 - Detection -   Acc = 65.47
2023-04-22 15:55:24,547 - Detection -   F1 = 70.8135
2023-04-22 15:55:24,547 - Detection -   F1-known = 72.027
2023-04-22 15:55:24,547 - Detection -   F1-open = 52.6104
2023-04-22 15:55:24,547 - Detection - Testing finished...
2023-04-22 15:55:24,547 - Detection - Results saved in results/results_DA-ADB-BOOST.csv
2023-04-22 15:55:24,566 - Detection - Open Intent Detection Finished...
