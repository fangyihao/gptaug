2023-04-21 15:55:56,418 - Detection - Open Intent Detection Begin...
2023-04-21 15:55:56,418 - Detection - Parameters Initialization...
2023-04-21 15:55:56,419 - Detection - ============================== Params ==============================
2023-04-21 15:55:56,419 - Detection - type:	open_intent_detection
2023-04-21 15:55:56,419 - Detection - logger_name:	Detection
2023-04-21 15:55:56,419 - Detection - log_dir:	logs
2023-04-21 15:55:56,419 - Detection - dataset:	oos_cg
2023-04-21 15:55:56,419 - Detection - known_cls_ratio:	0.25
2023-04-21 15:55:56,419 - Detection - labeled_ratio:	1.0
2023-04-21 15:55:56,419 - Detection - method:	DA-ADB
2023-04-21 15:55:56,419 - Detection - train:	True
2023-04-21 15:55:56,419 - Detection - pretrain:	True
2023-04-21 15:55:56,419 - Detection - save_model:	False
2023-04-21 15:55:56,419 - Detection - backbone:	bert_disaware_boost
2023-04-21 15:55:56,419 - Detection - config_file_name:	DA-ADB
2023-04-21 15:55:56,419 - Detection - seed:	9
2023-04-21 15:55:56,419 - Detection - gpu_id:	0
2023-04-21 15:55:56,419 - Detection - pipe_results_path:	pipe_results
2023-04-21 15:55:56,419 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-21 15:55:56,419 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-21 15:55:56,419 - Detection - model_dir:	models
2023-04-21 15:55:56,419 - Detection - load_pretrained_method:	None
2023-04-21 15:55:56,419 - Detection - result_dir:	results
2023-04-21 15:55:56,419 - Detection - results_file_name:	results_DA-ADB-BOOST.csv
2023-04-21 15:55:56,419 - Detection - save_results:	True
2023-04-21 15:55:56,419 - Detection - loss_fct:	CrossEntropyLoss
2023-04-21 15:55:56,419 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_oos_cg_0.25_1.0_bert_disaware_boost_9
2023-04-21 15:55:56,419 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_oos_cg_0.25_1.0_bert_disaware_boost_9/models
2023-04-21 15:55:56,419 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-21 15:55:56,419 - Detection - num_train_epochs:	100
2023-04-21 15:55:56,419 - Detection - num_labels:	None
2023-04-21 15:55:56,419 - Detection - max_seq_length:	None
2023-04-21 15:55:56,419 - Detection - freeze_backbone_parameters:	True
2023-04-21 15:55:56,419 - Detection - feat_dim:	768
2023-04-21 15:55:56,419 - Detection - warmup_proportion:	0.1
2023-04-21 15:55:56,419 - Detection - scale:	4
2023-04-21 15:55:56,419 - Detection - lr_boundary:	0.05
2023-04-21 15:55:56,419 - Detection - lr:	2e-05
2023-04-21 15:55:56,419 - Detection - activation:	relu
2023-04-21 15:55:56,419 - Detection - train_batch_size:	128
2023-04-21 15:55:56,419 - Detection - eval_batch_size:	64
2023-04-21 15:55:56,419 - Detection - test_batch_size:	64
2023-04-21 15:55:56,419 - Detection - wait_patient:	10
2023-04-21 15:55:56,419 - Detection - ============================== End Params ==============================
2023-04-21 15:55:56,419 - Detection - Data and Model Preparation...
2023-04-21 15:55:56,420 - Detection - The number of known intents is 38
2023-04-21 15:55:56,420 - Detection - Lists of known labels are: ['uber', 'pto_request_status', 'where_are_you_from', 'who_do_you_work_for', 'international_fees', 'distance', 'confirm_reservation', 'application_status', 'next_song', 'book_flight', 'change_volume', 'new_card', 'report_fraud', 'reminder', 'exchange_rate', 'order_checks', 'current_location', 'ingredient_substitution', 'restaurant_reservation', 'gas', 'credit_limit', 'cook_time', 'shopping_list', 'change_accent', 'tell_joke', 'pto_request', 'flip_coin', 'what_song', 'bill_due', 'user_name', 'shopping_list_update', 'vaccines', 'change_speed', 'meal_suggestion', 'oil_change_when', 'order_status', 'no', 'freeze_account']
2023-04-21 15:55:56,429 - Detection - Number of labeled training samples = 903
2023-04-21 15:55:56,429 - Detection - Number of unlabeled training samples = 2780
2023-04-21 15:55:56,433 - Detection - Number of evaluation samples = 433
2023-04-21 15:55:56,440 - Detection - Number of testing samples = 3632
2023-04-21 15:56:01,934 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-21 15:56:02,017 - Detection - Pre-training Begin...
2023-04-21 15:56:03,868 - Detection - ***** Epoch: 1: Eval results *****
2023-04-21 15:56:03,868 - Detection -   best_eval_score = 0
2023-04-21 15:56:03,868 - Detection -   eval_score = 0.49
2023-04-21 15:56:03,868 - Detection -   train_loss = 3.627244919538498
2023-04-21 15:56:14,701 - Detection - ***** Epoch: 2: Eval results *****
2023-04-21 15:56:14,701 - Detection -   best_eval_score = 0.49
2023-04-21 15:56:14,701 - Detection -   eval_score = 1.97
2023-04-21 15:56:14,701 - Detection -   train_loss = 3.612754166126251
2023-04-21 15:56:25,425 - Detection - ***** Epoch: 3: Eval results *****
2023-04-21 15:56:25,425 - Detection -   best_eval_score = 1.97
2023-04-21 15:56:25,425 - Detection -   eval_score = 6.57
2023-04-21 15:56:25,425 - Detection -   train_loss = 3.4242287278175354
2023-04-21 15:56:36,319 - Detection - ***** Epoch: 4: Eval results *****
2023-04-21 15:56:36,319 - Detection -   best_eval_score = 6.57
2023-04-21 15:56:36,319 - Detection -   eval_score = 25.04
2023-04-21 15:56:36,319 - Detection -   train_loss = 3.0647830963134766
2023-04-21 15:56:47,166 - Detection - ***** Epoch: 5: Eval results *****
2023-04-21 15:56:47,167 - Detection -   best_eval_score = 25.04
2023-04-21 15:56:47,167 - Detection -   eval_score = 48.61
2023-04-21 15:56:47,167 - Detection -   train_loss = 2.616276890039444
2023-04-21 15:56:57,877 - Detection - ***** Epoch: 6: Eval results *****
2023-04-21 15:56:57,878 - Detection -   best_eval_score = 48.61
2023-04-21 15:56:57,878 - Detection -   eval_score = 60.27
2023-04-21 15:56:57,878 - Detection -   train_loss = 2.146601125597954
2023-04-21 15:57:08,704 - Detection - ***** Epoch: 7: Eval results *****
2023-04-21 15:57:08,704 - Detection -   best_eval_score = 60.27
2023-04-21 15:57:08,704 - Detection -   eval_score = 69.57
2023-04-21 15:57:08,704 - Detection -   train_loss = 1.785116270184517
2023-04-21 15:57:19,535 - Detection - ***** Epoch: 8: Eval results *****
2023-04-21 15:57:19,535 - Detection -   best_eval_score = 69.57
2023-04-21 15:57:19,535 - Detection -   eval_score = 71.35
2023-04-21 15:57:19,535 - Detection -   train_loss = 1.5187553316354752
2023-04-21 15:57:30,433 - Detection - ***** Epoch: 9: Eval results *****
2023-04-21 15:57:30,434 - Detection -   best_eval_score = 71.35
2023-04-21 15:57:30,434 - Detection -   eval_score = 75.22
2023-04-21 15:57:30,434 - Detection -   train_loss = 1.3512770384550095
2023-04-21 15:57:41,204 - Detection - ***** Epoch: 10: Eval results *****
2023-04-21 15:57:41,204 - Detection -   best_eval_score = 75.22
2023-04-21 15:57:41,204 - Detection -   eval_score = 77.38
2023-04-21 15:57:41,204 - Detection -   train_loss = 1.221031978726387
2023-04-21 15:57:51,990 - Detection - ***** Epoch: 11: Eval results *****
2023-04-21 15:57:51,991 - Detection -   best_eval_score = 77.38
2023-04-21 15:57:51,991 - Detection -   eval_score = 79.47
2023-04-21 15:57:51,991 - Detection -   train_loss = 1.1466561406850815
2023-04-21 15:58:02,658 - Detection - ***** Epoch: 12: Eval results *****
2023-04-21 15:58:02,658 - Detection -   best_eval_score = 79.47
2023-04-21 15:58:02,658 - Detection -   eval_score = 81.43
2023-04-21 15:58:02,658 - Detection -   train_loss = 1.0818521454930305
2023-04-21 15:58:13,478 - Detection - ***** Epoch: 13: Eval results *****
2023-04-21 15:58:13,478 - Detection -   best_eval_score = 81.43
2023-04-21 15:58:13,478 - Detection -   eval_score = 81.16
2023-04-21 15:58:13,478 - Detection -   train_loss = 1.0554336905479431
2023-04-21 15:58:24,300 - Detection - ***** Epoch: 14: Eval results *****
2023-04-21 15:58:24,300 - Detection -   best_eval_score = 81.43
2023-04-21 15:58:24,300 - Detection -   eval_score = 82.34
2023-04-21 15:58:24,300 - Detection -   train_loss = 1.0226774886250496
2023-04-21 15:58:35,025 - Detection - ***** Epoch: 15: Eval results *****
2023-04-21 15:58:35,025 - Detection -   best_eval_score = 82.34
2023-04-21 15:58:35,025 - Detection -   eval_score = 82.0
2023-04-21 15:58:35,025 - Detection -   train_loss = 0.9675432965159416
2023-04-21 15:58:45,796 - Detection - ***** Epoch: 16: Eval results *****
2023-04-21 15:58:45,796 - Detection -   best_eval_score = 82.34
2023-04-21 15:58:45,796 - Detection -   eval_score = 82.46
2023-04-21 15:58:45,796 - Detection -   train_loss = 0.940599799156189
2023-04-21 15:58:56,627 - Detection - ***** Epoch: 17: Eval results *****
2023-04-21 15:58:56,627 - Detection -   best_eval_score = 82.46
2023-04-21 15:58:56,627 - Detection -   eval_score = 82.1
2023-04-21 15:58:56,627 - Detection -   train_loss = 0.9117414653301239
2023-04-21 15:59:07,400 - Detection - ***** Epoch: 18: Eval results *****
2023-04-21 15:59:07,400 - Detection -   best_eval_score = 82.46
2023-04-21 15:59:07,400 - Detection -   eval_score = 82.64
2023-04-21 15:59:07,400 - Detection -   train_loss = 0.9116974771022797
2023-04-21 15:59:18,287 - Detection - ***** Epoch: 19: Eval results *****
2023-04-21 15:59:18,287 - Detection -   best_eval_score = 82.64
2023-04-21 15:59:18,287 - Detection -   eval_score = 83.33
2023-04-21 15:59:18,287 - Detection -   train_loss = 0.8993905410170555
2023-04-21 15:59:29,213 - Detection - ***** Epoch: 20: Eval results *****
2023-04-21 15:59:29,213 - Detection -   best_eval_score = 83.33
2023-04-21 15:59:29,213 - Detection -   eval_score = 82.3
2023-04-21 15:59:29,213 - Detection -   train_loss = 0.8761398121714592
2023-04-21 15:59:39,937 - Detection - ***** Epoch: 21: Eval results *****
2023-04-21 15:59:39,938 - Detection -   best_eval_score = 83.33
2023-04-21 15:59:39,938 - Detection -   eval_score = 83.19
2023-04-21 15:59:39,938 - Detection -   train_loss = 0.8510825410485268
2023-04-21 15:59:50,772 - Detection - ***** Epoch: 22: Eval results *****
2023-04-21 15:59:50,772 - Detection -   best_eval_score = 83.33
2023-04-21 15:59:50,772 - Detection -   eval_score = 82.8
2023-04-21 15:59:50,772 - Detection -   train_loss = 0.8410708531737328
2023-04-21 16:00:01,625 - Detection - ***** Epoch: 23: Eval results *****
2023-04-21 16:00:01,625 - Detection -   best_eval_score = 83.33
2023-04-21 16:00:01,625 - Detection -   eval_score = 82.75
2023-04-21 16:00:01,625 - Detection -   train_loss = 0.8271589279174805
2023-04-21 16:00:12,315 - Detection - ***** Epoch: 24: Eval results *****
2023-04-21 16:00:12,315 - Detection -   best_eval_score = 83.33
2023-04-21 16:00:12,315 - Detection -   eval_score = 83.13
2023-04-21 16:00:12,315 - Detection -   train_loss = 0.8221547231078148
2023-04-21 16:00:23,096 - Detection - ***** Epoch: 25: Eval results *****
2023-04-21 16:00:23,096 - Detection -   best_eval_score = 83.33
2023-04-21 16:00:23,096 - Detection -   eval_score = 83.07
2023-04-21 16:00:23,096 - Detection -   train_loss = 0.8043201267719269
2023-04-21 16:00:33,935 - Detection - ***** Epoch: 26: Eval results *****
2023-04-21 16:00:33,935 - Detection -   best_eval_score = 83.33
2023-04-21 16:00:33,935 - Detection -   eval_score = 82.52
2023-04-21 16:00:33,935 - Detection -   train_loss = 0.7983116507530212
2023-04-21 16:00:44,625 - Detection - ***** Epoch: 27: Eval results *****
2023-04-21 16:00:44,625 - Detection -   best_eval_score = 83.33
2023-04-21 16:00:44,625 - Detection -   eval_score = 82.63
2023-04-21 16:00:44,625 - Detection -   train_loss = 0.7941529676318169
2023-04-21 16:00:55,475 - Detection - ***** Epoch: 28: Eval results *****
2023-04-21 16:00:55,475 - Detection -   best_eval_score = 83.33
2023-04-21 16:00:55,475 - Detection -   eval_score = 82.52
2023-04-21 16:00:55,475 - Detection -   train_loss = 0.7863508760929108
2023-04-21 16:01:06,406 - Detection - ***** Epoch: 29: Eval results *****
2023-04-21 16:01:06,407 - Detection -   best_eval_score = 83.33
2023-04-21 16:01:06,407 - Detection -   eval_score = 82.62
2023-04-21 16:01:06,407 - Detection -   train_loss = 0.7838718444108963
2023-04-21 16:01:06,407 - Detection - Pre-training finished...
2023-04-21 16:01:06,407 - Detection - Training Begin...
2023-04-21 16:01:07,237 - Detection - ***** Epoch: 1: Eval results *****
2023-04-21 16:01:07,237 - Detection -   best_eval_score = 0
2023-04-21 16:01:07,238 - Detection -   eval_score = 2.85
2023-04-21 16:01:07,238 - Detection -   train_loss = 2.75952011346817
2023-04-21 16:01:17,295 - Detection - ***** Epoch: 2: Eval results *****
2023-04-21 16:01:17,295 - Detection -   best_eval_score = 2.85
2023-04-21 16:01:17,295 - Detection -   eval_score = 49.5
2023-04-21 16:01:17,295 - Detection -   train_loss = 2.6230464577674866
2023-04-21 16:01:27,470 - Detection - ***** Epoch: 3: Eval results *****
2023-04-21 16:01:27,470 - Detection -   best_eval_score = 49.5
2023-04-21 16:01:27,470 - Detection -   eval_score = 49.87
2023-04-21 16:01:27,470 - Detection -   train_loss = 0.4706236571073532
2023-04-21 16:01:37,679 - Detection - ***** Epoch: 4: Eval results *****
2023-04-21 16:01:37,679 - Detection -   best_eval_score = 49.87
2023-04-21 16:01:37,679 - Detection -   eval_score = 51.24
2023-04-21 16:01:37,679 - Detection -   train_loss = 0.4097767062485218
2023-04-21 16:01:47,734 - Detection - ***** Epoch: 5: Eval results *****
2023-04-21 16:01:47,735 - Detection -   best_eval_score = 51.24
2023-04-21 16:01:47,735 - Detection -   eval_score = 50.97
2023-04-21 16:01:47,735 - Detection -   train_loss = 0.38837409391999245
2023-04-21 16:01:57,913 - Detection - ***** Epoch: 6: Eval results *****
2023-04-21 16:01:57,913 - Detection -   best_eval_score = 51.24
2023-04-21 16:01:57,913 - Detection -   eval_score = 50.51
2023-04-21 16:01:57,913 - Detection -   train_loss = 0.39801499620079994
2023-04-21 16:02:08,119 - Detection - ***** Epoch: 7: Eval results *****
2023-04-21 16:02:08,119 - Detection -   best_eval_score = 51.24
2023-04-21 16:02:08,119 - Detection -   eval_score = 50.84
2023-04-21 16:02:08,119 - Detection -   train_loss = 0.4053526222705841
2023-04-21 16:02:18,441 - Detection - ***** Epoch: 8: Eval results *****
2023-04-21 16:02:18,441 - Detection -   best_eval_score = 51.24
2023-04-21 16:02:18,441 - Detection -   eval_score = 50.81
2023-04-21 16:02:18,441 - Detection -   train_loss = 0.425088070333004
2023-04-21 16:02:28,633 - Detection - ***** Epoch: 9: Eval results *****
2023-04-21 16:02:28,633 - Detection -   best_eval_score = 51.24
2023-04-21 16:02:28,633 - Detection -   eval_score = 50.44
2023-04-21 16:02:28,633 - Detection -   train_loss = 0.42988666519522667
2023-04-21 16:02:38,701 - Detection - ***** Epoch: 10: Eval results *****
2023-04-21 16:02:38,701 - Detection -   best_eval_score = 51.24
2023-04-21 16:02:38,701 - Detection -   eval_score = 51.23
2023-04-21 16:02:38,701 - Detection -   train_loss = 0.421954158693552
2023-04-21 16:02:48,888 - Detection - ***** Epoch: 11: Eval results *****
2023-04-21 16:02:48,888 - Detection -   best_eval_score = 51.24
2023-04-21 16:02:48,888 - Detection -   eval_score = 51.63
2023-04-21 16:02:48,888 - Detection -   train_loss = 0.42166484892368317
2023-04-21 16:02:59,078 - Detection - ***** Epoch: 12: Eval results *****
2023-04-21 16:02:59,078 - Detection -   best_eval_score = 51.63
2023-04-21 16:02:59,078 - Detection -   eval_score = 51.11
2023-04-21 16:02:59,078 - Detection -   train_loss = 0.3932429440319538
2023-04-21 16:03:09,179 - Detection - ***** Epoch: 13: Eval results *****
2023-04-21 16:03:09,179 - Detection -   best_eval_score = 51.63
2023-04-21 16:03:09,179 - Detection -   eval_score = 51.01
2023-04-21 16:03:09,179 - Detection -   train_loss = 0.43065357208251953
2023-04-21 16:03:19,505 - Detection - ***** Epoch: 14: Eval results *****
2023-04-21 16:03:19,505 - Detection -   best_eval_score = 51.63
2023-04-21 16:03:19,505 - Detection -   eval_score = 50.7
2023-04-21 16:03:19,505 - Detection -   train_loss = 0.41638072207570076
2023-04-21 16:03:29,698 - Detection - ***** Epoch: 15: Eval results *****
2023-04-21 16:03:29,698 - Detection -   best_eval_score = 51.63
2023-04-21 16:03:29,698 - Detection -   eval_score = 51.46
2023-04-21 16:03:29,698 - Detection -   train_loss = 0.4158237650990486
2023-04-21 16:03:39,839 - Detection - ***** Epoch: 16: Eval results *****
2023-04-21 16:03:39,839 - Detection -   best_eval_score = 51.63
2023-04-21 16:03:39,839 - Detection -   eval_score = 51.16
2023-04-21 16:03:39,839 - Detection -   train_loss = 0.4358174577355385
2023-04-21 16:03:50,109 - Detection - ***** Epoch: 17: Eval results *****
2023-04-21 16:03:50,110 - Detection -   best_eval_score = 51.63
2023-04-21 16:03:50,110 - Detection -   eval_score = 50.87
2023-04-21 16:03:50,110 - Detection -   train_loss = 0.41322312876582146
2023-04-21 16:04:00,329 - Detection - ***** Epoch: 18: Eval results *****
2023-04-21 16:04:00,329 - Detection -   best_eval_score = 51.63
2023-04-21 16:04:00,329 - Detection -   eval_score = 49.87
2023-04-21 16:04:00,329 - Detection -   train_loss = 0.42683907598257065
2023-04-21 16:04:10,413 - Detection - ***** Epoch: 19: Eval results *****
2023-04-21 16:04:10,413 - Detection -   best_eval_score = 51.63
2023-04-21 16:04:10,413 - Detection -   eval_score = 50.67
2023-04-21 16:04:10,413 - Detection -   train_loss = 0.3956793546676636
2023-04-21 16:04:20,687 - Detection - ***** Epoch: 20: Eval results *****
2023-04-21 16:04:20,687 - Detection -   best_eval_score = 51.63
2023-04-21 16:04:20,687 - Detection -   eval_score = 51.19
2023-04-21 16:04:20,687 - Detection -   train_loss = 0.4412599727511406
2023-04-21 16:04:30,878 - Detection - ***** Epoch: 21: Eval results *****
2023-04-21 16:04:30,878 - Detection -   best_eval_score = 51.63
2023-04-21 16:04:30,878 - Detection -   eval_score = 50.97
2023-04-21 16:04:30,878 - Detection -   train_loss = 0.41582855209708214
2023-04-21 16:04:30,878 - Detection - Training Finished...
2023-04-21 16:04:30,878 - Detection - Testing begin...
2023-04-21 16:04:32,936 - Detection - ***** Test: Confusion Matrix *****
2023-04-21 16:04:32,936 - Detection - [[  11    0    0 ...    0    0    9]
 [   0    4    0 ...    0    0   11]
 [   0    0   12 ...    0    0    9]
 ...
 [   0    0    0 ...   12    0   11]
 [   0    0    0 ...    0    7    2]
 [   1    3    4 ...    6   11 2907]]
2023-04-21 16:04:32,936 - Detection - ***** Test results *****
2023-04-21 16:04:32,936 - Detection -   Acc = 87.0
2023-04-21 16:04:32,936 - Detection -   F1 = 48.0831
2023-04-21 16:04:32,936 - Detection -   F1-known = 46.9133
2023-04-21 16:04:32,936 - Detection -   F1-open = 92.5354
2023-04-21 16:04:32,936 - Detection - Testing finished...
2023-04-21 16:04:32,937 - Detection - Results saved in results/results_DA-ADB-BOOST.csv
2023-04-21 16:04:32,957 - Detection - Open Intent Detection Finished...
