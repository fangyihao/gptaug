2023-04-22 13:00:45,746 - Detection - Open Intent Detection Begin...
2023-04-22 13:00:45,746 - Detection - Parameters Initialization...
2023-04-22 13:00:45,746 - Detection - ============================== Params ==============================
2023-04-22 13:00:45,747 - Detection - type:	open_intent_detection
2023-04-22 13:00:45,747 - Detection - logger_name:	Detection
2023-04-22 13:00:45,747 - Detection - log_dir:	logs
2023-04-22 13:00:45,747 - Detection - dataset:	stackoverflow_cg
2023-04-22 13:00:45,747 - Detection - known_cls_ratio:	0.5
2023-04-22 13:00:45,747 - Detection - labeled_ratio:	1.0
2023-04-22 13:00:45,747 - Detection - method:	DA-ADB
2023-04-22 13:00:45,747 - Detection - train:	True
2023-04-22 13:00:45,747 - Detection - pretrain:	True
2023-04-22 13:00:45,747 - Detection - save_model:	False
2023-04-22 13:00:45,747 - Detection - backbone:	bert_disaware_boost
2023-04-22 13:00:45,747 - Detection - config_file_name:	DA-ADB
2023-04-22 13:00:45,747 - Detection - seed:	6
2023-04-22 13:00:45,747 - Detection - gpu_id:	0
2023-04-22 13:00:45,747 - Detection - pipe_results_path:	pipe_results
2023-04-22 13:00:45,747 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-22 13:00:45,747 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-22 13:00:45,747 - Detection - model_dir:	models
2023-04-22 13:00:45,747 - Detection - load_pretrained_method:	None
2023-04-22 13:00:45,747 - Detection - result_dir:	results
2023-04-22 13:00:45,747 - Detection - results_file_name:	results_DA-ADB-BOOST.csv
2023-04-22 13:00:45,747 - Detection - save_results:	True
2023-04-22 13:00:45,747 - Detection - loss_fct:	CrossEntropyLoss
2023-04-22 13:00:45,747 - Detection - boost_method:	F-10
2023-04-22 13:00:45,747 - Detection - boost_start_score:	0.0
2023-04-22 13:00:45,747 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.5_1.0_bert_disaware_boost_6
2023-04-22 13:00:45,747 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.5_1.0_bert_disaware_boost_6/models
2023-04-22 13:00:45,747 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-22 13:00:45,747 - Detection - num_train_epochs:	100
2023-04-22 13:00:45,747 - Detection - num_labels:	None
2023-04-22 13:00:45,747 - Detection - max_seq_length:	None
2023-04-22 13:00:45,747 - Detection - freeze_backbone_parameters:	True
2023-04-22 13:00:45,747 - Detection - feat_dim:	768
2023-04-22 13:00:45,747 - Detection - warmup_proportion:	0.1
2023-04-22 13:00:45,747 - Detection - scale:	4
2023-04-22 13:00:45,747 - Detection - lr_boundary:	0.05
2023-04-22 13:00:45,747 - Detection - lr:	2e-05
2023-04-22 13:00:45,747 - Detection - activation:	relu
2023-04-22 13:00:45,747 - Detection - train_batch_size:	128
2023-04-22 13:00:45,747 - Detection - eval_batch_size:	64
2023-04-22 13:00:45,747 - Detection - test_batch_size:	64
2023-04-22 13:00:45,747 - Detection - wait_patient:	10
2023-04-22 13:00:45,747 - Detection - ============================== End Params ==============================
2023-04-22 13:00:45,747 - Detection - Data and Model Preparation...
2023-04-22 13:00:45,748 - Detection - The number of known intents is 10
2023-04-22 13:00:45,748 - Detection - Lists of known labels are: ['svn', 'hibernate', 'excel', 'haskell', 'linq', 'bash', 'sharepoint', 'scala', 'drupal', 'oracle']
2023-04-22 13:00:45,756 - Detection - Number of labeled training samples = 1218
2023-04-22 13:00:45,756 - Detection - Number of unlabeled training samples = 1573
2023-04-22 13:00:45,758 - Detection - Number of evaluation samples = 722
2023-04-22 13:00:45,764 - Detection - Number of testing samples = 2905
2023-04-22 13:00:51,343 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-22 13:00:51,426 - Detection - Pre-training Begin...
2023-04-22 13:00:54,647 - Detection - ***** Epoch: 1: Eval results *****
2023-04-22 13:00:54,647 - Detection -   best_eval_score = 0
2023-04-22 13:00:54,647 - Detection -   eval_score = 4.0
2023-04-22 13:00:54,647 - Detection -   train_loss = 2.2985496044158937
2023-04-22 13:01:13,929 - Detection - ***** Epoch: 2: Eval results *****
2023-04-22 13:01:13,930 - Detection -   best_eval_score = 4.0
2023-04-22 13:01:13,930 - Detection -   eval_score = 8.94
2023-04-22 13:01:13,930 - Detection -   train_loss = 2.29116747379303
2023-04-22 13:01:33,334 - Detection - ***** Epoch: 3: Eval results *****
2023-04-22 13:01:33,334 - Detection -   best_eval_score = 8.94
2023-04-22 13:01:33,334 - Detection -   eval_score = 51.82
2023-04-22 13:01:33,335 - Detection -   train_loss = 2.1921928405761717
2023-04-22 13:01:52,650 - Detection - ***** Epoch: 4: Eval results *****
2023-04-22 13:01:52,650 - Detection -   best_eval_score = 51.82
2023-04-22 13:01:52,650 - Detection -   eval_score = 80.86
2023-04-22 13:01:52,651 - Detection -   train_loss = 1.9085764169692994
2023-04-22 13:02:12,083 - Detection - ***** Epoch: 5: Eval results *****
2023-04-22 13:02:12,084 - Detection -   best_eval_score = 80.86
2023-04-22 13:02:12,084 - Detection -   eval_score = 83.25
2023-04-22 13:02:12,084 - Detection -   train_loss = 1.4308739185333252
2023-04-22 13:02:31,479 - Detection - ***** Epoch: 6: Eval results *****
2023-04-22 13:02:31,479 - Detection -   best_eval_score = 83.25
2023-04-22 13:02:31,479 - Detection -   eval_score = 84.77
2023-04-22 13:02:31,479 - Detection -   train_loss = 1.066405987739563
2023-04-22 13:02:51,193 - Detection - ***** Epoch: 7: Eval results *****
2023-04-22 13:02:51,193 - Detection -   best_eval_score = 84.77
2023-04-22 13:02:51,193 - Detection -   eval_score = 86.19
2023-04-22 13:02:51,193 - Detection -   train_loss = 0.8767404854297638
2023-04-22 13:03:10,510 - Detection - ***** Epoch: 8: Eval results *****
2023-04-22 13:03:10,510 - Detection -   best_eval_score = 86.19
2023-04-22 13:03:10,510 - Detection -   eval_score = 85.91
2023-04-22 13:03:10,510 - Detection -   train_loss = 0.7252325356006623
2023-04-22 13:03:29,859 - Detection - ***** Epoch: 9: Eval results *****
2023-04-22 13:03:29,859 - Detection -   best_eval_score = 86.19
2023-04-22 13:03:29,859 - Detection -   eval_score = 84.87
2023-04-22 13:03:29,859 - Detection -   train_loss = 0.6313969194889069
2023-04-22 13:03:49,306 - Detection - ***** Epoch: 10: Eval results *****
2023-04-22 13:03:49,306 - Detection -   best_eval_score = 86.19
2023-04-22 13:03:49,306 - Detection -   eval_score = 85.49
2023-04-22 13:03:49,306 - Detection -   train_loss = 0.5590689659118653
2023-04-22 13:04:08,509 - Detection - ***** Epoch: 11: Eval results *****
2023-04-22 13:04:08,509 - Detection -   best_eval_score = 86.19
2023-04-22 13:04:08,509 - Detection -   eval_score = 86.05
2023-04-22 13:04:08,509 - Detection -   train_loss = 0.47771543860435484
2023-04-22 13:04:27,936 - Detection - ***** Epoch: 12: Eval results *****
2023-04-22 13:04:27,936 - Detection -   best_eval_score = 86.19
2023-04-22 13:04:27,936 - Detection -   eval_score = 86.16
2023-04-22 13:04:27,936 - Detection -   train_loss = 0.42313219606876373
2023-04-22 13:04:47,264 - Detection - ***** Epoch: 13: Eval results *****
2023-04-22 13:04:47,264 - Detection -   best_eval_score = 86.19
2023-04-22 13:04:47,264 - Detection -   eval_score = 86.61
2023-04-22 13:04:47,264 - Detection -   train_loss = 0.3935168296098709
2023-04-22 13:05:06,560 - Detection - ***** Epoch: 14: Eval results *****
2023-04-22 13:05:06,560 - Detection -   best_eval_score = 86.61
2023-04-22 13:05:06,560 - Detection -   eval_score = 86.53
2023-04-22 13:05:06,560 - Detection -   train_loss = 0.36173600852489474
2023-04-22 13:05:25,891 - Detection - ***** Epoch: 15: Eval results *****
2023-04-22 13:05:25,892 - Detection -   best_eval_score = 86.61
2023-04-22 13:05:25,892 - Detection -   eval_score = 87.24
2023-04-22 13:05:25,892 - Detection -   train_loss = 0.34694614112377165
2023-04-22 13:05:45,086 - Detection - ***** Epoch: 16: Eval results *****
2023-04-22 13:05:45,086 - Detection -   best_eval_score = 87.24
2023-04-22 13:05:45,086 - Detection -   eval_score = 86.54
2023-04-22 13:05:45,086 - Detection -   train_loss = 0.3200178205966949
2023-04-22 13:06:04,472 - Detection - ***** Epoch: 17: Eval results *****
2023-04-22 13:06:04,472 - Detection -   best_eval_score = 87.24
2023-04-22 13:06:04,472 - Detection -   eval_score = 85.81
2023-04-22 13:06:04,472 - Detection -   train_loss = 0.28703798055648805
2023-04-22 13:06:23,884 - Detection - ***** Epoch: 18: Eval results *****
2023-04-22 13:06:23,884 - Detection -   best_eval_score = 87.24
2023-04-22 13:06:23,884 - Detection -   eval_score = 86.31
2023-04-22 13:06:23,884 - Detection -   train_loss = 0.2745312064886093
2023-04-22 13:06:43,283 - Detection - ***** Epoch: 19: Eval results *****
2023-04-22 13:06:43,283 - Detection -   best_eval_score = 87.24
2023-04-22 13:06:43,283 - Detection -   eval_score = 85.82
2023-04-22 13:06:43,283 - Detection -   train_loss = 0.26399985402822496
2023-04-22 13:07:02,635 - Detection - ***** Epoch: 20: Eval results *****
2023-04-22 13:07:02,635 - Detection -   best_eval_score = 87.24
2023-04-22 13:07:02,635 - Detection -   eval_score = 86.47
2023-04-22 13:07:02,635 - Detection -   train_loss = 0.25136630684137345
2023-04-22 13:07:22,132 - Detection - ***** Epoch: 21: Eval results *****
2023-04-22 13:07:22,132 - Detection -   best_eval_score = 87.24
2023-04-22 13:07:22,132 - Detection -   eval_score = 85.65
2023-04-22 13:07:22,132 - Detection -   train_loss = 0.2459745779633522
2023-04-22 13:07:41,494 - Detection - ***** Epoch: 22: Eval results *****
2023-04-22 13:07:41,494 - Detection -   best_eval_score = 87.24
2023-04-22 13:07:41,494 - Detection -   eval_score = 85.4
2023-04-22 13:07:41,494 - Detection -   train_loss = 0.23289789408445358
2023-04-22 13:08:00,873 - Detection - ***** Epoch: 23: Eval results *****
2023-04-22 13:08:00,873 - Detection -   best_eval_score = 87.24
2023-04-22 13:08:00,873 - Detection -   eval_score = 85.95
2023-04-22 13:08:00,873 - Detection -   train_loss = 0.2319513350725174
2023-04-22 13:08:20,267 - Detection - ***** Epoch: 24: Eval results *****
2023-04-22 13:08:20,267 - Detection -   best_eval_score = 87.24
2023-04-22 13:08:20,268 - Detection -   eval_score = 85.52
2023-04-22 13:08:20,268 - Detection -   train_loss = 0.2214295119047165
2023-04-22 13:08:39,610 - Detection - ***** Epoch: 25: Eval results *****
2023-04-22 13:08:39,610 - Detection -   best_eval_score = 87.24
2023-04-22 13:08:39,610 - Detection -   eval_score = 86.57
2023-04-22 13:08:39,610 - Detection -   train_loss = 0.21913283467292785
2023-04-22 13:08:39,611 - Detection - Pre-training finished...
2023-04-22 13:08:39,611 - Detection - Training Begin...
2023-04-22 13:08:41,342 - Detection - ***** Epoch: 1: Eval results *****
2023-04-22 13:08:41,342 - Detection -   best_eval_score = 0
2023-04-22 13:08:41,342 - Detection -   eval_score = 0.26
2023-04-22 13:08:41,342 - Detection -   train_loss = 4.928950452804566
2023-04-22 13:08:59,423 - Detection - ***** Epoch: 2: Eval results *****
2023-04-22 13:08:59,423 - Detection -   best_eval_score = 0.26
2023-04-22 13:08:59,423 - Detection -   eval_score = 73.34
2023-04-22 13:08:59,423 - Detection -   train_loss = 4.617654132843017
2023-04-22 13:09:17,647 - Detection - ***** Epoch: 3: Eval results *****
2023-04-22 13:09:17,648 - Detection -   best_eval_score = 73.34
2023-04-22 13:09:17,648 - Detection -   eval_score = 73.81
2023-04-22 13:09:17,648 - Detection -   train_loss = 1.0471453011035918
2023-04-22 13:09:35,923 - Detection - ***** Epoch: 4: Eval results *****
2023-04-22 13:09:35,923 - Detection -   best_eval_score = 73.81
2023-04-22 13:09:35,923 - Detection -   eval_score = 73.91
2023-04-22 13:09:35,923 - Detection -   train_loss = 1.064566785097122
2023-04-22 13:09:54,237 - Detection - ***** Epoch: 5: Eval results *****
2023-04-22 13:09:54,237 - Detection -   best_eval_score = 73.91
2023-04-22 13:09:54,237 - Detection -   eval_score = 73.36
2023-04-22 13:09:54,237 - Detection -   train_loss = 1.0554460525512694
2023-04-22 13:10:12,450 - Detection - ***** Epoch: 6: Eval results *****
2023-04-22 13:10:12,450 - Detection -   best_eval_score = 73.91
2023-04-22 13:10:12,450 - Detection -   eval_score = 73.79
2023-04-22 13:10:12,450 - Detection -   train_loss = 1.078685361146927
2023-04-22 13:10:30,935 - Detection - ***** Epoch: 7: Eval results *****
2023-04-22 13:10:30,935 - Detection -   best_eval_score = 73.91
2023-04-22 13:10:30,935 - Detection -   eval_score = 74.1
2023-04-22 13:10:30,935 - Detection -   train_loss = 1.093539309501648
2023-04-22 13:10:49,328 - Detection - ***** Epoch: 8: Eval results *****
2023-04-22 13:10:49,329 - Detection -   best_eval_score = 74.1
2023-04-22 13:10:49,329 - Detection -   eval_score = 73.97
2023-04-22 13:10:49,329 - Detection -   train_loss = 1.0968801259994507
2023-04-22 13:11:07,395 - Detection - ***** Epoch: 9: Eval results *****
2023-04-22 13:11:07,395 - Detection -   best_eval_score = 74.1
2023-04-22 13:11:07,395 - Detection -   eval_score = 73.63
2023-04-22 13:11:07,395 - Detection -   train_loss = 1.0719771027565002
2023-04-22 13:11:25,595 - Detection - ***** Epoch: 10: Eval results *****
2023-04-22 13:11:25,595 - Detection -   best_eval_score = 74.1
2023-04-22 13:11:25,595 - Detection -   eval_score = 74.2
2023-04-22 13:11:25,595 - Detection -   train_loss = 1.0824297845363617
2023-04-22 13:11:43,814 - Detection - ***** Epoch: 11: Eval results *****
2023-04-22 13:11:43,814 - Detection -   best_eval_score = 74.2
2023-04-22 13:11:43,814 - Detection -   eval_score = 73.49
2023-04-22 13:11:43,814 - Detection -   train_loss = 1.0353602170944214
2023-04-22 13:12:02,064 - Detection - ***** Epoch: 12: Eval results *****
2023-04-22 13:12:02,064 - Detection -   best_eval_score = 74.2
2023-04-22 13:12:02,064 - Detection -   eval_score = 73.68
2023-04-22 13:12:02,064 - Detection -   train_loss = 1.0782415330410005
2023-04-22 13:12:20,162 - Detection - ***** Epoch: 13: Eval results *****
2023-04-22 13:12:20,162 - Detection -   best_eval_score = 74.2
2023-04-22 13:12:20,162 - Detection -   eval_score = 73.95
2023-04-22 13:12:20,162 - Detection -   train_loss = 1.0506215512752533
2023-04-22 13:12:38,391 - Detection - ***** Epoch: 14: Eval results *****
2023-04-22 13:12:38,391 - Detection -   best_eval_score = 74.2
2023-04-22 13:12:38,391 - Detection -   eval_score = 72.5
2023-04-22 13:12:38,391 - Detection -   train_loss = 1.0725557506084442
2023-04-22 13:12:56,582 - Detection - ***** Epoch: 15: Eval results *****
2023-04-22 13:12:56,582 - Detection -   best_eval_score = 74.2
2023-04-22 13:12:56,582 - Detection -   eval_score = 73.06
2023-04-22 13:12:56,582 - Detection -   train_loss = 1.107095229625702
2023-04-22 13:13:14,756 - Detection - ***** Epoch: 16: Eval results *****
2023-04-22 13:13:14,756 - Detection -   best_eval_score = 74.2
2023-04-22 13:13:14,756 - Detection -   eval_score = 73.31
2023-04-22 13:13:14,756 - Detection -   train_loss = 1.0814571917057036
2023-04-22 13:13:32,921 - Detection - ***** Epoch: 17: Eval results *****
2023-04-22 13:13:32,921 - Detection -   best_eval_score = 74.2
2023-04-22 13:13:32,921 - Detection -   eval_score = 73.54
2023-04-22 13:13:32,921 - Detection -   train_loss = 1.0882566213607787
2023-04-22 13:13:51,155 - Detection - ***** Epoch: 18: Eval results *****
2023-04-22 13:13:51,155 - Detection -   best_eval_score = 74.2
2023-04-22 13:13:51,155 - Detection -   eval_score = 74.16
2023-04-22 13:13:51,155 - Detection -   train_loss = 1.081570279598236
2023-04-22 13:14:09,514 - Detection - ***** Epoch: 19: Eval results *****
2023-04-22 13:14:09,514 - Detection -   best_eval_score = 74.2
2023-04-22 13:14:09,514 - Detection -   eval_score = 73.81
2023-04-22 13:14:09,514 - Detection -   train_loss = 1.0699380874633788
2023-04-22 13:14:27,933 - Detection - ***** Epoch: 20: Eval results *****
2023-04-22 13:14:27,933 - Detection -   best_eval_score = 74.2
2023-04-22 13:14:27,933 - Detection -   eval_score = 73.77
2023-04-22 13:14:27,933 - Detection -   train_loss = 1.0848110020160675
2023-04-22 13:14:27,933 - Detection - Training Finished...
2023-04-22 13:14:27,933 - Detection - Testing begin...
2023-04-22 13:14:30,348 - Detection - ***** Test: Confusion Matrix *****
2023-04-22 13:14:30,349 - Detection - [[ 111    0    0    1    0    0    0    0    3    0   34]
 [   0   86    0    0    0    0    0    0    1    3   38]
 [   0    0   96    0    0    0    2    0    1    0   41]
 [   0    0    0   54    0    0    0    0    0    0   68]
 [   0    0    0    2  106    0    0    1    0    0   22]
 [   0    0    0    2    0   76    0    0    4    0   57]
 [   0    0    3    0    0    0  123    0    0    0   45]
 [   0    0    0    3    0    0    0   54    0    0   67]
 [   0    0    0    0    0    0    1    0  107    0   20]
 [   0    0    0    0    0    0    0    0    0   94   33]
 [   2   16    8   44    1   10   24    5   31    2 1403]]
2023-04-22 13:14:30,349 - Detection - ***** Test results *****
2023-04-22 13:14:30,349 - Detection -   Acc = 79.52
2023-04-22 13:14:30,349 - Detection -   F1 = 74.6135
2023-04-22 13:14:30,349 - Detection -   F1-known = 73.7583
2023-04-22 13:14:30,349 - Detection -   F1-open = 83.1654
2023-04-22 13:14:30,349 - Detection - Testing finished...
2023-04-22 13:14:30,349 - Detection - Results saved in results/results_DA-ADB-BOOST.csv
2023-04-22 13:14:30,368 - Detection - Open Intent Detection Finished...
