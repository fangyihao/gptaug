2023-04-19 18:26:18,180 - Detection - Open Intent Detection Begin...
2023-04-19 18:26:18,180 - Detection - Parameters Initialization...
2023-04-19 18:26:18,181 - Detection - ============================== Params ==============================
2023-04-19 18:26:18,181 - Detection - type:	open_intent_detection
2023-04-19 18:26:18,181 - Detection - logger_name:	Detection
2023-04-19 18:26:18,181 - Detection - log_dir:	logs
2023-04-19 18:26:18,181 - Detection - dataset:	banking_cg
2023-04-19 18:26:18,181 - Detection - known_cls_ratio:	0.25
2023-04-19 18:26:18,181 - Detection - labeled_ratio:	1.0
2023-04-19 18:26:18,181 - Detection - method:	DA-ADB
2023-04-19 18:26:18,181 - Detection - train:	True
2023-04-19 18:26:18,181 - Detection - pretrain:	True
2023-04-19 18:26:18,181 - Detection - save_model:	True
2023-04-19 18:26:18,181 - Detection - backbone:	bert_disaware
2023-04-19 18:26:18,181 - Detection - config_file_name:	DA-ADB
2023-04-19 18:26:18,181 - Detection - seed:	2
2023-04-19 18:26:18,181 - Detection - gpu_id:	0
2023-04-19 18:26:18,181 - Detection - pipe_results_path:	pipe_results
2023-04-19 18:26:18,181 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-19 18:26:18,181 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-19 18:26:18,181 - Detection - model_dir:	models
2023-04-19 18:26:18,181 - Detection - load_pretrained_method:	None
2023-04-19 18:26:18,181 - Detection - result_dir:	results
2023-04-19 18:26:18,181 - Detection - results_file_name:	results_DA-ADB.csv
2023-04-19 18:26:18,181 - Detection - save_results:	True
2023-04-19 18:26:18,181 - Detection - loss_fct:	CrossEntropyLoss
2023-04-19 18:26:18,181 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_cg_0.25_1.0_bert_disaware_2
2023-04-19 18:26:18,181 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_cg_0.25_1.0_bert_disaware_2/models
2023-04-19 18:26:18,181 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-19 18:26:18,181 - Detection - num_train_epochs:	100
2023-04-19 18:26:18,181 - Detection - num_labels:	None
2023-04-19 18:26:18,181 - Detection - max_seq_length:	None
2023-04-19 18:26:18,181 - Detection - freeze_backbone_parameters:	True
2023-04-19 18:26:18,181 - Detection - feat_dim:	768
2023-04-19 18:26:18,181 - Detection - warmup_proportion:	0.1
2023-04-19 18:26:18,181 - Detection - scale:	4
2023-04-19 18:26:18,181 - Detection - lr_boundary:	0.05
2023-04-19 18:26:18,181 - Detection - lr:	2e-05
2023-04-19 18:26:18,181 - Detection - activation:	relu
2023-04-19 18:26:18,181 - Detection - train_batch_size:	128
2023-04-19 18:26:18,181 - Detection - eval_batch_size:	64
2023-04-19 18:26:18,181 - Detection - test_batch_size:	64
2023-04-19 18:26:18,181 - Detection - wait_patient:	10
2023-04-19 18:26:18,181 - Detection - ============================== End Params ==============================
2023-04-19 18:26:18,181 - Detection - Data and Model Preparation...
2023-04-19 18:26:18,182 - Detection - The number of known intents is 19
2023-04-19 18:26:18,182 - Detection - Lists of known labels are: ['direct_debit_payment_not_recognised', 'declined_cash_withdrawal', 'supported_cards_and_currencies', 'pin_blocked', 'verify_top_up', 'compromised_card', 'wrong_exchange_rate_for_cash_withdrawal', 'activate_my_card', 'verify_source_of_funds', 'reverted_card_payment?', 'request_refund', 'transfer_into_account', 'card_delivery_estimate', 'failed_transfer', 'top_up_by_card_charge', 'unable_to_verify_identity', 'disposable_card_limits', 'top_up_by_cash_or_cheque', 'cash_withdrawal_not_recognised']
2023-04-19 18:26:18,190 - Detection - Number of labeled training samples = 682
2023-04-19 18:26:18,190 - Detection - Number of unlabeled training samples = 2093
2023-04-19 18:26:18,192 - Detection - Number of evaluation samples = 209
2023-04-19 18:26:18,196 - Detection - Number of testing samples = 1896
2023-04-19 18:26:23,663 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-19 18:26:23,745 - Detection - Pre-training Begin...
2023-04-19 18:26:25,896 - Detection - ***** Epoch: 1: Eval results *****
2023-04-19 18:26:25,897 - Detection -   best_eval_score = 0
2023-04-19 18:26:25,897 - Detection -   eval_score = 2.0
2023-04-19 18:26:25,897 - Detection -   train_loss = 2.9377127091089883
2023-04-19 18:26:27,567 - Detection - ***** Epoch: 2: Eval results *****
2023-04-19 18:26:27,567 - Detection -   best_eval_score = 2.0
2023-04-19 18:26:27,567 - Detection -   eval_score = 1.35
2023-04-19 18:26:27,567 - Detection -   train_loss = 2.913015365600586
2023-04-19 18:26:29,228 - Detection - ***** Epoch: 3: Eval results *****
2023-04-19 18:26:29,228 - Detection -   best_eval_score = 2.0
2023-04-19 18:26:29,228 - Detection -   eval_score = 0.4
2023-04-19 18:26:29,229 - Detection -   train_loss = 2.8678000768025718
2023-04-19 18:26:30,891 - Detection - ***** Epoch: 4: Eval results *****
2023-04-19 18:26:30,892 - Detection -   best_eval_score = 2.0
2023-04-19 18:26:30,892 - Detection -   eval_score = 0.35
2023-04-19 18:26:30,892 - Detection -   train_loss = 2.834450682004293
2023-04-19 18:26:32,554 - Detection - ***** Epoch: 5: Eval results *****
2023-04-19 18:26:32,554 - Detection -   best_eval_score = 2.0
2023-04-19 18:26:32,554 - Detection -   eval_score = 1.01
2023-04-19 18:26:32,554 - Detection -   train_loss = 2.7946691115697226
2023-04-19 18:26:34,217 - Detection - ***** Epoch: 6: Eval results *****
2023-04-19 18:26:34,217 - Detection -   best_eval_score = 2.0
2023-04-19 18:26:34,217 - Detection -   eval_score = 0.31
2023-04-19 18:26:34,217 - Detection -   train_loss = 2.7559080521265664
2023-04-19 18:26:35,882 - Detection - ***** Epoch: 7: Eval results *****
2023-04-19 18:26:35,882 - Detection -   best_eval_score = 2.0
2023-04-19 18:26:35,882 - Detection -   eval_score = 0.67
2023-04-19 18:26:35,882 - Detection -   train_loss = 2.733602205912272
2023-04-19 18:26:37,549 - Detection - ***** Epoch: 8: Eval results *****
2023-04-19 18:26:37,549 - Detection -   best_eval_score = 2.0
2023-04-19 18:26:37,550 - Detection -   eval_score = 1.73
2023-04-19 18:26:37,550 - Detection -   train_loss = 2.6842657327651978
2023-04-19 18:26:39,216 - Detection - ***** Epoch: 9: Eval results *****
2023-04-19 18:26:39,216 - Detection -   best_eval_score = 2.0
2023-04-19 18:26:39,216 - Detection -   eval_score = 2.6
2023-04-19 18:26:39,216 - Detection -   train_loss = 2.6459495623906455
2023-04-19 18:26:40,897 - Detection - ***** Epoch: 10: Eval results *****
2023-04-19 18:26:40,897 - Detection -   best_eval_score = 2.6
2023-04-19 18:26:40,897 - Detection -   eval_score = 7.12
2023-04-19 18:26:40,897 - Detection -   train_loss = 2.6026459534962973
2023-04-19 18:26:42,577 - Detection - ***** Epoch: 11: Eval results *****
2023-04-19 18:26:42,577 - Detection -   best_eval_score = 7.12
2023-04-19 18:26:42,577 - Detection -   eval_score = 9.93
2023-04-19 18:26:42,577 - Detection -   train_loss = 2.5245951811472573
2023-04-19 18:26:44,259 - Detection - ***** Epoch: 12: Eval results *****
2023-04-19 18:26:44,259 - Detection -   best_eval_score = 9.93
2023-04-19 18:26:44,260 - Detection -   eval_score = 12.85
2023-04-19 18:26:44,260 - Detection -   train_loss = 2.4219247102737427
2023-04-19 18:26:45,941 - Detection - ***** Epoch: 13: Eval results *****
2023-04-19 18:26:45,941 - Detection -   best_eval_score = 12.85
2023-04-19 18:26:45,941 - Detection -   eval_score = 16.2
2023-04-19 18:26:45,941 - Detection -   train_loss = 2.2767513593037925
2023-04-19 18:26:47,625 - Detection - ***** Epoch: 14: Eval results *****
2023-04-19 18:26:47,625 - Detection -   best_eval_score = 16.2
2023-04-19 18:26:47,625 - Detection -   eval_score = 22.17
2023-04-19 18:26:47,625 - Detection -   train_loss = 2.1573747793833413
2023-04-19 18:26:49,310 - Detection - ***** Epoch: 15: Eval results *****
2023-04-19 18:26:49,311 - Detection -   best_eval_score = 22.17
2023-04-19 18:26:49,311 - Detection -   eval_score = 28.35
2023-04-19 18:26:49,311 - Detection -   train_loss = 2.0166444381078086
2023-04-19 18:26:50,994 - Detection - ***** Epoch: 16: Eval results *****
2023-04-19 18:26:50,994 - Detection -   best_eval_score = 28.35
2023-04-19 18:26:50,994 - Detection -   eval_score = 37.36
2023-04-19 18:26:50,994 - Detection -   train_loss = 1.8722930947939556
2023-04-19 18:26:52,780 - Detection - ***** Epoch: 17: Eval results *****
2023-04-19 18:26:52,780 - Detection -   best_eval_score = 37.36
2023-04-19 18:26:52,780 - Detection -   eval_score = 41.04
2023-04-19 18:26:52,780 - Detection -   train_loss = 1.7475246787071228
2023-04-19 18:26:54,465 - Detection - ***** Epoch: 18: Eval results *****
2023-04-19 18:26:54,466 - Detection -   best_eval_score = 41.04
2023-04-19 18:26:54,466 - Detection -   eval_score = 47.83
2023-04-19 18:26:54,466 - Detection -   train_loss = 1.6670710643132527
2023-04-19 18:26:56,151 - Detection - ***** Epoch: 19: Eval results *****
2023-04-19 18:26:56,151 - Detection -   best_eval_score = 47.83
2023-04-19 18:26:56,151 - Detection -   eval_score = 52.4
2023-04-19 18:26:56,151 - Detection -   train_loss = 1.5748772422472637
2023-04-19 18:26:57,837 - Detection - ***** Epoch: 20: Eval results *****
2023-04-19 18:26:57,837 - Detection -   best_eval_score = 52.4
2023-04-19 18:26:57,837 - Detection -   eval_score = 53.4
2023-04-19 18:26:57,837 - Detection -   train_loss = 1.488270143667857
2023-04-19 18:26:59,525 - Detection - ***** Epoch: 21: Eval results *****
2023-04-19 18:26:59,525 - Detection -   best_eval_score = 53.4
2023-04-19 18:26:59,525 - Detection -   eval_score = 60.53
2023-04-19 18:26:59,525 - Detection -   train_loss = 1.431686282157898
2023-04-19 18:27:01,215 - Detection - ***** Epoch: 22: Eval results *****
2023-04-19 18:27:01,215 - Detection -   best_eval_score = 60.53
2023-04-19 18:27:01,215 - Detection -   eval_score = 62.72
2023-04-19 18:27:01,215 - Detection -   train_loss = 1.3774682680765789
2023-04-19 18:27:02,905 - Detection - ***** Epoch: 23: Eval results *****
2023-04-19 18:27:02,905 - Detection -   best_eval_score = 62.72
2023-04-19 18:27:02,905 - Detection -   eval_score = 63.19
2023-04-19 18:27:02,905 - Detection -   train_loss = 1.3234910170237224
2023-04-19 18:27:04,598 - Detection - ***** Epoch: 24: Eval results *****
2023-04-19 18:27:04,598 - Detection -   best_eval_score = 63.19
2023-04-19 18:27:04,598 - Detection -   eval_score = 67.71
2023-04-19 18:27:04,598 - Detection -   train_loss = 1.2932150959968567
2023-04-19 18:27:06,292 - Detection - ***** Epoch: 25: Eval results *****
2023-04-19 18:27:06,292 - Detection -   best_eval_score = 67.71
2023-04-19 18:27:06,292 - Detection -   eval_score = 67.38
2023-04-19 18:27:06,292 - Detection -   train_loss = 1.2358455061912537
2023-04-19 18:27:07,974 - Detection - ***** Epoch: 26: Eval results *****
2023-04-19 18:27:07,974 - Detection -   best_eval_score = 67.71
2023-04-19 18:27:07,974 - Detection -   eval_score = 70.79
2023-04-19 18:27:07,974 - Detection -   train_loss = 1.195678452650706
2023-04-19 18:27:09,670 - Detection - ***** Epoch: 27: Eval results *****
2023-04-19 18:27:09,670 - Detection -   best_eval_score = 70.79
2023-04-19 18:27:09,670 - Detection -   eval_score = 69.07
2023-04-19 18:27:09,670 - Detection -   train_loss = 1.1721439560254414
2023-04-19 18:27:11,353 - Detection - ***** Epoch: 28: Eval results *****
2023-04-19 18:27:11,353 - Detection -   best_eval_score = 70.79
2023-04-19 18:27:11,353 - Detection -   eval_score = 73.09
2023-04-19 18:27:11,353 - Detection -   train_loss = 1.1430086096127827
2023-04-19 18:27:13,050 - Detection - ***** Epoch: 29: Eval results *****
2023-04-19 18:27:13,050 - Detection -   best_eval_score = 73.09
2023-04-19 18:27:13,050 - Detection -   eval_score = 72.43
2023-04-19 18:27:13,050 - Detection -   train_loss = 1.1140280564626057
2023-04-19 18:27:14,733 - Detection - ***** Epoch: 30: Eval results *****
2023-04-19 18:27:14,733 - Detection -   best_eval_score = 73.09
2023-04-19 18:27:14,733 - Detection -   eval_score = 72.6
2023-04-19 18:27:14,733 - Detection -   train_loss = 1.108315368493398
2023-04-19 18:27:16,418 - Detection - ***** Epoch: 31: Eval results *****
2023-04-19 18:27:16,418 - Detection -   best_eval_score = 73.09
2023-04-19 18:27:16,418 - Detection -   eval_score = 74.48
2023-04-19 18:27:16,418 - Detection -   train_loss = 1.0680450002352397
2023-04-19 18:27:18,115 - Detection - ***** Epoch: 32: Eval results *****
2023-04-19 18:27:18,115 - Detection -   best_eval_score = 74.48
2023-04-19 18:27:18,115 - Detection -   eval_score = 74.25
2023-04-19 18:27:18,115 - Detection -   train_loss = 1.0523921052614849
2023-04-19 18:27:19,802 - Detection - ***** Epoch: 33: Eval results *****
2023-04-19 18:27:19,802 - Detection -   best_eval_score = 74.48
2023-04-19 18:27:19,802 - Detection -   eval_score = 75.18
2023-04-19 18:27:19,802 - Detection -   train_loss = 1.0319440464178722
2023-04-19 18:27:21,500 - Detection - ***** Epoch: 34: Eval results *****
2023-04-19 18:27:21,500 - Detection -   best_eval_score = 75.18
2023-04-19 18:27:21,501 - Detection -   eval_score = 75.2
2023-04-19 18:27:21,501 - Detection -   train_loss = 1.0245566169420879
2023-04-19 18:27:23,197 - Detection - ***** Epoch: 35: Eval results *****
2023-04-19 18:27:23,197 - Detection -   best_eval_score = 75.2
2023-04-19 18:27:23,197 - Detection -   eval_score = 74.82
2023-04-19 18:27:23,197 - Detection -   train_loss = 1.002671132485072
2023-04-19 18:27:24,883 - Detection - ***** Epoch: 36: Eval results *****
2023-04-19 18:27:24,883 - Detection -   best_eval_score = 75.2
2023-04-19 18:27:24,883 - Detection -   eval_score = 76.59
2023-04-19 18:27:24,883 - Detection -   train_loss = 0.999254991610845
2023-04-19 18:27:26,581 - Detection - ***** Epoch: 37: Eval results *****
2023-04-19 18:27:26,581 - Detection -   best_eval_score = 76.59
2023-04-19 18:27:26,581 - Detection -   eval_score = 76.13
2023-04-19 18:27:26,581 - Detection -   train_loss = 0.9828004141648611
2023-04-19 18:27:28,267 - Detection - ***** Epoch: 38: Eval results *****
2023-04-19 18:27:28,268 - Detection -   best_eval_score = 76.59
2023-04-19 18:27:28,268 - Detection -   eval_score = 76.21
2023-04-19 18:27:28,268 - Detection -   train_loss = 0.959397166967392
2023-04-19 18:27:29,954 - Detection - ***** Epoch: 39: Eval results *****
2023-04-19 18:27:29,954 - Detection -   best_eval_score = 76.59
2023-04-19 18:27:29,954 - Detection -   eval_score = 76.59
2023-04-19 18:27:29,954 - Detection -   train_loss = 0.9571905930836996
2023-04-19 18:27:31,640 - Detection - ***** Epoch: 40: Eval results *****
2023-04-19 18:27:31,640 - Detection -   best_eval_score = 76.59
2023-04-19 18:27:31,640 - Detection -   eval_score = 76.34
2023-04-19 18:27:31,640 - Detection -   train_loss = 0.9446879625320435
2023-04-19 18:27:33,327 - Detection - ***** Epoch: 41: Eval results *****
2023-04-19 18:27:33,327 - Detection -   best_eval_score = 76.59
2023-04-19 18:27:33,327 - Detection -   eval_score = 76.8
2023-04-19 18:27:33,327 - Detection -   train_loss = 0.9362379014492035
2023-04-19 18:27:35,027 - Detection - ***** Epoch: 42: Eval results *****
2023-04-19 18:27:35,027 - Detection -   best_eval_score = 76.8
2023-04-19 18:27:35,027 - Detection -   eval_score = 78.07
2023-04-19 18:27:35,027 - Detection -   train_loss = 0.9207940896352133
2023-04-19 18:27:36,726 - Detection - ***** Epoch: 43: Eval results *****
2023-04-19 18:27:36,726 - Detection -   best_eval_score = 78.07
2023-04-19 18:27:36,726 - Detection -   eval_score = 78.39
2023-04-19 18:27:36,726 - Detection -   train_loss = 0.9107581277688345
2023-04-19 18:27:38,426 - Detection - ***** Epoch: 44: Eval results *****
2023-04-19 18:27:38,426 - Detection -   best_eval_score = 78.39
2023-04-19 18:27:38,426 - Detection -   eval_score = 78.32
2023-04-19 18:27:38,426 - Detection -   train_loss = 0.9001772304375967
2023-04-19 18:27:40,114 - Detection - ***** Epoch: 45: Eval results *****
2023-04-19 18:27:40,114 - Detection -   best_eval_score = 78.39
2023-04-19 18:27:40,114 - Detection -   eval_score = 79.53
2023-04-19 18:27:40,114 - Detection -   train_loss = 0.8947568734486898
2023-04-19 18:27:41,813 - Detection - ***** Epoch: 46: Eval results *****
2023-04-19 18:27:41,813 - Detection -   best_eval_score = 79.53
2023-04-19 18:27:41,813 - Detection -   eval_score = 80.69
2023-04-19 18:27:41,814 - Detection -   train_loss = 0.8861295481522878
2023-04-19 18:27:43,511 - Detection - ***** Epoch: 47: Eval results *****
2023-04-19 18:27:43,512 - Detection -   best_eval_score = 80.69
2023-04-19 18:27:43,512 - Detection -   eval_score = 79.58
2023-04-19 18:27:43,512 - Detection -   train_loss = 0.8816192249457041
2023-04-19 18:27:45,199 - Detection - ***** Epoch: 48: Eval results *****
2023-04-19 18:27:45,199 - Detection -   best_eval_score = 80.69
2023-04-19 18:27:45,199 - Detection -   eval_score = 80.04
2023-04-19 18:27:45,199 - Detection -   train_loss = 0.8636119862397512
2023-04-19 18:27:46,887 - Detection - ***** Epoch: 49: Eval results *****
2023-04-19 18:27:46,887 - Detection -   best_eval_score = 80.69
2023-04-19 18:27:46,887 - Detection -   eval_score = 79.86
2023-04-19 18:27:46,887 - Detection -   train_loss = 0.8577179114023844
2023-04-19 18:27:48,574 - Detection - ***** Epoch: 50: Eval results *****
2023-04-19 18:27:48,574 - Detection -   best_eval_score = 80.69
2023-04-19 18:27:48,574 - Detection -   eval_score = 80.38
2023-04-19 18:27:48,574 - Detection -   train_loss = 0.8774055937925974
2023-04-19 18:27:50,260 - Detection - ***** Epoch: 51: Eval results *****
2023-04-19 18:27:50,260 - Detection -   best_eval_score = 80.69
2023-04-19 18:27:50,261 - Detection -   eval_score = 81.11
2023-04-19 18:27:50,261 - Detection -   train_loss = 0.8527715504169464
2023-04-19 18:27:51,960 - Detection - ***** Epoch: 52: Eval results *****
2023-04-19 18:27:51,960 - Detection -   best_eval_score = 81.11
2023-04-19 18:27:51,960 - Detection -   eval_score = 81.78
2023-04-19 18:27:51,960 - Detection -   train_loss = 0.8513745466868082
2023-04-19 18:27:53,658 - Detection - ***** Epoch: 53: Eval results *****
2023-04-19 18:27:53,658 - Detection -   best_eval_score = 81.78
2023-04-19 18:27:53,658 - Detection -   eval_score = 80.21
2023-04-19 18:27:53,658 - Detection -   train_loss = 0.8556232849756876
2023-04-19 18:27:55,345 - Detection - ***** Epoch: 54: Eval results *****
2023-04-19 18:27:55,345 - Detection -   best_eval_score = 81.78
2023-04-19 18:27:55,345 - Detection -   eval_score = 80.59
2023-04-19 18:27:55,345 - Detection -   train_loss = 0.8227353096008301
2023-04-19 18:27:57,134 - Detection - ***** Epoch: 55: Eval results *****
2023-04-19 18:27:57,134 - Detection -   best_eval_score = 81.78
2023-04-19 18:27:57,134 - Detection -   eval_score = 80.01
2023-04-19 18:27:57,134 - Detection -   train_loss = 0.8422482212384542
2023-04-19 18:27:58,823 - Detection - ***** Epoch: 56: Eval results *****
2023-04-19 18:27:58,823 - Detection -   best_eval_score = 81.78
2023-04-19 18:27:58,823 - Detection -   eval_score = 80.31
2023-04-19 18:27:58,823 - Detection -   train_loss = 0.8332030673821768
2023-04-19 18:28:00,509 - Detection - ***** Epoch: 57: Eval results *****
2023-04-19 18:28:00,509 - Detection -   best_eval_score = 81.78
2023-04-19 18:28:00,509 - Detection -   eval_score = 80.06
2023-04-19 18:28:00,509 - Detection -   train_loss = 0.8244981666405996
2023-04-19 18:28:02,195 - Detection - ***** Epoch: 58: Eval results *****
2023-04-19 18:28:02,195 - Detection -   best_eval_score = 81.78
2023-04-19 18:28:02,195 - Detection -   eval_score = 80.31
2023-04-19 18:28:02,195 - Detection -   train_loss = 0.8327077527840933
2023-04-19 18:28:03,881 - Detection - ***** Epoch: 59: Eval results *****
2023-04-19 18:28:03,881 - Detection -   best_eval_score = 81.78
2023-04-19 18:28:03,881 - Detection -   eval_score = 80.56
2023-04-19 18:28:03,881 - Detection -   train_loss = 0.8165753881136576
2023-04-19 18:28:05,566 - Detection - ***** Epoch: 60: Eval results *****
2023-04-19 18:28:05,566 - Detection -   best_eval_score = 81.78
2023-04-19 18:28:05,566 - Detection -   eval_score = 80.89
2023-04-19 18:28:05,567 - Detection -   train_loss = 0.8141304055849711
2023-04-19 18:28:07,251 - Detection - ***** Epoch: 61: Eval results *****
2023-04-19 18:28:07,251 - Detection -   best_eval_score = 81.78
2023-04-19 18:28:07,251 - Detection -   eval_score = 81.41
2023-04-19 18:28:07,251 - Detection -   train_loss = 0.8139661550521851
2023-04-19 18:28:08,937 - Detection - ***** Epoch: 62: Eval results *****
2023-04-19 18:28:08,937 - Detection -   best_eval_score = 81.78
2023-04-19 18:28:08,938 - Detection -   eval_score = 80.89
2023-04-19 18:28:08,938 - Detection -   train_loss = 0.8019512891769409
2023-04-19 18:28:08,938 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_cg_0.25_1.0_bert_disaware_2/models
2023-04-19 18:28:09,482 - Detection - Pre-training finished...
2023-04-19 18:28:09,482 - Detection - Training Begin...
2023-04-19 18:28:10,475 - Detection - ***** Epoch: 1: Eval results *****
2023-04-19 18:28:10,476 - Detection -   best_eval_score = 0
2023-04-19 18:28:10,476 - Detection -   eval_score = 0.0
2023-04-19 18:28:10,476 - Detection -   train_loss = 3.2531630198160806
2023-04-19 18:28:11,469 - Detection - ***** Epoch: 2: Eval results *****
2023-04-19 18:28:11,469 - Detection -   best_eval_score = 0
2023-04-19 18:28:11,469 - Detection -   eval_score = 2.0
2023-04-19 18:28:11,469 - Detection -   train_loss = 3.1111154158910117
2023-04-19 18:28:12,461 - Detection - ***** Epoch: 3: Eval results *****
2023-04-19 18:28:12,461 - Detection -   best_eval_score = 2.0
2023-04-19 18:28:12,461 - Detection -   eval_score = 2.0
2023-04-19 18:28:12,461 - Detection -   train_loss = 2.955134471257528
2023-04-19 18:28:13,454 - Detection - ***** Epoch: 4: Eval results *****
2023-04-19 18:28:13,455 - Detection -   best_eval_score = 2.0
2023-04-19 18:28:13,455 - Detection -   eval_score = 3.64
2023-04-19 18:28:13,455 - Detection -   train_loss = 2.703543265660604
2023-04-19 18:28:14,447 - Detection - ***** Epoch: 5: Eval results *****
2023-04-19 18:28:14,447 - Detection -   best_eval_score = 3.64
2023-04-19 18:28:14,447 - Detection -   eval_score = 4.87
2023-04-19 18:28:14,447 - Detection -   train_loss = 2.554924209912618
2023-04-19 18:28:15,440 - Detection - ***** Epoch: 6: Eval results *****
2023-04-19 18:28:15,440 - Detection -   best_eval_score = 4.87
2023-04-19 18:28:15,440 - Detection -   eval_score = 8.85
2023-04-19 18:28:15,440 - Detection -   train_loss = 2.273066838582357
2023-04-19 18:28:16,433 - Detection - ***** Epoch: 7: Eval results *****
2023-04-19 18:28:16,433 - Detection -   best_eval_score = 8.85
2023-04-19 18:28:16,433 - Detection -   eval_score = 15.73
2023-04-19 18:28:16,433 - Detection -   train_loss = 2.0565026998519897
2023-04-19 18:28:17,426 - Detection - ***** Epoch: 8: Eval results *****
2023-04-19 18:28:17,426 - Detection -   best_eval_score = 15.73
2023-04-19 18:28:17,426 - Detection -   eval_score = 20.8
2023-04-19 18:28:17,426 - Detection -   train_loss = 1.7206468383471172
2023-04-19 18:28:18,419 - Detection - ***** Epoch: 9: Eval results *****
2023-04-19 18:28:18,419 - Detection -   best_eval_score = 20.8
2023-04-19 18:28:18,419 - Detection -   eval_score = 30.33
2023-04-19 18:28:18,419 - Detection -   train_loss = 1.4730961521466572
2023-04-19 18:28:19,412 - Detection - ***** Epoch: 10: Eval results *****
2023-04-19 18:28:19,412 - Detection -   best_eval_score = 30.33
2023-04-19 18:28:19,412 - Detection -   eval_score = 36.96
2023-04-19 18:28:19,412 - Detection -   train_loss = 1.2237549622853596
2023-04-19 18:28:20,406 - Detection - ***** Epoch: 11: Eval results *****
2023-04-19 18:28:20,406 - Detection -   best_eval_score = 36.96
2023-04-19 18:28:20,406 - Detection -   eval_score = 42.97
2023-04-19 18:28:20,406 - Detection -   train_loss = 1.0204114218552907
2023-04-19 18:28:21,399 - Detection - ***** Epoch: 12: Eval results *****
2023-04-19 18:28:21,399 - Detection -   best_eval_score = 42.97
2023-04-19 18:28:21,399 - Detection -   eval_score = 50.38
2023-04-19 18:28:21,399 - Detection -   train_loss = 0.8054169615109762
2023-04-19 18:28:22,393 - Detection - ***** Epoch: 13: Eval results *****
2023-04-19 18:28:22,393 - Detection -   best_eval_score = 50.38
2023-04-19 18:28:22,393 - Detection -   eval_score = 55.03
2023-04-19 18:28:22,393 - Detection -   train_loss = 0.7188960214455923
2023-04-19 18:28:23,387 - Detection - ***** Epoch: 14: Eval results *****
2023-04-19 18:28:23,387 - Detection -   best_eval_score = 55.03
2023-04-19 18:28:23,387 - Detection -   eval_score = 59.84
2023-04-19 18:28:23,387 - Detection -   train_loss = 0.6451271772384644
2023-04-19 18:28:24,380 - Detection - ***** Epoch: 15: Eval results *****
2023-04-19 18:28:24,380 - Detection -   best_eval_score = 59.84
2023-04-19 18:28:24,380 - Detection -   eval_score = 60.61
2023-04-19 18:28:24,380 - Detection -   train_loss = 0.5896678318579992
2023-04-19 18:28:25,374 - Detection - ***** Epoch: 16: Eval results *****
2023-04-19 18:28:25,374 - Detection -   best_eval_score = 60.61
2023-04-19 18:28:25,374 - Detection -   eval_score = 62.92
2023-04-19 18:28:25,374 - Detection -   train_loss = 0.5915635327498118
2023-04-19 18:28:26,367 - Detection - ***** Epoch: 17: Eval results *****
2023-04-19 18:28:26,367 - Detection -   best_eval_score = 62.92
2023-04-19 18:28:26,367 - Detection -   eval_score = 63.26
2023-04-19 18:28:26,367 - Detection -   train_loss = 0.5481908768415451
2023-04-19 18:28:27,360 - Detection - ***** Epoch: 18: Eval results *****
2023-04-19 18:28:27,360 - Detection -   best_eval_score = 63.26
2023-04-19 18:28:27,360 - Detection -   eval_score = 63.19
2023-04-19 18:28:27,360 - Detection -   train_loss = 0.5688601036866506
2023-04-19 18:28:28,354 - Detection - ***** Epoch: 19: Eval results *****
2023-04-19 18:28:28,354 - Detection -   best_eval_score = 63.26
2023-04-19 18:28:28,354 - Detection -   eval_score = 63.47
2023-04-19 18:28:28,354 - Detection -   train_loss = 0.5563672184944153
2023-04-19 18:28:29,347 - Detection - ***** Epoch: 20: Eval results *****
2023-04-19 18:28:29,347 - Detection -   best_eval_score = 63.47
2023-04-19 18:28:29,347 - Detection -   eval_score = 62.83
2023-04-19 18:28:29,347 - Detection -   train_loss = 0.5364448179801306
2023-04-19 18:28:30,341 - Detection - ***** Epoch: 21: Eval results *****
2023-04-19 18:28:30,341 - Detection -   best_eval_score = 63.47
2023-04-19 18:28:30,341 - Detection -   eval_score = 62.83
2023-04-19 18:28:30,341 - Detection -   train_loss = 0.5827232201894125
2023-04-19 18:28:31,334 - Detection - ***** Epoch: 22: Eval results *****
2023-04-19 18:28:31,334 - Detection -   best_eval_score = 63.47
2023-04-19 18:28:31,334 - Detection -   eval_score = 62.17
2023-04-19 18:28:31,334 - Detection -   train_loss = 0.5628738254308701
2023-04-19 18:28:32,328 - Detection - ***** Epoch: 23: Eval results *****
2023-04-19 18:28:32,328 - Detection -   best_eval_score = 63.47
2023-04-19 18:28:32,328 - Detection -   eval_score = 62.24
2023-04-19 18:28:32,328 - Detection -   train_loss = 0.5592244068781534
2023-04-19 18:28:33,320 - Detection - ***** Epoch: 24: Eval results *****
2023-04-19 18:28:33,321 - Detection -   best_eval_score = 63.47
2023-04-19 18:28:33,321 - Detection -   eval_score = 62.62
2023-04-19 18:28:33,321 - Detection -   train_loss = 0.5431535542011261
2023-04-19 18:28:34,314 - Detection - ***** Epoch: 25: Eval results *****
2023-04-19 18:28:34,314 - Detection -   best_eval_score = 63.47
2023-04-19 18:28:34,314 - Detection -   eval_score = 62.24
2023-04-19 18:28:34,314 - Detection -   train_loss = 0.5250607281923294
2023-04-19 18:28:35,307 - Detection - ***** Epoch: 26: Eval results *****
2023-04-19 18:28:35,307 - Detection -   best_eval_score = 63.47
2023-04-19 18:28:35,307 - Detection -   eval_score = 61.18
2023-04-19 18:28:35,307 - Detection -   train_loss = 0.5802596857150396
2023-04-19 18:28:36,300 - Detection - ***** Epoch: 27: Eval results *****
2023-04-19 18:28:36,300 - Detection -   best_eval_score = 63.47
2023-04-19 18:28:36,300 - Detection -   eval_score = 61.63
2023-04-19 18:28:36,300 - Detection -   train_loss = 0.5563848614692688
2023-04-19 18:28:37,294 - Detection - ***** Epoch: 28: Eval results *****
2023-04-19 18:28:37,294 - Detection -   best_eval_score = 63.47
2023-04-19 18:28:37,294 - Detection -   eval_score = 62.41
2023-04-19 18:28:37,294 - Detection -   train_loss = 0.5530063509941101
2023-04-19 18:28:38,288 - Detection - ***** Epoch: 29: Eval results *****
2023-04-19 18:28:38,288 - Detection -   best_eval_score = 63.47
2023-04-19 18:28:38,288 - Detection -   eval_score = 63.05
2023-04-19 18:28:38,288 - Detection -   train_loss = 0.5524827688932419
2023-04-19 18:28:38,289 - Detection - Training Finished...
2023-04-19 18:28:38,289 - Detection - Testing begin...
2023-04-19 18:28:40,197 - Detection - ***** Test: Confusion Matrix *****
2023-04-19 18:28:40,198 - Detection - [[   5    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    2    9]
 [   0   30    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    5]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0   24]
 [   0    0    0    9    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0   12]
 [   0    0    0    0   25    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    4]
 [   0    0    0    0    0    1    0    0    0    0    0    0    0    0
     0    0    0    0    0   17]
 [   0    0    0    0    0    0   25    0    0    0    0    0    0    0
     0    0    0    0    0    3]
 [   0    0    0    0    0    0    0   26    0    0    0    0    0    0
     0    0    0    0    0    5]
 [   0    0    0    0    0    0    0    0    5    0    0    0    0    0
     0    0    0    0    0   21]
 [   0    0    0    0    0    0    0    0    0   24    0    0    0    0
     0    0    0    0    0   11]
 [   0    0    0    0    0    0    0    0    0    0   30    0    0    0
     0    0    0    0    0    6]
 [   0    0    1    0    0    0    0    0    0    0    0    6    0    0
     0    0    0    1    0   19]
 [   0    0    0    0    0    0    0    0    0    0    0    0    7    0
     0    0    0    0    0   16]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0   17
     0    0    0    0    0   10]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     7    0    0    0    0   12]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0   19    0    0    0   11]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0   16    0    0    5]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0   16    0   15]
 [   0    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0   14   19]
 [   1   20    2    3    0    2   40    1    0   17   19    2    4   27
     4   38   20    5    3 1177]]
2023-04-19 18:28:40,198 - Detection - ***** Test results *****
2023-04-19 18:28:40,198 - Detection -   Acc = 76.95
2023-04-19 18:28:40,198 - Detection -   F1 = 52.4421
2023-04-19 18:28:40,198 - Detection -   F1-known = 50.7552
2023-04-19 18:28:40,198 - Detection -   F1-open = 84.4939
2023-04-19 18:28:40,198 - Detection - Testing finished...
2023-04-19 18:28:40,198 - Detection - Results saved in results/results_DA-ADB.csv
2023-04-19 18:28:40,217 - Detection - Open Intent Detection Finished...
