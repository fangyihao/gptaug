2023-04-24 12:32:58,925 - Detection - Open Intent Detection Begin...
2023-04-24 12:32:58,925 - Detection - Parameters Initialization...
2023-04-24 12:32:58,925 - Detection - ============================== Params ==============================
2023-04-24 12:32:58,925 - Detection - type:	open_intent_detection
2023-04-24 12:32:58,925 - Detection - logger_name:	Detection
2023-04-24 12:32:58,925 - Detection - log_dir:	logs
2023-04-24 12:32:58,925 - Detection - dataset:	stackoverflow_cg
2023-04-24 12:32:58,925 - Detection - known_cls_ratio:	0.5
2023-04-24 12:32:58,925 - Detection - labeled_ratio:	1.0
2023-04-24 12:32:58,925 - Detection - method:	ADB
2023-04-24 12:32:58,925 - Detection - train:	True
2023-04-24 12:32:58,925 - Detection - pretrain:	True
2023-04-24 12:32:58,925 - Detection - save_model:	False
2023-04-24 12:32:58,925 - Detection - backbone:	bert_boost
2023-04-24 12:32:58,925 - Detection - config_file_name:	ADB
2023-04-24 12:32:58,925 - Detection - seed:	9
2023-04-24 12:32:58,925 - Detection - gpu_id:	0
2023-04-24 12:32:58,925 - Detection - pipe_results_path:	pipe_results
2023-04-24 12:32:58,925 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-24 12:32:58,925 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-24 12:32:58,925 - Detection - model_dir:	models
2023-04-24 12:32:58,925 - Detection - load_pretrained_method:	None
2023-04-24 12:32:58,925 - Detection - result_dir:	results
2023-04-24 12:32:58,925 - Detection - results_file_name:	results_ADB-BOOST-F-10.csv
2023-04-24 12:32:58,925 - Detection - save_results:	True
2023-04-24 12:32:58,925 - Detection - loss_fct:	CrossEntropyLoss
2023-04-24 12:32:58,925 - Detection - boost_method:	F-10
2023-04-24 12:32:58,925 - Detection - boost_start_score:	0.0
2023-04-24 12:32:58,925 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.5_1.0_bert_boost_9
2023-04-24 12:32:58,925 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.5_1.0_bert_boost_9/models
2023-04-24 12:32:58,925 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-24 12:32:58,925 - Detection - num_train_epochs:	100
2023-04-24 12:32:58,925 - Detection - num_labels:	None
2023-04-24 12:32:58,925 - Detection - max_seq_length:	None
2023-04-24 12:32:58,926 - Detection - freeze_backbone_parameters:	True
2023-04-24 12:32:58,926 - Detection - feat_dim:	768
2023-04-24 12:32:58,926 - Detection - warmup_proportion:	0.1
2023-04-24 12:32:58,926 - Detection - lr_boundary:	0.05
2023-04-24 12:32:58,926 - Detection - lr:	2e-05
2023-04-24 12:32:58,926 - Detection - activation:	relu
2023-04-24 12:32:58,926 - Detection - train_batch_size:	128
2023-04-24 12:32:58,926 - Detection - eval_batch_size:	64
2023-04-24 12:32:58,926 - Detection - test_batch_size:	64
2023-04-24 12:32:58,926 - Detection - wait_patient:	10
2023-04-24 12:32:58,926 - Detection - ============================== End Params ==============================
2023-04-24 12:32:58,926 - Detection - Data and Model Preparation...
2023-04-24 12:32:58,926 - Detection - The number of known intents is 10
2023-04-24 12:32:58,926 - Detection - Lists of known labels are: ['cocoa', 'haskell', 'hibernate', 'excel', 'spring', 'sharepoint', 'bash', 'drupal', 'magento', 'matlab']
2023-04-24 12:32:58,934 - Detection - Number of labeled training samples = 1369
2023-04-24 12:32:58,934 - Detection - Number of unlabeled training samples = 1422
2023-04-24 12:32:58,937 - Detection - Number of evaluation samples = 706
2023-04-24 12:32:58,943 - Detection - Number of testing samples = 2905
2023-04-24 12:33:02,946 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-24 12:33:04,609 - Detection - Pre-training Begin...
2023-04-24 12:33:06,961 - Detection - ***** Epoch: 1: Eval results *****
2023-04-24 12:33:06,961 - Detection -   best_eval_score = 0
2023-04-24 12:33:06,961 - Detection -   eval_score = 11.61
2023-04-24 12:33:06,961 - Detection -   train_loss = 2.2965011596679688
2023-04-24 12:33:27,179 - Detection - ***** Epoch: 2: Eval results *****
2023-04-24 12:33:27,179 - Detection -   best_eval_score = 11.61
2023-04-24 12:33:27,179 - Detection -   eval_score = 35.98
2023-04-24 12:33:27,179 - Detection -   train_loss = 2.2789220159704033
2023-04-24 12:33:47,357 - Detection - ***** Epoch: 3: Eval results *****
2023-04-24 12:33:47,357 - Detection -   best_eval_score = 35.98
2023-04-24 12:33:47,357 - Detection -   eval_score = 73.8
2023-04-24 12:33:47,357 - Detection -   train_loss = 1.9133761470968074
2023-04-24 12:34:07,563 - Detection - ***** Epoch: 4: Eval results *****
2023-04-24 12:34:07,564 - Detection -   best_eval_score = 73.8
2023-04-24 12:34:07,564 - Detection -   eval_score = 81.87
2023-04-24 12:34:07,564 - Detection -   train_loss = 1.0757279829545454
2023-04-24 12:34:27,782 - Detection - ***** Epoch: 5: Eval results *****
2023-04-24 12:34:27,782 - Detection -   best_eval_score = 81.87
2023-04-24 12:34:27,783 - Detection -   eval_score = 82.58
2023-04-24 12:34:27,783 - Detection -   train_loss = 0.6759997497905385
2023-04-24 12:34:49,102 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 12:34:49,102 - Detection -   best_eval_score = 82.58
2023-04-24 12:34:49,102 - Detection -   eval_score = 83.14
2023-04-24 12:34:49,102 - Detection -   train_loss = 0.49481789632277057
2023-04-24 12:35:09,286 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 12:35:09,286 - Detection -   best_eval_score = 83.14
2023-04-24 12:35:09,286 - Detection -   eval_score = 83.43
2023-04-24 12:35:09,286 - Detection -   train_loss = 0.3612917715852911
2023-04-24 12:35:29,549 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 12:35:29,549 - Detection -   best_eval_score = 83.43
2023-04-24 12:35:29,549 - Detection -   eval_score = 82.72
2023-04-24 12:35:29,549 - Detection -   train_loss = 0.2534170828082345
2023-04-24 12:35:49,808 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 12:35:49,808 - Detection -   best_eval_score = 83.43
2023-04-24 12:35:49,808 - Detection -   eval_score = 83.14
2023-04-24 12:35:49,808 - Detection -   train_loss = 0.20612480694597418
2023-04-24 12:36:10,082 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 12:36:10,082 - Detection -   best_eval_score = 83.43
2023-04-24 12:36:10,082 - Detection -   eval_score = 82.72
2023-04-24 12:36:10,082 - Detection -   train_loss = 0.14687177877534519
2023-04-24 12:36:30,340 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 12:36:30,340 - Detection -   best_eval_score = 83.43
2023-04-24 12:36:30,340 - Detection -   eval_score = 83.14
2023-04-24 12:36:30,340 - Detection -   train_loss = 0.12901384180242365
2023-04-24 12:36:50,612 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 12:36:50,612 - Detection -   best_eval_score = 83.43
2023-04-24 12:36:50,612 - Detection -   eval_score = 82.29
2023-04-24 12:36:50,612 - Detection -   train_loss = 0.09609434889121489
2023-04-24 12:37:10,931 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 12:37:10,931 - Detection -   best_eval_score = 83.43
2023-04-24 12:37:10,931 - Detection -   eval_score = 83.0
2023-04-24 12:37:10,931 - Detection -   train_loss = 0.09356133978475224
2023-04-24 12:37:31,169 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 12:37:31,170 - Detection -   best_eval_score = 83.43
2023-04-24 12:37:31,170 - Detection -   eval_score = 82.72
2023-04-24 12:37:31,170 - Detection -   train_loss = 0.0730918523940173
2023-04-24 12:37:51,483 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 12:37:51,483 - Detection -   best_eval_score = 83.43
2023-04-24 12:37:51,483 - Detection -   eval_score = 82.86
2023-04-24 12:37:51,483 - Detection -   train_loss = 0.0641647433354096
2023-04-24 12:38:11,790 - Detection - ***** Epoch: 16: Eval results *****
2023-04-24 12:38:11,791 - Detection -   best_eval_score = 83.43
2023-04-24 12:38:11,791 - Detection -   eval_score = 83.14
2023-04-24 12:38:11,791 - Detection -   train_loss = 0.06068868596445431
2023-04-24 12:38:32,047 - Detection - ***** Epoch: 17: Eval results *****
2023-04-24 12:38:32,047 - Detection -   best_eval_score = 83.43
2023-04-24 12:38:32,047 - Detection -   eval_score = 83.0
2023-04-24 12:38:32,047 - Detection -   train_loss = 0.05693812109529972
2023-04-24 12:38:32,047 - Detection - Pre-training finished...
2023-04-24 12:38:32,047 - Detection - Training Begin...
2023-04-24 12:38:35,001 - Detection - ***** Epoch: 1: Eval results *****
2023-04-24 12:38:35,001 - Detection -   best_eval_score = 0
2023-04-24 12:38:35,001 - Detection -   eval_score = 0.0
2023-04-24 12:38:35,001 - Detection -   train_loss = 8.318359635092996
2023-04-24 12:38:36,847 - Detection - ***** Epoch: 2: Eval results *****
2023-04-24 12:38:36,847 - Detection -   best_eval_score = 0
2023-04-24 12:38:36,847 - Detection -   eval_score = 0.0
2023-04-24 12:38:36,847 - Detection -   train_loss = 7.9113567959178575
2023-04-24 12:38:38,693 - Detection - ***** Epoch: 3: Eval results *****
2023-04-24 12:38:38,693 - Detection -   best_eval_score = 0
2023-04-24 12:38:38,693 - Detection -   eval_score = 0.27
2023-04-24 12:38:38,693 - Detection -   train_loss = 7.488719853487882
2023-04-24 12:38:58,917 - Detection - ***** Epoch: 4: Eval results *****
2023-04-24 12:38:58,917 - Detection -   best_eval_score = 0.27
2023-04-24 12:38:58,917 - Detection -   eval_score = 68.75
2023-04-24 12:38:58,917 - Detection -   train_loss = 7.011354749852961
2023-04-24 12:39:19,407 - Detection - ***** Epoch: 5: Eval results *****
2023-04-24 12:39:19,407 - Detection -   best_eval_score = 68.75
2023-04-24 12:39:19,407 - Detection -   eval_score = 72.84
2023-04-24 12:39:19,407 - Detection -   train_loss = 1.6192774881016125
2023-04-24 12:39:39,551 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 12:39:39,551 - Detection -   best_eval_score = 72.84
2023-04-24 12:39:39,551 - Detection -   eval_score = 72.97
2023-04-24 12:39:39,551 - Detection -   train_loss = 1.431800668889826
2023-04-24 12:39:59,708 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 12:39:59,709 - Detection -   best_eval_score = 72.97
2023-04-24 12:39:59,709 - Detection -   eval_score = 72.78
2023-04-24 12:39:59,709 - Detection -   train_loss = 1.4051712426272305
2023-04-24 12:40:20,011 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 12:40:20,011 - Detection -   best_eval_score = 72.97
2023-04-24 12:40:20,011 - Detection -   eval_score = 72.82
2023-04-24 12:40:20,011 - Detection -   train_loss = 1.3988723429766567
2023-04-24 12:40:40,219 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 12:40:40,219 - Detection -   best_eval_score = 72.97
2023-04-24 12:40:40,219 - Detection -   eval_score = 72.75
2023-04-24 12:40:40,219 - Detection -   train_loss = 1.3840998953038997
2023-04-24 12:41:00,342 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 12:41:00,342 - Detection -   best_eval_score = 72.97
2023-04-24 12:41:00,342 - Detection -   eval_score = 72.79
2023-04-24 12:41:00,342 - Detection -   train_loss = 1.4194745367223567
2023-04-24 12:41:20,511 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 12:41:20,511 - Detection -   best_eval_score = 72.97
2023-04-24 12:41:20,511 - Detection -   eval_score = 72.95
2023-04-24 12:41:20,511 - Detection -   train_loss = 1.3846239285035566
2023-04-24 12:41:40,646 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 12:41:40,646 - Detection -   best_eval_score = 72.97
2023-04-24 12:41:40,646 - Detection -   eval_score = 72.92
2023-04-24 12:41:40,646 - Detection -   train_loss = 1.4314512556249446
2023-04-24 12:42:00,794 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 12:42:00,794 - Detection -   best_eval_score = 72.97
2023-04-24 12:42:00,794 - Detection -   eval_score = 72.87
2023-04-24 12:42:00,794 - Detection -   train_loss = 1.4010664116252551
2023-04-24 12:42:21,023 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 12:42:21,024 - Detection -   best_eval_score = 72.97
2023-04-24 12:42:21,024 - Detection -   eval_score = 72.89
2023-04-24 12:42:21,024 - Detection -   train_loss = 1.3837317119945178
2023-04-24 12:42:41,163 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 12:42:41,163 - Detection -   best_eval_score = 72.97
2023-04-24 12:42:41,163 - Detection -   eval_score = 73.23
2023-04-24 12:42:41,163 - Detection -   train_loss = 1.4341389699415727
2023-04-24 12:43:01,356 - Detection - ***** Epoch: 16: Eval results *****
2023-04-24 12:43:01,357 - Detection -   best_eval_score = 73.23
2023-04-24 12:43:01,357 - Detection -   eval_score = 72.86
2023-04-24 12:43:01,357 - Detection -   train_loss = 1.407556793906472
2023-04-24 12:43:21,706 - Detection - ***** Epoch: 17: Eval results *****
2023-04-24 12:43:21,706 - Detection -   best_eval_score = 73.23
2023-04-24 12:43:21,706 - Detection -   eval_score = 72.84
2023-04-24 12:43:21,706 - Detection -   train_loss = 1.4181209044022993
2023-04-24 12:43:42,016 - Detection - ***** Epoch: 18: Eval results *****
2023-04-24 12:43:42,016 - Detection -   best_eval_score = 73.23
2023-04-24 12:43:42,016 - Detection -   eval_score = 72.77
2023-04-24 12:43:42,016 - Detection -   train_loss = 1.4183719700033015
2023-04-24 12:44:02,194 - Detection - ***** Epoch: 19: Eval results *****
2023-04-24 12:44:02,194 - Detection -   best_eval_score = 73.23
2023-04-24 12:44:02,194 - Detection -   eval_score = 72.91
2023-04-24 12:44:02,194 - Detection -   train_loss = 1.41566124829379
2023-04-24 12:44:22,392 - Detection - ***** Epoch: 20: Eval results *****
2023-04-24 12:44:22,393 - Detection -   best_eval_score = 73.23
2023-04-24 12:44:22,393 - Detection -   eval_score = 73.06
2023-04-24 12:44:22,393 - Detection -   train_loss = 1.443587920882485
2023-04-24 12:44:42,400 - Detection - ***** Epoch: 21: Eval results *****
2023-04-24 12:44:42,400 - Detection -   best_eval_score = 73.23
2023-04-24 12:44:42,400 - Detection -   eval_score = 73.0
2023-04-24 12:44:42,400 - Detection -   train_loss = 1.3805685151707043
2023-04-24 12:45:02,648 - Detection - ***** Epoch: 22: Eval results *****
2023-04-24 12:45:02,648 - Detection -   best_eval_score = 73.23
2023-04-24 12:45:02,648 - Detection -   eval_score = 72.94
2023-04-24 12:45:02,648 - Detection -   train_loss = 1.4363383488221602
2023-04-24 12:45:22,896 - Detection - ***** Epoch: 23: Eval results *****
2023-04-24 12:45:22,896 - Detection -   best_eval_score = 73.23
2023-04-24 12:45:22,897 - Detection -   eval_score = 72.98
2023-04-24 12:45:22,897 - Detection -   train_loss = 1.4350321076133035
2023-04-24 12:45:43,054 - Detection - ***** Epoch: 24: Eval results *****
2023-04-24 12:45:43,055 - Detection -   best_eval_score = 73.23
2023-04-24 12:45:43,055 - Detection -   eval_score = 72.96
2023-04-24 12:45:43,055 - Detection -   train_loss = 1.4215124303644353
2023-04-24 12:46:03,239 - Detection - ***** Epoch: 25: Eval results *****
2023-04-24 12:46:03,239 - Detection -   best_eval_score = 73.23
2023-04-24 12:46:03,239 - Detection -   eval_score = 73.14
2023-04-24 12:46:03,239 - Detection -   train_loss = 1.4218600013039329
2023-04-24 12:46:03,239 - Detection - Training Finished...
2023-04-24 12:46:03,239 - Detection - Testing begin...
2023-04-24 12:46:05,638 - Detection - ***** Test: Confusion Matrix *****
2023-04-24 12:46:05,639 - Detection - [[  87    3    0    0    2    2    0    0    0    0   67]
 [   0   88    0    1    0    0    0    0    0    3   30]
 [   0    0   84    0    4    1    0    0    0    0   39]
 [   4    1    0   84    1    0    1    0    0    0   49]
 [   1    0    3    0  113    0    1    0    0    0   33]
 [   1    0    1    1    2   89    2    0    0    0   75]
 [   4    6    0    0    0    0   85    2    0    0   42]
 [   0    1    0    0    0    0    0   96    0    0   31]
 [   0    0    0    1    0    2    0    2  102    0   25]
 [   1    2    0    0    0    0    0    0    0  136   25]
 [ 104   92    2   40   14   18   59   38    1    4 1097]]
2023-04-24 12:46:05,639 - Detection - ***** Test results *****
2023-04-24 12:46:05,639 - Detection -   Acc = 70.95
2023-04-24 12:46:05,639 - Detection -   F1 = 69.6211
2023-04-24 12:46:05,639 - Detection -   F1-known = 69.2257
2023-04-24 12:46:05,639 - Detection -   F1-open = 73.5748
2023-04-24 12:46:05,639 - Detection - Testing finished...
2023-04-24 12:46:05,639 - Detection - Results saved in results/results_ADB-BOOST-F-10.csv
2023-04-24 12:46:05,658 - Detection - Open Intent Detection Finished...
