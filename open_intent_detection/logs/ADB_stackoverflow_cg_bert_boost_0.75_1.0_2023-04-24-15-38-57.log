2023-04-24 15:38:57,753 - Detection - Open Intent Detection Begin...
2023-04-24 15:38:57,753 - Detection - Parameters Initialization...
2023-04-24 15:38:57,753 - Detection - ============================== Params ==============================
2023-04-24 15:38:57,753 - Detection - type:	open_intent_detection
2023-04-24 15:38:57,753 - Detection - logger_name:	Detection
2023-04-24 15:38:57,753 - Detection - log_dir:	logs
2023-04-24 15:38:57,753 - Detection - dataset:	stackoverflow_cg
2023-04-24 15:38:57,753 - Detection - known_cls_ratio:	0.75
2023-04-24 15:38:57,753 - Detection - labeled_ratio:	1.0
2023-04-24 15:38:57,753 - Detection - method:	ADB
2023-04-24 15:38:57,753 - Detection - train:	True
2023-04-24 15:38:57,753 - Detection - pretrain:	True
2023-04-24 15:38:57,753 - Detection - save_model:	False
2023-04-24 15:38:57,753 - Detection - backbone:	bert_boost
2023-04-24 15:38:57,753 - Detection - config_file_name:	ADB
2023-04-24 15:38:57,754 - Detection - seed:	7
2023-04-24 15:38:57,754 - Detection - gpu_id:	0
2023-04-24 15:38:57,754 - Detection - pipe_results_path:	pipe_results
2023-04-24 15:38:57,754 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-24 15:38:57,754 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-24 15:38:57,754 - Detection - model_dir:	models
2023-04-24 15:38:57,754 - Detection - load_pretrained_method:	None
2023-04-24 15:38:57,754 - Detection - result_dir:	results
2023-04-24 15:38:57,754 - Detection - results_file_name:	results_ADB-BOOST-F-10.csv
2023-04-24 15:38:57,754 - Detection - save_results:	True
2023-04-24 15:38:57,754 - Detection - loss_fct:	CrossEntropyLoss
2023-04-24 15:38:57,754 - Detection - boost_method:	F-10
2023-04-24 15:38:57,754 - Detection - boost_start_score:	0.0
2023-04-24 15:38:57,754 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.75_1.0_bert_boost_7
2023-04-24 15:38:57,754 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.75_1.0_bert_boost_7/models
2023-04-24 15:38:57,754 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-24 15:38:57,754 - Detection - num_train_epochs:	100
2023-04-24 15:38:57,754 - Detection - num_labels:	None
2023-04-24 15:38:57,754 - Detection - max_seq_length:	None
2023-04-24 15:38:57,754 - Detection - freeze_backbone_parameters:	True
2023-04-24 15:38:57,754 - Detection - feat_dim:	768
2023-04-24 15:38:57,754 - Detection - warmup_proportion:	0.1
2023-04-24 15:38:57,754 - Detection - lr_boundary:	0.05
2023-04-24 15:38:57,754 - Detection - lr:	2e-05
2023-04-24 15:38:57,754 - Detection - activation:	relu
2023-04-24 15:38:57,754 - Detection - train_batch_size:	128
2023-04-24 15:38:57,754 - Detection - eval_batch_size:	64
2023-04-24 15:38:57,754 - Detection - test_batch_size:	64
2023-04-24 15:38:57,754 - Detection - wait_patient:	10
2023-04-24 15:38:57,754 - Detection - ============================== End Params ==============================
2023-04-24 15:38:57,754 - Detection - Data and Model Preparation...
2023-04-24 15:38:57,754 - Detection - The number of known intents is 15
2023-04-24 15:38:57,755 - Detection - Lists of known labels are: ['apache', 'svn', 'bash', 'excel', 'oracle', 'ajax', 'visual-studio', 'haskell', 'qt', 'wordpress', 'matlab', 'scala', 'linq', 'spring', 'magento']
2023-04-24 15:38:57,764 - Detection - Number of labeled training samples = 2017
2023-04-24 15:38:57,764 - Detection - Number of unlabeled training samples = 774
2023-04-24 15:38:57,767 - Detection - Number of evaluation samples = 1052
2023-04-24 15:38:57,773 - Detection - Number of testing samples = 2905
2023-04-24 15:39:01,859 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-24 15:39:03,512 - Detection - Pre-training Begin...
2023-04-24 15:39:06,728 - Detection - ***** Epoch: 1: Eval results *****
2023-04-24 15:39:06,728 - Detection -   best_eval_score = 0
2023-04-24 15:39:06,728 - Detection -   eval_score = 5.7
2023-04-24 15:39:06,728 - Detection -   train_loss = 2.7056975215673447
2023-04-24 15:39:36,570 - Detection - ***** Epoch: 2: Eval results *****
2023-04-24 15:39:36,570 - Detection -   best_eval_score = 5.7
2023-04-24 15:39:36,570 - Detection -   eval_score = 37.07
2023-04-24 15:39:36,570 - Detection -   train_loss = 2.69063863158226
2023-04-24 15:40:06,309 - Detection - ***** Epoch: 3: Eval results *****
2023-04-24 15:40:06,309 - Detection -   best_eval_score = 37.07
2023-04-24 15:40:06,309 - Detection -   eval_score = 78.99
2023-04-24 15:40:06,309 - Detection -   train_loss = 2.1046004742383957
2023-04-24 15:40:36,172 - Detection - ***** Epoch: 4: Eval results *****
2023-04-24 15:40:36,173 - Detection -   best_eval_score = 78.99
2023-04-24 15:40:36,173 - Detection -   eval_score = 82.89
2023-04-24 15:40:36,173 - Detection -   train_loss = 1.1552805826067924
2023-04-24 15:41:06,018 - Detection - ***** Epoch: 5: Eval results *****
2023-04-24 15:41:06,018 - Detection -   best_eval_score = 82.89
2023-04-24 15:41:06,018 - Detection -   eval_score = 83.56
2023-04-24 15:41:06,018 - Detection -   train_loss = 0.8018290027976036
2023-04-24 15:41:35,962 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 15:41:35,962 - Detection -   best_eval_score = 83.56
2023-04-24 15:41:35,962 - Detection -   eval_score = 84.03
2023-04-24 15:41:35,962 - Detection -   train_loss = 0.6252403017133474
2023-04-24 15:42:05,911 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 15:42:05,911 - Detection -   best_eval_score = 84.03
2023-04-24 15:42:05,911 - Detection -   eval_score = 84.6
2023-04-24 15:42:05,911 - Detection -   train_loss = 0.49266443215310574
2023-04-24 15:42:35,657 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 15:42:35,657 - Detection -   best_eval_score = 84.6
2023-04-24 15:42:35,657 - Detection -   eval_score = 83.56
2023-04-24 15:42:35,657 - Detection -   train_loss = 0.3958752816542983
2023-04-24 15:43:05,499 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 15:43:05,499 - Detection -   best_eval_score = 84.6
2023-04-24 15:43:05,499 - Detection -   eval_score = 83.17
2023-04-24 15:43:05,499 - Detection -   train_loss = 0.30313430819660425
2023-04-24 15:43:35,443 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 15:43:35,443 - Detection -   best_eval_score = 84.6
2023-04-24 15:43:35,443 - Detection -   eval_score = 82.6
2023-04-24 15:43:35,443 - Detection -   train_loss = 0.23546958342194557
2023-04-24 15:44:05,217 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 15:44:05,217 - Detection -   best_eval_score = 84.6
2023-04-24 15:44:05,217 - Detection -   eval_score = 83.46
2023-04-24 15:44:05,217 - Detection -   train_loss = 0.17788733216002584
2023-04-24 15:44:34,959 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 15:44:34,959 - Detection -   best_eval_score = 84.6
2023-04-24 15:44:34,959 - Detection -   eval_score = 83.56
2023-04-24 15:44:34,959 - Detection -   train_loss = 0.156768886372447
2023-04-24 15:45:04,788 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 15:45:04,788 - Detection -   best_eval_score = 84.6
2023-04-24 15:45:04,788 - Detection -   eval_score = 83.37
2023-04-24 15:45:04,788 - Detection -   train_loss = 0.1238152883015573
2023-04-24 15:45:34,702 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 15:45:34,702 - Detection -   best_eval_score = 84.6
2023-04-24 15:45:34,703 - Detection -   eval_score = 83.94
2023-04-24 15:45:34,703 - Detection -   train_loss = 0.10076413163915277
2023-04-24 15:46:04,640 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 15:46:04,640 - Detection -   best_eval_score = 84.6
2023-04-24 15:46:04,640 - Detection -   eval_score = 83.37
2023-04-24 15:46:04,640 - Detection -   train_loss = 0.09323512576520443
2023-04-24 15:46:34,589 - Detection - ***** Epoch: 16: Eval results *****
2023-04-24 15:46:34,589 - Detection -   best_eval_score = 84.6
2023-04-24 15:46:34,589 - Detection -   eval_score = 83.94
2023-04-24 15:46:34,589 - Detection -   train_loss = 0.07753797806799412
2023-04-24 15:47:04,421 - Detection - ***** Epoch: 17: Eval results *****
2023-04-24 15:47:04,421 - Detection -   best_eval_score = 84.6
2023-04-24 15:47:04,421 - Detection -   eval_score = 84.03
2023-04-24 15:47:04,422 - Detection -   train_loss = 0.06269620812963694
2023-04-24 15:47:04,422 - Detection - Pre-training finished...
2023-04-24 15:47:04,422 - Detection - Training Begin...
2023-04-24 15:47:08,765 - Detection - ***** Epoch: 1: Eval results *****
2023-04-24 15:47:08,765 - Detection -   best_eval_score = 0
2023-04-24 15:47:08,765 - Detection -   eval_score = 0.0
2023-04-24 15:47:08,765 - Detection -   train_loss = 9.518475770950317
2023-04-24 15:47:11,484 - Detection - ***** Epoch: 2: Eval results *****
2023-04-24 15:47:11,485 - Detection -   best_eval_score = 0
2023-04-24 15:47:11,485 - Detection -   eval_score = 0.0
2023-04-24 15:47:11,485 - Detection -   train_loss = 9.02974158525467
2023-04-24 15:47:14,206 - Detection - ***** Epoch: 3: Eval results *****
2023-04-24 15:47:14,206 - Detection -   best_eval_score = 0
2023-04-24 15:47:14,206 - Detection -   eval_score = 0.0
2023-04-24 15:47:14,206 - Detection -   train_loss = 8.383996695280075
2023-04-24 15:47:16,929 - Detection - ***** Epoch: 4: Eval results *****
2023-04-24 15:47:16,929 - Detection -   best_eval_score = 0
2023-04-24 15:47:16,929 - Detection -   eval_score = 0.0
2023-04-24 15:47:16,929 - Detection -   train_loss = 7.5917986035346985
2023-04-24 15:47:19,653 - Detection - ***** Epoch: 5: Eval results *****
2023-04-24 15:47:19,654 - Detection -   best_eval_score = 0
2023-04-24 15:47:19,654 - Detection -   eval_score = 0.47
2023-04-24 15:47:19,654 - Detection -   train_loss = 6.746679097414017
2023-04-24 15:47:49,300 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 15:47:49,300 - Detection -   best_eval_score = 0.47
2023-04-24 15:47:49,300 - Detection -   eval_score = 77.56
2023-04-24 15:47:49,300 - Detection -   train_loss = 5.893262594938278
2023-04-24 15:48:19,076 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 15:48:19,076 - Detection -   best_eval_score = 77.56
2023-04-24 15:48:19,076 - Detection -   eval_score = 77.55
2023-04-24 15:48:19,076 - Detection -   train_loss = 1.5509332939982414
2023-04-24 15:48:48,763 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 15:48:48,764 - Detection -   best_eval_score = 77.56
2023-04-24 15:48:48,764 - Detection -   eval_score = 77.45
2023-04-24 15:48:48,764 - Detection -   train_loss = 1.558277279138565
2023-04-24 15:49:18,357 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 15:49:18,357 - Detection -   best_eval_score = 77.56
2023-04-24 15:49:18,357 - Detection -   eval_score = 77.55
2023-04-24 15:49:18,357 - Detection -   train_loss = 1.5161646530032158
2023-04-24 15:49:47,832 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 15:49:47,832 - Detection -   best_eval_score = 77.56
2023-04-24 15:49:47,832 - Detection -   eval_score = 77.72
2023-04-24 15:49:47,832 - Detection -   train_loss = 1.568578191101551
2023-04-24 15:50:18,372 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 15:50:18,372 - Detection -   best_eval_score = 77.72
2023-04-24 15:50:18,372 - Detection -   eval_score = 77.51
2023-04-24 15:50:18,372 - Detection -   train_loss = 1.537860557436943
2023-04-24 15:50:47,825 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 15:50:47,825 - Detection -   best_eval_score = 77.72
2023-04-24 15:50:47,825 - Detection -   eval_score = 77.49
2023-04-24 15:50:47,825 - Detection -   train_loss = 1.5511250644922256
2023-04-24 15:51:17,441 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 15:51:17,441 - Detection -   best_eval_score = 77.72
2023-04-24 15:51:17,441 - Detection -   eval_score = 77.76
2023-04-24 15:51:17,441 - Detection -   train_loss = 1.5568149089813232
2023-04-24 15:51:47,038 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 15:51:47,038 - Detection -   best_eval_score = 77.76
2023-04-24 15:51:47,038 - Detection -   eval_score = 77.75
2023-04-24 15:51:47,038 - Detection -   train_loss = 1.54453244805336
2023-04-24 15:52:16,696 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 15:52:16,697 - Detection -   best_eval_score = 77.76
2023-04-24 15:52:16,697 - Detection -   eval_score = 77.64
2023-04-24 15:52:16,697 - Detection -   train_loss = 1.5827914699912071
2023-04-24 15:52:46,343 - Detection - ***** Epoch: 16: Eval results *****
2023-04-24 15:52:46,343 - Detection -   best_eval_score = 77.76
2023-04-24 15:52:46,343 - Detection -   eval_score = 77.59
2023-04-24 15:52:46,343 - Detection -   train_loss = 1.5711193904280663
2023-04-24 15:53:15,843 - Detection - ***** Epoch: 17: Eval results *****
2023-04-24 15:53:15,843 - Detection -   best_eval_score = 77.76
2023-04-24 15:53:15,843 - Detection -   eval_score = 77.6
2023-04-24 15:53:15,843 - Detection -   train_loss = 1.569399707019329
2023-04-24 15:53:45,500 - Detection - ***** Epoch: 18: Eval results *****
2023-04-24 15:53:45,500 - Detection -   best_eval_score = 77.76
2023-04-24 15:53:45,500 - Detection -   eval_score = 77.47
2023-04-24 15:53:45,500 - Detection -   train_loss = 1.5337902903556824
2023-04-24 15:54:15,024 - Detection - ***** Epoch: 19: Eval results *****
2023-04-24 15:54:15,024 - Detection -   best_eval_score = 77.76
2023-04-24 15:54:15,024 - Detection -   eval_score = 77.85
2023-04-24 15:54:15,024 - Detection -   train_loss = 1.5348785445094109
2023-04-24 15:54:44,669 - Detection - ***** Epoch: 20: Eval results *****
2023-04-24 15:54:44,669 - Detection -   best_eval_score = 77.85
2023-04-24 15:54:44,669 - Detection -   eval_score = 77.45
2023-04-24 15:54:44,669 - Detection -   train_loss = 1.5899617671966553
2023-04-24 15:55:14,200 - Detection - ***** Epoch: 21: Eval results *****
2023-04-24 15:55:14,200 - Detection -   best_eval_score = 77.85
2023-04-24 15:55:14,200 - Detection -   eval_score = 77.69
2023-04-24 15:55:14,200 - Detection -   train_loss = 1.5601311177015305
2023-04-24 15:55:43,946 - Detection - ***** Epoch: 22: Eval results *****
2023-04-24 15:55:43,946 - Detection -   best_eval_score = 77.85
2023-04-24 15:55:43,946 - Detection -   eval_score = 77.53
2023-04-24 15:55:43,946 - Detection -   train_loss = 1.568899817764759
2023-04-24 15:56:13,429 - Detection - ***** Epoch: 23: Eval results *****
2023-04-24 15:56:13,429 - Detection -   best_eval_score = 77.85
2023-04-24 15:56:13,429 - Detection -   eval_score = 77.54
2023-04-24 15:56:13,429 - Detection -   train_loss = 1.5586137846112251
2023-04-24 15:56:42,971 - Detection - ***** Epoch: 24: Eval results *****
2023-04-24 15:56:42,971 - Detection -   best_eval_score = 77.85
2023-04-24 15:56:42,971 - Detection -   eval_score = 77.65
2023-04-24 15:56:42,972 - Detection -   train_loss = 1.573842667043209
2023-04-24 15:57:13,621 - Detection - ***** Epoch: 25: Eval results *****
2023-04-24 15:57:13,622 - Detection -   best_eval_score = 77.85
2023-04-24 15:57:13,622 - Detection -   eval_score = 77.71
2023-04-24 15:57:13,622 - Detection -   train_loss = 1.5537511929869652
2023-04-24 15:57:43,320 - Detection - ***** Epoch: 26: Eval results *****
2023-04-24 15:57:43,320 - Detection -   best_eval_score = 77.85
2023-04-24 15:57:43,320 - Detection -   eval_score = 77.73
2023-04-24 15:57:43,320 - Detection -   train_loss = 1.559851996600628
2023-04-24 15:58:12,939 - Detection - ***** Epoch: 27: Eval results *****
2023-04-24 15:58:12,940 - Detection -   best_eval_score = 77.85
2023-04-24 15:58:12,940 - Detection -   eval_score = 77.49
2023-04-24 15:58:12,940 - Detection -   train_loss = 1.5589424073696136
2023-04-24 15:58:42,566 - Detection - ***** Epoch: 28: Eval results *****
2023-04-24 15:58:42,566 - Detection -   best_eval_score = 77.85
2023-04-24 15:58:42,566 - Detection -   eval_score = 77.84
2023-04-24 15:58:42,566 - Detection -   train_loss = 1.5521651357412338
2023-04-24 15:59:12,105 - Detection - ***** Epoch: 29: Eval results *****
2023-04-24 15:59:12,105 - Detection -   best_eval_score = 77.85
2023-04-24 15:59:12,105 - Detection -   eval_score = 77.49
2023-04-24 15:59:12,105 - Detection -   train_loss = 1.5696494281291962
2023-04-24 15:59:12,105 - Detection - Training Finished...
2023-04-24 15:59:12,105 - Detection - Testing begin...
2023-04-24 15:59:14,498 - Detection - ***** Test: Confusion Matrix *****
2023-04-24 15:59:14,499 - Detection - [[ 97   2   1   0   1   3   0   1   0   1   0   0   0   0   0  64]
 [  1 108   0   0   0   0   2   1   0   0   0   0   0   0   0  37]
 [  0   0  90   0   0   3   0   1   0   0   0   1   0   0   0  44]
 [  0   0   0  89   2   0   0   0   0   0   2   2   0   0   0  45]
 [  0   0   0   2  98   0   0   2   0   0   0   0   0   0   0  25]
 [  2   0   1   2   0 121   0   1   0   1   0   0   0   0   0  32]
 [  0   3   0   3   1   4  40   0   0   0   0   0   0   0   0  55]
 [  0   0   0   1   0   1   1  87   0   0   2   1   0   0   0  29]
 [  0   0   0   0   0   0   0   0 150   0   0   1   0   0   0  21]
 [  3   0   0   0   0   3   0   0   0 102   0   0   0   0   0  29]
 [  0   0   0   0   0   0   0   1   0   0 134   2   0   0   0  27]
 [  0   0   0   1   0   1   0   4   0   0   0  78   0   0   0  40]
 [  0   0   0   0   1   0   0   0   0   0   0   2  99   0   0  29]
 [  1   0   0   0   0   1   0   0   0   0   0   0   0 123   0  26]
 [  1   0   0   0   1   0   0   0   1   0   0   0   0   0 103  26]
 [ 11   4  16   3  17  42  12  11   5   1   1   3   0  35   2 618]]
2023-04-24 15:59:14,499 - Detection - ***** Test results *****
2023-04-24 15:59:14,499 - Detection -   Acc = 73.56
2023-04-24 15:59:14,499 - Detection -   F1 = 76.5647
2023-04-24 15:59:14,499 - Detection -   F1-known = 77.3951
2023-04-24 15:59:14,499 - Detection -   F1-open = 64.1079
2023-04-24 15:59:14,499 - Detection - Testing finished...
2023-04-24 15:59:14,499 - Detection - Results saved in results/results_ADB-BOOST-F-10.csv
2023-04-24 15:59:14,518 - Detection - Open Intent Detection Finished...
