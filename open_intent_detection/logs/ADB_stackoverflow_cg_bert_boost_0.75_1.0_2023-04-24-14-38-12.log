2023-04-24 14:38:12,709 - Detection - Open Intent Detection Begin...
2023-04-24 14:38:12,710 - Detection - Parameters Initialization...
2023-04-24 14:38:12,710 - Detection - ============================== Params ==============================
2023-04-24 14:38:12,710 - Detection - type:	open_intent_detection
2023-04-24 14:38:12,710 - Detection - logger_name:	Detection
2023-04-24 14:38:12,710 - Detection - log_dir:	logs
2023-04-24 14:38:12,710 - Detection - dataset:	stackoverflow_cg
2023-04-24 14:38:12,710 - Detection - known_cls_ratio:	0.75
2023-04-24 14:38:12,710 - Detection - labeled_ratio:	1.0
2023-04-24 14:38:12,710 - Detection - method:	ADB
2023-04-24 14:38:12,710 - Detection - train:	True
2023-04-24 14:38:12,710 - Detection - pretrain:	True
2023-04-24 14:38:12,710 - Detection - save_model:	False
2023-04-24 14:38:12,710 - Detection - backbone:	bert_boost
2023-04-24 14:38:12,710 - Detection - config_file_name:	ADB
2023-04-24 14:38:12,710 - Detection - seed:	4
2023-04-24 14:38:12,710 - Detection - gpu_id:	0
2023-04-24 14:38:12,710 - Detection - pipe_results_path:	pipe_results
2023-04-24 14:38:12,710 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-24 14:38:12,710 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-24 14:38:12,710 - Detection - model_dir:	models
2023-04-24 14:38:12,710 - Detection - load_pretrained_method:	None
2023-04-24 14:38:12,710 - Detection - result_dir:	results
2023-04-24 14:38:12,710 - Detection - results_file_name:	results_ADB-BOOST-F-10.csv
2023-04-24 14:38:12,710 - Detection - save_results:	True
2023-04-24 14:38:12,710 - Detection - loss_fct:	CrossEntropyLoss
2023-04-24 14:38:12,710 - Detection - boost_method:	F-10
2023-04-24 14:38:12,710 - Detection - boost_start_score:	0.0
2023-04-24 14:38:12,710 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.75_1.0_bert_boost_4
2023-04-24 14:38:12,710 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.75_1.0_bert_boost_4/models
2023-04-24 14:38:12,710 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-24 14:38:12,710 - Detection - num_train_epochs:	100
2023-04-24 14:38:12,710 - Detection - num_labels:	None
2023-04-24 14:38:12,710 - Detection - max_seq_length:	None
2023-04-24 14:38:12,710 - Detection - freeze_backbone_parameters:	True
2023-04-24 14:38:12,710 - Detection - feat_dim:	768
2023-04-24 14:38:12,710 - Detection - warmup_proportion:	0.1
2023-04-24 14:38:12,710 - Detection - lr_boundary:	0.05
2023-04-24 14:38:12,710 - Detection - lr:	2e-05
2023-04-24 14:38:12,710 - Detection - activation:	relu
2023-04-24 14:38:12,710 - Detection - train_batch_size:	128
2023-04-24 14:38:12,710 - Detection - eval_batch_size:	64
2023-04-24 14:38:12,710 - Detection - test_batch_size:	64
2023-04-24 14:38:12,710 - Detection - wait_patient:	10
2023-04-24 14:38:12,710 - Detection - ============================== End Params ==============================
2023-04-24 14:38:12,711 - Detection - Data and Model Preparation...
2023-04-24 14:38:12,711 - Detection - The number of known intents is 15
2023-04-24 14:38:12,711 - Detection - Lists of known labels are: ['wordpress', 'cocoa', 'visual-studio', 'haskell', 'qt', 'drupal', 'ajax', 'svn', 'osx', 'oracle', 'sharepoint', 'matlab', 'magento', 'bash', 'spring']
2023-04-24 14:38:12,720 - Detection - Number of labeled training samples = 2172
2023-04-24 14:38:12,721 - Detection - Number of unlabeled training samples = 619
2023-04-24 14:38:12,723 - Detection - Number of evaluation samples = 1054
2023-04-24 14:38:12,729 - Detection - Number of testing samples = 2905
2023-04-24 14:38:16,925 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-24 14:38:18,595 - Detection - Pre-training Begin...
2023-04-24 14:38:21,949 - Detection - ***** Epoch: 1: Eval results *****
2023-04-24 14:38:21,949 - Detection -   best_eval_score = 0
2023-04-24 14:38:21,949 - Detection -   eval_score = 6.93
2023-04-24 14:38:21,949 - Detection -   train_loss = 2.7132636939778045
2023-04-24 14:38:54,020 - Detection - ***** Epoch: 2: Eval results *****
2023-04-24 14:38:54,020 - Detection -   best_eval_score = 6.93
2023-04-24 14:38:54,020 - Detection -   eval_score = 30.17
2023-04-24 14:38:54,020 - Detection -   train_loss = 2.6966106751385857
2023-04-24 14:39:25,892 - Detection - ***** Epoch: 3: Eval results *****
2023-04-24 14:39:25,892 - Detection -   best_eval_score = 30.17
2023-04-24 14:39:25,892 - Detection -   eval_score = 74.57
2023-04-24 14:39:25,892 - Detection -   train_loss = 2.218035165001364
2023-04-24 14:39:57,848 - Detection - ***** Epoch: 4: Eval results *****
2023-04-24 14:39:57,849 - Detection -   best_eval_score = 74.57
2023-04-24 14:39:57,849 - Detection -   eval_score = 79.7
2023-04-24 14:39:57,849 - Detection -   train_loss = 1.2485920962165384
2023-04-24 14:40:29,729 - Detection - ***** Epoch: 5: Eval results *****
2023-04-24 14:40:29,729 - Detection -   best_eval_score = 79.7
2023-04-24 14:40:29,729 - Detection -   eval_score = 80.27
2023-04-24 14:40:29,729 - Detection -   train_loss = 0.8649588683072258
2023-04-24 14:41:01,741 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 14:41:01,741 - Detection -   best_eval_score = 80.27
2023-04-24 14:41:01,741 - Detection -   eval_score = 81.12
2023-04-24 14:41:01,741 - Detection -   train_loss = 0.6924161279902739
2023-04-24 14:41:33,657 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 14:41:33,657 - Detection -   best_eval_score = 81.12
2023-04-24 14:41:33,657 - Detection -   eval_score = 81.02
2023-04-24 14:41:33,657 - Detection -   train_loss = 0.5622714810511645
2023-04-24 14:42:05,701 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 14:42:05,701 - Detection -   best_eval_score = 81.12
2023-04-24 14:42:05,701 - Detection -   eval_score = 80.83
2023-04-24 14:42:05,701 - Detection -   train_loss = 0.44764691766570597
2023-04-24 14:42:37,666 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 14:42:37,666 - Detection -   best_eval_score = 81.12
2023-04-24 14:42:37,666 - Detection -   eval_score = 80.36
2023-04-24 14:42:37,666 - Detection -   train_loss = 0.35026538021424236
2023-04-24 14:43:09,770 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 14:43:09,770 - Detection -   best_eval_score = 81.12
2023-04-24 14:43:09,770 - Detection -   eval_score = 81.12
2023-04-24 14:43:09,771 - Detection -   train_loss = 0.29942702808800864
2023-04-24 14:43:41,682 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 14:43:41,682 - Detection -   best_eval_score = 81.12
2023-04-24 14:43:41,682 - Detection -   eval_score = 80.46
2023-04-24 14:43:41,682 - Detection -   train_loss = 0.2150818135808496
2023-04-24 14:44:13,668 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 14:44:13,668 - Detection -   best_eval_score = 81.12
2023-04-24 14:44:13,668 - Detection -   eval_score = 81.12
2023-04-24 14:44:13,668 - Detection -   train_loss = 0.18074814449338353
2023-04-24 14:44:45,564 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 14:44:45,564 - Detection -   best_eval_score = 81.12
2023-04-24 14:44:45,564 - Detection -   eval_score = 80.74
2023-04-24 14:44:45,564 - Detection -   train_loss = 0.1554024149389828
2023-04-24 14:45:17,528 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 14:45:17,528 - Detection -   best_eval_score = 81.12
2023-04-24 14:45:17,528 - Detection -   eval_score = 81.21
2023-04-24 14:45:17,528 - Detection -   train_loss = 0.12257630334180944
2023-04-24 14:45:49,579 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 14:45:49,579 - Detection -   best_eval_score = 81.21
2023-04-24 14:45:49,579 - Detection -   eval_score = 81.02
2023-04-24 14:45:49,579 - Detection -   train_loss = 0.1039965886841802
2023-04-24 14:46:21,575 - Detection - ***** Epoch: 16: Eval results *****
2023-04-24 14:46:21,575 - Detection -   best_eval_score = 81.21
2023-04-24 14:46:21,575 - Detection -   eval_score = 81.02
2023-04-24 14:46:21,575 - Detection -   train_loss = 0.09563055985114154
2023-04-24 14:46:53,491 - Detection - ***** Epoch: 17: Eval results *****
2023-04-24 14:46:53,492 - Detection -   best_eval_score = 81.21
2023-04-24 14:46:53,492 - Detection -   eval_score = 80.83
2023-04-24 14:46:53,492 - Detection -   train_loss = 0.06919565731111695
2023-04-24 14:47:25,445 - Detection - ***** Epoch: 18: Eval results *****
2023-04-24 14:47:25,445 - Detection -   best_eval_score = 81.21
2023-04-24 14:47:25,445 - Detection -   eval_score = 81.12
2023-04-24 14:47:25,446 - Detection -   train_loss = 0.06747327481999117
2023-04-24 14:47:57,386 - Detection - ***** Epoch: 19: Eval results *****
2023-04-24 14:47:57,386 - Detection -   best_eval_score = 81.21
2023-04-24 14:47:57,386 - Detection -   eval_score = 81.02
2023-04-24 14:47:57,387 - Detection -   train_loss = 0.06568112914614818
2023-04-24 14:48:29,331 - Detection - ***** Epoch: 20: Eval results *****
2023-04-24 14:48:29,331 - Detection -   best_eval_score = 81.21
2023-04-24 14:48:29,331 - Detection -   eval_score = 81.02
2023-04-24 14:48:29,331 - Detection -   train_loss = 0.050050174379173445
2023-04-24 14:49:01,350 - Detection - ***** Epoch: 21: Eval results *****
2023-04-24 14:49:01,350 - Detection -   best_eval_score = 81.21
2023-04-24 14:49:01,350 - Detection -   eval_score = 80.83
2023-04-24 14:49:01,350 - Detection -   train_loss = 0.05352160367457306
2023-04-24 14:49:33,334 - Detection - ***** Epoch: 22: Eval results *****
2023-04-24 14:49:33,334 - Detection -   best_eval_score = 81.21
2023-04-24 14:49:33,334 - Detection -   eval_score = 80.65
2023-04-24 14:49:33,334 - Detection -   train_loss = 0.04174366363269441
2023-04-24 14:50:05,330 - Detection - ***** Epoch: 23: Eval results *****
2023-04-24 14:50:05,330 - Detection -   best_eval_score = 81.21
2023-04-24 14:50:05,330 - Detection -   eval_score = 80.74
2023-04-24 14:50:05,330 - Detection -   train_loss = 0.04004996938302236
2023-04-24 14:50:37,330 - Detection - ***** Epoch: 24: Eval results *****
2023-04-24 14:50:37,330 - Detection -   best_eval_score = 81.21
2023-04-24 14:50:37,330 - Detection -   eval_score = 80.74
2023-04-24 14:50:37,330 - Detection -   train_loss = 0.03794377401252003
2023-04-24 14:50:37,331 - Detection - Pre-training finished...
2023-04-24 14:50:37,331 - Detection - Training Begin...
2023-04-24 14:50:41,929 - Detection - ***** Epoch: 1: Eval results *****
2023-04-24 14:50:41,930 - Detection -   best_eval_score = 0
2023-04-24 14:50:41,930 - Detection -   eval_score = 0.0
2023-04-24 14:50:41,930 - Detection -   train_loss = 13.106952667236328
2023-04-24 14:50:44,785 - Detection - ***** Epoch: 2: Eval results *****
2023-04-24 14:50:44,785 - Detection -   best_eval_score = 0
2023-04-24 14:50:44,785 - Detection -   eval_score = 0.0
2023-04-24 14:50:44,785 - Detection -   train_loss = 12.557034436394186
2023-04-24 14:50:47,645 - Detection - ***** Epoch: 3: Eval results *****
2023-04-24 14:50:47,645 - Detection -   best_eval_score = 0
2023-04-24 14:50:47,645 - Detection -   eval_score = 0.0
2023-04-24 14:50:47,645 - Detection -   train_loss = 11.875461073482738
2023-04-24 14:50:50,509 - Detection - ***** Epoch: 4: Eval results *****
2023-04-24 14:50:50,509 - Detection -   best_eval_score = 0
2023-04-24 14:50:50,509 - Detection -   eval_score = 0.0
2023-04-24 14:50:50,509 - Detection -   train_loss = 11.08064780515783
2023-04-24 14:50:53,374 - Detection - ***** Epoch: 5: Eval results *****
2023-04-24 14:50:53,374 - Detection -   best_eval_score = 0
2023-04-24 14:50:53,374 - Detection -   eval_score = 0.0
2023-04-24 14:50:53,374 - Detection -   train_loss = 10.092662923476276
2023-04-24 14:50:56,238 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 14:50:56,238 - Detection -   best_eval_score = 0
2023-04-24 14:50:56,238 - Detection -   eval_score = 0.49
2023-04-24 14:50:56,238 - Detection -   train_loss = 9.179239048677331
2023-04-24 14:51:28,078 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 14:51:28,078 - Detection -   best_eval_score = 0.49
2023-04-24 14:51:28,078 - Detection -   eval_score = 74.09
2023-04-24 14:51:28,078 - Detection -   train_loss = 8.225890580345602
2023-04-24 14:52:00,039 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 14:52:00,039 - Detection -   best_eval_score = 74.09
2023-04-24 14:52:00,039 - Detection -   eval_score = 74.58
2023-04-24 14:52:00,039 - Detection -   train_loss = 1.8147098036373364
2023-04-24 14:52:31,843 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 14:52:31,843 - Detection -   best_eval_score = 74.58
2023-04-24 14:52:31,843 - Detection -   eval_score = 74.51
2023-04-24 14:52:31,843 - Detection -   train_loss = 1.786407049964456
2023-04-24 14:53:03,655 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 14:53:03,655 - Detection -   best_eval_score = 74.58
2023-04-24 14:53:03,655 - Detection -   eval_score = 74.73
2023-04-24 14:53:03,655 - Detection -   train_loss = 1.7764654299792122
2023-04-24 14:53:35,285 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 14:53:35,285 - Detection -   best_eval_score = 74.73
2023-04-24 14:53:35,285 - Detection -   eval_score = 74.65
2023-04-24 14:53:35,285 - Detection -   train_loss = 1.8257211937623865
2023-04-24 14:54:06,938 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 14:54:06,938 - Detection -   best_eval_score = 74.73
2023-04-24 14:54:06,939 - Detection -   eval_score = 74.66
2023-04-24 14:54:06,939 - Detection -   train_loss = 1.7884545957340914
2023-04-24 14:54:38,541 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 14:54:38,541 - Detection -   best_eval_score = 74.73
2023-04-24 14:54:38,541 - Detection -   eval_score = 74.47
2023-04-24 14:54:38,541 - Detection -   train_loss = 1.7370335635016947
2023-04-24 14:55:10,164 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 14:55:10,164 - Detection -   best_eval_score = 74.73
2023-04-24 14:55:10,164 - Detection -   eval_score = 74.37
2023-04-24 14:55:10,164 - Detection -   train_loss = 1.8165046888239242
2023-04-24 14:55:41,972 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 14:55:41,972 - Detection -   best_eval_score = 74.73
2023-04-24 14:55:41,972 - Detection -   eval_score = 74.62
2023-04-24 14:55:41,972 - Detection -   train_loss = 1.7977901837405037
2023-04-24 14:56:13,592 - Detection - ***** Epoch: 16: Eval results *****
2023-04-24 14:56:13,592 - Detection -   best_eval_score = 74.73
2023-04-24 14:56:13,592 - Detection -   eval_score = 74.43
2023-04-24 14:56:13,592 - Detection -   train_loss = 1.7529782197054695
2023-04-24 14:56:45,231 - Detection - ***** Epoch: 17: Eval results *****
2023-04-24 14:56:45,231 - Detection -   best_eval_score = 74.73
2023-04-24 14:56:45,231 - Detection -   eval_score = 74.7
2023-04-24 14:56:45,231 - Detection -   train_loss = 1.7489647514679854
2023-04-24 14:57:16,909 - Detection - ***** Epoch: 18: Eval results *****
2023-04-24 14:57:16,909 - Detection -   best_eval_score = 74.73
2023-04-24 14:57:16,909 - Detection -   eval_score = 74.41
2023-04-24 14:57:16,909 - Detection -   train_loss = 1.7758902451571297
2023-04-24 14:57:48,676 - Detection - ***** Epoch: 19: Eval results *****
2023-04-24 14:57:48,676 - Detection -   best_eval_score = 74.73
2023-04-24 14:57:48,676 - Detection -   eval_score = 74.52
2023-04-24 14:57:48,676 - Detection -   train_loss = 1.7900527365067427
2023-04-24 14:58:20,302 - Detection - ***** Epoch: 20: Eval results *****
2023-04-24 14:58:20,302 - Detection -   best_eval_score = 74.73
2023-04-24 14:58:20,302 - Detection -   eval_score = 74.73
2023-04-24 14:58:20,302 - Detection -   train_loss = 1.7788290276246912
2023-04-24 14:58:20,302 - Detection - Training Finished...
2023-04-24 14:58:20,302 - Detection - Testing begin...
2023-04-24 14:58:22,696 - Detection - ***** Test: Confusion Matrix *****
2023-04-24 14:58:22,697 - Detection - [[106   0   0   0   0   0   0   0   0   0   0   0   0   1   0  30]
 [  0  77   0   0   2   0   0   0  13   0   0   0   0   0   0  69]
 [  0   2  42   0   0   0   0   1   2   0   2   0   0   0   0  57]
 [  0   1   0  84   0   0   0   0   0   0   0   1   0   0   0  36]
 [  0   1   0   0 151   0   0   0   0   0   0   0   0   0   0  20]
 [  0   0   0   0   0  90   0   0   0   1   0   0   0   0   0  37]
 [  1   1   1   0   0   0 110   0   1   0   2   0   0   0   0  44]
 [  0   0   2   0   1   0   0  97   1   0   0   0   0   0   0  48]
 [  0  31   1   1   2   0   0   1 103   0   0   0   0   0   0  54]
 [  0   0   0   0   0   0   0   0   0  95   0   0   0   0   0  32]
 [  0   0   2   0   0   0   1   0   0   0 105   0   0   1   0  62]
 [  0   2   0   0   0   0   0   0   0   0   0 133   0   0   0  29]
 [  0   0   0   0   1   0   0   0   0   1   1   0 101   0   0  28]
 [  0   2   0   1   0   0   1   0   5   0   0   0   0  80   0  50]
 [  0   1   0   0   0   0   0   0   0   0   0   0   0   0 117  33]
 [  2  11   9  12   0   2  14   3   7   9   3   2   0   3  13 603]]
2023-04-24 14:58:22,697 - Detection - ***** Test results *****
2023-04-24 14:58:22,697 - Detection -   Acc = 72.08
2023-04-24 14:58:22,697 - Detection -   F1 = 75.412
2023-04-24 14:58:22,697 - Detection -   F1-known = 76.2629
2023-04-24 14:58:22,697 - Detection -   F1-open = 62.6494
2023-04-24 14:58:22,697 - Detection - Testing finished...
2023-04-24 14:58:22,697 - Detection - Results saved in results/results_ADB-BOOST-F-10.csv
2023-04-24 14:58:22,716 - Detection - Open Intent Detection Finished...
