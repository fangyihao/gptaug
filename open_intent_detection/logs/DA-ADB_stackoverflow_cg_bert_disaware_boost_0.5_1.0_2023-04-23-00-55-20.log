2023-04-23 00:55:20,534 - Detection - Open Intent Detection Begin...
2023-04-23 00:55:20,534 - Detection - Parameters Initialization...
2023-04-23 00:55:20,534 - Detection - ============================== Params ==============================
2023-04-23 00:55:20,534 - Detection - type:	open_intent_detection
2023-04-23 00:55:20,534 - Detection - logger_name:	Detection
2023-04-23 00:55:20,534 - Detection - log_dir:	logs
2023-04-23 00:55:20,534 - Detection - dataset:	stackoverflow_cg
2023-04-23 00:55:20,534 - Detection - known_cls_ratio:	0.5
2023-04-23 00:55:20,534 - Detection - labeled_ratio:	1.0
2023-04-23 00:55:20,534 - Detection - method:	DA-ADB
2023-04-23 00:55:20,534 - Detection - train:	True
2023-04-23 00:55:20,534 - Detection - pretrain:	True
2023-04-23 00:55:20,534 - Detection - save_model:	False
2023-04-23 00:55:20,534 - Detection - backbone:	bert_disaware_boost
2023-04-23 00:55:20,534 - Detection - config_file_name:	DA-ADB
2023-04-23 00:55:20,534 - Detection - seed:	6
2023-04-23 00:55:20,534 - Detection - gpu_id:	0
2023-04-23 00:55:20,534 - Detection - pipe_results_path:	pipe_results
2023-04-23 00:55:20,534 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-23 00:55:20,534 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-23 00:55:20,535 - Detection - model_dir:	models
2023-04-23 00:55:20,535 - Detection - load_pretrained_method:	None
2023-04-23 00:55:20,535 - Detection - result_dir:	results
2023-04-23 00:55:20,535 - Detection - results_file_name:	results_DA-ADB-BOOST-F-4.csv
2023-04-23 00:55:20,535 - Detection - save_results:	True
2023-04-23 00:55:20,535 - Detection - loss_fct:	CrossEntropyLoss
2023-04-23 00:55:20,535 - Detection - boost_method:	F-4
2023-04-23 00:55:20,535 - Detection - boost_start_score:	0.0
2023-04-23 00:55:20,535 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.5_1.0_bert_disaware_boost_6
2023-04-23 00:55:20,535 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.5_1.0_bert_disaware_boost_6/models
2023-04-23 00:55:20,535 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-23 00:55:20,535 - Detection - num_train_epochs:	100
2023-04-23 00:55:20,535 - Detection - num_labels:	None
2023-04-23 00:55:20,535 - Detection - max_seq_length:	None
2023-04-23 00:55:20,535 - Detection - freeze_backbone_parameters:	True
2023-04-23 00:55:20,535 - Detection - feat_dim:	768
2023-04-23 00:55:20,535 - Detection - warmup_proportion:	0.1
2023-04-23 00:55:20,535 - Detection - scale:	4
2023-04-23 00:55:20,535 - Detection - lr_boundary:	0.05
2023-04-23 00:55:20,535 - Detection - lr:	2e-05
2023-04-23 00:55:20,535 - Detection - activation:	relu
2023-04-23 00:55:20,535 - Detection - train_batch_size:	128
2023-04-23 00:55:20,535 - Detection - eval_batch_size:	64
2023-04-23 00:55:20,535 - Detection - test_batch_size:	64
2023-04-23 00:55:20,535 - Detection - wait_patient:	10
2023-04-23 00:55:20,535 - Detection - ============================== End Params ==============================
2023-04-23 00:55:20,535 - Detection - Data and Model Preparation...
2023-04-23 00:55:20,535 - Detection - The number of known intents is 10
2023-04-23 00:55:20,536 - Detection - Lists of known labels are: ['svn', 'hibernate', 'excel', 'haskell', 'linq', 'bash', 'sharepoint', 'scala', 'drupal', 'oracle']
2023-04-23 00:55:20,543 - Detection - Number of labeled training samples = 1218
2023-04-23 00:55:20,543 - Detection - Number of unlabeled training samples = 1573
2023-04-23 00:55:20,546 - Detection - Number of evaluation samples = 722
2023-04-23 00:55:20,552 - Detection - Number of testing samples = 2905
2023-04-23 00:55:26,185 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-23 00:55:26,299 - Detection - Pre-training Begin...
2023-04-23 00:55:29,030 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 00:55:29,030 - Detection -   best_eval_score = 0
2023-04-23 00:55:29,030 - Detection -   eval_score = 4.38
2023-04-23 00:55:29,030 - Detection -   train_loss = 2.297311782836914
2023-04-23 00:55:36,948 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 00:55:36,948 - Detection -   best_eval_score = 4.38
2023-04-23 00:55:36,948 - Detection -   eval_score = 4.47
2023-04-23 00:55:36,948 - Detection -   train_loss = 2.291399836540222
2023-04-23 00:55:44,716 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 00:55:44,716 - Detection -   best_eval_score = 4.47
2023-04-23 00:55:44,716 - Detection -   eval_score = 13.79
2023-04-23 00:55:44,716 - Detection -   train_loss = 2.2523389577865602
2023-04-23 00:55:52,489 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 00:55:52,490 - Detection -   best_eval_score = 13.79
2023-04-23 00:55:52,490 - Detection -   eval_score = 40.02
2023-04-23 00:55:52,490 - Detection -   train_loss = 2.1612792730331423
2023-04-23 00:56:00,387 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 00:56:00,387 - Detection -   best_eval_score = 40.02
2023-04-23 00:56:00,387 - Detection -   eval_score = 74.2
2023-04-23 00:56:00,388 - Detection -   train_loss = 1.949859607219696
2023-04-23 00:56:08,151 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 00:56:08,151 - Detection -   best_eval_score = 74.2
2023-04-23 00:56:08,151 - Detection -   eval_score = 83.7
2023-04-23 00:56:08,151 - Detection -   train_loss = 1.5456344723701476
2023-04-23 00:56:16,048 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 00:56:16,048 - Detection -   best_eval_score = 83.7
2023-04-23 00:56:16,048 - Detection -   eval_score = 85.18
2023-04-23 00:56:16,048 - Detection -   train_loss = 1.1860971808433534
2023-04-23 00:56:23,970 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 00:56:23,970 - Detection -   best_eval_score = 85.18
2023-04-23 00:56:23,970 - Detection -   eval_score = 84.55
2023-04-23 00:56:23,970 - Detection -   train_loss = 0.9915378212928772
2023-04-23 00:56:31,739 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 00:56:31,739 - Detection -   best_eval_score = 85.18
2023-04-23 00:56:31,739 - Detection -   eval_score = 86.25
2023-04-23 00:56:31,739 - Detection -   train_loss = 0.8835081934928894
2023-04-23 00:56:39,739 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 00:56:39,739 - Detection -   best_eval_score = 86.25
2023-04-23 00:56:39,739 - Detection -   eval_score = 86.02
2023-04-23 00:56:39,739 - Detection -   train_loss = 0.8281805038452148
2023-04-23 00:56:47,539 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 00:56:47,539 - Detection -   best_eval_score = 86.25
2023-04-23 00:56:47,539 - Detection -   eval_score = 85.72
2023-04-23 00:56:47,539 - Detection -   train_loss = 0.725412768125534
2023-04-23 00:56:55,469 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 00:56:55,470 - Detection -   best_eval_score = 86.25
2023-04-23 00:56:55,470 - Detection -   eval_score = 86.09
2023-04-23 00:56:55,470 - Detection -   train_loss = 0.6590551555156707
2023-04-23 00:57:03,263 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 00:57:03,263 - Detection -   best_eval_score = 86.25
2023-04-23 00:57:03,263 - Detection -   eval_score = 85.89
2023-04-23 00:57:03,263 - Detection -   train_loss = 0.6018887877464294
2023-04-23 00:57:11,059 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 00:57:11,059 - Detection -   best_eval_score = 86.25
2023-04-23 00:57:11,059 - Detection -   eval_score = 86.62
2023-04-23 00:57:11,059 - Detection -   train_loss = 0.5598555982112885
2023-04-23 00:57:18,983 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 00:57:18,984 - Detection -   best_eval_score = 86.62
2023-04-23 00:57:18,984 - Detection -   eval_score = 86.57
2023-04-23 00:57:18,984 - Detection -   train_loss = 0.5241166770458221
2023-04-23 00:57:26,775 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 00:57:26,775 - Detection -   best_eval_score = 86.62
2023-04-23 00:57:26,775 - Detection -   eval_score = 85.5
2023-04-23 00:57:26,775 - Detection -   train_loss = 0.4921466648578644
2023-04-23 00:57:34,648 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 00:57:34,648 - Detection -   best_eval_score = 86.62
2023-04-23 00:57:34,648 - Detection -   eval_score = 85.75
2023-04-23 00:57:34,648 - Detection -   train_loss = 0.4662142813205719
2023-04-23 00:57:42,621 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 00:57:42,621 - Detection -   best_eval_score = 86.62
2023-04-23 00:57:42,621 - Detection -   eval_score = 86.18
2023-04-23 00:57:42,621 - Detection -   train_loss = 0.43761408030986787
2023-04-23 00:57:50,449 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 00:57:50,449 - Detection -   best_eval_score = 86.62
2023-04-23 00:57:50,449 - Detection -   eval_score = 85.18
2023-04-23 00:57:50,449 - Detection -   train_loss = 0.4041824728250504
2023-04-23 00:57:58,241 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 00:57:58,241 - Detection -   best_eval_score = 86.62
2023-04-23 00:57:58,241 - Detection -   eval_score = 86.48
2023-04-23 00:57:58,241 - Detection -   train_loss = 0.387898775935173
2023-04-23 00:58:06,288 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 00:58:06,288 - Detection -   best_eval_score = 86.62
2023-04-23 00:58:06,288 - Detection -   eval_score = 85.9
2023-04-23 00:58:06,288 - Detection -   train_loss = 0.36571081876754763
2023-04-23 00:58:14,085 - Detection - ***** Epoch: 22: Eval results *****
2023-04-23 00:58:14,085 - Detection -   best_eval_score = 86.62
2023-04-23 00:58:14,085 - Detection -   eval_score = 85.81
2023-04-23 00:58:14,086 - Detection -   train_loss = 0.36603628695011137
2023-04-23 00:58:22,018 - Detection - ***** Epoch: 23: Eval results *****
2023-04-23 00:58:22,018 - Detection -   best_eval_score = 86.62
2023-04-23 00:58:22,018 - Detection -   eval_score = 86.22
2023-04-23 00:58:22,018 - Detection -   train_loss = 0.3437947481870651
2023-04-23 00:58:29,834 - Detection - ***** Epoch: 24: Eval results *****
2023-04-23 00:58:29,834 - Detection -   best_eval_score = 86.62
2023-04-23 00:58:29,834 - Detection -   eval_score = 85.78
2023-04-23 00:58:29,834 - Detection -   train_loss = 0.33532716929912565
2023-04-23 00:58:29,834 - Detection - Pre-training finished...
2023-04-23 00:58:29,835 - Detection - Training Begin...
2023-04-23 00:58:31,094 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 00:58:31,095 - Detection -   best_eval_score = 0
2023-04-23 00:58:31,095 - Detection -   eval_score = 0.0
2023-04-23 00:58:31,095 - Detection -   train_loss = 4.21987738609314
2023-04-23 00:58:32,354 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 00:58:32,355 - Detection -   best_eval_score = 0
2023-04-23 00:58:32,355 - Detection -   eval_score = 0.0
2023-04-23 00:58:32,355 - Detection -   train_loss = 3.9141700744628904
2023-04-23 00:58:33,616 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 00:58:33,616 - Detection -   best_eval_score = 0
2023-04-23 00:58:33,616 - Detection -   eval_score = 3.07
2023-04-23 00:58:33,616 - Detection -   train_loss = 3.5400453329086305
2023-04-23 00:58:40,619 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 00:58:40,619 - Detection -   best_eval_score = 3.07
2023-04-23 00:58:40,619 - Detection -   eval_score = 64.07
2023-04-23 00:58:40,620 - Detection -   train_loss = 3.096195340156555
2023-04-23 00:58:47,781 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 00:58:47,781 - Detection -   best_eval_score = 64.07
2023-04-23 00:58:47,781 - Detection -   eval_score = 77.69
2023-04-23 00:58:47,781 - Detection -   train_loss = 0.9765415012836456
2023-04-23 00:58:54,795 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 00:58:54,795 - Detection -   best_eval_score = 77.69
2023-04-23 00:58:54,795 - Detection -   eval_score = 77.24
2023-04-23 00:58:54,795 - Detection -   train_loss = 0.9499594211578369
2023-04-23 00:59:01,825 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 00:59:01,825 - Detection -   best_eval_score = 77.69
2023-04-23 00:59:01,825 - Detection -   eval_score = 77.25
2023-04-23 00:59:01,825 - Detection -   train_loss = 0.9387885093688965
2023-04-23 00:59:08,947 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 00:59:08,948 - Detection -   best_eval_score = 77.69
2023-04-23 00:59:08,948 - Detection -   eval_score = 77.67
2023-04-23 00:59:08,948 - Detection -   train_loss = 0.9243856310844422
2023-04-23 00:59:15,986 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 00:59:15,986 - Detection -   best_eval_score = 77.69
2023-04-23 00:59:15,986 - Detection -   eval_score = 77.15
2023-04-23 00:59:15,986 - Detection -   train_loss = 0.9580020546913147
2023-04-23 00:59:23,009 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 00:59:23,009 - Detection -   best_eval_score = 77.69
2023-04-23 00:59:23,009 - Detection -   eval_score = 77.69
2023-04-23 00:59:23,009 - Detection -   train_loss = 0.9086946427822113
2023-04-23 00:59:30,146 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 00:59:30,146 - Detection -   best_eval_score = 77.69
2023-04-23 00:59:30,146 - Detection -   eval_score = 78.15
2023-04-23 00:59:30,146 - Detection -   train_loss = 0.953920555114746
2023-04-23 00:59:37,188 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 00:59:37,188 - Detection -   best_eval_score = 78.15
2023-04-23 00:59:37,188 - Detection -   eval_score = 76.84
2023-04-23 00:59:37,188 - Detection -   train_loss = 0.9403151154518128
2023-04-23 00:59:44,212 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 00:59:44,213 - Detection -   best_eval_score = 78.15
2023-04-23 00:59:44,213 - Detection -   eval_score = 77.01
2023-04-23 00:59:44,213 - Detection -   train_loss = 0.9585993647575378
2023-04-23 00:59:51,335 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 00:59:51,335 - Detection -   best_eval_score = 78.15
2023-04-23 00:59:51,335 - Detection -   eval_score = 77.59
2023-04-23 00:59:51,335 - Detection -   train_loss = 0.9449911773204803
2023-04-23 00:59:58,382 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 00:59:58,382 - Detection -   best_eval_score = 78.15
2023-04-23 00:59:58,382 - Detection -   eval_score = 78.11
2023-04-23 00:59:58,382 - Detection -   train_loss = 0.9413624405860901
2023-04-23 01:00:05,354 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 01:00:05,354 - Detection -   best_eval_score = 78.15
2023-04-23 01:00:05,354 - Detection -   eval_score = 77.34
2023-04-23 01:00:05,354 - Detection -   train_loss = 0.923550808429718
2023-04-23 01:00:12,468 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 01:00:12,468 - Detection -   best_eval_score = 78.15
2023-04-23 01:00:12,468 - Detection -   eval_score = 78.05
2023-04-23 01:00:12,468 - Detection -   train_loss = 0.9695897579193116
2023-04-23 01:00:19,475 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 01:00:19,475 - Detection -   best_eval_score = 78.15
2023-04-23 01:00:19,475 - Detection -   eval_score = 77.59
2023-04-23 01:00:19,475 - Detection -   train_loss = 0.9284954965114594
2023-04-23 01:00:26,475 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 01:00:26,475 - Detection -   best_eval_score = 78.15
2023-04-23 01:00:26,475 - Detection -   eval_score = 78.08
2023-04-23 01:00:26,475 - Detection -   train_loss = 0.9443224668502808
2023-04-23 01:00:33,496 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 01:00:33,496 - Detection -   best_eval_score = 78.15
2023-04-23 01:00:33,496 - Detection -   eval_score = 77.78
2023-04-23 01:00:33,496 - Detection -   train_loss = 0.9431749522686005
2023-04-23 01:00:40,496 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 01:00:40,496 - Detection -   best_eval_score = 78.15
2023-04-23 01:00:40,496 - Detection -   eval_score = 77.45
2023-04-23 01:00:40,496 - Detection -   train_loss = 0.9476597547531128
2023-04-23 01:00:40,496 - Detection - Training Finished...
2023-04-23 01:00:40,496 - Detection - Testing begin...
2023-04-23 01:00:42,241 - Detection - ***** Test: Confusion Matrix *****
2023-04-23 01:00:42,241 - Detection - [[ 112    0    0    0    0    0    0    0    3    0   34]
 [   0   82    0    1    0    0    0    0    1    4   40]
 [   0    0   97    1    0    0    1    1    2    1   37]
 [   0    0    1   66    0    0    0    1    0    1   53]
 [   0    0    0    2  103    0    0    1    0    2   23]
 [   0    0    0    1    0   91    0    0    5    1   41]
 [   0    0    3    0    0    0  127    0    1    0   40]
 [   0    0    0    3    0    0    0   90    0    0   31]
 [   0    0    0    0    0    0    0    0  110    0   18]
 [   0    0    0    2    0    0    0    0    0  101   24]
 [   3   16   11   60    1   18   34    7   64    5 1327]]
2023-04-23 01:00:42,241 - Detection - ***** Test results *****
2023-04-23 01:00:42,241 - Detection -   Acc = 79.38
2023-04-23 01:00:42,241 - Detection -   F1 = 76.3048
2023-04-23 01:00:42,241 - Detection -   F1-known = 75.6777
2023-04-23 01:00:42,241 - Detection -   F1-open = 82.5762
2023-04-23 01:00:42,241 - Detection - Testing finished...
2023-04-23 01:00:42,241 - Detection - Results saved in results/results_DA-ADB-BOOST-F-4.csv
2023-04-23 01:00:42,260 - Detection - Open Intent Detection Finished...
