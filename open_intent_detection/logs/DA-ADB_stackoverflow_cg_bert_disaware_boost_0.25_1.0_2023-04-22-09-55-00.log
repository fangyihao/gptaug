2023-04-22 09:55:00,579 - Detection - Open Intent Detection Begin...
2023-04-22 09:55:00,580 - Detection - Parameters Initialization...
2023-04-22 09:55:00,580 - Detection - ============================== Params ==============================
2023-04-22 09:55:00,580 - Detection - type:	open_intent_detection
2023-04-22 09:55:00,580 - Detection - logger_name:	Detection
2023-04-22 09:55:00,580 - Detection - log_dir:	logs
2023-04-22 09:55:00,580 - Detection - dataset:	stackoverflow_cg
2023-04-22 09:55:00,580 - Detection - known_cls_ratio:	0.25
2023-04-22 09:55:00,580 - Detection - labeled_ratio:	1.0
2023-04-22 09:55:00,580 - Detection - method:	DA-ADB
2023-04-22 09:55:00,580 - Detection - train:	True
2023-04-22 09:55:00,580 - Detection - pretrain:	True
2023-04-22 09:55:00,580 - Detection - save_model:	False
2023-04-22 09:55:00,580 - Detection - backbone:	bert_disaware_boost
2023-04-22 09:55:00,580 - Detection - config_file_name:	DA-ADB
2023-04-22 09:55:00,580 - Detection - seed:	2
2023-04-22 09:55:00,580 - Detection - gpu_id:	0
2023-04-22 09:55:00,580 - Detection - pipe_results_path:	pipe_results
2023-04-22 09:55:00,580 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-22 09:55:00,580 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-22 09:55:00,580 - Detection - model_dir:	models
2023-04-22 09:55:00,580 - Detection - load_pretrained_method:	None
2023-04-22 09:55:00,580 - Detection - result_dir:	results
2023-04-22 09:55:00,580 - Detection - results_file_name:	results_DA-ADB-BOOST.csv
2023-04-22 09:55:00,580 - Detection - save_results:	True
2023-04-22 09:55:00,580 - Detection - loss_fct:	CrossEntropyLoss
2023-04-22 09:55:00,580 - Detection - boost_method:	F-10
2023-04-22 09:55:00,580 - Detection - boost_start_score:	0.0
2023-04-22 09:55:00,580 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.25_1.0_bert_disaware_boost_2
2023-04-22 09:55:00,580 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.25_1.0_bert_disaware_boost_2/models
2023-04-22 09:55:00,580 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-22 09:55:00,580 - Detection - num_train_epochs:	100
2023-04-22 09:55:00,580 - Detection - num_labels:	None
2023-04-22 09:55:00,580 - Detection - max_seq_length:	None
2023-04-22 09:55:00,580 - Detection - freeze_backbone_parameters:	True
2023-04-22 09:55:00,580 - Detection - feat_dim:	768
2023-04-22 09:55:00,580 - Detection - warmup_proportion:	0.1
2023-04-22 09:55:00,580 - Detection - scale:	4
2023-04-22 09:55:00,580 - Detection - lr_boundary:	0.05
2023-04-22 09:55:00,580 - Detection - lr:	2e-05
2023-04-22 09:55:00,580 - Detection - activation:	relu
2023-04-22 09:55:00,581 - Detection - train_batch_size:	128
2023-04-22 09:55:00,581 - Detection - eval_batch_size:	64
2023-04-22 09:55:00,581 - Detection - test_batch_size:	64
2023-04-22 09:55:00,581 - Detection - wait_patient:	10
2023-04-22 09:55:00,581 - Detection - ============================== End Params ==============================
2023-04-22 09:55:00,581 - Detection - Data and Model Preparation...
2023-04-22 09:55:00,581 - Detection - The number of known intents is 5
2023-04-22 09:55:00,581 - Detection - Lists of known labels are: ['osx', 'drupal', 'visual-studio', 'ajax', 'magento']
2023-04-22 09:55:00,588 - Detection - Number of labeled training samples = 741
2023-04-22 09:55:00,588 - Detection - Number of unlabeled training samples = 2050
2023-04-22 09:55:00,591 - Detection - Number of evaluation samples = 343
2023-04-22 09:55:00,596 - Detection - Number of testing samples = 2905
2023-04-22 09:55:06,131 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-22 09:55:06,213 - Detection - Pre-training Begin...
2023-04-22 09:55:08,263 - Detection - ***** Epoch: 1: Eval results *****
2023-04-22 09:55:08,263 - Detection -   best_eval_score = 0
2023-04-22 09:55:08,263 - Detection -   eval_score = 10.41
2023-04-22 09:55:08,263 - Detection -   train_loss = 1.6157690286636353
2023-04-22 09:55:20,167 - Detection - ***** Epoch: 2: Eval results *****
2023-04-22 09:55:20,167 - Detection -   best_eval_score = 10.41
2023-04-22 09:55:20,167 - Detection -   eval_score = 4.92
2023-04-22 09:55:20,167 - Detection -   train_loss = 1.5998069246610005
2023-04-22 09:55:31,980 - Detection - ***** Epoch: 3: Eval results *****
2023-04-22 09:55:31,980 - Detection -   best_eval_score = 10.41
2023-04-22 09:55:31,980 - Detection -   eval_score = 34.4
2023-04-22 09:55:31,980 - Detection -   train_loss = 1.5320992867151897
2023-04-22 09:55:43,930 - Detection - ***** Epoch: 4: Eval results *****
2023-04-22 09:55:43,930 - Detection -   best_eval_score = 34.4
2023-04-22 09:55:43,930 - Detection -   eval_score = 65.58
2023-04-22 09:55:43,930 - Detection -   train_loss = 1.3400899370511372
2023-04-22 09:55:55,716 - Detection - ***** Epoch: 5: Eval results *****
2023-04-22 09:55:55,716 - Detection -   best_eval_score = 65.58
2023-04-22 09:55:55,716 - Detection -   eval_score = 78.89
2023-04-22 09:55:55,716 - Detection -   train_loss = 1.011492093404134
2023-04-22 09:56:07,610 - Detection - ***** Epoch: 6: Eval results *****
2023-04-22 09:56:07,611 - Detection -   best_eval_score = 78.89
2023-04-22 09:56:07,611 - Detection -   eval_score = 74.77
2023-04-22 09:56:07,611 - Detection -   train_loss = 0.7087113658587137
2023-04-22 09:56:19,523 - Detection - ***** Epoch: 7: Eval results *****
2023-04-22 09:56:19,523 - Detection -   best_eval_score = 78.89
2023-04-22 09:56:19,523 - Detection -   eval_score = 80.77
2023-04-22 09:56:19,523 - Detection -   train_loss = 0.6134994626045227
2023-04-22 09:56:31,531 - Detection - ***** Epoch: 8: Eval results *****
2023-04-22 09:56:31,531 - Detection -   best_eval_score = 80.77
2023-04-22 09:56:31,531 - Detection -   eval_score = 82.03
2023-04-22 09:56:31,531 - Detection -   train_loss = 0.49364717304706573
2023-04-22 09:56:43,456 - Detection - ***** Epoch: 9: Eval results *****
2023-04-22 09:56:43,456 - Detection -   best_eval_score = 82.03
2023-04-22 09:56:43,456 - Detection -   eval_score = 84.75
2023-04-22 09:56:43,456 - Detection -   train_loss = 0.40602340300877887
2023-04-22 09:56:55,344 - Detection - ***** Epoch: 10: Eval results *****
2023-04-22 09:56:55,344 - Detection -   best_eval_score = 84.75
2023-04-22 09:56:55,344 - Detection -   eval_score = 84.47
2023-04-22 09:56:55,344 - Detection -   train_loss = 0.32528749108314514
2023-04-22 09:57:07,292 - Detection - ***** Epoch: 11: Eval results *****
2023-04-22 09:57:07,292 - Detection -   best_eval_score = 84.75
2023-04-22 09:57:07,292 - Detection -   eval_score = 83.87
2023-04-22 09:57:07,292 - Detection -   train_loss = 0.2967046747605006
2023-04-22 09:57:20,086 - Detection - ***** Epoch: 12: Eval results *****
2023-04-22 09:57:20,086 - Detection -   best_eval_score = 84.75
2023-04-22 09:57:20,086 - Detection -   eval_score = 83.09
2023-04-22 09:57:20,086 - Detection -   train_loss = 0.2585296630859375
2023-04-22 09:57:32,031 - Detection - ***** Epoch: 13: Eval results *****
2023-04-22 09:57:32,031 - Detection -   best_eval_score = 84.75
2023-04-22 09:57:32,031 - Detection -   eval_score = 84.06
2023-04-22 09:57:32,031 - Detection -   train_loss = 0.25563671439886093
2023-04-22 09:57:43,924 - Detection - ***** Epoch: 14: Eval results *****
2023-04-22 09:57:43,924 - Detection -   best_eval_score = 84.75
2023-04-22 09:57:43,924 - Detection -   eval_score = 82.64
2023-04-22 09:57:43,924 - Detection -   train_loss = 0.23976988345384598
2023-04-22 09:57:56,181 - Detection - ***** Epoch: 15: Eval results *****
2023-04-22 09:57:56,181 - Detection -   best_eval_score = 84.75
2023-04-22 09:57:56,181 - Detection -   eval_score = 85.23
2023-04-22 09:57:56,181 - Detection -   train_loss = 0.2173356885711352
2023-04-22 09:58:08,781 - Detection - ***** Epoch: 16: Eval results *****
2023-04-22 09:58:08,781 - Detection -   best_eval_score = 85.23
2023-04-22 09:58:08,781 - Detection -   eval_score = 83.75
2023-04-22 09:58:08,781 - Detection -   train_loss = 0.1789876272281011
2023-04-22 09:58:21,576 - Detection - ***** Epoch: 17: Eval results *****
2023-04-22 09:58:21,576 - Detection -   best_eval_score = 85.23
2023-04-22 09:58:21,576 - Detection -   eval_score = 86.99
2023-04-22 09:58:21,576 - Detection -   train_loss = 0.16707569857438406
2023-04-22 09:58:33,404 - Detection - ***** Epoch: 18: Eval results *****
2023-04-22 09:58:33,404 - Detection -   best_eval_score = 86.99
2023-04-22 09:58:33,404 - Detection -   eval_score = 83.6
2023-04-22 09:58:33,404 - Detection -   train_loss = 0.1598216878871123
2023-04-22 09:58:45,354 - Detection - ***** Epoch: 19: Eval results *****
2023-04-22 09:58:45,354 - Detection -   best_eval_score = 86.99
2023-04-22 09:58:45,355 - Detection -   eval_score = 86.15
2023-04-22 09:58:45,355 - Detection -   train_loss = 0.14717072000106177
2023-04-22 09:58:57,260 - Detection - ***** Epoch: 20: Eval results *****
2023-04-22 09:58:57,260 - Detection -   best_eval_score = 86.99
2023-04-22 09:58:57,260 - Detection -   eval_score = 84.7
2023-04-22 09:58:57,260 - Detection -   train_loss = 0.12413137281934421
2023-04-22 09:59:09,267 - Detection - ***** Epoch: 21: Eval results *****
2023-04-22 09:59:09,267 - Detection -   best_eval_score = 86.99
2023-04-22 09:59:09,267 - Detection -   eval_score = 85.3
2023-04-22 09:59:09,267 - Detection -   train_loss = 0.11808934062719345
2023-04-22 09:59:21,036 - Detection - ***** Epoch: 22: Eval results *****
2023-04-22 09:59:21,036 - Detection -   best_eval_score = 86.99
2023-04-22 09:59:21,036 - Detection -   eval_score = 85.36
2023-04-22 09:59:21,036 - Detection -   train_loss = 0.10601831724246343
2023-04-22 09:59:32,957 - Detection - ***** Epoch: 23: Eval results *****
2023-04-22 09:59:32,957 - Detection -   best_eval_score = 86.99
2023-04-22 09:59:32,957 - Detection -   eval_score = 84.7
2023-04-22 09:59:32,957 - Detection -   train_loss = 0.10561578348279
2023-04-22 09:59:44,741 - Detection - ***** Epoch: 24: Eval results *****
2023-04-22 09:59:44,741 - Detection -   best_eval_score = 86.99
2023-04-22 09:59:44,741 - Detection -   eval_score = 85.18
2023-04-22 09:59:44,741 - Detection -   train_loss = 0.10249540706475575
2023-04-22 09:59:56,754 - Detection - ***** Epoch: 25: Eval results *****
2023-04-22 09:59:56,754 - Detection -   best_eval_score = 86.99
2023-04-22 09:59:56,754 - Detection -   eval_score = 84.68
2023-04-22 09:59:56,754 - Detection -   train_loss = 0.09847554191946983
2023-04-22 10:00:08,600 - Detection - ***** Epoch: 26: Eval results *****
2023-04-22 10:00:08,600 - Detection -   best_eval_score = 86.99
2023-04-22 10:00:08,600 - Detection -   eval_score = 84.38
2023-04-22 10:00:08,600 - Detection -   train_loss = 0.09920234233140945
2023-04-22 10:00:20,593 - Detection - ***** Epoch: 27: Eval results *****
2023-04-22 10:00:20,593 - Detection -   best_eval_score = 86.99
2023-04-22 10:00:20,593 - Detection -   eval_score = 86.21
2023-04-22 10:00:20,593 - Detection -   train_loss = 0.09346650292476018
2023-04-22 10:00:20,594 - Detection - Pre-training finished...
2023-04-22 10:00:20,594 - Detection - Training Begin...
2023-04-22 10:00:21,565 - Detection - ***** Epoch: 1: Eval results *****
2023-04-22 10:00:21,565 - Detection -   best_eval_score = 0
2023-04-22 10:00:21,565 - Detection -   eval_score = 0.0
2023-04-22 10:00:21,565 - Detection -   train_loss = 5.815223852793376
2023-04-22 10:00:22,536 - Detection - ***** Epoch: 2: Eval results *****
2023-04-22 10:00:22,536 - Detection -   best_eval_score = 0
2023-04-22 10:00:22,536 - Detection -   eval_score = 0.0
2023-04-22 10:00:22,536 - Detection -   train_loss = 5.774369319279988
2023-04-22 10:00:23,505 - Detection - ***** Epoch: 3: Eval results *****
2023-04-22 10:00:23,506 - Detection -   best_eval_score = 0
2023-04-22 10:00:23,506 - Detection -   eval_score = 0.0
2023-04-22 10:00:23,506 - Detection -   train_loss = 5.626086235046387
2023-04-22 10:00:24,476 - Detection - ***** Epoch: 4: Eval results *****
2023-04-22 10:00:24,476 - Detection -   best_eval_score = 0
2023-04-22 10:00:24,476 - Detection -   eval_score = 0.5
2023-04-22 10:00:24,476 - Detection -   train_loss = 5.519121885299683
2023-04-22 10:00:35,555 - Detection - ***** Epoch: 5: Eval results *****
2023-04-22 10:00:35,555 - Detection -   best_eval_score = 0.5
2023-04-22 10:00:35,555 - Detection -   eval_score = 40.52
2023-04-22 10:00:35,555 - Detection -   train_loss = 5.309003512064616
2023-04-22 10:00:46,832 - Detection - ***** Epoch: 6: Eval results *****
2023-04-22 10:00:46,832 - Detection -   best_eval_score = 40.52
2023-04-22 10:00:46,832 - Detection -   eval_score = 58.25
2023-04-22 10:00:46,832 - Detection -   train_loss = 2.061560869216919
2023-04-22 10:00:58,021 - Detection - ***** Epoch: 7: Eval results *****
2023-04-22 10:00:58,021 - Detection -   best_eval_score = 58.25
2023-04-22 10:00:58,021 - Detection -   eval_score = 57.39
2023-04-22 10:00:58,021 - Detection -   train_loss = 1.5168105959892273
2023-04-22 10:01:09,308 - Detection - ***** Epoch: 8: Eval results *****
2023-04-22 10:01:09,309 - Detection -   best_eval_score = 58.25
2023-04-22 10:01:09,309 - Detection -   eval_score = 58.03
2023-04-22 10:01:09,309 - Detection -   train_loss = 1.5063708027203877
2023-04-22 10:01:20,505 - Detection - ***** Epoch: 9: Eval results *****
2023-04-22 10:01:20,505 - Detection -   best_eval_score = 58.25
2023-04-22 10:01:20,505 - Detection -   eval_score = 58.22
2023-04-22 10:01:20,505 - Detection -   train_loss = 1.5294378399848938
2023-04-22 10:01:31,834 - Detection - ***** Epoch: 10: Eval results *****
2023-04-22 10:01:31,834 - Detection -   best_eval_score = 58.25
2023-04-22 10:01:31,834 - Detection -   eval_score = 57.39
2023-04-22 10:01:31,834 - Detection -   train_loss = 1.5308066010475159
2023-04-22 10:01:42,998 - Detection - ***** Epoch: 11: Eval results *****
2023-04-22 10:01:42,999 - Detection -   best_eval_score = 58.25
2023-04-22 10:01:42,999 - Detection -   eval_score = 57.88
2023-04-22 10:01:42,999 - Detection -   train_loss = 1.5721966624259949
2023-04-22 10:01:54,313 - Detection - ***** Epoch: 12: Eval results *****
2023-04-22 10:01:54,313 - Detection -   best_eval_score = 58.25
2023-04-22 10:01:54,313 - Detection -   eval_score = 57.64
2023-04-22 10:01:54,313 - Detection -   train_loss = 1.5011442303657532
2023-04-22 10:02:05,470 - Detection - ***** Epoch: 13: Eval results *****
2023-04-22 10:02:05,470 - Detection -   best_eval_score = 58.25
2023-04-22 10:02:05,470 - Detection -   eval_score = 58.28
2023-04-22 10:02:05,470 - Detection -   train_loss = 1.5411540865898132
2023-04-22 10:02:16,774 - Detection - ***** Epoch: 14: Eval results *****
2023-04-22 10:02:16,774 - Detection -   best_eval_score = 58.28
2023-04-22 10:02:16,774 - Detection -   eval_score = 57.88
2023-04-22 10:02:16,774 - Detection -   train_loss = 1.527315576871236
2023-04-22 10:02:27,875 - Detection - ***** Epoch: 15: Eval results *****
2023-04-22 10:02:27,876 - Detection -   best_eval_score = 58.28
2023-04-22 10:02:27,876 - Detection -   eval_score = 57.59
2023-04-22 10:02:27,876 - Detection -   train_loss = 1.503981590270996
2023-04-22 10:02:39,131 - Detection - ***** Epoch: 16: Eval results *****
2023-04-22 10:02:39,131 - Detection -   best_eval_score = 58.28
2023-04-22 10:02:39,131 - Detection -   eval_score = 57.88
2023-04-22 10:02:39,131 - Detection -   train_loss = 1.5305557648340862
2023-04-22 10:02:50,361 - Detection - ***** Epoch: 17: Eval results *****
2023-04-22 10:02:50,362 - Detection -   best_eval_score = 58.28
2023-04-22 10:02:50,362 - Detection -   eval_score = 58.55
2023-04-22 10:02:50,362 - Detection -   train_loss = 1.5108025670051575
2023-04-22 10:03:01,664 - Detection - ***** Epoch: 18: Eval results *****
2023-04-22 10:03:01,664 - Detection -   best_eval_score = 58.55
2023-04-22 10:03:01,664 - Detection -   eval_score = 59.14
2023-04-22 10:03:01,664 - Detection -   train_loss = 1.4975419441858928
2023-04-22 10:03:12,844 - Detection - ***** Epoch: 19: Eval results *****
2023-04-22 10:03:12,844 - Detection -   best_eval_score = 59.14
2023-04-22 10:03:12,845 - Detection -   eval_score = 58.15
2023-04-22 10:03:12,845 - Detection -   train_loss = 1.5409925977389018
2023-04-22 10:03:24,125 - Detection - ***** Epoch: 20: Eval results *****
2023-04-22 10:03:24,125 - Detection -   best_eval_score = 59.14
2023-04-22 10:03:24,125 - Detection -   eval_score = 58.58
2023-04-22 10:03:24,125 - Detection -   train_loss = 1.5167893171310425
2023-04-22 10:03:35,321 - Detection - ***** Epoch: 21: Eval results *****
2023-04-22 10:03:35,321 - Detection -   best_eval_score = 59.14
2023-04-22 10:03:35,321 - Detection -   eval_score = 57.64
2023-04-22 10:03:35,322 - Detection -   train_loss = 1.5332460602124531
2023-04-22 10:03:46,567 - Detection - ***** Epoch: 22: Eval results *****
2023-04-22 10:03:46,567 - Detection -   best_eval_score = 59.14
2023-04-22 10:03:46,568 - Detection -   eval_score = 57.79
2023-04-22 10:03:46,568 - Detection -   train_loss = 1.5676942865053813
2023-04-22 10:03:57,681 - Detection - ***** Epoch: 23: Eval results *****
2023-04-22 10:03:57,681 - Detection -   best_eval_score = 59.14
2023-04-22 10:03:57,681 - Detection -   eval_score = 57.39
2023-04-22 10:03:57,681 - Detection -   train_loss = 1.5050662358601887
2023-04-22 10:04:08,993 - Detection - ***** Epoch: 24: Eval results *****
2023-04-22 10:04:08,993 - Detection -   best_eval_score = 59.14
2023-04-22 10:04:08,993 - Detection -   eval_score = 57.46
2023-04-22 10:04:08,993 - Detection -   train_loss = 1.5102166136105855
2023-04-22 10:04:20,202 - Detection - ***** Epoch: 25: Eval results *****
2023-04-22 10:04:20,202 - Detection -   best_eval_score = 59.14
2023-04-22 10:04:20,203 - Detection -   eval_score = 58.74
2023-04-22 10:04:20,203 - Detection -   train_loss = 1.5268681446711223
2023-04-22 10:04:31,344 - Detection - ***** Epoch: 26: Eval results *****
2023-04-22 10:04:31,344 - Detection -   best_eval_score = 59.14
2023-04-22 10:04:31,344 - Detection -   eval_score = 57.64
2023-04-22 10:04:31,344 - Detection -   train_loss = 1.5875507791837056
2023-04-22 10:04:42,554 - Detection - ***** Epoch: 27: Eval results *****
2023-04-22 10:04:42,554 - Detection -   best_eval_score = 59.14
2023-04-22 10:04:42,554 - Detection -   eval_score = 57.39
2023-04-22 10:04:42,554 - Detection -   train_loss = 1.49917999903361
2023-04-22 10:04:53,894 - Detection - ***** Epoch: 28: Eval results *****
2023-04-22 10:04:53,894 - Detection -   best_eval_score = 59.14
2023-04-22 10:04:53,894 - Detection -   eval_score = 57.86
2023-04-22 10:04:53,895 - Detection -   train_loss = 1.474719266096751
2023-04-22 10:04:53,895 - Detection - Training Finished...
2023-04-22 10:04:53,895 - Detection - Testing begin...
2023-04-22 10:04:56,301 - Detection - ***** Test: Confusion Matrix *****
2023-04-22 10:04:56,301 - Detection - [[  79    0    0    5    0  109]
 [   0  102    0    7    0   19]
 [   1    0   40   10    0   55]
 [   1    0    0   53    0  106]
 [   0    0    0    4  106   22]
 [ 192    4   25  418    0 1547]]
2023-04-22 10:04:56,301 - Detection - ***** Test results *****
2023-04-22 10:04:56,301 - Detection -   Acc = 66.33
2023-04-22 10:04:56,301 - Detection -   F1 = 58.2644
2023-04-22 10:04:56,301 - Detection -   F1-known = 54.6157
2023-04-22 10:04:56,301 - Detection -   F1-open = 76.5084
2023-04-22 10:04:56,301 - Detection - Testing finished...
2023-04-22 10:04:56,301 - Detection - Results saved in results/results_DA-ADB-BOOST.csv
2023-04-22 10:04:56,321 - Detection - Open Intent Detection Finished...
