2023-04-24 00:50:37,398 - Detection - Open Intent Detection Begin...
2023-04-24 00:50:37,398 - Detection - Parameters Initialization...
2023-04-24 00:50:37,398 - Detection - ============================== Params ==============================
2023-04-24 00:50:37,398 - Detection - type:	open_intent_detection
2023-04-24 00:50:37,398 - Detection - logger_name:	Detection
2023-04-24 00:50:37,398 - Detection - log_dir:	logs
2023-04-24 00:50:37,398 - Detection - dataset:	oos_cg
2023-04-24 00:50:37,398 - Detection - known_cls_ratio:	0.25
2023-04-24 00:50:37,398 - Detection - labeled_ratio:	1.0
2023-04-24 00:50:37,398 - Detection - method:	ADB
2023-04-24 00:50:37,398 - Detection - train:	True
2023-04-24 00:50:37,398 - Detection - pretrain:	True
2023-04-24 00:50:37,398 - Detection - save_model:	False
2023-04-24 00:50:37,398 - Detection - backbone:	bert_boost
2023-04-24 00:50:37,398 - Detection - config_file_name:	ADB
2023-04-24 00:50:37,398 - Detection - seed:	8
2023-04-24 00:50:37,398 - Detection - gpu_id:	0
2023-04-24 00:50:37,398 - Detection - pipe_results_path:	pipe_results
2023-04-24 00:50:37,398 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-24 00:50:37,398 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-24 00:50:37,398 - Detection - model_dir:	models
2023-04-24 00:50:37,398 - Detection - load_pretrained_method:	None
2023-04-24 00:50:37,398 - Detection - result_dir:	results
2023-04-24 00:50:37,398 - Detection - results_file_name:	results_ADB-BOOST-F-10.csv
2023-04-24 00:50:37,398 - Detection - save_results:	True
2023-04-24 00:50:37,399 - Detection - loss_fct:	CrossEntropyLoss
2023-04-24 00:50:37,399 - Detection - boost_method:	F-10
2023-04-24 00:50:37,399 - Detection - boost_start_score:	0.0
2023-04-24 00:50:37,399 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_cg_0.25_1.0_bert_boost_8
2023-04-24 00:50:37,399 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_cg_0.25_1.0_bert_boost_8/models
2023-04-24 00:50:37,399 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-24 00:50:37,399 - Detection - num_train_epochs:	100
2023-04-24 00:50:37,399 - Detection - num_labels:	None
2023-04-24 00:50:37,399 - Detection - max_seq_length:	None
2023-04-24 00:50:37,399 - Detection - freeze_backbone_parameters:	True
2023-04-24 00:50:37,399 - Detection - feat_dim:	768
2023-04-24 00:50:37,399 - Detection - warmup_proportion:	0.1
2023-04-24 00:50:37,399 - Detection - lr_boundary:	0.05
2023-04-24 00:50:37,399 - Detection - lr:	2e-05
2023-04-24 00:50:37,399 - Detection - activation:	relu
2023-04-24 00:50:37,399 - Detection - train_batch_size:	128
2023-04-24 00:50:37,399 - Detection - eval_batch_size:	64
2023-04-24 00:50:37,399 - Detection - test_batch_size:	64
2023-04-24 00:50:37,399 - Detection - wait_patient:	10
2023-04-24 00:50:37,399 - Detection - ============================== End Params ==============================
2023-04-24 00:50:37,399 - Detection - Data and Model Preparation...
2023-04-24 00:50:37,399 - Detection - The number of known intents is 38
2023-04-24 00:50:37,400 - Detection - Lists of known labels are: ['apr', 'credit_limit_change', 'cook_time', 'what_are_your_hobbies', 'make_call', 'definition', 'change_speed', 'where_are_you_from', 'travel_alert', 'next_holiday', 'ingredients_list', 'credit_score', 'rollover_401k', 'greeting', 'text', 'whisper_mode', 'user_name', 'todo_list_update', 'meeting_schedule', 'transactions', 'how_old_are_you', 'account_blocked', 'meal_suggestion', 'pto_request', 'replacement_card_duration', 'accept_reservations', 'thank_you', 'application_status', 'car_rental', 'taxes', 'food_last', 'calendar', 'change_language', 'tire_change', 'pto_request_status', 'no', 'travel_suggestion', 'pto_balance']
2023-04-24 00:50:37,409 - Detection - Number of labeled training samples = 1039
2023-04-24 00:50:37,409 - Detection - Number of unlabeled training samples = 2644
2023-04-24 00:50:37,413 - Detection - Number of evaluation samples = 415
2023-04-24 00:50:37,420 - Detection - Number of testing samples = 3632
2023-04-24 00:50:41,371 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-24 00:50:43,041 - Detection - Pre-training Begin...
2023-04-24 00:50:44,452 - Detection - ***** Epoch: 1: Eval results *****
2023-04-24 00:50:44,452 - Detection -   best_eval_score = 0
2023-04-24 00:50:44,452 - Detection -   eval_score = 4.58
2023-04-24 00:50:44,452 - Detection -   train_loss = 3.641762309604221
2023-04-24 00:50:55,949 - Detection - ***** Epoch: 2: Eval results *****
2023-04-24 00:50:55,949 - Detection -   best_eval_score = 4.58
2023-04-24 00:50:55,949 - Detection -   eval_score = 21.2
2023-04-24 00:50:55,949 - Detection -   train_loss = 3.627192417780558
2023-04-24 00:51:07,503 - Detection - ***** Epoch: 3: Eval results *****
2023-04-24 00:51:07,504 - Detection -   best_eval_score = 21.2
2023-04-24 00:51:07,504 - Detection -   eval_score = 41.93
2023-04-24 00:51:07,504 - Detection -   train_loss = 3.1159203317430286
2023-04-24 00:51:19,014 - Detection - ***** Epoch: 4: Eval results *****
2023-04-24 00:51:19,014 - Detection -   best_eval_score = 41.93
2023-04-24 00:51:19,014 - Detection -   eval_score = 67.71
2023-04-24 00:51:19,014 - Detection -   train_loss = 1.6993379990259807
2023-04-24 00:51:30,483 - Detection - ***** Epoch: 5: Eval results *****
2023-04-24 00:51:30,483 - Detection -   best_eval_score = 67.71
2023-04-24 00:51:30,483 - Detection -   eval_score = 77.59
2023-04-24 00:51:30,483 - Detection -   train_loss = 0.8824983636538187
2023-04-24 00:51:41,949 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 00:51:41,949 - Detection -   best_eval_score = 77.59
2023-04-24 00:51:41,949 - Detection -   eval_score = 83.37
2023-04-24 00:51:41,950 - Detection -   train_loss = 0.4913899468051063
2023-04-24 00:51:53,438 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 00:51:53,438 - Detection -   best_eval_score = 83.37
2023-04-24 00:51:53,438 - Detection -   eval_score = 86.02
2023-04-24 00:51:53,438 - Detection -   train_loss = 0.26216740740670097
2023-04-24 00:52:04,932 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 00:52:04,932 - Detection -   best_eval_score = 86.02
2023-04-24 00:52:04,932 - Detection -   eval_score = 87.95
2023-04-24 00:52:04,932 - Detection -   train_loss = 0.2000226659907235
2023-04-24 00:52:16,354 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 00:52:16,354 - Detection -   best_eval_score = 87.95
2023-04-24 00:52:16,354 - Detection -   eval_score = 89.64
2023-04-24 00:52:16,355 - Detection -   train_loss = 0.1276757170756658
2023-04-24 00:52:27,887 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 00:52:27,887 - Detection -   best_eval_score = 89.64
2023-04-24 00:52:27,887 - Detection -   eval_score = 88.92
2023-04-24 00:52:27,888 - Detection -   train_loss = 0.088959491915173
2023-04-24 00:52:39,353 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 00:52:39,353 - Detection -   best_eval_score = 89.64
2023-04-24 00:52:39,353 - Detection -   eval_score = 89.88
2023-04-24 00:52:39,353 - Detection -   train_loss = 0.07535284136732419
2023-04-24 00:52:50,788 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 00:52:50,788 - Detection -   best_eval_score = 89.88
2023-04-24 00:52:50,788 - Detection -   eval_score = 89.4
2023-04-24 00:52:50,788 - Detection -   train_loss = 0.05644525525470575
2023-04-24 00:53:02,245 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 00:53:02,245 - Detection -   best_eval_score = 89.88
2023-04-24 00:53:02,245 - Detection -   eval_score = 90.12
2023-04-24 00:53:02,246 - Detection -   train_loss = 0.04600803698930475
2023-04-24 00:53:13,753 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 00:53:13,753 - Detection -   best_eval_score = 90.12
2023-04-24 00:53:13,753 - Detection -   eval_score = 89.88
2023-04-24 00:53:13,753 - Detection -   train_loss = 0.041378644191556506
2023-04-24 00:53:25,263 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 00:53:25,263 - Detection -   best_eval_score = 90.12
2023-04-24 00:53:25,263 - Detection -   eval_score = 89.16
2023-04-24 00:53:25,263 - Detection -   train_loss = 0.03538352934022745
2023-04-24 00:53:36,640 - Detection - ***** Epoch: 16: Eval results *****
2023-04-24 00:53:36,640 - Detection -   best_eval_score = 90.12
2023-04-24 00:53:36,640 - Detection -   eval_score = 89.4
2023-04-24 00:53:36,640 - Detection -   train_loss = 0.03255203987161318
2023-04-24 00:53:48,147 - Detection - ***** Epoch: 17: Eval results *****
2023-04-24 00:53:48,147 - Detection -   best_eval_score = 90.12
2023-04-24 00:53:48,147 - Detection -   eval_score = 90.12
2023-04-24 00:53:48,147 - Detection -   train_loss = 0.038119052433305316
2023-04-24 00:53:59,619 - Detection - ***** Epoch: 18: Eval results *****
2023-04-24 00:53:59,619 - Detection -   best_eval_score = 90.12
2023-04-24 00:53:59,619 - Detection -   eval_score = 89.88
2023-04-24 00:53:59,619 - Detection -   train_loss = 0.024460402627786
2023-04-24 00:54:10,984 - Detection - ***** Epoch: 19: Eval results *****
2023-04-24 00:54:10,984 - Detection -   best_eval_score = 90.12
2023-04-24 00:54:10,984 - Detection -   eval_score = 89.64
2023-04-24 00:54:10,984 - Detection -   train_loss = 0.023899269600709278
2023-04-24 00:54:22,539 - Detection - ***** Epoch: 20: Eval results *****
2023-04-24 00:54:22,539 - Detection -   best_eval_score = 90.12
2023-04-24 00:54:22,539 - Detection -   eval_score = 89.64
2023-04-24 00:54:22,539 - Detection -   train_loss = 0.018905937257740233
2023-04-24 00:54:34,018 - Detection - ***** Epoch: 21: Eval results *****
2023-04-24 00:54:34,019 - Detection -   best_eval_score = 90.12
2023-04-24 00:54:34,019 - Detection -   eval_score = 89.16
2023-04-24 00:54:34,019 - Detection -   train_loss = 0.015136489023764929
2023-04-24 00:54:45,367 - Detection - ***** Epoch: 22: Eval results *****
2023-04-24 00:54:45,367 - Detection -   best_eval_score = 90.12
2023-04-24 00:54:45,367 - Detection -   eval_score = 89.64
2023-04-24 00:54:45,367 - Detection -   train_loss = 0.014201876552154621
2023-04-24 00:54:56,931 - Detection - ***** Epoch: 23: Eval results *****
2023-04-24 00:54:56,932 - Detection -   best_eval_score = 90.12
2023-04-24 00:54:56,932 - Detection -   eval_score = 89.64
2023-04-24 00:54:56,932 - Detection -   train_loss = 0.012621445684797235
2023-04-24 00:54:56,932 - Detection - Pre-training finished...
2023-04-24 00:54:56,932 - Detection - Training Begin...
2023-04-24 00:54:58,427 - Detection - ***** Epoch: 1: Eval results *****
2023-04-24 00:54:58,428 - Detection -   best_eval_score = 0
2023-04-24 00:54:58,428 - Detection -   eval_score = 0.0
2023-04-24 00:54:58,428 - Detection -   train_loss = 9.863405121697319
2023-04-24 00:54:59,329 - Detection - ***** Epoch: 2: Eval results *****
2023-04-24 00:54:59,329 - Detection -   best_eval_score = 0
2023-04-24 00:54:59,329 - Detection -   eval_score = 0.0
2023-04-24 00:54:59,329 - Detection -   train_loss = 9.620299869113499
2023-04-24 00:55:00,231 - Detection - ***** Epoch: 3: Eval results *****
2023-04-24 00:55:00,231 - Detection -   best_eval_score = 0
2023-04-24 00:55:00,231 - Detection -   eval_score = 0.0
2023-04-24 00:55:00,231 - Detection -   train_loss = 9.38283305697971
2023-04-24 00:55:01,134 - Detection - ***** Epoch: 4: Eval results *****
2023-04-24 00:55:01,135 - Detection -   best_eval_score = 0
2023-04-24 00:55:01,135 - Detection -   eval_score = 0.0
2023-04-24 00:55:01,135 - Detection -   train_loss = 9.149725914001465
2023-04-24 00:55:02,037 - Detection - ***** Epoch: 5: Eval results *****
2023-04-24 00:55:02,037 - Detection -   best_eval_score = 0
2023-04-24 00:55:02,037 - Detection -   eval_score = 0.0
2023-04-24 00:55:02,037 - Detection -   train_loss = 8.808110978868273
2023-04-24 00:55:02,940 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 00:55:02,940 - Detection -   best_eval_score = 0
2023-04-24 00:55:02,940 - Detection -   eval_score = 0.0
2023-04-24 00:55:02,940 - Detection -   train_loss = 8.267444875505236
2023-04-24 00:55:03,844 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 00:55:03,844 - Detection -   best_eval_score = 0
2023-04-24 00:55:03,844 - Detection -   eval_score = 0.32
2023-04-24 00:55:03,844 - Detection -   train_loss = 7.959416177537706
2023-04-24 00:55:15,248 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 00:55:15,248 - Detection -   best_eval_score = 0.32
2023-04-24 00:55:15,248 - Detection -   eval_score = 23.72
2023-04-24 00:55:15,248 - Detection -   train_loss = 7.470873726738824
2023-04-24 00:55:26,543 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 00:55:26,543 - Detection -   best_eval_score = 23.72
2023-04-24 00:55:26,543 - Detection -   eval_score = 57.98
2023-04-24 00:55:26,543 - Detection -   train_loss = 3.2817812230851917
2023-04-24 00:55:37,952 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 00:55:37,952 - Detection -   best_eval_score = 57.98
2023-04-24 00:55:37,952 - Detection -   eval_score = 61.27
2023-04-24 00:55:37,952 - Detection -   train_loss = 1.1691155698564317
2023-04-24 00:55:49,322 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 00:55:49,322 - Detection -   best_eval_score = 61.27
2023-04-24 00:55:49,322 - Detection -   eval_score = 60.38
2023-04-24 00:55:49,322 - Detection -   train_loss = 1.113007167975108
2023-04-24 00:56:00,746 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 00:56:00,746 - Detection -   best_eval_score = 61.27
2023-04-24 00:56:00,746 - Detection -   eval_score = 60.28
2023-04-24 00:56:00,746 - Detection -   train_loss = 1.1099026335610285
2023-04-24 00:56:12,113 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 00:56:12,113 - Detection -   best_eval_score = 61.27
2023-04-24 00:56:12,113 - Detection -   eval_score = 60.2
2023-04-24 00:56:12,113 - Detection -   train_loss = 1.1761439773771498
2023-04-24 00:56:23,460 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 00:56:23,460 - Detection -   best_eval_score = 61.27
2023-04-24 00:56:23,460 - Detection -   eval_score = 60.52
2023-04-24 00:56:23,460 - Detection -   train_loss = 1.1599799659517076
2023-04-24 00:56:34,845 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 00:56:34,845 - Detection -   best_eval_score = 61.27
2023-04-24 00:56:34,845 - Detection -   eval_score = 60.13
2023-04-24 00:56:34,845 - Detection -   train_loss = 1.0998570786582098
2023-04-24 00:56:46,073 - Detection - ***** Epoch: 16: Eval results *****
2023-04-24 00:56:46,073 - Detection -   best_eval_score = 61.27
2023-04-24 00:56:46,073 - Detection -   eval_score = 61.21
2023-04-24 00:56:46,073 - Detection -   train_loss = 1.1216211252742343
2023-04-24 00:56:57,480 - Detection - ***** Epoch: 17: Eval results *****
2023-04-24 00:56:57,480 - Detection -   best_eval_score = 61.27
2023-04-24 00:56:57,480 - Detection -   eval_score = 60.69
2023-04-24 00:56:57,480 - Detection -   train_loss = 1.1817084285948012
2023-04-24 00:57:08,946 - Detection - ***** Epoch: 18: Eval results *****
2023-04-24 00:57:08,946 - Detection -   best_eval_score = 61.27
2023-04-24 00:57:08,946 - Detection -   eval_score = 60.46
2023-04-24 00:57:08,946 - Detection -   train_loss = 1.1214528216256037
2023-04-24 00:57:20,367 - Detection - ***** Epoch: 19: Eval results *****
2023-04-24 00:57:20,367 - Detection -   best_eval_score = 61.27
2023-04-24 00:57:20,367 - Detection -   eval_score = 60.43
2023-04-24 00:57:20,367 - Detection -   train_loss = 1.1274628241856892
2023-04-24 00:57:31,651 - Detection - ***** Epoch: 20: Eval results *****
2023-04-24 00:57:31,651 - Detection -   best_eval_score = 61.27
2023-04-24 00:57:31,651 - Detection -   eval_score = 60.34
2023-04-24 00:57:31,651 - Detection -   train_loss = 1.0841788782013788
2023-04-24 00:57:31,652 - Detection - Training Finished...
2023-04-24 00:57:31,652 - Detection - Testing begin...
2023-04-24 00:57:33,714 - Detection - ***** Test: Confusion Matrix *****
2023-04-24 00:57:33,714 - Detection - [[   2    0    0 ...    0    0    9]
 [   0   14    0 ...    0    0    7]
 [   0    0    2 ...    0    0    6]
 ...
 [   0    0    0 ...    7    0    8]
 [   0    0    0 ...    0    1    8]
 [   1    3    0 ...   11    3 2808]]
2023-04-24 00:57:33,714 - Detection - ***** Test results *****
2023-04-24 00:57:33,714 - Detection -   Acc = 85.46
2023-04-24 00:57:33,714 - Detection -   F1 = 46.7293
2023-04-24 00:57:33,714 - Detection -   F1-known = 45.5485
2023-04-24 00:57:33,714 - Detection -   F1-open = 91.6001
2023-04-24 00:57:33,714 - Detection - Testing finished...
2023-04-24 00:57:33,714 - Detection - Results saved in results/results_ADB-BOOST-F-10.csv
2023-04-24 00:57:33,735 - Detection - Open Intent Detection Finished...
