2023-04-19 18:23:50,645 - Detection - Open Intent Detection Begin...
2023-04-19 18:23:50,645 - Detection - Parameters Initialization...
2023-04-19 18:23:50,645 - Detection - ============================== Params ==============================
2023-04-19 18:23:50,646 - Detection - type:	open_intent_detection
2023-04-19 18:23:50,646 - Detection - logger_name:	Detection
2023-04-19 18:23:50,646 - Detection - log_dir:	logs
2023-04-19 18:23:50,646 - Detection - dataset:	banking_cg
2023-04-19 18:23:50,646 - Detection - known_cls_ratio:	0.25
2023-04-19 18:23:50,646 - Detection - labeled_ratio:	1.0
2023-04-19 18:23:50,646 - Detection - method:	DA-ADB
2023-04-19 18:23:50,646 - Detection - train:	True
2023-04-19 18:23:50,646 - Detection - pretrain:	True
2023-04-19 18:23:50,646 - Detection - save_model:	True
2023-04-19 18:23:50,646 - Detection - backbone:	bert_disaware
2023-04-19 18:23:50,646 - Detection - config_file_name:	DA-ADB
2023-04-19 18:23:50,646 - Detection - seed:	1
2023-04-19 18:23:50,646 - Detection - gpu_id:	0
2023-04-19 18:23:50,646 - Detection - pipe_results_path:	pipe_results
2023-04-19 18:23:50,646 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-19 18:23:50,646 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-19 18:23:50,646 - Detection - model_dir:	models
2023-04-19 18:23:50,646 - Detection - load_pretrained_method:	None
2023-04-19 18:23:50,646 - Detection - result_dir:	results
2023-04-19 18:23:50,646 - Detection - results_file_name:	results_DA-ADB.csv
2023-04-19 18:23:50,646 - Detection - save_results:	True
2023-04-19 18:23:50,646 - Detection - loss_fct:	CrossEntropyLoss
2023-04-19 18:23:50,646 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_cg_0.25_1.0_bert_disaware_1
2023-04-19 18:23:50,646 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_cg_0.25_1.0_bert_disaware_1/models
2023-04-19 18:23:50,646 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-19 18:23:50,646 - Detection - num_train_epochs:	100
2023-04-19 18:23:50,646 - Detection - num_labels:	None
2023-04-19 18:23:50,646 - Detection - max_seq_length:	None
2023-04-19 18:23:50,646 - Detection - freeze_backbone_parameters:	True
2023-04-19 18:23:50,646 - Detection - feat_dim:	768
2023-04-19 18:23:50,646 - Detection - warmup_proportion:	0.1
2023-04-19 18:23:50,646 - Detection - scale:	4
2023-04-19 18:23:50,646 - Detection - lr_boundary:	0.05
2023-04-19 18:23:50,646 - Detection - lr:	2e-05
2023-04-19 18:23:50,646 - Detection - activation:	relu
2023-04-19 18:23:50,646 - Detection - train_batch_size:	128
2023-04-19 18:23:50,646 - Detection - eval_batch_size:	64
2023-04-19 18:23:50,646 - Detection - test_batch_size:	64
2023-04-19 18:23:50,646 - Detection - wait_patient:	10
2023-04-19 18:23:50,646 - Detection - ============================== End Params ==============================
2023-04-19 18:23:50,646 - Detection - Data and Model Preparation...
2023-04-19 18:23:50,647 - Detection - The number of known intents is 19
2023-04-19 18:23:50,647 - Detection - Lists of known labels are: ['edit_personal_details', 'lost_or_stolen_phone', 'declined_card_payment', 'why_verify_identity', 'top_up_by_cash_or_cheque', 'top_up_failed', 'top_up_reverted', 'receiving_money', 'failed_transfer', 'top_up_by_card_charge', 'card_about_to_expire', 'reverted_card_payment?', 'exchange_via_app', 'age_limit', 'verify_top_up', 'declined_cash_withdrawal', 'pending_card_payment', 'card_not_working', 'passcode_forgotten']
2023-04-19 18:23:50,655 - Detection - Number of labeled training samples = 606
2023-04-19 18:23:50,655 - Detection - Number of unlabeled training samples = 2169
2023-04-19 18:23:50,656 - Detection - Number of evaluation samples = 203
2023-04-19 18:23:50,661 - Detection - Number of testing samples = 1896
2023-04-19 18:23:56,064 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-19 18:23:56,144 - Detection - Pre-training Begin...
2023-04-19 18:23:58,126 - Detection - ***** Epoch: 1: Eval results *****
2023-04-19 18:23:58,126 - Detection -   best_eval_score = 0
2023-04-19 18:23:58,126 - Detection -   eval_score = 0.36
2023-04-19 18:23:58,126 - Detection -   train_loss = 2.959738349914551
2023-04-19 18:23:59,625 - Detection - ***** Epoch: 2: Eval results *****
2023-04-19 18:23:59,625 - Detection -   best_eval_score = 0.36
2023-04-19 18:23:59,625 - Detection -   eval_score = 1.25
2023-04-19 18:23:59,625 - Detection -   train_loss = 2.949121856689453
2023-04-19 18:24:01,123 - Detection - ***** Epoch: 3: Eval results *****
2023-04-19 18:24:01,123 - Detection -   best_eval_score = 1.25
2023-04-19 18:24:01,123 - Detection -   eval_score = 1.75
2023-04-19 18:24:01,123 - Detection -   train_loss = 2.919978952407837
2023-04-19 18:24:02,621 - Detection - ***** Epoch: 4: Eval results *****
2023-04-19 18:24:02,621 - Detection -   best_eval_score = 1.75
2023-04-19 18:24:02,621 - Detection -   eval_score = 2.03
2023-04-19 18:24:02,621 - Detection -   train_loss = 2.8844406604766846
2023-04-19 18:24:04,119 - Detection - ***** Epoch: 5: Eval results *****
2023-04-19 18:24:04,119 - Detection -   best_eval_score = 2.03
2023-04-19 18:24:04,119 - Detection -   eval_score = 2.1
2023-04-19 18:24:04,119 - Detection -   train_loss = 2.857944440841675
2023-04-19 18:24:05,620 - Detection - ***** Epoch: 6: Eval results *****
2023-04-19 18:24:05,620 - Detection -   best_eval_score = 2.1
2023-04-19 18:24:05,620 - Detection -   eval_score = 2.24
2023-04-19 18:24:05,620 - Detection -   train_loss = 2.8338013172149656
2023-04-19 18:24:07,121 - Detection - ***** Epoch: 7: Eval results *****
2023-04-19 18:24:07,121 - Detection -   best_eval_score = 2.24
2023-04-19 18:24:07,121 - Detection -   eval_score = 2.43
2023-04-19 18:24:07,121 - Detection -   train_loss = 2.7986138343811033
2023-04-19 18:24:08,622 - Detection - ***** Epoch: 8: Eval results *****
2023-04-19 18:24:08,622 - Detection -   best_eval_score = 2.43
2023-04-19 18:24:08,622 - Detection -   eval_score = 2.38
2023-04-19 18:24:08,622 - Detection -   train_loss = 2.770356798171997
2023-04-19 18:24:10,114 - Detection - ***** Epoch: 9: Eval results *****
2023-04-19 18:24:10,114 - Detection -   best_eval_score = 2.43
2023-04-19 18:24:10,114 - Detection -   eval_score = 3.52
2023-04-19 18:24:10,114 - Detection -   train_loss = 2.739802837371826
2023-04-19 18:24:11,617 - Detection - ***** Epoch: 10: Eval results *****
2023-04-19 18:24:11,617 - Detection -   best_eval_score = 3.52
2023-04-19 18:24:11,617 - Detection -   eval_score = 3.14
2023-04-19 18:24:11,617 - Detection -   train_loss = 2.694577121734619
2023-04-19 18:24:13,110 - Detection - ***** Epoch: 11: Eval results *****
2023-04-19 18:24:13,110 - Detection -   best_eval_score = 3.52
2023-04-19 18:24:13,110 - Detection -   eval_score = 3.39
2023-04-19 18:24:13,110 - Detection -   train_loss = 2.6500744342803957
2023-04-19 18:24:14,604 - Detection - ***** Epoch: 12: Eval results *****
2023-04-19 18:24:14,604 - Detection -   best_eval_score = 3.52
2023-04-19 18:24:14,604 - Detection -   eval_score = 8.06
2023-04-19 18:24:14,604 - Detection -   train_loss = 2.599456310272217
2023-04-19 18:24:16,110 - Detection - ***** Epoch: 13: Eval results *****
2023-04-19 18:24:16,111 - Detection -   best_eval_score = 8.06
2023-04-19 18:24:16,111 - Detection -   eval_score = 15.44
2023-04-19 18:24:16,111 - Detection -   train_loss = 2.5265268802642824
2023-04-19 18:24:17,618 - Detection - ***** Epoch: 14: Eval results *****
2023-04-19 18:24:17,618 - Detection -   best_eval_score = 15.44
2023-04-19 18:24:17,618 - Detection -   eval_score = 28.36
2023-04-19 18:24:17,618 - Detection -   train_loss = 2.417515182495117
2023-04-19 18:24:19,125 - Detection - ***** Epoch: 15: Eval results *****
2023-04-19 18:24:19,125 - Detection -   best_eval_score = 28.36
2023-04-19 18:24:19,125 - Detection -   eval_score = 32.93
2023-04-19 18:24:19,125 - Detection -   train_loss = 2.3126665115356446
2023-04-19 18:24:20,634 - Detection - ***** Epoch: 16: Eval results *****
2023-04-19 18:24:20,634 - Detection -   best_eval_score = 32.93
2023-04-19 18:24:20,634 - Detection -   eval_score = 46.46
2023-04-19 18:24:20,634 - Detection -   train_loss = 2.198837089538574
2023-04-19 18:24:22,246 - Detection - ***** Epoch: 17: Eval results *****
2023-04-19 18:24:22,246 - Detection -   best_eval_score = 46.46
2023-04-19 18:24:22,246 - Detection -   eval_score = 49.3
2023-04-19 18:24:22,246 - Detection -   train_loss = 2.067599725723267
2023-04-19 18:24:23,754 - Detection - ***** Epoch: 18: Eval results *****
2023-04-19 18:24:23,754 - Detection -   best_eval_score = 49.3
2023-04-19 18:24:23,754 - Detection -   eval_score = 55.28
2023-04-19 18:24:23,754 - Detection -   train_loss = 1.939814829826355
2023-04-19 18:24:25,263 - Detection - ***** Epoch: 19: Eval results *****
2023-04-19 18:24:25,264 - Detection -   best_eval_score = 55.28
2023-04-19 18:24:25,264 - Detection -   eval_score = 55.8
2023-04-19 18:24:25,264 - Detection -   train_loss = 1.8097842693328858
2023-04-19 18:24:26,774 - Detection - ***** Epoch: 20: Eval results *****
2023-04-19 18:24:26,774 - Detection -   best_eval_score = 55.8
2023-04-19 18:24:26,774 - Detection -   eval_score = 64.22
2023-04-19 18:24:26,774 - Detection -   train_loss = 1.7195743322372437
2023-04-19 18:24:28,286 - Detection - ***** Epoch: 21: Eval results *****
2023-04-19 18:24:28,286 - Detection -   best_eval_score = 64.22
2023-04-19 18:24:28,286 - Detection -   eval_score = 66.81
2023-04-19 18:24:28,286 - Detection -   train_loss = 1.6272674322128295
2023-04-19 18:24:29,796 - Detection - ***** Epoch: 22: Eval results *****
2023-04-19 18:24:29,796 - Detection -   best_eval_score = 66.81
2023-04-19 18:24:29,796 - Detection -   eval_score = 68.45
2023-04-19 18:24:29,796 - Detection -   train_loss = 1.5621511697769166
2023-04-19 18:24:31,307 - Detection - ***** Epoch: 23: Eval results *****
2023-04-19 18:24:31,307 - Detection -   best_eval_score = 68.45
2023-04-19 18:24:31,307 - Detection -   eval_score = 73.66
2023-04-19 18:24:31,307 - Detection -   train_loss = 1.495129942893982
2023-04-19 18:24:32,819 - Detection - ***** Epoch: 24: Eval results *****
2023-04-19 18:24:32,819 - Detection -   best_eval_score = 73.66
2023-04-19 18:24:32,820 - Detection -   eval_score = 75.87
2023-04-19 18:24:32,820 - Detection -   train_loss = 1.4360145807266236
2023-04-19 18:24:34,335 - Detection - ***** Epoch: 25: Eval results *****
2023-04-19 18:24:34,335 - Detection -   best_eval_score = 75.87
2023-04-19 18:24:34,335 - Detection -   eval_score = 75.98
2023-04-19 18:24:34,335 - Detection -   train_loss = 1.3851161241531371
2023-04-19 18:24:35,849 - Detection - ***** Epoch: 26: Eval results *****
2023-04-19 18:24:35,849 - Detection -   best_eval_score = 75.98
2023-04-19 18:24:35,849 - Detection -   eval_score = 76.26
2023-04-19 18:24:35,849 - Detection -   train_loss = 1.345973587036133
2023-04-19 18:24:37,362 - Detection - ***** Epoch: 27: Eval results *****
2023-04-19 18:24:37,362 - Detection -   best_eval_score = 76.26
2023-04-19 18:24:37,362 - Detection -   eval_score = 76.97
2023-04-19 18:24:37,362 - Detection -   train_loss = 1.3110801219940185
2023-04-19 18:24:38,877 - Detection - ***** Epoch: 28: Eval results *****
2023-04-19 18:24:38,877 - Detection -   best_eval_score = 76.97
2023-04-19 18:24:38,877 - Detection -   eval_score = 77.77
2023-04-19 18:24:38,877 - Detection -   train_loss = 1.2689752578735352
2023-04-19 18:24:40,391 - Detection - ***** Epoch: 29: Eval results *****
2023-04-19 18:24:40,391 - Detection -   best_eval_score = 77.77
2023-04-19 18:24:40,391 - Detection -   eval_score = 77.46
2023-04-19 18:24:40,391 - Detection -   train_loss = 1.2362869739532472
2023-04-19 18:24:41,897 - Detection - ***** Epoch: 30: Eval results *****
2023-04-19 18:24:41,897 - Detection -   best_eval_score = 77.77
2023-04-19 18:24:41,897 - Detection -   eval_score = 77.0
2023-04-19 18:24:41,897 - Detection -   train_loss = 1.2030802249908448
2023-04-19 18:24:43,403 - Detection - ***** Epoch: 31: Eval results *****
2023-04-19 18:24:43,403 - Detection -   best_eval_score = 77.77
2023-04-19 18:24:43,403 - Detection -   eval_score = 76.9
2023-04-19 18:24:43,403 - Detection -   train_loss = 1.178980302810669
2023-04-19 18:24:44,910 - Detection - ***** Epoch: 32: Eval results *****
2023-04-19 18:24:44,910 - Detection -   best_eval_score = 77.77
2023-04-19 18:24:44,910 - Detection -   eval_score = 77.39
2023-04-19 18:24:44,910 - Detection -   train_loss = 1.1557232856750488
2023-04-19 18:24:46,418 - Detection - ***** Epoch: 33: Eval results *****
2023-04-19 18:24:46,418 - Detection -   best_eval_score = 77.77
2023-04-19 18:24:46,418 - Detection -   eval_score = 79.51
2023-04-19 18:24:46,418 - Detection -   train_loss = 1.1467267274856567
2023-04-19 18:24:47,936 - Detection - ***** Epoch: 34: Eval results *****
2023-04-19 18:24:47,936 - Detection -   best_eval_score = 79.51
2023-04-19 18:24:47,936 - Detection -   eval_score = 79.02
2023-04-19 18:24:47,936 - Detection -   train_loss = 1.1189060926437377
2023-04-19 18:24:49,443 - Detection - ***** Epoch: 35: Eval results *****
2023-04-19 18:24:49,443 - Detection -   best_eval_score = 79.51
2023-04-19 18:24:49,443 - Detection -   eval_score = 78.77
2023-04-19 18:24:49,443 - Detection -   train_loss = 1.1010621547698975
2023-04-19 18:24:50,952 - Detection - ***** Epoch: 36: Eval results *****
2023-04-19 18:24:50,952 - Detection -   best_eval_score = 79.51
2023-04-19 18:24:50,952 - Detection -   eval_score = 79.3
2023-04-19 18:24:50,952 - Detection -   train_loss = 1.0791526079177856
2023-04-19 18:24:52,459 - Detection - ***** Epoch: 37: Eval results *****
2023-04-19 18:24:52,460 - Detection -   best_eval_score = 79.51
2023-04-19 18:24:52,460 - Detection -   eval_score = 79.26
2023-04-19 18:24:52,460 - Detection -   train_loss = 1.0642142057418824
2023-04-19 18:24:53,967 - Detection - ***** Epoch: 38: Eval results *****
2023-04-19 18:24:53,967 - Detection -   best_eval_score = 79.51
2023-04-19 18:24:53,967 - Detection -   eval_score = 80.19
2023-04-19 18:24:53,967 - Detection -   train_loss = 1.0499614953994751
2023-04-19 18:24:55,488 - Detection - ***** Epoch: 39: Eval results *****
2023-04-19 18:24:55,488 - Detection -   best_eval_score = 80.19
2023-04-19 18:24:55,488 - Detection -   eval_score = 79.84
2023-04-19 18:24:55,488 - Detection -   train_loss = 1.0366055250167847
2023-04-19 18:24:56,999 - Detection - ***** Epoch: 40: Eval results *****
2023-04-19 18:24:56,999 - Detection -   best_eval_score = 80.19
2023-04-19 18:24:56,999 - Detection -   eval_score = 80.16
2023-04-19 18:24:56,999 - Detection -   train_loss = 1.02194687128067
2023-04-19 18:24:58,507 - Detection - ***** Epoch: 41: Eval results *****
2023-04-19 18:24:58,508 - Detection -   best_eval_score = 80.19
2023-04-19 18:24:58,508 - Detection -   eval_score = 80.74
2023-04-19 18:24:58,508 - Detection -   train_loss = 1.0106594920158387
2023-04-19 18:25:00,031 - Detection - ***** Epoch: 42: Eval results *****
2023-04-19 18:25:00,031 - Detection -   best_eval_score = 80.74
2023-04-19 18:25:00,031 - Detection -   eval_score = 80.38
2023-04-19 18:25:00,031 - Detection -   train_loss = 0.9964111566543579
2023-04-19 18:25:01,545 - Detection - ***** Epoch: 43: Eval results *****
2023-04-19 18:25:01,545 - Detection -   best_eval_score = 80.74
2023-04-19 18:25:01,545 - Detection -   eval_score = 81.02
2023-04-19 18:25:01,545 - Detection -   train_loss = 0.991592800617218
2023-04-19 18:25:03,073 - Detection - ***** Epoch: 44: Eval results *****
2023-04-19 18:25:03,073 - Detection -   best_eval_score = 81.02
2023-04-19 18:25:03,074 - Detection -   eval_score = 80.65
2023-04-19 18:25:03,074 - Detection -   train_loss = 0.985190999507904
2023-04-19 18:25:04,589 - Detection - ***** Epoch: 45: Eval results *****
2023-04-19 18:25:04,589 - Detection -   best_eval_score = 81.02
2023-04-19 18:25:04,589 - Detection -   eval_score = 81.59
2023-04-19 18:25:04,589 - Detection -   train_loss = 0.969552481174469
2023-04-19 18:25:06,115 - Detection - ***** Epoch: 46: Eval results *****
2023-04-19 18:25:06,116 - Detection -   best_eval_score = 81.59
2023-04-19 18:25:06,116 - Detection -   eval_score = 81.02
2023-04-19 18:25:06,116 - Detection -   train_loss = 0.9643520236015319
2023-04-19 18:25:07,631 - Detection - ***** Epoch: 47: Eval results *****
2023-04-19 18:25:07,631 - Detection -   best_eval_score = 81.59
2023-04-19 18:25:07,631 - Detection -   eval_score = 81.07
2023-04-19 18:25:07,631 - Detection -   train_loss = 0.9518494606018066
2023-04-19 18:25:09,146 - Detection - ***** Epoch: 48: Eval results *****
2023-04-19 18:25:09,146 - Detection -   best_eval_score = 81.59
2023-04-19 18:25:09,146 - Detection -   eval_score = 80.75
2023-04-19 18:25:09,146 - Detection -   train_loss = 0.950393807888031
2023-04-19 18:25:10,660 - Detection - ***** Epoch: 49: Eval results *****
2023-04-19 18:25:10,660 - Detection -   best_eval_score = 81.59
2023-04-19 18:25:10,660 - Detection -   eval_score = 81.66
2023-04-19 18:25:10,660 - Detection -   train_loss = 0.9326242208480835
2023-04-19 18:25:12,187 - Detection - ***** Epoch: 50: Eval results *****
2023-04-19 18:25:12,187 - Detection -   best_eval_score = 81.66
2023-04-19 18:25:12,187 - Detection -   eval_score = 81.62
2023-04-19 18:25:12,187 - Detection -   train_loss = 0.9254524946212769
2023-04-19 18:25:13,705 - Detection - ***** Epoch: 51: Eval results *****
2023-04-19 18:25:13,705 - Detection -   best_eval_score = 81.66
2023-04-19 18:25:13,705 - Detection -   eval_score = 81.62
2023-04-19 18:25:13,705 - Detection -   train_loss = 0.9189132332801819
2023-04-19 18:25:15,220 - Detection - ***** Epoch: 52: Eval results *****
2023-04-19 18:25:15,220 - Detection -   best_eval_score = 81.66
2023-04-19 18:25:15,220 - Detection -   eval_score = 81.13
2023-04-19 18:25:15,220 - Detection -   train_loss = 0.9136423826217651
2023-04-19 18:25:16,735 - Detection - ***** Epoch: 53: Eval results *****
2023-04-19 18:25:16,735 - Detection -   best_eval_score = 81.66
2023-04-19 18:25:16,735 - Detection -   eval_score = 80.45
2023-04-19 18:25:16,736 - Detection -   train_loss = 0.910542893409729
2023-04-19 18:25:18,251 - Detection - ***** Epoch: 54: Eval results *****
2023-04-19 18:25:18,251 - Detection -   best_eval_score = 81.66
2023-04-19 18:25:18,251 - Detection -   eval_score = 81.26
2023-04-19 18:25:18,251 - Detection -   train_loss = 0.9039190173149109
2023-04-19 18:25:19,768 - Detection - ***** Epoch: 55: Eval results *****
2023-04-19 18:25:19,768 - Detection -   best_eval_score = 81.66
2023-04-19 18:25:19,768 - Detection -   eval_score = 82.12
2023-04-19 18:25:19,768 - Detection -   train_loss = 0.8991638779640198
2023-04-19 18:25:21,296 - Detection - ***** Epoch: 56: Eval results *****
2023-04-19 18:25:21,296 - Detection -   best_eval_score = 82.12
2023-04-19 18:25:21,296 - Detection -   eval_score = 82.27
2023-04-19 18:25:21,296 - Detection -   train_loss = 0.8972133994102478
2023-04-19 18:25:22,824 - Detection - ***** Epoch: 57: Eval results *****
2023-04-19 18:25:22,825 - Detection -   best_eval_score = 82.27
2023-04-19 18:25:22,825 - Detection -   eval_score = 82.27
2023-04-19 18:25:22,825 - Detection -   train_loss = 0.8929445505142212
2023-04-19 18:25:24,340 - Detection - ***** Epoch: 58: Eval results *****
2023-04-19 18:25:24,340 - Detection -   best_eval_score = 82.27
2023-04-19 18:25:24,340 - Detection -   eval_score = 82.27
2023-04-19 18:25:24,340 - Detection -   train_loss = 0.8848270058631897
2023-04-19 18:25:25,855 - Detection - ***** Epoch: 59: Eval results *****
2023-04-19 18:25:25,855 - Detection -   best_eval_score = 82.27
2023-04-19 18:25:25,855 - Detection -   eval_score = 82.27
2023-04-19 18:25:25,856 - Detection -   train_loss = 0.8789939999580383
2023-04-19 18:25:27,372 - Detection - ***** Epoch: 60: Eval results *****
2023-04-19 18:25:27,372 - Detection -   best_eval_score = 82.27
2023-04-19 18:25:27,372 - Detection -   eval_score = 82.27
2023-04-19 18:25:27,373 - Detection -   train_loss = 0.8833117365837098
2023-04-19 18:25:28,889 - Detection - ***** Epoch: 61: Eval results *****
2023-04-19 18:25:28,889 - Detection -   best_eval_score = 82.27
2023-04-19 18:25:28,889 - Detection -   eval_score = 82.61
2023-04-19 18:25:28,889 - Detection -   train_loss = 0.8765369534492493
2023-04-19 18:25:30,519 - Detection - ***** Epoch: 62: Eval results *****
2023-04-19 18:25:30,519 - Detection -   best_eval_score = 82.61
2023-04-19 18:25:30,519 - Detection -   eval_score = 82.61
2023-04-19 18:25:30,519 - Detection -   train_loss = 0.8697963833808899
2023-04-19 18:25:32,035 - Detection - ***** Epoch: 63: Eval results *****
2023-04-19 18:25:32,035 - Detection -   best_eval_score = 82.61
2023-04-19 18:25:32,035 - Detection -   eval_score = 82.61
2023-04-19 18:25:32,035 - Detection -   train_loss = 0.8715101718902588
2023-04-19 18:25:33,552 - Detection - ***** Epoch: 64: Eval results *****
2023-04-19 18:25:33,552 - Detection -   best_eval_score = 82.61
2023-04-19 18:25:33,552 - Detection -   eval_score = 82.61
2023-04-19 18:25:33,552 - Detection -   train_loss = 0.861857271194458
2023-04-19 18:25:35,068 - Detection - ***** Epoch: 65: Eval results *****
2023-04-19 18:25:35,068 - Detection -   best_eval_score = 82.61
2023-04-19 18:25:35,068 - Detection -   eval_score = 82.61
2023-04-19 18:25:35,069 - Detection -   train_loss = 0.862277090549469
2023-04-19 18:25:36,585 - Detection - ***** Epoch: 66: Eval results *****
2023-04-19 18:25:36,585 - Detection -   best_eval_score = 82.61
2023-04-19 18:25:36,585 - Detection -   eval_score = 82.61
2023-04-19 18:25:36,585 - Detection -   train_loss = 0.8612173557281494
2023-04-19 18:25:38,101 - Detection - ***** Epoch: 67: Eval results *****
2023-04-19 18:25:38,101 - Detection -   best_eval_score = 82.61
2023-04-19 18:25:38,101 - Detection -   eval_score = 82.61
2023-04-19 18:25:38,101 - Detection -   train_loss = 0.8574406862258911
2023-04-19 18:25:39,618 - Detection - ***** Epoch: 68: Eval results *****
2023-04-19 18:25:39,618 - Detection -   best_eval_score = 82.61
2023-04-19 18:25:39,618 - Detection -   eval_score = 82.61
2023-04-19 18:25:39,618 - Detection -   train_loss = 0.8552597165107727
2023-04-19 18:25:41,136 - Detection - ***** Epoch: 69: Eval results *****
2023-04-19 18:25:41,136 - Detection -   best_eval_score = 82.61
2023-04-19 18:25:41,136 - Detection -   eval_score = 82.61
2023-04-19 18:25:41,136 - Detection -   train_loss = 0.8504854440689087
2023-04-19 18:25:42,655 - Detection - ***** Epoch: 70: Eval results *****
2023-04-19 18:25:42,655 - Detection -   best_eval_score = 82.61
2023-04-19 18:25:42,655 - Detection -   eval_score = 82.61
2023-04-19 18:25:42,655 - Detection -   train_loss = 0.8496102213859558
2023-04-19 18:25:44,173 - Detection - ***** Epoch: 71: Eval results *****
2023-04-19 18:25:44,173 - Detection -   best_eval_score = 82.61
2023-04-19 18:25:44,173 - Detection -   eval_score = 82.61
2023-04-19 18:25:44,173 - Detection -   train_loss = 0.8493173956871033
2023-04-19 18:25:44,173 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_cg_0.25_1.0_bert_disaware_1/models
2023-04-19 18:25:44,714 - Detection - Pre-training finished...
2023-04-19 18:25:44,714 - Detection - Training Begin...
2023-04-19 18:25:45,615 - Detection - ***** Epoch: 1: Eval results *****
2023-04-19 18:25:45,615 - Detection -   best_eval_score = 0
2023-04-19 18:25:45,615 - Detection -   eval_score = 0.0
2023-04-19 18:25:45,615 - Detection -   train_loss = 3.2768457889556886
2023-04-19 18:25:46,517 - Detection - ***** Epoch: 2: Eval results *****
2023-04-19 18:25:46,517 - Detection -   best_eval_score = 0
2023-04-19 18:25:46,517 - Detection -   eval_score = 0.0
2023-04-19 18:25:46,517 - Detection -   train_loss = 3.142303705215454
2023-04-19 18:25:47,418 - Detection - ***** Epoch: 3: Eval results *****
2023-04-19 18:25:47,418 - Detection -   best_eval_score = 0
2023-04-19 18:25:47,418 - Detection -   eval_score = 0.91
2023-04-19 18:25:47,418 - Detection -   train_loss = 3.005187749862671
2023-04-19 18:25:48,319 - Detection - ***** Epoch: 4: Eval results *****
2023-04-19 18:25:48,319 - Detection -   best_eval_score = 0.91
2023-04-19 18:25:48,319 - Detection -   eval_score = 0.91
2023-04-19 18:25:48,319 - Detection -   train_loss = 2.8377586364746095
2023-04-19 18:25:49,221 - Detection - ***** Epoch: 5: Eval results *****
2023-04-19 18:25:49,221 - Detection -   best_eval_score = 0.91
2023-04-19 18:25:49,221 - Detection -   eval_score = 1.67
2023-04-19 18:25:49,221 - Detection -   train_loss = 2.707088279724121
2023-04-19 18:25:50,122 - Detection - ***** Epoch: 6: Eval results *****
2023-04-19 18:25:50,122 - Detection -   best_eval_score = 1.67
2023-04-19 18:25:50,122 - Detection -   eval_score = 3.22
2023-04-19 18:25:50,122 - Detection -   train_loss = 2.5026806354522706
2023-04-19 18:25:51,023 - Detection - ***** Epoch: 7: Eval results *****
2023-04-19 18:25:51,024 - Detection -   best_eval_score = 3.22
2023-04-19 18:25:51,024 - Detection -   eval_score = 8.65
2023-04-19 18:25:51,024 - Detection -   train_loss = 2.3289849758148193
2023-04-19 18:25:51,925 - Detection - ***** Epoch: 8: Eval results *****
2023-04-19 18:25:51,926 - Detection -   best_eval_score = 8.65
2023-04-19 18:25:51,926 - Detection -   eval_score = 14.13
2023-04-19 18:25:51,926 - Detection -   train_loss = 2.1138728141784666
2023-04-19 18:25:52,827 - Detection - ***** Epoch: 9: Eval results *****
2023-04-19 18:25:52,827 - Detection -   best_eval_score = 14.13
2023-04-19 18:25:52,827 - Detection -   eval_score = 21.64
2023-04-19 18:25:52,827 - Detection -   train_loss = 1.9112745761871337
2023-04-19 18:25:53,728 - Detection - ***** Epoch: 10: Eval results *****
2023-04-19 18:25:53,728 - Detection -   best_eval_score = 21.64
2023-04-19 18:25:53,728 - Detection -   eval_score = 29.31
2023-04-19 18:25:53,728 - Detection -   train_loss = 1.652082371711731
2023-04-19 18:25:54,631 - Detection - ***** Epoch: 11: Eval results *****
2023-04-19 18:25:54,631 - Detection -   best_eval_score = 29.31
2023-04-19 18:25:54,631 - Detection -   eval_score = 34.43
2023-04-19 18:25:54,631 - Detection -   train_loss = 1.4482208728790282
2023-04-19 18:25:55,533 - Detection - ***** Epoch: 12: Eval results *****
2023-04-19 18:25:55,533 - Detection -   best_eval_score = 34.43
2023-04-19 18:25:55,533 - Detection -   eval_score = 40.2
2023-04-19 18:25:55,533 - Detection -   train_loss = 1.2519131660461427
2023-04-19 18:25:56,435 - Detection - ***** Epoch: 13: Eval results *****
2023-04-19 18:25:56,435 - Detection -   best_eval_score = 40.2
2023-04-19 18:25:56,435 - Detection -   eval_score = 43.46
2023-04-19 18:25:56,435 - Detection -   train_loss = 1.0679681062698365
2023-04-19 18:25:57,337 - Detection - ***** Epoch: 14: Eval results *****
2023-04-19 18:25:57,337 - Detection -   best_eval_score = 43.46
2023-04-19 18:25:57,337 - Detection -   eval_score = 48.79
2023-04-19 18:25:57,337 - Detection -   train_loss = 0.9213138461112976
2023-04-19 18:25:58,238 - Detection - ***** Epoch: 15: Eval results *****
2023-04-19 18:25:58,238 - Detection -   best_eval_score = 48.79
2023-04-19 18:25:58,238 - Detection -   eval_score = 52.8
2023-04-19 18:25:58,238 - Detection -   train_loss = 0.7997575044631958
2023-04-19 18:25:59,140 - Detection - ***** Epoch: 16: Eval results *****
2023-04-19 18:25:59,140 - Detection -   best_eval_score = 52.8
2023-04-19 18:25:59,140 - Detection -   eval_score = 55.84
2023-04-19 18:25:59,140 - Detection -   train_loss = 0.6713979601860046
2023-04-19 18:26:00,042 - Detection - ***** Epoch: 17: Eval results *****
2023-04-19 18:26:00,042 - Detection -   best_eval_score = 55.84
2023-04-19 18:26:00,042 - Detection -   eval_score = 58.42
2023-04-19 18:26:00,042 - Detection -   train_loss = 0.6254155576229096
2023-04-19 18:26:00,943 - Detection - ***** Epoch: 18: Eval results *****
2023-04-19 18:26:00,943 - Detection -   best_eval_score = 58.42
2023-04-19 18:26:00,943 - Detection -   eval_score = 59.36
2023-04-19 18:26:00,943 - Detection -   train_loss = 0.5684194326400757
2023-04-19 18:26:01,845 - Detection - ***** Epoch: 19: Eval results *****
2023-04-19 18:26:01,845 - Detection -   best_eval_score = 59.36
2023-04-19 18:26:01,845 - Detection -   eval_score = 59.03
2023-04-19 18:26:01,845 - Detection -   train_loss = 0.550162011384964
2023-04-19 18:26:02,747 - Detection - ***** Epoch: 20: Eval results *****
2023-04-19 18:26:02,747 - Detection -   best_eval_score = 59.36
2023-04-19 18:26:02,747 - Detection -   eval_score = 59.89
2023-04-19 18:26:02,747 - Detection -   train_loss = 0.5546587467193603
2023-04-19 18:26:03,649 - Detection - ***** Epoch: 21: Eval results *****
2023-04-19 18:26:03,649 - Detection -   best_eval_score = 59.89
2023-04-19 18:26:03,649 - Detection -   eval_score = 60.16
2023-04-19 18:26:03,649 - Detection -   train_loss = 0.5424837112426758
2023-04-19 18:26:04,551 - Detection - ***** Epoch: 22: Eval results *****
2023-04-19 18:26:04,551 - Detection -   best_eval_score = 60.16
2023-04-19 18:26:04,551 - Detection -   eval_score = 59.84
2023-04-19 18:26:04,551 - Detection -   train_loss = 0.5313914597034455
2023-04-19 18:26:05,452 - Detection - ***** Epoch: 23: Eval results *****
2023-04-19 18:26:05,452 - Detection -   best_eval_score = 60.16
2023-04-19 18:26:05,452 - Detection -   eval_score = 59.33
2023-04-19 18:26:05,452 - Detection -   train_loss = 0.5373329877853393
2023-04-19 18:26:06,354 - Detection - ***** Epoch: 24: Eval results *****
2023-04-19 18:26:06,355 - Detection -   best_eval_score = 60.16
2023-04-19 18:26:06,355 - Detection -   eval_score = 58.5
2023-04-19 18:26:06,355 - Detection -   train_loss = 0.5238729834556579
2023-04-19 18:26:07,256 - Detection - ***** Epoch: 25: Eval results *****
2023-04-19 18:26:07,256 - Detection -   best_eval_score = 60.16
2023-04-19 18:26:07,256 - Detection -   eval_score = 58.91
2023-04-19 18:26:07,256 - Detection -   train_loss = 0.5487461566925049
2023-04-19 18:26:08,158 - Detection - ***** Epoch: 26: Eval results *****
2023-04-19 18:26:08,158 - Detection -   best_eval_score = 60.16
2023-04-19 18:26:08,158 - Detection -   eval_score = 58.91
2023-04-19 18:26:08,158 - Detection -   train_loss = 0.5358526945114136
2023-04-19 18:26:09,060 - Detection - ***** Epoch: 27: Eval results *****
2023-04-19 18:26:09,060 - Detection -   best_eval_score = 60.16
2023-04-19 18:26:09,060 - Detection -   eval_score = 58.91
2023-04-19 18:26:09,060 - Detection -   train_loss = 0.5180145561695099
2023-04-19 18:26:09,962 - Detection - ***** Epoch: 28: Eval results *****
2023-04-19 18:26:09,962 - Detection -   best_eval_score = 60.16
2023-04-19 18:26:09,962 - Detection -   eval_score = 59.27
2023-04-19 18:26:09,962 - Detection -   train_loss = 0.5540619492530823
2023-04-19 18:26:10,864 - Detection - ***** Epoch: 29: Eval results *****
2023-04-19 18:26:10,864 - Detection -   best_eval_score = 60.16
2023-04-19 18:26:10,864 - Detection -   eval_score = 58.86
2023-04-19 18:26:10,864 - Detection -   train_loss = 0.5466087460517883
2023-04-19 18:26:11,766 - Detection - ***** Epoch: 30: Eval results *****
2023-04-19 18:26:11,766 - Detection -   best_eval_score = 60.16
2023-04-19 18:26:11,766 - Detection -   eval_score = 58.13
2023-04-19 18:26:11,766 - Detection -   train_loss = 0.5393067419528961
2023-04-19 18:26:12,667 - Detection - ***** Epoch: 31: Eval results *****
2023-04-19 18:26:12,667 - Detection -   best_eval_score = 60.16
2023-04-19 18:26:12,667 - Detection -   eval_score = 57.77
2023-04-19 18:26:12,667 - Detection -   train_loss = 0.5048291265964509
2023-04-19 18:26:12,669 - Detection - Training Finished...
2023-04-19 18:26:12,669 - Detection - Testing begin...
2023-04-19 18:26:14,576 - Detection - ***** Test: Confusion Matrix *****
2023-04-19 18:26:14,577 - Detection - [[  22    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    5]
 [   0   11    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0   13]
 [   0    0   11    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    1    0   20]
 [   0    0    0   20    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    2]
 [   0    0    0    0   14    0    0    0    0    0    0    0    0    0
     0    0    0    0    0   17]
 [   0    0    0    0    0    0   11    0    0    0    0    0    0    0
     0    0    0    0    0   19]
 [   0    0    0    0    0    0   16    0    0    0    0    0    0    0
     0    0    0    0    0   11]
 [   0    0    0    0    0    0    0    1    0    0    0    0    1    0
     0    0    0    0    0   24]
 [   0    0    0    0    0    0    0    0   17    0    0    0    0    0
     0    0    0    0    0   10]
 [   0    0    0    0    2    0    0    0    0    6    0    0    0    0
     0    0    0    0    0   11]
 [   0    0    0    0    0    0    0    0    0    0   28    0    0    0
     0    0    0    0    0    3]
 [   0    0    0    0    0    0    0    0    0    0    0   17    0    0
     0    0    0    0    0   18]
 [   0    0    0    0    0    0    0    0    0    0    0    0   16    0
     0    0    0    0    0    6]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0   17
     0    0    0    0    0    6]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
    25    0    0    0    0    4]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0   31    0    0    0    4]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0   18    0    0    8]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    9    0   11]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    7    9]
 [   0    3    2   34    5    0    4    1   14    2    2   26   67    1
     0   56    7   12    1 1157]]
2023-04-19 18:26:14,577 - Detection - ***** Test results *****
2023-04-19 18:26:14,577 - Detection -   Acc = 76.11
2023-04-19 18:26:14,577 - Detection -   F1 = 55.8111
2023-04-19 18:26:14,577 - Detection -   F1-known = 54.323
2023-04-19 18:26:14,577 - Detection -   F1-open = 84.0843
2023-04-19 18:26:14,577 - Detection - Testing finished...
2023-04-19 18:26:14,577 - Detection - Results saved in results/results_DA-ADB.csv
2023-04-19 18:26:14,596 - Detection - Open Intent Detection Finished...
