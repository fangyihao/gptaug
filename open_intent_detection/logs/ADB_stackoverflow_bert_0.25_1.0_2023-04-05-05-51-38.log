2023-04-05 05:51:38,292 - Detection - Open Intent Detection Begin...
2023-04-05 05:51:38,292 - Detection - Parameters Initialization...
2023-04-05 05:51:38,293 - Detection - ============================== Params ==============================
2023-04-05 05:51:38,293 - Detection - type:	open_intent_detection
2023-04-05 05:51:38,293 - Detection - logger_name:	Detection
2023-04-05 05:51:38,293 - Detection - log_dir:	logs
2023-04-05 05:51:38,293 - Detection - dataset:	stackoverflow
2023-04-05 05:51:38,293 - Detection - known_cls_ratio:	0.25
2023-04-05 05:51:38,293 - Detection - labeled_ratio:	1.0
2023-04-05 05:51:38,293 - Detection - method:	ADB
2023-04-05 05:51:38,293 - Detection - train:	True
2023-04-05 05:51:38,293 - Detection - pretrain:	True
2023-04-05 05:51:38,293 - Detection - save_model:	True
2023-04-05 05:51:38,293 - Detection - backbone:	bert
2023-04-05 05:51:38,293 - Detection - config_file_name:	ADB
2023-04-05 05:51:38,293 - Detection - seed:	7
2023-04-05 05:51:38,293 - Detection - gpu_id:	0
2023-04-05 05:51:38,293 - Detection - pipe_results_path:	pipe_results
2023-04-05 05:51:38,293 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-05 05:51:38,293 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-05 05:51:38,293 - Detection - model_dir:	models
2023-04-05 05:51:38,293 - Detection - load_pretrained_method:	None
2023-04-05 05:51:38,293 - Detection - result_dir:	results
2023-04-05 05:51:38,293 - Detection - results_file_name:	results_ADB.csv
2023-04-05 05:51:38,293 - Detection - save_results:	True
2023-04-05 05:51:38,293 - Detection - loss_fct:	CrossEntropyLoss
2023-04-05 05:51:38,293 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_0.25_1.0_bert_7
2023-04-05 05:51:38,293 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_0.25_1.0_bert_7/models
2023-04-05 05:51:38,293 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-05 05:51:38,293 - Detection - num_train_epochs:	100
2023-04-05 05:51:38,293 - Detection - num_labels:	None
2023-04-05 05:51:38,293 - Detection - max_seq_length:	None
2023-04-05 05:51:38,293 - Detection - freeze_backbone_parameters:	True
2023-04-05 05:51:38,293 - Detection - feat_dim:	768
2023-04-05 05:51:38,293 - Detection - warmup_proportion:	0.1
2023-04-05 05:51:38,293 - Detection - lr_boundary:	0.05
2023-04-05 05:51:38,293 - Detection - lr:	2e-05
2023-04-05 05:51:38,293 - Detection - activation:	relu
2023-04-05 05:51:38,293 - Detection - train_batch_size:	128
2023-04-05 05:51:38,293 - Detection - eval_batch_size:	64
2023-04-05 05:51:38,293 - Detection - test_batch_size:	64
2023-04-05 05:51:38,293 - Detection - wait_patient:	10
2023-04-05 05:51:38,293 - Detection - ============================== End Params ==============================
2023-04-05 05:51:38,293 - Detection - Data and Model Preparation...
2023-04-05 05:51:38,294 - Detection - The number of known intents is 5
2023-04-05 05:51:38,294 - Detection - Lists of known labels are: ['apache', 'svn', 'bash', 'excel', 'oracle']
2023-04-05 05:51:38,324 - Detection - Number of labeled training samples = 3000
2023-04-05 05:51:38,324 - Detection - Number of unlabeled training samples = 9000
2023-04-05 05:51:38,327 - Detection - Number of evaluation samples = 500
2023-04-05 05:51:38,339 - Detection - Number of testing samples = 6000
2023-04-05 05:51:45,856 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-05 05:51:47,525 - Detection - Pre-training Begin...
2023-04-05 05:51:51,288 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 05:51:51,288 - Detection -   best_eval_score = 0
2023-04-05 05:51:51,288 - Detection -   eval_score = 35.6
2023-04-05 05:51:51,288 - Detection -   train_loss = 1.6052324970563252
2023-04-05 05:51:54,546 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 05:51:54,546 - Detection -   best_eval_score = 35.6
2023-04-05 05:51:54,546 - Detection -   eval_score = 68.2
2023-04-05 05:51:54,546 - Detection -   train_loss = 1.5672082702318828
2023-04-05 05:51:57,819 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 05:51:57,819 - Detection -   best_eval_score = 68.2
2023-04-05 05:51:57,819 - Detection -   eval_score = 75.8
2023-04-05 05:51:57,819 - Detection -   train_loss = 1.4649609178304672
2023-04-05 05:52:01,102 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 05:52:01,102 - Detection -   best_eval_score = 75.8
2023-04-05 05:52:01,102 - Detection -   eval_score = 83.0
2023-04-05 05:52:01,102 - Detection -   train_loss = 1.167209694782893
2023-04-05 05:52:04,436 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 05:52:04,436 - Detection -   best_eval_score = 83.0
2023-04-05 05:52:04,436 - Detection -   eval_score = 86.6
2023-04-05 05:52:04,436 - Detection -   train_loss = 0.6688084974884987
2023-04-05 05:52:07,859 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 05:52:07,859 - Detection -   best_eval_score = 86.6
2023-04-05 05:52:07,859 - Detection -   eval_score = 90.8
2023-04-05 05:52:07,859 - Detection -   train_loss = 0.40089409550031024
2023-04-05 05:52:11,329 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 05:52:11,329 - Detection -   best_eval_score = 90.8
2023-04-05 05:52:11,329 - Detection -   eval_score = 91.2
2023-04-05 05:52:11,329 - Detection -   train_loss = 0.3104049364725749
2023-04-05 05:52:14,833 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 05:52:14,833 - Detection -   best_eval_score = 91.2
2023-04-05 05:52:14,833 - Detection -   eval_score = 92.4
2023-04-05 05:52:14,833 - Detection -   train_loss = 0.26238345851500827
2023-04-05 05:52:18,339 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 05:52:18,339 - Detection -   best_eval_score = 92.4
2023-04-05 05:52:18,339 - Detection -   eval_score = 91.6
2023-04-05 05:52:18,339 - Detection -   train_loss = 0.24247125132630268
2023-04-05 05:52:21,826 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 05:52:21,826 - Detection -   best_eval_score = 92.4
2023-04-05 05:52:21,826 - Detection -   eval_score = 92.4
2023-04-05 05:52:21,826 - Detection -   train_loss = 0.22021850446859995
2023-04-05 05:52:25,319 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 05:52:25,319 - Detection -   best_eval_score = 92.4
2023-04-05 05:52:25,319 - Detection -   eval_score = 92.2
2023-04-05 05:52:25,319 - Detection -   train_loss = 0.18646696861833334
2023-04-05 05:52:28,827 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 05:52:28,827 - Detection -   best_eval_score = 92.4
2023-04-05 05:52:28,827 - Detection -   eval_score = 92.8
2023-04-05 05:52:28,827 - Detection -   train_loss = 0.17562278484304747
2023-04-05 05:52:32,377 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 05:52:32,377 - Detection -   best_eval_score = 92.8
2023-04-05 05:52:32,377 - Detection -   eval_score = 92.0
2023-04-05 05:52:32,377 - Detection -   train_loss = 0.15033419399211803
2023-04-05 05:52:35,914 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 05:52:35,914 - Detection -   best_eval_score = 92.8
2023-04-05 05:52:35,914 - Detection -   eval_score = 92.0
2023-04-05 05:52:35,914 - Detection -   train_loss = 0.13988827696690956
2023-04-05 05:52:39,453 - Detection - ***** Epoch: 15: Eval results *****
2023-04-05 05:52:39,453 - Detection -   best_eval_score = 92.8
2023-04-05 05:52:39,453 - Detection -   eval_score = 92.4
2023-04-05 05:52:39,453 - Detection -   train_loss = 0.12107416583846013
2023-04-05 05:52:42,996 - Detection - ***** Epoch: 16: Eval results *****
2023-04-05 05:52:42,996 - Detection -   best_eval_score = 92.8
2023-04-05 05:52:42,996 - Detection -   eval_score = 92.2
2023-04-05 05:52:42,996 - Detection -   train_loss = 0.1255826527873675
2023-04-05 05:52:46,631 - Detection - ***** Epoch: 17: Eval results *****
2023-04-05 05:52:46,631 - Detection -   best_eval_score = 92.8
2023-04-05 05:52:46,631 - Detection -   eval_score = 93.0
2023-04-05 05:52:46,631 - Detection -   train_loss = 0.10628599642465512
2023-04-05 05:52:50,143 - Detection - ***** Epoch: 18: Eval results *****
2023-04-05 05:52:50,143 - Detection -   best_eval_score = 93.0
2023-04-05 05:52:50,143 - Detection -   eval_score = 92.8
2023-04-05 05:52:50,143 - Detection -   train_loss = 0.0969086963062485
2023-04-05 05:52:53,633 - Detection - ***** Epoch: 19: Eval results *****
2023-04-05 05:52:53,633 - Detection -   best_eval_score = 93.0
2023-04-05 05:52:53,633 - Detection -   eval_score = 92.6
2023-04-05 05:52:53,633 - Detection -   train_loss = 0.1000805067208906
2023-04-05 05:52:57,146 - Detection - ***** Epoch: 20: Eval results *****
2023-04-05 05:52:57,146 - Detection -   best_eval_score = 93.0
2023-04-05 05:52:57,146 - Detection -   eval_score = 92.8
2023-04-05 05:52:57,146 - Detection -   train_loss = 0.0858146605702738
2023-04-05 05:53:00,648 - Detection - ***** Epoch: 21: Eval results *****
2023-04-05 05:53:00,649 - Detection -   best_eval_score = 93.0
2023-04-05 05:53:00,649 - Detection -   eval_score = 92.8
2023-04-05 05:53:00,649 - Detection -   train_loss = 0.07989071720900635
2023-04-05 05:53:04,143 - Detection - ***** Epoch: 22: Eval results *****
2023-04-05 05:53:04,144 - Detection -   best_eval_score = 93.0
2023-04-05 05:53:04,144 - Detection -   eval_score = 92.6
2023-04-05 05:53:04,144 - Detection -   train_loss = 0.0749808931723237
2023-04-05 05:53:07,633 - Detection - ***** Epoch: 23: Eval results *****
2023-04-05 05:53:07,633 - Detection -   best_eval_score = 93.0
2023-04-05 05:53:07,633 - Detection -   eval_score = 92.6
2023-04-05 05:53:07,633 - Detection -   train_loss = 0.06591943480695288
2023-04-05 05:53:11,124 - Detection - ***** Epoch: 24: Eval results *****
2023-04-05 05:53:11,124 - Detection -   best_eval_score = 93.0
2023-04-05 05:53:11,124 - Detection -   eval_score = 92.2
2023-04-05 05:53:11,124 - Detection -   train_loss = 0.06269930458317201
2023-04-05 05:53:14,615 - Detection - ***** Epoch: 25: Eval results *****
2023-04-05 05:53:14,615 - Detection -   best_eval_score = 93.0
2023-04-05 05:53:14,615 - Detection -   eval_score = 93.0
2023-04-05 05:53:14,615 - Detection -   train_loss = 0.06120481124768654
2023-04-05 05:53:18,108 - Detection - ***** Epoch: 26: Eval results *****
2023-04-05 05:53:18,108 - Detection -   best_eval_score = 93.0
2023-04-05 05:53:18,108 - Detection -   eval_score = 91.8
2023-04-05 05:53:18,108 - Detection -   train_loss = 0.051658714190125465
2023-04-05 05:53:21,607 - Detection - ***** Epoch: 27: Eval results *****
2023-04-05 05:53:21,607 - Detection -   best_eval_score = 93.0
2023-04-05 05:53:21,607 - Detection -   eval_score = 92.2
2023-04-05 05:53:21,607 - Detection -   train_loss = 0.05051635873193542
2023-04-05 05:53:21,607 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_0.25_1.0_bert_7/models
2023-04-05 05:53:22,151 - Detection - Pre-training finished...
2023-04-05 05:53:22,151 - Detection - Training Begin...
2023-04-05 05:53:28,267 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 05:53:28,267 - Detection -   best_eval_score = 0
2023-04-05 05:53:28,267 - Detection -   eval_score = 9.8
2023-04-05 05:53:28,267 - Detection -   train_loss = 5.982252816359202
2023-04-05 05:53:31,720 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 05:53:31,720 - Detection -   best_eval_score = 9.8
2023-04-05 05:53:31,720 - Detection -   eval_score = 46.0
2023-04-05 05:53:31,720 - Detection -   train_loss = 4.936330119768779
2023-04-05 05:53:35,170 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 05:53:35,170 - Detection -   best_eval_score = 46.0
2023-04-05 05:53:35,170 - Detection -   eval_score = 61.1
2023-04-05 05:53:35,170 - Detection -   train_loss = 3.7167409161726632
2023-04-05 05:53:38,613 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 05:53:38,613 - Detection -   best_eval_score = 61.1
2023-04-05 05:53:38,614 - Detection -   eval_score = 74.15
2023-04-05 05:53:38,614 - Detection -   train_loss = 2.558873991171519
2023-04-05 05:53:42,058 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 05:53:42,058 - Detection -   best_eval_score = 74.15
2023-04-05 05:53:42,058 - Detection -   eval_score = 75.75
2023-04-05 05:53:42,058 - Detection -   train_loss = 1.683133289217949
2023-04-05 05:53:45,498 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 05:53:45,499 - Detection -   best_eval_score = 75.75
2023-04-05 05:53:45,499 - Detection -   eval_score = 75.96
2023-04-05 05:53:45,499 - Detection -   train_loss = 1.3135838856299717
2023-04-05 05:53:48,945 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 05:53:48,945 - Detection -   best_eval_score = 75.96
2023-04-05 05:53:48,945 - Detection -   eval_score = 75.87
2023-04-05 05:53:48,945 - Detection -   train_loss = 1.2732805609703064
2023-04-05 05:53:52,387 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 05:53:52,387 - Detection -   best_eval_score = 75.96
2023-04-05 05:53:52,387 - Detection -   eval_score = 75.87
2023-04-05 05:53:52,387 - Detection -   train_loss = 1.2943431933720906
2023-04-05 05:53:55,835 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 05:53:55,835 - Detection -   best_eval_score = 75.96
2023-04-05 05:53:55,835 - Detection -   eval_score = 75.97
2023-04-05 05:53:55,835 - Detection -   train_loss = 1.2798651133974392
2023-04-05 05:53:59,283 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 05:53:59,283 - Detection -   best_eval_score = 75.97
2023-04-05 05:53:59,283 - Detection -   eval_score = 75.87
2023-04-05 05:53:59,283 - Detection -   train_loss = 1.2499158754944801
2023-04-05 05:54:02,735 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 05:54:02,735 - Detection -   best_eval_score = 75.97
2023-04-05 05:54:02,736 - Detection -   eval_score = 75.76
2023-04-05 05:54:02,736 - Detection -   train_loss = 1.3228754475712776
2023-04-05 05:54:06,176 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 05:54:06,176 - Detection -   best_eval_score = 75.97
2023-04-05 05:54:06,176 - Detection -   eval_score = 75.86
2023-04-05 05:54:06,176 - Detection -   train_loss = 1.2764062235752742
2023-04-05 05:54:09,618 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 05:54:09,619 - Detection -   best_eval_score = 75.97
2023-04-05 05:54:09,619 - Detection -   eval_score = 75.86
2023-04-05 05:54:09,619 - Detection -   train_loss = 1.2864838888247807
2023-04-05 05:54:13,060 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 05:54:13,060 - Detection -   best_eval_score = 75.97
2023-04-05 05:54:13,060 - Detection -   eval_score = 75.86
2023-04-05 05:54:13,060 - Detection -   train_loss = 1.2704067379236221
2023-04-05 05:54:16,500 - Detection - ***** Epoch: 15: Eval results *****
2023-04-05 05:54:16,500 - Detection -   best_eval_score = 75.97
2023-04-05 05:54:16,500 - Detection -   eval_score = 75.86
2023-04-05 05:54:16,500 - Detection -   train_loss = 1.2918468763430913
2023-04-05 05:54:19,947 - Detection - ***** Epoch: 16: Eval results *****
2023-04-05 05:54:19,947 - Detection -   best_eval_score = 75.97
2023-04-05 05:54:19,947 - Detection -   eval_score = 75.86
2023-04-05 05:54:19,947 - Detection -   train_loss = 1.256863425175349
2023-04-05 05:54:23,388 - Detection - ***** Epoch: 17: Eval results *****
2023-04-05 05:54:23,388 - Detection -   best_eval_score = 75.97
2023-04-05 05:54:23,388 - Detection -   eval_score = 75.86
2023-04-05 05:54:23,388 - Detection -   train_loss = 1.2999768604834874
2023-04-05 05:54:26,828 - Detection - ***** Epoch: 18: Eval results *****
2023-04-05 05:54:26,829 - Detection -   best_eval_score = 75.97
2023-04-05 05:54:26,829 - Detection -   eval_score = 75.86
2023-04-05 05:54:26,829 - Detection -   train_loss = 1.255909229318301
2023-04-05 05:54:30,280 - Detection - ***** Epoch: 19: Eval results *****
2023-04-05 05:54:30,280 - Detection -   best_eval_score = 75.97
2023-04-05 05:54:30,280 - Detection -   eval_score = 75.86
2023-04-05 05:54:30,280 - Detection -   train_loss = 1.2861620684464772
2023-04-05 05:54:30,281 - Detection - Training Finished...
2023-04-05 05:54:30,281 - Detection - Testing begin...
2023-04-05 05:54:35,663 - Detection - ***** Test: Confusion Matrix *****
2023-04-05 05:54:35,663 - Detection - [[ 227    1    1    1    0   70]
 [   1  254    0    0    0   45]
 [   3    0  225    0    0   72]
 [   0    0    0  246    0   54]
 [   0    0    1    1  247   51]
 [ 188   28   82   79  104 4019]]
2023-04-05 05:54:35,663 - Detection - ***** Test results *****
2023-04-05 05:54:35,663 - Detection -   Acc = 86.97
2023-04-05 05:54:35,663 - Detection -   F1 = 78.2916
2023-04-05 05:54:35,663 - Detection -   F1-known = 75.7045
2023-04-05 05:54:35,663 - Detection -   F1-open = 91.2269
2023-04-05 05:54:35,663 - Detection - Testing finished...
2023-04-05 05:54:35,663 - Detection - Results saved in results/results_ADB.csv
2023-04-05 05:54:35,682 - Detection - Open Intent Detection Finished...
