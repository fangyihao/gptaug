2023-04-20 14:25:10,830 - Detection - Open Intent Detection Begin...
2023-04-20 14:25:10,830 - Detection - Parameters Initialization...
2023-04-20 14:25:10,830 - Detection - ============================== Params ==============================
2023-04-20 14:25:10,830 - Detection - type:	open_intent_detection
2023-04-20 14:25:10,830 - Detection - logger_name:	Detection
2023-04-20 14:25:10,830 - Detection - log_dir:	logs
2023-04-20 14:25:10,830 - Detection - dataset:	banking_cg
2023-04-20 14:25:10,830 - Detection - known_cls_ratio:	0.5
2023-04-20 14:25:10,830 - Detection - labeled_ratio:	1.0
2023-04-20 14:25:10,831 - Detection - method:	ADB
2023-04-20 14:25:10,831 - Detection - train:	True
2023-04-20 14:25:10,831 - Detection - pretrain:	True
2023-04-20 14:25:10,831 - Detection - save_model:	True
2023-04-20 14:25:10,831 - Detection - backbone:	bert
2023-04-20 14:25:10,831 - Detection - config_file_name:	ADB
2023-04-20 14:25:10,831 - Detection - seed:	6
2023-04-20 14:25:10,831 - Detection - gpu_id:	0
2023-04-20 14:25:10,831 - Detection - pipe_results_path:	pipe_results
2023-04-20 14:25:10,831 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-20 14:25:10,831 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-20 14:25:10,831 - Detection - model_dir:	models
2023-04-20 14:25:10,831 - Detection - load_pretrained_method:	None
2023-04-20 14:25:10,831 - Detection - result_dir:	results
2023-04-20 14:25:10,831 - Detection - results_file_name:	results_ADB.csv
2023-04-20 14:25:10,831 - Detection - save_results:	True
2023-04-20 14:25:10,831 - Detection - loss_fct:	CrossEntropyLoss
2023-04-20 14:25:10,831 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.5_1.0_bert_6
2023-04-20 14:25:10,831 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.5_1.0_bert_6/models
2023-04-20 14:25:10,831 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-20 14:25:10,831 - Detection - num_train_epochs:	100
2023-04-20 14:25:10,831 - Detection - num_labels:	None
2023-04-20 14:25:10,831 - Detection - max_seq_length:	None
2023-04-20 14:25:10,831 - Detection - freeze_backbone_parameters:	True
2023-04-20 14:25:10,831 - Detection - feat_dim:	768
2023-04-20 14:25:10,831 - Detection - warmup_proportion:	0.1
2023-04-20 14:25:10,831 - Detection - lr_boundary:	0.05
2023-04-20 14:25:10,831 - Detection - lr:	2e-05
2023-04-20 14:25:10,831 - Detection - activation:	relu
2023-04-20 14:25:10,831 - Detection - train_batch_size:	128
2023-04-20 14:25:10,831 - Detection - eval_batch_size:	64
2023-04-20 14:25:10,831 - Detection - test_batch_size:	64
2023-04-20 14:25:10,831 - Detection - wait_patient:	10
2023-04-20 14:25:10,831 - Detection - ============================== End Params ==============================
2023-04-20 14:25:10,831 - Detection - Data and Model Preparation...
2023-04-20 14:25:10,832 - Detection - The number of known intents is 38
2023-04-20 14:25:10,832 - Detection - Lists of known labels are: ['direct_debit_payment_not_recognised', 'exchange_via_app', 'compromised_card', 'top_up_by_cash_or_cheque', 'top_up_by_bank_transfer_charge', 'transfer_not_received_by_recipient', 'pending_cash_withdrawal', 'card_payment_not_recognised', 'Refund_not_showing_up', 'top_up_failed', 'get_disposable_virtual_card', 'pending_card_payment', 'getting_spare_card', 'card_delivery_estimate', 'get_physical_card', 'transfer_fee_charged', 'cash_withdrawal_charge', 'card_arrival', 'exchange_charge', 'transfer_timing', 'receiving_money', 'balance_not_updated_after_cheque_or_cash_deposit', 'disposable_card_limits', 'failed_transfer', 'request_refund', 'contactless_not_working', 'order_physical_card', 'declined_cash_withdrawal', 'cancel_transfer', 'verify_top_up', 'extra_charge_on_statement', 'card_payment_wrong_exchange_rate', 'virtual_card_not_working', 'card_acceptance', 'passcode_forgotten', 'apple_pay_or_google_pay', 'wrong_exchange_rate_for_cash_withdrawal', 'getting_virtual_card']
2023-04-20 14:25:10,843 - Detection - Number of labeled training samples = 1413
2023-04-20 14:25:10,843 - Detection - Number of unlabeled training samples = 1360
2023-04-20 14:25:10,845 - Detection - Number of evaluation samples = 405
2023-04-20 14:25:10,850 - Detection - Number of testing samples = 1896
2023-04-20 14:25:14,912 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-20 14:25:16,565 - Detection - Pre-training Begin...
2023-04-20 14:25:19,130 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 14:25:19,130 - Detection -   best_eval_score = 0
2023-04-20 14:25:19,130 - Detection -   eval_score = 3.7
2023-04-20 14:25:19,130 - Detection -   train_loss = 3.637830456097921
2023-04-20 14:25:21,212 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 14:25:21,212 - Detection -   best_eval_score = 3.7
2023-04-20 14:25:21,212 - Detection -   eval_score = 3.95
2023-04-20 14:25:21,212 - Detection -   train_loss = 3.624226232369741
2023-04-20 14:25:23,306 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 14:25:23,306 - Detection -   best_eval_score = 3.95
2023-04-20 14:25:23,306 - Detection -   eval_score = 4.69
2023-04-20 14:25:23,306 - Detection -   train_loss = 3.5925256808598838
2023-04-20 14:25:25,398 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 14:25:25,398 - Detection -   best_eval_score = 4.69
2023-04-20 14:25:25,398 - Detection -   eval_score = 4.94
2023-04-20 14:25:25,398 - Detection -   train_loss = 3.545533835887909
2023-04-20 14:25:27,488 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 14:25:27,488 - Detection -   best_eval_score = 4.94
2023-04-20 14:25:27,488 - Detection -   eval_score = 7.16
2023-04-20 14:25:27,488 - Detection -   train_loss = 3.486987312634786
2023-04-20 14:25:29,582 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 14:25:29,582 - Detection -   best_eval_score = 7.16
2023-04-20 14:25:29,582 - Detection -   eval_score = 8.89
2023-04-20 14:25:29,583 - Detection -   train_loss = 3.376473923524221
2023-04-20 14:25:31,685 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 14:25:31,685 - Detection -   best_eval_score = 8.89
2023-04-20 14:25:31,685 - Detection -   eval_score = 13.09
2023-04-20 14:25:31,685 - Detection -   train_loss = 3.2518945137659707
2023-04-20 14:25:33,802 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 14:25:33,802 - Detection -   best_eval_score = 13.09
2023-04-20 14:25:33,802 - Detection -   eval_score = 21.98
2023-04-20 14:25:33,802 - Detection -   train_loss = 3.0355548659960427
2023-04-20 14:25:35,941 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 14:25:35,941 - Detection -   best_eval_score = 21.98
2023-04-20 14:25:35,941 - Detection -   eval_score = 27.16
2023-04-20 14:25:35,941 - Detection -   train_loss = 2.7478405634562173
2023-04-20 14:25:38,100 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 14:25:38,100 - Detection -   best_eval_score = 27.16
2023-04-20 14:25:38,100 - Detection -   eval_score = 36.3
2023-04-20 14:25:38,100 - Detection -   train_loss = 2.4037646452585855
2023-04-20 14:25:40,279 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 14:25:40,279 - Detection -   best_eval_score = 36.3
2023-04-20 14:25:40,279 - Detection -   eval_score = 41.48
2023-04-20 14:25:40,279 - Detection -   train_loss = 2.022767851750056
2023-04-20 14:25:42,470 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 14:25:42,470 - Detection -   best_eval_score = 41.48
2023-04-20 14:25:42,470 - Detection -   eval_score = 46.42
2023-04-20 14:25:42,470 - Detection -   train_loss = 1.8302099009354909
2023-04-20 14:25:44,674 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 14:25:44,674 - Detection -   best_eval_score = 46.42
2023-04-20 14:25:44,674 - Detection -   eval_score = 50.62
2023-04-20 14:25:44,674 - Detection -   train_loss = 1.6604984800020854
2023-04-20 14:25:46,984 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 14:25:46,984 - Detection -   best_eval_score = 50.62
2023-04-20 14:25:46,984 - Detection -   eval_score = 52.59
2023-04-20 14:25:46,984 - Detection -   train_loss = 1.4126951396465302
2023-04-20 14:25:49,203 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 14:25:49,203 - Detection -   best_eval_score = 52.59
2023-04-20 14:25:49,203 - Detection -   eval_score = 56.79
2023-04-20 14:25:49,203 - Detection -   train_loss = 1.2764523526032765
2023-04-20 14:25:51,433 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 14:25:51,433 - Detection -   best_eval_score = 56.79
2023-04-20 14:25:51,433 - Detection -   eval_score = 60.49
2023-04-20 14:25:51,433 - Detection -   train_loss = 1.1657378673553467
2023-04-20 14:25:53,670 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 14:25:53,670 - Detection -   best_eval_score = 60.49
2023-04-20 14:25:53,670 - Detection -   eval_score = 60.25
2023-04-20 14:25:53,670 - Detection -   train_loss = 1.0322388410568237
2023-04-20 14:25:55,894 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 14:25:55,894 - Detection -   best_eval_score = 60.49
2023-04-20 14:25:55,894 - Detection -   eval_score = 60.99
2023-04-20 14:25:55,894 - Detection -   train_loss = 0.9450953801472982
2023-04-20 14:25:58,143 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 14:25:58,144 - Detection -   best_eval_score = 60.99
2023-04-20 14:25:58,144 - Detection -   eval_score = 64.2
2023-04-20 14:25:58,144 - Detection -   train_loss = 0.8976136445999146
2023-04-20 14:26:00,393 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 14:26:00,393 - Detection -   best_eval_score = 64.2
2023-04-20 14:26:00,393 - Detection -   eval_score = 63.7
2023-04-20 14:26:00,393 - Detection -   train_loss = 0.7940130705634753
2023-04-20 14:26:02,625 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 14:26:02,625 - Detection -   best_eval_score = 64.2
2023-04-20 14:26:02,625 - Detection -   eval_score = 64.94
2023-04-20 14:26:02,625 - Detection -   train_loss = 0.7519924094279608
2023-04-20 14:26:04,872 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 14:26:04,872 - Detection -   best_eval_score = 64.94
2023-04-20 14:26:04,872 - Detection -   eval_score = 65.19
2023-04-20 14:26:04,872 - Detection -   train_loss = 0.7397670149803162
2023-04-20 14:26:07,109 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 14:26:07,110 - Detection -   best_eval_score = 65.19
2023-04-20 14:26:07,110 - Detection -   eval_score = 66.67
2023-04-20 14:26:07,110 - Detection -   train_loss = 0.6565956075986227
2023-04-20 14:26:09,352 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 14:26:09,352 - Detection -   best_eval_score = 66.67
2023-04-20 14:26:09,352 - Detection -   eval_score = 68.15
2023-04-20 14:26:09,352 - Detection -   train_loss = 0.6805759320656458
2023-04-20 14:26:11,597 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 14:26:11,597 - Detection -   best_eval_score = 68.15
2023-04-20 14:26:11,597 - Detection -   eval_score = 68.15
2023-04-20 14:26:11,597 - Detection -   train_loss = 0.642399862408638
2023-04-20 14:26:13,827 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 14:26:13,828 - Detection -   best_eval_score = 68.15
2023-04-20 14:26:13,828 - Detection -   eval_score = 69.88
2023-04-20 14:26:13,828 - Detection -   train_loss = 0.5860563740134239
2023-04-20 14:26:16,063 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 14:26:16,063 - Detection -   best_eval_score = 69.88
2023-04-20 14:26:16,063 - Detection -   eval_score = 70.86
2023-04-20 14:26:16,063 - Detection -   train_loss = 0.57388969262441
2023-04-20 14:26:18,307 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 14:26:18,307 - Detection -   best_eval_score = 70.86
2023-04-20 14:26:18,307 - Detection -   eval_score = 68.89
2023-04-20 14:26:18,307 - Detection -   train_loss = 0.5304656500617663
2023-04-20 14:26:20,531 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 14:26:20,531 - Detection -   best_eval_score = 70.86
2023-04-20 14:26:20,531 - Detection -   eval_score = 70.86
2023-04-20 14:26:20,531 - Detection -   train_loss = 0.5562231863538424
2023-04-20 14:26:22,767 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 14:26:22,767 - Detection -   best_eval_score = 70.86
2023-04-20 14:26:22,767 - Detection -   eval_score = 71.85
2023-04-20 14:26:22,767 - Detection -   train_loss = 0.5076543117562929
2023-04-20 14:26:25,015 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 14:26:25,015 - Detection -   best_eval_score = 71.85
2023-04-20 14:26:25,015 - Detection -   eval_score = 72.35
2023-04-20 14:26:25,015 - Detection -   train_loss = 0.47898509601751965
2023-04-20 14:26:27,258 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 14:26:27,258 - Detection -   best_eval_score = 72.35
2023-04-20 14:26:27,258 - Detection -   eval_score = 72.59
2023-04-20 14:26:27,258 - Detection -   train_loss = 0.4678202271461487
2023-04-20 14:26:29,496 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 14:26:29,496 - Detection -   best_eval_score = 72.59
2023-04-20 14:26:29,496 - Detection -   eval_score = 72.84
2023-04-20 14:26:29,496 - Detection -   train_loss = 0.48046568781137466
2023-04-20 14:26:31,736 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 14:26:31,736 - Detection -   best_eval_score = 72.84
2023-04-20 14:26:31,736 - Detection -   eval_score = 73.09
2023-04-20 14:26:31,736 - Detection -   train_loss = 0.4332516739765803
2023-04-20 14:26:33,970 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 14:26:33,970 - Detection -   best_eval_score = 73.09
2023-04-20 14:26:33,970 - Detection -   eval_score = 72.59
2023-04-20 14:26:33,970 - Detection -   train_loss = 0.4418487399816513
2023-04-20 14:26:36,197 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 14:26:36,197 - Detection -   best_eval_score = 73.09
2023-04-20 14:26:36,197 - Detection -   eval_score = 72.59
2023-04-20 14:26:36,197 - Detection -   train_loss = 0.4477302481730779
2023-04-20 14:26:38,429 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 14:26:38,429 - Detection -   best_eval_score = 73.09
2023-04-20 14:26:38,429 - Detection -   eval_score = 74.07
2023-04-20 14:26:38,429 - Detection -   train_loss = 0.36412248263756436
2023-04-20 14:26:40,676 - Detection - ***** Epoch: 38: Eval results *****
2023-04-20 14:26:40,676 - Detection -   best_eval_score = 74.07
2023-04-20 14:26:40,676 - Detection -   eval_score = 73.33
2023-04-20 14:26:40,676 - Detection -   train_loss = 0.4195464452107747
2023-04-20 14:26:42,909 - Detection - ***** Epoch: 39: Eval results *****
2023-04-20 14:26:42,909 - Detection -   best_eval_score = 74.07
2023-04-20 14:26:42,909 - Detection -   eval_score = 73.83
2023-04-20 14:26:42,909 - Detection -   train_loss = 0.36818525443474454
2023-04-20 14:26:45,145 - Detection - ***** Epoch: 40: Eval results *****
2023-04-20 14:26:45,146 - Detection -   best_eval_score = 74.07
2023-04-20 14:26:45,146 - Detection -   eval_score = 74.32
2023-04-20 14:26:45,146 - Detection -   train_loss = 0.3469259664416313
2023-04-20 14:26:47,388 - Detection - ***** Epoch: 41: Eval results *****
2023-04-20 14:26:47,388 - Detection -   best_eval_score = 74.32
2023-04-20 14:26:47,388 - Detection -   eval_score = 74.57
2023-04-20 14:26:47,388 - Detection -   train_loss = 0.3453959599137306
2023-04-20 14:26:49,623 - Detection - ***** Epoch: 42: Eval results *****
2023-04-20 14:26:49,623 - Detection -   best_eval_score = 74.57
2023-04-20 14:26:49,623 - Detection -   eval_score = 75.06
2023-04-20 14:26:49,623 - Detection -   train_loss = 0.32301488891243935
2023-04-20 14:26:51,869 - Detection - ***** Epoch: 43: Eval results *****
2023-04-20 14:26:51,869 - Detection -   best_eval_score = 75.06
2023-04-20 14:26:51,869 - Detection -   eval_score = 74.32
2023-04-20 14:26:51,869 - Detection -   train_loss = 0.33325393746296567
2023-04-20 14:26:54,097 - Detection - ***** Epoch: 44: Eval results *****
2023-04-20 14:26:54,097 - Detection -   best_eval_score = 75.06
2023-04-20 14:26:54,097 - Detection -   eval_score = 74.07
2023-04-20 14:26:54,097 - Detection -   train_loss = 0.3235974833369255
2023-04-20 14:26:56,327 - Detection - ***** Epoch: 45: Eval results *****
2023-04-20 14:26:56,328 - Detection -   best_eval_score = 75.06
2023-04-20 14:26:56,328 - Detection -   eval_score = 74.07
2023-04-20 14:26:56,328 - Detection -   train_loss = 0.3083362778027852
2023-04-20 14:26:58,565 - Detection - ***** Epoch: 46: Eval results *****
2023-04-20 14:26:58,565 - Detection -   best_eval_score = 75.06
2023-04-20 14:26:58,565 - Detection -   eval_score = 74.81
2023-04-20 14:26:58,565 - Detection -   train_loss = 0.289215420683225
2023-04-20 14:27:00,800 - Detection - ***** Epoch: 47: Eval results *****
2023-04-20 14:27:00,800 - Detection -   best_eval_score = 75.06
2023-04-20 14:27:00,800 - Detection -   eval_score = 74.81
2023-04-20 14:27:00,800 - Detection -   train_loss = 0.3289824140568574
2023-04-20 14:27:03,025 - Detection - ***** Epoch: 48: Eval results *****
2023-04-20 14:27:03,025 - Detection -   best_eval_score = 75.06
2023-04-20 14:27:03,025 - Detection -   eval_score = 75.56
2023-04-20 14:27:03,025 - Detection -   train_loss = 0.3198392217357953
2023-04-20 14:27:05,263 - Detection - ***** Epoch: 49: Eval results *****
2023-04-20 14:27:05,263 - Detection -   best_eval_score = 75.56
2023-04-20 14:27:05,263 - Detection -   eval_score = 75.31
2023-04-20 14:27:05,263 - Detection -   train_loss = 0.2749893019596736
2023-04-20 14:27:07,583 - Detection - ***** Epoch: 50: Eval results *****
2023-04-20 14:27:07,583 - Detection -   best_eval_score = 75.56
2023-04-20 14:27:07,583 - Detection -   eval_score = 75.31
2023-04-20 14:27:07,583 - Detection -   train_loss = 0.269877798234423
2023-04-20 14:27:09,815 - Detection - ***** Epoch: 51: Eval results *****
2023-04-20 14:27:09,815 - Detection -   best_eval_score = 75.56
2023-04-20 14:27:09,815 - Detection -   eval_score = 75.56
2023-04-20 14:27:09,815 - Detection -   train_loss = 0.26942385360598564
2023-04-20 14:27:12,047 - Detection - ***** Epoch: 52: Eval results *****
2023-04-20 14:27:12,047 - Detection -   best_eval_score = 75.56
2023-04-20 14:27:12,047 - Detection -   eval_score = 75.56
2023-04-20 14:27:12,047 - Detection -   train_loss = 0.2676982991397381
2023-04-20 14:27:14,278 - Detection - ***** Epoch: 53: Eval results *****
2023-04-20 14:27:14,278 - Detection -   best_eval_score = 75.56
2023-04-20 14:27:14,278 - Detection -   eval_score = 75.06
2023-04-20 14:27:14,278 - Detection -   train_loss = 0.27432003368933994
2023-04-20 14:27:16,503 - Detection - ***** Epoch: 54: Eval results *****
2023-04-20 14:27:16,503 - Detection -   best_eval_score = 75.56
2023-04-20 14:27:16,503 - Detection -   eval_score = 76.05
2023-04-20 14:27:16,503 - Detection -   train_loss = 0.25015120456616086
2023-04-20 14:27:18,743 - Detection - ***** Epoch: 55: Eval results *****
2023-04-20 14:27:18,743 - Detection -   best_eval_score = 76.05
2023-04-20 14:27:18,743 - Detection -   eval_score = 75.06
2023-04-20 14:27:18,743 - Detection -   train_loss = 0.29881639530261356
2023-04-20 14:27:20,965 - Detection - ***** Epoch: 56: Eval results *****
2023-04-20 14:27:20,965 - Detection -   best_eval_score = 76.05
2023-04-20 14:27:20,965 - Detection -   eval_score = 74.81
2023-04-20 14:27:20,965 - Detection -   train_loss = 0.24796916668613753
2023-04-20 14:27:23,186 - Detection - ***** Epoch: 57: Eval results *****
2023-04-20 14:27:23,186 - Detection -   best_eval_score = 76.05
2023-04-20 14:27:23,186 - Detection -   eval_score = 75.31
2023-04-20 14:27:23,186 - Detection -   train_loss = 0.2420139660437902
2023-04-20 14:27:25,406 - Detection - ***** Epoch: 58: Eval results *****
2023-04-20 14:27:25,406 - Detection -   best_eval_score = 76.05
2023-04-20 14:27:25,406 - Detection -   eval_score = 75.8
2023-04-20 14:27:25,407 - Detection -   train_loss = 0.2703392542898655
2023-04-20 14:27:27,621 - Detection - ***** Epoch: 59: Eval results *****
2023-04-20 14:27:27,621 - Detection -   best_eval_score = 76.05
2023-04-20 14:27:27,621 - Detection -   eval_score = 74.57
2023-04-20 14:27:27,621 - Detection -   train_loss = 0.25555145492156345
2023-04-20 14:27:29,844 - Detection - ***** Epoch: 60: Eval results *****
2023-04-20 14:27:29,844 - Detection -   best_eval_score = 76.05
2023-04-20 14:27:29,844 - Detection -   eval_score = 75.8
2023-04-20 14:27:29,844 - Detection -   train_loss = 0.2615434800585111
2023-04-20 14:27:32,068 - Detection - ***** Epoch: 61: Eval results *****
2023-04-20 14:27:32,068 - Detection -   best_eval_score = 76.05
2023-04-20 14:27:32,068 - Detection -   eval_score = 75.8
2023-04-20 14:27:32,068 - Detection -   train_loss = 0.2348509207367897
2023-04-20 14:27:34,283 - Detection - ***** Epoch: 62: Eval results *****
2023-04-20 14:27:34,284 - Detection -   best_eval_score = 76.05
2023-04-20 14:27:34,284 - Detection -   eval_score = 74.81
2023-04-20 14:27:34,284 - Detection -   train_loss = 0.2343074989815553
2023-04-20 14:27:36,495 - Detection - ***** Epoch: 63: Eval results *****
2023-04-20 14:27:36,495 - Detection -   best_eval_score = 76.05
2023-04-20 14:27:36,495 - Detection -   eval_score = 74.81
2023-04-20 14:27:36,495 - Detection -   train_loss = 0.22458665197094282
2023-04-20 14:27:38,714 - Detection - ***** Epoch: 64: Eval results *****
2023-04-20 14:27:38,714 - Detection -   best_eval_score = 76.05
2023-04-20 14:27:38,714 - Detection -   eval_score = 74.57
2023-04-20 14:27:38,714 - Detection -   train_loss = 0.23430132493376732
2023-04-20 14:27:38,715 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.5_1.0_bert_6/models
2023-04-20 14:27:39,260 - Detection - Pre-training finished...
2023-04-20 14:27:39,260 - Detection - Training Begin...
2023-04-20 14:27:42,950 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 14:27:42,950 - Detection -   best_eval_score = 0
2023-04-20 14:27:42,950 - Detection -   eval_score = 0.0
2023-04-20 14:27:42,950 - Detection -   train_loss = 11.126033862431845
2023-04-20 14:27:45,143 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 14:27:45,143 - Detection -   best_eval_score = 0
2023-04-20 14:27:45,143 - Detection -   eval_score = 0.0
2023-04-20 14:27:45,143 - Detection -   train_loss = 10.693036635716757
2023-04-20 14:27:47,335 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 14:27:47,335 - Detection -   best_eval_score = 0
2023-04-20 14:27:47,335 - Detection -   eval_score = 0.0
2023-04-20 14:27:47,335 - Detection -   train_loss = 10.499398708343506
2023-04-20 14:27:49,525 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 14:27:49,525 - Detection -   best_eval_score = 0
2023-04-20 14:27:49,525 - Detection -   eval_score = 0.0
2023-04-20 14:27:49,525 - Detection -   train_loss = 10.012724081675211
2023-04-20 14:27:51,727 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 14:27:51,728 - Detection -   best_eval_score = 0
2023-04-20 14:27:51,728 - Detection -   eval_score = 0.0
2023-04-20 14:27:51,728 - Detection -   train_loss = 9.447969118754068
2023-04-20 14:27:53,920 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 14:27:53,920 - Detection -   best_eval_score = 0
2023-04-20 14:27:53,920 - Detection -   eval_score = 0.0
2023-04-20 14:27:53,920 - Detection -   train_loss = 9.064937353134155
2023-04-20 14:27:56,120 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 14:27:56,120 - Detection -   best_eval_score = 0
2023-04-20 14:27:56,120 - Detection -   eval_score = 0.37
2023-04-20 14:27:56,120 - Detection -   train_loss = 8.609689791997274
2023-04-20 14:27:58,315 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 14:27:58,315 - Detection -   best_eval_score = 0.37
2023-04-20 14:27:58,315 - Detection -   eval_score = 2.05
2023-04-20 14:27:58,315 - Detection -   train_loss = 7.924960454305013
2023-04-20 14:28:00,511 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 14:28:00,512 - Detection -   best_eval_score = 2.05
2023-04-20 14:28:00,512 - Detection -   eval_score = 2.9
2023-04-20 14:28:00,512 - Detection -   train_loss = 7.435339570045471
2023-04-20 14:28:02,708 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 14:28:02,708 - Detection -   best_eval_score = 2.9
2023-04-20 14:28:02,708 - Detection -   eval_score = 5.6
2023-04-20 14:28:02,708 - Detection -   train_loss = 6.940258105595906
2023-04-20 14:28:04,908 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 14:28:04,909 - Detection -   best_eval_score = 5.6
2023-04-20 14:28:04,909 - Detection -   eval_score = 9.03
2023-04-20 14:28:04,909 - Detection -   train_loss = 6.401859283447266
2023-04-20 14:28:07,107 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 14:28:07,107 - Detection -   best_eval_score = 9.03
2023-04-20 14:28:07,107 - Detection -   eval_score = 13.51
2023-04-20 14:28:07,107 - Detection -   train_loss = 5.8907848199208575
2023-04-20 14:28:09,304 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 14:28:09,304 - Detection -   best_eval_score = 13.51
2023-04-20 14:28:09,304 - Detection -   eval_score = 18.75
2023-04-20 14:28:09,304 - Detection -   train_loss = 5.471887509028117
2023-04-20 14:28:11,505 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 14:28:11,505 - Detection -   best_eval_score = 18.75
2023-04-20 14:28:11,505 - Detection -   eval_score = 22.84
2023-04-20 14:28:11,505 - Detection -   train_loss = 4.753506064414978
2023-04-20 14:28:13,699 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 14:28:13,699 - Detection -   best_eval_score = 22.84
2023-04-20 14:28:13,699 - Detection -   eval_score = 29.67
2023-04-20 14:28:13,699 - Detection -   train_loss = 4.2215651869773865
2023-04-20 14:28:15,894 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 14:28:15,894 - Detection -   best_eval_score = 29.67
2023-04-20 14:28:15,894 - Detection -   eval_score = 36.91
2023-04-20 14:28:15,894 - Detection -   train_loss = 3.7374951243400574
2023-04-20 14:28:18,094 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 14:28:18,095 - Detection -   best_eval_score = 36.91
2023-04-20 14:28:18,095 - Detection -   eval_score = 41.66
2023-04-20 14:28:18,095 - Detection -   train_loss = 3.3370656172434487
2023-04-20 14:28:20,296 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 14:28:20,296 - Detection -   best_eval_score = 41.66
2023-04-20 14:28:20,296 - Detection -   eval_score = 46.66
2023-04-20 14:28:20,296 - Detection -   train_loss = 2.8247405886650085
2023-04-20 14:28:22,486 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 14:28:22,486 - Detection -   best_eval_score = 46.66
2023-04-20 14:28:22,486 - Detection -   eval_score = 51.06
2023-04-20 14:28:22,486 - Detection -   train_loss = 2.545602103074392
2023-04-20 14:28:24,687 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 14:28:24,687 - Detection -   best_eval_score = 51.06
2023-04-20 14:28:24,687 - Detection -   eval_score = 53.01
2023-04-20 14:28:24,687 - Detection -   train_loss = 2.167522599299749
2023-04-20 14:28:26,892 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 14:28:26,892 - Detection -   best_eval_score = 53.01
2023-04-20 14:28:26,892 - Detection -   eval_score = 55.53
2023-04-20 14:28:26,892 - Detection -   train_loss = 1.826697215437889
2023-04-20 14:28:29,089 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 14:28:29,089 - Detection -   best_eval_score = 55.53
2023-04-20 14:28:29,090 - Detection -   eval_score = 58.68
2023-04-20 14:28:29,090 - Detection -   train_loss = 1.7221636474132538
2023-04-20 14:28:31,279 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 14:28:31,279 - Detection -   best_eval_score = 58.68
2023-04-20 14:28:31,279 - Detection -   eval_score = 60.66
2023-04-20 14:28:31,279 - Detection -   train_loss = 1.5679005980491638
2023-04-20 14:28:33,475 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 14:28:33,475 - Detection -   best_eval_score = 60.66
2023-04-20 14:28:33,475 - Detection -   eval_score = 62.38
2023-04-20 14:28:33,475 - Detection -   train_loss = 1.4807409445444744
2023-04-20 14:28:35,672 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 14:28:35,672 - Detection -   best_eval_score = 62.38
2023-04-20 14:28:35,672 - Detection -   eval_score = 62.82
2023-04-20 14:28:35,672 - Detection -   train_loss = 1.4053761412700017
2023-04-20 14:28:37,864 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 14:28:37,864 - Detection -   best_eval_score = 62.82
2023-04-20 14:28:37,864 - Detection -   eval_score = 63.43
2023-04-20 14:28:37,864 - Detection -   train_loss = 1.386674036582311
2023-04-20 14:28:40,064 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 14:28:40,064 - Detection -   best_eval_score = 63.43
2023-04-20 14:28:40,064 - Detection -   eval_score = 64.7
2023-04-20 14:28:40,064 - Detection -   train_loss = 1.5031959414482117
2023-04-20 14:28:42,259 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 14:28:42,259 - Detection -   best_eval_score = 64.7
2023-04-20 14:28:42,259 - Detection -   eval_score = 65.25
2023-04-20 14:28:42,259 - Detection -   train_loss = 1.3398098250230153
2023-04-20 14:28:44,458 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 14:28:44,458 - Detection -   best_eval_score = 65.25
2023-04-20 14:28:44,458 - Detection -   eval_score = 65.4
2023-04-20 14:28:44,458 - Detection -   train_loss = 1.4140223463376362
2023-04-20 14:28:46,645 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 14:28:46,645 - Detection -   best_eval_score = 65.4
2023-04-20 14:28:46,645 - Detection -   eval_score = 65.48
2023-04-20 14:28:46,645 - Detection -   train_loss = 1.4039400219917297
2023-04-20 14:28:48,841 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 14:28:48,841 - Detection -   best_eval_score = 65.48
2023-04-20 14:28:48,841 - Detection -   eval_score = 65.34
2023-04-20 14:28:48,841 - Detection -   train_loss = 1.327520415186882
2023-04-20 14:28:51,033 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 14:28:51,034 - Detection -   best_eval_score = 65.48
2023-04-20 14:28:51,034 - Detection -   eval_score = 65.2
2023-04-20 14:28:51,034 - Detection -   train_loss = 1.3585713108380635
2023-04-20 14:28:53,226 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 14:28:53,226 - Detection -   best_eval_score = 65.48
2023-04-20 14:28:53,226 - Detection -   eval_score = 65.55
2023-04-20 14:28:53,226 - Detection -   train_loss = 1.4490342338879902
2023-04-20 14:28:55,415 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 14:28:55,415 - Detection -   best_eval_score = 65.55
2023-04-20 14:28:55,415 - Detection -   eval_score = 67.09
2023-04-20 14:28:55,415 - Detection -   train_loss = 1.34408900141716
2023-04-20 14:28:57,605 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 14:28:57,605 - Detection -   best_eval_score = 67.09
2023-04-20 14:28:57,605 - Detection -   eval_score = 66.84
2023-04-20 14:28:57,605 - Detection -   train_loss = 1.3522338966528575
2023-04-20 14:28:59,795 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 14:28:59,795 - Detection -   best_eval_score = 67.09
2023-04-20 14:28:59,795 - Detection -   eval_score = 66.82
2023-04-20 14:28:59,796 - Detection -   train_loss = 1.455584317445755
2023-04-20 14:29:01,980 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 14:29:01,980 - Detection -   best_eval_score = 67.09
2023-04-20 14:29:01,981 - Detection -   eval_score = 66.47
2023-04-20 14:29:01,981 - Detection -   train_loss = 1.502334197362264
2023-04-20 14:29:04,175 - Detection - ***** Epoch: 38: Eval results *****
2023-04-20 14:29:04,175 - Detection -   best_eval_score = 67.09
2023-04-20 14:29:04,175 - Detection -   eval_score = 66.3
2023-04-20 14:29:04,175 - Detection -   train_loss = 1.3390384415785472
2023-04-20 14:29:06,368 - Detection - ***** Epoch: 39: Eval results *****
2023-04-20 14:29:06,368 - Detection -   best_eval_score = 67.09
2023-04-20 14:29:06,368 - Detection -   eval_score = 66.37
2023-04-20 14:29:06,368 - Detection -   train_loss = 1.3474828402201335
2023-04-20 14:29:08,556 - Detection - ***** Epoch: 40: Eval results *****
2023-04-20 14:29:08,557 - Detection -   best_eval_score = 67.09
2023-04-20 14:29:08,557 - Detection -   eval_score = 66.3
2023-04-20 14:29:08,557 - Detection -   train_loss = 1.3221952070792515
2023-04-20 14:29:10,747 - Detection - ***** Epoch: 41: Eval results *****
2023-04-20 14:29:10,747 - Detection -   best_eval_score = 67.09
2023-04-20 14:29:10,747 - Detection -   eval_score = 66.56
2023-04-20 14:29:10,747 - Detection -   train_loss = 1.3350418607393901
2023-04-20 14:29:12,947 - Detection - ***** Epoch: 42: Eval results *****
2023-04-20 14:29:12,947 - Detection -   best_eval_score = 67.09
2023-04-20 14:29:12,947 - Detection -   eval_score = 66.56
2023-04-20 14:29:12,947 - Detection -   train_loss = 1.412825604279836
2023-04-20 14:29:15,135 - Detection - ***** Epoch: 43: Eval results *****
2023-04-20 14:29:15,135 - Detection -   best_eval_score = 67.09
2023-04-20 14:29:15,135 - Detection -   eval_score = 66.62
2023-04-20 14:29:15,135 - Detection -   train_loss = 1.3668712675571442
2023-04-20 14:29:17,320 - Detection - ***** Epoch: 44: Eval results *****
2023-04-20 14:29:17,320 - Detection -   best_eval_score = 67.09
2023-04-20 14:29:17,320 - Detection -   eval_score = 66.62
2023-04-20 14:29:17,320 - Detection -   train_loss = 1.3918659190336864
2023-04-20 14:29:17,321 - Detection - Training Finished...
2023-04-20 14:29:17,321 - Detection - Testing begin...
2023-04-20 14:29:19,381 - Detection - ***** Test: Confusion Matrix *****
2023-04-20 14:29:19,381 - Detection - [[  5   0   0 ...   0   0  10]
 [  0  16   0 ...   0   0   6]
 [  0   0  10 ...   0   0   8]
 ...
 [  0   0   0 ...  18   0   2]
 [  0   0   0 ...   0  18   2]
 [  0  28  14 ...   1   0 601]]
2023-04-20 14:29:19,381 - Detection - ***** Test results *****
2023-04-20 14:29:19,381 - Detection -   Acc = 62.08
2023-04-20 14:29:19,381 - Detection -   F1 = 56.2104
2023-04-20 14:29:19,382 - Detection -   F1-known = 55.9235
2023-04-20 14:29:19,382 - Detection -   F1-open = 67.1133
2023-04-20 14:29:19,382 - Detection - Testing finished...
2023-04-20 14:29:19,382 - Detection - Results saved in results/results_ADB.csv
2023-04-20 14:29:19,401 - Detection - Open Intent Detection Finished...
