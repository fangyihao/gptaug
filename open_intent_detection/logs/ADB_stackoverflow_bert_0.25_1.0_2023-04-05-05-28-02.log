2023-04-05 05:28:02,696 - Detection - Open Intent Detection Begin...
2023-04-05 05:28:02,696 - Detection - Parameters Initialization...
2023-04-05 05:28:02,696 - Detection - ============================== Params ==============================
2023-04-05 05:28:02,696 - Detection - type:	open_intent_detection
2023-04-05 05:28:02,696 - Detection - logger_name:	Detection
2023-04-05 05:28:02,696 - Detection - log_dir:	logs
2023-04-05 05:28:02,696 - Detection - dataset:	stackoverflow
2023-04-05 05:28:02,696 - Detection - known_cls_ratio:	0.25
2023-04-05 05:28:02,696 - Detection - labeled_ratio:	1.0
2023-04-05 05:28:02,696 - Detection - method:	ADB
2023-04-05 05:28:02,696 - Detection - train:	True
2023-04-05 05:28:02,696 - Detection - pretrain:	True
2023-04-05 05:28:02,696 - Detection - save_model:	True
2023-04-05 05:28:02,696 - Detection - backbone:	bert
2023-04-05 05:28:02,696 - Detection - config_file_name:	ADB
2023-04-05 05:28:02,696 - Detection - seed:	0
2023-04-05 05:28:02,696 - Detection - gpu_id:	0
2023-04-05 05:28:02,696 - Detection - pipe_results_path:	pipe_results
2023-04-05 05:28:02,696 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-05 05:28:02,696 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-05 05:28:02,696 - Detection - model_dir:	models
2023-04-05 05:28:02,696 - Detection - load_pretrained_method:	None
2023-04-05 05:28:02,696 - Detection - result_dir:	results
2023-04-05 05:28:02,696 - Detection - results_file_name:	results_ADB.csv
2023-04-05 05:28:02,696 - Detection - save_results:	True
2023-04-05 05:28:02,696 - Detection - loss_fct:	CrossEntropyLoss
2023-04-05 05:28:02,697 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_0.25_1.0_bert_0
2023-04-05 05:28:02,697 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_0.25_1.0_bert_0/models
2023-04-05 05:28:02,697 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-05 05:28:02,697 - Detection - num_train_epochs:	100
2023-04-05 05:28:02,697 - Detection - num_labels:	None
2023-04-05 05:28:02,697 - Detection - max_seq_length:	None
2023-04-05 05:28:02,697 - Detection - freeze_backbone_parameters:	True
2023-04-05 05:28:02,697 - Detection - feat_dim:	768
2023-04-05 05:28:02,697 - Detection - warmup_proportion:	0.1
2023-04-05 05:28:02,697 - Detection - lr_boundary:	0.05
2023-04-05 05:28:02,697 - Detection - lr:	2e-05
2023-04-05 05:28:02,697 - Detection - activation:	relu
2023-04-05 05:28:02,697 - Detection - train_batch_size:	128
2023-04-05 05:28:02,697 - Detection - eval_batch_size:	64
2023-04-05 05:28:02,697 - Detection - test_batch_size:	64
2023-04-05 05:28:02,697 - Detection - wait_patient:	10
2023-04-05 05:28:02,697 - Detection - ============================== End Params ==============================
2023-04-05 05:28:02,697 - Detection - Data and Model Preparation...
2023-04-05 05:28:02,697 - Detection - The number of known intents is 5
2023-04-05 05:28:02,698 - Detection - Lists of known labels are: ['visual-studio', 'apache', 'wordpress', 'linq', 'matlab']
2023-04-05 05:28:02,728 - Detection - Number of labeled training samples = 3000
2023-04-05 05:28:02,728 - Detection - Number of unlabeled training samples = 9000
2023-04-05 05:28:02,732 - Detection - Number of evaluation samples = 500
2023-04-05 05:28:02,744 - Detection - Number of testing samples = 6000
2023-04-05 05:28:10,275 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-05 05:28:11,963 - Detection - Pre-training Begin...
2023-04-05 05:28:15,770 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 05:28:15,770 - Detection -   best_eval_score = 0
2023-04-05 05:28:15,770 - Detection -   eval_score = 27.6
2023-04-05 05:28:15,770 - Detection -   train_loss = 1.6112000743548076
2023-04-05 05:28:19,034 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 05:28:19,034 - Detection -   best_eval_score = 27.6
2023-04-05 05:28:19,034 - Detection -   eval_score = 65.2
2023-04-05 05:28:19,034 - Detection -   train_loss = 1.55917323132356
2023-04-05 05:28:22,306 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 05:28:22,306 - Detection -   best_eval_score = 65.2
2023-04-05 05:28:22,306 - Detection -   eval_score = 75.4
2023-04-05 05:28:22,306 - Detection -   train_loss = 1.423315942287445
2023-04-05 05:28:25,588 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 05:28:25,588 - Detection -   best_eval_score = 75.4
2023-04-05 05:28:25,588 - Detection -   eval_score = 86.6
2023-04-05 05:28:25,588 - Detection -   train_loss = 1.054066424568494
2023-04-05 05:28:28,916 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 05:28:28,917 - Detection -   best_eval_score = 86.6
2023-04-05 05:28:28,917 - Detection -   eval_score = 89.6
2023-04-05 05:28:28,917 - Detection -   train_loss = 0.5295763884981474
2023-04-05 05:28:32,330 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 05:28:32,330 - Detection -   best_eval_score = 89.6
2023-04-05 05:28:32,330 - Detection -   eval_score = 90.2
2023-04-05 05:28:32,330 - Detection -   train_loss = 0.2870641102393468
2023-04-05 05:28:35,807 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 05:28:35,808 - Detection -   best_eval_score = 90.2
2023-04-05 05:28:35,808 - Detection -   eval_score = 91.4
2023-04-05 05:28:35,808 - Detection -   train_loss = 0.22083736459414163
2023-04-05 05:28:39,310 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 05:28:39,310 - Detection -   best_eval_score = 91.4
2023-04-05 05:28:39,310 - Detection -   eval_score = 91.6
2023-04-05 05:28:39,310 - Detection -   train_loss = 0.19349415227770805
2023-04-05 05:28:42,808 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 05:28:42,808 - Detection -   best_eval_score = 91.6
2023-04-05 05:28:42,808 - Detection -   eval_score = 91.4
2023-04-05 05:28:42,808 - Detection -   train_loss = 0.16920634700606266
2023-04-05 05:28:46,298 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 05:28:46,298 - Detection -   best_eval_score = 91.6
2023-04-05 05:28:46,298 - Detection -   eval_score = 92.2
2023-04-05 05:28:46,298 - Detection -   train_loss = 0.1535795877377192
2023-04-05 05:28:49,801 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 05:28:49,801 - Detection -   best_eval_score = 92.2
2023-04-05 05:28:49,802 - Detection -   eval_score = 92.0
2023-04-05 05:28:49,802 - Detection -   train_loss = 0.136996577338626
2023-04-05 05:28:53,296 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 05:28:53,296 - Detection -   best_eval_score = 92.2
2023-04-05 05:28:53,296 - Detection -   eval_score = 93.4
2023-04-05 05:28:53,296 - Detection -   train_loss = 0.11814640136435628
2023-04-05 05:28:56,797 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 05:28:56,797 - Detection -   best_eval_score = 93.4
2023-04-05 05:28:56,797 - Detection -   eval_score = 93.2
2023-04-05 05:28:56,797 - Detection -   train_loss = 0.11293266620486975
2023-04-05 05:29:00,291 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 05:29:00,291 - Detection -   best_eval_score = 93.4
2023-04-05 05:29:00,291 - Detection -   eval_score = 93.0
2023-04-05 05:29:00,291 - Detection -   train_loss = 0.09589279621529083
2023-04-05 05:29:03,868 - Detection - ***** Epoch: 15: Eval results *****
2023-04-05 05:29:03,868 - Detection -   best_eval_score = 93.4
2023-04-05 05:29:03,868 - Detection -   eval_score = 93.8
2023-04-05 05:29:03,868 - Detection -   train_loss = 0.0900539771343271
2023-04-05 05:29:07,374 - Detection - ***** Epoch: 16: Eval results *****
2023-04-05 05:29:07,374 - Detection -   best_eval_score = 93.8
2023-04-05 05:29:07,375 - Detection -   eval_score = 93.4
2023-04-05 05:29:07,375 - Detection -   train_loss = 0.08027219818904996
2023-04-05 05:29:10,866 - Detection - ***** Epoch: 17: Eval results *****
2023-04-05 05:29:10,866 - Detection -   best_eval_score = 93.8
2023-04-05 05:29:10,866 - Detection -   eval_score = 93.6
2023-04-05 05:29:10,866 - Detection -   train_loss = 0.07027656414235632
2023-04-05 05:29:14,355 - Detection - ***** Epoch: 18: Eval results *****
2023-04-05 05:29:14,355 - Detection -   best_eval_score = 93.8
2023-04-05 05:29:14,355 - Detection -   eval_score = 93.4
2023-04-05 05:29:14,355 - Detection -   train_loss = 0.06893981853500009
2023-04-05 05:29:17,847 - Detection - ***** Epoch: 19: Eval results *****
2023-04-05 05:29:17,847 - Detection -   best_eval_score = 93.8
2023-04-05 05:29:17,847 - Detection -   eval_score = 93.2
2023-04-05 05:29:17,847 - Detection -   train_loss = 0.06031312382159134
2023-04-05 05:29:21,339 - Detection - ***** Epoch: 20: Eval results *****
2023-04-05 05:29:21,339 - Detection -   best_eval_score = 93.8
2023-04-05 05:29:21,339 - Detection -   eval_score = 93.2
2023-04-05 05:29:21,339 - Detection -   train_loss = 0.0677486405087014
2023-04-05 05:29:24,826 - Detection - ***** Epoch: 21: Eval results *****
2023-04-05 05:29:24,826 - Detection -   best_eval_score = 93.8
2023-04-05 05:29:24,826 - Detection -   eval_score = 93.2
2023-04-05 05:29:24,826 - Detection -   train_loss = 0.050837567929799356
2023-04-05 05:29:28,307 - Detection - ***** Epoch: 22: Eval results *****
2023-04-05 05:29:28,308 - Detection -   best_eval_score = 93.8
2023-04-05 05:29:28,308 - Detection -   eval_score = 93.6
2023-04-05 05:29:28,308 - Detection -   train_loss = 0.04911049106158316
2023-04-05 05:29:31,791 - Detection - ***** Epoch: 23: Eval results *****
2023-04-05 05:29:31,791 - Detection -   best_eval_score = 93.8
2023-04-05 05:29:31,791 - Detection -   eval_score = 93.6
2023-04-05 05:29:31,791 - Detection -   train_loss = 0.04332097969017923
2023-04-05 05:29:35,285 - Detection - ***** Epoch: 24: Eval results *****
2023-04-05 05:29:35,285 - Detection -   best_eval_score = 93.8
2023-04-05 05:29:35,285 - Detection -   eval_score = 93.6
2023-04-05 05:29:35,285 - Detection -   train_loss = 0.04334862631124755
2023-04-05 05:29:38,779 - Detection - ***** Epoch: 25: Eval results *****
2023-04-05 05:29:38,779 - Detection -   best_eval_score = 93.8
2023-04-05 05:29:38,779 - Detection -   eval_score = 93.4
2023-04-05 05:29:38,779 - Detection -   train_loss = 0.040313748021920524
2023-04-05 05:29:38,780 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_0.25_1.0_bert_0/models
2023-04-05 05:29:39,315 - Detection - Pre-training finished...
2023-04-05 05:29:39,315 - Detection - Training Begin...
2023-04-05 05:29:45,401 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 05:29:45,402 - Detection -   best_eval_score = 0
2023-04-05 05:29:45,402 - Detection -   eval_score = 7.11
2023-04-05 05:29:45,402 - Detection -   train_loss = 5.96137410402298
2023-04-05 05:29:48,840 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 05:29:48,840 - Detection -   best_eval_score = 7.11
2023-04-05 05:29:48,841 - Detection -   eval_score = 37.54
2023-04-05 05:29:48,841 - Detection -   train_loss = 4.962553163369496
2023-04-05 05:29:52,288 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 05:29:52,288 - Detection -   best_eval_score = 37.54
2023-04-05 05:29:52,289 - Detection -   eval_score = 63.2
2023-04-05 05:29:52,289 - Detection -   train_loss = 3.7506028910477958
2023-04-05 05:29:55,731 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 05:29:55,732 - Detection -   best_eval_score = 63.2
2023-04-05 05:29:55,732 - Detection -   eval_score = 73.3
2023-04-05 05:29:55,732 - Detection -   train_loss = 2.491973196466764
2023-04-05 05:29:59,178 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 05:29:59,178 - Detection -   best_eval_score = 73.3
2023-04-05 05:29:59,178 - Detection -   eval_score = 74.88
2023-04-05 05:29:59,178 - Detection -   train_loss = 1.4631799459457397
2023-04-05 05:30:02,631 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 05:30:02,631 - Detection -   best_eval_score = 74.88
2023-04-05 05:30:02,631 - Detection -   eval_score = 75.0
2023-04-05 05:30:02,631 - Detection -   train_loss = 1.166799691816171
2023-04-05 05:30:06,075 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 05:30:06,075 - Detection -   best_eval_score = 75.0
2023-04-05 05:30:06,075 - Detection -   eval_score = 74.9
2023-04-05 05:30:06,076 - Detection -   train_loss = 1.1682099054257076
2023-04-05 05:30:09,522 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 05:30:09,522 - Detection -   best_eval_score = 75.0
2023-04-05 05:30:09,522 - Detection -   eval_score = 75.0
2023-04-05 05:30:09,522 - Detection -   train_loss = 1.148182953397433
2023-04-05 05:30:12,975 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 05:30:12,975 - Detection -   best_eval_score = 75.0
2023-04-05 05:30:12,975 - Detection -   eval_score = 74.9
2023-04-05 05:30:12,975 - Detection -   train_loss = 1.1576267282168071
2023-04-05 05:30:16,435 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 05:30:16,435 - Detection -   best_eval_score = 75.0
2023-04-05 05:30:16,435 - Detection -   eval_score = 74.9
2023-04-05 05:30:16,435 - Detection -   train_loss = 1.145049440364043
2023-04-05 05:30:19,905 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 05:30:19,905 - Detection -   best_eval_score = 75.0
2023-04-05 05:30:19,905 - Detection -   eval_score = 75.0
2023-04-05 05:30:19,905 - Detection -   train_loss = 1.1308637609084446
2023-04-05 05:30:23,348 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 05:30:23,349 - Detection -   best_eval_score = 75.0
2023-04-05 05:30:23,349 - Detection -   eval_score = 74.9
2023-04-05 05:30:23,349 - Detection -   train_loss = 1.1528214265902836
2023-04-05 05:30:26,788 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 05:30:26,788 - Detection -   best_eval_score = 75.0
2023-04-05 05:30:26,788 - Detection -   eval_score = 74.9
2023-04-05 05:30:26,788 - Detection -   train_loss = 1.1528497785329819
2023-04-05 05:30:30,246 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 05:30:30,246 - Detection -   best_eval_score = 75.0
2023-04-05 05:30:30,246 - Detection -   eval_score = 74.9
2023-04-05 05:30:30,246 - Detection -   train_loss = 1.1443740079800289
2023-04-05 05:30:33,691 - Detection - ***** Epoch: 15: Eval results *****
2023-04-05 05:30:33,691 - Detection -   best_eval_score = 75.0
2023-04-05 05:30:33,691 - Detection -   eval_score = 74.9
2023-04-05 05:30:33,691 - Detection -   train_loss = 1.167510449886322
2023-04-05 05:30:37,150 - Detection - ***** Epoch: 16: Eval results *****
2023-04-05 05:30:37,150 - Detection -   best_eval_score = 75.0
2023-04-05 05:30:37,150 - Detection -   eval_score = 75.0
2023-04-05 05:30:37,150 - Detection -   train_loss = 1.1534380887945492
2023-04-05 05:30:37,151 - Detection - Training Finished...
2023-04-05 05:30:37,151 - Detection - Testing begin...
2023-04-05 05:30:42,537 - Detection - ***** Test: Confusion Matrix *****
2023-04-05 05:30:42,537 - Detection - [[ 242    1    0    0    0   57]
 [   1  231    1    0    0   67]
 [   0    2  265    1    0   32]
 [   0    0    0  262    0   38]
 [   0    0    0    0  259   41]
 [ 227  135   13   70    7 4048]]
2023-04-05 05:30:42,537 - Detection - ***** Test results *****
2023-04-05 05:30:42,537 - Detection -   Acc = 88.45
2023-04-05 05:30:42,537 - Detection -   F1 = 81.6551
2023-04-05 05:30:42,537 - Detection -   F1-known = 79.5505
2023-04-05 05:30:42,537 - Detection -   F1-open = 92.1781
2023-04-05 05:30:42,537 - Detection - Testing finished...
2023-04-05 05:30:42,537 - Detection - Results saved in results/results_ADB.csv
2023-04-05 05:30:42,556 - Detection - Open Intent Detection Finished...
