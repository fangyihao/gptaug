2023-04-20 00:17:18,637 - Detection - Open Intent Detection Begin...
2023-04-20 00:17:18,637 - Detection - Parameters Initialization...
2023-04-20 00:17:18,638 - Detection - ============================== Params ==============================
2023-04-20 00:17:18,638 - Detection - type:	open_intent_detection
2023-04-20 00:17:18,638 - Detection - logger_name:	Detection
2023-04-20 00:17:18,638 - Detection - log_dir:	logs
2023-04-20 00:17:18,638 - Detection - dataset:	stackoverflow_cg
2023-04-20 00:17:18,638 - Detection - known_cls_ratio:	0.25
2023-04-20 00:17:18,638 - Detection - labeled_ratio:	1.0
2023-04-20 00:17:18,638 - Detection - method:	DA-ADB
2023-04-20 00:17:18,638 - Detection - train:	True
2023-04-20 00:17:18,638 - Detection - pretrain:	True
2023-04-20 00:17:18,638 - Detection - save_model:	True
2023-04-20 00:17:18,638 - Detection - backbone:	bert_disaware
2023-04-20 00:17:18,638 - Detection - config_file_name:	DA-ADB
2023-04-20 00:17:18,638 - Detection - seed:	9
2023-04-20 00:17:18,638 - Detection - gpu_id:	0
2023-04-20 00:17:18,638 - Detection - pipe_results_path:	pipe_results
2023-04-20 00:17:18,638 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-20 00:17:18,638 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-20 00:17:18,638 - Detection - model_dir:	models
2023-04-20 00:17:18,638 - Detection - load_pretrained_method:	None
2023-04-20 00:17:18,638 - Detection - result_dir:	results
2023-04-20 00:17:18,638 - Detection - results_file_name:	results_DA-ADB.csv
2023-04-20 00:17:18,638 - Detection - save_results:	True
2023-04-20 00:17:18,638 - Detection - loss_fct:	CrossEntropyLoss
2023-04-20 00:17:18,638 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.25_1.0_bert_disaware_9
2023-04-20 00:17:18,638 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.25_1.0_bert_disaware_9/models
2023-04-20 00:17:18,638 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-20 00:17:18,638 - Detection - num_train_epochs:	100
2023-04-20 00:17:18,638 - Detection - num_labels:	None
2023-04-20 00:17:18,638 - Detection - max_seq_length:	None
2023-04-20 00:17:18,638 - Detection - freeze_backbone_parameters:	True
2023-04-20 00:17:18,638 - Detection - feat_dim:	768
2023-04-20 00:17:18,638 - Detection - warmup_proportion:	0.1
2023-04-20 00:17:18,638 - Detection - scale:	4
2023-04-20 00:17:18,638 - Detection - lr_boundary:	0.05
2023-04-20 00:17:18,638 - Detection - lr:	2e-05
2023-04-20 00:17:18,638 - Detection - activation:	relu
2023-04-20 00:17:18,638 - Detection - train_batch_size:	128
2023-04-20 00:17:18,638 - Detection - eval_batch_size:	64
2023-04-20 00:17:18,638 - Detection - test_batch_size:	64
2023-04-20 00:17:18,638 - Detection - wait_patient:	10
2023-04-20 00:17:18,638 - Detection - ============================== End Params ==============================
2023-04-20 00:17:18,638 - Detection - Data and Model Preparation...
2023-04-20 00:17:18,639 - Detection - The number of known intents is 5
2023-04-20 00:17:18,639 - Detection - Lists of known labels are: ['cocoa', 'haskell', 'hibernate', 'excel', 'spring']
2023-04-20 00:17:18,657 - Detection - Number of labeled training samples = 1990
2023-04-20 00:17:18,657 - Detection - Number of unlabeled training samples = 5827
2023-04-20 00:17:18,661 - Detection - Number of evaluation samples = 470
2023-04-20 00:17:18,670 - Detection - Number of testing samples = 5082
2023-04-20 00:17:26,737 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-20 00:17:26,818 - Detection - Pre-training Begin...
2023-04-20 00:17:31,123 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 00:17:31,123 - Detection -   best_eval_score = 0
2023-04-20 00:17:31,123 - Detection -   eval_score = 10.26
2023-04-20 00:17:31,123 - Detection -   train_loss = 1.6159120798110962
2023-04-20 00:17:34,952 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 00:17:34,952 - Detection -   best_eval_score = 10.26
2023-04-20 00:17:34,952 - Detection -   eval_score = 17.96
2023-04-20 00:17:34,952 - Detection -   train_loss = 1.6009884253144264
2023-04-20 00:17:38,788 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 00:17:38,788 - Detection -   best_eval_score = 17.96
2023-04-20 00:17:38,788 - Detection -   eval_score = 20.55
2023-04-20 00:17:38,788 - Detection -   train_loss = 1.5855227038264275
2023-04-20 00:17:42,625 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 00:17:42,625 - Detection -   best_eval_score = 20.55
2023-04-20 00:17:42,625 - Detection -   eval_score = 48.79
2023-04-20 00:17:42,625 - Detection -   train_loss = 1.5537193641066551
2023-04-20 00:17:46,468 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 00:17:46,468 - Detection -   best_eval_score = 48.79
2023-04-20 00:17:46,468 - Detection -   eval_score = 48.58
2023-04-20 00:17:46,468 - Detection -   train_loss = 1.4682568833231926
2023-04-20 00:17:50,310 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 00:17:50,310 - Detection -   best_eval_score = 48.79
2023-04-20 00:17:50,310 - Detection -   eval_score = 77.21
2023-04-20 00:17:50,310 - Detection -   train_loss = 1.2716752365231514
2023-04-20 00:17:54,171 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 00:17:54,171 - Detection -   best_eval_score = 77.21
2023-04-20 00:17:54,171 - Detection -   eval_score = 85.73
2023-04-20 00:17:54,171 - Detection -   train_loss = 0.9924087077379227
2023-04-20 00:17:58,038 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 00:17:58,038 - Detection -   best_eval_score = 85.73
2023-04-20 00:17:58,038 - Detection -   eval_score = 86.75
2023-04-20 00:17:58,038 - Detection -   train_loss = 0.7646898999810219
2023-04-20 00:18:01,910 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 00:18:01,910 - Detection -   best_eval_score = 86.75
2023-04-20 00:18:01,910 - Detection -   eval_score = 88.89
2023-04-20 00:18:01,910 - Detection -   train_loss = 0.613760981708765
2023-04-20 00:18:05,789 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 00:18:05,789 - Detection -   best_eval_score = 88.89
2023-04-20 00:18:05,790 - Detection -   eval_score = 88.7
2023-04-20 00:18:05,790 - Detection -   train_loss = 0.5318568460643291
2023-04-20 00:18:09,666 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 00:18:09,666 - Detection -   best_eval_score = 88.89
2023-04-20 00:18:09,666 - Detection -   eval_score = 90.71
2023-04-20 00:18:09,666 - Detection -   train_loss = 0.47669795900583267
2023-04-20 00:18:13,551 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 00:18:13,551 - Detection -   best_eval_score = 90.71
2023-04-20 00:18:13,551 - Detection -   eval_score = 90.45
2023-04-20 00:18:13,551 - Detection -   train_loss = 0.44013744220137596
2023-04-20 00:18:17,434 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 00:18:17,434 - Detection -   best_eval_score = 90.71
2023-04-20 00:18:17,434 - Detection -   eval_score = 90.94
2023-04-20 00:18:17,434 - Detection -   train_loss = 0.4068881403654814
2023-04-20 00:18:21,341 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 00:18:21,341 - Detection -   best_eval_score = 90.94
2023-04-20 00:18:21,341 - Detection -   eval_score = 90.06
2023-04-20 00:18:21,341 - Detection -   train_loss = 0.38125063106417656
2023-04-20 00:18:25,235 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 00:18:25,235 - Detection -   best_eval_score = 90.94
2023-04-20 00:18:25,235 - Detection -   eval_score = 89.23
2023-04-20 00:18:25,235 - Detection -   train_loss = 0.36051598377525806
2023-04-20 00:18:29,133 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 00:18:29,134 - Detection -   best_eval_score = 90.94
2023-04-20 00:18:29,134 - Detection -   eval_score = 89.9
2023-04-20 00:18:29,134 - Detection -   train_loss = 0.3401310872286558
2023-04-20 00:18:33,034 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 00:18:33,034 - Detection -   best_eval_score = 90.94
2023-04-20 00:18:33,034 - Detection -   eval_score = 91.75
2023-04-20 00:18:33,035 - Detection -   train_loss = 0.32607099413871765
2023-04-20 00:18:36,939 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 00:18:36,940 - Detection -   best_eval_score = 91.75
2023-04-20 00:18:36,940 - Detection -   eval_score = 90.94
2023-04-20 00:18:36,940 - Detection -   train_loss = 0.3125203549861908
2023-04-20 00:18:40,830 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 00:18:40,830 - Detection -   best_eval_score = 91.75
2023-04-20 00:18:40,830 - Detection -   eval_score = 91.15
2023-04-20 00:18:40,830 - Detection -   train_loss = 0.29348476603627205
2023-04-20 00:18:44,818 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 00:18:44,818 - Detection -   best_eval_score = 91.75
2023-04-20 00:18:44,818 - Detection -   eval_score = 90.53
2023-04-20 00:18:44,818 - Detection -   train_loss = 0.2803591564297676
2023-04-20 00:18:48,707 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 00:18:48,707 - Detection -   best_eval_score = 91.75
2023-04-20 00:18:48,707 - Detection -   eval_score = 90.68
2023-04-20 00:18:48,707 - Detection -   train_loss = 0.26758488919585943
2023-04-20 00:18:52,593 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 00:18:52,593 - Detection -   best_eval_score = 91.75
2023-04-20 00:18:52,593 - Detection -   eval_score = 90.67
2023-04-20 00:18:52,593 - Detection -   train_loss = 0.26128959096968174
2023-04-20 00:18:56,479 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 00:18:56,479 - Detection -   best_eval_score = 91.75
2023-04-20 00:18:56,479 - Detection -   eval_score = 91.8
2023-04-20 00:18:56,479 - Detection -   train_loss = 0.25010927580296993
2023-04-20 00:19:00,370 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 00:19:00,370 - Detection -   best_eval_score = 91.8
2023-04-20 00:19:00,370 - Detection -   eval_score = 90.9
2023-04-20 00:19:00,370 - Detection -   train_loss = 0.2498312508687377
2023-04-20 00:19:04,252 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 00:19:04,252 - Detection -   best_eval_score = 91.8
2023-04-20 00:19:04,252 - Detection -   eval_score = 90.29
2023-04-20 00:19:04,252 - Detection -   train_loss = 0.23182827699929476
2023-04-20 00:19:08,138 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 00:19:08,138 - Detection -   best_eval_score = 91.8
2023-04-20 00:19:08,138 - Detection -   eval_score = 91.36
2023-04-20 00:19:08,138 - Detection -   train_loss = 0.218672682531178
2023-04-20 00:19:12,022 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 00:19:12,022 - Detection -   best_eval_score = 91.8
2023-04-20 00:19:12,022 - Detection -   eval_score = 91.35
2023-04-20 00:19:12,022 - Detection -   train_loss = 0.21990267094224691
2023-04-20 00:19:15,906 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 00:19:15,906 - Detection -   best_eval_score = 91.8
2023-04-20 00:19:15,906 - Detection -   eval_score = 91.36
2023-04-20 00:19:15,906 - Detection -   train_loss = 0.20882253255695105
2023-04-20 00:19:19,791 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 00:19:19,791 - Detection -   best_eval_score = 91.8
2023-04-20 00:19:19,791 - Detection -   eval_score = 91.78
2023-04-20 00:19:19,791 - Detection -   train_loss = 0.2090101409703493
2023-04-20 00:19:23,676 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 00:19:23,676 - Detection -   best_eval_score = 91.8
2023-04-20 00:19:23,676 - Detection -   eval_score = 90.69
2023-04-20 00:19:23,676 - Detection -   train_loss = 0.20445919129997492
2023-04-20 00:19:27,561 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 00:19:27,561 - Detection -   best_eval_score = 91.8
2023-04-20 00:19:27,561 - Detection -   eval_score = 91.13
2023-04-20 00:19:27,561 - Detection -   train_loss = 0.19544886238873005
2023-04-20 00:19:31,446 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 00:19:31,446 - Detection -   best_eval_score = 91.8
2023-04-20 00:19:31,446 - Detection -   eval_score = 91.29
2023-04-20 00:19:31,446 - Detection -   train_loss = 0.19305487535893917
2023-04-20 00:19:35,333 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 00:19:35,333 - Detection -   best_eval_score = 91.8
2023-04-20 00:19:35,333 - Detection -   eval_score = 91.54
2023-04-20 00:19:35,333 - Detection -   train_loss = 0.18633455410599709
2023-04-20 00:19:35,334 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.25_1.0_bert_disaware_9/models
2023-04-20 00:19:35,874 - Detection - Pre-training finished...
2023-04-20 00:19:35,874 - Detection - Training Begin...
2023-04-20 00:19:38,106 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 00:19:38,106 - Detection -   best_eval_score = 0
2023-04-20 00:19:38,106 - Detection -   eval_score = 3.81
2023-04-20 00:19:38,106 - Detection -   train_loss = 4.201558440923691
2023-04-20 00:19:40,337 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 00:19:40,337 - Detection -   best_eval_score = 3.81
2023-04-20 00:19:40,337 - Detection -   eval_score = 14.39
2023-04-20 00:19:40,337 - Detection -   train_loss = 3.633259117603302
2023-04-20 00:19:42,568 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 00:19:42,569 - Detection -   best_eval_score = 14.39
2023-04-20 00:19:42,569 - Detection -   eval_score = 26.46
2023-04-20 00:19:42,569 - Detection -   train_loss = 2.9356590062379837
2023-04-20 00:19:44,802 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 00:19:44,802 - Detection -   best_eval_score = 26.46
2023-04-20 00:19:44,802 - Detection -   eval_score = 52.92
2023-04-20 00:19:44,802 - Detection -   train_loss = 2.1333191990852356
2023-04-20 00:19:47,033 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 00:19:47,033 - Detection -   best_eval_score = 52.92
2023-04-20 00:19:47,034 - Detection -   eval_score = 68.66
2023-04-20 00:19:47,034 - Detection -   train_loss = 1.4370658099651337
2023-04-20 00:19:49,267 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 00:19:49,267 - Detection -   best_eval_score = 68.66
2023-04-20 00:19:49,267 - Detection -   eval_score = 72.69
2023-04-20 00:19:49,267 - Detection -   train_loss = 1.1009866558015347
2023-04-20 00:19:51,498 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 00:19:51,498 - Detection -   best_eval_score = 72.69
2023-04-20 00:19:51,498 - Detection -   eval_score = 72.8
2023-04-20 00:19:51,498 - Detection -   train_loss = 1.0350160151720047
2023-04-20 00:19:53,731 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 00:19:53,731 - Detection -   best_eval_score = 72.8
2023-04-20 00:19:53,731 - Detection -   eval_score = 72.01
2023-04-20 00:19:53,731 - Detection -   train_loss = 1.066527247428894
2023-04-20 00:19:55,961 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 00:19:55,961 - Detection -   best_eval_score = 72.8
2023-04-20 00:19:55,961 - Detection -   eval_score = 72.02
2023-04-20 00:19:55,961 - Detection -   train_loss = 1.0406997576355934
2023-04-20 00:19:58,192 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 00:19:58,192 - Detection -   best_eval_score = 72.8
2023-04-20 00:19:58,192 - Detection -   eval_score = 72.2
2023-04-20 00:19:58,192 - Detection -   train_loss = 1.0693865343928337
2023-04-20 00:20:00,427 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 00:20:00,427 - Detection -   best_eval_score = 72.8
2023-04-20 00:20:00,427 - Detection -   eval_score = 72.68
2023-04-20 00:20:00,427 - Detection -   train_loss = 1.025556594133377
2023-04-20 00:20:02,660 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 00:20:02,660 - Detection -   best_eval_score = 72.8
2023-04-20 00:20:02,660 - Detection -   eval_score = 72.39
2023-04-20 00:20:02,660 - Detection -   train_loss = 1.0356728546321392
2023-04-20 00:20:04,890 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 00:20:04,890 - Detection -   best_eval_score = 72.8
2023-04-20 00:20:04,890 - Detection -   eval_score = 72.39
2023-04-20 00:20:04,890 - Detection -   train_loss = 1.045119285583496
2023-04-20 00:20:07,119 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 00:20:07,119 - Detection -   best_eval_score = 72.8
2023-04-20 00:20:07,119 - Detection -   eval_score = 72.32
2023-04-20 00:20:07,119 - Detection -   train_loss = 1.034672286361456
2023-04-20 00:20:09,347 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 00:20:09,347 - Detection -   best_eval_score = 72.8
2023-04-20 00:20:09,347 - Detection -   eval_score = 72.69
2023-04-20 00:20:09,347 - Detection -   train_loss = 1.0342685133218765
2023-04-20 00:20:11,577 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 00:20:11,577 - Detection -   best_eval_score = 72.8
2023-04-20 00:20:11,577 - Detection -   eval_score = 72.28
2023-04-20 00:20:11,577 - Detection -   train_loss = 1.061701387166977
2023-04-20 00:20:13,807 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 00:20:13,808 - Detection -   best_eval_score = 72.8
2023-04-20 00:20:13,808 - Detection -   eval_score = 71.89
2023-04-20 00:20:13,808 - Detection -   train_loss = 1.0508226864039898
2023-04-20 00:20:13,809 - Detection - Training Finished...
2023-04-20 00:20:13,809 - Detection - Testing begin...
2023-04-20 00:20:18,030 - Detection - ***** Test: Confusion Matrix *****
2023-04-20 00:20:18,030 - Detection - [[ 163    1    0    0    0   72]
 [   1  222    0    0    0   46]
 [   0    1  210    0    2   45]
 [   0    1    0  178    0   52]
 [   3    0    1    0  187   55]
 [ 432  236    2   10   28 3134]]
2023-04-20 00:20:18,030 - Detection - ***** Test results *****
2023-04-20 00:20:18,030 - Detection -   Acc = 80.56
2023-04-20 00:20:18,030 - Detection -   F1 = 73.5467
2023-04-20 00:20:18,030 - Detection -   F1-known = 70.9555
2023-04-20 00:20:18,031 - Detection -   F1-open = 86.5029
2023-04-20 00:20:18,031 - Detection - Testing finished...
2023-04-20 00:20:18,031 - Detection - Results saved in results/results_DA-ADB.csv
2023-04-20 00:20:18,052 - Detection - Open Intent Detection Finished...
