2023-04-19 21:05:37,388 - Detection - Open Intent Detection Begin...
2023-04-19 21:05:37,388 - Detection - Parameters Initialization...
2023-04-19 21:05:37,388 - Detection - ============================== Params ==============================
2023-04-19 21:05:37,388 - Detection - type:	open_intent_detection
2023-04-19 21:05:37,388 - Detection - logger_name:	Detection
2023-04-19 21:05:37,388 - Detection - log_dir:	logs
2023-04-19 21:05:37,388 - Detection - dataset:	banking_cg
2023-04-19 21:05:37,388 - Detection - known_cls_ratio:	0.75
2023-04-19 21:05:37,388 - Detection - labeled_ratio:	1.0
2023-04-19 21:05:37,388 - Detection - method:	DA-ADB
2023-04-19 21:05:37,388 - Detection - train:	True
2023-04-19 21:05:37,388 - Detection - pretrain:	True
2023-04-19 21:05:37,388 - Detection - save_model:	True
2023-04-19 21:05:37,388 - Detection - backbone:	bert_disaware
2023-04-19 21:05:37,388 - Detection - config_file_name:	DA-ADB
2023-04-19 21:05:37,388 - Detection - seed:	9
2023-04-19 21:05:37,388 - Detection - gpu_id:	0
2023-04-19 21:05:37,388 - Detection - pipe_results_path:	pipe_results
2023-04-19 21:05:37,388 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-19 21:05:37,388 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-19 21:05:37,388 - Detection - model_dir:	models
2023-04-19 21:05:37,388 - Detection - load_pretrained_method:	None
2023-04-19 21:05:37,388 - Detection - result_dir:	results
2023-04-19 21:05:37,388 - Detection - results_file_name:	results_DA-ADB.csv
2023-04-19 21:05:37,388 - Detection - save_results:	True
2023-04-19 21:05:37,388 - Detection - loss_fct:	CrossEntropyLoss
2023-04-19 21:05:37,388 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_cg_0.75_1.0_bert_disaware_9
2023-04-19 21:05:37,388 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_cg_0.75_1.0_bert_disaware_9/models
2023-04-19 21:05:37,388 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-19 21:05:37,388 - Detection - num_train_epochs:	100
2023-04-19 21:05:37,388 - Detection - num_labels:	None
2023-04-19 21:05:37,388 - Detection - max_seq_length:	None
2023-04-19 21:05:37,388 - Detection - freeze_backbone_parameters:	True
2023-04-19 21:05:37,388 - Detection - feat_dim:	768
2023-04-19 21:05:37,388 - Detection - warmup_proportion:	0.1
2023-04-19 21:05:37,388 - Detection - scale:	4
2023-04-19 21:05:37,388 - Detection - lr_boundary:	0.05
2023-04-19 21:05:37,389 - Detection - lr:	2e-05
2023-04-19 21:05:37,389 - Detection - activation:	relu
2023-04-19 21:05:37,389 - Detection - train_batch_size:	128
2023-04-19 21:05:37,389 - Detection - eval_batch_size:	64
2023-04-19 21:05:37,389 - Detection - test_batch_size:	64
2023-04-19 21:05:37,389 - Detection - wait_patient:	10
2023-04-19 21:05:37,389 - Detection - ============================== End Params ==============================
2023-04-19 21:05:37,389 - Detection - Data and Model Preparation...
2023-04-19 21:05:37,389 - Detection - The number of known intents is 58
2023-04-19 21:05:37,389 - Detection - Lists of known labels are: ['card_payment_not_recognised', 'cash_withdrawal_charge', 'declined_transfer', 'exchange_via_app', 'cash_withdrawal_not_recognised', 'declined_card_payment', 'pending_transfer', 'country_support', 'verify_top_up', 'apple_pay_or_google_pay', 'reverted_card_payment?', 'top_up_reverted', 'passcode_forgotten', 'balance_not_updated_after_bank_transfer', 'card_linking', 'lost_or_stolen_phone', 'failed_transfer', 'card_not_working', 'top_up_by_card_charge', 'balance_not_updated_after_cheque_or_cash_deposit', 'compromised_card', 'exchange_charge', 'top_up_by_cash_or_cheque', 'order_physical_card', 'age_limit', 'terminate_account', 'pin_blocked', 'edit_personal_details', 'declined_cash_withdrawal', 'get_physical_card', 'beneficiary_not_allowed', 'disposable_card_limits', 'receiving_money', 'contactless_not_working', 'automatic_top_up', 'getting_virtual_card', 'pending_top_up', 'card_about_to_expire', 'transfer_timing', 'wrong_exchange_rate_for_cash_withdrawal', 'atm_support', 'pending_cash_withdrawal', 'visa_or_mastercard', 'transaction_charged_twice', 'pending_card_payment', 'unable_to_verify_identity', 'card_delivery_estimate', 'verify_my_identity', 'card_payment_fee_charged', 'cancel_transfer', 'get_disposable_virtual_card', 'card_swallowed', 'fiat_currency_support', 'card_acceptance', 'extra_charge_on_statement', 'activate_my_card', 'virtual_card_not_working', 'card_payment_wrong_exchange_rate']
2023-04-19 21:05:37,400 - Detection - Number of labeled training samples = 2041
2023-04-19 21:05:37,400 - Detection - Number of unlabeled training samples = 734
2023-04-19 21:05:37,402 - Detection - Number of evaluation samples = 610
2023-04-19 21:05:37,407 - Detection - Number of testing samples = 1896
2023-04-19 21:05:43,289 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-19 21:05:43,371 - Detection - Pre-training Begin...
2023-04-19 21:05:48,783 - Detection - ***** Epoch: 1: Eval results *****
2023-04-19 21:05:48,783 - Detection -   best_eval_score = 0
2023-04-19 21:05:48,783 - Detection -   eval_score = 0.08
2023-04-19 21:05:48,784 - Detection -   train_loss = 4.065200358629227
2023-04-19 21:05:53,728 - Detection - ***** Epoch: 2: Eval results *****
2023-04-19 21:05:53,728 - Detection -   best_eval_score = 0.08
2023-04-19 21:05:53,728 - Detection -   eval_score = 0.44
2023-04-19 21:05:53,728 - Detection -   train_loss = 4.036051481962204
2023-04-19 21:05:58,682 - Detection - ***** Epoch: 3: Eval results *****
2023-04-19 21:05:58,682 - Detection -   best_eval_score = 0.44
2023-04-19 21:05:58,682 - Detection -   eval_score = 0.09
2023-04-19 21:05:58,682 - Detection -   train_loss = 3.9979400038719177
2023-04-19 21:06:03,632 - Detection - ***** Epoch: 4: Eval results *****
2023-04-19 21:06:03,632 - Detection -   best_eval_score = 0.44
2023-04-19 21:06:03,632 - Detection -   eval_score = 0.09
2023-04-19 21:06:03,632 - Detection -   train_loss = 3.9655294716358185
2023-04-19 21:06:08,593 - Detection - ***** Epoch: 5: Eval results *****
2023-04-19 21:06:08,593 - Detection -   best_eval_score = 0.44
2023-04-19 21:06:08,593 - Detection -   eval_score = 0.21
2023-04-19 21:06:08,593 - Detection -   train_loss = 3.93656986951828
2023-04-19 21:06:13,558 - Detection - ***** Epoch: 6: Eval results *****
2023-04-19 21:06:13,558 - Detection -   best_eval_score = 0.44
2023-04-19 21:06:13,559 - Detection -   eval_score = 0.77
2023-04-19 21:06:13,559 - Detection -   train_loss = 3.9045727103948593
2023-04-19 21:06:18,544 - Detection - ***** Epoch: 7: Eval results *****
2023-04-19 21:06:18,544 - Detection -   best_eval_score = 0.77
2023-04-19 21:06:18,544 - Detection -   eval_score = 1.03
2023-04-19 21:06:18,544 - Detection -   train_loss = 3.8697560876607895
2023-04-19 21:06:23,538 - Detection - ***** Epoch: 8: Eval results *****
2023-04-19 21:06:23,538 - Detection -   best_eval_score = 1.03
2023-04-19 21:06:23,538 - Detection -   eval_score = 1.53
2023-04-19 21:06:23,539 - Detection -   train_loss = 3.8178989738225937
2023-04-19 21:06:28,534 - Detection - ***** Epoch: 9: Eval results *****
2023-04-19 21:06:28,534 - Detection -   best_eval_score = 1.53
2023-04-19 21:06:28,534 - Detection -   eval_score = 3.26
2023-04-19 21:06:28,534 - Detection -   train_loss = 3.7299722135066986
2023-04-19 21:06:33,641 - Detection - ***** Epoch: 10: Eval results *****
2023-04-19 21:06:33,641 - Detection -   best_eval_score = 3.26
2023-04-19 21:06:33,641 - Detection -   eval_score = 10.68
2023-04-19 21:06:33,641 - Detection -   train_loss = 3.5704169124364853
2023-04-19 21:06:38,680 - Detection - ***** Epoch: 11: Eval results *****
2023-04-19 21:06:38,680 - Detection -   best_eval_score = 10.68
2023-04-19 21:06:38,680 - Detection -   eval_score = 16.84
2023-04-19 21:06:38,680 - Detection -   train_loss = 3.381235748529434
2023-04-19 21:06:43,713 - Detection - ***** Epoch: 12: Eval results *****
2023-04-19 21:06:43,713 - Detection -   best_eval_score = 16.84
2023-04-19 21:06:43,713 - Detection -   eval_score = 21.88
2023-04-19 21:06:43,713 - Detection -   train_loss = 3.1974465996026993
2023-04-19 21:06:48,737 - Detection - ***** Epoch: 13: Eval results *****
2023-04-19 21:06:48,737 - Detection -   best_eval_score = 21.88
2023-04-19 21:06:48,737 - Detection -   eval_score = 27.99
2023-04-19 21:06:48,737 - Detection -   train_loss = 3.0444398671388626
2023-04-19 21:06:53,758 - Detection - ***** Epoch: 14: Eval results *****
2023-04-19 21:06:53,758 - Detection -   best_eval_score = 27.99
2023-04-19 21:06:53,758 - Detection -   eval_score = 30.94
2023-04-19 21:06:53,758 - Detection -   train_loss = 2.9112013578414917
2023-04-19 21:06:58,767 - Detection - ***** Epoch: 15: Eval results *****
2023-04-19 21:06:58,767 - Detection -   best_eval_score = 30.94
2023-04-19 21:06:58,767 - Detection -   eval_score = 34.85
2023-04-19 21:06:58,767 - Detection -   train_loss = 2.802979990839958
2023-04-19 21:07:03,778 - Detection - ***** Epoch: 16: Eval results *****
2023-04-19 21:07:03,778 - Detection -   best_eval_score = 34.85
2023-04-19 21:07:03,779 - Detection -   eval_score = 38.7
2023-04-19 21:07:03,779 - Detection -   train_loss = 2.706068679690361
2023-04-19 21:07:08,789 - Detection - ***** Epoch: 17: Eval results *****
2023-04-19 21:07:08,789 - Detection -   best_eval_score = 38.7
2023-04-19 21:07:08,789 - Detection -   eval_score = 39.85
2023-04-19 21:07:08,789 - Detection -   train_loss = 2.619335725903511
2023-04-19 21:07:13,797 - Detection - ***** Epoch: 18: Eval results *****
2023-04-19 21:07:13,797 - Detection -   best_eval_score = 39.85
2023-04-19 21:07:13,797 - Detection -   eval_score = 42.47
2023-04-19 21:07:13,797 - Detection -   train_loss = 2.5506518334150314
2023-04-19 21:07:18,806 - Detection - ***** Epoch: 19: Eval results *****
2023-04-19 21:07:18,806 - Detection -   best_eval_score = 42.47
2023-04-19 21:07:18,806 - Detection -   eval_score = 45.05
2023-04-19 21:07:18,806 - Detection -   train_loss = 2.485351860523224
2023-04-19 21:07:23,811 - Detection - ***** Epoch: 20: Eval results *****
2023-04-19 21:07:23,811 - Detection -   best_eval_score = 45.05
2023-04-19 21:07:23,811 - Detection -   eval_score = 45.68
2023-04-19 21:07:23,811 - Detection -   train_loss = 2.429114654660225
2023-04-19 21:07:28,815 - Detection - ***** Epoch: 21: Eval results *****
2023-04-19 21:07:28,816 - Detection -   best_eval_score = 45.68
2023-04-19 21:07:28,816 - Detection -   eval_score = 47.97
2023-04-19 21:07:28,816 - Detection -   train_loss = 2.375350832939148
2023-04-19 21:07:33,818 - Detection - ***** Epoch: 22: Eval results *****
2023-04-19 21:07:33,818 - Detection -   best_eval_score = 47.97
2023-04-19 21:07:33,818 - Detection -   eval_score = 49.09
2023-04-19 21:07:33,818 - Detection -   train_loss = 2.3278605192899704
2023-04-19 21:07:38,821 - Detection - ***** Epoch: 23: Eval results *****
2023-04-19 21:07:38,821 - Detection -   best_eval_score = 49.09
2023-04-19 21:07:38,821 - Detection -   eval_score = 49.53
2023-04-19 21:07:38,821 - Detection -   train_loss = 2.2839176058769226
2023-04-19 21:07:43,827 - Detection - ***** Epoch: 24: Eval results *****
2023-04-19 21:07:43,827 - Detection -   best_eval_score = 49.53
2023-04-19 21:07:43,827 - Detection -   eval_score = 50.54
2023-04-19 21:07:43,827 - Detection -   train_loss = 2.2497062534093857
2023-04-19 21:07:48,833 - Detection - ***** Epoch: 25: Eval results *****
2023-04-19 21:07:48,833 - Detection -   best_eval_score = 50.54
2023-04-19 21:07:48,833 - Detection -   eval_score = 51.79
2023-04-19 21:07:48,833 - Detection -   train_loss = 2.205654516816139
2023-04-19 21:07:53,836 - Detection - ***** Epoch: 26: Eval results *****
2023-04-19 21:07:53,836 - Detection -   best_eval_score = 51.79
2023-04-19 21:07:53,836 - Detection -   eval_score = 51.69
2023-04-19 21:07:53,836 - Detection -   train_loss = 2.170791119337082
2023-04-19 21:07:58,829 - Detection - ***** Epoch: 27: Eval results *****
2023-04-19 21:07:58,829 - Detection -   best_eval_score = 51.79
2023-04-19 21:07:58,829 - Detection -   eval_score = 53.56
2023-04-19 21:07:58,829 - Detection -   train_loss = 2.144255682826042
2023-04-19 21:08:03,930 - Detection - ***** Epoch: 28: Eval results *****
2023-04-19 21:08:03,930 - Detection -   best_eval_score = 53.56
2023-04-19 21:08:03,930 - Detection -   eval_score = 54.33
2023-04-19 21:08:03,930 - Detection -   train_loss = 2.117135688662529
2023-04-19 21:08:08,928 - Detection - ***** Epoch: 29: Eval results *****
2023-04-19 21:08:08,928 - Detection -   best_eval_score = 54.33
2023-04-19 21:08:08,928 - Detection -   eval_score = 54.49
2023-04-19 21:08:08,928 - Detection -   train_loss = 2.086538352072239
2023-04-19 21:08:13,925 - Detection - ***** Epoch: 30: Eval results *****
2023-04-19 21:08:13,925 - Detection -   best_eval_score = 54.49
2023-04-19 21:08:13,925 - Detection -   eval_score = 54.77
2023-04-19 21:08:13,925 - Detection -   train_loss = 2.061378888785839
2023-04-19 21:08:18,921 - Detection - ***** Epoch: 31: Eval results *****
2023-04-19 21:08:18,921 - Detection -   best_eval_score = 54.77
2023-04-19 21:08:18,921 - Detection -   eval_score = 56.09
2023-04-19 21:08:18,921 - Detection -   train_loss = 2.0383891984820366
2023-04-19 21:08:23,917 - Detection - ***** Epoch: 32: Eval results *****
2023-04-19 21:08:23,917 - Detection -   best_eval_score = 56.09
2023-04-19 21:08:23,917 - Detection -   eval_score = 56.84
2023-04-19 21:08:23,918 - Detection -   train_loss = 2.0126473903656006
2023-04-19 21:08:28,918 - Detection - ***** Epoch: 33: Eval results *****
2023-04-19 21:08:28,918 - Detection -   best_eval_score = 56.84
2023-04-19 21:08:28,918 - Detection -   eval_score = 57.35
2023-04-19 21:08:28,918 - Detection -   train_loss = 1.9938607811927795
2023-04-19 21:08:33,914 - Detection - ***** Epoch: 34: Eval results *****
2023-04-19 21:08:33,914 - Detection -   best_eval_score = 57.35
2023-04-19 21:08:33,914 - Detection -   eval_score = 58.11
2023-04-19 21:08:33,914 - Detection -   train_loss = 1.9699997007846832
2023-04-19 21:08:38,917 - Detection - ***** Epoch: 35: Eval results *****
2023-04-19 21:08:38,917 - Detection -   best_eval_score = 58.11
2023-04-19 21:08:38,917 - Detection -   eval_score = 58.16
2023-04-19 21:08:38,917 - Detection -   train_loss = 1.948516309261322
2023-04-19 21:08:43,915 - Detection - ***** Epoch: 36: Eval results *****
2023-04-19 21:08:43,915 - Detection -   best_eval_score = 58.16
2023-04-19 21:08:43,915 - Detection -   eval_score = 57.94
2023-04-19 21:08:43,915 - Detection -   train_loss = 1.9325991868972778
2023-04-19 21:08:48,899 - Detection - ***** Epoch: 37: Eval results *****
2023-04-19 21:08:48,899 - Detection -   best_eval_score = 58.16
2023-04-19 21:08:48,899 - Detection -   eval_score = 57.8
2023-04-19 21:08:48,899 - Detection -   train_loss = 1.917407564818859
2023-04-19 21:08:53,880 - Detection - ***** Epoch: 38: Eval results *****
2023-04-19 21:08:53,880 - Detection -   best_eval_score = 58.16
2023-04-19 21:08:53,880 - Detection -   eval_score = 58.86
2023-04-19 21:08:53,880 - Detection -   train_loss = 1.895474724471569
2023-04-19 21:08:58,879 - Detection - ***** Epoch: 39: Eval results *****
2023-04-19 21:08:58,880 - Detection -   best_eval_score = 58.86
2023-04-19 21:08:58,880 - Detection -   eval_score = 59.52
2023-04-19 21:08:58,880 - Detection -   train_loss = 1.8855565637350082
2023-04-19 21:09:03,878 - Detection - ***** Epoch: 40: Eval results *****
2023-04-19 21:09:03,878 - Detection -   best_eval_score = 59.52
2023-04-19 21:09:03,878 - Detection -   eval_score = 59.62
2023-04-19 21:09:03,878 - Detection -   train_loss = 1.8701303750276566
2023-04-19 21:09:08,876 - Detection - ***** Epoch: 41: Eval results *****
2023-04-19 21:09:08,876 - Detection -   best_eval_score = 59.62
2023-04-19 21:09:08,876 - Detection -   eval_score = 59.91
2023-04-19 21:09:08,876 - Detection -   train_loss = 1.853660874068737
2023-04-19 21:09:13,868 - Detection - ***** Epoch: 42: Eval results *****
2023-04-19 21:09:13,868 - Detection -   best_eval_score = 59.91
2023-04-19 21:09:13,868 - Detection -   eval_score = 59.25
2023-04-19 21:09:13,868 - Detection -   train_loss = 1.8387829139828682
2023-04-19 21:09:18,847 - Detection - ***** Epoch: 43: Eval results *****
2023-04-19 21:09:18,847 - Detection -   best_eval_score = 59.91
2023-04-19 21:09:18,847 - Detection -   eval_score = 60.56
2023-04-19 21:09:18,847 - Detection -   train_loss = 1.8287282809615135
2023-04-19 21:09:23,840 - Detection - ***** Epoch: 44: Eval results *****
2023-04-19 21:09:23,840 - Detection -   best_eval_score = 60.56
2023-04-19 21:09:23,840 - Detection -   eval_score = 60.69
2023-04-19 21:09:23,840 - Detection -   train_loss = 1.8180653750896454
2023-04-19 21:09:28,842 - Detection - ***** Epoch: 45: Eval results *****
2023-04-19 21:09:28,842 - Detection -   best_eval_score = 60.69
2023-04-19 21:09:28,842 - Detection -   eval_score = 61.07
2023-04-19 21:09:28,842 - Detection -   train_loss = 1.8074591532349586
2023-04-19 21:09:33,841 - Detection - ***** Epoch: 46: Eval results *****
2023-04-19 21:09:33,841 - Detection -   best_eval_score = 61.07
2023-04-19 21:09:33,841 - Detection -   eval_score = 61.26
2023-04-19 21:09:33,841 - Detection -   train_loss = 1.7901785373687744
2023-04-19 21:09:38,937 - Detection - ***** Epoch: 47: Eval results *****
2023-04-19 21:09:38,937 - Detection -   best_eval_score = 61.26
2023-04-19 21:09:38,937 - Detection -   eval_score = 61.23
2023-04-19 21:09:38,937 - Detection -   train_loss = 1.7823516950011253
2023-04-19 21:09:43,918 - Detection - ***** Epoch: 48: Eval results *****
2023-04-19 21:09:43,918 - Detection -   best_eval_score = 61.26
2023-04-19 21:09:43,918 - Detection -   eval_score = 61.49
2023-04-19 21:09:43,918 - Detection -   train_loss = 1.7691963613033295
2023-04-19 21:09:48,915 - Detection - ***** Epoch: 49: Eval results *****
2023-04-19 21:09:48,915 - Detection -   best_eval_score = 61.49
2023-04-19 21:09:48,915 - Detection -   eval_score = 61.91
2023-04-19 21:09:48,915 - Detection -   train_loss = 1.7625853046774864
2023-04-19 21:09:53,912 - Detection - ***** Epoch: 50: Eval results *****
2023-04-19 21:09:53,912 - Detection -   best_eval_score = 61.91
2023-04-19 21:09:53,912 - Detection -   eval_score = 62.08
2023-04-19 21:09:53,912 - Detection -   train_loss = 1.7490114942193031
2023-04-19 21:09:58,906 - Detection - ***** Epoch: 51: Eval results *****
2023-04-19 21:09:58,906 - Detection -   best_eval_score = 62.08
2023-04-19 21:09:58,906 - Detection -   eval_score = 62.07
2023-04-19 21:09:58,906 - Detection -   train_loss = 1.7371248677372932
2023-04-19 21:10:03,894 - Detection - ***** Epoch: 52: Eval results *****
2023-04-19 21:10:03,894 - Detection -   best_eval_score = 62.08
2023-04-19 21:10:03,894 - Detection -   eval_score = 62.32
2023-04-19 21:10:03,894 - Detection -   train_loss = 1.7349430993199348
2023-04-19 21:10:08,891 - Detection - ***** Epoch: 53: Eval results *****
2023-04-19 21:10:08,892 - Detection -   best_eval_score = 62.32
2023-04-19 21:10:08,892 - Detection -   eval_score = 62.33
2023-04-19 21:10:08,892 - Detection -   train_loss = 1.7253570929169655
2023-04-19 21:10:13,891 - Detection - ***** Epoch: 54: Eval results *****
2023-04-19 21:10:13,891 - Detection -   best_eval_score = 62.33
2023-04-19 21:10:13,891 - Detection -   eval_score = 62.72
2023-04-19 21:10:13,891 - Detection -   train_loss = 1.7123910412192345
2023-04-19 21:10:18,894 - Detection - ***** Epoch: 55: Eval results *****
2023-04-19 21:10:18,894 - Detection -   best_eval_score = 62.72
2023-04-19 21:10:18,894 - Detection -   eval_score = 63.56
2023-04-19 21:10:18,894 - Detection -   train_loss = 1.7053620368242264
2023-04-19 21:10:23,890 - Detection - ***** Epoch: 56: Eval results *****
2023-04-19 21:10:23,891 - Detection -   best_eval_score = 63.56
2023-04-19 21:10:23,891 - Detection -   eval_score = 63.24
2023-04-19 21:10:23,891 - Detection -   train_loss = 1.6967591419816017
2023-04-19 21:10:28,875 - Detection - ***** Epoch: 57: Eval results *****
2023-04-19 21:10:28,875 - Detection -   best_eval_score = 63.56
2023-04-19 21:10:28,875 - Detection -   eval_score = 63.67
2023-04-19 21:10:28,875 - Detection -   train_loss = 1.694642297923565
2023-04-19 21:10:33,869 - Detection - ***** Epoch: 58: Eval results *****
2023-04-19 21:10:33,869 - Detection -   best_eval_score = 63.67
2023-04-19 21:10:33,869 - Detection -   eval_score = 63.37
2023-04-19 21:10:33,869 - Detection -   train_loss = 1.6849920973181725
2023-04-19 21:10:38,857 - Detection - ***** Epoch: 59: Eval results *****
2023-04-19 21:10:38,857 - Detection -   best_eval_score = 63.67
2023-04-19 21:10:38,857 - Detection -   eval_score = 63.33
2023-04-19 21:10:38,857 - Detection -   train_loss = 1.6805153414607048
2023-04-19 21:10:43,839 - Detection - ***** Epoch: 60: Eval results *****
2023-04-19 21:10:43,839 - Detection -   best_eval_score = 63.67
2023-04-19 21:10:43,839 - Detection -   eval_score = 63.77
2023-04-19 21:10:43,839 - Detection -   train_loss = 1.6730474904179573
2023-04-19 21:10:48,834 - Detection - ***** Epoch: 61: Eval results *****
2023-04-19 21:10:48,834 - Detection -   best_eval_score = 63.77
2023-04-19 21:10:48,834 - Detection -   eval_score = 63.79
2023-04-19 21:10:48,834 - Detection -   train_loss = 1.6662393137812614
2023-04-19 21:10:53,827 - Detection - ***** Epoch: 62: Eval results *****
2023-04-19 21:10:53,827 - Detection -   best_eval_score = 63.79
2023-04-19 21:10:53,827 - Detection -   eval_score = 63.61
2023-04-19 21:10:53,828 - Detection -   train_loss = 1.6548670306801796
2023-04-19 21:10:58,812 - Detection - ***** Epoch: 63: Eval results *****
2023-04-19 21:10:58,812 - Detection -   best_eval_score = 63.79
2023-04-19 21:10:58,812 - Detection -   eval_score = 63.92
2023-04-19 21:10:58,812 - Detection -   train_loss = 1.6567786857485771
2023-04-19 21:11:03,814 - Detection - ***** Epoch: 64: Eval results *****
2023-04-19 21:11:03,814 - Detection -   best_eval_score = 63.92
2023-04-19 21:11:03,814 - Detection -   eval_score = 63.89
2023-04-19 21:11:03,814 - Detection -   train_loss = 1.650992639362812
2023-04-19 21:11:08,803 - Detection - ***** Epoch: 65: Eval results *****
2023-04-19 21:11:08,803 - Detection -   best_eval_score = 63.92
2023-04-19 21:11:08,803 - Detection -   eval_score = 63.75
2023-04-19 21:11:08,803 - Detection -   train_loss = 1.6451454386115074
2023-04-19 21:11:13,792 - Detection - ***** Epoch: 66: Eval results *****
2023-04-19 21:11:13,792 - Detection -   best_eval_score = 63.92
2023-04-19 21:11:13,792 - Detection -   eval_score = 64.52
2023-04-19 21:11:13,792 - Detection -   train_loss = 1.6376298144459724
2023-04-19 21:11:18,789 - Detection - ***** Epoch: 67: Eval results *****
2023-04-19 21:11:18,789 - Detection -   best_eval_score = 64.52
2023-04-19 21:11:18,789 - Detection -   eval_score = 64.35
2023-04-19 21:11:18,789 - Detection -   train_loss = 1.6359897777438164
2023-04-19 21:11:23,772 - Detection - ***** Epoch: 68: Eval results *****
2023-04-19 21:11:23,772 - Detection -   best_eval_score = 64.52
2023-04-19 21:11:23,772 - Detection -   eval_score = 64.64
2023-04-19 21:11:23,772 - Detection -   train_loss = 1.6279061287641525
2023-04-19 21:11:28,769 - Detection - ***** Epoch: 69: Eval results *****
2023-04-19 21:11:28,769 - Detection -   best_eval_score = 64.64
2023-04-19 21:11:28,769 - Detection -   eval_score = 64.86
2023-04-19 21:11:28,769 - Detection -   train_loss = 1.621875360608101
2023-04-19 21:11:33,866 - Detection - ***** Epoch: 70: Eval results *****
2023-04-19 21:11:33,866 - Detection -   best_eval_score = 64.86
2023-04-19 21:11:33,866 - Detection -   eval_score = 64.77
2023-04-19 21:11:33,866 - Detection -   train_loss = 1.6242472380399704
2023-04-19 21:11:38,848 - Detection - ***** Epoch: 71: Eval results *****
2023-04-19 21:11:38,848 - Detection -   best_eval_score = 64.86
2023-04-19 21:11:38,848 - Detection -   eval_score = 64.87
2023-04-19 21:11:38,848 - Detection -   train_loss = 1.6180866062641144
2023-04-19 21:11:43,844 - Detection - ***** Epoch: 72: Eval results *****
2023-04-19 21:11:43,844 - Detection -   best_eval_score = 64.87
2023-04-19 21:11:43,844 - Detection -   eval_score = 64.88
2023-04-19 21:11:43,844 - Detection -   train_loss = 1.6122029796242714
2023-04-19 21:11:48,840 - Detection - ***** Epoch: 73: Eval results *****
2023-04-19 21:11:48,840 - Detection -   best_eval_score = 64.88
2023-04-19 21:11:48,840 - Detection -   eval_score = 65.25
2023-04-19 21:11:48,840 - Detection -   train_loss = 1.6065873876214027
2023-04-19 21:11:53,832 - Detection - ***** Epoch: 74: Eval results *****
2023-04-19 21:11:53,832 - Detection -   best_eval_score = 65.25
2023-04-19 21:11:53,832 - Detection -   eval_score = 65.22
2023-04-19 21:11:53,832 - Detection -   train_loss = 1.6060954332351685
2023-04-19 21:11:58,813 - Detection - ***** Epoch: 75: Eval results *****
2023-04-19 21:11:58,813 - Detection -   best_eval_score = 65.25
2023-04-19 21:11:58,813 - Detection -   eval_score = 65.09
2023-04-19 21:11:58,813 - Detection -   train_loss = 1.604396291077137
2023-04-19 21:12:03,803 - Detection - ***** Epoch: 76: Eval results *****
2023-04-19 21:12:03,803 - Detection -   best_eval_score = 65.25
2023-04-19 21:12:03,803 - Detection -   eval_score = 65.02
2023-04-19 21:12:03,803 - Detection -   train_loss = 1.6041143238544464
2023-04-19 21:12:08,793 - Detection - ***** Epoch: 77: Eval results *****
2023-04-19 21:12:08,793 - Detection -   best_eval_score = 65.25
2023-04-19 21:12:08,793 - Detection -   eval_score = 65.28
2023-04-19 21:12:08,793 - Detection -   train_loss = 1.6008523032069206
2023-04-19 21:12:13,788 - Detection - ***** Epoch: 78: Eval results *****
2023-04-19 21:12:13,788 - Detection -   best_eval_score = 65.28
2023-04-19 21:12:13,788 - Detection -   eval_score = 65.02
2023-04-19 21:12:13,788 - Detection -   train_loss = 1.59868822991848
2023-04-19 21:12:18,770 - Detection - ***** Epoch: 79: Eval results *****
2023-04-19 21:12:18,770 - Detection -   best_eval_score = 65.28
2023-04-19 21:12:18,770 - Detection -   eval_score = 64.98
2023-04-19 21:12:18,770 - Detection -   train_loss = 1.5902590453624725
2023-04-19 21:12:23,751 - Detection - ***** Epoch: 80: Eval results *****
2023-04-19 21:12:23,751 - Detection -   best_eval_score = 65.28
2023-04-19 21:12:23,751 - Detection -   eval_score = 65.25
2023-04-19 21:12:23,751 - Detection -   train_loss = 1.591786228120327
2023-04-19 21:12:28,732 - Detection - ***** Epoch: 81: Eval results *****
2023-04-19 21:12:28,732 - Detection -   best_eval_score = 65.28
2023-04-19 21:12:28,732 - Detection -   eval_score = 64.98
2023-04-19 21:12:28,732 - Detection -   train_loss = 1.589867815375328
2023-04-19 21:12:33,715 - Detection - ***** Epoch: 82: Eval results *****
2023-04-19 21:12:33,715 - Detection -   best_eval_score = 65.28
2023-04-19 21:12:33,715 - Detection -   eval_score = 65.38
2023-04-19 21:12:33,715 - Detection -   train_loss = 1.5864176601171494
2023-04-19 21:12:38,710 - Detection - ***** Epoch: 83: Eval results *****
2023-04-19 21:12:38,710 - Detection -   best_eval_score = 65.38
2023-04-19 21:12:38,710 - Detection -   eval_score = 65.97
2023-04-19 21:12:38,710 - Detection -   train_loss = 1.5869119986891747
2023-04-19 21:12:43,705 - Detection - ***** Epoch: 84: Eval results *****
2023-04-19 21:12:43,706 - Detection -   best_eval_score = 65.97
2023-04-19 21:12:43,706 - Detection -   eval_score = 65.34
2023-04-19 21:12:43,706 - Detection -   train_loss = 1.5838169902563095
2023-04-19 21:12:48,687 - Detection - ***** Epoch: 85: Eval results *****
2023-04-19 21:12:48,687 - Detection -   best_eval_score = 65.97
2023-04-19 21:12:48,687 - Detection -   eval_score = 65.51
2023-04-19 21:12:48,687 - Detection -   train_loss = 1.582071028649807
2023-04-19 21:12:53,669 - Detection - ***** Epoch: 86: Eval results *****
2023-04-19 21:12:53,669 - Detection -   best_eval_score = 65.97
2023-04-19 21:12:53,669 - Detection -   eval_score = 65.5
2023-04-19 21:12:53,669 - Detection -   train_loss = 1.580438755452633
2023-04-19 21:12:58,655 - Detection - ***** Epoch: 87: Eval results *****
2023-04-19 21:12:58,655 - Detection -   best_eval_score = 65.97
2023-04-19 21:12:58,655 - Detection -   eval_score = 65.38
2023-04-19 21:12:58,655 - Detection -   train_loss = 1.5803806856274605
2023-04-19 21:13:03,639 - Detection - ***** Epoch: 88: Eval results *****
2023-04-19 21:13:03,639 - Detection -   best_eval_score = 65.97
2023-04-19 21:13:03,639 - Detection -   eval_score = 65.38
2023-04-19 21:13:03,640 - Detection -   train_loss = 1.579677365720272
2023-04-19 21:13:08,625 - Detection - ***** Epoch: 89: Eval results *****
2023-04-19 21:13:08,625 - Detection -   best_eval_score = 65.97
2023-04-19 21:13:08,625 - Detection -   eval_score = 65.38
2023-04-19 21:13:08,625 - Detection -   train_loss = 1.582422062754631
2023-04-19 21:13:13,607 - Detection - ***** Epoch: 90: Eval results *****
2023-04-19 21:13:13,607 - Detection -   best_eval_score = 65.97
2023-04-19 21:13:13,607 - Detection -   eval_score = 65.25
2023-04-19 21:13:13,607 - Detection -   train_loss = 1.5816356763243675
2023-04-19 21:13:18,591 - Detection - ***** Epoch: 91: Eval results *****
2023-04-19 21:13:18,591 - Detection -   best_eval_score = 65.97
2023-04-19 21:13:18,591 - Detection -   eval_score = 65.84
2023-04-19 21:13:18,591 - Detection -   train_loss = 1.5799370929598808
2023-04-19 21:13:23,575 - Detection - ***** Epoch: 92: Eval results *****
2023-04-19 21:13:23,575 - Detection -   best_eval_score = 65.97
2023-04-19 21:13:23,575 - Detection -   eval_score = 65.84
2023-04-19 21:13:23,575 - Detection -   train_loss = 1.5758406072854996
2023-04-19 21:13:28,558 - Detection - ***** Epoch: 93: Eval results *****
2023-04-19 21:13:28,558 - Detection -   best_eval_score = 65.97
2023-04-19 21:13:28,558 - Detection -   eval_score = 65.83
2023-04-19 21:13:28,558 - Detection -   train_loss = 1.5790216475725174
2023-04-19 21:13:28,559 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_cg_0.75_1.0_bert_disaware_9/models
2023-04-19 21:13:29,106 - Detection - Pre-training finished...
2023-04-19 21:13:29,107 - Detection - Training Begin...
2023-04-19 21:13:32,036 - Detection - ***** Epoch: 1: Eval results *****
2023-04-19 21:13:32,036 - Detection -   best_eval_score = 0
2023-04-19 21:13:32,036 - Detection -   eval_score = 1.85
2023-04-19 21:13:32,036 - Detection -   train_loss = 3.5364820808172226
2023-04-19 21:13:34,967 - Detection - ***** Epoch: 2: Eval results *****
2023-04-19 21:13:34,967 - Detection -   best_eval_score = 1.85
2023-04-19 21:13:34,967 - Detection -   eval_score = 5.96
2023-04-19 21:13:34,967 - Detection -   train_loss = 3.0926318615674973
2023-04-19 21:13:37,899 - Detection - ***** Epoch: 3: Eval results *****
2023-04-19 21:13:37,899 - Detection -   best_eval_score = 5.96
2023-04-19 21:13:37,899 - Detection -   eval_score = 13.44
2023-04-19 21:13:37,899 - Detection -   train_loss = 2.5186264365911484
2023-04-19 21:13:40,830 - Detection - ***** Epoch: 4: Eval results *****
2023-04-19 21:13:40,830 - Detection -   best_eval_score = 13.44
2023-04-19 21:13:40,830 - Detection -   eval_score = 27.17
2023-04-19 21:13:40,830 - Detection -   train_loss = 1.8978232443332672
2023-04-19 21:13:43,759 - Detection - ***** Epoch: 5: Eval results *****
2023-04-19 21:13:43,760 - Detection -   best_eval_score = 27.17
2023-04-19 21:13:43,760 - Detection -   eval_score = 44.97
2023-04-19 21:13:43,760 - Detection -   train_loss = 1.2991952076554298
2023-04-19 21:13:46,691 - Detection - ***** Epoch: 6: Eval results *****
2023-04-19 21:13:46,691 - Detection -   best_eval_score = 44.97
2023-04-19 21:13:46,691 - Detection -   eval_score = 56.62
2023-04-19 21:13:46,691 - Detection -   train_loss = 0.8825574219226837
2023-04-19 21:13:49,624 - Detection - ***** Epoch: 7: Eval results *****
2023-04-19 21:13:49,624 - Detection -   best_eval_score = 56.62
2023-04-19 21:13:49,624 - Detection -   eval_score = 59.56
2023-04-19 21:13:49,624 - Detection -   train_loss = 0.7196115180850029
2023-04-19 21:13:52,555 - Detection - ***** Epoch: 8: Eval results *****
2023-04-19 21:13:52,555 - Detection -   best_eval_score = 59.56
2023-04-19 21:13:52,555 - Detection -   eval_score = 60.46
2023-04-19 21:13:52,555 - Detection -   train_loss = 0.6905193775892258
2023-04-19 21:13:55,486 - Detection - ***** Epoch: 9: Eval results *****
2023-04-19 21:13:55,486 - Detection -   best_eval_score = 60.46
2023-04-19 21:13:55,486 - Detection -   eval_score = 59.92
2023-04-19 21:13:55,486 - Detection -   train_loss = 0.6848175264894962
2023-04-19 21:13:58,418 - Detection - ***** Epoch: 10: Eval results *****
2023-04-19 21:13:58,418 - Detection -   best_eval_score = 60.46
2023-04-19 21:13:58,418 - Detection -   eval_score = 59.76
2023-04-19 21:13:58,418 - Detection -   train_loss = 0.6742650605738163
2023-04-19 21:14:01,350 - Detection - ***** Epoch: 11: Eval results *****
2023-04-19 21:14:01,350 - Detection -   best_eval_score = 60.46
2023-04-19 21:14:01,350 - Detection -   eval_score = 60.14
2023-04-19 21:14:01,350 - Detection -   train_loss = 0.6740151718258858
2023-04-19 21:14:04,284 - Detection - ***** Epoch: 12: Eval results *****
2023-04-19 21:14:04,284 - Detection -   best_eval_score = 60.46
2023-04-19 21:14:04,284 - Detection -   eval_score = 59.48
2023-04-19 21:14:04,284 - Detection -   train_loss = 0.6856484301388264
2023-04-19 21:14:07,216 - Detection - ***** Epoch: 13: Eval results *****
2023-04-19 21:14:07,216 - Detection -   best_eval_score = 60.46
2023-04-19 21:14:07,216 - Detection -   eval_score = 59.7
2023-04-19 21:14:07,216 - Detection -   train_loss = 0.6630520895123482
2023-04-19 21:14:10,151 - Detection - ***** Epoch: 14: Eval results *****
2023-04-19 21:14:10,151 - Detection -   best_eval_score = 60.46
2023-04-19 21:14:10,151 - Detection -   eval_score = 60.26
2023-04-19 21:14:10,151 - Detection -   train_loss = 0.6701669916510582
2023-04-19 21:14:13,085 - Detection - ***** Epoch: 15: Eval results *****
2023-04-19 21:14:13,086 - Detection -   best_eval_score = 60.46
2023-04-19 21:14:13,086 - Detection -   eval_score = 59.63
2023-04-19 21:14:13,086 - Detection -   train_loss = 0.6608800664544106
2023-04-19 21:14:16,017 - Detection - ***** Epoch: 16: Eval results *****
2023-04-19 21:14:16,017 - Detection -   best_eval_score = 60.46
2023-04-19 21:14:16,017 - Detection -   eval_score = 59.79
2023-04-19 21:14:16,017 - Detection -   train_loss = 0.6741711385548115
2023-04-19 21:14:18,950 - Detection - ***** Epoch: 17: Eval results *****
2023-04-19 21:14:18,950 - Detection -   best_eval_score = 60.46
2023-04-19 21:14:18,950 - Detection -   eval_score = 59.77
2023-04-19 21:14:18,950 - Detection -   train_loss = 0.6757273823022842
2023-04-19 21:14:21,882 - Detection - ***** Epoch: 18: Eval results *****
2023-04-19 21:14:21,883 - Detection -   best_eval_score = 60.46
2023-04-19 21:14:21,883 - Detection -   eval_score = 59.53
2023-04-19 21:14:21,883 - Detection -   train_loss = 0.6666449122130871
2023-04-19 21:14:21,884 - Detection - Training Finished...
2023-04-19 21:14:21,884 - Detection - Testing begin...
2023-04-19 21:14:23,793 - Detection - ***** Test: Confusion Matrix *****
2023-04-19 21:14:23,793 - Detection - [[  7   0   0 ...   0   0  13]
 [  0  26   0 ...   0   0   7]
 [  0   0  11 ...   0   0  14]
 ...
 [  0   0   0 ...   0   0   9]
 [  0   0   0 ...   0  18   2]
 [  1   0   0 ...   0   9 372]]
2023-04-19 21:14:23,793 - Detection - ***** Test results *****
2023-04-19 21:14:23,793 - Detection -   Acc = 59.86
2023-04-19 21:14:23,793 - Detection -   F1 = 59.5954
2023-04-19 21:14:23,793 - Detection -   F1-known = 59.7131
2023-04-19 21:14:23,793 - Detection -   F1-open = 52.766
2023-04-19 21:14:23,793 - Detection - Testing finished...
2023-04-19 21:14:23,793 - Detection - Results saved in results/results_DA-ADB.csv
2023-04-19 21:14:23,813 - Detection - Open Intent Detection Finished...
