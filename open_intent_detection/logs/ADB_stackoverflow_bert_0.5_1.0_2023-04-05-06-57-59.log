2023-04-05 06:57:59,226 - Detection - Open Intent Detection Begin...
2023-04-05 06:57:59,226 - Detection - Parameters Initialization...
2023-04-05 06:57:59,227 - Detection - ============================== Params ==============================
2023-04-05 06:57:59,227 - Detection - type:	open_intent_detection
2023-04-05 06:57:59,227 - Detection - logger_name:	Detection
2023-04-05 06:57:59,227 - Detection - log_dir:	logs
2023-04-05 06:57:59,227 - Detection - dataset:	stackoverflow
2023-04-05 06:57:59,227 - Detection - known_cls_ratio:	0.5
2023-04-05 06:57:59,227 - Detection - labeled_ratio:	1.0
2023-04-05 06:57:59,227 - Detection - method:	ADB
2023-04-05 06:57:59,227 - Detection - train:	True
2023-04-05 06:57:59,227 - Detection - pretrain:	True
2023-04-05 06:57:59,227 - Detection - save_model:	True
2023-04-05 06:57:59,227 - Detection - backbone:	bert
2023-04-05 06:57:59,227 - Detection - config_file_name:	ADB
2023-04-05 06:57:59,227 - Detection - seed:	8
2023-04-05 06:57:59,227 - Detection - gpu_id:	0
2023-04-05 06:57:59,227 - Detection - pipe_results_path:	pipe_results
2023-04-05 06:57:59,227 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-05 06:57:59,227 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-05 06:57:59,227 - Detection - model_dir:	models
2023-04-05 06:57:59,227 - Detection - load_pretrained_method:	None
2023-04-05 06:57:59,227 - Detection - result_dir:	results
2023-04-05 06:57:59,227 - Detection - results_file_name:	results_ADB.csv
2023-04-05 06:57:59,227 - Detection - save_results:	True
2023-04-05 06:57:59,227 - Detection - loss_fct:	CrossEntropyLoss
2023-04-05 06:57:59,227 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_0.5_1.0_bert_8
2023-04-05 06:57:59,227 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_0.5_1.0_bert_8/models
2023-04-05 06:57:59,227 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-05 06:57:59,227 - Detection - num_train_epochs:	100
2023-04-05 06:57:59,227 - Detection - num_labels:	None
2023-04-05 06:57:59,227 - Detection - max_seq_length:	None
2023-04-05 06:57:59,227 - Detection - freeze_backbone_parameters:	True
2023-04-05 06:57:59,227 - Detection - feat_dim:	768
2023-04-05 06:57:59,227 - Detection - warmup_proportion:	0.1
2023-04-05 06:57:59,227 - Detection - lr_boundary:	0.05
2023-04-05 06:57:59,227 - Detection - lr:	2e-05
2023-04-05 06:57:59,227 - Detection - activation:	relu
2023-04-05 06:57:59,227 - Detection - train_batch_size:	128
2023-04-05 06:57:59,227 - Detection - eval_batch_size:	64
2023-04-05 06:57:59,227 - Detection - test_batch_size:	64
2023-04-05 06:57:59,227 - Detection - wait_patient:	10
2023-04-05 06:57:59,227 - Detection - ============================== End Params ==============================
2023-04-05 06:57:59,227 - Detection - Data and Model Preparation...
2023-04-05 06:57:59,228 - Detection - The number of known intents is 10
2023-04-05 06:57:59,228 - Detection - Lists of known labels are: ['hibernate', 'oracle', 'haskell', 'sharepoint', 'visual-studio', 'drupal', 'osx', 'bash', 'qt', 'apache']
2023-04-05 06:57:59,267 - Detection - Number of labeled training samples = 6000
2023-04-05 06:57:59,267 - Detection - Number of unlabeled training samples = 6000
2023-04-05 06:57:59,271 - Detection - Number of evaluation samples = 1000
2023-04-05 06:57:59,284 - Detection - Number of testing samples = 6000
2023-04-05 06:58:06,826 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-05 06:58:08,495 - Detection - Pre-training Begin...
2023-04-05 06:58:15,470 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 06:58:15,470 - Detection -   best_eval_score = 0
2023-04-05 06:58:15,470 - Detection -   eval_score = 13.9
2023-04-05 06:58:15,470 - Detection -   train_loss = 2.2998612535760756
2023-04-05 06:58:22,001 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 06:58:22,001 - Detection -   best_eval_score = 13.9
2023-04-05 06:58:22,001 - Detection -   eval_score = 47.1
2023-04-05 06:58:22,001 - Detection -   train_loss = 2.2584288373906563
2023-04-05 06:58:28,718 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 06:58:28,718 - Detection -   best_eval_score = 47.1
2023-04-05 06:58:28,718 - Detection -   eval_score = 54.6
2023-04-05 06:58:28,718 - Detection -   train_loss = 2.1174986235638884
2023-04-05 06:58:35,669 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 06:58:35,669 - Detection -   best_eval_score = 54.6
2023-04-05 06:58:35,669 - Detection -   eval_score = 72.5
2023-04-05 06:58:35,669 - Detection -   train_loss = 1.6618158386108723
2023-04-05 06:58:42,645 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 06:58:42,645 - Detection -   best_eval_score = 72.5
2023-04-05 06:58:42,645 - Detection -   eval_score = 81.6
2023-04-05 06:58:42,645 - Detection -   train_loss = 1.0339539634420516
2023-04-05 06:58:49,636 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 06:58:49,636 - Detection -   best_eval_score = 81.6
2023-04-05 06:58:49,636 - Detection -   eval_score = 84.8
2023-04-05 06:58:49,636 - Detection -   train_loss = 0.6488971177567827
2023-04-05 06:58:56,619 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 06:58:56,619 - Detection -   best_eval_score = 84.8
2023-04-05 06:58:56,619 - Detection -   eval_score = 85.9
2023-04-05 06:58:56,619 - Detection -   train_loss = 0.4982689771246403
2023-04-05 06:59:03,707 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 06:59:03,707 - Detection -   best_eval_score = 85.9
2023-04-05 06:59:03,707 - Detection -   eval_score = 85.7
2023-04-05 06:59:03,707 - Detection -   train_loss = 0.4262572168669802
2023-04-05 06:59:10,684 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 06:59:10,684 - Detection -   best_eval_score = 85.9
2023-04-05 06:59:10,684 - Detection -   eval_score = 86.9
2023-04-05 06:59:10,684 - Detection -   train_loss = 0.387426569106731
2023-04-05 06:59:17,655 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 06:59:17,655 - Detection -   best_eval_score = 86.9
2023-04-05 06:59:17,655 - Detection -   eval_score = 87.5
2023-04-05 06:59:17,656 - Detection -   train_loss = 0.3498846907564934
2023-04-05 06:59:24,637 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 06:59:24,637 - Detection -   best_eval_score = 87.5
2023-04-05 06:59:24,637 - Detection -   eval_score = 87.9
2023-04-05 06:59:24,638 - Detection -   train_loss = 0.3243099374974028
2023-04-05 06:59:31,620 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 06:59:31,621 - Detection -   best_eval_score = 87.9
2023-04-05 06:59:31,621 - Detection -   eval_score = 88.4
2023-04-05 06:59:31,621 - Detection -   train_loss = 0.29772935997932515
2023-04-05 06:59:38,603 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 06:59:38,603 - Detection -   best_eval_score = 88.4
2023-04-05 06:59:38,603 - Detection -   eval_score = 88.9
2023-04-05 06:59:38,603 - Detection -   train_loss = 0.28269219810658314
2023-04-05 06:59:45,594 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 06:59:45,594 - Detection -   best_eval_score = 88.9
2023-04-05 06:59:45,594 - Detection -   eval_score = 89.6
2023-04-05 06:59:45,594 - Detection -   train_loss = 0.2577308780969457
2023-04-05 06:59:52,584 - Detection - ***** Epoch: 15: Eval results *****
2023-04-05 06:59:52,584 - Detection -   best_eval_score = 89.6
2023-04-05 06:59:52,584 - Detection -   eval_score = 89.0
2023-04-05 06:59:52,584 - Detection -   train_loss = 0.2537538891142987
2023-04-05 06:59:59,551 - Detection - ***** Epoch: 16: Eval results *****
2023-04-05 06:59:59,551 - Detection -   best_eval_score = 89.6
2023-04-05 06:59:59,551 - Detection -   eval_score = 89.3
2023-04-05 06:59:59,551 - Detection -   train_loss = 0.23087625887165678
2023-04-05 07:00:06,537 - Detection - ***** Epoch: 17: Eval results *****
2023-04-05 07:00:06,537 - Detection -   best_eval_score = 89.6
2023-04-05 07:00:06,537 - Detection -   eval_score = 89.0
2023-04-05 07:00:06,537 - Detection -   train_loss = 0.21473271383884104
2023-04-05 07:00:13,534 - Detection - ***** Epoch: 18: Eval results *****
2023-04-05 07:00:13,534 - Detection -   best_eval_score = 89.6
2023-04-05 07:00:13,534 - Detection -   eval_score = 89.0
2023-04-05 07:00:13,534 - Detection -   train_loss = 0.21296656940211642
2023-04-05 07:00:20,506 - Detection - ***** Epoch: 19: Eval results *****
2023-04-05 07:00:20,506 - Detection -   best_eval_score = 89.6
2023-04-05 07:00:20,506 - Detection -   eval_score = 90.0
2023-04-05 07:00:20,506 - Detection -   train_loss = 0.19374996518835108
2023-04-05 07:00:27,477 - Detection - ***** Epoch: 20: Eval results *****
2023-04-05 07:00:27,477 - Detection -   best_eval_score = 90.0
2023-04-05 07:00:27,477 - Detection -   eval_score = 89.2
2023-04-05 07:00:27,477 - Detection -   train_loss = 0.1892786720331679
2023-04-05 07:00:34,419 - Detection - ***** Epoch: 21: Eval results *****
2023-04-05 07:00:34,419 - Detection -   best_eval_score = 90.0
2023-04-05 07:00:34,419 - Detection -   eval_score = 89.2
2023-04-05 07:00:34,419 - Detection -   train_loss = 0.17350843485365522
2023-04-05 07:00:41,342 - Detection - ***** Epoch: 22: Eval results *****
2023-04-05 07:00:41,343 - Detection -   best_eval_score = 90.0
2023-04-05 07:00:41,343 - Detection -   eval_score = 88.9
2023-04-05 07:00:41,343 - Detection -   train_loss = 0.16432491927704912
2023-04-05 07:00:48,282 - Detection - ***** Epoch: 23: Eval results *****
2023-04-05 07:00:48,282 - Detection -   best_eval_score = 90.0
2023-04-05 07:00:48,282 - Detection -   eval_score = 89.3
2023-04-05 07:00:48,282 - Detection -   train_loss = 0.15382291233920037
2023-04-05 07:00:55,213 - Detection - ***** Epoch: 24: Eval results *****
2023-04-05 07:00:55,213 - Detection -   best_eval_score = 90.0
2023-04-05 07:00:55,213 - Detection -   eval_score = 89.6
2023-04-05 07:00:55,213 - Detection -   train_loss = 0.1502106359347384
2023-04-05 07:01:02,150 - Detection - ***** Epoch: 25: Eval results *****
2023-04-05 07:01:02,150 - Detection -   best_eval_score = 90.0
2023-04-05 07:01:02,150 - Detection -   eval_score = 89.3
2023-04-05 07:01:02,150 - Detection -   train_loss = 0.1454428995543338
2023-04-05 07:01:09,081 - Detection - ***** Epoch: 26: Eval results *****
2023-04-05 07:01:09,081 - Detection -   best_eval_score = 90.0
2023-04-05 07:01:09,081 - Detection -   eval_score = 89.3
2023-04-05 07:01:09,081 - Detection -   train_loss = 0.13131456663633914
2023-04-05 07:01:16,006 - Detection - ***** Epoch: 27: Eval results *****
2023-04-05 07:01:16,006 - Detection -   best_eval_score = 90.0
2023-04-05 07:01:16,006 - Detection -   eval_score = 89.5
2023-04-05 07:01:16,006 - Detection -   train_loss = 0.1323565277171896
2023-04-05 07:01:22,931 - Detection - ***** Epoch: 28: Eval results *****
2023-04-05 07:01:22,931 - Detection -   best_eval_score = 90.0
2023-04-05 07:01:22,931 - Detection -   eval_score = 89.8
2023-04-05 07:01:22,931 - Detection -   train_loss = 0.12169033907195355
2023-04-05 07:01:29,845 - Detection - ***** Epoch: 29: Eval results *****
2023-04-05 07:01:29,845 - Detection -   best_eval_score = 90.0
2023-04-05 07:01:29,845 - Detection -   eval_score = 89.4
2023-04-05 07:01:29,845 - Detection -   train_loss = 0.12116739930624658
2023-04-05 07:01:29,845 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_0.5_1.0_bert_8/models
2023-04-05 07:01:30,391 - Detection - Pre-training finished...
2023-04-05 07:01:30,391 - Detection - Training Begin...
2023-04-05 07:01:42,439 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 07:01:42,439 - Detection -   best_eval_score = 0
2023-04-05 07:01:42,439 - Detection -   eval_score = 7.04
2023-04-05 07:01:42,439 - Detection -   train_loss = 7.436192735712579
2023-04-05 07:01:49,287 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 07:01:49,287 - Detection -   best_eval_score = 7.04
2023-04-05 07:01:49,287 - Detection -   eval_score = 58.33
2023-04-05 07:01:49,287 - Detection -   train_loss = 5.153744875116551
2023-04-05 07:01:56,226 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 07:01:56,226 - Detection -   best_eval_score = 58.33
2023-04-05 07:01:56,226 - Detection -   eval_score = 77.67
2023-04-05 07:01:56,226 - Detection -   train_loss = 2.7583790713168206
2023-04-05 07:02:03,068 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 07:02:03,068 - Detection -   best_eval_score = 77.67
2023-04-05 07:02:03,068 - Detection -   eval_score = 79.47
2023-04-05 07:02:03,068 - Detection -   train_loss = 1.6278166289025164
2023-04-05 07:02:09,923 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 07:02:09,923 - Detection -   best_eval_score = 79.47
2023-04-05 07:02:09,923 - Detection -   eval_score = 79.59
2023-04-05 07:02:09,923 - Detection -   train_loss = 1.581983855430116
2023-04-05 07:02:16,774 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 07:02:16,774 - Detection -   best_eval_score = 79.59
2023-04-05 07:02:16,774 - Detection -   eval_score = 79.59
2023-04-05 07:02:16,774 - Detection -   train_loss = 1.5689532376350241
2023-04-05 07:02:23,641 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 07:02:23,641 - Detection -   best_eval_score = 79.59
2023-04-05 07:02:23,641 - Detection -   eval_score = 79.47
2023-04-05 07:02:23,641 - Detection -   train_loss = 1.5725221431001704
2023-04-05 07:02:30,478 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 07:02:30,478 - Detection -   best_eval_score = 79.59
2023-04-05 07:02:30,478 - Detection -   eval_score = 79.59
2023-04-05 07:02:30,478 - Detection -   train_loss = 1.5459240700336212
2023-04-05 07:02:37,341 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 07:02:37,341 - Detection -   best_eval_score = 79.59
2023-04-05 07:02:37,341 - Detection -   eval_score = 79.47
2023-04-05 07:02:37,341 - Detection -   train_loss = 1.55930598492318
2023-04-05 07:02:44,195 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 07:02:44,195 - Detection -   best_eval_score = 79.59
2023-04-05 07:02:44,195 - Detection -   eval_score = 79.47
2023-04-05 07:02:44,195 - Detection -   train_loss = 1.569721282796657
2023-04-05 07:02:51,054 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 07:02:51,054 - Detection -   best_eval_score = 79.59
2023-04-05 07:02:51,054 - Detection -   eval_score = 79.53
2023-04-05 07:02:51,054 - Detection -   train_loss = 1.5721283111166446
2023-04-05 07:02:57,901 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 07:02:57,901 - Detection -   best_eval_score = 79.59
2023-04-05 07:02:57,901 - Detection -   eval_score = 79.53
2023-04-05 07:02:57,901 - Detection -   train_loss = 1.5777505014805084
2023-04-05 07:03:04,766 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 07:03:04,766 - Detection -   best_eval_score = 79.59
2023-04-05 07:03:04,766 - Detection -   eval_score = 79.47
2023-04-05 07:03:04,766 - Detection -   train_loss = 1.5940574179304408
2023-04-05 07:03:11,614 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 07:03:11,614 - Detection -   best_eval_score = 79.59
2023-04-05 07:03:11,614 - Detection -   eval_score = 79.53
2023-04-05 07:03:11,614 - Detection -   train_loss = 1.5654538185038465
2023-04-05 07:03:18,464 - Detection - ***** Epoch: 15: Eval results *****
2023-04-05 07:03:18,464 - Detection -   best_eval_score = 79.59
2023-04-05 07:03:18,464 - Detection -   eval_score = 79.47
2023-04-05 07:03:18,464 - Detection -   train_loss = 1.5571833113406568
2023-04-05 07:03:18,465 - Detection - Training Finished...
2023-04-05 07:03:18,465 - Detection - Testing begin...
2023-04-05 07:03:23,855 - Detection - ***** Test: Confusion Matrix *****
2023-04-05 07:03:23,855 - Detection - [[ 252    2    0    0    0    0    0    0    0    0   46]
 [   0  240    0    1    1    0    0    0    0    0   58]
 [   0    0  230    0    0    0    0    0    0    0   70]
 [   0    0    0  246    2    0    0    0    0    0   52]
 [   0    0    0    1  221    0    1    0    0    1   76]
 [   0    0    0    1    0  256    0    0    0    2   41]
 [   0    1    0    0    0    0  232    0    2    1   64]
 [   0    0    2    0    0    0    5  216    0    1   76]
 [   0    0    0    0    0    0    0    0  277    0   23]
 [   0    0    0    0    0    0    0    1    0  221   78]
 [  29    9   34    7   18    1  120    8    7   48 2719]]
2023-04-05 07:03:23,855 - Detection - ***** Test results *****
2023-04-05 07:03:23,855 - Detection -   Acc = 85.17
2023-04-05 07:03:23,855 - Detection -   F1 = 84.3234
2023-04-05 07:03:23,855 - Detection -   F1-known = 84.1281
2023-04-05 07:03:23,855 - Detection -   F1-open = 86.2764
2023-04-05 07:03:23,855 - Detection - Testing finished...
2023-04-05 07:03:23,855 - Detection - Results saved in results/results_ADB.csv
2023-04-05 07:03:23,875 - Detection - Open Intent Detection Finished...
