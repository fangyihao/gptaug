2023-04-20 18:15:33,883 - Detection - Open Intent Detection Begin...
2023-04-20 18:15:33,883 - Detection - Parameters Initialization...
2023-04-20 18:15:33,883 - Detection - ============================== Params ==============================
2023-04-20 18:15:33,883 - Detection - type:	open_intent_detection
2023-04-20 18:15:33,883 - Detection - logger_name:	Detection
2023-04-20 18:15:33,883 - Detection - log_dir:	logs
2023-04-20 18:15:33,883 - Detection - dataset:	oos_cg
2023-04-20 18:15:33,883 - Detection - known_cls_ratio:	0.5
2023-04-20 18:15:33,883 - Detection - labeled_ratio:	1.0
2023-04-20 18:15:33,883 - Detection - method:	ADB
2023-04-20 18:15:33,884 - Detection - train:	True
2023-04-20 18:15:33,884 - Detection - pretrain:	True
2023-04-20 18:15:33,884 - Detection - save_model:	True
2023-04-20 18:15:33,884 - Detection - backbone:	bert
2023-04-20 18:15:33,884 - Detection - config_file_name:	ADB
2023-04-20 18:15:33,884 - Detection - seed:	6
2023-04-20 18:15:33,884 - Detection - gpu_id:	0
2023-04-20 18:15:33,884 - Detection - pipe_results_path:	pipe_results
2023-04-20 18:15:33,884 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-20 18:15:33,884 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-20 18:15:33,884 - Detection - model_dir:	models
2023-04-20 18:15:33,884 - Detection - load_pretrained_method:	None
2023-04-20 18:15:33,884 - Detection - result_dir:	results
2023-04-20 18:15:33,884 - Detection - results_file_name:	results_ADB.csv
2023-04-20 18:15:33,884 - Detection - save_results:	True
2023-04-20 18:15:33,884 - Detection - loss_fct:	CrossEntropyLoss
2023-04-20 18:15:33,884 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_cg_0.5_1.0_bert_6
2023-04-20 18:15:33,884 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_cg_0.5_1.0_bert_6/models
2023-04-20 18:15:33,884 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-20 18:15:33,884 - Detection - num_train_epochs:	100
2023-04-20 18:15:33,884 - Detection - num_labels:	None
2023-04-20 18:15:33,884 - Detection - max_seq_length:	None
2023-04-20 18:15:33,884 - Detection - freeze_backbone_parameters:	True
2023-04-20 18:15:33,884 - Detection - feat_dim:	768
2023-04-20 18:15:33,884 - Detection - warmup_proportion:	0.1
2023-04-20 18:15:33,884 - Detection - lr_boundary:	0.05
2023-04-20 18:15:33,884 - Detection - lr:	2e-05
2023-04-20 18:15:33,884 - Detection - activation:	relu
2023-04-20 18:15:33,884 - Detection - train_batch_size:	128
2023-04-20 18:15:33,884 - Detection - eval_batch_size:	64
2023-04-20 18:15:33,884 - Detection - test_batch_size:	64
2023-04-20 18:15:33,884 - Detection - wait_patient:	10
2023-04-20 18:15:33,884 - Detection - ============================== End Params ==============================
2023-04-20 18:15:33,884 - Detection - Data and Model Preparation...
2023-04-20 18:15:33,885 - Detection - The number of known intents is 75
2023-04-20 18:15:33,885 - Detection - Lists of known labels are: ['apr', 'sync_device', 'alarm', 'change_speed', 'timezone', 'repeat', 'travel_suggestion', 'exchange_rate', 'user_name', 'improve_credit_score', 'todo_list_update', 'order_checks', 'spending_history', 'uber', 'next_holiday', 'text', 'roll_dice', 'how_busy', 'recipe', 'damaged_card', 'distance', 'thank_you', 'food_last', 'accept_reservations', 'ingredient_substitution', 'mpg', 'plug_type', 'restaurant_reviews', 'credit_score', 'redeem_rewards', 'freeze_account', 'interest_rate', 'cancel_reservation', 'calendar_update', 'travel_notification', 'traffic', 'lost_luggage', 'whisper_mode', 'reminder_update', 'goodbye', 'car_rental', 'restaurant_suggestion', 'min_payment', 'international_visa', 'fun_fact', 'calendar', 'how_old_are_you', 'cook_time', 'definition', 'income', 'tell_joke', 'taxes', 'time', 'balance', 'shopping_list', 'card_declined', 'do_you_have_pets', 'change_accent', 'insurance_change', 'schedule_maintenance', 'pay_bill', 'international_fees', 'report_lost_card', 'reset_settings', 'reminder', 'pto_balance', 'application_status', 'restaurant_reservation', 'calories', 'credit_limit_change', 'pto_request', 'payday', 'what_can_i_ask_you', 'travel_alert', 'who_do_you_work_for']
2023-04-20 18:15:33,902 - Detection - Number of labeled training samples = 1932
2023-04-20 18:15:33,902 - Detection - Number of unlabeled training samples = 1751
2023-04-20 18:15:33,906 - Detection - Number of evaluation samples = 833
2023-04-20 18:15:33,915 - Detection - Number of testing samples = 3632
2023-04-20 18:15:38,006 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-20 18:15:39,673 - Detection - Pre-training Begin...
2023-04-20 18:15:42,048 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 18:15:42,048 - Detection -   best_eval_score = 0
2023-04-20 18:15:42,048 - Detection -   eval_score = 1.2
2023-04-20 18:15:42,048 - Detection -   train_loss = 4.314350336790085
2023-04-20 18:15:43,903 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 18:15:43,903 - Detection -   best_eval_score = 1.2
2023-04-20 18:15:43,903 - Detection -   eval_score = 2.88
2023-04-20 18:15:43,903 - Detection -   train_loss = 4.290548920631409
2023-04-20 18:15:45,726 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 18:15:45,726 - Detection -   best_eval_score = 2.88
2023-04-20 18:15:45,726 - Detection -   eval_score = 4.8
2023-04-20 18:15:45,726 - Detection -   train_loss = 4.245703458786011
2023-04-20 18:15:47,620 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 18:15:47,620 - Detection -   best_eval_score = 4.8
2023-04-20 18:15:47,620 - Detection -   eval_score = 6.0
2023-04-20 18:15:47,620 - Detection -   train_loss = 4.181884437799454
2023-04-20 18:15:49,445 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 18:15:49,445 - Detection -   best_eval_score = 6.0
2023-04-20 18:15:49,445 - Detection -   eval_score = 8.04
2023-04-20 18:15:49,445 - Detection -   train_loss = 4.0435174107551575
2023-04-20 18:15:51,444 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 18:15:51,444 - Detection -   best_eval_score = 8.04
2023-04-20 18:15:51,444 - Detection -   eval_score = 10.8
2023-04-20 18:15:51,444 - Detection -   train_loss = 3.7941716611385345
2023-04-20 18:15:53,284 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 18:15:53,284 - Detection -   best_eval_score = 10.8
2023-04-20 18:15:53,284 - Detection -   eval_score = 12.73
2023-04-20 18:15:53,285 - Detection -   train_loss = 3.4307146668434143
2023-04-20 18:15:55,128 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 18:15:55,128 - Detection -   best_eval_score = 12.73
2023-04-20 18:15:55,128 - Detection -   eval_score = 17.53
2023-04-20 18:15:55,128 - Detection -   train_loss = 2.939137250185013
2023-04-20 18:15:57,042 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 18:15:57,043 - Detection -   best_eval_score = 17.53
2023-04-20 18:15:57,043 - Detection -   eval_score = 24.01
2023-04-20 18:15:57,043 - Detection -   train_loss = 2.4817405492067337
2023-04-20 18:15:58,963 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 18:15:58,963 - Detection -   best_eval_score = 24.01
2023-04-20 18:15:58,963 - Detection -   eval_score = 32.17
2023-04-20 18:15:58,963 - Detection -   train_loss = 2.1291122883558273
2023-04-20 18:16:00,849 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 18:16:00,849 - Detection -   best_eval_score = 32.17
2023-04-20 18:16:00,849 - Detection -   eval_score = 38.3
2023-04-20 18:16:00,849 - Detection -   train_loss = 1.7277498915791512
2023-04-20 18:16:02,783 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 18:16:02,783 - Detection -   best_eval_score = 38.3
2023-04-20 18:16:02,783 - Detection -   eval_score = 45.02
2023-04-20 18:16:02,783 - Detection -   train_loss = 1.4266652800142765
2023-04-20 18:16:04,737 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 18:16:04,737 - Detection -   best_eval_score = 45.02
2023-04-20 18:16:04,737 - Detection -   eval_score = 49.58
2023-04-20 18:16:04,737 - Detection -   train_loss = 1.2068197019398212
2023-04-20 18:16:06,655 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 18:16:06,655 - Detection -   best_eval_score = 49.58
2023-04-20 18:16:06,655 - Detection -   eval_score = 54.62
2023-04-20 18:16:06,655 - Detection -   train_loss = 1.0483551807701588
2023-04-20 18:16:08,656 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 18:16:08,656 - Detection -   best_eval_score = 54.62
2023-04-20 18:16:08,656 - Detection -   eval_score = 56.66
2023-04-20 18:16:08,656 - Detection -   train_loss = 0.8951851706951857
2023-04-20 18:16:10,592 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 18:16:10,592 - Detection -   best_eval_score = 56.66
2023-04-20 18:16:10,592 - Detection -   eval_score = 59.78
2023-04-20 18:16:10,592 - Detection -   train_loss = 0.8003101050853729
2023-04-20 18:16:12,557 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 18:16:12,557 - Detection -   best_eval_score = 59.78
2023-04-20 18:16:12,557 - Detection -   eval_score = 62.18
2023-04-20 18:16:12,557 - Detection -   train_loss = 0.7048724889755249
2023-04-20 18:16:14,568 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 18:16:14,568 - Detection -   best_eval_score = 62.18
2023-04-20 18:16:14,568 - Detection -   eval_score = 63.27
2023-04-20 18:16:14,568 - Detection -   train_loss = 0.6087331175804138
2023-04-20 18:16:16,546 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 18:16:16,546 - Detection -   best_eval_score = 63.27
2023-04-20 18:16:16,546 - Detection -   eval_score = 63.51
2023-04-20 18:16:16,546 - Detection -   train_loss = 0.5619990862905979
2023-04-20 18:16:18,539 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 18:16:18,539 - Detection -   best_eval_score = 63.51
2023-04-20 18:16:18,539 - Detection -   eval_score = 63.87
2023-04-20 18:16:18,539 - Detection -   train_loss = 0.5209775287657976
2023-04-20 18:16:20,508 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 18:16:20,508 - Detection -   best_eval_score = 63.87
2023-04-20 18:16:20,508 - Detection -   eval_score = 67.11
2023-04-20 18:16:20,508 - Detection -   train_loss = 0.4532439149916172
2023-04-20 18:16:22,521 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 18:16:22,521 - Detection -   best_eval_score = 67.11
2023-04-20 18:16:22,521 - Detection -   eval_score = 66.87
2023-04-20 18:16:22,521 - Detection -   train_loss = 0.40606093127280474
2023-04-20 18:16:24,457 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 18:16:24,457 - Detection -   best_eval_score = 67.11
2023-04-20 18:16:24,457 - Detection -   eval_score = 68.07
2023-04-20 18:16:24,457 - Detection -   train_loss = 0.3879661560058594
2023-04-20 18:16:26,467 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 18:16:26,467 - Detection -   best_eval_score = 68.07
2023-04-20 18:16:26,467 - Detection -   eval_score = 69.75
2023-04-20 18:16:26,467 - Detection -   train_loss = 0.35106150805950165
2023-04-20 18:16:28,407 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 18:16:28,408 - Detection -   best_eval_score = 69.75
2023-04-20 18:16:28,408 - Detection -   eval_score = 69.15
2023-04-20 18:16:28,408 - Detection -   train_loss = 0.3261497709900141
2023-04-20 18:16:30,336 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 18:16:30,336 - Detection -   best_eval_score = 69.75
2023-04-20 18:16:30,336 - Detection -   eval_score = 70.35
2023-04-20 18:16:30,336 - Detection -   train_loss = 0.3071787394583225
2023-04-20 18:16:32,380 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 18:16:32,380 - Detection -   best_eval_score = 70.35
2023-04-20 18:16:32,380 - Detection -   eval_score = 72.03
2023-04-20 18:16:32,380 - Detection -   train_loss = 0.29264883045107126
2023-04-20 18:16:34,386 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 18:16:34,386 - Detection -   best_eval_score = 72.03
2023-04-20 18:16:34,386 - Detection -   eval_score = 71.43
2023-04-20 18:16:34,386 - Detection -   train_loss = 0.27471294440329075
2023-04-20 18:16:36,470 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 18:16:36,470 - Detection -   best_eval_score = 72.03
2023-04-20 18:16:36,470 - Detection -   eval_score = 72.03
2023-04-20 18:16:36,470 - Detection -   train_loss = 0.2485678344964981
2023-04-20 18:16:38,476 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 18:16:38,476 - Detection -   best_eval_score = 72.03
2023-04-20 18:16:38,476 - Detection -   eval_score = 71.91
2023-04-20 18:16:38,476 - Detection -   train_loss = 0.23403380252420902
2023-04-20 18:16:40,413 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 18:16:40,413 - Detection -   best_eval_score = 72.03
2023-04-20 18:16:40,413 - Detection -   eval_score = 72.27
2023-04-20 18:16:40,413 - Detection -   train_loss = 0.22455871012061834
2023-04-20 18:16:42,345 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 18:16:42,345 - Detection -   best_eval_score = 72.27
2023-04-20 18:16:42,345 - Detection -   eval_score = 73.23
2023-04-20 18:16:42,345 - Detection -   train_loss = 0.210064637940377
2023-04-20 18:16:44,476 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 18:16:44,476 - Detection -   best_eval_score = 73.23
2023-04-20 18:16:44,476 - Detection -   eval_score = 73.83
2023-04-20 18:16:44,477 - Detection -   train_loss = 0.20329576265066862
2023-04-20 18:16:46,438 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 18:16:46,438 - Detection -   best_eval_score = 73.83
2023-04-20 18:16:46,438 - Detection -   eval_score = 73.95
2023-04-20 18:16:46,438 - Detection -   train_loss = 0.18950879108160734
2023-04-20 18:16:48,414 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 18:16:48,414 - Detection -   best_eval_score = 73.95
2023-04-20 18:16:48,414 - Detection -   eval_score = 73.59
2023-04-20 18:16:48,414 - Detection -   train_loss = 0.18271997850388288
2023-04-20 18:16:50,360 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 18:16:50,360 - Detection -   best_eval_score = 73.95
2023-04-20 18:16:50,360 - Detection -   eval_score = 74.19
2023-04-20 18:16:50,360 - Detection -   train_loss = 0.17067856714129448
2023-04-20 18:16:52,338 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 18:16:52,338 - Detection -   best_eval_score = 74.19
2023-04-20 18:16:52,338 - Detection -   eval_score = 74.31
2023-04-20 18:16:52,338 - Detection -   train_loss = 0.16346863703802228
2023-04-20 18:16:54,316 - Detection - ***** Epoch: 38: Eval results *****
2023-04-20 18:16:54,316 - Detection -   best_eval_score = 74.31
2023-04-20 18:16:54,316 - Detection -   eval_score = 74.43
2023-04-20 18:16:54,316 - Detection -   train_loss = 0.15501505555585027
2023-04-20 18:16:56,273 - Detection - ***** Epoch: 39: Eval results *****
2023-04-20 18:16:56,273 - Detection -   best_eval_score = 74.43
2023-04-20 18:16:56,273 - Detection -   eval_score = 74.55
2023-04-20 18:16:56,273 - Detection -   train_loss = 0.14695068961009383
2023-04-20 18:16:58,319 - Detection - ***** Epoch: 40: Eval results *****
2023-04-20 18:16:58,319 - Detection -   best_eval_score = 74.55
2023-04-20 18:16:58,319 - Detection -   eval_score = 74.67
2023-04-20 18:16:58,319 - Detection -   train_loss = 0.14834879711270332
2023-04-20 18:17:00,269 - Detection - ***** Epoch: 41: Eval results *****
2023-04-20 18:17:00,269 - Detection -   best_eval_score = 74.67
2023-04-20 18:17:00,269 - Detection -   eval_score = 75.03
2023-04-20 18:17:00,269 - Detection -   train_loss = 0.13271168456412852
2023-04-20 18:17:02,218 - Detection - ***** Epoch: 42: Eval results *****
2023-04-20 18:17:02,218 - Detection -   best_eval_score = 75.03
2023-04-20 18:17:02,218 - Detection -   eval_score = 74.91
2023-04-20 18:17:02,218 - Detection -   train_loss = 0.13465159386396408
2023-04-20 18:17:04,154 - Detection - ***** Epoch: 43: Eval results *****
2023-04-20 18:17:04,154 - Detection -   best_eval_score = 75.03
2023-04-20 18:17:04,154 - Detection -   eval_score = 75.15
2023-04-20 18:17:04,154 - Detection -   train_loss = 0.12674941588193178
2023-04-20 18:17:06,098 - Detection - ***** Epoch: 44: Eval results *****
2023-04-20 18:17:06,098 - Detection -   best_eval_score = 75.15
2023-04-20 18:17:06,098 - Detection -   eval_score = 75.15
2023-04-20 18:17:06,098 - Detection -   train_loss = 0.12424461636692286
2023-04-20 18:17:08,027 - Detection - ***** Epoch: 45: Eval results *****
2023-04-20 18:17:08,027 - Detection -   best_eval_score = 75.15
2023-04-20 18:17:08,027 - Detection -   eval_score = 75.03
2023-04-20 18:17:08,027 - Detection -   train_loss = 0.119246996473521
2023-04-20 18:17:09,971 - Detection - ***** Epoch: 46: Eval results *****
2023-04-20 18:17:09,971 - Detection -   best_eval_score = 75.15
2023-04-20 18:17:09,971 - Detection -   eval_score = 75.51
2023-04-20 18:17:09,971 - Detection -   train_loss = 0.11356534669175744
2023-04-20 18:17:11,916 - Detection - ***** Epoch: 47: Eval results *****
2023-04-20 18:17:11,916 - Detection -   best_eval_score = 75.51
2023-04-20 18:17:11,916 - Detection -   eval_score = 75.75
2023-04-20 18:17:11,916 - Detection -   train_loss = 0.12460046401247382
2023-04-20 18:17:13,863 - Detection - ***** Epoch: 48: Eval results *****
2023-04-20 18:17:13,863 - Detection -   best_eval_score = 75.75
2023-04-20 18:17:13,863 - Detection -   eval_score = 76.71
2023-04-20 18:17:13,863 - Detection -   train_loss = 0.10920599661767483
2023-04-20 18:17:15,810 - Detection - ***** Epoch: 49: Eval results *****
2023-04-20 18:17:15,810 - Detection -   best_eval_score = 76.71
2023-04-20 18:17:15,810 - Detection -   eval_score = 76.59
2023-04-20 18:17:15,810 - Detection -   train_loss = 0.11194354621693492
2023-04-20 18:17:17,745 - Detection - ***** Epoch: 50: Eval results *****
2023-04-20 18:17:17,745 - Detection -   best_eval_score = 76.71
2023-04-20 18:17:17,745 - Detection -   eval_score = 76.35
2023-04-20 18:17:17,745 - Detection -   train_loss = 0.10359661653637886
2023-04-20 18:17:19,680 - Detection - ***** Epoch: 51: Eval results *****
2023-04-20 18:17:19,680 - Detection -   best_eval_score = 76.71
2023-04-20 18:17:19,680 - Detection -   eval_score = 76.83
2023-04-20 18:17:19,680 - Detection -   train_loss = 0.10321982856839895
2023-04-20 18:17:21,636 - Detection - ***** Epoch: 52: Eval results *****
2023-04-20 18:17:21,636 - Detection -   best_eval_score = 76.83
2023-04-20 18:17:21,636 - Detection -   eval_score = 76.59
2023-04-20 18:17:21,637 - Detection -   train_loss = 0.10162735125049949
2023-04-20 18:17:23,562 - Detection - ***** Epoch: 53: Eval results *****
2023-04-20 18:17:23,562 - Detection -   best_eval_score = 76.83
2023-04-20 18:17:23,562 - Detection -   eval_score = 76.47
2023-04-20 18:17:23,562 - Detection -   train_loss = 0.09569358639419079
2023-04-20 18:17:25,521 - Detection - ***** Epoch: 54: Eval results *****
2023-04-20 18:17:25,522 - Detection -   best_eval_score = 76.83
2023-04-20 18:17:25,522 - Detection -   eval_score = 76.47
2023-04-20 18:17:25,522 - Detection -   train_loss = 0.0982881891541183
2023-04-20 18:17:27,487 - Detection - ***** Epoch: 55: Eval results *****
2023-04-20 18:17:27,487 - Detection -   best_eval_score = 76.83
2023-04-20 18:17:27,487 - Detection -   eval_score = 76.35
2023-04-20 18:17:27,487 - Detection -   train_loss = 0.08818109123967588
2023-04-20 18:17:29,417 - Detection - ***** Epoch: 56: Eval results *****
2023-04-20 18:17:29,417 - Detection -   best_eval_score = 76.83
2023-04-20 18:17:29,417 - Detection -   eval_score = 76.23
2023-04-20 18:17:29,417 - Detection -   train_loss = 0.08773916680365801
2023-04-20 18:17:31,339 - Detection - ***** Epoch: 57: Eval results *****
2023-04-20 18:17:31,339 - Detection -   best_eval_score = 76.83
2023-04-20 18:17:31,339 - Detection -   eval_score = 76.83
2023-04-20 18:17:31,339 - Detection -   train_loss = 0.09017004678025842
2023-04-20 18:17:33,262 - Detection - ***** Epoch: 58: Eval results *****
2023-04-20 18:17:33,262 - Detection -   best_eval_score = 76.83
2023-04-20 18:17:33,262 - Detection -   eval_score = 77.43
2023-04-20 18:17:33,262 - Detection -   train_loss = 0.08360851835459471
2023-04-20 18:17:35,196 - Detection - ***** Epoch: 59: Eval results *****
2023-04-20 18:17:35,196 - Detection -   best_eval_score = 77.43
2023-04-20 18:17:35,196 - Detection -   eval_score = 77.55
2023-04-20 18:17:35,196 - Detection -   train_loss = 0.08125929138623178
2023-04-20 18:17:37,127 - Detection - ***** Epoch: 60: Eval results *****
2023-04-20 18:17:37,128 - Detection -   best_eval_score = 77.55
2023-04-20 18:17:37,128 - Detection -   eval_score = 77.55
2023-04-20 18:17:37,128 - Detection -   train_loss = 0.08317620074376464
2023-04-20 18:17:39,064 - Detection - ***** Epoch: 61: Eval results *****
2023-04-20 18:17:39,064 - Detection -   best_eval_score = 77.55
2023-04-20 18:17:39,064 - Detection -   eval_score = 77.91
2023-04-20 18:17:39,064 - Detection -   train_loss = 0.08329631667584181
2023-04-20 18:17:40,998 - Detection - ***** Epoch: 62: Eval results *****
2023-04-20 18:17:40,998 - Detection -   best_eval_score = 77.91
2023-04-20 18:17:40,998 - Detection -   eval_score = 77.91
2023-04-20 18:17:40,998 - Detection -   train_loss = 0.07982215192168951
2023-04-20 18:17:42,922 - Detection - ***** Epoch: 63: Eval results *****
2023-04-20 18:17:42,922 - Detection -   best_eval_score = 77.91
2023-04-20 18:17:42,922 - Detection -   eval_score = 77.31
2023-04-20 18:17:42,922 - Detection -   train_loss = 0.07763142348267138
2023-04-20 18:17:44,846 - Detection - ***** Epoch: 64: Eval results *****
2023-04-20 18:17:44,846 - Detection -   best_eval_score = 77.91
2023-04-20 18:17:44,846 - Detection -   eval_score = 77.79
2023-04-20 18:17:44,846 - Detection -   train_loss = 0.0789602529257536
2023-04-20 18:17:46,786 - Detection - ***** Epoch: 65: Eval results *****
2023-04-20 18:17:46,786 - Detection -   best_eval_score = 77.91
2023-04-20 18:17:46,786 - Detection -   eval_score = 77.55
2023-04-20 18:17:46,786 - Detection -   train_loss = 0.07888604677282274
2023-04-20 18:17:48,713 - Detection - ***** Epoch: 66: Eval results *****
2023-04-20 18:17:48,713 - Detection -   best_eval_score = 77.91
2023-04-20 18:17:48,713 - Detection -   eval_score = 77.91
2023-04-20 18:17:48,713 - Detection -   train_loss = 0.07676539057865739
2023-04-20 18:17:50,655 - Detection - ***** Epoch: 67: Eval results *****
2023-04-20 18:17:50,656 - Detection -   best_eval_score = 77.91
2023-04-20 18:17:50,656 - Detection -   eval_score = 77.91
2023-04-20 18:17:50,656 - Detection -   train_loss = 0.07474660384468734
2023-04-20 18:17:52,586 - Detection - ***** Epoch: 68: Eval results *****
2023-04-20 18:17:52,587 - Detection -   best_eval_score = 77.91
2023-04-20 18:17:52,587 - Detection -   eval_score = 77.79
2023-04-20 18:17:52,587 - Detection -   train_loss = 0.07076009036973119
2023-04-20 18:17:54,516 - Detection - ***** Epoch: 69: Eval results *****
2023-04-20 18:17:54,516 - Detection -   best_eval_score = 77.91
2023-04-20 18:17:54,516 - Detection -   eval_score = 77.67
2023-04-20 18:17:54,516 - Detection -   train_loss = 0.06956968060694635
2023-04-20 18:17:56,445 - Detection - ***** Epoch: 70: Eval results *****
2023-04-20 18:17:56,445 - Detection -   best_eval_score = 77.91
2023-04-20 18:17:56,445 - Detection -   eval_score = 77.91
2023-04-20 18:17:56,445 - Detection -   train_loss = 0.0711890950333327
2023-04-20 18:17:58,373 - Detection - ***** Epoch: 71: Eval results *****
2023-04-20 18:17:58,373 - Detection -   best_eval_score = 77.91
2023-04-20 18:17:58,373 - Detection -   eval_score = 77.79
2023-04-20 18:17:58,373 - Detection -   train_loss = 0.06737665575928986
2023-04-20 18:17:58,374 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_cg_0.5_1.0_bert_6/models
2023-04-20 18:17:58,926 - Detection - Pre-training finished...
2023-04-20 18:17:58,926 - Detection - Training Begin...
2023-04-20 18:18:02,066 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 18:18:02,067 - Detection -   best_eval_score = 0
2023-04-20 18:18:02,067 - Detection -   eval_score = 0.0
2023-04-20 18:18:02,067 - Detection -   train_loss = 11.665963590145111
2023-04-20 18:18:03,986 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 18:18:03,986 - Detection -   best_eval_score = 0
2023-04-20 18:18:03,986 - Detection -   eval_score = 0.0
2023-04-20 18:18:03,986 - Detection -   train_loss = 11.20450246334076
2023-04-20 18:18:06,078 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 18:18:06,078 - Detection -   best_eval_score = 0
2023-04-20 18:18:06,078 - Detection -   eval_score = 0.0
2023-04-20 18:18:06,078 - Detection -   train_loss = 10.745267152786255
2023-04-20 18:18:07,988 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 18:18:07,988 - Detection -   best_eval_score = 0
2023-04-20 18:18:07,988 - Detection -   eval_score = 0.44
2023-04-20 18:18:07,988 - Detection -   train_loss = 10.076480388641357
2023-04-20 18:18:09,914 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 18:18:09,914 - Detection -   best_eval_score = 0.44
2023-04-20 18:18:09,914 - Detection -   eval_score = 0.44
2023-04-20 18:18:09,914 - Detection -   train_loss = 9.484130859375
2023-04-20 18:18:11,824 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 18:18:11,824 - Detection -   best_eval_score = 0.44
2023-04-20 18:18:11,824 - Detection -   eval_score = 0.44
2023-04-20 18:18:11,824 - Detection -   train_loss = 8.755664885044098
2023-04-20 18:18:13,739 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 18:18:13,739 - Detection -   best_eval_score = 0.44
2023-04-20 18:18:13,739 - Detection -   eval_score = 0.66
2023-04-20 18:18:13,739 - Detection -   train_loss = 8.114485740661621
2023-04-20 18:18:15,643 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 18:18:15,643 - Detection -   best_eval_score = 0.66
2023-04-20 18:18:15,643 - Detection -   eval_score = 2.19
2023-04-20 18:18:15,643 - Detection -   train_loss = 7.508010268211365
2023-04-20 18:18:17,561 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 18:18:17,561 - Detection -   best_eval_score = 2.19
2023-04-20 18:18:17,561 - Detection -   eval_score = 5.6
2023-04-20 18:18:17,561 - Detection -   train_loss = 6.751047700643539
2023-04-20 18:18:19,473 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 18:18:19,473 - Detection -   best_eval_score = 5.6
2023-04-20 18:18:19,473 - Detection -   eval_score = 8.27
2023-04-20 18:18:19,473 - Detection -   train_loss = 6.019754558801651
2023-04-20 18:18:21,385 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 18:18:21,385 - Detection -   best_eval_score = 8.27
2023-04-20 18:18:21,385 - Detection -   eval_score = 11.27
2023-04-20 18:18:21,385 - Detection -   train_loss = 5.256642520427704
2023-04-20 18:18:23,301 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 18:18:23,301 - Detection -   best_eval_score = 11.27
2023-04-20 18:18:23,301 - Detection -   eval_score = 16.35
2023-04-20 18:18:23,301 - Detection -   train_loss = 4.70661386847496
2023-04-20 18:18:25,261 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 18:18:25,261 - Detection -   best_eval_score = 16.35
2023-04-20 18:18:25,261 - Detection -   eval_score = 20.67
2023-04-20 18:18:25,261 - Detection -   train_loss = 4.138040453195572
2023-04-20 18:18:27,183 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 18:18:27,183 - Detection -   best_eval_score = 20.67
2023-04-20 18:18:27,183 - Detection -   eval_score = 24.32
2023-04-20 18:18:27,183 - Detection -   train_loss = 3.3966901749372482
2023-04-20 18:18:29,121 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 18:18:29,121 - Detection -   best_eval_score = 24.32
2023-04-20 18:18:29,121 - Detection -   eval_score = 29.67
2023-04-20 18:18:29,121 - Detection -   train_loss = 2.8045803010463715
2023-04-20 18:18:31,075 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 18:18:31,075 - Detection -   best_eval_score = 29.67
2023-04-20 18:18:31,075 - Detection -   eval_score = 34.58
2023-04-20 18:18:31,075 - Detection -   train_loss = 2.397019684314728
2023-04-20 18:18:33,012 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 18:18:33,013 - Detection -   best_eval_score = 34.58
2023-04-20 18:18:33,013 - Detection -   eval_score = 39.54
2023-04-20 18:18:33,013 - Detection -   train_loss = 2.0237751230597496
2023-04-20 18:18:34,954 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 18:18:34,954 - Detection -   best_eval_score = 39.54
2023-04-20 18:18:34,954 - Detection -   eval_score = 44.92
2023-04-20 18:18:34,954 - Detection -   train_loss = 1.7251720279455185
2023-04-20 18:18:36,893 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 18:18:36,893 - Detection -   best_eval_score = 44.92
2023-04-20 18:18:36,893 - Detection -   eval_score = 47.97
2023-04-20 18:18:36,893 - Detection -   train_loss = 1.5283477157354355
2023-04-20 18:18:38,827 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 18:18:38,828 - Detection -   best_eval_score = 47.97
2023-04-20 18:18:38,828 - Detection -   eval_score = 50.25
2023-04-20 18:18:38,828 - Detection -   train_loss = 1.4484290331602097
2023-04-20 18:18:40,755 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 18:18:40,755 - Detection -   best_eval_score = 50.25
2023-04-20 18:18:40,755 - Detection -   eval_score = 52.61
2023-04-20 18:18:40,755 - Detection -   train_loss = 1.3611873611807823
2023-04-20 18:18:42,677 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 18:18:42,677 - Detection -   best_eval_score = 52.61
2023-04-20 18:18:42,677 - Detection -   eval_score = 54.13
2023-04-20 18:18:42,677 - Detection -   train_loss = 1.2827271297574043
2023-04-20 18:18:44,606 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 18:18:44,606 - Detection -   best_eval_score = 54.13
2023-04-20 18:18:44,606 - Detection -   eval_score = 54.7
2023-04-20 18:18:44,606 - Detection -   train_loss = 1.222705502063036
2023-04-20 18:18:46,526 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 18:18:46,526 - Detection -   best_eval_score = 54.7
2023-04-20 18:18:46,526 - Detection -   eval_score = 55.41
2023-04-20 18:18:46,526 - Detection -   train_loss = 1.185771219432354
2023-04-20 18:18:48,455 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 18:18:48,455 - Detection -   best_eval_score = 55.41
2023-04-20 18:18:48,455 - Detection -   eval_score = 56.03
2023-04-20 18:18:48,455 - Detection -   train_loss = 1.201161652803421
2023-04-20 18:18:50,392 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 18:18:50,392 - Detection -   best_eval_score = 56.03
2023-04-20 18:18:50,392 - Detection -   eval_score = 57.0
2023-04-20 18:18:50,392 - Detection -   train_loss = 1.1806467957794666
2023-04-20 18:18:52,306 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 18:18:52,306 - Detection -   best_eval_score = 57.0
2023-04-20 18:18:52,306 - Detection -   eval_score = 56.73
2023-04-20 18:18:52,306 - Detection -   train_loss = 1.1806224063038826
2023-04-20 18:18:54,230 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 18:18:54,231 - Detection -   best_eval_score = 57.0
2023-04-20 18:18:54,231 - Detection -   eval_score = 57.42
2023-04-20 18:18:54,231 - Detection -   train_loss = 1.1764355525374413
2023-04-20 18:18:56,159 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 18:18:56,160 - Detection -   best_eval_score = 57.42
2023-04-20 18:18:56,160 - Detection -   eval_score = 57.13
2023-04-20 18:18:56,160 - Detection -   train_loss = 1.128987304866314
2023-04-20 18:18:58,100 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 18:18:58,100 - Detection -   best_eval_score = 57.42
2023-04-20 18:18:58,100 - Detection -   eval_score = 57.29
2023-04-20 18:18:58,100 - Detection -   train_loss = 1.1824465915560722
2023-04-20 18:19:00,029 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 18:19:00,029 - Detection -   best_eval_score = 57.42
2023-04-20 18:19:00,029 - Detection -   eval_score = 57.9
2023-04-20 18:19:00,029 - Detection -   train_loss = 1.1602947190403938
2023-04-20 18:19:01,954 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 18:19:01,954 - Detection -   best_eval_score = 57.9
2023-04-20 18:19:01,954 - Detection -   eval_score = 58.08
2023-04-20 18:19:01,954 - Detection -   train_loss = 1.1379663906991482
2023-04-20 18:19:03,883 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 18:19:03,883 - Detection -   best_eval_score = 58.08
2023-04-20 18:19:03,883 - Detection -   eval_score = 58.35
2023-04-20 18:19:03,883 - Detection -   train_loss = 1.164824090898037
2023-04-20 18:19:05,802 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 18:19:05,803 - Detection -   best_eval_score = 58.35
2023-04-20 18:19:05,803 - Detection -   eval_score = 58.35
2023-04-20 18:19:05,803 - Detection -   train_loss = 1.1608171239495277
2023-04-20 18:19:07,719 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 18:19:07,719 - Detection -   best_eval_score = 58.35
2023-04-20 18:19:07,720 - Detection -   eval_score = 58.18
2023-04-20 18:19:07,720 - Detection -   train_loss = 1.1898092776536942
2023-04-20 18:19:09,640 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 18:19:09,640 - Detection -   best_eval_score = 58.35
2023-04-20 18:19:09,640 - Detection -   eval_score = 58.58
2023-04-20 18:19:09,640 - Detection -   train_loss = 1.1405985578894615
2023-04-20 18:19:11,552 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 18:19:11,552 - Detection -   best_eval_score = 58.58
2023-04-20 18:19:11,552 - Detection -   eval_score = 58.53
2023-04-20 18:19:11,552 - Detection -   train_loss = 1.1716422885656357
2023-04-20 18:19:13,467 - Detection - ***** Epoch: 38: Eval results *****
2023-04-20 18:19:13,467 - Detection -   best_eval_score = 58.58
2023-04-20 18:19:13,467 - Detection -   eval_score = 57.94
2023-04-20 18:19:13,467 - Detection -   train_loss = 1.193946234881878
2023-04-20 18:19:15,389 - Detection - ***** Epoch: 39: Eval results *****
2023-04-20 18:19:15,389 - Detection -   best_eval_score = 58.58
2023-04-20 18:19:15,389 - Detection -   eval_score = 57.71
2023-04-20 18:19:15,389 - Detection -   train_loss = 1.1247598081827164
2023-04-20 18:19:17,297 - Detection - ***** Epoch: 40: Eval results *****
2023-04-20 18:19:17,297 - Detection -   best_eval_score = 58.58
2023-04-20 18:19:17,297 - Detection -   eval_score = 57.68
2023-04-20 18:19:17,297 - Detection -   train_loss = 1.1470270715653896
2023-04-20 18:19:19,210 - Detection - ***** Epoch: 41: Eval results *****
2023-04-20 18:19:19,211 - Detection -   best_eval_score = 58.58
2023-04-20 18:19:19,211 - Detection -   eval_score = 57.52
2023-04-20 18:19:19,211 - Detection -   train_loss = 1.212087705731392
2023-04-20 18:19:21,132 - Detection - ***** Epoch: 42: Eval results *****
2023-04-20 18:19:21,132 - Detection -   best_eval_score = 58.58
2023-04-20 18:19:21,132 - Detection -   eval_score = 57.75
2023-04-20 18:19:21,132 - Detection -   train_loss = 1.1622950173914433
2023-04-20 18:19:23,043 - Detection - ***** Epoch: 43: Eval results *****
2023-04-20 18:19:23,043 - Detection -   best_eval_score = 58.58
2023-04-20 18:19:23,043 - Detection -   eval_score = 57.7
2023-04-20 18:19:23,043 - Detection -   train_loss = 1.1773624643683434
2023-04-20 18:19:24,951 - Detection - ***** Epoch: 44: Eval results *****
2023-04-20 18:19:24,951 - Detection -   best_eval_score = 58.58
2023-04-20 18:19:24,951 - Detection -   eval_score = 57.55
2023-04-20 18:19:24,951 - Detection -   train_loss = 1.175183154642582
2023-04-20 18:19:26,869 - Detection - ***** Epoch: 45: Eval results *****
2023-04-20 18:19:26,869 - Detection -   best_eval_score = 58.58
2023-04-20 18:19:26,869 - Detection -   eval_score = 57.65
2023-04-20 18:19:26,869 - Detection -   train_loss = 1.217381477355957
2023-04-20 18:19:28,778 - Detection - ***** Epoch: 46: Eval results *****
2023-04-20 18:19:28,778 - Detection -   best_eval_score = 58.58
2023-04-20 18:19:28,778 - Detection -   eval_score = 57.77
2023-04-20 18:19:28,778 - Detection -   train_loss = 1.1613051816821098
2023-04-20 18:19:28,780 - Detection - Training Finished...
2023-04-20 18:19:28,780 - Detection - Testing begin...
2023-04-20 18:19:31,081 - Detection - ***** Test: Confusion Matrix *****
2023-04-20 18:19:31,081 - Detection - [[   0    0    0 ...    0    0   11]
 [   0   11    0 ...    0    0    1]
 [   0    0   22 ...    0    0    8]
 ...
 [   0    0    0 ...    1    0   12]
 [   0    0    0 ...    0    9    4]
 [   2    4    0 ...    0    3 2114]]
2023-04-20 18:19:31,081 - Detection - ***** Test results *****
2023-04-20 18:19:31,081 - Detection -   Acc = 75.94
2023-04-20 18:19:31,081 - Detection -   F1 = 52.3719
2023-04-20 18:19:31,081 - Detection -   F1-known = 51.9506
2023-04-20 18:19:31,081 - Detection -   F1-open = 83.9722
2023-04-20 18:19:31,081 - Detection - Testing finished...
2023-04-20 18:19:31,081 - Detection - Results saved in results/results_ADB.csv
2023-04-20 18:19:31,101 - Detection - Open Intent Detection Finished...
