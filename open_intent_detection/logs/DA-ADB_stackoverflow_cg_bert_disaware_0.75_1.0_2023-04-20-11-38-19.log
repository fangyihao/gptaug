2023-04-20 11:38:19,033 - Detection - Open Intent Detection Begin...
2023-04-20 11:38:19,033 - Detection - Parameters Initialization...
2023-04-20 11:38:19,034 - Detection - ============================== Params ==============================
2023-04-20 11:38:19,034 - Detection - type:	open_intent_detection
2023-04-20 11:38:19,034 - Detection - logger_name:	Detection
2023-04-20 11:38:19,034 - Detection - log_dir:	logs
2023-04-20 11:38:19,034 - Detection - dataset:	stackoverflow_cg
2023-04-20 11:38:19,034 - Detection - known_cls_ratio:	0.75
2023-04-20 11:38:19,035 - Detection - labeled_ratio:	1.0
2023-04-20 11:38:19,035 - Detection - method:	DA-ADB
2023-04-20 11:38:19,035 - Detection - train:	True
2023-04-20 11:38:19,035 - Detection - pretrain:	True
2023-04-20 11:38:19,035 - Detection - save_model:	True
2023-04-20 11:38:19,035 - Detection - backbone:	bert_disaware
2023-04-20 11:38:19,035 - Detection - config_file_name:	DA-ADB
2023-04-20 11:38:19,035 - Detection - seed:	2
2023-04-20 11:38:19,035 - Detection - gpu_id:	0
2023-04-20 11:38:19,035 - Detection - pipe_results_path:	pipe_results
2023-04-20 11:38:19,035 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-20 11:38:19,035 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-20 11:38:19,035 - Detection - model_dir:	models
2023-04-20 11:38:19,035 - Detection - load_pretrained_method:	None
2023-04-20 11:38:19,035 - Detection - result_dir:	results
2023-04-20 11:38:19,035 - Detection - results_file_name:	results_DA-ADB.csv
2023-04-20 11:38:19,035 - Detection - save_results:	True
2023-04-20 11:38:19,035 - Detection - loss_fct:	CrossEntropyLoss
2023-04-20 11:38:19,035 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.75_1.0_bert_disaware_2
2023-04-20 11:38:19,035 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.75_1.0_bert_disaware_2/models
2023-04-20 11:38:19,035 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-20 11:38:19,035 - Detection - num_train_epochs:	100
2023-04-20 11:38:19,035 - Detection - num_labels:	None
2023-04-20 11:38:19,035 - Detection - max_seq_length:	None
2023-04-20 11:38:19,035 - Detection - freeze_backbone_parameters:	True
2023-04-20 11:38:19,035 - Detection - feat_dim:	768
2023-04-20 11:38:19,035 - Detection - warmup_proportion:	0.1
2023-04-20 11:38:19,035 - Detection - scale:	4
2023-04-20 11:38:19,035 - Detection - lr_boundary:	0.05
2023-04-20 11:38:19,035 - Detection - lr:	2e-05
2023-04-20 11:38:19,035 - Detection - activation:	relu
2023-04-20 11:38:19,035 - Detection - train_batch_size:	128
2023-04-20 11:38:19,035 - Detection - eval_batch_size:	64
2023-04-20 11:38:19,035 - Detection - test_batch_size:	64
2023-04-20 11:38:19,035 - Detection - wait_patient:	10
2023-04-20 11:38:19,035 - Detection - ============================== End Params ==============================
2023-04-20 11:38:19,035 - Detection - Data and Model Preparation...
2023-04-20 11:38:19,036 - Detection - The number of known intents is 15
2023-04-20 11:38:19,036 - Detection - Lists of known labels are: ['osx', 'drupal', 'visual-studio', 'ajax', 'magento', 'excel', 'cocoa', 'matlab', 'apache', 'svn', 'hibernate', 'spring', 'scala', 'bash', 'oracle']
2023-04-20 11:38:19,051 - Detection - Number of labeled training samples = 2118
2023-04-20 11:38:19,051 - Detection - Number of unlabeled training samples = 673
2023-04-20 11:38:19,053 - Detection - Number of evaluation samples = 1057
2023-04-20 11:38:19,060 - Detection - Number of testing samples = 2905
2023-04-20 11:38:24,853 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-20 11:38:24,938 - Detection - Pre-training Begin...
2023-04-20 11:38:30,035 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 11:38:30,035 - Detection -   best_eval_score = 0
2023-04-20 11:38:30,036 - Detection -   eval_score = 1.57
2023-04-20 11:38:30,036 - Detection -   train_loss = 2.7183812926797306
2023-04-20 11:38:34,621 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 11:38:34,621 - Detection -   best_eval_score = 1.57
2023-04-20 11:38:34,621 - Detection -   eval_score = 0.98
2023-04-20 11:38:34,621 - Detection -   train_loss = 2.691317488165463
2023-04-20 11:38:39,162 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 11:38:39,162 - Detection -   best_eval_score = 1.57
2023-04-20 11:38:39,162 - Detection -   eval_score = 0.79
2023-04-20 11:38:39,162 - Detection -   train_loss = 2.672619749518002
2023-04-20 11:38:43,709 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 11:38:43,710 - Detection -   best_eval_score = 1.57
2023-04-20 11:38:43,710 - Detection -   eval_score = 1.36
2023-04-20 11:38:43,710 - Detection -   train_loss = 2.661586607203764
2023-04-20 11:38:48,264 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 11:38:48,264 - Detection -   best_eval_score = 1.57
2023-04-20 11:38:48,264 - Detection -   eval_score = 1.53
2023-04-20 11:38:48,264 - Detection -   train_loss = 2.64353541766896
2023-04-20 11:38:52,822 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 11:38:52,822 - Detection -   best_eval_score = 1.57
2023-04-20 11:38:52,822 - Detection -   eval_score = 3.09
2023-04-20 11:38:52,822 - Detection -   train_loss = 2.609364215065451
2023-04-20 11:38:57,402 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 11:38:57,402 - Detection -   best_eval_score = 3.09
2023-04-20 11:38:57,402 - Detection -   eval_score = 9.26
2023-04-20 11:38:57,402 - Detection -   train_loss = 2.5347271105822395
2023-04-20 11:39:01,987 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 11:39:01,987 - Detection -   best_eval_score = 9.26
2023-04-20 11:39:01,987 - Detection -   eval_score = 30.23
2023-04-20 11:39:01,987 - Detection -   train_loss = 2.3957636075861313
2023-04-20 11:39:06,573 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 11:39:06,574 - Detection -   best_eval_score = 30.23
2023-04-20 11:39:06,574 - Detection -   eval_score = 54.79
2023-04-20 11:39:06,574 - Detection -   train_loss = 2.1983498405007755
2023-04-20 11:39:11,176 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 11:39:11,176 - Detection -   best_eval_score = 54.79
2023-04-20 11:39:11,176 - Detection -   eval_score = 70.58
2023-04-20 11:39:11,176 - Detection -   train_loss = 1.9424306154251099
2023-04-20 11:39:15,877 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 11:39:15,877 - Detection -   best_eval_score = 70.58
2023-04-20 11:39:15,877 - Detection -   eval_score = 76.02
2023-04-20 11:39:15,877 - Detection -   train_loss = 1.704676074140212
2023-04-20 11:39:20,484 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 11:39:20,484 - Detection -   best_eval_score = 76.02
2023-04-20 11:39:20,484 - Detection -   eval_score = 77.05
2023-04-20 11:39:20,484 - Detection -   train_loss = 1.5391359539592968
2023-04-20 11:39:25,092 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 11:39:25,092 - Detection -   best_eval_score = 77.05
2023-04-20 11:39:25,092 - Detection -   eval_score = 77.68
2023-04-20 11:39:25,092 - Detection -   train_loss = 1.4358060009339277
2023-04-20 11:39:29,705 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 11:39:29,705 - Detection -   best_eval_score = 77.68
2023-04-20 11:39:29,705 - Detection -   eval_score = 78.65
2023-04-20 11:39:29,705 - Detection -   train_loss = 1.362792730331421
2023-04-20 11:39:34,315 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 11:39:34,315 - Detection -   best_eval_score = 78.65
2023-04-20 11:39:34,315 - Detection -   eval_score = 80.15
2023-04-20 11:39:34,315 - Detection -   train_loss = 1.3081683761933272
2023-04-20 11:39:38,931 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 11:39:38,931 - Detection -   best_eval_score = 80.15
2023-04-20 11:39:38,931 - Detection -   eval_score = 80.84
2023-04-20 11:39:38,931 - Detection -   train_loss = 1.2453413640751558
2023-04-20 11:39:43,541 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 11:39:43,541 - Detection -   best_eval_score = 80.84
2023-04-20 11:39:43,541 - Detection -   eval_score = 81.23
2023-04-20 11:39:43,541 - Detection -   train_loss = 1.216247881160063
2023-04-20 11:39:48,152 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 11:39:48,153 - Detection -   best_eval_score = 81.23
2023-04-20 11:39:48,153 - Detection -   eval_score = 80.99
2023-04-20 11:39:48,153 - Detection -   train_loss = 1.1878210095798267
2023-04-20 11:39:52,746 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 11:39:52,746 - Detection -   best_eval_score = 81.23
2023-04-20 11:39:52,746 - Detection -   eval_score = 81.37
2023-04-20 11:39:52,746 - Detection -   train_loss = 1.1476744588683634
2023-04-20 11:39:57,354 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 11:39:57,354 - Detection -   best_eval_score = 81.37
2023-04-20 11:39:57,354 - Detection -   eval_score = 81.57
2023-04-20 11:39:57,354 - Detection -   train_loss = 1.1249402480966904
2023-04-20 11:40:01,960 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 11:40:01,960 - Detection -   best_eval_score = 81.57
2023-04-20 11:40:01,960 - Detection -   eval_score = 81.75
2023-04-20 11:40:01,960 - Detection -   train_loss = 1.093971880043254
2023-04-20 11:40:06,563 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 11:40:06,563 - Detection -   best_eval_score = 81.75
2023-04-20 11:40:06,563 - Detection -   eval_score = 81.73
2023-04-20 11:40:06,563 - Detection -   train_loss = 1.0803218974786646
2023-04-20 11:40:11,156 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 11:40:11,156 - Detection -   best_eval_score = 81.75
2023-04-20 11:40:11,156 - Detection -   eval_score = 81.96
2023-04-20 11:40:11,156 - Detection -   train_loss = 1.0491041190483992
2023-04-20 11:40:15,765 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 11:40:15,765 - Detection -   best_eval_score = 81.96
2023-04-20 11:40:15,765 - Detection -   eval_score = 82.12
2023-04-20 11:40:15,765 - Detection -   train_loss = 1.0321521198048311
2023-04-20 11:40:20,369 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 11:40:20,369 - Detection -   best_eval_score = 82.12
2023-04-20 11:40:20,369 - Detection -   eval_score = 82.02
2023-04-20 11:40:20,369 - Detection -   train_loss = 1.01567826200934
2023-04-20 11:40:24,953 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 11:40:24,953 - Detection -   best_eval_score = 82.12
2023-04-20 11:40:24,953 - Detection -   eval_score = 82.06
2023-04-20 11:40:24,953 - Detection -   train_loss = 0.9890029816066518
2023-04-20 11:40:29,540 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 11:40:29,540 - Detection -   best_eval_score = 82.12
2023-04-20 11:40:29,540 - Detection -   eval_score = 82.03
2023-04-20 11:40:29,540 - Detection -   train_loss = 0.9709874496740454
2023-04-20 11:40:34,119 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 11:40:34,119 - Detection -   best_eval_score = 82.12
2023-04-20 11:40:34,119 - Detection -   eval_score = 81.89
2023-04-20 11:40:34,119 - Detection -   train_loss = 0.9678923838278827
2023-04-20 11:40:38,704 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 11:40:38,704 - Detection -   best_eval_score = 82.12
2023-04-20 11:40:38,704 - Detection -   eval_score = 81.92
2023-04-20 11:40:38,704 - Detection -   train_loss = 0.9472043409067041
2023-04-20 11:40:43,284 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 11:40:43,284 - Detection -   best_eval_score = 82.12
2023-04-20 11:40:43,284 - Detection -   eval_score = 81.82
2023-04-20 11:40:43,284 - Detection -   train_loss = 0.9273834999869851
2023-04-20 11:40:47,865 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 11:40:47,865 - Detection -   best_eval_score = 82.12
2023-04-20 11:40:47,865 - Detection -   eval_score = 81.76
2023-04-20 11:40:47,865 - Detection -   train_loss = 0.9185832318137673
2023-04-20 11:40:52,446 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 11:40:52,446 - Detection -   best_eval_score = 82.12
2023-04-20 11:40:52,446 - Detection -   eval_score = 81.76
2023-04-20 11:40:52,446 - Detection -   train_loss = 0.8986818860558903
2023-04-20 11:40:57,031 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 11:40:57,031 - Detection -   best_eval_score = 82.12
2023-04-20 11:40:57,031 - Detection -   eval_score = 82.07
2023-04-20 11:40:57,031 - Detection -   train_loss = 0.8919083546189701
2023-04-20 11:41:01,612 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 11:41:01,613 - Detection -   best_eval_score = 82.12
2023-04-20 11:41:01,613 - Detection -   eval_score = 81.91
2023-04-20 11:41:01,613 - Detection -   train_loss = 0.8767808675765991
2023-04-20 11:41:01,613 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.75_1.0_bert_disaware_2/models
2023-04-20 11:41:02,169 - Detection - Pre-training finished...
2023-04-20 11:41:02,169 - Detection - Training Begin...
2023-04-20 11:41:05,001 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 11:41:05,001 - Detection -   best_eval_score = 0
2023-04-20 11:41:05,001 - Detection -   eval_score = 0.0
2023-04-20 11:41:05,001 - Detection -   train_loss = 4.2983078956604
2023-04-20 11:41:07,831 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 11:41:07,831 - Detection -   best_eval_score = 0
2023-04-20 11:41:07,831 - Detection -   eval_score = 3.99
2023-04-20 11:41:07,831 - Detection -   train_loss = 3.8340831363902375
2023-04-20 11:41:10,662 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 11:41:10,662 - Detection -   best_eval_score = 3.99
2023-04-20 11:41:10,662 - Detection -   eval_score = 7.39
2023-04-20 11:41:10,662 - Detection -   train_loss = 3.158568438361673
2023-04-20 11:41:13,599 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 11:41:13,599 - Detection -   best_eval_score = 7.39
2023-04-20 11:41:13,599 - Detection -   eval_score = 31.97
2023-04-20 11:41:13,599 - Detection -   train_loss = 2.378753185272217
2023-04-20 11:41:16,430 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 11:41:16,431 - Detection -   best_eval_score = 31.97
2023-04-20 11:41:16,431 - Detection -   eval_score = 54.5
2023-04-20 11:41:16,431 - Detection -   train_loss = 1.616024508195765
2023-04-20 11:41:19,262 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 11:41:19,263 - Detection -   best_eval_score = 54.5
2023-04-20 11:41:19,263 - Detection -   eval_score = 72.55
2023-04-20 11:41:19,263 - Detection -   train_loss = 1.1564243541044348
2023-04-20 11:41:22,095 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 11:41:22,095 - Detection -   best_eval_score = 72.55
2023-04-20 11:41:22,095 - Detection -   eval_score = 76.24
2023-04-20 11:41:22,095 - Detection -   train_loss = 1.0340368607464958
2023-04-20 11:41:24,928 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 11:41:24,928 - Detection -   best_eval_score = 76.24
2023-04-20 11:41:24,928 - Detection -   eval_score = 75.92
2023-04-20 11:41:24,928 - Detection -   train_loss = 1.020186690723195
2023-04-20 11:41:27,762 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 11:41:27,762 - Detection -   best_eval_score = 76.24
2023-04-20 11:41:27,762 - Detection -   eval_score = 75.75
2023-04-20 11:41:27,762 - Detection -   train_loss = 1.025396795833812
2023-04-20 11:41:30,595 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 11:41:30,595 - Detection -   best_eval_score = 76.24
2023-04-20 11:41:30,595 - Detection -   eval_score = 75.66
2023-04-20 11:41:30,595 - Detection -   train_loss = 1.0106987216893364
2023-04-20 11:41:33,428 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 11:41:33,428 - Detection -   best_eval_score = 76.24
2023-04-20 11:41:33,428 - Detection -   eval_score = 75.59
2023-04-20 11:41:33,428 - Detection -   train_loss = 1.0290713941349703
2023-04-20 11:41:36,261 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 11:41:36,261 - Detection -   best_eval_score = 76.24
2023-04-20 11:41:36,261 - Detection -   eval_score = 75.78
2023-04-20 11:41:36,261 - Detection -   train_loss = 1.0010273877312155
2023-04-20 11:41:39,098 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 11:41:39,098 - Detection -   best_eval_score = 76.24
2023-04-20 11:41:39,098 - Detection -   eval_score = 75.69
2023-04-20 11:41:39,098 - Detection -   train_loss = 1.01849426241482
2023-04-20 11:41:41,933 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 11:41:41,933 - Detection -   best_eval_score = 76.24
2023-04-20 11:41:41,933 - Detection -   eval_score = 75.26
2023-04-20 11:41:41,933 - Detection -   train_loss = 1.0347180156146778
2023-04-20 11:41:44,769 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 11:41:44,770 - Detection -   best_eval_score = 76.24
2023-04-20 11:41:44,770 - Detection -   eval_score = 75.65
2023-04-20 11:41:44,770 - Detection -   train_loss = 1.0144643678384668
2023-04-20 11:41:47,604 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 11:41:47,605 - Detection -   best_eval_score = 76.24
2023-04-20 11:41:47,605 - Detection -   eval_score = 75.52
2023-04-20 11:41:47,605 - Detection -   train_loss = 1.02189238281811
2023-04-20 11:41:50,442 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 11:41:50,443 - Detection -   best_eval_score = 76.24
2023-04-20 11:41:50,443 - Detection -   eval_score = 75.18
2023-04-20 11:41:50,443 - Detection -   train_loss = 1.0317355885225183
2023-04-20 11:41:50,444 - Detection - Training Finished...
2023-04-20 11:41:50,444 - Detection - Testing begin...
2023-04-20 11:41:52,858 - Detection - ***** Test: Confusion Matrix *****
2023-04-20 11:41:52,859 - Detection - [[114   0   0   0   0   1  15   0   1   1   0   0   1   0   1  59]
 [  0 100   0   1   0   0   0   0   0   0   0   0   0   0   0  27]
 [  2   0  35   1   0   0   1   0   1   0   0   0   0   0   2  64]
 [  0   0   0 117   0   0   1   0   1   0   0   0   0   1   0  40]
 [  0   0   0   0 104   0   1   0   0   0   0   0   0   0   0  27]
 [  0   0   0   0   0  90   1   0   0   0   0   0   2   0   0  47]
 [ 11   0   0   0   0   0  98   0   2   0   0   0   0   1   1  48]
 [  0   0   0   0   0   0   2 123   0   0   0   0   0   0   0  39]
 [  1   0   0   0   0   0   1   0  94   1   0   0   0   1   0  72]
 [  1   0   1   0   0   0   0   0   0 111   0   0   0   0   0  36]
 [  0   0   0   0   0   0   0   0   0   0  84   2   1   0   3  38]
 [  0   0   0   0   0   0   0   0   0   0   1 112   0   0   0  38]
 [  0   0   0   0   0   0   1   0   0   0   0   1  92   0   0  30]
 [  3   0   0   1   0   0   1   0   0   0   0   0   1  87   0  46]
 [  1   0   0   0   0   0   0   0   0   0   0   0   0   0  97  29]
 [  7   0   4   1   0   4   4   1   4   0   0   0   7   1   7 693]]
2023-04-20 11:41:52,859 - Detection - ***** Test results *****
2023-04-20 11:41:52,859 - Detection -   Acc = 74.04
2023-04-20 11:41:52,859 - Detection -   F1 = 76.7176
2023-04-20 11:41:52,859 - Detection -   F1-known = 77.3597
2023-04-20 11:41:52,859 - Detection -   F1-open = 67.0862
2023-04-20 11:41:52,859 - Detection - Testing finished...
2023-04-20 11:41:52,859 - Detection - Results saved in results/results_DA-ADB.csv
2023-04-20 11:41:52,879 - Detection - Open Intent Detection Finished...
