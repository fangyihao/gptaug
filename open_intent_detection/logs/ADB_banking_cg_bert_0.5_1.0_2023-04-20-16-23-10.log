2023-04-20 16:23:10,518 - Detection - Open Intent Detection Begin...
2023-04-20 16:23:10,518 - Detection - Parameters Initialization...
2023-04-20 16:23:10,519 - Detection - ============================== Params ==============================
2023-04-20 16:23:10,519 - Detection - type:	open_intent_detection
2023-04-20 16:23:10,519 - Detection - logger_name:	Detection
2023-04-20 16:23:10,519 - Detection - log_dir:	logs
2023-04-20 16:23:10,519 - Detection - dataset:	banking_cg
2023-04-20 16:23:10,519 - Detection - known_cls_ratio:	0.5
2023-04-20 16:23:10,519 - Detection - labeled_ratio:	1.0
2023-04-20 16:23:10,519 - Detection - method:	ADB
2023-04-20 16:23:10,519 - Detection - train:	True
2023-04-20 16:23:10,519 - Detection - pretrain:	True
2023-04-20 16:23:10,519 - Detection - save_model:	True
2023-04-20 16:23:10,519 - Detection - backbone:	bert
2023-04-20 16:23:10,519 - Detection - config_file_name:	ADB
2023-04-20 16:23:10,519 - Detection - seed:	8
2023-04-20 16:23:10,519 - Detection - gpu_id:	0
2023-04-20 16:23:10,519 - Detection - pipe_results_path:	pipe_results
2023-04-20 16:23:10,519 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-20 16:23:10,519 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-20 16:23:10,519 - Detection - model_dir:	models
2023-04-20 16:23:10,519 - Detection - load_pretrained_method:	None
2023-04-20 16:23:10,519 - Detection - result_dir:	results
2023-04-20 16:23:10,519 - Detection - results_file_name:	results_ADB.csv
2023-04-20 16:23:10,519 - Detection - save_results:	True
2023-04-20 16:23:10,519 - Detection - loss_fct:	CrossEntropyLoss
2023-04-20 16:23:10,519 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.5_1.0_bert_8
2023-04-20 16:23:10,519 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.5_1.0_bert_8/models
2023-04-20 16:23:10,519 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-20 16:23:10,519 - Detection - num_train_epochs:	100
2023-04-20 16:23:10,519 - Detection - num_labels:	None
2023-04-20 16:23:10,519 - Detection - max_seq_length:	None
2023-04-20 16:23:10,519 - Detection - freeze_backbone_parameters:	True
2023-04-20 16:23:10,519 - Detection - feat_dim:	768
2023-04-20 16:23:10,519 - Detection - warmup_proportion:	0.1
2023-04-20 16:23:10,519 - Detection - lr_boundary:	0.05
2023-04-20 16:23:10,519 - Detection - lr:	2e-05
2023-04-20 16:23:10,519 - Detection - activation:	relu
2023-04-20 16:23:10,519 - Detection - train_batch_size:	128
2023-04-20 16:23:10,519 - Detection - eval_batch_size:	64
2023-04-20 16:23:10,519 - Detection - test_batch_size:	64
2023-04-20 16:23:10,519 - Detection - wait_patient:	10
2023-04-20 16:23:10,519 - Detection - ============================== End Params ==============================
2023-04-20 16:23:10,519 - Detection - Data and Model Preparation...
2023-04-20 16:23:10,520 - Detection - The number of known intents is 38
2023-04-20 16:23:10,520 - Detection - Lists of known labels are: ['getting_spare_card', 'failed_transfer', 'virtual_card_not_working', 'apple_pay_or_google_pay', 'pending_card_payment', 'order_physical_card', 'activate_my_card', 'card_arrival', 'card_payment_fee_charged', 'card_swallowed', 'verify_top_up', 'exchange_rate', 'passcode_forgotten', 'pending_cash_withdrawal', 'topping_up_by_card', 'exchange_charge', 'pin_blocked', 'compromised_card', 'visa_or_mastercard', 'exchange_via_app', 'card_acceptance', 'wrong_amount_of_cash_received', 'country_support', 'top_up_by_card_charge', 'contactless_not_working', 'transfer_fee_charged', 'disposable_card_limits', 'balance_not_updated_after_bank_transfer', 'verify_source_of_funds', 'unable_to_verify_identity', 'supported_cards_and_currencies', 'Refund_not_showing_up', 'card_about_to_expire', 'get_physical_card', 'extra_charge_on_statement', 'request_refund', 'why_verify_identity', 'cash_withdrawal_not_recognised']
2023-04-20 16:23:10,529 - Detection - Number of labeled training samples = 1278
2023-04-20 16:23:10,529 - Detection - Number of unlabeled training samples = 1494
2023-04-20 16:23:10,531 - Detection - Number of evaluation samples = 388
2023-04-20 16:23:10,536 - Detection - Number of testing samples = 1896
2023-04-20 16:23:15,054 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-20 16:23:16,734 - Detection - Pre-training Begin...
2023-04-20 16:23:19,137 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 16:23:19,137 - Detection -   best_eval_score = 0
2023-04-20 16:23:19,137 - Detection -   eval_score = 2.58
2023-04-20 16:23:19,137 - Detection -   train_loss = 3.6258004903793335
2023-04-20 16:23:21,044 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 16:23:21,044 - Detection -   best_eval_score = 2.58
2023-04-20 16:23:21,044 - Detection -   eval_score = 4.64
2023-04-20 16:23:21,044 - Detection -   train_loss = 3.6114253997802734
2023-04-20 16:23:23,019 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 16:23:23,019 - Detection -   best_eval_score = 4.64
2023-04-20 16:23:23,019 - Detection -   eval_score = 4.9
2023-04-20 16:23:23,019 - Detection -   train_loss = 3.579747772216797
2023-04-20 16:23:24,949 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 16:23:24,949 - Detection -   best_eval_score = 4.9
2023-04-20 16:23:24,949 - Detection -   eval_score = 6.7
2023-04-20 16:23:24,950 - Detection -   train_loss = 3.5358432054519655
2023-04-20 16:23:26,870 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 16:23:26,870 - Detection -   best_eval_score = 6.7
2023-04-20 16:23:26,870 - Detection -   eval_score = 6.7
2023-04-20 16:23:26,870 - Detection -   train_loss = 3.4725033044815063
2023-04-20 16:23:28,915 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 16:23:28,915 - Detection -   best_eval_score = 6.7
2023-04-20 16:23:28,915 - Detection -   eval_score = 8.76
2023-04-20 16:23:28,915 - Detection -   train_loss = 3.3680702209472657
2023-04-20 16:23:30,849 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 16:23:30,849 - Detection -   best_eval_score = 8.76
2023-04-20 16:23:30,849 - Detection -   eval_score = 13.92
2023-04-20 16:23:30,850 - Detection -   train_loss = 3.2120092630386354
2023-04-20 16:23:32,833 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 16:23:32,833 - Detection -   best_eval_score = 13.92
2023-04-20 16:23:32,833 - Detection -   eval_score = 21.39
2023-04-20 16:23:32,833 - Detection -   train_loss = 2.9552260398864747
2023-04-20 16:23:34,836 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 16:23:34,836 - Detection -   best_eval_score = 21.39
2023-04-20 16:23:34,837 - Detection -   eval_score = 28.87
2023-04-20 16:23:34,837 - Detection -   train_loss = 2.605501174926758
2023-04-20 16:23:36,807 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 16:23:36,807 - Detection -   best_eval_score = 28.87
2023-04-20 16:23:36,807 - Detection -   eval_score = 37.89
2023-04-20 16:23:36,807 - Detection -   train_loss = 2.238717293739319
2023-04-20 16:23:38,792 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 16:23:38,792 - Detection -   best_eval_score = 37.89
2023-04-20 16:23:38,792 - Detection -   eval_score = 44.07
2023-04-20 16:23:38,792 - Detection -   train_loss = 1.8934603214263916
2023-04-20 16:23:40,785 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 16:23:40,786 - Detection -   best_eval_score = 44.07
2023-04-20 16:23:40,786 - Detection -   eval_score = 53.87
2023-04-20 16:23:40,786 - Detection -   train_loss = 1.5991819143295287
2023-04-20 16:23:42,832 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 16:23:42,832 - Detection -   best_eval_score = 53.87
2023-04-20 16:23:42,832 - Detection -   eval_score = 58.76
2023-04-20 16:23:42,832 - Detection -   train_loss = 1.3614673495292664
2023-04-20 16:23:44,893 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 16:23:44,893 - Detection -   best_eval_score = 58.76
2023-04-20 16:23:44,893 - Detection -   eval_score = 61.86
2023-04-20 16:23:44,894 - Detection -   train_loss = 1.167586326599121
2023-04-20 16:23:47,026 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 16:23:47,026 - Detection -   best_eval_score = 61.86
2023-04-20 16:23:47,026 - Detection -   eval_score = 65.98
2023-04-20 16:23:47,026 - Detection -   train_loss = 1.0094398736953736
2023-04-20 16:23:49,078 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 16:23:49,078 - Detection -   best_eval_score = 65.98
2023-04-20 16:23:49,078 - Detection -   eval_score = 69.59
2023-04-20 16:23:49,078 - Detection -   train_loss = 0.8863887965679169
2023-04-20 16:23:51,175 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 16:23:51,175 - Detection -   best_eval_score = 69.59
2023-04-20 16:23:51,175 - Detection -   eval_score = 71.13
2023-04-20 16:23:51,175 - Detection -   train_loss = 0.7894502341747284
2023-04-20 16:23:53,237 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 16:23:53,237 - Detection -   best_eval_score = 71.13
2023-04-20 16:23:53,237 - Detection -   eval_score = 72.94
2023-04-20 16:23:53,237 - Detection -   train_loss = 0.7001445174217225
2023-04-20 16:23:55,331 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 16:23:55,331 - Detection -   best_eval_score = 72.94
2023-04-20 16:23:55,331 - Detection -   eval_score = 73.71
2023-04-20 16:23:55,331 - Detection -   train_loss = 0.6375454843044281
2023-04-20 16:23:57,372 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 16:23:57,372 - Detection -   best_eval_score = 73.71
2023-04-20 16:23:57,372 - Detection -   eval_score = 76.55
2023-04-20 16:23:57,372 - Detection -   train_loss = 0.5724961996078491
2023-04-20 16:23:59,427 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 16:23:59,427 - Detection -   best_eval_score = 76.55
2023-04-20 16:23:59,427 - Detection -   eval_score = 77.32
2023-04-20 16:23:59,427 - Detection -   train_loss = 0.5190358966588974
2023-04-20 16:24:01,484 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 16:24:01,484 - Detection -   best_eval_score = 77.32
2023-04-20 16:24:01,484 - Detection -   eval_score = 79.12
2023-04-20 16:24:01,484 - Detection -   train_loss = 0.47572432160377504
2023-04-20 16:24:03,558 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 16:24:03,558 - Detection -   best_eval_score = 79.12
2023-04-20 16:24:03,558 - Detection -   eval_score = 80.41
2023-04-20 16:24:03,558 - Detection -   train_loss = 0.4323454350233078
2023-04-20 16:24:05,637 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 16:24:05,637 - Detection -   best_eval_score = 80.41
2023-04-20 16:24:05,637 - Detection -   eval_score = 79.9
2023-04-20 16:24:05,637 - Detection -   train_loss = 0.39811381995677947
2023-04-20 16:24:07,677 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 16:24:07,677 - Detection -   best_eval_score = 80.41
2023-04-20 16:24:07,677 - Detection -   eval_score = 80.67
2023-04-20 16:24:07,678 - Detection -   train_loss = 0.3673556536436081
2023-04-20 16:24:09,762 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 16:24:09,762 - Detection -   best_eval_score = 80.67
2023-04-20 16:24:09,762 - Detection -   eval_score = 80.15
2023-04-20 16:24:09,762 - Detection -   train_loss = 0.34317336678504945
2023-04-20 16:24:11,828 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 16:24:11,828 - Detection -   best_eval_score = 80.67
2023-04-20 16:24:11,828 - Detection -   eval_score = 81.44
2023-04-20 16:24:11,828 - Detection -   train_loss = 0.32341077029705045
2023-04-20 16:24:13,956 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 16:24:13,956 - Detection -   best_eval_score = 81.44
2023-04-20 16:24:13,956 - Detection -   eval_score = 80.93
2023-04-20 16:24:13,956 - Detection -   train_loss = 0.306317126750946
2023-04-20 16:24:16,017 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 16:24:16,017 - Detection -   best_eval_score = 81.44
2023-04-20 16:24:16,017 - Detection -   eval_score = 82.22
2023-04-20 16:24:16,017 - Detection -   train_loss = 0.2766922786831856
2023-04-20 16:24:18,105 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 16:24:18,105 - Detection -   best_eval_score = 82.22
2023-04-20 16:24:18,105 - Detection -   eval_score = 80.93
2023-04-20 16:24:18,105 - Detection -   train_loss = 0.2549054652452469
2023-04-20 16:24:20,154 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 16:24:20,154 - Detection -   best_eval_score = 82.22
2023-04-20 16:24:20,154 - Detection -   eval_score = 81.96
2023-04-20 16:24:20,154 - Detection -   train_loss = 0.24374690800905227
2023-04-20 16:24:22,232 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 16:24:22,232 - Detection -   best_eval_score = 82.22
2023-04-20 16:24:22,232 - Detection -   eval_score = 81.7
2023-04-20 16:24:22,232 - Detection -   train_loss = 0.22544468343257903
2023-04-20 16:24:24,321 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 16:24:24,321 - Detection -   best_eval_score = 82.22
2023-04-20 16:24:24,321 - Detection -   eval_score = 81.7
2023-04-20 16:24:24,321 - Detection -   train_loss = 0.22158313691616058
2023-04-20 16:24:26,390 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 16:24:26,390 - Detection -   best_eval_score = 82.22
2023-04-20 16:24:26,390 - Detection -   eval_score = 81.7
2023-04-20 16:24:26,390 - Detection -   train_loss = 0.21009760051965715
2023-04-20 16:24:28,473 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 16:24:28,473 - Detection -   best_eval_score = 82.22
2023-04-20 16:24:28,473 - Detection -   eval_score = 81.7
2023-04-20 16:24:28,473 - Detection -   train_loss = 0.1964378610253334
2023-04-20 16:24:30,548 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 16:24:30,548 - Detection -   best_eval_score = 82.22
2023-04-20 16:24:30,548 - Detection -   eval_score = 82.99
2023-04-20 16:24:30,548 - Detection -   train_loss = 0.18593675196170806
2023-04-20 16:24:32,609 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 16:24:32,609 - Detection -   best_eval_score = 82.99
2023-04-20 16:24:32,609 - Detection -   eval_score = 82.47
2023-04-20 16:24:32,609 - Detection -   train_loss = 0.17932596653699875
2023-04-20 16:24:34,656 - Detection - ***** Epoch: 38: Eval results *****
2023-04-20 16:24:34,656 - Detection -   best_eval_score = 82.99
2023-04-20 16:24:34,656 - Detection -   eval_score = 82.73
2023-04-20 16:24:34,656 - Detection -   train_loss = 0.16981664448976516
2023-04-20 16:24:36,712 - Detection - ***** Epoch: 39: Eval results *****
2023-04-20 16:24:36,713 - Detection -   best_eval_score = 82.99
2023-04-20 16:24:36,713 - Detection -   eval_score = 82.22
2023-04-20 16:24:36,713 - Detection -   train_loss = 0.16071411669254304
2023-04-20 16:24:38,767 - Detection - ***** Epoch: 40: Eval results *****
2023-04-20 16:24:38,767 - Detection -   best_eval_score = 82.99
2023-04-20 16:24:38,767 - Detection -   eval_score = 82.22
2023-04-20 16:24:38,767 - Detection -   train_loss = 0.15595898032188416
2023-04-20 16:24:40,835 - Detection - ***** Epoch: 41: Eval results *****
2023-04-20 16:24:40,835 - Detection -   best_eval_score = 82.99
2023-04-20 16:24:40,835 - Detection -   eval_score = 82.73
2023-04-20 16:24:40,835 - Detection -   train_loss = 0.15022328943014146
2023-04-20 16:24:42,895 - Detection - ***** Epoch: 42: Eval results *****
2023-04-20 16:24:42,895 - Detection -   best_eval_score = 82.99
2023-04-20 16:24:42,895 - Detection -   eval_score = 83.76
2023-04-20 16:24:42,895 - Detection -   train_loss = 0.13882217556238174
2023-04-20 16:24:44,943 - Detection - ***** Epoch: 43: Eval results *****
2023-04-20 16:24:44,943 - Detection -   best_eval_score = 83.76
2023-04-20 16:24:44,943 - Detection -   eval_score = 83.51
2023-04-20 16:24:44,943 - Detection -   train_loss = 0.13816662430763244
2023-04-20 16:24:47,036 - Detection - ***** Epoch: 44: Eval results *****
2023-04-20 16:24:47,036 - Detection -   best_eval_score = 83.76
2023-04-20 16:24:47,036 - Detection -   eval_score = 82.99
2023-04-20 16:24:47,036 - Detection -   train_loss = 0.13004331067204475
2023-04-20 16:24:49,115 - Detection - ***** Epoch: 45: Eval results *****
2023-04-20 16:24:49,115 - Detection -   best_eval_score = 83.76
2023-04-20 16:24:49,115 - Detection -   eval_score = 83.51
2023-04-20 16:24:49,115 - Detection -   train_loss = 0.1281283289194107
2023-04-20 16:24:51,165 - Detection - ***** Epoch: 46: Eval results *****
2023-04-20 16:24:51,165 - Detection -   best_eval_score = 83.76
2023-04-20 16:24:51,165 - Detection -   eval_score = 83.51
2023-04-20 16:24:51,165 - Detection -   train_loss = 0.1267641954123974
2023-04-20 16:24:53,212 - Detection - ***** Epoch: 47: Eval results *****
2023-04-20 16:24:53,212 - Detection -   best_eval_score = 83.76
2023-04-20 16:24:53,212 - Detection -   eval_score = 83.51
2023-04-20 16:24:53,212 - Detection -   train_loss = 0.12197190374135972
2023-04-20 16:24:55,269 - Detection - ***** Epoch: 48: Eval results *****
2023-04-20 16:24:55,269 - Detection -   best_eval_score = 83.76
2023-04-20 16:24:55,269 - Detection -   eval_score = 83.76
2023-04-20 16:24:55,269 - Detection -   train_loss = 0.11938495412468911
2023-04-20 16:24:57,486 - Detection - ***** Epoch: 49: Eval results *****
2023-04-20 16:24:57,486 - Detection -   best_eval_score = 83.76
2023-04-20 16:24:57,486 - Detection -   eval_score = 84.02
2023-04-20 16:24:57,486 - Detection -   train_loss = 0.11091367229819298
2023-04-20 16:24:59,558 - Detection - ***** Epoch: 50: Eval results *****
2023-04-20 16:24:59,558 - Detection -   best_eval_score = 84.02
2023-04-20 16:24:59,558 - Detection -   eval_score = 83.76
2023-04-20 16:24:59,558 - Detection -   train_loss = 0.10996147096157075
2023-04-20 16:25:01,639 - Detection - ***** Epoch: 51: Eval results *****
2023-04-20 16:25:01,639 - Detection -   best_eval_score = 84.02
2023-04-20 16:25:01,639 - Detection -   eval_score = 83.25
2023-04-20 16:25:01,639 - Detection -   train_loss = 0.1063090831041336
2023-04-20 16:25:03,722 - Detection - ***** Epoch: 52: Eval results *****
2023-04-20 16:25:03,722 - Detection -   best_eval_score = 84.02
2023-04-20 16:25:03,723 - Detection -   eval_score = 84.28
2023-04-20 16:25:03,723 - Detection -   train_loss = 0.10207072645425797
2023-04-20 16:25:05,875 - Detection - ***** Epoch: 53: Eval results *****
2023-04-20 16:25:05,875 - Detection -   best_eval_score = 84.28
2023-04-20 16:25:05,875 - Detection -   eval_score = 83.25
2023-04-20 16:25:05,875 - Detection -   train_loss = 0.10156613066792489
2023-04-20 16:25:07,940 - Detection - ***** Epoch: 54: Eval results *****
2023-04-20 16:25:07,940 - Detection -   best_eval_score = 84.28
2023-04-20 16:25:07,940 - Detection -   eval_score = 84.02
2023-04-20 16:25:07,940 - Detection -   train_loss = 0.10025468543171882
2023-04-20 16:25:10,095 - Detection - ***** Epoch: 55: Eval results *****
2023-04-20 16:25:10,095 - Detection -   best_eval_score = 84.28
2023-04-20 16:25:10,095 - Detection -   eval_score = 83.76
2023-04-20 16:25:10,095 - Detection -   train_loss = 0.09791790619492531
2023-04-20 16:25:12,162 - Detection - ***** Epoch: 56: Eval results *****
2023-04-20 16:25:12,162 - Detection -   best_eval_score = 84.28
2023-04-20 16:25:12,162 - Detection -   eval_score = 83.76
2023-04-20 16:25:12,162 - Detection -   train_loss = 0.09181853905320167
2023-04-20 16:25:14,301 - Detection - ***** Epoch: 57: Eval results *****
2023-04-20 16:25:14,301 - Detection -   best_eval_score = 84.28
2023-04-20 16:25:14,301 - Detection -   eval_score = 83.76
2023-04-20 16:25:14,301 - Detection -   train_loss = 0.09482268765568733
2023-04-20 16:25:16,487 - Detection - ***** Epoch: 58: Eval results *****
2023-04-20 16:25:16,487 - Detection -   best_eval_score = 84.28
2023-04-20 16:25:16,488 - Detection -   eval_score = 83.76
2023-04-20 16:25:16,488 - Detection -   train_loss = 0.08665832355618477
2023-04-20 16:25:18,566 - Detection - ***** Epoch: 59: Eval results *****
2023-04-20 16:25:18,566 - Detection -   best_eval_score = 84.28
2023-04-20 16:25:18,566 - Detection -   eval_score = 83.51
2023-04-20 16:25:18,566 - Detection -   train_loss = 0.08764976114034653
2023-04-20 16:25:20,675 - Detection - ***** Epoch: 60: Eval results *****
2023-04-20 16:25:20,675 - Detection -   best_eval_score = 84.28
2023-04-20 16:25:20,675 - Detection -   eval_score = 83.25
2023-04-20 16:25:20,675 - Detection -   train_loss = 0.08457413874566555
2023-04-20 16:25:22,827 - Detection - ***** Epoch: 61: Eval results *****
2023-04-20 16:25:22,827 - Detection -   best_eval_score = 84.28
2023-04-20 16:25:22,827 - Detection -   eval_score = 82.99
2023-04-20 16:25:22,827 - Detection -   train_loss = 0.08449478298425675
2023-04-20 16:25:24,903 - Detection - ***** Epoch: 62: Eval results *****
2023-04-20 16:25:24,903 - Detection -   best_eval_score = 84.28
2023-04-20 16:25:24,903 - Detection -   eval_score = 83.25
2023-04-20 16:25:24,903 - Detection -   train_loss = 0.080563835054636
2023-04-20 16:25:24,903 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.5_1.0_bert_8/models
2023-04-20 16:25:25,444 - Detection - Pre-training finished...
2023-04-20 16:25:25,445 - Detection - Training Begin...
2023-04-20 16:25:28,895 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 16:25:28,895 - Detection -   best_eval_score = 0
2023-04-20 16:25:28,895 - Detection -   eval_score = 0.0
2023-04-20 16:25:28,895 - Detection -   train_loss = 11.095951080322266
2023-04-20 16:25:30,982 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 16:25:30,982 - Detection -   best_eval_score = 0
2023-04-20 16:25:30,982 - Detection -   eval_score = 0.0
2023-04-20 16:25:30,982 - Detection -   train_loss = 10.822335910797118
2023-04-20 16:25:33,020 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 16:25:33,020 - Detection -   best_eval_score = 0
2023-04-20 16:25:33,020 - Detection -   eval_score = 0.0
2023-04-20 16:25:33,020 - Detection -   train_loss = 10.478230667114257
2023-04-20 16:25:35,033 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 16:25:35,033 - Detection -   best_eval_score = 0
2023-04-20 16:25:35,033 - Detection -   eval_score = 0.0
2023-04-20 16:25:35,033 - Detection -   train_loss = 10.086914539337158
2023-04-20 16:25:37,048 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 16:25:37,048 - Detection -   best_eval_score = 0
2023-04-20 16:25:37,048 - Detection -   eval_score = 0.0
2023-04-20 16:25:37,048 - Detection -   train_loss = 9.621761798858643
2023-04-20 16:25:39,071 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 16:25:39,072 - Detection -   best_eval_score = 0
2023-04-20 16:25:39,072 - Detection -   eval_score = 0.0
2023-04-20 16:25:39,072 - Detection -   train_loss = 9.206399536132812
2023-04-20 16:25:41,099 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 16:25:41,099 - Detection -   best_eval_score = 0
2023-04-20 16:25:41,099 - Detection -   eval_score = 0.28
2023-04-20 16:25:41,099 - Detection -   train_loss = 8.739988613128663
2023-04-20 16:25:43,112 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 16:25:43,112 - Detection -   best_eval_score = 0.28
2023-04-20 16:25:43,112 - Detection -   eval_score = 0.54
2023-04-20 16:25:43,112 - Detection -   train_loss = 8.250174427032471
2023-04-20 16:25:45,142 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 16:25:45,142 - Detection -   best_eval_score = 0.54
2023-04-20 16:25:45,142 - Detection -   eval_score = 2.06
2023-04-20 16:25:45,142 - Detection -   train_loss = 7.706250524520874
2023-04-20 16:25:47,188 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 16:25:47,188 - Detection -   best_eval_score = 2.06
2023-04-20 16:25:47,188 - Detection -   eval_score = 5.05
2023-04-20 16:25:47,188 - Detection -   train_loss = 7.2196940898895265
2023-04-20 16:25:49,225 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 16:25:49,225 - Detection -   best_eval_score = 5.05
2023-04-20 16:25:49,225 - Detection -   eval_score = 7.7
2023-04-20 16:25:49,226 - Detection -   train_loss = 6.6687774658203125
2023-04-20 16:25:51,269 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 16:25:51,270 - Detection -   best_eval_score = 7.7
2023-04-20 16:25:51,270 - Detection -   eval_score = 11.09
2023-04-20 16:25:51,270 - Detection -   train_loss = 6.237406921386719
2023-04-20 16:25:53,432 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 16:25:53,432 - Detection -   best_eval_score = 11.09
2023-04-20 16:25:53,432 - Detection -   eval_score = 15.57
2023-04-20 16:25:53,432 - Detection -   train_loss = 5.703729438781738
2023-04-20 16:25:55,456 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 16:25:55,456 - Detection -   best_eval_score = 15.57
2023-04-20 16:25:55,456 - Detection -   eval_score = 22.52
2023-04-20 16:25:55,456 - Detection -   train_loss = 5.219083261489868
2023-04-20 16:25:57,473 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 16:25:57,473 - Detection -   best_eval_score = 22.52
2023-04-20 16:25:57,473 - Detection -   eval_score = 28.79
2023-04-20 16:25:57,473 - Detection -   train_loss = 4.717102861404419
2023-04-20 16:25:59,520 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 16:25:59,520 - Detection -   best_eval_score = 28.79
2023-04-20 16:25:59,520 - Detection -   eval_score = 34.08
2023-04-20 16:25:59,520 - Detection -   train_loss = 4.2529576301574705
2023-04-20 16:26:01,561 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 16:26:01,562 - Detection -   best_eval_score = 34.08
2023-04-20 16:26:01,562 - Detection -   eval_score = 40.3
2023-04-20 16:26:01,562 - Detection -   train_loss = 3.776652383804321
2023-04-20 16:26:03,571 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 16:26:03,571 - Detection -   best_eval_score = 40.3
2023-04-20 16:26:03,571 - Detection -   eval_score = 44.27
2023-04-20 16:26:03,571 - Detection -   train_loss = 3.2996381759643554
2023-04-20 16:26:05,586 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 16:26:05,586 - Detection -   best_eval_score = 44.27
2023-04-20 16:26:05,586 - Detection -   eval_score = 52.02
2023-04-20 16:26:05,586 - Detection -   train_loss = 2.856437611579895
2023-04-20 16:26:07,601 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 16:26:07,601 - Detection -   best_eval_score = 52.02
2023-04-20 16:26:07,601 - Detection -   eval_score = 55.08
2023-04-20 16:26:07,602 - Detection -   train_loss = 2.4010750532150267
2023-04-20 16:26:09,631 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 16:26:09,631 - Detection -   best_eval_score = 55.08
2023-04-20 16:26:09,631 - Detection -   eval_score = 61.58
2023-04-20 16:26:09,631 - Detection -   train_loss = 2.088283360004425
2023-04-20 16:26:11,673 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 16:26:11,673 - Detection -   best_eval_score = 61.58
2023-04-20 16:26:11,673 - Detection -   eval_score = 64.58
2023-04-20 16:26:11,673 - Detection -   train_loss = 1.8336580991744995
2023-04-20 16:26:13,715 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 16:26:13,715 - Detection -   best_eval_score = 64.58
2023-04-20 16:26:13,715 - Detection -   eval_score = 66.11
2023-04-20 16:26:13,715 - Detection -   train_loss = 1.612088644504547
2023-04-20 16:26:15,726 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 16:26:15,726 - Detection -   best_eval_score = 66.11
2023-04-20 16:26:15,726 - Detection -   eval_score = 68.04
2023-04-20 16:26:15,726 - Detection -   train_loss = 1.4665371537208558
2023-04-20 16:26:17,738 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 16:26:17,738 - Detection -   best_eval_score = 68.04
2023-04-20 16:26:17,738 - Detection -   eval_score = 69.13
2023-04-20 16:26:17,738 - Detection -   train_loss = 1.371900749206543
2023-04-20 16:26:19,769 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 16:26:19,769 - Detection -   best_eval_score = 69.13
2023-04-20 16:26:19,769 - Detection -   eval_score = 70.35
2023-04-20 16:26:19,769 - Detection -   train_loss = 1.3027650594711304
2023-04-20 16:26:21,828 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 16:26:21,829 - Detection -   best_eval_score = 70.35
2023-04-20 16:26:21,829 - Detection -   eval_score = 71.48
2023-04-20 16:26:21,829 - Detection -   train_loss = 1.2819543361663819
2023-04-20 16:26:23,881 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 16:26:23,881 - Detection -   best_eval_score = 71.48
2023-04-20 16:26:23,881 - Detection -   eval_score = 71.44
2023-04-20 16:26:23,881 - Detection -   train_loss = 1.2337625622749329
2023-04-20 16:26:25,933 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 16:26:25,933 - Detection -   best_eval_score = 71.48
2023-04-20 16:26:25,933 - Detection -   eval_score = 71.37
2023-04-20 16:26:25,933 - Detection -   train_loss = 1.2640686869621276
2023-04-20 16:26:27,957 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 16:26:27,958 - Detection -   best_eval_score = 71.48
2023-04-20 16:26:27,958 - Detection -   eval_score = 72.35
2023-04-20 16:26:27,958 - Detection -   train_loss = 1.254253911972046
2023-04-20 16:26:30,013 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 16:26:30,013 - Detection -   best_eval_score = 72.35
2023-04-20 16:26:30,013 - Detection -   eval_score = 72.35
2023-04-20 16:26:30,013 - Detection -   train_loss = 1.2552826881408692
2023-04-20 16:26:32,050 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 16:26:32,050 - Detection -   best_eval_score = 72.35
2023-04-20 16:26:32,050 - Detection -   eval_score = 72.55
2023-04-20 16:26:32,050 - Detection -   train_loss = 1.2572372674942016
2023-04-20 16:26:34,075 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 16:26:34,075 - Detection -   best_eval_score = 72.55
2023-04-20 16:26:34,075 - Detection -   eval_score = 72.55
2023-04-20 16:26:34,075 - Detection -   train_loss = 1.2406339406967164
2023-04-20 16:26:36,134 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 16:26:36,134 - Detection -   best_eval_score = 72.55
2023-04-20 16:26:36,134 - Detection -   eval_score = 72.27
2023-04-20 16:26:36,134 - Detection -   train_loss = 1.2274704694747924
2023-04-20 16:26:38,147 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 16:26:38,147 - Detection -   best_eval_score = 72.55
2023-04-20 16:26:38,147 - Detection -   eval_score = 72.51
2023-04-20 16:26:38,147 - Detection -   train_loss = 1.2453389167785645
2023-04-20 16:26:40,200 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 16:26:40,200 - Detection -   best_eval_score = 72.55
2023-04-20 16:26:40,200 - Detection -   eval_score = 72.4
2023-04-20 16:26:40,200 - Detection -   train_loss = 1.2145660996437073
2023-04-20 16:26:42,281 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 16:26:42,281 - Detection -   best_eval_score = 72.55
2023-04-20 16:26:42,281 - Detection -   eval_score = 72.22
2023-04-20 16:26:42,281 - Detection -   train_loss = 1.2404590845108032
2023-04-20 16:26:44,336 - Detection - ***** Epoch: 38: Eval results *****
2023-04-20 16:26:44,336 - Detection -   best_eval_score = 72.55
2023-04-20 16:26:44,336 - Detection -   eval_score = 72.32
2023-04-20 16:26:44,336 - Detection -   train_loss = 1.2463210940361023
2023-04-20 16:26:46,365 - Detection - ***** Epoch: 39: Eval results *****
2023-04-20 16:26:46,365 - Detection -   best_eval_score = 72.55
2023-04-20 16:26:46,365 - Detection -   eval_score = 72.25
2023-04-20 16:26:46,365 - Detection -   train_loss = 1.2666726589202881
2023-04-20 16:26:48,407 - Detection - ***** Epoch: 40: Eval results *****
2023-04-20 16:26:48,407 - Detection -   best_eval_score = 72.55
2023-04-20 16:26:48,407 - Detection -   eval_score = 72.38
2023-04-20 16:26:48,407 - Detection -   train_loss = 1.2307169675827025
2023-04-20 16:26:50,463 - Detection - ***** Epoch: 41: Eval results *****
2023-04-20 16:26:50,463 - Detection -   best_eval_score = 72.55
2023-04-20 16:26:50,463 - Detection -   eval_score = 72.42
2023-04-20 16:26:50,463 - Detection -   train_loss = 1.2742194533348083
2023-04-20 16:26:52,497 - Detection - ***** Epoch: 42: Eval results *****
2023-04-20 16:26:52,497 - Detection -   best_eval_score = 72.55
2023-04-20 16:26:52,497 - Detection -   eval_score = 72.42
2023-04-20 16:26:52,497 - Detection -   train_loss = 1.2145903706550598
2023-04-20 16:26:52,498 - Detection - Training Finished...
2023-04-20 16:26:52,498 - Detection - Testing begin...
2023-04-20 16:26:54,593 - Detection - ***** Test: Confusion Matrix *****
2023-04-20 16:26:54,593 - Detection - [[  3   0   0 ...   0   0  13]
 [  0  19   0 ...   0   0   8]
 [  0   0   2 ...   0   0   6]
 ...
 [  0   0   0 ...  16   0   1]
 [  0   0   0 ...   0  17  13]
 [  0  31   1 ...  10  12 697]]
2023-04-20 16:26:54,593 - Detection - ***** Test results *****
2023-04-20 16:26:54,593 - Detection -   Acc = 67.41
2023-04-20 16:26:54,593 - Detection -   F1 = 61.2051
2023-04-20 16:26:54,593 - Detection -   F1-known = 60.9287
2023-04-20 16:26:54,593 - Detection -   F1-open = 71.7078
2023-04-20 16:26:54,593 - Detection - Testing finished...
2023-04-20 16:26:54,594 - Detection - Results saved in results/results_ADB.csv
2023-04-20 16:26:54,613 - Detection - Open Intent Detection Finished...
