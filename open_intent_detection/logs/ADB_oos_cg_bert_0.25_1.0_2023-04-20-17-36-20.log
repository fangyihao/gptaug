2023-04-20 17:36:20,187 - Detection - Open Intent Detection Begin...
2023-04-20 17:36:20,187 - Detection - Parameters Initialization...
2023-04-20 17:36:20,188 - Detection - ============================== Params ==============================
2023-04-20 17:36:20,188 - Detection - type:	open_intent_detection
2023-04-20 17:36:20,188 - Detection - logger_name:	Detection
2023-04-20 17:36:20,188 - Detection - log_dir:	logs
2023-04-20 17:36:20,188 - Detection - dataset:	oos_cg
2023-04-20 17:36:20,188 - Detection - known_cls_ratio:	0.25
2023-04-20 17:36:20,188 - Detection - labeled_ratio:	1.0
2023-04-20 17:36:20,188 - Detection - method:	ADB
2023-04-20 17:36:20,188 - Detection - train:	True
2023-04-20 17:36:20,188 - Detection - pretrain:	True
2023-04-20 17:36:20,188 - Detection - save_model:	True
2023-04-20 17:36:20,188 - Detection - backbone:	bert
2023-04-20 17:36:20,188 - Detection - config_file_name:	ADB
2023-04-20 17:36:20,188 - Detection - seed:	1
2023-04-20 17:36:20,188 - Detection - gpu_id:	0
2023-04-20 17:36:20,188 - Detection - pipe_results_path:	pipe_results
2023-04-20 17:36:20,188 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-20 17:36:20,188 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-20 17:36:20,188 - Detection - model_dir:	models
2023-04-20 17:36:20,188 - Detection - load_pretrained_method:	None
2023-04-20 17:36:20,188 - Detection - result_dir:	results
2023-04-20 17:36:20,188 - Detection - results_file_name:	results_ADB.csv
2023-04-20 17:36:20,188 - Detection - save_results:	True
2023-04-20 17:36:20,188 - Detection - loss_fct:	CrossEntropyLoss
2023-04-20 17:36:20,188 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_cg_0.25_1.0_bert_1
2023-04-20 17:36:20,188 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_cg_0.25_1.0_bert_1/models
2023-04-20 17:36:20,188 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-20 17:36:20,188 - Detection - num_train_epochs:	100
2023-04-20 17:36:20,188 - Detection - num_labels:	None
2023-04-20 17:36:20,188 - Detection - max_seq_length:	None
2023-04-20 17:36:20,188 - Detection - freeze_backbone_parameters:	True
2023-04-20 17:36:20,188 - Detection - feat_dim:	768
2023-04-20 17:36:20,188 - Detection - warmup_proportion:	0.1
2023-04-20 17:36:20,188 - Detection - lr_boundary:	0.05
2023-04-20 17:36:20,188 - Detection - lr:	2e-05
2023-04-20 17:36:20,188 - Detection - activation:	relu
2023-04-20 17:36:20,188 - Detection - train_batch_size:	128
2023-04-20 17:36:20,188 - Detection - eval_batch_size:	64
2023-04-20 17:36:20,188 - Detection - test_batch_size:	64
2023-04-20 17:36:20,188 - Detection - wait_patient:	10
2023-04-20 17:36:20,188 - Detection - ============================== End Params ==============================
2023-04-20 17:36:20,188 - Detection - Data and Model Preparation...
2023-04-20 17:36:20,189 - Detection - The number of known intents is 38
2023-04-20 17:36:20,189 - Detection - Lists of known labels are: ['calories', 'report_fraud', 'next_song', 'cancel_reservation', 'translate', 'ingredients_list', 'what_are_your_hobbies', 'food_last', 'credit_limit_change', 'thank_you', 'reminder', 'are_you_a_bot', 'restaurant_reviews', 'how_busy', 'oil_change_how', 'flight_status', 'recipe', 'maybe', 'current_location', 'direct_deposit', 'pto_request_status', 'payday', 'nutrition_info', 'expiration_date', 'tire_pressure', 'report_lost_card', 'date', 'carry_on', 'new_card', 'whisper_mode', 'pto_used', 'uber', 'measurement_conversion', 'traffic', 'spelling', 'gas_type', 'improve_credit_score', 'credit_limit']
2023-04-20 17:36:20,199 - Detection - Number of labeled training samples = 909
2023-04-20 17:36:20,199 - Detection - Number of unlabeled training samples = 2774
2023-04-20 17:36:20,203 - Detection - Number of evaluation samples = 407
2023-04-20 17:36:20,217 - Detection - Number of testing samples = 3632
2023-04-20 17:36:24,152 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-20 17:36:25,830 - Detection - Pre-training Begin...
2023-04-20 17:36:27,217 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 17:36:27,218 - Detection -   best_eval_score = 0
2023-04-20 17:36:27,218 - Detection -   eval_score = 2.95
2023-04-20 17:36:27,218 - Detection -   train_loss = 3.641788989305496
2023-04-20 17:36:28,086 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 17:36:28,086 - Detection -   best_eval_score = 2.95
2023-04-20 17:36:28,086 - Detection -   eval_score = 3.44
2023-04-20 17:36:28,086 - Detection -   train_loss = 3.6276930570602417
2023-04-20 17:36:28,958 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 17:36:28,958 - Detection -   best_eval_score = 3.44
2023-04-20 17:36:28,958 - Detection -   eval_score = 5.16
2023-04-20 17:36:28,958 - Detection -   train_loss = 3.5969721972942352
2023-04-20 17:36:29,830 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 17:36:29,830 - Detection -   best_eval_score = 5.16
2023-04-20 17:36:29,831 - Detection -   eval_score = 6.39
2023-04-20 17:36:29,831 - Detection -   train_loss = 3.5411394238471985
2023-04-20 17:36:30,725 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 17:36:30,725 - Detection -   best_eval_score = 6.39
2023-04-20 17:36:30,725 - Detection -   eval_score = 7.13
2023-04-20 17:36:30,725 - Detection -   train_loss = 3.4732002317905426
2023-04-20 17:36:31,631 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 17:36:31,631 - Detection -   best_eval_score = 7.13
2023-04-20 17:36:31,631 - Detection -   eval_score = 8.11
2023-04-20 17:36:31,631 - Detection -   train_loss = 3.3635529577732086
2023-04-20 17:36:32,539 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 17:36:32,539 - Detection -   best_eval_score = 8.11
2023-04-20 17:36:32,539 - Detection -   eval_score = 10.81
2023-04-20 17:36:32,539 - Detection -   train_loss = 3.155564934015274
2023-04-20 17:36:33,422 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 17:36:33,423 - Detection -   best_eval_score = 10.81
2023-04-20 17:36:33,423 - Detection -   eval_score = 15.97
2023-04-20 17:36:33,423 - Detection -   train_loss = 2.896392673254013
2023-04-20 17:36:34,412 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 17:36:34,412 - Detection -   best_eval_score = 15.97
2023-04-20 17:36:34,412 - Detection -   eval_score = 24.57
2023-04-20 17:36:34,412 - Detection -   train_loss = 2.529480516910553
2023-04-20 17:36:35,304 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 17:36:35,304 - Detection -   best_eval_score = 24.57
2023-04-20 17:36:35,304 - Detection -   eval_score = 32.43
2023-04-20 17:36:35,304 - Detection -   train_loss = 2.0788903683423996
2023-04-20 17:36:36,199 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 17:36:36,199 - Detection -   best_eval_score = 32.43
2023-04-20 17:36:36,199 - Detection -   eval_score = 38.82
2023-04-20 17:36:36,199 - Detection -   train_loss = 1.7131653428077698
2023-04-20 17:36:37,088 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 17:36:37,088 - Detection -   best_eval_score = 38.82
2023-04-20 17:36:37,088 - Detection -   eval_score = 46.93
2023-04-20 17:36:37,088 - Detection -   train_loss = 1.452369749546051
2023-04-20 17:36:37,983 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 17:36:37,983 - Detection -   best_eval_score = 46.93
2023-04-20 17:36:37,983 - Detection -   eval_score = 57.49
2023-04-20 17:36:37,983 - Detection -   train_loss = 1.252601146697998
2023-04-20 17:36:38,915 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 17:36:38,915 - Detection -   best_eval_score = 57.49
2023-04-20 17:36:38,915 - Detection -   eval_score = 63.88
2023-04-20 17:36:38,915 - Detection -   train_loss = 1.060942754149437
2023-04-20 17:36:39,817 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 17:36:39,817 - Detection -   best_eval_score = 63.88
2023-04-20 17:36:39,817 - Detection -   eval_score = 67.08
2023-04-20 17:36:39,817 - Detection -   train_loss = 0.8618410676717758
2023-04-20 17:36:40,696 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 17:36:40,697 - Detection -   best_eval_score = 67.08
2023-04-20 17:36:40,697 - Detection -   eval_score = 67.57
2023-04-20 17:36:40,697 - Detection -   train_loss = 0.7275694981217384
2023-04-20 17:36:41,620 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 17:36:41,620 - Detection -   best_eval_score = 67.57
2023-04-20 17:36:41,620 - Detection -   eval_score = 70.76
2023-04-20 17:36:41,620 - Detection -   train_loss = 0.6459648460149765
2023-04-20 17:36:42,530 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 17:36:42,530 - Detection -   best_eval_score = 70.76
2023-04-20 17:36:42,530 - Detection -   eval_score = 71.99
2023-04-20 17:36:42,530 - Detection -   train_loss = 0.5845799744129181
2023-04-20 17:36:43,435 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 17:36:43,435 - Detection -   best_eval_score = 71.99
2023-04-20 17:36:43,435 - Detection -   eval_score = 74.45
2023-04-20 17:36:43,435 - Detection -   train_loss = 0.4783598631620407
2023-04-20 17:36:44,328 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 17:36:44,328 - Detection -   best_eval_score = 74.45
2023-04-20 17:36:44,328 - Detection -   eval_score = 76.41
2023-04-20 17:36:44,329 - Detection -   train_loss = 0.40960124135017395
2023-04-20 17:36:45,241 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 17:36:45,241 - Detection -   best_eval_score = 76.41
2023-04-20 17:36:45,241 - Detection -   eval_score = 77.64
2023-04-20 17:36:45,241 - Detection -   train_loss = 0.3979284502565861
2023-04-20 17:36:46,155 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 17:36:46,155 - Detection -   best_eval_score = 77.64
2023-04-20 17:36:46,155 - Detection -   eval_score = 77.89
2023-04-20 17:36:46,155 - Detection -   train_loss = 0.35034335032105446
2023-04-20 17:36:47,085 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 17:36:47,085 - Detection -   best_eval_score = 77.89
2023-04-20 17:36:47,085 - Detection -   eval_score = 77.64
2023-04-20 17:36:47,085 - Detection -   train_loss = 0.32448194921016693
2023-04-20 17:36:47,982 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 17:36:47,982 - Detection -   best_eval_score = 77.89
2023-04-20 17:36:47,982 - Detection -   eval_score = 78.38
2023-04-20 17:36:47,982 - Detection -   train_loss = 0.27153973653912544
2023-04-20 17:36:48,893 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 17:36:48,893 - Detection -   best_eval_score = 78.38
2023-04-20 17:36:48,893 - Detection -   eval_score = 78.87
2023-04-20 17:36:48,893 - Detection -   train_loss = 0.2641124501824379
2023-04-20 17:36:49,805 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 17:36:49,805 - Detection -   best_eval_score = 78.87
2023-04-20 17:36:49,805 - Detection -   eval_score = 78.87
2023-04-20 17:36:49,805 - Detection -   train_loss = 0.2340325340628624
2023-04-20 17:36:50,714 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 17:36:50,715 - Detection -   best_eval_score = 78.87
2023-04-20 17:36:50,715 - Detection -   eval_score = 80.1
2023-04-20 17:36:50,715 - Detection -   train_loss = 0.21761689148843288
2023-04-20 17:36:51,626 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 17:36:51,626 - Detection -   best_eval_score = 80.1
2023-04-20 17:36:51,627 - Detection -   eval_score = 81.57
2023-04-20 17:36:51,627 - Detection -   train_loss = 0.20582748763263226
2023-04-20 17:36:52,540 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 17:36:52,540 - Detection -   best_eval_score = 81.57
2023-04-20 17:36:52,540 - Detection -   eval_score = 81.57
2023-04-20 17:36:52,541 - Detection -   train_loss = 0.1868522297590971
2023-04-20 17:36:53,457 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 17:36:53,457 - Detection -   best_eval_score = 81.57
2023-04-20 17:36:53,457 - Detection -   eval_score = 82.06
2023-04-20 17:36:53,457 - Detection -   train_loss = 0.1928818430751562
2023-04-20 17:36:54,383 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 17:36:54,383 - Detection -   best_eval_score = 82.06
2023-04-20 17:36:54,383 - Detection -   eval_score = 82.06
2023-04-20 17:36:54,383 - Detection -   train_loss = 0.17280680686235428
2023-04-20 17:36:55,306 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 17:36:55,306 - Detection -   best_eval_score = 82.06
2023-04-20 17:36:55,306 - Detection -   eval_score = 82.31
2023-04-20 17:36:55,306 - Detection -   train_loss = 0.16871928609907627
2023-04-20 17:36:56,233 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 17:36:56,233 - Detection -   best_eval_score = 82.31
2023-04-20 17:36:56,233 - Detection -   eval_score = 82.31
2023-04-20 17:36:56,233 - Detection -   train_loss = 0.15347370505332947
2023-04-20 17:36:57,142 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 17:36:57,143 - Detection -   best_eval_score = 82.31
2023-04-20 17:36:57,143 - Detection -   eval_score = 81.33
2023-04-20 17:36:57,143 - Detection -   train_loss = 0.1431951830163598
2023-04-20 17:36:58,061 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 17:36:58,061 - Detection -   best_eval_score = 82.31
2023-04-20 17:36:58,061 - Detection -   eval_score = 82.06
2023-04-20 17:36:58,061 - Detection -   train_loss = 0.13728124182671309
2023-04-20 17:36:58,975 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 17:36:58,975 - Detection -   best_eval_score = 82.31
2023-04-20 17:36:58,976 - Detection -   eval_score = 82.31
2023-04-20 17:36:58,976 - Detection -   train_loss = 0.1402744334191084
2023-04-20 17:36:59,923 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 17:36:59,923 - Detection -   best_eval_score = 82.31
2023-04-20 17:36:59,923 - Detection -   eval_score = 82.06
2023-04-20 17:36:59,923 - Detection -   train_loss = 0.13108775299042463
2023-04-20 17:37:00,863 - Detection - ***** Epoch: 38: Eval results *****
2023-04-20 17:37:00,863 - Detection -   best_eval_score = 82.31
2023-04-20 17:37:00,863 - Detection -   eval_score = 82.31
2023-04-20 17:37:00,863 - Detection -   train_loss = 0.119562610052526
2023-04-20 17:37:01,820 - Detection - ***** Epoch: 39: Eval results *****
2023-04-20 17:37:01,820 - Detection -   best_eval_score = 82.31
2023-04-20 17:37:01,820 - Detection -   eval_score = 82.31
2023-04-20 17:37:01,820 - Detection -   train_loss = 0.11921185720711946
2023-04-20 17:37:02,759 - Detection - ***** Epoch: 40: Eval results *****
2023-04-20 17:37:02,759 - Detection -   best_eval_score = 82.31
2023-04-20 17:37:02,759 - Detection -   eval_score = 83.54
2023-04-20 17:37:02,759 - Detection -   train_loss = 0.10716148605570197
2023-04-20 17:37:03,703 - Detection - ***** Epoch: 41: Eval results *****
2023-04-20 17:37:03,703 - Detection -   best_eval_score = 83.54
2023-04-20 17:37:03,703 - Detection -   eval_score = 83.29
2023-04-20 17:37:03,703 - Detection -   train_loss = 0.1075173569843173
2023-04-20 17:37:04,635 - Detection - ***** Epoch: 42: Eval results *****
2023-04-20 17:37:04,635 - Detection -   best_eval_score = 83.54
2023-04-20 17:37:04,635 - Detection -   eval_score = 83.05
2023-04-20 17:37:04,635 - Detection -   train_loss = 0.10463690012693405
2023-04-20 17:37:05,575 - Detection - ***** Epoch: 43: Eval results *****
2023-04-20 17:37:05,575 - Detection -   best_eval_score = 83.54
2023-04-20 17:37:05,575 - Detection -   eval_score = 83.05
2023-04-20 17:37:05,575 - Detection -   train_loss = 0.0999967074021697
2023-04-20 17:37:06,518 - Detection - ***** Epoch: 44: Eval results *****
2023-04-20 17:37:06,518 - Detection -   best_eval_score = 83.54
2023-04-20 17:37:06,518 - Detection -   eval_score = 83.05
2023-04-20 17:37:06,518 - Detection -   train_loss = 0.09410698432475328
2023-04-20 17:37:07,457 - Detection - ***** Epoch: 45: Eval results *****
2023-04-20 17:37:07,457 - Detection -   best_eval_score = 83.54
2023-04-20 17:37:07,458 - Detection -   eval_score = 83.29
2023-04-20 17:37:07,458 - Detection -   train_loss = 0.09132178872823715
2023-04-20 17:37:08,398 - Detection - ***** Epoch: 46: Eval results *****
2023-04-20 17:37:08,398 - Detection -   best_eval_score = 83.54
2023-04-20 17:37:08,398 - Detection -   eval_score = 83.54
2023-04-20 17:37:08,398 - Detection -   train_loss = 0.0874272407963872
2023-04-20 17:37:09,339 - Detection - ***** Epoch: 47: Eval results *****
2023-04-20 17:37:09,339 - Detection -   best_eval_score = 83.54
2023-04-20 17:37:09,339 - Detection -   eval_score = 83.78
2023-04-20 17:37:09,339 - Detection -   train_loss = 0.08984770812094212
2023-04-20 17:37:10,292 - Detection - ***** Epoch: 48: Eval results *****
2023-04-20 17:37:10,292 - Detection -   best_eval_score = 83.78
2023-04-20 17:37:10,292 - Detection -   eval_score = 83.78
2023-04-20 17:37:10,292 - Detection -   train_loss = 0.08750697504729033
2023-04-20 17:37:11,213 - Detection - ***** Epoch: 49: Eval results *****
2023-04-20 17:37:11,213 - Detection -   best_eval_score = 83.78
2023-04-20 17:37:11,213 - Detection -   eval_score = 84.03
2023-04-20 17:37:11,213 - Detection -   train_loss = 0.08583196345716715
2023-04-20 17:37:12,161 - Detection - ***** Epoch: 50: Eval results *****
2023-04-20 17:37:12,161 - Detection -   best_eval_score = 84.03
2023-04-20 17:37:12,161 - Detection -   eval_score = 84.28
2023-04-20 17:37:12,161 - Detection -   train_loss = 0.07925957255065441
2023-04-20 17:37:13,213 - Detection - ***** Epoch: 51: Eval results *****
2023-04-20 17:37:13,213 - Detection -   best_eval_score = 84.28
2023-04-20 17:37:13,213 - Detection -   eval_score = 85.01
2023-04-20 17:37:13,213 - Detection -   train_loss = 0.07508781924843788
2023-04-20 17:37:14,167 - Detection - ***** Epoch: 52: Eval results *****
2023-04-20 17:37:14,167 - Detection -   best_eval_score = 85.01
2023-04-20 17:37:14,167 - Detection -   eval_score = 85.26
2023-04-20 17:37:14,167 - Detection -   train_loss = 0.07417540857568383
2023-04-20 17:37:15,114 - Detection - ***** Epoch: 53: Eval results *****
2023-04-20 17:37:15,114 - Detection -   best_eval_score = 85.26
2023-04-20 17:37:15,115 - Detection -   eval_score = 85.01
2023-04-20 17:37:15,115 - Detection -   train_loss = 0.07125813141465187
2023-04-20 17:37:16,038 - Detection - ***** Epoch: 54: Eval results *****
2023-04-20 17:37:16,038 - Detection -   best_eval_score = 85.26
2023-04-20 17:37:16,038 - Detection -   eval_score = 84.28
2023-04-20 17:37:16,038 - Detection -   train_loss = 0.07364038936793804
2023-04-20 17:37:16,965 - Detection - ***** Epoch: 55: Eval results *****
2023-04-20 17:37:16,965 - Detection -   best_eval_score = 85.26
2023-04-20 17:37:16,965 - Detection -   eval_score = 84.77
2023-04-20 17:37:16,965 - Detection -   train_loss = 0.06688292743638158
2023-04-20 17:37:17,887 - Detection - ***** Epoch: 56: Eval results *****
2023-04-20 17:37:17,888 - Detection -   best_eval_score = 85.26
2023-04-20 17:37:17,888 - Detection -   eval_score = 84.77
2023-04-20 17:37:17,888 - Detection -   train_loss = 0.08703347202390432
2023-04-20 17:37:18,804 - Detection - ***** Epoch: 57: Eval results *****
2023-04-20 17:37:18,804 - Detection -   best_eval_score = 85.26
2023-04-20 17:37:18,804 - Detection -   eval_score = 84.28
2023-04-20 17:37:18,804 - Detection -   train_loss = 0.07033981755375862
2023-04-20 17:37:19,730 - Detection - ***** Epoch: 58: Eval results *****
2023-04-20 17:37:19,731 - Detection -   best_eval_score = 85.26
2023-04-20 17:37:19,731 - Detection -   eval_score = 84.28
2023-04-20 17:37:19,731 - Detection -   train_loss = 0.06621231511235237
2023-04-20 17:37:20,659 - Detection - ***** Epoch: 59: Eval results *****
2023-04-20 17:37:20,659 - Detection -   best_eval_score = 85.26
2023-04-20 17:37:20,659 - Detection -   eval_score = 84.28
2023-04-20 17:37:20,659 - Detection -   train_loss = 0.06134754652157426
2023-04-20 17:37:21,585 - Detection - ***** Epoch: 60: Eval results *****
2023-04-20 17:37:21,586 - Detection -   best_eval_score = 85.26
2023-04-20 17:37:21,586 - Detection -   eval_score = 84.77
2023-04-20 17:37:21,586 - Detection -   train_loss = 0.06016481318511069
2023-04-20 17:37:22,506 - Detection - ***** Epoch: 61: Eval results *****
2023-04-20 17:37:22,506 - Detection -   best_eval_score = 85.26
2023-04-20 17:37:22,506 - Detection -   eval_score = 84.52
2023-04-20 17:37:22,506 - Detection -   train_loss = 0.0653897738084197
2023-04-20 17:37:23,431 - Detection - ***** Epoch: 62: Eval results *****
2023-04-20 17:37:23,431 - Detection -   best_eval_score = 85.26
2023-04-20 17:37:23,431 - Detection -   eval_score = 84.77
2023-04-20 17:37:23,432 - Detection -   train_loss = 0.060590047389268875
2023-04-20 17:37:23,432 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_cg_0.25_1.0_bert_1/models
2023-04-20 17:37:23,977 - Detection - Pre-training finished...
2023-04-20 17:37:23,977 - Detection - Training Begin...
2023-04-20 17:37:25,455 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 17:37:25,455 - Detection -   best_eval_score = 0
2023-04-20 17:37:25,455 - Detection -   eval_score = 0.0
2023-04-20 17:37:25,455 - Detection -   train_loss = 9.176870942115784
2023-04-20 17:37:26,407 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 17:37:26,407 - Detection -   best_eval_score = 0
2023-04-20 17:37:26,407 - Detection -   eval_score = 0.0
2023-04-20 17:37:26,407 - Detection -   train_loss = 8.86802887916565
2023-04-20 17:37:27,371 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 17:37:27,372 - Detection -   best_eval_score = 0
2023-04-20 17:37:27,372 - Detection -   eval_score = 0.0
2023-04-20 17:37:27,372 - Detection -   train_loss = 8.693979144096375
2023-04-20 17:37:28,323 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 17:37:28,323 - Detection -   best_eval_score = 0
2023-04-20 17:37:28,323 - Detection -   eval_score = 0.0
2023-04-20 17:37:28,323 - Detection -   train_loss = 8.413486242294312
2023-04-20 17:37:29,255 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 17:37:29,256 - Detection -   best_eval_score = 0
2023-04-20 17:37:29,256 - Detection -   eval_score = 0.0
2023-04-20 17:37:29,256 - Detection -   train_loss = 8.106749892234802
2023-04-20 17:37:30,182 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 17:37:30,182 - Detection -   best_eval_score = 0
2023-04-20 17:37:30,182 - Detection -   eval_score = 0.0
2023-04-20 17:37:30,182 - Detection -   train_loss = 7.781175196170807
2023-04-20 17:37:31,107 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 17:37:31,107 - Detection -   best_eval_score = 0
2023-04-20 17:37:31,107 - Detection -   eval_score = 0.0
2023-04-20 17:37:31,107 - Detection -   train_loss = 7.4453540444374084
2023-04-20 17:37:32,034 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 17:37:32,034 - Detection -   best_eval_score = 0
2023-04-20 17:37:32,034 - Detection -   eval_score = 0.0
2023-04-20 17:37:32,034 - Detection -   train_loss = 7.090115070343018
2023-04-20 17:37:32,970 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 17:37:32,970 - Detection -   best_eval_score = 0
2023-04-20 17:37:32,970 - Detection -   eval_score = 0.43
2023-04-20 17:37:32,970 - Detection -   train_loss = 6.732879102230072
2023-04-20 17:37:33,897 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 17:37:33,897 - Detection -   best_eval_score = 0.43
2023-04-20 17:37:33,897 - Detection -   eval_score = 0.94
2023-04-20 17:37:33,897 - Detection -   train_loss = 6.498354256153107
2023-04-20 17:37:34,826 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 17:37:34,826 - Detection -   best_eval_score = 0.94
2023-04-20 17:37:34,826 - Detection -   eval_score = 3.48
2023-04-20 17:37:34,826 - Detection -   train_loss = 6.0210957527160645
2023-04-20 17:37:35,760 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 17:37:35,760 - Detection -   best_eval_score = 3.48
2023-04-20 17:37:35,760 - Detection -   eval_score = 5.27
2023-04-20 17:37:35,760 - Detection -   train_loss = 5.675853669643402
2023-04-20 17:37:36,669 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 17:37:36,669 - Detection -   best_eval_score = 5.27
2023-04-20 17:37:36,669 - Detection -   eval_score = 7.28
2023-04-20 17:37:36,669 - Detection -   train_loss = 5.236009359359741
2023-04-20 17:37:37,593 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 17:37:37,593 - Detection -   best_eval_score = 7.28
2023-04-20 17:37:37,593 - Detection -   eval_score = 9.78
2023-04-20 17:37:37,593 - Detection -   train_loss = 4.887417256832123
2023-04-20 17:37:38,512 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 17:37:38,512 - Detection -   best_eval_score = 9.78
2023-04-20 17:37:38,512 - Detection -   eval_score = 13.01
2023-04-20 17:37:38,512 - Detection -   train_loss = 4.525520026683807
2023-04-20 17:37:39,459 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 17:37:39,459 - Detection -   best_eval_score = 13.01
2023-04-20 17:37:39,459 - Detection -   eval_score = 16.5
2023-04-20 17:37:39,459 - Detection -   train_loss = 4.188832461833954
2023-04-20 17:37:40,390 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 17:37:40,390 - Detection -   best_eval_score = 16.5
2023-04-20 17:37:40,390 - Detection -   eval_score = 19.34
2023-04-20 17:37:40,391 - Detection -   train_loss = 3.844778925180435
2023-04-20 17:37:41,310 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 17:37:41,310 - Detection -   best_eval_score = 19.34
2023-04-20 17:37:41,310 - Detection -   eval_score = 21.63
2023-04-20 17:37:41,310 - Detection -   train_loss = 3.460407257080078
2023-04-20 17:37:42,236 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 17:37:42,236 - Detection -   best_eval_score = 21.63
2023-04-20 17:37:42,236 - Detection -   eval_score = 26.26
2023-04-20 17:37:42,236 - Detection -   train_loss = 3.101072072982788
2023-04-20 17:37:43,159 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 17:37:43,159 - Detection -   best_eval_score = 26.26
2023-04-20 17:37:43,159 - Detection -   eval_score = 29.85
2023-04-20 17:37:43,159 - Detection -   train_loss = 2.825527161359787
2023-04-20 17:37:44,073 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 17:37:44,073 - Detection -   best_eval_score = 29.85
2023-04-20 17:37:44,073 - Detection -   eval_score = 33.48
2023-04-20 17:37:44,073 - Detection -   train_loss = 2.463189959526062
2023-04-20 17:37:45,009 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 17:37:45,009 - Detection -   best_eval_score = 33.48
2023-04-20 17:37:45,009 - Detection -   eval_score = 36.39
2023-04-20 17:37:45,009 - Detection -   train_loss = 2.108154460787773
2023-04-20 17:37:45,928 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 17:37:45,929 - Detection -   best_eval_score = 36.39
2023-04-20 17:37:45,929 - Detection -   eval_score = 39.53
2023-04-20 17:37:45,929 - Detection -   train_loss = 1.7735009342432022
2023-04-20 17:37:46,854 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 17:37:46,854 - Detection -   best_eval_score = 39.53
2023-04-20 17:37:46,854 - Detection -   eval_score = 44.9
2023-04-20 17:37:46,854 - Detection -   train_loss = 1.6601077914237976
2023-04-20 17:37:47,776 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 17:37:47,776 - Detection -   best_eval_score = 44.9
2023-04-20 17:37:47,776 - Detection -   eval_score = 47.58
2023-04-20 17:37:47,776 - Detection -   train_loss = 1.5224102139472961
2023-04-20 17:37:48,693 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 17:37:48,693 - Detection -   best_eval_score = 47.58
2023-04-20 17:37:48,693 - Detection -   eval_score = 50.96
2023-04-20 17:37:48,693 - Detection -   train_loss = 1.3368910402059555
2023-04-20 17:37:49,601 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 17:37:49,601 - Detection -   best_eval_score = 50.96
2023-04-20 17:37:49,601 - Detection -   eval_score = 52.94
2023-04-20 17:37:49,601 - Detection -   train_loss = 1.2177027016878128
2023-04-20 17:37:50,520 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 17:37:50,520 - Detection -   best_eval_score = 52.94
2023-04-20 17:37:50,520 - Detection -   eval_score = 54.67
2023-04-20 17:37:50,520 - Detection -   train_loss = 1.137884482741356
2023-04-20 17:37:51,434 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 17:37:51,434 - Detection -   best_eval_score = 54.67
2023-04-20 17:37:51,434 - Detection -   eval_score = 57.49
2023-04-20 17:37:51,434 - Detection -   train_loss = 1.0985440611839294
2023-04-20 17:37:52,375 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 17:37:52,376 - Detection -   best_eval_score = 57.49
2023-04-20 17:37:52,376 - Detection -   eval_score = 57.7
2023-04-20 17:37:52,376 - Detection -   train_loss = 1.0568339750170708
2023-04-20 17:37:53,344 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 17:37:53,344 - Detection -   best_eval_score = 57.7
2023-04-20 17:37:53,344 - Detection -   eval_score = 58.12
2023-04-20 17:37:53,344 - Detection -   train_loss = 0.9875405505299568
2023-04-20 17:37:54,272 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 17:37:54,272 - Detection -   best_eval_score = 58.12
2023-04-20 17:37:54,272 - Detection -   eval_score = 58.5
2023-04-20 17:37:54,272 - Detection -   train_loss = 1.027381882071495
2023-04-20 17:37:55,216 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 17:37:55,216 - Detection -   best_eval_score = 58.5
2023-04-20 17:37:55,216 - Detection -   eval_score = 59.08
2023-04-20 17:37:55,216 - Detection -   train_loss = 1.0247495919466019
2023-04-20 17:37:56,155 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 17:37:56,155 - Detection -   best_eval_score = 59.08
2023-04-20 17:37:56,155 - Detection -   eval_score = 59.52
2023-04-20 17:37:56,155 - Detection -   train_loss = 1.0635824352502823
2023-04-20 17:37:57,087 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 17:37:57,087 - Detection -   best_eval_score = 59.52
2023-04-20 17:37:57,087 - Detection -   eval_score = 59.74
2023-04-20 17:37:57,087 - Detection -   train_loss = 1.041207678616047
2023-04-20 17:37:58,087 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 17:37:58,087 - Detection -   best_eval_score = 59.74
2023-04-20 17:37:58,087 - Detection -   eval_score = 60.0
2023-04-20 17:37:58,088 - Detection -   train_loss = 0.9643667116761208
2023-04-20 17:37:59,017 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 17:37:59,017 - Detection -   best_eval_score = 60.0
2023-04-20 17:37:59,017 - Detection -   eval_score = 60.13
2023-04-20 17:37:59,017 - Detection -   train_loss = 1.0017436295747757
2023-04-20 17:37:59,948 - Detection - ***** Epoch: 38: Eval results *****
2023-04-20 17:37:59,948 - Detection -   best_eval_score = 60.13
2023-04-20 17:37:59,948 - Detection -   eval_score = 60.35
2023-04-20 17:37:59,949 - Detection -   train_loss = 0.9949421882629395
2023-04-20 17:38:00,880 - Detection - ***** Epoch: 39: Eval results *****
2023-04-20 17:38:00,880 - Detection -   best_eval_score = 60.35
2023-04-20 17:38:00,880 - Detection -   eval_score = 60.56
2023-04-20 17:38:00,880 - Detection -   train_loss = 0.9485909417271614
2023-04-20 17:38:01,817 - Detection - ***** Epoch: 40: Eval results *****
2023-04-20 17:38:01,817 - Detection -   best_eval_score = 60.56
2023-04-20 17:38:01,817 - Detection -   eval_score = 60.65
2023-04-20 17:38:01,817 - Detection -   train_loss = 0.9809780269861221
2023-04-20 17:38:02,740 - Detection - ***** Epoch: 41: Eval results *****
2023-04-20 17:38:02,740 - Detection -   best_eval_score = 60.65
2023-04-20 17:38:02,740 - Detection -   eval_score = 60.5
2023-04-20 17:38:02,740 - Detection -   train_loss = 1.0308501571416855
2023-04-20 17:38:03,671 - Detection - ***** Epoch: 42: Eval results *****
2023-04-20 17:38:03,672 - Detection -   best_eval_score = 60.65
2023-04-20 17:38:03,672 - Detection -   eval_score = 60.68
2023-04-20 17:38:03,672 - Detection -   train_loss = 0.9203261807560921
2023-04-20 17:38:04,574 - Detection - ***** Epoch: 43: Eval results *****
2023-04-20 17:38:04,574 - Detection -   best_eval_score = 60.68
2023-04-20 17:38:04,574 - Detection -   eval_score = 60.68
2023-04-20 17:38:04,574 - Detection -   train_loss = 0.9992770105600357
2023-04-20 17:38:05,492 - Detection - ***** Epoch: 44: Eval results *****
2023-04-20 17:38:05,492 - Detection -   best_eval_score = 60.68
2023-04-20 17:38:05,492 - Detection -   eval_score = 60.99
2023-04-20 17:38:05,492 - Detection -   train_loss = 0.9851434603333473
2023-04-20 17:38:06,393 - Detection - ***** Epoch: 45: Eval results *****
2023-04-20 17:38:06,393 - Detection -   best_eval_score = 60.99
2023-04-20 17:38:06,393 - Detection -   eval_score = 60.78
2023-04-20 17:38:06,393 - Detection -   train_loss = 0.9831403270363808
2023-04-20 17:38:07,320 - Detection - ***** Epoch: 46: Eval results *****
2023-04-20 17:38:07,321 - Detection -   best_eval_score = 60.99
2023-04-20 17:38:07,321 - Detection -   eval_score = 60.73
2023-04-20 17:38:07,321 - Detection -   train_loss = 1.051619604229927
2023-04-20 17:38:08,236 - Detection - ***** Epoch: 47: Eval results *****
2023-04-20 17:38:08,236 - Detection -   best_eval_score = 60.99
2023-04-20 17:38:08,236 - Detection -   eval_score = 60.51
2023-04-20 17:38:08,236 - Detection -   train_loss = 0.9234443232417107
2023-04-20 17:38:09,163 - Detection - ***** Epoch: 48: Eval results *****
2023-04-20 17:38:09,163 - Detection -   best_eval_score = 60.99
2023-04-20 17:38:09,163 - Detection -   eval_score = 60.5
2023-04-20 17:38:09,163 - Detection -   train_loss = 1.0063046663999557
2023-04-20 17:38:10,072 - Detection - ***** Epoch: 49: Eval results *****
2023-04-20 17:38:10,072 - Detection -   best_eval_score = 60.99
2023-04-20 17:38:10,072 - Detection -   eval_score = 60.07
2023-04-20 17:38:10,072 - Detection -   train_loss = 0.9964665770530701
2023-04-20 17:38:10,982 - Detection - ***** Epoch: 50: Eval results *****
2023-04-20 17:38:10,982 - Detection -   best_eval_score = 60.99
2023-04-20 17:38:10,982 - Detection -   eval_score = 60.18
2023-04-20 17:38:10,982 - Detection -   train_loss = 0.9718799665570259
2023-04-20 17:38:11,901 - Detection - ***** Epoch: 51: Eval results *****
2023-04-20 17:38:11,901 - Detection -   best_eval_score = 60.99
2023-04-20 17:38:11,901 - Detection -   eval_score = 59.94
2023-04-20 17:38:11,901 - Detection -   train_loss = 0.9804518446326256
2023-04-20 17:38:12,814 - Detection - ***** Epoch: 52: Eval results *****
2023-04-20 17:38:12,814 - Detection -   best_eval_score = 60.99
2023-04-20 17:38:12,814 - Detection -   eval_score = 59.86
2023-04-20 17:38:12,814 - Detection -   train_loss = 1.0810367241501808
2023-04-20 17:38:13,762 - Detection - ***** Epoch: 53: Eval results *****
2023-04-20 17:38:13,762 - Detection -   best_eval_score = 60.99
2023-04-20 17:38:13,762 - Detection -   eval_score = 60.11
2023-04-20 17:38:13,762 - Detection -   train_loss = 0.93174197524786
2023-04-20 17:38:14,698 - Detection - ***** Epoch: 54: Eval results *****
2023-04-20 17:38:14,698 - Detection -   best_eval_score = 60.99
2023-04-20 17:38:14,698 - Detection -   eval_score = 60.91
2023-04-20 17:38:14,698 - Detection -   train_loss = 0.9526037573814392
2023-04-20 17:38:14,700 - Detection - Training Finished...
2023-04-20 17:38:14,700 - Detection - Testing begin...
2023-04-20 17:38:17,022 - Detection - ***** Test: Confusion Matrix *****
2023-04-20 17:38:17,022 - Detection - [[   4    0    0 ...    0    0    7]
 [   0    4    0 ...    0    0   11]
 [   0    0    4 ...    0    0    4]
 ...
 [   0    0    0 ...    2    0    6]
 [   0    0    0 ...    0    1    9]
 [   2    2   14 ...    6    2 2728]]
2023-04-20 17:38:17,022 - Detection - ***** Test results *****
2023-04-20 17:38:17,023 - Detection -   Acc = 84.77
2023-04-20 17:38:17,023 - Detection -   F1 = 53.3523
2023-04-20 17:38:17,023 - Detection -   F1-known = 52.3569
2023-04-20 17:38:17,023 - Detection -   F1-open = 91.1765
2023-04-20 17:38:17,023 - Detection - Testing finished...
2023-04-20 17:38:17,023 - Detection - Results saved in results/results_ADB.csv
2023-04-20 17:38:17,043 - Detection - Open Intent Detection Finished...
