2023-04-23 21:46:23,197 - Detection - Open Intent Detection Begin...
2023-04-23 21:46:23,197 - Detection - Parameters Initialization...
2023-04-23 21:46:23,197 - Detection - ============================== Params ==============================
2023-04-23 21:46:23,197 - Detection - type:	open_intent_detection
2023-04-23 21:46:23,197 - Detection - logger_name:	Detection
2023-04-23 21:46:23,197 - Detection - log_dir:	logs
2023-04-23 21:46:23,197 - Detection - dataset:	stackoverflow_cg
2023-04-23 21:46:23,197 - Detection - known_cls_ratio:	0.25
2023-04-23 21:46:23,197 - Detection - labeled_ratio:	1.0
2023-04-23 21:46:23,197 - Detection - method:	ADB
2023-04-23 21:46:23,197 - Detection - train:	True
2023-04-23 21:46:23,197 - Detection - pretrain:	True
2023-04-23 21:46:23,197 - Detection - save_model:	False
2023-04-23 21:46:23,197 - Detection - backbone:	bert_boost
2023-04-23 21:46:23,197 - Detection - config_file_name:	ADB
2023-04-23 21:46:23,197 - Detection - seed:	5
2023-04-23 21:46:23,197 - Detection - gpu_id:	0
2023-04-23 21:46:23,197 - Detection - pipe_results_path:	pipe_results
2023-04-23 21:46:23,197 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-23 21:46:23,197 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-23 21:46:23,197 - Detection - model_dir:	models
2023-04-23 21:46:23,197 - Detection - load_pretrained_method:	None
2023-04-23 21:46:23,197 - Detection - result_dir:	results
2023-04-23 21:46:23,197 - Detection - results_file_name:	results_ADB-BOOST-F-4.csv
2023-04-23 21:46:23,197 - Detection - save_results:	True
2023-04-23 21:46:23,197 - Detection - loss_fct:	CrossEntropyLoss
2023-04-23 21:46:23,197 - Detection - boost_method:	F-4
2023-04-23 21:46:23,197 - Detection - boost_start_score:	0.0
2023-04-23 21:46:23,197 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.25_1.0_bert_boost_5
2023-04-23 21:46:23,197 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.25_1.0_bert_boost_5/models
2023-04-23 21:46:23,197 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-23 21:46:23,197 - Detection - num_train_epochs:	100
2023-04-23 21:46:23,198 - Detection - num_labels:	None
2023-04-23 21:46:23,198 - Detection - max_seq_length:	None
2023-04-23 21:46:23,198 - Detection - freeze_backbone_parameters:	True
2023-04-23 21:46:23,198 - Detection - feat_dim:	768
2023-04-23 21:46:23,198 - Detection - warmup_proportion:	0.1
2023-04-23 21:46:23,198 - Detection - lr_boundary:	0.05
2023-04-23 21:46:23,198 - Detection - lr:	2e-05
2023-04-23 21:46:23,198 - Detection - activation:	relu
2023-04-23 21:46:23,198 - Detection - train_batch_size:	128
2023-04-23 21:46:23,198 - Detection - eval_batch_size:	64
2023-04-23 21:46:23,198 - Detection - test_batch_size:	64
2023-04-23 21:46:23,198 - Detection - wait_patient:	10
2023-04-23 21:46:23,198 - Detection - ============================== End Params ==============================
2023-04-23 21:46:23,198 - Detection - Data and Model Preparation...
2023-04-23 21:46:23,198 - Detection - The number of known intents is 5
2023-04-23 21:46:23,198 - Detection - Lists of known labels are: ['bash', 'excel', 'svn', 'wordpress', 'osx']
2023-04-23 21:46:23,205 - Detection - Number of labeled training samples = 620
2023-04-23 21:46:23,205 - Detection - Number of unlabeled training samples = 2171
2023-04-23 21:46:23,208 - Detection - Number of evaluation samples = 374
2023-04-23 21:46:23,213 - Detection - Number of testing samples = 2905
2023-04-23 21:46:27,131 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-23 21:46:28,852 - Detection - Pre-training Begin...
2023-04-23 21:46:30,243 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 21:46:30,243 - Detection -   best_eval_score = 0
2023-04-23 21:46:30,243 - Detection -   eval_score = 17.38
2023-04-23 21:46:30,243 - Detection -   train_loss = 1.617458987236023
2023-04-23 21:46:34,080 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 21:46:34,080 - Detection -   best_eval_score = 17.38
2023-04-23 21:46:34,080 - Detection -   eval_score = 28.61
2023-04-23 21:46:34,080 - Detection -   train_loss = 1.6113966703414917
2023-04-23 21:46:38,038 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 21:46:38,039 - Detection -   best_eval_score = 28.61
2023-04-23 21:46:38,039 - Detection -   eval_score = 50.8
2023-04-23 21:46:38,039 - Detection -   train_loss = 1.5192675828933715
2023-04-23 21:46:41,835 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 21:46:41,835 - Detection -   best_eval_score = 50.8
2023-04-23 21:46:41,835 - Detection -   eval_score = 74.33
2023-04-23 21:46:41,835 - Detection -   train_loss = 1.3513965845108031
2023-04-23 21:46:45,636 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 21:46:45,636 - Detection -   best_eval_score = 74.33
2023-04-23 21:46:45,636 - Detection -   eval_score = 86.36
2023-04-23 21:46:45,636 - Detection -   train_loss = 0.9576640725135803
2023-04-23 21:46:49,447 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 21:46:49,447 - Detection -   best_eval_score = 86.36
2023-04-23 21:46:49,447 - Detection -   eval_score = 87.43
2023-04-23 21:46:49,447 - Detection -   train_loss = 0.6084143638610839
2023-04-23 21:46:53,446 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 21:46:53,447 - Detection -   best_eval_score = 87.43
2023-04-23 21:46:53,447 - Detection -   eval_score = 87.97
2023-04-23 21:46:53,447 - Detection -   train_loss = 0.4651849627494812
2023-04-23 21:46:57,253 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 21:46:57,254 - Detection -   best_eval_score = 87.97
2023-04-23 21:46:57,254 - Detection -   eval_score = 88.24
2023-04-23 21:46:57,254 - Detection -   train_loss = 0.357143759727478
2023-04-23 21:47:01,079 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 21:47:01,079 - Detection -   best_eval_score = 88.24
2023-04-23 21:47:01,079 - Detection -   eval_score = 87.7
2023-04-23 21:47:01,079 - Detection -   train_loss = 0.26843408644199374
2023-04-23 21:47:04,942 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 21:47:04,942 - Detection -   best_eval_score = 88.24
2023-04-23 21:47:04,942 - Detection -   eval_score = 87.43
2023-04-23 21:47:04,942 - Detection -   train_loss = 0.20973106026649474
2023-04-23 21:47:08,737 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 21:47:08,737 - Detection -   best_eval_score = 88.24
2023-04-23 21:47:08,737 - Detection -   eval_score = 87.17
2023-04-23 21:47:08,737 - Detection -   train_loss = 0.16339995265007018
2023-04-23 21:47:12,587 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 21:47:12,587 - Detection -   best_eval_score = 88.24
2023-04-23 21:47:12,587 - Detection -   eval_score = 86.63
2023-04-23 21:47:12,587 - Detection -   train_loss = 0.11211486756801606
2023-04-23 21:47:16,393 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 21:47:16,393 - Detection -   best_eval_score = 88.24
2023-04-23 21:47:16,393 - Detection -   eval_score = 87.43
2023-04-23 21:47:16,393 - Detection -   train_loss = 0.08487417101860047
2023-04-23 21:47:20,189 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 21:47:20,189 - Detection -   best_eval_score = 88.24
2023-04-23 21:47:20,189 - Detection -   eval_score = 87.17
2023-04-23 21:47:20,189 - Detection -   train_loss = 0.06377876996994018
2023-04-23 21:47:24,024 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 21:47:24,024 - Detection -   best_eval_score = 88.24
2023-04-23 21:47:24,024 - Detection -   eval_score = 86.9
2023-04-23 21:47:24,024 - Detection -   train_loss = 0.06269201785326003
2023-04-23 21:47:27,813 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 21:47:27,814 - Detection -   best_eval_score = 88.24
2023-04-23 21:47:27,814 - Detection -   eval_score = 87.17
2023-04-23 21:47:27,814 - Detection -   train_loss = 0.053899028524756434
2023-04-23 21:47:31,628 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 21:47:31,628 - Detection -   best_eval_score = 88.24
2023-04-23 21:47:31,628 - Detection -   eval_score = 87.43
2023-04-23 21:47:31,628 - Detection -   train_loss = 0.043390776589512826
2023-04-23 21:47:35,561 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 21:47:35,561 - Detection -   best_eval_score = 88.24
2023-04-23 21:47:35,561 - Detection -   eval_score = 86.9
2023-04-23 21:47:35,561 - Detection -   train_loss = 0.03612077757716179
2023-04-23 21:47:35,561 - Detection - Pre-training finished...
2023-04-23 21:47:35,561 - Detection - Training Begin...
2023-04-23 21:47:36,576 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 21:47:36,576 - Detection -   best_eval_score = 0
2023-04-23 21:47:36,576 - Detection -   eval_score = 0.0
2023-04-23 21:47:36,576 - Detection -   train_loss = 6.549020290374756
2023-04-23 21:47:37,217 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 21:47:37,217 - Detection -   best_eval_score = 0
2023-04-23 21:47:37,217 - Detection -   eval_score = 0.0
2023-04-23 21:47:37,217 - Detection -   train_loss = 6.408311367034912
2023-04-23 21:47:37,857 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 21:47:37,857 - Detection -   best_eval_score = 0
2023-04-23 21:47:37,857 - Detection -   eval_score = 0.0
2023-04-23 21:47:37,857 - Detection -   train_loss = 6.307247734069824
2023-04-23 21:47:38,500 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 21:47:38,500 - Detection -   best_eval_score = 0
2023-04-23 21:47:38,500 - Detection -   eval_score = 0.0
2023-04-23 21:47:38,500 - Detection -   train_loss = 6.129981136322021
2023-04-23 21:47:39,144 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 21:47:39,144 - Detection -   best_eval_score = 0
2023-04-23 21:47:39,144 - Detection -   eval_score = 0.0
2023-04-23 21:47:39,144 - Detection -   train_loss = 5.96511812210083
2023-04-23 21:47:39,787 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 21:47:39,787 - Detection -   best_eval_score = 0
2023-04-23 21:47:39,787 - Detection -   eval_score = 0.0
2023-04-23 21:47:39,787 - Detection -   train_loss = 5.7923578262329105
2023-04-23 21:47:40,429 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 21:47:40,429 - Detection -   best_eval_score = 0
2023-04-23 21:47:40,429 - Detection -   eval_score = 0.0
2023-04-23 21:47:40,429 - Detection -   train_loss = 5.603793144226074
2023-04-23 21:47:41,073 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 21:47:41,073 - Detection -   best_eval_score = 0
2023-04-23 21:47:41,073 - Detection -   eval_score = 0.0
2023-04-23 21:47:41,073 - Detection -   train_loss = 5.319970035552979
2023-04-23 21:47:41,719 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 21:47:41,719 - Detection -   best_eval_score = 0
2023-04-23 21:47:41,719 - Detection -   eval_score = 0.0
2023-04-23 21:47:41,719 - Detection -   train_loss = 5.026350975036621
2023-04-23 21:47:42,364 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 21:47:42,364 - Detection -   best_eval_score = 0
2023-04-23 21:47:42,364 - Detection -   eval_score = 0.0
2023-04-23 21:47:42,364 - Detection -   train_loss = 4.778438091278076
2023-04-23 21:47:43,008 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 21:47:43,008 - Detection -   best_eval_score = 0
2023-04-23 21:47:43,008 - Detection -   eval_score = 0.44
2023-04-23 21:47:43,008 - Detection -   train_loss = 4.596424674987793
2023-04-23 21:47:46,855 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 21:47:46,855 - Detection -   best_eval_score = 0.44
2023-04-23 21:47:46,855 - Detection -   eval_score = 37.32
2023-04-23 21:47:46,855 - Detection -   train_loss = 4.278838872909546
2023-04-23 21:47:50,646 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 21:47:50,646 - Detection -   best_eval_score = 37.32
2023-04-23 21:47:50,646 - Detection -   eval_score = 67.74
2023-04-23 21:47:50,646 - Detection -   train_loss = 2.8373079776763914
2023-04-23 21:47:54,447 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 21:47:54,447 - Detection -   best_eval_score = 67.74
2023-04-23 21:47:54,447 - Detection -   eval_score = 72.69
2023-04-23 21:47:54,447 - Detection -   train_loss = 1.5256345510482787
2023-04-23 21:47:58,350 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 21:47:58,350 - Detection -   best_eval_score = 72.69
2023-04-23 21:47:58,350 - Detection -   eval_score = 73.03
2023-04-23 21:47:58,350 - Detection -   train_loss = 1.1128144025802613
2023-04-23 21:48:02,134 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 21:48:02,134 - Detection -   best_eval_score = 73.03
2023-04-23 21:48:02,134 - Detection -   eval_score = 72.9
2023-04-23 21:48:02,134 - Detection -   train_loss = 1.1189759969711304
2023-04-23 21:48:05,965 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 21:48:05,965 - Detection -   best_eval_score = 73.03
2023-04-23 21:48:05,965 - Detection -   eval_score = 72.86
2023-04-23 21:48:05,965 - Detection -   train_loss = 1.0620160818099975
2023-04-23 21:48:09,749 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 21:48:09,749 - Detection -   best_eval_score = 73.03
2023-04-23 21:48:09,749 - Detection -   eval_score = 72.99
2023-04-23 21:48:09,749 - Detection -   train_loss = 1.075014352798462
2023-04-23 21:48:13,542 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 21:48:13,542 - Detection -   best_eval_score = 73.03
2023-04-23 21:48:13,542 - Detection -   eval_score = 72.99
2023-04-23 21:48:13,542 - Detection -   train_loss = 1.100139307975769
2023-04-23 21:48:17,430 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 21:48:17,430 - Detection -   best_eval_score = 73.03
2023-04-23 21:48:17,430 - Detection -   eval_score = 72.99
2023-04-23 21:48:17,430 - Detection -   train_loss = 1.0922569751739502
2023-04-23 21:48:21,193 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 21:48:21,193 - Detection -   best_eval_score = 73.03
2023-04-23 21:48:21,193 - Detection -   eval_score = 73.13
2023-04-23 21:48:21,193 - Detection -   train_loss = 1.0348710894584656
2023-04-23 21:48:25,002 - Detection - ***** Epoch: 22: Eval results *****
2023-04-23 21:48:25,002 - Detection -   best_eval_score = 73.13
2023-04-23 21:48:25,002 - Detection -   eval_score = 72.86
2023-04-23 21:48:25,003 - Detection -   train_loss = 1.093874728679657
2023-04-23 21:48:28,932 - Detection - ***** Epoch: 23: Eval results *****
2023-04-23 21:48:28,933 - Detection -   best_eval_score = 73.13
2023-04-23 21:48:28,933 - Detection -   eval_score = 73.0
2023-04-23 21:48:28,933 - Detection -   train_loss = 1.1017795085906983
2023-04-23 21:48:32,731 - Detection - ***** Epoch: 24: Eval results *****
2023-04-23 21:48:32,731 - Detection -   best_eval_score = 73.13
2023-04-23 21:48:32,731 - Detection -   eval_score = 72.86
2023-04-23 21:48:32,731 - Detection -   train_loss = 1.0701101899147034
2023-04-23 21:48:36,509 - Detection - ***** Epoch: 25: Eval results *****
2023-04-23 21:48:36,510 - Detection -   best_eval_score = 73.13
2023-04-23 21:48:36,510 - Detection -   eval_score = 72.86
2023-04-23 21:48:36,510 - Detection -   train_loss = 1.0672098875045777
2023-04-23 21:48:40,421 - Detection - ***** Epoch: 26: Eval results *****
2023-04-23 21:48:40,422 - Detection -   best_eval_score = 73.13
2023-04-23 21:48:40,422 - Detection -   eval_score = 73.04
2023-04-23 21:48:40,422 - Detection -   train_loss = 1.0571407079696655
2023-04-23 21:48:44,225 - Detection - ***** Epoch: 27: Eval results *****
2023-04-23 21:48:44,225 - Detection -   best_eval_score = 73.13
2023-04-23 21:48:44,225 - Detection -   eval_score = 72.86
2023-04-23 21:48:44,225 - Detection -   train_loss = 1.122743809223175
2023-04-23 21:48:48,009 - Detection - ***** Epoch: 28: Eval results *****
2023-04-23 21:48:48,009 - Detection -   best_eval_score = 73.13
2023-04-23 21:48:48,009 - Detection -   eval_score = 72.86
2023-04-23 21:48:48,009 - Detection -   train_loss = 1.0957340598106384
2023-04-23 21:48:51,805 - Detection - ***** Epoch: 29: Eval results *****
2023-04-23 21:48:51,805 - Detection -   best_eval_score = 73.13
2023-04-23 21:48:51,805 - Detection -   eval_score = 73.03
2023-04-23 21:48:51,805 - Detection -   train_loss = 1.0769471168518066
2023-04-23 21:48:55,572 - Detection - ***** Epoch: 30: Eval results *****
2023-04-23 21:48:55,572 - Detection -   best_eval_score = 73.13
2023-04-23 21:48:55,572 - Detection -   eval_score = 72.99
2023-04-23 21:48:55,572 - Detection -   train_loss = 1.0757453680038451
2023-04-23 21:48:59,483 - Detection - ***** Epoch: 31: Eval results *****
2023-04-23 21:48:59,483 - Detection -   best_eval_score = 73.13
2023-04-23 21:48:59,483 - Detection -   eval_score = 73.0
2023-04-23 21:48:59,483 - Detection -   train_loss = 1.0835659980773926
2023-04-23 21:48:59,483 - Detection - Training Finished...
2023-04-23 21:48:59,484 - Detection - Testing begin...
2023-04-23 21:49:01,229 - Detection - ***** Test: Confusion Matrix *****
2023-04-23 21:49:01,229 - Detection - [[  95    3    1    2    6   32]
 [   2  103    0    0    9   26]
 [   0    0  119    0    5   25]
 [   1    0    0  104    1   31]
 [   0    1    2    2  157   31]
 [  97  205   37   39  492 1277]]
2023-04-23 21:49:01,229 - Detection - ***** Test results *****
2023-04-23 21:49:01,229 - Detection -   Acc = 63.86
2023-04-23 21:49:01,229 - Detection -   F1 = 60.1532
2023-04-23 21:49:01,229 - Detection -   F1-known = 57.8717
2023-04-23 21:49:01,229 - Detection -   F1-open = 71.5607
2023-04-23 21:49:01,229 - Detection - Testing finished...
2023-04-23 21:49:01,229 - Detection - Results saved in results/results_ADB-BOOST-F-4.csv
2023-04-23 21:49:01,248 - Detection - Open Intent Detection Finished...
