2023-04-22 11:33:31,528 - Detection - Open Intent Detection Begin...
2023-04-22 11:33:31,528 - Detection - Parameters Initialization...
2023-04-22 11:33:31,528 - Detection - ============================== Params ==============================
2023-04-22 11:33:31,528 - Detection - type:	open_intent_detection
2023-04-22 11:33:31,528 - Detection - logger_name:	Detection
2023-04-22 11:33:31,529 - Detection - log_dir:	logs
2023-04-22 11:33:31,529 - Detection - dataset:	stackoverflow_cg
2023-04-22 11:33:31,529 - Detection - known_cls_ratio:	0.5
2023-04-22 11:33:31,529 - Detection - labeled_ratio:	1.0
2023-04-22 11:33:31,529 - Detection - method:	DA-ADB
2023-04-22 11:33:31,529 - Detection - train:	True
2023-04-22 11:33:31,529 - Detection - pretrain:	True
2023-04-22 11:33:31,529 - Detection - save_model:	False
2023-04-22 11:33:31,529 - Detection - backbone:	bert_disaware_boost
2023-04-22 11:33:31,529 - Detection - config_file_name:	DA-ADB
2023-04-22 11:33:31,529 - Detection - seed:	1
2023-04-22 11:33:31,529 - Detection - gpu_id:	0
2023-04-22 11:33:31,529 - Detection - pipe_results_path:	pipe_results
2023-04-22 11:33:31,529 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-22 11:33:31,529 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-22 11:33:31,529 - Detection - model_dir:	models
2023-04-22 11:33:31,529 - Detection - load_pretrained_method:	None
2023-04-22 11:33:31,529 - Detection - result_dir:	results
2023-04-22 11:33:31,529 - Detection - results_file_name:	results_DA-ADB-BOOST.csv
2023-04-22 11:33:31,529 - Detection - save_results:	True
2023-04-22 11:33:31,529 - Detection - loss_fct:	CrossEntropyLoss
2023-04-22 11:33:31,529 - Detection - boost_method:	F-10
2023-04-22 11:33:31,529 - Detection - boost_start_score:	0.0
2023-04-22 11:33:31,529 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.5_1.0_bert_disaware_boost_1
2023-04-22 11:33:31,529 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.5_1.0_bert_disaware_boost_1/models
2023-04-22 11:33:31,529 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-22 11:33:31,529 - Detection - num_train_epochs:	100
2023-04-22 11:33:31,529 - Detection - num_labels:	None
2023-04-22 11:33:31,529 - Detection - max_seq_length:	None
2023-04-22 11:33:31,529 - Detection - freeze_backbone_parameters:	True
2023-04-22 11:33:31,529 - Detection - feat_dim:	768
2023-04-22 11:33:31,529 - Detection - warmup_proportion:	0.1
2023-04-22 11:33:31,529 - Detection - scale:	4
2023-04-22 11:33:31,529 - Detection - lr_boundary:	0.05
2023-04-22 11:33:31,529 - Detection - lr:	2e-05
2023-04-22 11:33:31,529 - Detection - activation:	relu
2023-04-22 11:33:31,529 - Detection - train_batch_size:	128
2023-04-22 11:33:31,529 - Detection - eval_batch_size:	64
2023-04-22 11:33:31,529 - Detection - test_batch_size:	64
2023-04-22 11:33:31,529 - Detection - wait_patient:	10
2023-04-22 11:33:31,529 - Detection - ============================== End Params ==============================
2023-04-22 11:33:31,529 - Detection - Data and Model Preparation...
2023-04-22 11:33:31,530 - Detection - The number of known intents is 10
2023-04-22 11:33:31,530 - Detection - Lists of known labels are: ['cocoa', 'spring', 'haskell', 'matlab', 'bash', 'scala', 'drupal', 'svn', 'hibernate', 'apache']
2023-04-22 11:33:31,538 - Detection - Number of labeled training samples = 1405
2023-04-22 11:33:31,538 - Detection - Number of unlabeled training samples = 1386
2023-04-22 11:33:31,541 - Detection - Number of evaluation samples = 722
2023-04-22 11:33:31,546 - Detection - Number of testing samples = 2905
2023-04-22 11:33:37,119 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-22 11:33:37,198 - Detection - Pre-training Begin...
2023-04-22 11:33:40,846 - Detection - ***** Epoch: 1: Eval results *****
2023-04-22 11:33:40,846 - Detection -   best_eval_score = 0
2023-04-22 11:33:40,846 - Detection -   eval_score = 2.37
2023-04-22 11:33:40,846 - Detection -   train_loss = 2.3127061020244253
2023-04-22 11:34:03,088 - Detection - ***** Epoch: 2: Eval results *****
2023-04-22 11:34:03,088 - Detection -   best_eval_score = 2.37
2023-04-22 11:34:03,088 - Detection -   eval_score = 2.69
2023-04-22 11:34:03,088 - Detection -   train_loss = 2.291138237172907
2023-04-22 11:34:25,375 - Detection - ***** Epoch: 3: Eval results *****
2023-04-22 11:34:25,375 - Detection -   best_eval_score = 2.69
2023-04-22 11:34:25,376 - Detection -   eval_score = 17.15
2023-04-22 11:34:25,376 - Detection -   train_loss = 2.200279105793346
2023-04-22 11:34:47,557 - Detection - ***** Epoch: 4: Eval results *****
2023-04-22 11:34:47,557 - Detection -   best_eval_score = 17.15
2023-04-22 11:34:47,557 - Detection -   eval_score = 68.11
2023-04-22 11:34:47,557 - Detection -   train_loss = 1.9699143821542913
2023-04-22 11:35:09,882 - Detection - ***** Epoch: 5: Eval results *****
2023-04-22 11:35:09,882 - Detection -   best_eval_score = 68.11
2023-04-22 11:35:09,882 - Detection -   eval_score = 79.1
2023-04-22 11:35:09,882 - Detection -   train_loss = 1.5172962167046287
2023-04-22 11:35:32,160 - Detection - ***** Epoch: 6: Eval results *****
2023-04-22 11:35:32,160 - Detection -   best_eval_score = 79.1
2023-04-22 11:35:32,160 - Detection -   eval_score = 81.47
2023-04-22 11:35:32,160 - Detection -   train_loss = 1.1587088108062744
2023-04-22 11:35:54,489 - Detection - ***** Epoch: 7: Eval results *****
2023-04-22 11:35:54,489 - Detection -   best_eval_score = 81.47
2023-04-22 11:35:54,489 - Detection -   eval_score = 83.04
2023-04-22 11:35:54,489 - Detection -   train_loss = 0.9243074709718878
2023-04-22 11:36:16,757 - Detection - ***** Epoch: 8: Eval results *****
2023-04-22 11:36:16,757 - Detection -   best_eval_score = 83.04
2023-04-22 11:36:16,757 - Detection -   eval_score = 85.19
2023-04-22 11:36:16,758 - Detection -   train_loss = 0.7948744297027588
2023-04-22 11:36:39,140 - Detection - ***** Epoch: 9: Eval results *****
2023-04-22 11:36:39,140 - Detection -   best_eval_score = 85.19
2023-04-22 11:36:39,140 - Detection -   eval_score = 85.09
2023-04-22 11:36:39,140 - Detection -   train_loss = 0.6870050213553689
2023-04-22 11:37:01,445 - Detection - ***** Epoch: 10: Eval results *****
2023-04-22 11:37:01,445 - Detection -   best_eval_score = 85.19
2023-04-22 11:37:01,445 - Detection -   eval_score = 84.96
2023-04-22 11:37:01,445 - Detection -   train_loss = 0.5937880277633667
2023-04-22 11:37:23,587 - Detection - ***** Epoch: 11: Eval results *****
2023-04-22 11:37:23,588 - Detection -   best_eval_score = 85.19
2023-04-22 11:37:23,588 - Detection -   eval_score = 83.19
2023-04-22 11:37:23,588 - Detection -   train_loss = 0.5303418690508063
2023-04-22 11:37:45,912 - Detection - ***** Epoch: 12: Eval results *****
2023-04-22 11:37:45,912 - Detection -   best_eval_score = 85.19
2023-04-22 11:37:45,912 - Detection -   eval_score = 83.02
2023-04-22 11:37:45,912 - Detection -   train_loss = 0.49514002149755304
2023-04-22 11:38:08,139 - Detection - ***** Epoch: 13: Eval results *****
2023-04-22 11:38:08,139 - Detection -   best_eval_score = 85.19
2023-04-22 11:38:08,139 - Detection -   eval_score = 83.85
2023-04-22 11:38:08,139 - Detection -   train_loss = 0.4842592423612421
2023-04-22 11:38:30,373 - Detection - ***** Epoch: 14: Eval results *****
2023-04-22 11:38:30,373 - Detection -   best_eval_score = 85.19
2023-04-22 11:38:30,374 - Detection -   eval_score = 84.12
2023-04-22 11:38:30,374 - Detection -   train_loss = 0.4105059504508972
2023-04-22 11:38:52,686 - Detection - ***** Epoch: 15: Eval results *****
2023-04-22 11:38:52,686 - Detection -   best_eval_score = 85.19
2023-04-22 11:38:52,686 - Detection -   eval_score = 84.37
2023-04-22 11:38:52,686 - Detection -   train_loss = 0.3612249114296653
2023-04-22 11:39:14,782 - Detection - ***** Epoch: 16: Eval results *****
2023-04-22 11:39:14,782 - Detection -   best_eval_score = 85.19
2023-04-22 11:39:14,782 - Detection -   eval_score = 84.56
2023-04-22 11:39:14,782 - Detection -   train_loss = 0.33975408564914356
2023-04-22 11:39:37,120 - Detection - ***** Epoch: 17: Eval results *****
2023-04-22 11:39:37,120 - Detection -   best_eval_score = 85.19
2023-04-22 11:39:37,120 - Detection -   eval_score = 84.58
2023-04-22 11:39:37,120 - Detection -   train_loss = 0.3191465897993608
2023-04-22 11:39:59,265 - Detection - ***** Epoch: 18: Eval results *****
2023-04-22 11:39:59,265 - Detection -   best_eval_score = 85.19
2023-04-22 11:39:59,265 - Detection -   eval_score = 84.76
2023-04-22 11:39:59,265 - Detection -   train_loss = 0.2997899218039079
2023-04-22 11:39:59,265 - Detection - Pre-training finished...
2023-04-22 11:39:59,265 - Detection - Training Begin...
2023-04-22 11:40:01,167 - Detection - ***** Epoch: 1: Eval results *****
2023-04-22 11:40:01,167 - Detection -   best_eval_score = 0
2023-04-22 11:40:01,167 - Detection -   eval_score = 1.95
2023-04-22 11:40:01,167 - Detection -   train_loss = 4.057792706923052
2023-04-22 11:40:22,195 - Detection - ***** Epoch: 2: Eval results *****
2023-04-22 11:40:22,195 - Detection -   best_eval_score = 1.95
2023-04-22 11:40:22,195 - Detection -   eval_score = 68.51
2023-04-22 11:40:22,195 - Detection -   train_loss = 3.7003123326735063
2023-04-22 11:40:43,148 - Detection - ***** Epoch: 3: Eval results *****
2023-04-22 11:40:43,148 - Detection -   best_eval_score = 68.51
2023-04-22 11:40:43,148 - Detection -   eval_score = 67.61
2023-04-22 11:40:43,148 - Detection -   train_loss = 0.973122932694175
2023-04-22 11:41:04,119 - Detection - ***** Epoch: 4: Eval results *****
2023-04-22 11:41:04,119 - Detection -   best_eval_score = 68.51
2023-04-22 11:41:04,119 - Detection -   eval_score = 67.88
2023-04-22 11:41:04,119 - Detection -   train_loss = 0.9605220827189359
2023-04-22 11:41:25,010 - Detection - ***** Epoch: 5: Eval results *****
2023-04-22 11:41:25,010 - Detection -   best_eval_score = 68.51
2023-04-22 11:41:25,010 - Detection -   eval_score = 67.97
2023-04-22 11:41:25,010 - Detection -   train_loss = 0.952948505228216
2023-04-22 11:41:46,070 - Detection - ***** Epoch: 6: Eval results *****
2023-04-22 11:41:46,071 - Detection -   best_eval_score = 68.51
2023-04-22 11:41:46,071 - Detection -   eval_score = 68.08
2023-04-22 11:41:46,071 - Detection -   train_loss = 0.9681955034082587
2023-04-22 11:42:07,000 - Detection - ***** Epoch: 7: Eval results *****
2023-04-22 11:42:07,001 - Detection -   best_eval_score = 68.51
2023-04-22 11:42:07,001 - Detection -   eval_score = 67.89
2023-04-22 11:42:07,001 - Detection -   train_loss = 0.9285717118870128
2023-04-22 11:42:28,234 - Detection - ***** Epoch: 8: Eval results *****
2023-04-22 11:42:28,234 - Detection -   best_eval_score = 68.51
2023-04-22 11:42:28,234 - Detection -   eval_score = 68.25
2023-04-22 11:42:28,234 - Detection -   train_loss = 0.9542274041609331
2023-04-22 11:42:49,124 - Detection - ***** Epoch: 9: Eval results *****
2023-04-22 11:42:49,124 - Detection -   best_eval_score = 68.51
2023-04-22 11:42:49,124 - Detection -   eval_score = 68.18
2023-04-22 11:42:49,124 - Detection -   train_loss = 0.9498317295854742
2023-04-22 11:43:10,040 - Detection - ***** Epoch: 10: Eval results *****
2023-04-22 11:43:10,040 - Detection -   best_eval_score = 68.51
2023-04-22 11:43:10,040 - Detection -   eval_score = 67.85
2023-04-22 11:43:10,040 - Detection -   train_loss = 0.9556451006369158
2023-04-22 11:43:31,012 - Detection - ***** Epoch: 11: Eval results *****
2023-04-22 11:43:31,012 - Detection -   best_eval_score = 68.51
2023-04-22 11:43:31,012 - Detection -   eval_score = 67.56
2023-04-22 11:43:31,012 - Detection -   train_loss = 0.9387794570489363
2023-04-22 11:43:51,932 - Detection - ***** Epoch: 12: Eval results *****
2023-04-22 11:43:51,933 - Detection -   best_eval_score = 68.51
2023-04-22 11:43:51,933 - Detection -   eval_score = 67.54
2023-04-22 11:43:51,933 - Detection -   train_loss = 0.9373883550817316
2023-04-22 11:43:51,933 - Detection - Training Finished...
2023-04-22 11:43:51,933 - Detection - Testing begin...
2023-04-22 11:43:54,351 - Detection - ***** Test: Confusion Matrix *****
2023-04-22 11:43:54,352 - Detection - [[100   2  11   1   3   0   1   2   0   3  38]
 [  3 115   5   2   0   2   0   0   3   2  19]
 [  4   2  50   1   1   3   0   0   0   1  60]
 [  3   0   6 140   1   4   0   0   0   0  10]
 [  8   0  21   2  61   1   0   0   0   2  44]
 [  4   0  19   0   2  59   0   0   0   1  39]
 [  1   0   6   0   0   1 102   0   0   7  11]
 [  3   0   4   0   1   1   1 117   0   8  14]
 [  6   6  10   0   2   2   1   0  90   1  10]
 [  3   0   4   0   3   0   4   2   1 115  38]
 [330  58 302   7 145  21 110  30  11 181 274]]
2023-04-22 11:43:54,352 - Detection - ***** Test results *****
2023-04-22 11:43:54,352 - Detection -   Acc = 42.1
2023-04-22 11:43:54,352 - Detection -   F1 = 53.0125
2023-04-22 11:43:54,352 - Detection -   F1-known = 55.6089
2023-04-22 11:43:54,352 - Detection -   F1-open = 27.0484
2023-04-22 11:43:54,352 - Detection - Testing finished...
2023-04-22 11:43:54,352 - Detection - Results saved in results/results_DA-ADB-BOOST.csv
2023-04-22 11:43:54,371 - Detection - Open Intent Detection Finished...
