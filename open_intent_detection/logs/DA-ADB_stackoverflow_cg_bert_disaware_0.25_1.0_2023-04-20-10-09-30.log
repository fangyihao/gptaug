2023-04-20 10:09:30,942 - Detection - Open Intent Detection Begin...
2023-04-20 10:09:30,942 - Detection - Parameters Initialization...
2023-04-20 10:09:30,942 - Detection - ============================== Params ==============================
2023-04-20 10:09:30,942 - Detection - type:	open_intent_detection
2023-04-20 10:09:30,942 - Detection - logger_name:	Detection
2023-04-20 10:09:30,942 - Detection - log_dir:	logs
2023-04-20 10:09:30,942 - Detection - dataset:	stackoverflow_cg
2023-04-20 10:09:30,942 - Detection - known_cls_ratio:	0.25
2023-04-20 10:09:30,942 - Detection - labeled_ratio:	1.0
2023-04-20 10:09:30,942 - Detection - method:	DA-ADB
2023-04-20 10:09:30,942 - Detection - train:	True
2023-04-20 10:09:30,942 - Detection - pretrain:	True
2023-04-20 10:09:30,943 - Detection - save_model:	True
2023-04-20 10:09:30,943 - Detection - backbone:	bert_disaware
2023-04-20 10:09:30,943 - Detection - config_file_name:	DA-ADB
2023-04-20 10:09:30,943 - Detection - seed:	0
2023-04-20 10:09:30,943 - Detection - gpu_id:	0
2023-04-20 10:09:30,943 - Detection - pipe_results_path:	pipe_results
2023-04-20 10:09:30,943 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-20 10:09:30,943 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-20 10:09:30,943 - Detection - model_dir:	models
2023-04-20 10:09:30,943 - Detection - load_pretrained_method:	None
2023-04-20 10:09:30,943 - Detection - result_dir:	results
2023-04-20 10:09:30,943 - Detection - results_file_name:	results_DA-ADB.csv
2023-04-20 10:09:30,943 - Detection - save_results:	True
2023-04-20 10:09:30,943 - Detection - loss_fct:	CrossEntropyLoss
2023-04-20 10:09:30,943 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.25_1.0_bert_disaware_0
2023-04-20 10:09:30,943 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.25_1.0_bert_disaware_0/models
2023-04-20 10:09:30,943 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-20 10:09:30,943 - Detection - num_train_epochs:	100
2023-04-20 10:09:30,943 - Detection - num_labels:	None
2023-04-20 10:09:30,943 - Detection - max_seq_length:	None
2023-04-20 10:09:30,943 - Detection - freeze_backbone_parameters:	True
2023-04-20 10:09:30,943 - Detection - feat_dim:	768
2023-04-20 10:09:30,943 - Detection - warmup_proportion:	0.1
2023-04-20 10:09:30,943 - Detection - scale:	4
2023-04-20 10:09:30,943 - Detection - lr_boundary:	0.05
2023-04-20 10:09:30,943 - Detection - lr:	2e-05
2023-04-20 10:09:30,943 - Detection - activation:	relu
2023-04-20 10:09:30,943 - Detection - train_batch_size:	128
2023-04-20 10:09:30,943 - Detection - eval_batch_size:	64
2023-04-20 10:09:30,943 - Detection - test_batch_size:	64
2023-04-20 10:09:30,943 - Detection - wait_patient:	10
2023-04-20 10:09:30,943 - Detection - ============================== End Params ==============================
2023-04-20 10:09:30,943 - Detection - Data and Model Preparation...
2023-04-20 10:09:30,944 - Detection - The number of known intents is 5
2023-04-20 10:09:30,944 - Detection - Lists of known labels are: ['visual-studio', 'apache', 'wordpress', 'linq', 'matlab']
2023-04-20 10:09:30,957 - Detection - Number of labeled training samples = 1302
2023-04-20 10:09:30,957 - Detection - Number of unlabeled training samples = 4123
2023-04-20 10:09:30,961 - Detection - Number of evaluation samples = 473
2023-04-20 10:09:30,969 - Detection - Number of testing samples = 4516
2023-04-20 10:09:37,398 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-20 10:09:37,482 - Detection - Pre-training Begin...
2023-04-20 10:09:40,609 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 10:09:40,609 - Detection -   best_eval_score = 0
2023-04-20 10:09:40,609 - Detection -   eval_score = 6.77
2023-04-20 10:09:40,609 - Detection -   train_loss = 1.6453945961865513
2023-04-20 10:09:43,121 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 10:09:43,122 - Detection -   best_eval_score = 6.77
2023-04-20 10:09:43,122 - Detection -   eval_score = 6.81
2023-04-20 10:09:43,122 - Detection -   train_loss = 1.5967581488869407
2023-04-20 10:09:45,643 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 10:09:45,643 - Detection -   best_eval_score = 6.81
2023-04-20 10:09:45,643 - Detection -   eval_score = 6.81
2023-04-20 10:09:45,643 - Detection -   train_loss = 1.5686999017542058
2023-04-20 10:09:48,154 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 10:09:48,154 - Detection -   best_eval_score = 6.81
2023-04-20 10:09:48,154 - Detection -   eval_score = 6.81
2023-04-20 10:09:48,154 - Detection -   train_loss = 1.5603838942267678
2023-04-20 10:09:50,674 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 10:09:50,674 - Detection -   best_eval_score = 6.81
2023-04-20 10:09:50,674 - Detection -   eval_score = 22.95
2023-04-20 10:09:50,674 - Detection -   train_loss = 1.525374781001698
2023-04-20 10:09:53,208 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 10:09:53,208 - Detection -   best_eval_score = 22.95
2023-04-20 10:09:53,208 - Detection -   eval_score = 37.47
2023-04-20 10:09:53,208 - Detection -   train_loss = 1.462095390666615
2023-04-20 10:09:55,749 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 10:09:55,749 - Detection -   best_eval_score = 37.47
2023-04-20 10:09:55,749 - Detection -   eval_score = 63.43
2023-04-20 10:09:55,749 - Detection -   train_loss = 1.301688551902771
2023-04-20 10:09:58,300 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 10:09:58,300 - Detection -   best_eval_score = 63.43
2023-04-20 10:09:58,300 - Detection -   eval_score = 80.72
2023-04-20 10:09:58,300 - Detection -   train_loss = 1.0715811252593994
2023-04-20 10:10:00,851 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 10:10:00,851 - Detection -   best_eval_score = 80.72
2023-04-20 10:10:00,851 - Detection -   eval_score = 88.91
2023-04-20 10:10:00,851 - Detection -   train_loss = 0.8009344447742809
2023-04-20 10:10:03,404 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 10:10:03,404 - Detection -   best_eval_score = 88.91
2023-04-20 10:10:03,404 - Detection -   eval_score = 89.42
2023-04-20 10:10:03,404 - Detection -   train_loss = 0.6087031364440918
2023-04-20 10:10:05,962 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 10:10:05,962 - Detection -   best_eval_score = 89.42
2023-04-20 10:10:05,962 - Detection -   eval_score = 90.27
2023-04-20 10:10:05,963 - Detection -   train_loss = 0.5183977809819308
2023-04-20 10:10:08,532 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 10:10:08,532 - Detection -   best_eval_score = 90.27
2023-04-20 10:10:08,532 - Detection -   eval_score = 89.9
2023-04-20 10:10:08,532 - Detection -   train_loss = 0.4590017687190663
2023-04-20 10:10:11,096 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 10:10:11,096 - Detection -   best_eval_score = 90.27
2023-04-20 10:10:11,097 - Detection -   eval_score = 91.47
2023-04-20 10:10:11,097 - Detection -   train_loss = 0.4114323908632452
2023-04-20 10:10:13,670 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 10:10:13,670 - Detection -   best_eval_score = 91.47
2023-04-20 10:10:13,670 - Detection -   eval_score = 91.29
2023-04-20 10:10:13,670 - Detection -   train_loss = 0.4003708904439753
2023-04-20 10:10:16,243 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 10:10:16,243 - Detection -   best_eval_score = 91.47
2023-04-20 10:10:16,243 - Detection -   eval_score = 91.67
2023-04-20 10:10:16,243 - Detection -   train_loss = 0.36713882467963477
2023-04-20 10:10:18,830 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 10:10:18,830 - Detection -   best_eval_score = 91.67
2023-04-20 10:10:18,830 - Detection -   eval_score = 91.09
2023-04-20 10:10:18,830 - Detection -   train_loss = 0.36483213847333734
2023-04-20 10:10:21,407 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 10:10:21,408 - Detection -   best_eval_score = 91.67
2023-04-20 10:10:21,408 - Detection -   eval_score = 92.5
2023-04-20 10:10:21,408 - Detection -   train_loss = 0.3531029224395752
2023-04-20 10:10:24,000 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 10:10:24,000 - Detection -   best_eval_score = 92.5
2023-04-20 10:10:24,000 - Detection -   eval_score = 91.84
2023-04-20 10:10:24,000 - Detection -   train_loss = 0.3306868536905809
2023-04-20 10:10:26,584 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 10:10:26,584 - Detection -   best_eval_score = 92.5
2023-04-20 10:10:26,584 - Detection -   eval_score = 91.71
2023-04-20 10:10:26,584 - Detection -   train_loss = 0.30862435698509216
2023-04-20 10:10:29,177 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 10:10:29,177 - Detection -   best_eval_score = 92.5
2023-04-20 10:10:29,177 - Detection -   eval_score = 91.86
2023-04-20 10:10:29,177 - Detection -   train_loss = 0.300771182233637
2023-04-20 10:10:31,777 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 10:10:31,777 - Detection -   best_eval_score = 92.5
2023-04-20 10:10:31,777 - Detection -   eval_score = 91.84
2023-04-20 10:10:31,777 - Detection -   train_loss = 0.28424534608017316
2023-04-20 10:10:34,379 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 10:10:34,379 - Detection -   best_eval_score = 92.5
2023-04-20 10:10:34,379 - Detection -   eval_score = 91.78
2023-04-20 10:10:34,379 - Detection -   train_loss = 0.27150889011946594
2023-04-20 10:10:36,983 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 10:10:36,983 - Detection -   best_eval_score = 92.5
2023-04-20 10:10:36,983 - Detection -   eval_score = 91.83
2023-04-20 10:10:36,983 - Detection -   train_loss = 0.27749551697210834
2023-04-20 10:10:39,587 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 10:10:39,587 - Detection -   best_eval_score = 92.5
2023-04-20 10:10:39,587 - Detection -   eval_score = 91.55
2023-04-20 10:10:39,587 - Detection -   train_loss = 0.2596298252994364
2023-04-20 10:10:42,194 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 10:10:42,194 - Detection -   best_eval_score = 92.5
2023-04-20 10:10:42,194 - Detection -   eval_score = 91.61
2023-04-20 10:10:42,194 - Detection -   train_loss = 0.259405100887472
2023-04-20 10:10:44,804 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 10:10:44,804 - Detection -   best_eval_score = 92.5
2023-04-20 10:10:44,804 - Detection -   eval_score = 92.07
2023-04-20 10:10:44,804 - Detection -   train_loss = 0.24420153417370535
2023-04-20 10:10:47,414 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 10:10:47,414 - Detection -   best_eval_score = 92.5
2023-04-20 10:10:47,414 - Detection -   eval_score = 91.85
2023-04-20 10:10:47,414 - Detection -   train_loss = 0.24465514448556033
2023-04-20 10:10:47,414 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.25_1.0_bert_disaware_0/models
2023-04-20 10:10:47,952 - Detection - Pre-training finished...
2023-04-20 10:10:47,952 - Detection - Training Begin...
2023-04-20 10:10:49,517 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 10:10:49,517 - Detection -   best_eval_score = 0
2023-04-20 10:10:49,517 - Detection -   eval_score = 0.34
2023-04-20 10:10:49,517 - Detection -   train_loss = 3.8007480664686724
2023-04-20 10:10:51,081 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 10:10:51,081 - Detection -   best_eval_score = 0.34
2023-04-20 10:10:51,081 - Detection -   eval_score = 2.29
2023-04-20 10:10:51,081 - Detection -   train_loss = 3.3901466239582407
2023-04-20 10:10:52,646 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 10:10:52,646 - Detection -   best_eval_score = 2.29
2023-04-20 10:10:52,646 - Detection -   eval_score = 13.52
2023-04-20 10:10:52,646 - Detection -   train_loss = 3.0485668182373047
2023-04-20 10:10:54,211 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 10:10:54,212 - Detection -   best_eval_score = 13.52
2023-04-20 10:10:54,212 - Detection -   eval_score = 27.32
2023-04-20 10:10:54,212 - Detection -   train_loss = 2.516026648608121
2023-04-20 10:10:55,777 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 10:10:55,778 - Detection -   best_eval_score = 27.32
2023-04-20 10:10:55,778 - Detection -   eval_score = 45.07
2023-04-20 10:10:55,778 - Detection -   train_loss = 1.9884953065352007
2023-04-20 10:10:57,345 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 10:10:57,345 - Detection -   best_eval_score = 45.07
2023-04-20 10:10:57,345 - Detection -   eval_score = 66.13
2023-04-20 10:10:57,345 - Detection -   train_loss = 1.448239499872381
2023-04-20 10:10:58,911 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 10:10:58,911 - Detection -   best_eval_score = 66.13
2023-04-20 10:10:58,911 - Detection -   eval_score = 74.19
2023-04-20 10:10:58,911 - Detection -   train_loss = 1.0279267701235684
2023-04-20 10:11:00,480 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 10:11:00,480 - Detection -   best_eval_score = 74.19
2023-04-20 10:11:00,480 - Detection -   eval_score = 74.82
2023-04-20 10:11:00,480 - Detection -   train_loss = 0.8625662597742948
2023-04-20 10:11:02,050 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 10:11:02,050 - Detection -   best_eval_score = 74.82
2023-04-20 10:11:02,050 - Detection -   eval_score = 74.82
2023-04-20 10:11:02,050 - Detection -   train_loss = 0.8442023342305963
2023-04-20 10:11:03,621 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 10:11:03,621 - Detection -   best_eval_score = 74.82
2023-04-20 10:11:03,621 - Detection -   eval_score = 74.82
2023-04-20 10:11:03,621 - Detection -   train_loss = 0.8193962844935331
2023-04-20 10:11:05,194 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 10:11:05,194 - Detection -   best_eval_score = 74.82
2023-04-20 10:11:05,194 - Detection -   eval_score = 74.51
2023-04-20 10:11:05,194 - Detection -   train_loss = 0.8296394077214327
2023-04-20 10:11:06,767 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 10:11:06,767 - Detection -   best_eval_score = 74.82
2023-04-20 10:11:06,767 - Detection -   eval_score = 74.61
2023-04-20 10:11:06,767 - Detection -   train_loss = 0.8619885227896951
2023-04-20 10:11:08,345 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 10:11:08,345 - Detection -   best_eval_score = 74.82
2023-04-20 10:11:08,345 - Detection -   eval_score = 74.72
2023-04-20 10:11:08,345 - Detection -   train_loss = 0.8490599285472523
2023-04-20 10:11:09,920 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 10:11:09,920 - Detection -   best_eval_score = 74.82
2023-04-20 10:11:09,920 - Detection -   eval_score = 74.72
2023-04-20 10:11:09,920 - Detection -   train_loss = 0.8727398189631376
2023-04-20 10:11:11,498 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 10:11:11,498 - Detection -   best_eval_score = 74.82
2023-04-20 10:11:11,498 - Detection -   eval_score = 74.72
2023-04-20 10:11:11,498 - Detection -   train_loss = 0.8234511451287703
2023-04-20 10:11:13,076 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 10:11:13,076 - Detection -   best_eval_score = 74.82
2023-04-20 10:11:13,076 - Detection -   eval_score = 74.61
2023-04-20 10:11:13,076 - Detection -   train_loss = 0.838631044734608
2023-04-20 10:11:14,656 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 10:11:14,656 - Detection -   best_eval_score = 74.82
2023-04-20 10:11:14,656 - Detection -   eval_score = 74.4
2023-04-20 10:11:14,656 - Detection -   train_loss = 0.8682873465798118
2023-04-20 10:11:16,234 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 10:11:16,234 - Detection -   best_eval_score = 74.82
2023-04-20 10:11:16,234 - Detection -   eval_score = 74.61
2023-04-20 10:11:16,234 - Detection -   train_loss = 0.8303733142939481
2023-04-20 10:11:16,235 - Detection - Training Finished...
2023-04-20 10:11:16,235 - Detection - Testing begin...
2023-04-20 10:11:19,930 - Detection - ***** Test: Confusion Matrix *****
2023-04-20 10:11:19,930 - Detection - [[ 141    2    0    0    0   37]
 [   2  178    1    0    0   55]
 [   0    2  186    0    0   31]
 [   0    0    0  175    0   38]
 [   0    0    0    0  204   31]
 [ 374  129    6   27   13 2884]]
2023-04-20 10:11:19,930 - Detection - ***** Test results *****
2023-04-20 10:11:19,930 - Detection -   Acc = 83.44
2023-04-20 10:11:19,930 - Detection -   F1 = 76.5085
2023-04-20 10:11:19,930 - Detection -   F1-known = 74.0871
2023-04-20 10:11:19,930 - Detection -   F1-open = 88.6158
2023-04-20 10:11:19,930 - Detection - Testing finished...
2023-04-20 10:11:19,930 - Detection - Results saved in results/results_DA-ADB.csv
2023-04-20 10:11:19,951 - Detection - Open Intent Detection Finished...
