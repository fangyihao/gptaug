2023-04-19 18:31:01,255 - Detection - Open Intent Detection Begin...
2023-04-19 18:31:01,256 - Detection - Parameters Initialization...
2023-04-19 18:31:01,256 - Detection - ============================== Params ==============================
2023-04-19 18:31:01,256 - Detection - type:	open_intent_detection
2023-04-19 18:31:01,256 - Detection - logger_name:	Detection
2023-04-19 18:31:01,256 - Detection - log_dir:	logs
2023-04-19 18:31:01,256 - Detection - dataset:	banking_cg
2023-04-19 18:31:01,256 - Detection - known_cls_ratio:	0.25
2023-04-19 18:31:01,256 - Detection - labeled_ratio:	1.0
2023-04-19 18:31:01,256 - Detection - method:	DA-ADB
2023-04-19 18:31:01,256 - Detection - train:	True
2023-04-19 18:31:01,256 - Detection - pretrain:	True
2023-04-19 18:31:01,256 - Detection - save_model:	True
2023-04-19 18:31:01,256 - Detection - backbone:	bert_disaware
2023-04-19 18:31:01,256 - Detection - config_file_name:	DA-ADB
2023-04-19 18:31:01,256 - Detection - seed:	4
2023-04-19 18:31:01,256 - Detection - gpu_id:	0
2023-04-19 18:31:01,256 - Detection - pipe_results_path:	pipe_results
2023-04-19 18:31:01,256 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-19 18:31:01,256 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-19 18:31:01,256 - Detection - model_dir:	models
2023-04-19 18:31:01,256 - Detection - load_pretrained_method:	None
2023-04-19 18:31:01,256 - Detection - result_dir:	results
2023-04-19 18:31:01,256 - Detection - results_file_name:	results_DA-ADB.csv
2023-04-19 18:31:01,256 - Detection - save_results:	True
2023-04-19 18:31:01,256 - Detection - loss_fct:	CrossEntropyLoss
2023-04-19 18:31:01,256 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_cg_0.25_1.0_bert_disaware_4
2023-04-19 18:31:01,256 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_cg_0.25_1.0_bert_disaware_4/models
2023-04-19 18:31:01,256 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-19 18:31:01,256 - Detection - num_train_epochs:	100
2023-04-19 18:31:01,256 - Detection - num_labels:	None
2023-04-19 18:31:01,256 - Detection - max_seq_length:	None
2023-04-19 18:31:01,256 - Detection - freeze_backbone_parameters:	True
2023-04-19 18:31:01,256 - Detection - feat_dim:	768
2023-04-19 18:31:01,256 - Detection - warmup_proportion:	0.1
2023-04-19 18:31:01,256 - Detection - scale:	4
2023-04-19 18:31:01,256 - Detection - lr_boundary:	0.05
2023-04-19 18:31:01,256 - Detection - lr:	2e-05
2023-04-19 18:31:01,256 - Detection - activation:	relu
2023-04-19 18:31:01,256 - Detection - train_batch_size:	128
2023-04-19 18:31:01,256 - Detection - eval_batch_size:	64
2023-04-19 18:31:01,256 - Detection - test_batch_size:	64
2023-04-19 18:31:01,256 - Detection - wait_patient:	10
2023-04-19 18:31:01,256 - Detection - ============================== End Params ==============================
2023-04-19 18:31:01,256 - Detection - Data and Model Preparation...
2023-04-19 18:31:01,257 - Detection - The number of known intents is 19
2023-04-19 18:31:01,257 - Detection - Lists of known labels are: ['pending_transfer', 'transfer_not_received_by_recipient', 'top_up_limits', 'pending_top_up', 'card_linking', 'declined_card_payment', 'visa_or_mastercard', 'contactless_not_working', 'direct_debit_payment_not_recognised', 'atm_support', 'card_swallowed', 'why_verify_identity', 'lost_or_stolen_phone', 'automatic_top_up', 'fiat_currency_support', 'pending_cash_withdrawal', 'getting_virtual_card', 'cash_withdrawal_charge', 'card_about_to_expire']
2023-04-19 18:31:01,265 - Detection - Number of labeled training samples = 691
2023-04-19 18:31:01,265 - Detection - Number of unlabeled training samples = 2084
2023-04-19 18:31:01,267 - Detection - Number of evaluation samples = 192
2023-04-19 18:31:01,271 - Detection - Number of testing samples = 1896
2023-04-19 18:31:06,767 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-19 18:31:06,849 - Detection - Pre-training Begin...
2023-04-19 18:31:09,004 - Detection - ***** Epoch: 1: Eval results *****
2023-04-19 18:31:09,005 - Detection -   best_eval_score = 0
2023-04-19 18:31:09,005 - Detection -   eval_score = 1.25
2023-04-19 18:31:09,005 - Detection -   train_loss = 2.9330111742019653
2023-04-19 18:31:10,672 - Detection - ***** Epoch: 2: Eval results *****
2023-04-19 18:31:10,672 - Detection -   best_eval_score = 1.25
2023-04-19 18:31:10,672 - Detection -   eval_score = 0.33
2023-04-19 18:31:10,672 - Detection -   train_loss = 2.914949655532837
2023-04-19 18:31:12,331 - Detection - ***** Epoch: 3: Eval results *****
2023-04-19 18:31:12,331 - Detection -   best_eval_score = 1.25
2023-04-19 18:31:12,331 - Detection -   eval_score = 0.33
2023-04-19 18:31:12,331 - Detection -   train_loss = 2.869473139444987
2023-04-19 18:31:13,986 - Detection - ***** Epoch: 4: Eval results *****
2023-04-19 18:31:13,986 - Detection -   best_eval_score = 1.25
2023-04-19 18:31:13,987 - Detection -   eval_score = 0.33
2023-04-19 18:31:13,987 - Detection -   train_loss = 2.824363589286804
2023-04-19 18:31:15,645 - Detection - ***** Epoch: 5: Eval results *****
2023-04-19 18:31:15,645 - Detection -   best_eval_score = 1.25
2023-04-19 18:31:15,645 - Detection -   eval_score = 0.33
2023-04-19 18:31:15,645 - Detection -   train_loss = 2.7944512367248535
2023-04-19 18:31:17,305 - Detection - ***** Epoch: 6: Eval results *****
2023-04-19 18:31:17,306 - Detection -   best_eval_score = 1.25
2023-04-19 18:31:17,306 - Detection -   eval_score = 0.34
2023-04-19 18:31:17,306 - Detection -   train_loss = 2.760899464289347
2023-04-19 18:31:18,967 - Detection - ***** Epoch: 7: Eval results *****
2023-04-19 18:31:18,967 - Detection -   best_eval_score = 1.25
2023-04-19 18:31:18,967 - Detection -   eval_score = 0.55
2023-04-19 18:31:18,967 - Detection -   train_loss = 2.7451484203338623
2023-04-19 18:31:20,628 - Detection - ***** Epoch: 8: Eval results *****
2023-04-19 18:31:20,628 - Detection -   best_eval_score = 1.25
2023-04-19 18:31:20,628 - Detection -   eval_score = 0.55
2023-04-19 18:31:20,628 - Detection -   train_loss = 2.722898562749227
2023-04-19 18:31:22,288 - Detection - ***** Epoch: 9: Eval results *****
2023-04-19 18:31:22,288 - Detection -   best_eval_score = 1.25
2023-04-19 18:31:22,288 - Detection -   eval_score = 1.38
2023-04-19 18:31:22,288 - Detection -   train_loss = 2.6908369859059653
2023-04-19 18:31:23,965 - Detection - ***** Epoch: 10: Eval results *****
2023-04-19 18:31:23,965 - Detection -   best_eval_score = 1.38
2023-04-19 18:31:23,965 - Detection -   eval_score = 2.78
2023-04-19 18:31:23,965 - Detection -   train_loss = 2.622045358022054
2023-04-19 18:31:25,642 - Detection - ***** Epoch: 11: Eval results *****
2023-04-19 18:31:25,642 - Detection -   best_eval_score = 2.78
2023-04-19 18:31:25,642 - Detection -   eval_score = 8.06
2023-04-19 18:31:25,642 - Detection -   train_loss = 2.531236410140991
2023-04-19 18:31:27,322 - Detection - ***** Epoch: 12: Eval results *****
2023-04-19 18:31:27,322 - Detection -   best_eval_score = 8.06
2023-04-19 18:31:27,322 - Detection -   eval_score = 17.67
2023-04-19 18:31:27,322 - Detection -   train_loss = 2.4036724964777627
2023-04-19 18:31:29,002 - Detection - ***** Epoch: 13: Eval results *****
2023-04-19 18:31:29,002 - Detection -   best_eval_score = 17.67
2023-04-19 18:31:29,002 - Detection -   eval_score = 23.82
2023-04-19 18:31:29,002 - Detection -   train_loss = 2.25842014948527
2023-04-19 18:31:30,681 - Detection - ***** Epoch: 14: Eval results *****
2023-04-19 18:31:30,681 - Detection -   best_eval_score = 23.82
2023-04-19 18:31:30,681 - Detection -   eval_score = 35.22
2023-04-19 18:31:30,681 - Detection -   train_loss = 2.1271267334620156
2023-04-19 18:31:32,363 - Detection - ***** Epoch: 15: Eval results *****
2023-04-19 18:31:32,363 - Detection -   best_eval_score = 35.22
2023-04-19 18:31:32,363 - Detection -   eval_score = 41.54
2023-04-19 18:31:32,363 - Detection -   train_loss = 1.9671123027801514
2023-04-19 18:31:34,045 - Detection - ***** Epoch: 16: Eval results *****
2023-04-19 18:31:34,045 - Detection -   best_eval_score = 41.54
2023-04-19 18:31:34,045 - Detection -   eval_score = 46.84
2023-04-19 18:31:34,045 - Detection -   train_loss = 1.84815247853597
2023-04-19 18:31:35,828 - Detection - ***** Epoch: 17: Eval results *****
2023-04-19 18:31:35,828 - Detection -   best_eval_score = 46.84
2023-04-19 18:31:35,828 - Detection -   eval_score = 53.73
2023-04-19 18:31:35,828 - Detection -   train_loss = 1.7210791905721028
2023-04-19 18:31:37,511 - Detection - ***** Epoch: 18: Eval results *****
2023-04-19 18:31:37,512 - Detection -   best_eval_score = 53.73
2023-04-19 18:31:37,512 - Detection -   eval_score = 57.93
2023-04-19 18:31:37,512 - Detection -   train_loss = 1.6060533324877422
2023-04-19 18:31:39,194 - Detection - ***** Epoch: 19: Eval results *****
2023-04-19 18:31:39,194 - Detection -   best_eval_score = 57.93
2023-04-19 18:31:39,194 - Detection -   eval_score = 61.42
2023-04-19 18:31:39,194 - Detection -   train_loss = 1.5219567219416301
2023-04-19 18:31:40,876 - Detection - ***** Epoch: 20: Eval results *****
2023-04-19 18:31:40,876 - Detection -   best_eval_score = 61.42
2023-04-19 18:31:40,877 - Detection -   eval_score = 62.07
2023-04-19 18:31:40,877 - Detection -   train_loss = 1.4522194266319275
2023-04-19 18:31:42,560 - Detection - ***** Epoch: 21: Eval results *****
2023-04-19 18:31:42,561 - Detection -   best_eval_score = 62.07
2023-04-19 18:31:42,561 - Detection -   eval_score = 64.66
2023-04-19 18:31:42,561 - Detection -   train_loss = 1.3863558769226074
2023-04-19 18:31:44,247 - Detection - ***** Epoch: 22: Eval results *****
2023-04-19 18:31:44,247 - Detection -   best_eval_score = 64.66
2023-04-19 18:31:44,247 - Detection -   eval_score = 67.17
2023-04-19 18:31:44,248 - Detection -   train_loss = 1.3328130046526592
2023-04-19 18:31:45,936 - Detection - ***** Epoch: 23: Eval results *****
2023-04-19 18:31:45,936 - Detection -   best_eval_score = 67.17
2023-04-19 18:31:45,936 - Detection -   eval_score = 68.81
2023-04-19 18:31:45,936 - Detection -   train_loss = 1.2848569750785828
2023-04-19 18:31:47,622 - Detection - ***** Epoch: 24: Eval results *****
2023-04-19 18:31:47,623 - Detection -   best_eval_score = 68.81
2023-04-19 18:31:47,623 - Detection -   eval_score = 68.65
2023-04-19 18:31:47,623 - Detection -   train_loss = 1.2300290862719219
2023-04-19 18:31:49,301 - Detection - ***** Epoch: 25: Eval results *****
2023-04-19 18:31:49,301 - Detection -   best_eval_score = 68.81
2023-04-19 18:31:49,301 - Detection -   eval_score = 73.17
2023-04-19 18:31:49,301 - Detection -   train_loss = 1.2149659991264343
2023-04-19 18:31:50,989 - Detection - ***** Epoch: 26: Eval results *****
2023-04-19 18:31:50,989 - Detection -   best_eval_score = 73.17
2023-04-19 18:31:50,990 - Detection -   eval_score = 74.9
2023-04-19 18:31:50,990 - Detection -   train_loss = 1.171119749546051
2023-04-19 18:31:52,681 - Detection - ***** Epoch: 27: Eval results *****
2023-04-19 18:31:52,681 - Detection -   best_eval_score = 74.9
2023-04-19 18:31:52,681 - Detection -   eval_score = 74.92
2023-04-19 18:31:52,681 - Detection -   train_loss = 1.1374203562736511
2023-04-19 18:31:54,371 - Detection - ***** Epoch: 28: Eval results *****
2023-04-19 18:31:54,371 - Detection -   best_eval_score = 74.92
2023-04-19 18:31:54,371 - Detection -   eval_score = 77.99
2023-04-19 18:31:54,371 - Detection -   train_loss = 1.1127437750498455
2023-04-19 18:31:56,060 - Detection - ***** Epoch: 29: Eval results *****
2023-04-19 18:31:56,061 - Detection -   best_eval_score = 77.99
2023-04-19 18:31:56,061 - Detection -   eval_score = 79.14
2023-04-19 18:31:56,061 - Detection -   train_loss = 1.0902182459831238
2023-04-19 18:31:57,752 - Detection - ***** Epoch: 30: Eval results *****
2023-04-19 18:31:57,752 - Detection -   best_eval_score = 79.14
2023-04-19 18:31:57,752 - Detection -   eval_score = 81.52
2023-04-19 18:31:57,752 - Detection -   train_loss = 1.0651057362556458
2023-04-19 18:31:59,443 - Detection - ***** Epoch: 31: Eval results *****
2023-04-19 18:31:59,443 - Detection -   best_eval_score = 81.52
2023-04-19 18:31:59,443 - Detection -   eval_score = 83.23
2023-04-19 18:31:59,443 - Detection -   train_loss = 1.041251689195633
2023-04-19 18:32:01,135 - Detection - ***** Epoch: 32: Eval results *****
2023-04-19 18:32:01,135 - Detection -   best_eval_score = 83.23
2023-04-19 18:32:01,135 - Detection -   eval_score = 82.15
2023-04-19 18:32:01,135 - Detection -   train_loss = 1.0170363585154216
2023-04-19 18:32:02,815 - Detection - ***** Epoch: 33: Eval results *****
2023-04-19 18:32:02,815 - Detection -   best_eval_score = 83.23
2023-04-19 18:32:02,816 - Detection -   eval_score = 84.37
2023-04-19 18:32:02,816 - Detection -   train_loss = 1.0004425048828125
2023-04-19 18:32:04,508 - Detection - ***** Epoch: 34: Eval results *****
2023-04-19 18:32:04,508 - Detection -   best_eval_score = 84.37
2023-04-19 18:32:04,508 - Detection -   eval_score = 84.32
2023-04-19 18:32:04,508 - Detection -   train_loss = 0.9794410566488901
2023-04-19 18:32:06,192 - Detection - ***** Epoch: 35: Eval results *****
2023-04-19 18:32:06,192 - Detection -   best_eval_score = 84.37
2023-04-19 18:32:06,192 - Detection -   eval_score = 86.87
2023-04-19 18:32:06,192 - Detection -   train_loss = 0.9752627412478129
2023-04-19 18:32:07,888 - Detection - ***** Epoch: 36: Eval results *****
2023-04-19 18:32:07,888 - Detection -   best_eval_score = 86.87
2023-04-19 18:32:07,888 - Detection -   eval_score = 87.88
2023-04-19 18:32:07,888 - Detection -   train_loss = 0.9525935451189677
2023-04-19 18:32:09,584 - Detection - ***** Epoch: 37: Eval results *****
2023-04-19 18:32:09,584 - Detection -   best_eval_score = 87.88
2023-04-19 18:32:09,584 - Detection -   eval_score = 87.53
2023-04-19 18:32:09,584 - Detection -   train_loss = 0.9428022702534994
2023-04-19 18:32:11,271 - Detection - ***** Epoch: 38: Eval results *****
2023-04-19 18:32:11,271 - Detection -   best_eval_score = 87.88
2023-04-19 18:32:11,271 - Detection -   eval_score = 87.88
2023-04-19 18:32:11,271 - Detection -   train_loss = 0.9336784879366556
2023-04-19 18:32:12,956 - Detection - ***** Epoch: 39: Eval results *****
2023-04-19 18:32:12,956 - Detection -   best_eval_score = 87.88
2023-04-19 18:32:12,956 - Detection -   eval_score = 87.98
2023-04-19 18:32:12,956 - Detection -   train_loss = 0.9230203032493591
2023-04-19 18:32:14,652 - Detection - ***** Epoch: 40: Eval results *****
2023-04-19 18:32:14,652 - Detection -   best_eval_score = 87.98
2023-04-19 18:32:14,652 - Detection -   eval_score = 88.64
2023-04-19 18:32:14,652 - Detection -   train_loss = 0.8982710142930349
2023-04-19 18:32:16,349 - Detection - ***** Epoch: 41: Eval results *****
2023-04-19 18:32:16,349 - Detection -   best_eval_score = 88.64
2023-04-19 18:32:16,349 - Detection -   eval_score = 88.29
2023-04-19 18:32:16,349 - Detection -   train_loss = 0.8925955891609192
2023-04-19 18:32:18,030 - Detection - ***** Epoch: 42: Eval results *****
2023-04-19 18:32:18,030 - Detection -   best_eval_score = 88.64
2023-04-19 18:32:18,030 - Detection -   eval_score = 88.27
2023-04-19 18:32:18,030 - Detection -   train_loss = 0.8928024073441824
2023-04-19 18:32:19,712 - Detection - ***** Epoch: 43: Eval results *****
2023-04-19 18:32:19,712 - Detection -   best_eval_score = 88.64
2023-04-19 18:32:19,712 - Detection -   eval_score = 88.64
2023-04-19 18:32:19,712 - Detection -   train_loss = 0.8725971976915995
2023-04-19 18:32:21,394 - Detection - ***** Epoch: 44: Eval results *****
2023-04-19 18:32:21,394 - Detection -   best_eval_score = 88.64
2023-04-19 18:32:21,394 - Detection -   eval_score = 89.03
2023-04-19 18:32:21,394 - Detection -   train_loss = 0.8794965048631033
2023-04-19 18:32:23,088 - Detection - ***** Epoch: 45: Eval results *****
2023-04-19 18:32:23,088 - Detection -   best_eval_score = 89.03
2023-04-19 18:32:23,088 - Detection -   eval_score = 88.99
2023-04-19 18:32:23,088 - Detection -   train_loss = 0.8583317597707113
2023-04-19 18:32:24,770 - Detection - ***** Epoch: 46: Eval results *****
2023-04-19 18:32:24,770 - Detection -   best_eval_score = 89.03
2023-04-19 18:32:24,770 - Detection -   eval_score = 88.99
2023-04-19 18:32:24,770 - Detection -   train_loss = 0.8509390552838644
2023-04-19 18:32:26,450 - Detection - ***** Epoch: 47: Eval results *****
2023-04-19 18:32:26,450 - Detection -   best_eval_score = 89.03
2023-04-19 18:32:26,450 - Detection -   eval_score = 89.03
2023-04-19 18:32:26,450 - Detection -   train_loss = 0.8331656555334727
2023-04-19 18:32:28,132 - Detection - ***** Epoch: 48: Eval results *****
2023-04-19 18:32:28,132 - Detection -   best_eval_score = 89.03
2023-04-19 18:32:28,132 - Detection -   eval_score = 89.03
2023-04-19 18:32:28,132 - Detection -   train_loss = 0.8319967289765676
2023-04-19 18:32:29,812 - Detection - ***** Epoch: 49: Eval results *****
2023-04-19 18:32:29,812 - Detection -   best_eval_score = 89.03
2023-04-19 18:32:29,812 - Detection -   eval_score = 89.77
2023-04-19 18:32:29,812 - Detection -   train_loss = 0.8322282334168752
2023-04-19 18:32:31,503 - Detection - ***** Epoch: 50: Eval results *****
2023-04-19 18:32:31,503 - Detection -   best_eval_score = 89.77
2023-04-19 18:32:31,504 - Detection -   eval_score = 89.45
2023-04-19 18:32:31,504 - Detection -   train_loss = 0.8237324655056
2023-04-19 18:32:33,184 - Detection - ***** Epoch: 51: Eval results *****
2023-04-19 18:32:33,185 - Detection -   best_eval_score = 89.77
2023-04-19 18:32:33,185 - Detection -   eval_score = 89.44
2023-04-19 18:32:33,185 - Detection -   train_loss = 0.8235338926315308
2023-04-19 18:32:34,867 - Detection - ***** Epoch: 52: Eval results *****
2023-04-19 18:32:34,867 - Detection -   best_eval_score = 89.77
2023-04-19 18:32:34,867 - Detection -   eval_score = 89.44
2023-04-19 18:32:34,867 - Detection -   train_loss = 0.8215257823467255
2023-04-19 18:32:36,547 - Detection - ***** Epoch: 53: Eval results *****
2023-04-19 18:32:36,547 - Detection -   best_eval_score = 89.77
2023-04-19 18:32:36,547 - Detection -   eval_score = 89.38
2023-04-19 18:32:36,547 - Detection -   train_loss = 0.8120963871479034
2023-04-19 18:32:38,226 - Detection - ***** Epoch: 54: Eval results *****
2023-04-19 18:32:38,226 - Detection -   best_eval_score = 89.77
2023-04-19 18:32:38,227 - Detection -   eval_score = 89.38
2023-04-19 18:32:38,227 - Detection -   train_loss = 0.8093909124533335
2023-04-19 18:32:40,010 - Detection - ***** Epoch: 55: Eval results *****
2023-04-19 18:32:40,010 - Detection -   best_eval_score = 89.77
2023-04-19 18:32:40,010 - Detection -   eval_score = 89.44
2023-04-19 18:32:40,010 - Detection -   train_loss = 0.8133582870165507
2023-04-19 18:32:41,691 - Detection - ***** Epoch: 56: Eval results *****
2023-04-19 18:32:41,692 - Detection -   best_eval_score = 89.77
2023-04-19 18:32:41,692 - Detection -   eval_score = 89.88
2023-04-19 18:32:41,692 - Detection -   train_loss = 0.7943135599295298
2023-04-19 18:32:43,383 - Detection - ***** Epoch: 57: Eval results *****
2023-04-19 18:32:43,383 - Detection -   best_eval_score = 89.88
2023-04-19 18:32:43,383 - Detection -   eval_score = 89.88
2023-04-19 18:32:43,383 - Detection -   train_loss = 0.7990161081155142
2023-04-19 18:32:45,064 - Detection - ***** Epoch: 58: Eval results *****
2023-04-19 18:32:45,064 - Detection -   best_eval_score = 89.88
2023-04-19 18:32:45,064 - Detection -   eval_score = 90.21
2023-04-19 18:32:45,064 - Detection -   train_loss = 0.7900374829769135
2023-04-19 18:32:46,756 - Detection - ***** Epoch: 59: Eval results *****
2023-04-19 18:32:46,756 - Detection -   best_eval_score = 90.21
2023-04-19 18:32:46,756 - Detection -   eval_score = 90.59
2023-04-19 18:32:46,756 - Detection -   train_loss = 0.7864971359570821
2023-04-19 18:32:48,447 - Detection - ***** Epoch: 60: Eval results *****
2023-04-19 18:32:48,447 - Detection -   best_eval_score = 90.59
2023-04-19 18:32:48,447 - Detection -   eval_score = 90.23
2023-04-19 18:32:48,447 - Detection -   train_loss = 0.7920277019341787
2023-04-19 18:32:50,126 - Detection - ***** Epoch: 61: Eval results *****
2023-04-19 18:32:50,126 - Detection -   best_eval_score = 90.59
2023-04-19 18:32:50,126 - Detection -   eval_score = 89.83
2023-04-19 18:32:50,126 - Detection -   train_loss = 0.7776660621166229
2023-04-19 18:32:51,804 - Detection - ***** Epoch: 62: Eval results *****
2023-04-19 18:32:51,804 - Detection -   best_eval_score = 90.59
2023-04-19 18:32:51,804 - Detection -   eval_score = 89.83
2023-04-19 18:32:51,804 - Detection -   train_loss = 0.7786203324794769
2023-04-19 18:32:53,483 - Detection - ***** Epoch: 63: Eval results *****
2023-04-19 18:32:53,483 - Detection -   best_eval_score = 90.59
2023-04-19 18:32:53,484 - Detection -   eval_score = 89.83
2023-04-19 18:32:53,484 - Detection -   train_loss = 0.7686990598837534
2023-04-19 18:32:55,162 - Detection - ***** Epoch: 64: Eval results *****
2023-04-19 18:32:55,162 - Detection -   best_eval_score = 90.59
2023-04-19 18:32:55,162 - Detection -   eval_score = 90.99
2023-04-19 18:32:55,162 - Detection -   train_loss = 0.7754334509372711
2023-04-19 18:32:56,852 - Detection - ***** Epoch: 65: Eval results *****
2023-04-19 18:32:56,852 - Detection -   best_eval_score = 90.99
2023-04-19 18:32:56,852 - Detection -   eval_score = 89.86
2023-04-19 18:32:56,852 - Detection -   train_loss = 0.767425149679184
2023-04-19 18:32:58,534 - Detection - ***** Epoch: 66: Eval results *****
2023-04-19 18:32:58,534 - Detection -   best_eval_score = 90.99
2023-04-19 18:32:58,534 - Detection -   eval_score = 89.86
2023-04-19 18:32:58,534 - Detection -   train_loss = 0.7688467701276144
2023-04-19 18:33:00,214 - Detection - ***** Epoch: 67: Eval results *****
2023-04-19 18:33:00,214 - Detection -   best_eval_score = 90.99
2023-04-19 18:33:00,214 - Detection -   eval_score = 89.79
2023-04-19 18:33:00,214 - Detection -   train_loss = 0.7598068714141846
2023-04-19 18:33:01,893 - Detection - ***** Epoch: 68: Eval results *****
2023-04-19 18:33:01,893 - Detection -   best_eval_score = 90.99
2023-04-19 18:33:01,893 - Detection -   eval_score = 89.79
2023-04-19 18:33:01,893 - Detection -   train_loss = 0.7566657463709513
2023-04-19 18:33:03,575 - Detection - ***** Epoch: 69: Eval results *****
2023-04-19 18:33:03,575 - Detection -   best_eval_score = 90.99
2023-04-19 18:33:03,575 - Detection -   eval_score = 90.95
2023-04-19 18:33:03,575 - Detection -   train_loss = 0.7547167738278707
2023-04-19 18:33:05,253 - Detection - ***** Epoch: 70: Eval results *****
2023-04-19 18:33:05,253 - Detection -   best_eval_score = 90.99
2023-04-19 18:33:05,253 - Detection -   eval_score = 90.95
2023-04-19 18:33:05,253 - Detection -   train_loss = 0.7506737013657888
2023-04-19 18:33:06,930 - Detection - ***** Epoch: 71: Eval results *****
2023-04-19 18:33:06,930 - Detection -   best_eval_score = 90.99
2023-04-19 18:33:06,930 - Detection -   eval_score = 91.03
2023-04-19 18:33:06,930 - Detection -   train_loss = 0.7579967975616455
2023-04-19 18:33:08,623 - Detection - ***** Epoch: 72: Eval results *****
2023-04-19 18:33:08,623 - Detection -   best_eval_score = 91.03
2023-04-19 18:33:08,623 - Detection -   eval_score = 90.67
2023-04-19 18:33:08,623 - Detection -   train_loss = 0.7500632405281067
2023-04-19 18:33:10,301 - Detection - ***** Epoch: 73: Eval results *****
2023-04-19 18:33:10,301 - Detection -   best_eval_score = 91.03
2023-04-19 18:33:10,301 - Detection -   eval_score = 90.24
2023-04-19 18:33:10,301 - Detection -   train_loss = 0.7608731289704641
2023-04-19 18:33:11,981 - Detection - ***** Epoch: 74: Eval results *****
2023-04-19 18:33:11,981 - Detection -   best_eval_score = 91.03
2023-04-19 18:33:11,981 - Detection -   eval_score = 90.67
2023-04-19 18:33:11,981 - Detection -   train_loss = 0.741862823565801
2023-04-19 18:33:13,659 - Detection - ***** Epoch: 75: Eval results *****
2023-04-19 18:33:13,659 - Detection -   best_eval_score = 91.03
2023-04-19 18:33:13,659 - Detection -   eval_score = 90.24
2023-04-19 18:33:13,659 - Detection -   train_loss = 0.7490092615286509
2023-04-19 18:33:15,335 - Detection - ***** Epoch: 76: Eval results *****
2023-04-19 18:33:15,335 - Detection -   best_eval_score = 91.03
2023-04-19 18:33:15,336 - Detection -   eval_score = 90.6
2023-04-19 18:33:15,336 - Detection -   train_loss = 0.7495285173257192
2023-04-19 18:33:17,014 - Detection - ***** Epoch: 77: Eval results *****
2023-04-19 18:33:17,014 - Detection -   best_eval_score = 91.03
2023-04-19 18:33:17,014 - Detection -   eval_score = 90.6
2023-04-19 18:33:17,014 - Detection -   train_loss = 0.750630666812261
2023-04-19 18:33:18,690 - Detection - ***** Epoch: 78: Eval results *****
2023-04-19 18:33:18,690 - Detection -   best_eval_score = 91.03
2023-04-19 18:33:18,690 - Detection -   eval_score = 90.6
2023-04-19 18:33:18,690 - Detection -   train_loss = 0.7454623679320017
2023-04-19 18:33:20,369 - Detection - ***** Epoch: 79: Eval results *****
2023-04-19 18:33:20,369 - Detection -   best_eval_score = 91.03
2023-04-19 18:33:20,369 - Detection -   eval_score = 90.6
2023-04-19 18:33:20,370 - Detection -   train_loss = 0.7518954277038574
2023-04-19 18:33:22,047 - Detection - ***** Epoch: 80: Eval results *****
2023-04-19 18:33:22,047 - Detection -   best_eval_score = 91.03
2023-04-19 18:33:22,047 - Detection -   eval_score = 90.6
2023-04-19 18:33:22,047 - Detection -   train_loss = 0.7433698077996572
2023-04-19 18:33:23,727 - Detection - ***** Epoch: 81: Eval results *****
2023-04-19 18:33:23,727 - Detection -   best_eval_score = 91.03
2023-04-19 18:33:23,727 - Detection -   eval_score = 90.6
2023-04-19 18:33:23,727 - Detection -   train_loss = 0.7400025626023611
2023-04-19 18:33:23,727 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_cg_0.25_1.0_bert_disaware_4/models
2023-04-19 18:33:24,274 - Detection - Pre-training finished...
2023-04-19 18:33:24,275 - Detection - Training Begin...
2023-04-19 18:33:25,256 - Detection - ***** Epoch: 1: Eval results *****
2023-04-19 18:33:25,256 - Detection -   best_eval_score = 0
2023-04-19 18:33:25,256 - Detection -   eval_score = 0.0
2023-04-19 18:33:25,256 - Detection -   train_loss = 3.246182084083557
2023-04-19 18:33:26,235 - Detection - ***** Epoch: 2: Eval results *****
2023-04-19 18:33:26,235 - Detection -   best_eval_score = 0
2023-04-19 18:33:26,236 - Detection -   eval_score = 1.11
2023-04-19 18:33:26,236 - Detection -   train_loss = 3.05181622505188
2023-04-19 18:33:27,216 - Detection - ***** Epoch: 3: Eval results *****
2023-04-19 18:33:27,216 - Detection -   best_eval_score = 1.11
2023-04-19 18:33:27,216 - Detection -   eval_score = 5.87
2023-04-19 18:33:27,216 - Detection -   train_loss = 2.870212117830912
2023-04-19 18:33:28,196 - Detection - ***** Epoch: 4: Eval results *****
2023-04-19 18:33:28,196 - Detection -   best_eval_score = 5.87
2023-04-19 18:33:28,196 - Detection -   eval_score = 13.25
2023-04-19 18:33:28,196 - Detection -   train_loss = 2.6477774381637573
2023-04-19 18:33:29,177 - Detection - ***** Epoch: 5: Eval results *****
2023-04-19 18:33:29,177 - Detection -   best_eval_score = 13.25
2023-04-19 18:33:29,177 - Detection -   eval_score = 15.53
2023-04-19 18:33:29,177 - Detection -   train_loss = 2.3922606706619263
2023-04-19 18:33:30,157 - Detection - ***** Epoch: 6: Eval results *****
2023-04-19 18:33:30,157 - Detection -   best_eval_score = 15.53
2023-04-19 18:33:30,157 - Detection -   eval_score = 21.58
2023-04-19 18:33:30,157 - Detection -   train_loss = 2.146465281645457
2023-04-19 18:33:31,138 - Detection - ***** Epoch: 7: Eval results *****
2023-04-19 18:33:31,138 - Detection -   best_eval_score = 21.58
2023-04-19 18:33:31,138 - Detection -   eval_score = 28.28
2023-04-19 18:33:31,138 - Detection -   train_loss = 1.9099790056546528
2023-04-19 18:33:32,119 - Detection - ***** Epoch: 8: Eval results *****
2023-04-19 18:33:32,119 - Detection -   best_eval_score = 28.28
2023-04-19 18:33:32,119 - Detection -   eval_score = 34.67
2023-04-19 18:33:32,119 - Detection -   train_loss = 1.6396963993708293
2023-04-19 18:33:33,099 - Detection - ***** Epoch: 9: Eval results *****
2023-04-19 18:33:33,099 - Detection -   best_eval_score = 34.67
2023-04-19 18:33:33,099 - Detection -   eval_score = 43.41
2023-04-19 18:33:33,099 - Detection -   train_loss = 1.3965303500493367
2023-04-19 18:33:34,080 - Detection - ***** Epoch: 10: Eval results *****
2023-04-19 18:33:34,080 - Detection -   best_eval_score = 43.41
2023-04-19 18:33:34,080 - Detection -   eval_score = 51.9
2023-04-19 18:33:34,080 - Detection -   train_loss = 1.1500296990076702
2023-04-19 18:33:35,060 - Detection - ***** Epoch: 11: Eval results *****
2023-04-19 18:33:35,060 - Detection -   best_eval_score = 51.9
2023-04-19 18:33:35,060 - Detection -   eval_score = 60.13
2023-04-19 18:33:35,060 - Detection -   train_loss = 0.937709112962087
2023-04-19 18:33:36,040 - Detection - ***** Epoch: 12: Eval results *****
2023-04-19 18:33:36,040 - Detection -   best_eval_score = 60.13
2023-04-19 18:33:36,040 - Detection -   eval_score = 65.01
2023-04-19 18:33:36,040 - Detection -   train_loss = 0.7811999320983887
2023-04-19 18:33:37,020 - Detection - ***** Epoch: 13: Eval results *****
2023-04-19 18:33:37,020 - Detection -   best_eval_score = 65.01
2023-04-19 18:33:37,020 - Detection -   eval_score = 66.96
2023-04-19 18:33:37,020 - Detection -   train_loss = 0.6525668303171793
2023-04-19 18:33:38,000 - Detection - ***** Epoch: 14: Eval results *****
2023-04-19 18:33:38,001 - Detection -   best_eval_score = 66.96
2023-04-19 18:33:38,001 - Detection -   eval_score = 70.38
2023-04-19 18:33:38,001 - Detection -   train_loss = 0.6047279040018717
2023-04-19 18:33:38,982 - Detection - ***** Epoch: 15: Eval results *****
2023-04-19 18:33:38,982 - Detection -   best_eval_score = 70.38
2023-04-19 18:33:38,982 - Detection -   eval_score = 70.64
2023-04-19 18:33:38,982 - Detection -   train_loss = 0.5684340496857961
2023-04-19 18:33:39,962 - Detection - ***** Epoch: 16: Eval results *****
2023-04-19 18:33:39,962 - Detection -   best_eval_score = 70.64
2023-04-19 18:33:39,962 - Detection -   eval_score = 70.97
2023-04-19 18:33:39,962 - Detection -   train_loss = 0.5216181774934133
2023-04-19 18:33:40,944 - Detection - ***** Epoch: 17: Eval results *****
2023-04-19 18:33:40,944 - Detection -   best_eval_score = 70.97
2023-04-19 18:33:40,944 - Detection -   eval_score = 70.76
2023-04-19 18:33:40,944 - Detection -   train_loss = 0.552864134311676
2023-04-19 18:33:41,923 - Detection - ***** Epoch: 18: Eval results *****
2023-04-19 18:33:41,924 - Detection -   best_eval_score = 70.97
2023-04-19 18:33:41,924 - Detection -   eval_score = 70.76
2023-04-19 18:33:41,924 - Detection -   train_loss = 0.5579764743645986
2023-04-19 18:33:42,904 - Detection - ***** Epoch: 19: Eval results *****
2023-04-19 18:33:42,904 - Detection -   best_eval_score = 70.97
2023-04-19 18:33:42,904 - Detection -   eval_score = 70.76
2023-04-19 18:33:42,904 - Detection -   train_loss = 0.532827893892924
2023-04-19 18:33:43,884 - Detection - ***** Epoch: 20: Eval results *****
2023-04-19 18:33:43,884 - Detection -   best_eval_score = 70.97
2023-04-19 18:33:43,884 - Detection -   eval_score = 70.76
2023-04-19 18:33:43,884 - Detection -   train_loss = 0.5475950539112091
2023-04-19 18:33:44,864 - Detection - ***** Epoch: 21: Eval results *****
2023-04-19 18:33:44,864 - Detection -   best_eval_score = 70.97
2023-04-19 18:33:44,864 - Detection -   eval_score = 70.43
2023-04-19 18:33:44,865 - Detection -   train_loss = 0.5564932723840078
2023-04-19 18:33:45,845 - Detection - ***** Epoch: 22: Eval results *****
2023-04-19 18:33:45,845 - Detection -   best_eval_score = 70.97
2023-04-19 18:33:45,845 - Detection -   eval_score = 70.43
2023-04-19 18:33:45,845 - Detection -   train_loss = 0.5544199148813883
2023-04-19 18:33:46,825 - Detection - ***** Epoch: 23: Eval results *****
2023-04-19 18:33:46,825 - Detection -   best_eval_score = 70.97
2023-04-19 18:33:46,825 - Detection -   eval_score = 70.43
2023-04-19 18:33:46,825 - Detection -   train_loss = 0.5660394777854284
2023-04-19 18:33:47,805 - Detection - ***** Epoch: 24: Eval results *****
2023-04-19 18:33:47,805 - Detection -   best_eval_score = 70.97
2023-04-19 18:33:47,805 - Detection -   eval_score = 70.43
2023-04-19 18:33:47,805 - Detection -   train_loss = 0.538659597436587
2023-04-19 18:33:48,786 - Detection - ***** Epoch: 25: Eval results *****
2023-04-19 18:33:48,786 - Detection -   best_eval_score = 70.97
2023-04-19 18:33:48,786 - Detection -   eval_score = 70.76
2023-04-19 18:33:48,786 - Detection -   train_loss = 0.5510148306687673
2023-04-19 18:33:49,767 - Detection - ***** Epoch: 26: Eval results *****
2023-04-19 18:33:49,767 - Detection -   best_eval_score = 70.97
2023-04-19 18:33:49,767 - Detection -   eval_score = 70.43
2023-04-19 18:33:49,767 - Detection -   train_loss = 0.5219143033027649
2023-04-19 18:33:49,768 - Detection - Training Finished...
2023-04-19 18:33:49,768 - Detection - Testing begin...
2023-04-19 18:33:51,674 - Detection - ***** Test: Confusion Matrix *****
2023-04-19 18:33:51,675 - Detection - [[  18    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0   16]
 [   2   12    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0   13]
 [   0    0   12    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    7]
 [   0    0    0   15    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0   10]
 [   0    0    0    0   14    0    0    0    0    0    0    0    0    0
     0    0    0    0    0   14]
 [   0    0    0    0    0   22    0    0    0    0    0    0    0    0
     0    0    0    0    0   10]
 [   0    0    0    0    0    0   17    0    0    0    0    0    0    0
     0    0    0    0    0    3]
 [   0    0    0    0    0    0    0   12    0    0    0    0    0    0
     0    0    0    0    0    8]
 [   0    0    0    0    0    0    0    0    5    0    0    0    0    0
     0    0    0    0    0   11]
 [   0    0    0    0    0    0    0    0    0    7    0    0    0    0
     0    0    0    0    0   13]
 [   0    0    0    0    0    0    0    0    0    0    2    0    0    0
     0    0    0    0    0   15]
 [   0    0    0    0    0    0    0    0    0    0    0   20    0    0
     0    0    0    0    0    2]
 [   0    0    0    0    0    0    0    0    0    0    0    0   13    0
     0    0    0    0    0   11]
 [   0    0    1    0    0    0    0    0    0    0    0    0    0    9
     0    0    0    0    0   14]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
    15    0    0    0    0    8]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0   19    0    0    0   10]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0   19    0    0    2]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0   29    0    5]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0   19   12]
 [  17   14    1   25    3   21    2    0    2    0    0   36    0    3
    57    5   14   10    0 1220]]
2023-04-19 18:33:51,675 - Detection - ***** Test results *****
2023-04-19 18:33:51,675 - Detection -   Acc = 79.06
2023-04-19 18:33:51,675 - Detection -   F1 = 60.0534
2023-04-19 18:33:51,675 - Detection -   F1-known = 58.6827
2023-04-19 18:33:51,675 - Detection -   F1-open = 86.0974
2023-04-19 18:33:51,675 - Detection - Testing finished...
2023-04-19 18:33:51,675 - Detection - Results saved in results/results_DA-ADB.csv
2023-04-19 18:33:51,696 - Detection - Open Intent Detection Finished...
