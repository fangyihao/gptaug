2023-04-05 03:19:17,911 - Detection - Open Intent Detection Begin...
2023-04-05 03:19:17,911 - Detection - Parameters Initialization...
2023-04-05 03:19:17,912 - Detection - ============================== Params ==============================
2023-04-05 03:19:17,912 - Detection - type:	open_intent_detection
2023-04-05 03:19:17,912 - Detection - logger_name:	Detection
2023-04-05 03:19:17,912 - Detection - log_dir:	logs
2023-04-05 03:19:17,912 - Detection - dataset:	oos
2023-04-05 03:19:17,912 - Detection - known_cls_ratio:	0.5
2023-04-05 03:19:17,912 - Detection - labeled_ratio:	1.0
2023-04-05 03:19:17,912 - Detection - method:	ADB
2023-04-05 03:19:17,912 - Detection - train:	True
2023-04-05 03:19:17,912 - Detection - pretrain:	True
2023-04-05 03:19:17,912 - Detection - save_model:	True
2023-04-05 03:19:17,912 - Detection - backbone:	bert
2023-04-05 03:19:17,912 - Detection - config_file_name:	ADB
2023-04-05 03:19:17,912 - Detection - seed:	9
2023-04-05 03:19:17,912 - Detection - gpu_id:	0
2023-04-05 03:19:17,912 - Detection - pipe_results_path:	pipe_results
2023-04-05 03:19:17,912 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-05 03:19:17,912 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-05 03:19:17,912 - Detection - model_dir:	models
2023-04-05 03:19:17,912 - Detection - load_pretrained_method:	None
2023-04-05 03:19:17,912 - Detection - result_dir:	results
2023-04-05 03:19:17,912 - Detection - results_file_name:	results_ADB.csv
2023-04-05 03:19:17,912 - Detection - save_results:	True
2023-04-05 03:19:17,912 - Detection - loss_fct:	CrossEntropyLoss
2023-04-05 03:19:17,912 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_0.5_1.0_bert_9
2023-04-05 03:19:17,912 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_0.5_1.0_bert_9/models
2023-04-05 03:19:17,912 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-05 03:19:17,912 - Detection - num_train_epochs:	100
2023-04-05 03:19:17,912 - Detection - num_labels:	None
2023-04-05 03:19:17,912 - Detection - max_seq_length:	None
2023-04-05 03:19:17,912 - Detection - freeze_backbone_parameters:	True
2023-04-05 03:19:17,912 - Detection - feat_dim:	768
2023-04-05 03:19:17,912 - Detection - warmup_proportion:	0.1
2023-04-05 03:19:17,912 - Detection - lr_boundary:	0.05
2023-04-05 03:19:17,912 - Detection - lr:	2e-05
2023-04-05 03:19:17,912 - Detection - activation:	relu
2023-04-05 03:19:17,912 - Detection - train_batch_size:	128
2023-04-05 03:19:17,912 - Detection - eval_batch_size:	64
2023-04-05 03:19:17,912 - Detection - test_batch_size:	64
2023-04-05 03:19:17,912 - Detection - wait_patient:	10
2023-04-05 03:19:17,912 - Detection - ============================== End Params ==============================
2023-04-05 03:19:17,912 - Detection - Data and Model Preparation...
2023-04-05 03:19:17,913 - Detection - The number of known intents is 75
2023-04-05 03:19:17,913 - Detection - Lists of known labels are: ['uber', 'pto_request_status', 'where_are_you_from', 'who_do_you_work_for', 'international_fees', 'distance', 'confirm_reservation', 'application_status', 'next_song', 'book_flight', 'change_volume', 'new_card', 'report_fraud', 'reminder', 'exchange_rate', 'order_checks', 'current_location', 'ingredient_substitution', 'restaurant_reservation', 'gas', 'credit_limit', 'cook_time', 'shopping_list', 'change_accent', 'tell_joke', 'pto_request', 'flip_coin', 'what_song', 'bill_due', 'user_name', 'shopping_list_update', 'vaccines', 'change_speed', 'meal_suggestion', 'oil_change_when', 'order_status', 'no', 'freeze_account', 'schedule_meeting', 'bill_balance', 'car_rental', 'reset_settings', 'play_music', 'food_last', 'restaurant_suggestion', 'meaning_of_life', 'balance', 'measurement_conversion', 'direct_deposit', 'transfer', 'meeting_schedule', 'how_busy', 'book_hotel', 'improve_credit_score', 'travel_notification', 'update_playlist', 'share_location', 'weather', 'order', 'change_ai_name', 'travel_suggestion', 'do_you_have_pets', 'alarm', 'payday', 'sync_device', 'calculator', 'insurance', 'oil_change_how', 'timer', 'repeat', 'replacement_card_duration', 'directions', 'damaged_card', 'who_made_you', 'pto_balance']
2023-04-05 03:19:17,964 - Detection - Number of labeled training samples = 7500
2023-04-05 03:19:17,964 - Detection - Number of unlabeled training samples = 7500
2023-04-05 03:19:17,972 - Detection - Number of evaluation samples = 1500
2023-04-05 03:19:17,984 - Detection - Number of testing samples = 5700
2023-04-05 03:19:25,488 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-05 03:19:27,164 - Detection - Pre-training Begin...
2023-04-05 03:19:33,489 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 03:19:33,489 - Detection -   best_eval_score = 0
2023-04-05 03:19:33,489 - Detection -   eval_score = 2.2
2023-04-05 03:19:33,489 - Detection -   train_loss = 4.314364837387861
2023-04-05 03:19:39,331 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 03:19:39,331 - Detection -   best_eval_score = 2.2
2023-04-05 03:19:39,331 - Detection -   eval_score = 8.47
2023-04-05 03:19:39,331 - Detection -   train_loss = 4.2790905176582985
2023-04-05 03:19:45,265 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 03:19:45,265 - Detection -   best_eval_score = 8.47
2023-04-05 03:19:45,265 - Detection -   eval_score = 35.0
2023-04-05 03:19:45,265 - Detection -   train_loss = 4.177415354777191
2023-04-05 03:19:51,416 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 03:19:51,416 - Detection -   best_eval_score = 35.0
2023-04-05 03:19:51,416 - Detection -   eval_score = 59.4
2023-04-05 03:19:51,416 - Detection -   train_loss = 3.824788562322067
2023-04-05 03:19:57,664 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 03:19:57,665 - Detection -   best_eval_score = 59.4
2023-04-05 03:19:57,665 - Detection -   eval_score = 72.87
2023-04-05 03:19:57,665 - Detection -   train_loss = 3.0976852643287787
2023-04-05 03:20:04,014 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 03:20:04,015 - Detection -   best_eval_score = 72.87
2023-04-05 03:20:04,015 - Detection -   eval_score = 85.13
2023-04-05 03:20:04,015 - Detection -   train_loss = 2.296451687812805
2023-04-05 03:20:10,259 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 03:20:10,259 - Detection -   best_eval_score = 85.13
2023-04-05 03:20:10,259 - Detection -   eval_score = 89.8
2023-04-05 03:20:10,259 - Detection -   train_loss = 1.5993017503770732
2023-04-05 03:20:16,503 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 03:20:16,503 - Detection -   best_eval_score = 89.8
2023-04-05 03:20:16,503 - Detection -   eval_score = 92.8
2023-04-05 03:20:16,503 - Detection -   train_loss = 1.095061770940231
2023-04-05 03:20:22,752 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 03:20:22,752 - Detection -   best_eval_score = 92.8
2023-04-05 03:20:22,752 - Detection -   eval_score = 94.2
2023-04-05 03:20:22,752 - Detection -   train_loss = 0.7547128867294829
2023-04-05 03:20:28,989 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 03:20:28,989 - Detection -   best_eval_score = 94.2
2023-04-05 03:20:28,989 - Detection -   eval_score = 95.2
2023-04-05 03:20:28,989 - Detection -   train_loss = 0.5393119949405476
2023-04-05 03:20:35,242 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 03:20:35,242 - Detection -   best_eval_score = 95.2
2023-04-05 03:20:35,242 - Detection -   eval_score = 95.33
2023-04-05 03:20:35,242 - Detection -   train_loss = 0.4034418751627712
2023-04-05 03:20:41,486 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 03:20:41,486 - Detection -   best_eval_score = 95.33
2023-04-05 03:20:41,486 - Detection -   eval_score = 95.67
2023-04-05 03:20:41,486 - Detection -   train_loss = 0.3153159481994176
2023-04-05 03:20:47,726 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 03:20:47,727 - Detection -   best_eval_score = 95.67
2023-04-05 03:20:47,727 - Detection -   eval_score = 95.73
2023-04-05 03:20:47,727 - Detection -   train_loss = 0.2613421122906572
2023-04-05 03:20:53,979 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 03:20:53,979 - Detection -   best_eval_score = 95.73
2023-04-05 03:20:53,979 - Detection -   eval_score = 96.2
2023-04-05 03:20:53,979 - Detection -   train_loss = 0.21813337530119944
2023-04-05 03:21:00,221 - Detection - ***** Epoch: 15: Eval results *****
2023-04-05 03:21:00,221 - Detection -   best_eval_score = 96.2
2023-04-05 03:21:00,221 - Detection -   eval_score = 96.2
2023-04-05 03:21:00,221 - Detection -   train_loss = 0.1899724408226498
2023-04-05 03:21:06,459 - Detection - ***** Epoch: 16: Eval results *****
2023-04-05 03:21:06,459 - Detection -   best_eval_score = 96.2
2023-04-05 03:21:06,459 - Detection -   eval_score = 96.4
2023-04-05 03:21:06,459 - Detection -   train_loss = 0.16238670190006999
2023-04-05 03:21:12,700 - Detection - ***** Epoch: 17: Eval results *****
2023-04-05 03:21:12,700 - Detection -   best_eval_score = 96.4
2023-04-05 03:21:12,701 - Detection -   eval_score = 96.27
2023-04-05 03:21:12,701 - Detection -   train_loss = 0.14544451337749675
2023-04-05 03:21:18,947 - Detection - ***** Epoch: 18: Eval results *****
2023-04-05 03:21:18,947 - Detection -   best_eval_score = 96.4
2023-04-05 03:21:18,947 - Detection -   eval_score = 96.53
2023-04-05 03:21:18,947 - Detection -   train_loss = 0.1308749612357657
2023-04-05 03:21:25,192 - Detection - ***** Epoch: 19: Eval results *****
2023-04-05 03:21:25,193 - Detection -   best_eval_score = 96.53
2023-04-05 03:21:25,193 - Detection -   eval_score = 96.33
2023-04-05 03:21:25,193 - Detection -   train_loss = 0.11911971690291065
2023-04-05 03:21:31,410 - Detection - ***** Epoch: 20: Eval results *****
2023-04-05 03:21:31,410 - Detection -   best_eval_score = 96.53
2023-04-05 03:21:31,410 - Detection -   eval_score = 96.47
2023-04-05 03:21:31,410 - Detection -   train_loss = 0.10747241355099921
2023-04-05 03:21:37,618 - Detection - ***** Epoch: 21: Eval results *****
2023-04-05 03:21:37,619 - Detection -   best_eval_score = 96.53
2023-04-05 03:21:37,619 - Detection -   eval_score = 96.6
2023-04-05 03:21:37,619 - Detection -   train_loss = 0.10027720349825035
2023-04-05 03:21:43,927 - Detection - ***** Epoch: 22: Eval results *****
2023-04-05 03:21:43,927 - Detection -   best_eval_score = 96.6
2023-04-05 03:21:43,927 - Detection -   eval_score = 96.53
2023-04-05 03:21:43,927 - Detection -   train_loss = 0.09271671231520379
2023-04-05 03:21:50,132 - Detection - ***** Epoch: 23: Eval results *****
2023-04-05 03:21:50,132 - Detection -   best_eval_score = 96.6
2023-04-05 03:21:50,132 - Detection -   eval_score = 96.6
2023-04-05 03:21:50,132 - Detection -   train_loss = 0.08510886473675906
2023-04-05 03:21:56,326 - Detection - ***** Epoch: 24: Eval results *****
2023-04-05 03:21:56,326 - Detection -   best_eval_score = 96.6
2023-04-05 03:21:56,326 - Detection -   eval_score = 96.4
2023-04-05 03:21:56,326 - Detection -   train_loss = 0.07794357937271312
2023-04-05 03:22:02,517 - Detection - ***** Epoch: 25: Eval results *****
2023-04-05 03:22:02,517 - Detection -   best_eval_score = 96.6
2023-04-05 03:22:02,517 - Detection -   eval_score = 96.67
2023-04-05 03:22:02,517 - Detection -   train_loss = 0.07100769542789055
2023-04-05 03:22:08,718 - Detection - ***** Epoch: 26: Eval results *****
2023-04-05 03:22:08,719 - Detection -   best_eval_score = 96.67
2023-04-05 03:22:08,719 - Detection -   eval_score = 96.8
2023-04-05 03:22:08,719 - Detection -   train_loss = 0.06831666473614967
2023-04-05 03:22:14,913 - Detection - ***** Epoch: 27: Eval results *****
2023-04-05 03:22:14,913 - Detection -   best_eval_score = 96.8
2023-04-05 03:22:14,913 - Detection -   eval_score = 96.73
2023-04-05 03:22:14,913 - Detection -   train_loss = 0.06349438340482065
2023-04-05 03:22:21,100 - Detection - ***** Epoch: 28: Eval results *****
2023-04-05 03:22:21,100 - Detection -   best_eval_score = 96.8
2023-04-05 03:22:21,100 - Detection -   eval_score = 96.53
2023-04-05 03:22:21,100 - Detection -   train_loss = 0.059448124304161236
2023-04-05 03:22:27,277 - Detection - ***** Epoch: 29: Eval results *****
2023-04-05 03:22:27,278 - Detection -   best_eval_score = 96.8
2023-04-05 03:22:27,278 - Detection -   eval_score = 96.67
2023-04-05 03:22:27,278 - Detection -   train_loss = 0.05529071125438658
2023-04-05 03:22:33,456 - Detection - ***** Epoch: 30: Eval results *****
2023-04-05 03:22:33,457 - Detection -   best_eval_score = 96.8
2023-04-05 03:22:33,457 - Detection -   eval_score = 96.87
2023-04-05 03:22:33,457 - Detection -   train_loss = 0.05191249422476453
2023-04-05 03:22:39,646 - Detection - ***** Epoch: 31: Eval results *****
2023-04-05 03:22:39,647 - Detection -   best_eval_score = 96.87
2023-04-05 03:22:39,647 - Detection -   eval_score = 96.8
2023-04-05 03:22:39,647 - Detection -   train_loss = 0.050993896894535776
2023-04-05 03:22:45,821 - Detection - ***** Epoch: 32: Eval results *****
2023-04-05 03:22:45,821 - Detection -   best_eval_score = 96.87
2023-04-05 03:22:45,821 - Detection -   eval_score = 96.8
2023-04-05 03:22:45,821 - Detection -   train_loss = 0.04745668337001639
2023-04-05 03:22:51,996 - Detection - ***** Epoch: 33: Eval results *****
2023-04-05 03:22:51,996 - Detection -   best_eval_score = 96.87
2023-04-05 03:22:51,996 - Detection -   eval_score = 96.8
2023-04-05 03:22:51,996 - Detection -   train_loss = 0.044827725106881836
2023-04-05 03:22:58,180 - Detection - ***** Epoch: 34: Eval results *****
2023-04-05 03:22:58,180 - Detection -   best_eval_score = 96.87
2023-04-05 03:22:58,180 - Detection -   eval_score = 97.0
2023-04-05 03:22:58,180 - Detection -   train_loss = 0.04276834630360037
2023-04-05 03:23:04,361 - Detection - ***** Epoch: 35: Eval results *****
2023-04-05 03:23:04,361 - Detection -   best_eval_score = 97.0
2023-04-05 03:23:04,361 - Detection -   eval_score = 96.87
2023-04-05 03:23:04,361 - Detection -   train_loss = 0.03982794827828973
2023-04-05 03:23:10,536 - Detection - ***** Epoch: 36: Eval results *****
2023-04-05 03:23:10,536 - Detection -   best_eval_score = 97.0
2023-04-05 03:23:10,536 - Detection -   eval_score = 96.87
2023-04-05 03:23:10,536 - Detection -   train_loss = 0.039218044539881966
2023-04-05 03:23:16,708 - Detection - ***** Epoch: 37: Eval results *****
2023-04-05 03:23:16,708 - Detection -   best_eval_score = 97.0
2023-04-05 03:23:16,708 - Detection -   eval_score = 96.8
2023-04-05 03:23:16,708 - Detection -   train_loss = 0.03765426816071494
2023-04-05 03:23:22,881 - Detection - ***** Epoch: 38: Eval results *****
2023-04-05 03:23:22,881 - Detection -   best_eval_score = 97.0
2023-04-05 03:23:22,881 - Detection -   eval_score = 97.0
2023-04-05 03:23:22,881 - Detection -   train_loss = 0.03581170488338349
2023-04-05 03:23:29,042 - Detection - ***** Epoch: 39: Eval results *****
2023-04-05 03:23:29,042 - Detection -   best_eval_score = 97.0
2023-04-05 03:23:29,042 - Detection -   eval_score = 97.07
2023-04-05 03:23:29,042 - Detection -   train_loss = 0.03329347844346095
2023-04-05 03:23:35,208 - Detection - ***** Epoch: 40: Eval results *****
2023-04-05 03:23:35,208 - Detection -   best_eval_score = 97.07
2023-04-05 03:23:35,208 - Detection -   eval_score = 97.07
2023-04-05 03:23:35,208 - Detection -   train_loss = 0.03371125794315742
2023-04-05 03:23:41,384 - Detection - ***** Epoch: 41: Eval results *****
2023-04-05 03:23:41,384 - Detection -   best_eval_score = 97.07
2023-04-05 03:23:41,384 - Detection -   eval_score = 96.87
2023-04-05 03:23:41,384 - Detection -   train_loss = 0.028658478915438813
2023-04-05 03:23:47,550 - Detection - ***** Epoch: 42: Eval results *****
2023-04-05 03:23:47,550 - Detection -   best_eval_score = 97.07
2023-04-05 03:23:47,550 - Detection -   eval_score = 96.73
2023-04-05 03:23:47,550 - Detection -   train_loss = 0.030632342874877535
2023-04-05 03:23:53,712 - Detection - ***** Epoch: 43: Eval results *****
2023-04-05 03:23:53,712 - Detection -   best_eval_score = 97.07
2023-04-05 03:23:53,713 - Detection -   eval_score = 97.07
2023-04-05 03:23:53,713 - Detection -   train_loss = 0.027917840139214264
2023-04-05 03:23:59,973 - Detection - ***** Epoch: 44: Eval results *****
2023-04-05 03:23:59,973 - Detection -   best_eval_score = 97.07
2023-04-05 03:23:59,973 - Detection -   eval_score = 97.13
2023-04-05 03:23:59,973 - Detection -   train_loss = 0.026117292659009916
2023-04-05 03:24:06,150 - Detection - ***** Epoch: 45: Eval results *****
2023-04-05 03:24:06,150 - Detection -   best_eval_score = 97.13
2023-04-05 03:24:06,150 - Detection -   eval_score = 96.93
2023-04-05 03:24:06,150 - Detection -   train_loss = 0.02611269626640162
2023-04-05 03:24:12,312 - Detection - ***** Epoch: 46: Eval results *****
2023-04-05 03:24:12,312 - Detection -   best_eval_score = 97.13
2023-04-05 03:24:12,313 - Detection -   eval_score = 97.0
2023-04-05 03:24:12,313 - Detection -   train_loss = 0.02468217656774036
2023-04-05 03:24:18,468 - Detection - ***** Epoch: 47: Eval results *****
2023-04-05 03:24:18,468 - Detection -   best_eval_score = 97.13
2023-04-05 03:24:18,468 - Detection -   eval_score = 97.0
2023-04-05 03:24:18,468 - Detection -   train_loss = 0.024667510210331214
2023-04-05 03:24:24,631 - Detection - ***** Epoch: 48: Eval results *****
2023-04-05 03:24:24,631 - Detection -   best_eval_score = 97.13
2023-04-05 03:24:24,631 - Detection -   eval_score = 97.2
2023-04-05 03:24:24,631 - Detection -   train_loss = 0.0246709590556763
2023-04-05 03:24:30,797 - Detection - ***** Epoch: 49: Eval results *****
2023-04-05 03:24:30,797 - Detection -   best_eval_score = 97.2
2023-04-05 03:24:30,797 - Detection -   eval_score = 97.0
2023-04-05 03:24:30,797 - Detection -   train_loss = 0.022261183503699506
2023-04-05 03:24:36,949 - Detection - ***** Epoch: 50: Eval results *****
2023-04-05 03:24:36,949 - Detection -   best_eval_score = 97.2
2023-04-05 03:24:36,949 - Detection -   eval_score = 96.87
2023-04-05 03:24:36,949 - Detection -   train_loss = 0.02163952795820216
2023-04-05 03:24:43,126 - Detection - ***** Epoch: 51: Eval results *****
2023-04-05 03:24:43,127 - Detection -   best_eval_score = 97.2
2023-04-05 03:24:43,127 - Detection -   eval_score = 96.87
2023-04-05 03:24:43,127 - Detection -   train_loss = 0.02029718444445881
2023-04-05 03:24:49,287 - Detection - ***** Epoch: 52: Eval results *****
2023-04-05 03:24:49,287 - Detection -   best_eval_score = 97.2
2023-04-05 03:24:49,287 - Detection -   eval_score = 97.13
2023-04-05 03:24:49,287 - Detection -   train_loss = 0.020014696328316706
2023-04-05 03:24:55,435 - Detection - ***** Epoch: 53: Eval results *****
2023-04-05 03:24:55,435 - Detection -   best_eval_score = 97.2
2023-04-05 03:24:55,435 - Detection -   eval_score = 97.13
2023-04-05 03:24:55,435 - Detection -   train_loss = 0.020213477881783147
2023-04-05 03:25:01,601 - Detection - ***** Epoch: 54: Eval results *****
2023-04-05 03:25:01,601 - Detection -   best_eval_score = 97.2
2023-04-05 03:25:01,601 - Detection -   eval_score = 97.13
2023-04-05 03:25:01,601 - Detection -   train_loss = 0.02072672893182706
2023-04-05 03:25:07,754 - Detection - ***** Epoch: 55: Eval results *****
2023-04-05 03:25:07,754 - Detection -   best_eval_score = 97.2
2023-04-05 03:25:07,754 - Detection -   eval_score = 97.13
2023-04-05 03:25:07,754 - Detection -   train_loss = 0.0204910159237304
2023-04-05 03:25:13,910 - Detection - ***** Epoch: 56: Eval results *****
2023-04-05 03:25:13,910 - Detection -   best_eval_score = 97.2
2023-04-05 03:25:13,910 - Detection -   eval_score = 97.07
2023-04-05 03:25:13,911 - Detection -   train_loss = 0.017342887881953838
2023-04-05 03:25:20,063 - Detection - ***** Epoch: 57: Eval results *****
2023-04-05 03:25:20,063 - Detection -   best_eval_score = 97.2
2023-04-05 03:25:20,063 - Detection -   eval_score = 97.07
2023-04-05 03:25:20,063 - Detection -   train_loss = 0.018368219767334097
2023-04-05 03:25:26,223 - Detection - ***** Epoch: 58: Eval results *****
2023-04-05 03:25:26,223 - Detection -   best_eval_score = 97.2
2023-04-05 03:25:26,223 - Detection -   eval_score = 97.2
2023-04-05 03:25:26,223 - Detection -   train_loss = 0.017264878708806077
2023-04-05 03:25:26,223 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_0.5_1.0_bert_9/models
2023-04-05 03:25:26,766 - Detection - Pre-training finished...
2023-04-05 03:25:26,766 - Detection - Training Begin...
2023-04-05 03:25:37,404 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 03:25:37,404 - Detection -   best_eval_score = 0
2023-04-05 03:25:37,404 - Detection -   eval_score = 0.36
2023-04-05 03:25:37,404 - Detection -   train_loss = 13.17064657049664
2023-04-05 03:25:43,483 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 03:25:43,483 - Detection -   best_eval_score = 0.36
2023-04-05 03:25:43,483 - Detection -   eval_score = 12.15
2023-04-05 03:25:43,483 - Detection -   train_loss = 10.814278360140525
2023-04-05 03:25:49,572 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 03:25:49,572 - Detection -   best_eval_score = 12.15
2023-04-05 03:25:49,572 - Detection -   eval_score = 56.67
2023-04-05 03:25:49,572 - Detection -   train_loss = 8.147906659013135
2023-04-05 03:25:55,660 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 03:25:55,660 - Detection -   best_eval_score = 56.67
2023-04-05 03:25:55,660 - Detection -   eval_score = 79.63
2023-04-05 03:25:55,661 - Detection -   train_loss = 5.613234043121338
2023-04-05 03:26:01,756 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 03:26:01,756 - Detection -   best_eval_score = 79.63
2023-04-05 03:26:01,756 - Detection -   eval_score = 90.0
2023-04-05 03:26:01,756 - Detection -   train_loss = 3.21737579976098
2023-04-05 03:26:07,845 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 03:26:07,845 - Detection -   best_eval_score = 90.0
2023-04-05 03:26:07,845 - Detection -   eval_score = 92.42
2023-04-05 03:26:07,845 - Detection -   train_loss = 1.7103394431582952
2023-04-05 03:26:13,937 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 03:26:13,937 - Detection -   best_eval_score = 92.42
2023-04-05 03:26:13,937 - Detection -   eval_score = 92.77
2023-04-05 03:26:13,937 - Detection -   train_loss = 1.4368799823825642
2023-04-05 03:26:20,039 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 03:26:20,040 - Detection -   best_eval_score = 92.77
2023-04-05 03:26:20,040 - Detection -   eval_score = 92.81
2023-04-05 03:26:20,040 - Detection -   train_loss = 1.4082466444726718
2023-04-05 03:26:26,233 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 03:26:26,233 - Detection -   best_eval_score = 92.81
2023-04-05 03:26:26,233 - Detection -   eval_score = 92.94
2023-04-05 03:26:26,233 - Detection -   train_loss = 1.4209318120600813
2023-04-05 03:26:32,332 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 03:26:32,332 - Detection -   best_eval_score = 92.94
2023-04-05 03:26:32,332 - Detection -   eval_score = 92.74
2023-04-05 03:26:32,332 - Detection -   train_loss = 1.4164626133643974
2023-04-05 03:26:38,415 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 03:26:38,415 - Detection -   best_eval_score = 92.94
2023-04-05 03:26:38,415 - Detection -   eval_score = 92.82
2023-04-05 03:26:38,415 - Detection -   train_loss = 1.4202092401051924
2023-04-05 03:26:44,508 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 03:26:44,508 - Detection -   best_eval_score = 92.94
2023-04-05 03:26:44,508 - Detection -   eval_score = 92.87
2023-04-05 03:26:44,508 - Detection -   train_loss = 1.4087258355092194
2023-04-05 03:26:50,603 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 03:26:50,603 - Detection -   best_eval_score = 92.94
2023-04-05 03:26:50,603 - Detection -   eval_score = 92.89
2023-04-05 03:26:50,603 - Detection -   train_loss = 1.426952204461825
2023-04-05 03:26:56,687 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 03:26:56,687 - Detection -   best_eval_score = 92.94
2023-04-05 03:26:56,687 - Detection -   eval_score = 92.82
2023-04-05 03:26:56,687 - Detection -   train_loss = 1.4356277191032798
2023-04-05 03:27:02,771 - Detection - ***** Epoch: 15: Eval results *****
2023-04-05 03:27:02,771 - Detection -   best_eval_score = 92.94
2023-04-05 03:27:02,771 - Detection -   eval_score = 92.82
2023-04-05 03:27:02,771 - Detection -   train_loss = 1.4228010500891735
2023-04-05 03:27:08,869 - Detection - ***** Epoch: 16: Eval results *****
2023-04-05 03:27:08,869 - Detection -   best_eval_score = 92.94
2023-04-05 03:27:08,869 - Detection -   eval_score = 92.74
2023-04-05 03:27:08,869 - Detection -   train_loss = 1.4204136658523043
2023-04-05 03:27:14,952 - Detection - ***** Epoch: 17: Eval results *****
2023-04-05 03:27:14,952 - Detection -   best_eval_score = 92.94
2023-04-05 03:27:14,952 - Detection -   eval_score = 92.78
2023-04-05 03:27:14,952 - Detection -   train_loss = 1.4381389961404316
2023-04-05 03:27:21,051 - Detection - ***** Epoch: 18: Eval results *****
2023-04-05 03:27:21,051 - Detection -   best_eval_score = 92.94
2023-04-05 03:27:21,051 - Detection -   eval_score = 92.9
2023-04-05 03:27:21,051 - Detection -   train_loss = 1.4362057124154042
2023-04-05 03:27:27,139 - Detection - ***** Epoch: 19: Eval results *****
2023-04-05 03:27:27,139 - Detection -   best_eval_score = 92.94
2023-04-05 03:27:27,139 - Detection -   eval_score = 92.94
2023-04-05 03:27:27,139 - Detection -   train_loss = 1.4235954527127541
2023-04-05 03:27:27,140 - Detection - Training Finished...
2023-04-05 03:27:27,141 - Detection - Testing begin...
2023-04-05 03:27:30,642 - Detection - ***** Test: Confusion Matrix *****
2023-04-05 03:27:30,642 - Detection - [[  29    0    0 ...    0    0    1]
 [   0   25    0 ...    0    1    4]
 [   0    0   28 ...    0    0    2]
 ...
 [   0    0    0 ...   27    0    3]
 [   0    1    0 ...    0   28    1]
 [   1    0    2 ...    2   26 2900]]
2023-04-05 03:27:30,642 - Detection - ***** Test results *****
2023-04-05 03:27:30,642 - Detection -   Acc = 86.47
2023-04-05 03:27:30,642 - Detection -   F1 = 85.4822
2023-04-05 03:27:30,642 - Detection -   F1-known = 85.4416
2023-04-05 03:27:30,642 - Detection -   F1-open = 88.5226
2023-04-05 03:27:30,642 - Detection - Testing finished...
2023-04-05 03:27:30,642 - Detection - Results saved in results/results_ADB.csv
2023-04-05 03:27:30,666 - Detection - Open Intent Detection Finished...
