2023-04-24 11:13:36,584 - Detection - Open Intent Detection Begin...
2023-04-24 11:13:36,584 - Detection - Parameters Initialization...
2023-04-24 11:13:36,585 - Detection - ============================== Params ==============================
2023-04-24 11:13:36,585 - Detection - type:	open_intent_detection
2023-04-24 11:13:36,585 - Detection - logger_name:	Detection
2023-04-24 11:13:36,585 - Detection - log_dir:	logs
2023-04-24 11:13:36,585 - Detection - dataset:	stackoverflow_cg
2023-04-24 11:13:36,585 - Detection - known_cls_ratio:	0.5
2023-04-24 11:13:36,585 - Detection - labeled_ratio:	1.0
2023-04-24 11:13:36,585 - Detection - method:	ADB
2023-04-24 11:13:36,585 - Detection - train:	True
2023-04-24 11:13:36,585 - Detection - pretrain:	True
2023-04-24 11:13:36,585 - Detection - save_model:	False
2023-04-24 11:13:36,585 - Detection - backbone:	bert_boost
2023-04-24 11:13:36,585 - Detection - config_file_name:	ADB
2023-04-24 11:13:36,585 - Detection - seed:	4
2023-04-24 11:13:36,585 - Detection - gpu_id:	0
2023-04-24 11:13:36,585 - Detection - pipe_results_path:	pipe_results
2023-04-24 11:13:36,585 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-24 11:13:36,585 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-24 11:13:36,585 - Detection - model_dir:	models
2023-04-24 11:13:36,585 - Detection - load_pretrained_method:	None
2023-04-24 11:13:36,585 - Detection - result_dir:	results
2023-04-24 11:13:36,585 - Detection - results_file_name:	results_ADB-BOOST-F-10.csv
2023-04-24 11:13:36,585 - Detection - save_results:	True
2023-04-24 11:13:36,585 - Detection - loss_fct:	CrossEntropyLoss
2023-04-24 11:13:36,585 - Detection - boost_method:	F-10
2023-04-24 11:13:36,585 - Detection - boost_start_score:	0.0
2023-04-24 11:13:36,585 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.5_1.0_bert_boost_4
2023-04-24 11:13:36,585 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.5_1.0_bert_boost_4/models
2023-04-24 11:13:36,585 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-24 11:13:36,585 - Detection - num_train_epochs:	100
2023-04-24 11:13:36,585 - Detection - num_labels:	None
2023-04-24 11:13:36,585 - Detection - max_seq_length:	None
2023-04-24 11:13:36,585 - Detection - freeze_backbone_parameters:	True
2023-04-24 11:13:36,585 - Detection - feat_dim:	768
2023-04-24 11:13:36,585 - Detection - warmup_proportion:	0.1
2023-04-24 11:13:36,585 - Detection - lr_boundary:	0.05
2023-04-24 11:13:36,585 - Detection - lr:	2e-05
2023-04-24 11:13:36,585 - Detection - activation:	relu
2023-04-24 11:13:36,585 - Detection - train_batch_size:	128
2023-04-24 11:13:36,585 - Detection - eval_batch_size:	64
2023-04-24 11:13:36,585 - Detection - test_batch_size:	64
2023-04-24 11:13:36,585 - Detection - wait_patient:	10
2023-04-24 11:13:36,585 - Detection - ============================== End Params ==============================
2023-04-24 11:13:36,585 - Detection - Data and Model Preparation...
2023-04-24 11:13:36,586 - Detection - The number of known intents is 10
2023-04-24 11:13:36,586 - Detection - Lists of known labels are: ['wordpress', 'cocoa', 'visual-studio', 'haskell', 'qt', 'drupal', 'ajax', 'svn', 'osx', 'oracle']
2023-04-24 11:13:36,595 - Detection - Number of labeled training samples = 1530
2023-04-24 11:13:36,595 - Detection - Number of unlabeled training samples = 1261
2023-04-24 11:13:36,597 - Detection - Number of evaluation samples = 693
2023-04-24 11:13:36,603 - Detection - Number of testing samples = 2905
2023-04-24 11:13:40,558 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-24 11:13:42,228 - Detection - Pre-training Begin...
2023-04-24 11:13:44,690 - Detection - ***** Epoch: 1: Eval results *****
2023-04-24 11:13:44,690 - Detection -   best_eval_score = 0
2023-04-24 11:13:44,690 - Detection -   eval_score = 11.26
2023-04-24 11:13:44,690 - Detection -   train_loss = 2.309693773587545
2023-04-24 11:14:07,270 - Detection - ***** Epoch: 2: Eval results *****
2023-04-24 11:14:07,270 - Detection -   best_eval_score = 11.26
2023-04-24 11:14:07,270 - Detection -   eval_score = 35.64
2023-04-24 11:14:07,270 - Detection -   train_loss = 2.2941895723342896
2023-04-24 11:14:29,871 - Detection - ***** Epoch: 3: Eval results *****
2023-04-24 11:14:29,872 - Detection -   best_eval_score = 35.64
2023-04-24 11:14:29,872 - Detection -   eval_score = 75.04
2023-04-24 11:14:29,872 - Detection -   train_loss = 1.9170872072378795
2023-04-24 11:14:52,496 - Detection - ***** Epoch: 4: Eval results *****
2023-04-24 11:14:52,496 - Detection -   best_eval_score = 75.04
2023-04-24 11:14:52,496 - Detection -   eval_score = 80.66
2023-04-24 11:14:52,496 - Detection -   train_loss = 1.037043382724126
2023-04-24 11:15:15,133 - Detection - ***** Epoch: 5: Eval results *****
2023-04-24 11:15:15,133 - Detection -   best_eval_score = 80.66
2023-04-24 11:15:15,133 - Detection -   eval_score = 81.1
2023-04-24 11:15:15,133 - Detection -   train_loss = 0.7274525364240011
2023-04-24 11:15:37,832 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 11:15:37,832 - Detection -   best_eval_score = 81.1
2023-04-24 11:15:37,832 - Detection -   eval_score = 82.25
2023-04-24 11:15:37,832 - Detection -   train_loss = 0.5648536359270414
2023-04-24 11:16:00,444 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 11:16:00,444 - Detection -   best_eval_score = 82.25
2023-04-24 11:16:00,444 - Detection -   eval_score = 81.67
2023-04-24 11:16:00,444 - Detection -   train_loss = 0.44885072112083435
2023-04-24 11:16:23,041 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 11:16:23,041 - Detection -   best_eval_score = 82.25
2023-04-24 11:16:23,041 - Detection -   eval_score = 80.66
2023-04-24 11:16:23,041 - Detection -   train_loss = 0.3780166208744049
2023-04-24 11:16:45,790 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 11:16:45,790 - Detection -   best_eval_score = 82.25
2023-04-24 11:16:45,790 - Detection -   eval_score = 81.39
2023-04-24 11:16:45,790 - Detection -   train_loss = 0.2796119960645835
2023-04-24 11:17:08,447 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 11:17:08,447 - Detection -   best_eval_score = 82.25
2023-04-24 11:17:08,447 - Detection -   eval_score = 80.81
2023-04-24 11:17:08,447 - Detection -   train_loss = 0.20681236560146013
2023-04-24 11:17:31,170 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 11:17:31,170 - Detection -   best_eval_score = 82.25
2023-04-24 11:17:31,170 - Detection -   eval_score = 79.51
2023-04-24 11:17:31,170 - Detection -   train_loss = 0.1724532674998045
2023-04-24 11:17:53,822 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 11:17:53,823 - Detection -   best_eval_score = 82.25
2023-04-24 11:17:53,823 - Detection -   eval_score = 79.94
2023-04-24 11:17:53,823 - Detection -   train_loss = 0.15331224538385868
2023-04-24 11:18:16,442 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 11:18:16,442 - Detection -   best_eval_score = 82.25
2023-04-24 11:18:16,442 - Detection -   eval_score = 79.94
2023-04-24 11:18:16,442 - Detection -   train_loss = 0.11923268064856529
2023-04-24 11:18:39,147 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 11:18:39,147 - Detection -   best_eval_score = 82.25
2023-04-24 11:18:39,147 - Detection -   eval_score = 79.8
2023-04-24 11:18:39,147 - Detection -   train_loss = 0.094939226595064
2023-04-24 11:19:01,718 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 11:19:01,719 - Detection -   best_eval_score = 82.25
2023-04-24 11:19:01,719 - Detection -   eval_score = 80.09
2023-04-24 11:19:01,719 - Detection -   train_loss = 0.08313161879777908
2023-04-24 11:19:24,370 - Detection - ***** Epoch: 16: Eval results *****
2023-04-24 11:19:24,370 - Detection -   best_eval_score = 82.25
2023-04-24 11:19:24,371 - Detection -   eval_score = 80.95
2023-04-24 11:19:24,371 - Detection -   train_loss = 0.07294174811492364
2023-04-24 11:19:24,371 - Detection - Pre-training finished...
2023-04-24 11:19:24,371 - Detection - Training Begin...
2023-04-24 11:19:27,684 - Detection - ***** Epoch: 1: Eval results *****
2023-04-24 11:19:27,684 - Detection -   best_eval_score = 0
2023-04-24 11:19:27,684 - Detection -   eval_score = 0.0
2023-04-24 11:19:27,684 - Detection -   train_loss = 8.080361008644104
2023-04-24 11:19:29,660 - Detection - ***** Epoch: 2: Eval results *****
2023-04-24 11:19:29,660 - Detection -   best_eval_score = 0
2023-04-24 11:19:29,660 - Detection -   eval_score = 0.0
2023-04-24 11:19:29,660 - Detection -   train_loss = 7.686862627665202
2023-04-24 11:19:31,639 - Detection - ***** Epoch: 3: Eval results *****
2023-04-24 11:19:31,639 - Detection -   best_eval_score = 0
2023-04-24 11:19:31,639 - Detection -   eval_score = 0.0
2023-04-24 11:19:31,639 - Detection -   train_loss = 7.236861944198608
2023-04-24 11:19:33,618 - Detection - ***** Epoch: 4: Eval results *****
2023-04-24 11:19:33,618 - Detection -   best_eval_score = 0
2023-04-24 11:19:33,618 - Detection -   eval_score = 0.0
2023-04-24 11:19:33,618 - Detection -   train_loss = 6.695517897605896
2023-04-24 11:19:35,598 - Detection - ***** Epoch: 5: Eval results *****
2023-04-24 11:19:35,598 - Detection -   best_eval_score = 0
2023-04-24 11:19:35,598 - Detection -   eval_score = 0.0
2023-04-24 11:19:35,598 - Detection -   train_loss = 6.104075471560161
2023-04-24 11:19:37,582 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 11:19:37,582 - Detection -   best_eval_score = 0
2023-04-24 11:19:37,582 - Detection -   eval_score = 1.07
2023-04-24 11:19:37,582 - Detection -   train_loss = 5.452210823694865
2023-04-24 11:20:00,204 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 11:20:00,204 - Detection -   best_eval_score = 1.07
2023-04-24 11:20:00,204 - Detection -   eval_score = 73.15
2023-04-24 11:20:00,204 - Detection -   train_loss = 4.780027627944946
2023-04-24 11:20:22,700 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 11:20:22,700 - Detection -   best_eval_score = 73.15
2023-04-24 11:20:22,700 - Detection -   eval_score = 73.05
2023-04-24 11:20:22,700 - Detection -   train_loss = 1.3358541627724965
2023-04-24 11:20:45,235 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 11:20:45,235 - Detection -   best_eval_score = 73.15
2023-04-24 11:20:45,236 - Detection -   eval_score = 72.84
2023-04-24 11:20:45,236 - Detection -   train_loss = 1.326669305562973
2023-04-24 11:21:07,681 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 11:21:07,682 - Detection -   best_eval_score = 73.15
2023-04-24 11:21:07,682 - Detection -   eval_score = 72.75
2023-04-24 11:21:07,682 - Detection -   train_loss = 1.3381344576676686
2023-04-24 11:21:30,222 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 11:21:30,222 - Detection -   best_eval_score = 73.15
2023-04-24 11:21:30,222 - Detection -   eval_score = 73.09
2023-04-24 11:21:30,222 - Detection -   train_loss = 1.3133112688859303
2023-04-24 11:21:52,647 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 11:21:52,647 - Detection -   best_eval_score = 73.15
2023-04-24 11:21:52,647 - Detection -   eval_score = 73.0
2023-04-24 11:21:52,647 - Detection -   train_loss = 1.2985089123249054
2023-04-24 11:22:15,232 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 11:22:15,232 - Detection -   best_eval_score = 73.15
2023-04-24 11:22:15,232 - Detection -   eval_score = 72.98
2023-04-24 11:22:15,232 - Detection -   train_loss = 1.3226576646169026
2023-04-24 11:22:37,977 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 11:22:37,977 - Detection -   best_eval_score = 73.15
2023-04-24 11:22:37,977 - Detection -   eval_score = 73.08
2023-04-24 11:22:37,977 - Detection -   train_loss = 1.3290139238039653
2023-04-24 11:23:00,460 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 11:23:00,461 - Detection -   best_eval_score = 73.15
2023-04-24 11:23:00,461 - Detection -   eval_score = 73.01
2023-04-24 11:23:00,461 - Detection -   train_loss = 1.294123609860738
2023-04-24 11:23:23,019 - Detection - ***** Epoch: 16: Eval results *****
2023-04-24 11:23:23,019 - Detection -   best_eval_score = 73.15
2023-04-24 11:23:23,019 - Detection -   eval_score = 72.94
2023-04-24 11:23:23,019 - Detection -   train_loss = 1.3069260319073994
2023-04-24 11:23:45,491 - Detection - ***** Epoch: 17: Eval results *****
2023-04-24 11:23:45,491 - Detection -   best_eval_score = 73.15
2023-04-24 11:23:45,491 - Detection -   eval_score = 73.24
2023-04-24 11:23:45,491 - Detection -   train_loss = 1.313357760508855
2023-04-24 11:24:08,160 - Detection - ***** Epoch: 18: Eval results *****
2023-04-24 11:24:08,161 - Detection -   best_eval_score = 73.24
2023-04-24 11:24:08,161 - Detection -   eval_score = 72.68
2023-04-24 11:24:08,161 - Detection -   train_loss = 1.341488907734553
2023-04-24 11:24:30,745 - Detection - ***** Epoch: 19: Eval results *****
2023-04-24 11:24:30,745 - Detection -   best_eval_score = 73.24
2023-04-24 11:24:30,745 - Detection -   eval_score = 73.03
2023-04-24 11:24:30,745 - Detection -   train_loss = 1.2931768000125885
2023-04-24 11:24:53,261 - Detection - ***** Epoch: 20: Eval results *****
2023-04-24 11:24:53,261 - Detection -   best_eval_score = 73.24
2023-04-24 11:24:53,261 - Detection -   eval_score = 73.19
2023-04-24 11:24:53,261 - Detection -   train_loss = 1.2899941106637318
2023-04-24 11:25:15,886 - Detection - ***** Epoch: 21: Eval results *****
2023-04-24 11:25:15,886 - Detection -   best_eval_score = 73.24
2023-04-24 11:25:15,886 - Detection -   eval_score = 73.31
2023-04-24 11:25:15,886 - Detection -   train_loss = 1.3181813557942708
2023-04-24 11:25:38,319 - Detection - ***** Epoch: 22: Eval results *****
2023-04-24 11:25:38,319 - Detection -   best_eval_score = 73.31
2023-04-24 11:25:38,319 - Detection -   eval_score = 72.88
2023-04-24 11:25:38,319 - Detection -   train_loss = 1.36103093624115
2023-04-24 11:26:00,981 - Detection - ***** Epoch: 23: Eval results *****
2023-04-24 11:26:00,982 - Detection -   best_eval_score = 73.31
2023-04-24 11:26:00,982 - Detection -   eval_score = 73.16
2023-04-24 11:26:00,982 - Detection -   train_loss = 1.304490566253662
2023-04-24 11:26:23,607 - Detection - ***** Epoch: 24: Eval results *****
2023-04-24 11:26:23,608 - Detection -   best_eval_score = 73.31
2023-04-24 11:26:23,608 - Detection -   eval_score = 72.7
2023-04-24 11:26:23,608 - Detection -   train_loss = 1.2986920773983002
2023-04-24 11:26:46,008 - Detection - ***** Epoch: 25: Eval results *****
2023-04-24 11:26:46,008 - Detection -   best_eval_score = 73.31
2023-04-24 11:26:46,008 - Detection -   eval_score = 73.25
2023-04-24 11:26:46,008 - Detection -   train_loss = 1.3323666155338287
2023-04-24 11:27:08,563 - Detection - ***** Epoch: 26: Eval results *****
2023-04-24 11:27:08,564 - Detection -   best_eval_score = 73.31
2023-04-24 11:27:08,564 - Detection -   eval_score = 72.83
2023-04-24 11:27:08,564 - Detection -   train_loss = 1.3267677128314972
2023-04-24 11:27:30,933 - Detection - ***** Epoch: 27: Eval results *****
2023-04-24 11:27:30,933 - Detection -   best_eval_score = 73.31
2023-04-24 11:27:30,933 - Detection -   eval_score = 73.14
2023-04-24 11:27:30,933 - Detection -   train_loss = 1.3087740341822307
2023-04-24 11:27:53,602 - Detection - ***** Epoch: 28: Eval results *****
2023-04-24 11:27:53,602 - Detection -   best_eval_score = 73.31
2023-04-24 11:27:53,602 - Detection -   eval_score = 73.27
2023-04-24 11:27:53,602 - Detection -   train_loss = 1.3245450556278229
2023-04-24 11:28:16,173 - Detection - ***** Epoch: 29: Eval results *****
2023-04-24 11:28:16,173 - Detection -   best_eval_score = 73.31
2023-04-24 11:28:16,173 - Detection -   eval_score = 72.8
2023-04-24 11:28:16,173 - Detection -   train_loss = 1.3280206720034282
2023-04-24 11:28:38,565 - Detection - ***** Epoch: 30: Eval results *****
2023-04-24 11:28:38,565 - Detection -   best_eval_score = 73.31
2023-04-24 11:28:38,565 - Detection -   eval_score = 73.0
2023-04-24 11:28:38,565 - Detection -   train_loss = 1.326162427663803
2023-04-24 11:29:01,131 - Detection - ***** Epoch: 31: Eval results *****
2023-04-24 11:29:01,131 - Detection -   best_eval_score = 73.31
2023-04-24 11:29:01,131 - Detection -   eval_score = 73.07
2023-04-24 11:29:01,131 - Detection -   train_loss = 1.3217086493968964
2023-04-24 11:29:01,131 - Detection - Training Finished...
2023-04-24 11:29:01,132 - Detection - Testing begin...
2023-04-24 11:29:03,529 - Detection - ***** Test: Confusion Matrix *****
2023-04-24 11:29:03,529 - Detection - [[107   0   0   2   0   2   1   0   0   0  25]
 [  0  89   1   3   2   2   0   0  25   1  38]
 [  0   3  47   0   0   0   3   1   4   2  46]
 [  0   0   1  92   0   0   0   0   4   0  25]
 [  0   1   0   2 152   0   0   0   2   0  15]
 [  0   0   0   1   0  97   1   0   0   1  28]
 [  1   1   0   0   0   0 119   0   3   0  36]
 [  0   2   2   1   0   0   0 112   3   0  29]
 [  0  27   3   1   2   1   0   1 128   1  29]
 [  0   1   0   2   0   1   1   0   1  97  24]
 [  4  55  25 160   1  36  90   9 110  43 917]]
2023-04-24 11:29:03,529 - Detection - ***** Test results *****
2023-04-24 11:29:03,529 - Detection -   Acc = 67.37
2023-04-24 11:29:03,529 - Detection -   F1 = 67.4543
2023-04-24 11:29:03,529 - Detection -   F1-known = 67.3102
2023-04-24 11:29:03,529 - Detection -   F1-open = 68.8956
2023-04-24 11:29:03,529 - Detection - Testing finished...
2023-04-24 11:29:03,529 - Detection - Results saved in results/results_ADB-BOOST-F-10.csv
2023-04-24 11:29:03,548 - Detection - Open Intent Detection Finished...
