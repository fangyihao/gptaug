2023-04-20 00:11:28,485 - Detection - Open Intent Detection Begin...
2023-04-20 00:11:28,485 - Detection - Parameters Initialization...
2023-04-20 00:11:28,486 - Detection - ============================== Params ==============================
2023-04-20 00:11:28,486 - Detection - type:	open_intent_detection
2023-04-20 00:11:28,486 - Detection - logger_name:	Detection
2023-04-20 00:11:28,486 - Detection - log_dir:	logs
2023-04-20 00:11:28,486 - Detection - dataset:	stackoverflow_cg
2023-04-20 00:11:28,486 - Detection - known_cls_ratio:	0.25
2023-04-20 00:11:28,486 - Detection - labeled_ratio:	1.0
2023-04-20 00:11:28,486 - Detection - method:	DA-ADB
2023-04-20 00:11:28,486 - Detection - train:	True
2023-04-20 00:11:28,486 - Detection - pretrain:	True
2023-04-20 00:11:28,486 - Detection - save_model:	True
2023-04-20 00:11:28,486 - Detection - backbone:	bert_disaware
2023-04-20 00:11:28,486 - Detection - config_file_name:	DA-ADB
2023-04-20 00:11:28,486 - Detection - seed:	7
2023-04-20 00:11:28,486 - Detection - gpu_id:	0
2023-04-20 00:11:28,486 - Detection - pipe_results_path:	pipe_results
2023-04-20 00:11:28,486 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-20 00:11:28,486 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-20 00:11:28,486 - Detection - model_dir:	models
2023-04-20 00:11:28,486 - Detection - load_pretrained_method:	None
2023-04-20 00:11:28,486 - Detection - result_dir:	results
2023-04-20 00:11:28,486 - Detection - results_file_name:	results_DA-ADB.csv
2023-04-20 00:11:28,486 - Detection - save_results:	True
2023-04-20 00:11:28,486 - Detection - loss_fct:	CrossEntropyLoss
2023-04-20 00:11:28,486 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.25_1.0_bert_disaware_7
2023-04-20 00:11:28,486 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.25_1.0_bert_disaware_7/models
2023-04-20 00:11:28,486 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-20 00:11:28,486 - Detection - num_train_epochs:	100
2023-04-20 00:11:28,486 - Detection - num_labels:	None
2023-04-20 00:11:28,486 - Detection - max_seq_length:	None
2023-04-20 00:11:28,486 - Detection - freeze_backbone_parameters:	True
2023-04-20 00:11:28,486 - Detection - feat_dim:	768
2023-04-20 00:11:28,486 - Detection - warmup_proportion:	0.1
2023-04-20 00:11:28,486 - Detection - scale:	4
2023-04-20 00:11:28,486 - Detection - lr_boundary:	0.05
2023-04-20 00:11:28,486 - Detection - lr:	2e-05
2023-04-20 00:11:28,486 - Detection - activation:	relu
2023-04-20 00:11:28,486 - Detection - train_batch_size:	128
2023-04-20 00:11:28,486 - Detection - eval_batch_size:	64
2023-04-20 00:11:28,486 - Detection - test_batch_size:	64
2023-04-20 00:11:28,486 - Detection - wait_patient:	10
2023-04-20 00:11:28,486 - Detection - ============================== End Params ==============================
2023-04-20 00:11:28,486 - Detection - Data and Model Preparation...
2023-04-20 00:11:28,487 - Detection - The number of known intents is 5
2023-04-20 00:11:28,487 - Detection - Lists of known labels are: ['apache', 'svn', 'bash', 'excel', 'oracle']
2023-04-20 00:11:28,505 - Detection - Number of labeled training samples = 1956
2023-04-20 00:11:28,505 - Detection - Number of unlabeled training samples = 5861
2023-04-20 00:11:28,509 - Detection - Number of evaluation samples = 476
2023-04-20 00:11:28,518 - Detection - Number of testing samples = 5082
2023-04-20 00:11:35,457 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-20 00:11:35,541 - Detection - Pre-training Begin...
2023-04-20 00:11:39,793 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 00:11:39,793 - Detection -   best_eval_score = 0
2023-04-20 00:11:39,793 - Detection -   eval_score = 8.49
2023-04-20 00:11:39,793 - Detection -   train_loss = 1.6114275380969048
2023-04-20 00:11:43,565 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 00:11:43,565 - Detection -   best_eval_score = 8.49
2023-04-20 00:11:43,565 - Detection -   eval_score = 16.02
2023-04-20 00:11:43,565 - Detection -   train_loss = 1.5993793457746506
2023-04-20 00:11:47,339 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 00:11:47,339 - Detection -   best_eval_score = 16.02
2023-04-20 00:11:47,339 - Detection -   eval_score = 25.63
2023-04-20 00:11:47,339 - Detection -   train_loss = 1.5868837386369705
2023-04-20 00:11:51,118 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 00:11:51,118 - Detection -   best_eval_score = 25.63
2023-04-20 00:11:51,118 - Detection -   eval_score = 55.43
2023-04-20 00:11:51,118 - Detection -   train_loss = 1.5529173836112022
2023-04-20 00:11:54,904 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 00:11:54,904 - Detection -   best_eval_score = 55.43
2023-04-20 00:11:54,904 - Detection -   eval_score = 63.07
2023-04-20 00:11:54,904 - Detection -   train_loss = 1.4646670892834663
2023-04-20 00:11:58,700 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 00:11:58,700 - Detection -   best_eval_score = 63.07
2023-04-20 00:11:58,700 - Detection -   eval_score = 81.27
2023-04-20 00:11:58,700 - Detection -   train_loss = 1.229676365852356
2023-04-20 00:12:02,509 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 00:12:02,509 - Detection -   best_eval_score = 81.27
2023-04-20 00:12:02,509 - Detection -   eval_score = 86.28
2023-04-20 00:12:02,509 - Detection -   train_loss = 0.8970848619937897
2023-04-20 00:12:06,319 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 00:12:06,319 - Detection -   best_eval_score = 86.28
2023-04-20 00:12:06,319 - Detection -   eval_score = 90.62
2023-04-20 00:12:06,319 - Detection -   train_loss = 0.6440060045570135
2023-04-20 00:12:10,135 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 00:12:10,135 - Detection -   best_eval_score = 90.62
2023-04-20 00:12:10,135 - Detection -   eval_score = 91.25
2023-04-20 00:12:10,135 - Detection -   train_loss = 0.5309953782707453
2023-04-20 00:12:13,954 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 00:12:13,954 - Detection -   best_eval_score = 91.25
2023-04-20 00:12:13,954 - Detection -   eval_score = 91.02
2023-04-20 00:12:13,954 - Detection -   train_loss = 0.4742634706199169
2023-04-20 00:12:17,763 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 00:12:17,763 - Detection -   best_eval_score = 91.25
2023-04-20 00:12:17,763 - Detection -   eval_score = 91.47
2023-04-20 00:12:17,763 - Detection -   train_loss = 0.431139899417758
2023-04-20 00:12:21,591 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 00:12:21,591 - Detection -   best_eval_score = 91.47
2023-04-20 00:12:21,591 - Detection -   eval_score = 92.68
2023-04-20 00:12:21,591 - Detection -   train_loss = 0.39757003262639046
2023-04-20 00:12:25,427 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 00:12:25,427 - Detection -   best_eval_score = 92.68
2023-04-20 00:12:25,427 - Detection -   eval_score = 91.47
2023-04-20 00:12:25,427 - Detection -   train_loss = 0.3736696783453226
2023-04-20 00:12:29,257 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 00:12:29,257 - Detection -   best_eval_score = 92.68
2023-04-20 00:12:29,257 - Detection -   eval_score = 92.02
2023-04-20 00:12:29,257 - Detection -   train_loss = 0.34338441863656044
2023-04-20 00:12:33,086 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 00:12:33,087 - Detection -   best_eval_score = 92.68
2023-04-20 00:12:33,087 - Detection -   eval_score = 92.27
2023-04-20 00:12:33,087 - Detection -   train_loss = 0.3356828782707453
2023-04-20 00:12:36,919 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 00:12:36,919 - Detection -   best_eval_score = 92.68
2023-04-20 00:12:36,919 - Detection -   eval_score = 91.61
2023-04-20 00:12:36,919 - Detection -   train_loss = 0.3005068898200989
2023-04-20 00:12:40,749 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 00:12:40,749 - Detection -   best_eval_score = 92.68
2023-04-20 00:12:40,749 - Detection -   eval_score = 92.45
2023-04-20 00:12:40,749 - Detection -   train_loss = 0.29372360464185476
2023-04-20 00:12:44,579 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 00:12:44,579 - Detection -   best_eval_score = 92.68
2023-04-20 00:12:44,579 - Detection -   eval_score = 92.28
2023-04-20 00:12:44,579 - Detection -   train_loss = 0.2904120199382305
2023-04-20 00:12:48,406 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 00:12:48,406 - Detection -   best_eval_score = 92.68
2023-04-20 00:12:48,406 - Detection -   eval_score = 91.88
2023-04-20 00:12:48,406 - Detection -   train_loss = 0.2717895498499274
2023-04-20 00:12:52,335 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 00:12:52,335 - Detection -   best_eval_score = 92.68
2023-04-20 00:12:52,335 - Detection -   eval_score = 92.67
2023-04-20 00:12:52,335 - Detection -   train_loss = 0.2492836145684123
2023-04-20 00:12:56,155 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 00:12:56,155 - Detection -   best_eval_score = 92.68
2023-04-20 00:12:56,155 - Detection -   eval_score = 92.48
2023-04-20 00:12:56,155 - Detection -   train_loss = 0.24049645941704512
2023-04-20 00:12:59,974 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 00:12:59,974 - Detection -   best_eval_score = 92.68
2023-04-20 00:12:59,974 - Detection -   eval_score = 92.46
2023-04-20 00:12:59,974 - Detection -   train_loss = 0.24300228524953127
2023-04-20 00:12:59,975 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.25_1.0_bert_disaware_7/models
2023-04-20 00:13:00,526 - Detection - Pre-training finished...
2023-04-20 00:13:00,527 - Detection - Training Begin...
2023-04-20 00:13:02,730 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 00:13:02,730 - Detection -   best_eval_score = 0
2023-04-20 00:13:02,730 - Detection -   eval_score = 0.0
2023-04-20 00:13:02,730 - Detection -   train_loss = 4.111925855278969
2023-04-20 00:13:04,936 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 00:13:04,936 - Detection -   best_eval_score = 0
2023-04-20 00:13:04,936 - Detection -   eval_score = 0.0
2023-04-20 00:13:04,936 - Detection -   train_loss = 3.723433032631874
2023-04-20 00:13:07,140 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 00:13:07,140 - Detection -   best_eval_score = 0
2023-04-20 00:13:07,140 - Detection -   eval_score = 0.69
2023-04-20 00:13:07,141 - Detection -   train_loss = 3.114414393901825
2023-04-20 00:13:09,347 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 00:13:09,348 - Detection -   best_eval_score = 0.69
2023-04-20 00:13:09,348 - Detection -   eval_score = 27.58
2023-04-20 00:13:09,348 - Detection -   train_loss = 2.2903774604201317
2023-04-20 00:13:11,552 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 00:13:11,552 - Detection -   best_eval_score = 27.58
2023-04-20 00:13:11,552 - Detection -   eval_score = 67.63
2023-04-20 00:13:11,552 - Detection -   train_loss = 1.3617089036852121
2023-04-20 00:13:13,757 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 00:13:13,757 - Detection -   best_eval_score = 67.63
2023-04-20 00:13:13,757 - Detection -   eval_score = 74.17
2023-04-20 00:13:13,757 - Detection -   train_loss = 0.9076672531664371
2023-04-20 00:13:15,960 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 00:13:15,960 - Detection -   best_eval_score = 74.17
2023-04-20 00:13:15,960 - Detection -   eval_score = 74.28
2023-04-20 00:13:15,960 - Detection -   train_loss = 0.8988189809024334
2023-04-20 00:13:18,164 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 00:13:18,164 - Detection -   best_eval_score = 74.28
2023-04-20 00:13:18,164 - Detection -   eval_score = 73.96
2023-04-20 00:13:18,164 - Detection -   train_loss = 0.8874373733997345
2023-04-20 00:13:20,370 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 00:13:20,370 - Detection -   best_eval_score = 74.28
2023-04-20 00:13:20,370 - Detection -   eval_score = 73.96
2023-04-20 00:13:20,370 - Detection -   train_loss = 0.8605675268918276
2023-04-20 00:13:22,574 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 00:13:22,574 - Detection -   best_eval_score = 74.28
2023-04-20 00:13:22,574 - Detection -   eval_score = 73.96
2023-04-20 00:13:22,574 - Detection -   train_loss = 0.878018531948328
2023-04-20 00:13:24,778 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 00:13:24,778 - Detection -   best_eval_score = 74.28
2023-04-20 00:13:24,778 - Detection -   eval_score = 73.85
2023-04-20 00:13:24,778 - Detection -   train_loss = 0.8861272409558296
2023-04-20 00:13:26,983 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 00:13:26,983 - Detection -   best_eval_score = 74.28
2023-04-20 00:13:26,983 - Detection -   eval_score = 73.85
2023-04-20 00:13:26,983 - Detection -   train_loss = 0.9015246033668518
2023-04-20 00:13:29,187 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 00:13:29,187 - Detection -   best_eval_score = 74.28
2023-04-20 00:13:29,187 - Detection -   eval_score = 73.96
2023-04-20 00:13:29,187 - Detection -   train_loss = 0.8964740373194218
2023-04-20 00:13:31,392 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 00:13:31,392 - Detection -   best_eval_score = 74.28
2023-04-20 00:13:31,392 - Detection -   eval_score = 73.96
2023-04-20 00:13:31,392 - Detection -   train_loss = 0.9084973074495792
2023-04-20 00:13:33,597 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 00:13:33,597 - Detection -   best_eval_score = 74.28
2023-04-20 00:13:33,597 - Detection -   eval_score = 73.96
2023-04-20 00:13:33,597 - Detection -   train_loss = 0.8762348778545856
2023-04-20 00:13:35,801 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 00:13:35,801 - Detection -   best_eval_score = 74.28
2023-04-20 00:13:35,801 - Detection -   eval_score = 73.85
2023-04-20 00:13:35,801 - Detection -   train_loss = 0.872443500906229
2023-04-20 00:13:38,005 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 00:13:38,006 - Detection -   best_eval_score = 74.28
2023-04-20 00:13:38,006 - Detection -   eval_score = 74.06
2023-04-20 00:13:38,006 - Detection -   train_loss = 0.8751338981091976
2023-04-20 00:13:38,007 - Detection - Training Finished...
2023-04-20 00:13:38,007 - Detection - Testing begin...
2023-04-20 00:13:42,233 - Detection - ***** Test: Confusion Matrix *****
2023-04-20 00:13:42,233 - Detection - [[ 185    1    0    0    0   59]
 [   3  224    0    0    0   46]
 [   3    0  181    0    0   72]
 [   1    0    0  174    0   56]
 [   0    0    1    1  217   44]
 [ 222   11   27   10   96 3448]]
2023-04-20 00:13:42,234 - Detection - ***** Test results *****
2023-04-20 00:13:42,234 - Detection -   Acc = 87.15
2023-04-20 00:13:42,234 - Detection -   F1 = 78.7472
2023-04-20 00:13:42,234 - Detection -   F1-known = 76.2024
2023-04-20 00:13:42,234 - Detection -   F1-open = 91.471
2023-04-20 00:13:42,234 - Detection - Testing finished...
2023-04-20 00:13:42,234 - Detection - Results saved in results/results_DA-ADB.csv
2023-04-20 00:13:42,253 - Detection - Open Intent Detection Finished...
