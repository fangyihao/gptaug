2023-04-23 21:58:51,007 - Detection - Open Intent Detection Begin...
2023-04-23 21:58:51,007 - Detection - Parameters Initialization...
2023-04-23 21:58:51,007 - Detection - ============================== Params ==============================
2023-04-23 21:58:51,007 - Detection - type:	open_intent_detection
2023-04-23 21:58:51,007 - Detection - logger_name:	Detection
2023-04-23 21:58:51,007 - Detection - log_dir:	logs
2023-04-23 21:58:51,007 - Detection - dataset:	stackoverflow_cg
2023-04-23 21:58:51,007 - Detection - known_cls_ratio:	0.25
2023-04-23 21:58:51,007 - Detection - labeled_ratio:	1.0
2023-04-23 21:58:51,007 - Detection - method:	ADB
2023-04-23 21:58:51,007 - Detection - train:	True
2023-04-23 21:58:51,007 - Detection - pretrain:	True
2023-04-23 21:58:51,007 - Detection - save_model:	False
2023-04-23 21:58:51,007 - Detection - backbone:	bert_boost
2023-04-23 21:58:51,007 - Detection - config_file_name:	ADB
2023-04-23 21:58:51,007 - Detection - seed:	9
2023-04-23 21:58:51,007 - Detection - gpu_id:	0
2023-04-23 21:58:51,007 - Detection - pipe_results_path:	pipe_results
2023-04-23 21:58:51,007 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-23 21:58:51,007 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-23 21:58:51,007 - Detection - model_dir:	models
2023-04-23 21:58:51,007 - Detection - load_pretrained_method:	None
2023-04-23 21:58:51,007 - Detection - result_dir:	results
2023-04-23 21:58:51,007 - Detection - results_file_name:	results_ADB-BOOST-F-4.csv
2023-04-23 21:58:51,007 - Detection - save_results:	True
2023-04-23 21:58:51,007 - Detection - loss_fct:	CrossEntropyLoss
2023-04-23 21:58:51,007 - Detection - boost_method:	F-4
2023-04-23 21:58:51,007 - Detection - boost_start_score:	0.0
2023-04-23 21:58:51,007 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.25_1.0_bert_boost_9
2023-04-23 21:58:51,007 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.25_1.0_bert_boost_9/models
2023-04-23 21:58:51,007 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-23 21:58:51,007 - Detection - num_train_epochs:	100
2023-04-23 21:58:51,007 - Detection - num_labels:	None
2023-04-23 21:58:51,007 - Detection - max_seq_length:	None
2023-04-23 21:58:51,008 - Detection - freeze_backbone_parameters:	True
2023-04-23 21:58:51,008 - Detection - feat_dim:	768
2023-04-23 21:58:51,008 - Detection - warmup_proportion:	0.1
2023-04-23 21:58:51,008 - Detection - lr_boundary:	0.05
2023-04-23 21:58:51,008 - Detection - lr:	2e-05
2023-04-23 21:58:51,008 - Detection - activation:	relu
2023-04-23 21:58:51,008 - Detection - train_batch_size:	128
2023-04-23 21:58:51,008 - Detection - eval_batch_size:	64
2023-04-23 21:58:51,008 - Detection - test_batch_size:	64
2023-04-23 21:58:51,008 - Detection - wait_patient:	10
2023-04-23 21:58:51,008 - Detection - ============================== End Params ==============================
2023-04-23 21:58:51,008 - Detection - Data and Model Preparation...
2023-04-23 21:58:51,008 - Detection - The number of known intents is 5
2023-04-23 21:58:51,008 - Detection - Lists of known labels are: ['cocoa', 'haskell', 'hibernate', 'excel', 'spring']
2023-04-23 21:58:51,017 - Detection - Number of labeled training samples = 749
2023-04-23 21:58:51,017 - Detection - Number of unlabeled training samples = 2042
2023-04-23 21:58:51,020 - Detection - Number of evaluation samples = 342
2023-04-23 21:58:51,026 - Detection - Number of testing samples = 2905
2023-04-23 21:58:54,913 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-23 21:58:56,618 - Detection - Pre-training Begin...
2023-04-23 21:58:58,072 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 21:58:58,072 - Detection -   best_eval_score = 0
2023-04-23 21:58:58,072 - Detection -   eval_score = 19.59
2023-04-23 21:58:58,072 - Detection -   train_loss = 1.60202556848526
2023-04-23 21:59:02,549 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 21:59:02,549 - Detection -   best_eval_score = 19.59
2023-04-23 21:59:02,549 - Detection -   eval_score = 19.3
2023-04-23 21:59:02,550 - Detection -   train_loss = 1.5885412295659382
2023-04-23 21:59:07,128 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 21:59:07,128 - Detection -   best_eval_score = 19.59
2023-04-23 21:59:07,129 - Detection -   eval_score = 52.34
2023-04-23 21:59:07,129 - Detection -   train_loss = 1.4905939102172852
2023-04-23 21:59:11,671 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 21:59:11,671 - Detection -   best_eval_score = 52.34
2023-04-23 21:59:11,671 - Detection -   eval_score = 67.84
2023-04-23 21:59:11,672 - Detection -   train_loss = 1.3118442098299663
2023-04-23 21:59:16,403 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 21:59:16,403 - Detection -   best_eval_score = 67.84
2023-04-23 21:59:16,403 - Detection -   eval_score = 81.58
2023-04-23 21:59:16,403 - Detection -   train_loss = 0.8934763868649801
2023-04-23 21:59:20,861 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 21:59:20,862 - Detection -   best_eval_score = 81.58
2023-04-23 21:59:20,862 - Detection -   eval_score = 84.21
2023-04-23 21:59:20,862 - Detection -   train_loss = 0.544053390622139
2023-04-23 21:59:25,428 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 21:59:25,429 - Detection -   best_eval_score = 84.21
2023-04-23 21:59:25,429 - Detection -   eval_score = 85.67
2023-04-23 21:59:25,429 - Detection -   train_loss = 0.4146779477596283
2023-04-23 21:59:29,905 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 21:59:29,905 - Detection -   best_eval_score = 85.67
2023-04-23 21:59:29,905 - Detection -   eval_score = 85.38
2023-04-23 21:59:29,905 - Detection -   train_loss = 0.3130248536666234
2023-04-23 21:59:34,407 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 21:59:34,407 - Detection -   best_eval_score = 85.67
2023-04-23 21:59:34,407 - Detection -   eval_score = 85.38
2023-04-23 21:59:34,407 - Detection -   train_loss = 0.23818547775348028
2023-04-23 21:59:39,002 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 21:59:39,002 - Detection -   best_eval_score = 85.67
2023-04-23 21:59:39,002 - Detection -   eval_score = 84.8
2023-04-23 21:59:39,002 - Detection -   train_loss = 0.18800937136014303
2023-04-23 21:59:43,465 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 21:59:43,466 - Detection -   best_eval_score = 85.67
2023-04-23 21:59:43,466 - Detection -   eval_score = 87.13
2023-04-23 21:59:43,466 - Detection -   train_loss = 0.1470398729046186
2023-04-23 21:59:47,936 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 21:59:47,936 - Detection -   best_eval_score = 87.13
2023-04-23 21:59:47,936 - Detection -   eval_score = 86.26
2023-04-23 21:59:47,936 - Detection -   train_loss = 0.11149183412392934
2023-04-23 21:59:52,406 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 21:59:52,407 - Detection -   best_eval_score = 87.13
2023-04-23 21:59:52,407 - Detection -   eval_score = 86.26
2023-04-23 21:59:52,407 - Detection -   train_loss = 0.10424750794967015
2023-04-23 21:59:56,872 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 21:59:56,872 - Detection -   best_eval_score = 87.13
2023-04-23 21:59:56,872 - Detection -   eval_score = 86.26
2023-04-23 21:59:56,872 - Detection -   train_loss = 0.09217008575797081
2023-04-23 22:00:01,503 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 22:00:01,504 - Detection -   best_eval_score = 87.13
2023-04-23 22:00:01,504 - Detection -   eval_score = 86.84
2023-04-23 22:00:01,504 - Detection -   train_loss = 0.06437049681941669
2023-04-23 22:00:05,965 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 22:00:05,965 - Detection -   best_eval_score = 87.13
2023-04-23 22:00:05,965 - Detection -   eval_score = 87.13
2023-04-23 22:00:05,966 - Detection -   train_loss = 0.05869488542278608
2023-04-23 22:00:10,478 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 22:00:10,478 - Detection -   best_eval_score = 87.13
2023-04-23 22:00:10,478 - Detection -   eval_score = 86.55
2023-04-23 22:00:10,478 - Detection -   train_loss = 0.04620704551537832
2023-04-23 22:00:14,991 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 22:00:14,992 - Detection -   best_eval_score = 87.13
2023-04-23 22:00:14,992 - Detection -   eval_score = 87.72
2023-04-23 22:00:14,992 - Detection -   train_loss = 0.041167769891520344
2023-04-23 22:00:19,467 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 22:00:19,467 - Detection -   best_eval_score = 87.72
2023-04-23 22:00:19,467 - Detection -   eval_score = 86.55
2023-04-23 22:00:19,467 - Detection -   train_loss = 0.02753219784547885
2023-04-23 22:00:24,086 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 22:00:24,086 - Detection -   best_eval_score = 87.72
2023-04-23 22:00:24,086 - Detection -   eval_score = 86.55
2023-04-23 22:00:24,086 - Detection -   train_loss = 0.035821717232465744
2023-04-23 22:00:28,584 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 22:00:28,584 - Detection -   best_eval_score = 87.72
2023-04-23 22:00:28,584 - Detection -   eval_score = 85.96
2023-04-23 22:00:28,584 - Detection -   train_loss = 0.03399844281375408
2023-04-23 22:00:33,124 - Detection - ***** Epoch: 22: Eval results *****
2023-04-23 22:00:33,124 - Detection -   best_eval_score = 87.72
2023-04-23 22:00:33,125 - Detection -   eval_score = 87.72
2023-04-23 22:00:33,125 - Detection -   train_loss = 0.0248324042186141
2023-04-23 22:00:37,638 - Detection - ***** Epoch: 23: Eval results *****
2023-04-23 22:00:37,638 - Detection -   best_eval_score = 87.72
2023-04-23 22:00:37,638 - Detection -   eval_score = 87.72
2023-04-23 22:00:37,638 - Detection -   train_loss = 0.029623142754038174
2023-04-23 22:00:42,155 - Detection - ***** Epoch: 24: Eval results *****
2023-04-23 22:00:42,155 - Detection -   best_eval_score = 87.72
2023-04-23 22:00:42,155 - Detection -   eval_score = 87.43
2023-04-23 22:00:42,155 - Detection -   train_loss = 0.01766891498118639
2023-04-23 22:00:46,742 - Detection - ***** Epoch: 25: Eval results *****
2023-04-23 22:00:46,742 - Detection -   best_eval_score = 87.72
2023-04-23 22:00:46,742 - Detection -   eval_score = 86.84
2023-04-23 22:00:46,742 - Detection -   train_loss = 0.021766057703644037
2023-04-23 22:00:51,220 - Detection - ***** Epoch: 26: Eval results *****
2023-04-23 22:00:51,220 - Detection -   best_eval_score = 87.72
2023-04-23 22:00:51,220 - Detection -   eval_score = 87.13
2023-04-23 22:00:51,220 - Detection -   train_loss = 0.019144299284865458
2023-04-23 22:00:55,669 - Detection - ***** Epoch: 27: Eval results *****
2023-04-23 22:00:55,669 - Detection -   best_eval_score = 87.72
2023-04-23 22:00:55,669 - Detection -   eval_score = 85.67
2023-04-23 22:00:55,669 - Detection -   train_loss = 0.01958961458876729
2023-04-23 22:01:00,132 - Detection - ***** Epoch: 28: Eval results *****
2023-04-23 22:01:00,133 - Detection -   best_eval_score = 87.72
2023-04-23 22:01:00,133 - Detection -   eval_score = 87.13
2023-04-23 22:01:00,133 - Detection -   train_loss = 0.02111150308822592
2023-04-23 22:01:00,133 - Detection - Pre-training finished...
2023-04-23 22:01:00,133 - Detection - Training Begin...
2023-04-23 22:01:01,294 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 22:01:01,294 - Detection -   best_eval_score = 0
2023-04-23 22:01:01,294 - Detection -   eval_score = 0.0
2023-04-23 22:01:01,295 - Detection -   train_loss = 8.539401849110922
2023-04-23 22:01:02,007 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 22:01:02,007 - Detection -   best_eval_score = 0
2023-04-23 22:01:02,007 - Detection -   eval_score = 0.0
2023-04-23 22:01:02,007 - Detection -   train_loss = 8.346246242523193
2023-04-23 22:01:02,718 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 22:01:02,719 - Detection -   best_eval_score = 0
2023-04-23 22:01:02,719 - Detection -   eval_score = 0.0
2023-04-23 22:01:02,719 - Detection -   train_loss = 8.1096830368042
2023-04-23 22:01:03,430 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 22:01:03,431 - Detection -   best_eval_score = 0
2023-04-23 22:01:03,431 - Detection -   eval_score = 0.0
2023-04-23 22:01:03,431 - Detection -   train_loss = 7.954857349395752
2023-04-23 22:01:04,143 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 22:01:04,143 - Detection -   best_eval_score = 0
2023-04-23 22:01:04,143 - Detection -   eval_score = 0.0
2023-04-23 22:01:04,143 - Detection -   train_loss = 7.65106185277303
2023-04-23 22:01:04,855 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 22:01:04,855 - Detection -   best_eval_score = 0
2023-04-23 22:01:04,855 - Detection -   eval_score = 0.0
2023-04-23 22:01:04,855 - Detection -   train_loss = 7.349322319030762
2023-04-23 22:01:05,567 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 22:01:05,568 - Detection -   best_eval_score = 0
2023-04-23 22:01:05,568 - Detection -   eval_score = 0.0
2023-04-23 22:01:05,568 - Detection -   train_loss = 7.132800738016765
2023-04-23 22:01:06,280 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 22:01:06,280 - Detection -   best_eval_score = 0
2023-04-23 22:01:06,280 - Detection -   eval_score = 0.95
2023-04-23 22:01:06,280 - Detection -   train_loss = 6.80330228805542
2023-04-23 22:01:10,745 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 22:01:10,745 - Detection -   best_eval_score = 0.95
2023-04-23 22:01:10,745 - Detection -   eval_score = 22.21
2023-04-23 22:01:10,745 - Detection -   train_loss = 6.466641982396443
2023-04-23 22:01:15,393 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 22:01:15,393 - Detection -   best_eval_score = 22.21
2023-04-23 22:01:15,393 - Detection -   eval_score = 48.04
2023-04-23 22:01:15,393 - Detection -   train_loss = 4.917138417561849
2023-04-23 22:01:19,907 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 22:01:19,907 - Detection -   best_eval_score = 48.04
2023-04-23 22:01:19,907 - Detection -   eval_score = 64.52
2023-04-23 22:01:19,907 - Detection -   train_loss = 3.2121631701787314
2023-04-23 22:01:24,394 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 22:01:24,394 - Detection -   best_eval_score = 64.52
2023-04-23 22:01:24,395 - Detection -   eval_score = 69.16
2023-04-23 22:01:24,395 - Detection -   train_loss = 1.7590759793917339
2023-04-23 22:01:28,934 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 22:01:28,935 - Detection -   best_eval_score = 69.16
2023-04-23 22:01:28,935 - Detection -   eval_score = 69.69
2023-04-23 22:01:28,935 - Detection -   train_loss = 1.3037307659784954
2023-04-23 22:01:33,438 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 22:01:33,438 - Detection -   best_eval_score = 69.69
2023-04-23 22:01:33,438 - Detection -   eval_score = 69.69
2023-04-23 22:01:33,438 - Detection -   train_loss = 1.3327628175417583
2023-04-23 22:01:38,034 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 22:01:38,034 - Detection -   best_eval_score = 69.69
2023-04-23 22:01:38,034 - Detection -   eval_score = 69.69
2023-04-23 22:01:38,034 - Detection -   train_loss = 1.2717567682266235
2023-04-23 22:01:42,468 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 22:01:42,468 - Detection -   best_eval_score = 69.69
2023-04-23 22:01:42,468 - Detection -   eval_score = 69.69
2023-04-23 22:01:42,468 - Detection -   train_loss = 1.2632599472999573
2023-04-23 22:01:46,912 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 22:01:46,912 - Detection -   best_eval_score = 69.69
2023-04-23 22:01:46,912 - Detection -   eval_score = 69.69
2023-04-23 22:01:46,912 - Detection -   train_loss = 1.174246609210968
2023-04-23 22:01:51,343 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 22:01:51,343 - Detection -   best_eval_score = 69.69
2023-04-23 22:01:51,343 - Detection -   eval_score = 69.69
2023-04-23 22:01:51,343 - Detection -   train_loss = 1.2284938494364421
2023-04-23 22:01:55,833 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 22:01:55,833 - Detection -   best_eval_score = 69.69
2023-04-23 22:01:55,833 - Detection -   eval_score = 69.61
2023-04-23 22:01:55,833 - Detection -   train_loss = 1.2538347045580547
2023-04-23 22:02:00,468 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 22:02:00,468 - Detection -   best_eval_score = 69.69
2023-04-23 22:02:00,468 - Detection -   eval_score = 69.69
2023-04-23 22:02:00,468 - Detection -   train_loss = 1.2555412848790486
2023-04-23 22:02:04,905 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 22:02:04,905 - Detection -   best_eval_score = 69.69
2023-04-23 22:02:04,905 - Detection -   eval_score = 69.69
2023-04-23 22:02:04,905 - Detection -   train_loss = 1.2592411438624065
2023-04-23 22:02:09,369 - Detection - ***** Epoch: 22: Eval results *****
2023-04-23 22:02:09,369 - Detection -   best_eval_score = 69.69
2023-04-23 22:02:09,369 - Detection -   eval_score = 69.69
2023-04-23 22:02:09,369 - Detection -   train_loss = 1.3469329078992207
2023-04-23 22:02:13,810 - Detection - ***** Epoch: 23: Eval results *****
2023-04-23 22:02:13,810 - Detection -   best_eval_score = 69.69
2023-04-23 22:02:13,810 - Detection -   eval_score = 69.69
2023-04-23 22:02:13,810 - Detection -   train_loss = 1.248041609923045
2023-04-23 22:02:13,811 - Detection - Training Finished...
2023-04-23 22:02:13,811 - Detection - Testing begin...
2023-04-23 22:02:15,563 - Detection - ***** Test: Confusion Matrix *****
2023-04-23 22:02:15,564 - Detection - [[ 101    1    1    1    1   56]
 [   1   92    0    2    1   26]
 [   0    0   88    0    3   37]
 [   7    1    0   88    0   44]
 [   2    0    0    0  112   37]
 [ 291  161    5   75   50 1621]]
2023-04-23 22:02:15,564 - Detection - ***** Test results *****
2023-04-23 22:02:15,564 - Detection -   Acc = 72.36
2023-04-23 22:02:15,564 - Detection -   F1 = 62.0813
2023-04-23 22:02:15,564 - Detection -   F1-known = 58.3843
2023-04-23 22:02:15,564 - Detection -   F1-open = 80.5666
2023-04-23 22:02:15,564 - Detection - Testing finished...
2023-04-23 22:02:15,564 - Detection - Results saved in results/results_ADB-BOOST-F-4.csv
2023-04-23 22:02:15,583 - Detection - Open Intent Detection Finished...
