2023-04-05 07:03:27,422 - Detection - Open Intent Detection Begin...
2023-04-05 07:03:27,422 - Detection - Parameters Initialization...
2023-04-05 07:03:27,423 - Detection - ============================== Params ==============================
2023-04-05 07:03:27,423 - Detection - type:	open_intent_detection
2023-04-05 07:03:27,423 - Detection - logger_name:	Detection
2023-04-05 07:03:27,423 - Detection - log_dir:	logs
2023-04-05 07:03:27,423 - Detection - dataset:	stackoverflow
2023-04-05 07:03:27,423 - Detection - known_cls_ratio:	0.5
2023-04-05 07:03:27,423 - Detection - labeled_ratio:	1.0
2023-04-05 07:03:27,423 - Detection - method:	ADB
2023-04-05 07:03:27,423 - Detection - train:	True
2023-04-05 07:03:27,423 - Detection - pretrain:	True
2023-04-05 07:03:27,423 - Detection - save_model:	True
2023-04-05 07:03:27,423 - Detection - backbone:	bert
2023-04-05 07:03:27,423 - Detection - config_file_name:	ADB
2023-04-05 07:03:27,423 - Detection - seed:	9
2023-04-05 07:03:27,423 - Detection - gpu_id:	0
2023-04-05 07:03:27,423 - Detection - pipe_results_path:	pipe_results
2023-04-05 07:03:27,423 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-05 07:03:27,423 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-05 07:03:27,423 - Detection - model_dir:	models
2023-04-05 07:03:27,423 - Detection - load_pretrained_method:	None
2023-04-05 07:03:27,423 - Detection - result_dir:	results
2023-04-05 07:03:27,423 - Detection - results_file_name:	results_ADB.csv
2023-04-05 07:03:27,423 - Detection - save_results:	True
2023-04-05 07:03:27,423 - Detection - loss_fct:	CrossEntropyLoss
2023-04-05 07:03:27,423 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_0.5_1.0_bert_9
2023-04-05 07:03:27,423 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_0.5_1.0_bert_9/models
2023-04-05 07:03:27,423 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-05 07:03:27,423 - Detection - num_train_epochs:	100
2023-04-05 07:03:27,423 - Detection - num_labels:	None
2023-04-05 07:03:27,423 - Detection - max_seq_length:	None
2023-04-05 07:03:27,423 - Detection - freeze_backbone_parameters:	True
2023-04-05 07:03:27,423 - Detection - feat_dim:	768
2023-04-05 07:03:27,423 - Detection - warmup_proportion:	0.1
2023-04-05 07:03:27,423 - Detection - lr_boundary:	0.05
2023-04-05 07:03:27,423 - Detection - lr:	2e-05
2023-04-05 07:03:27,423 - Detection - activation:	relu
2023-04-05 07:03:27,423 - Detection - train_batch_size:	128
2023-04-05 07:03:27,423 - Detection - eval_batch_size:	64
2023-04-05 07:03:27,423 - Detection - test_batch_size:	64
2023-04-05 07:03:27,423 - Detection - wait_patient:	10
2023-04-05 07:03:27,423 - Detection - ============================== End Params ==============================
2023-04-05 07:03:27,423 - Detection - Data and Model Preparation...
2023-04-05 07:03:27,424 - Detection - The number of known intents is 10
2023-04-05 07:03:27,424 - Detection - Lists of known labels are: ['cocoa', 'haskell', 'hibernate', 'excel', 'spring', 'sharepoint', 'bash', 'drupal', 'magento', 'matlab']
2023-04-05 07:03:27,459 - Detection - Number of labeled training samples = 6000
2023-04-05 07:03:27,459 - Detection - Number of unlabeled training samples = 6000
2023-04-05 07:03:27,463 - Detection - Number of evaluation samples = 1000
2023-04-05 07:03:27,475 - Detection - Number of testing samples = 6000
2023-04-05 07:03:35,047 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-05 07:03:36,722 - Detection - Pre-training Begin...
2023-04-05 07:03:43,705 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 07:03:43,705 - Detection -   best_eval_score = 0
2023-04-05 07:03:43,705 - Detection -   eval_score = 27.0
2023-04-05 07:03:43,705 - Detection -   train_loss = 2.2929831159875746
2023-04-05 07:03:50,234 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 07:03:50,234 - Detection -   best_eval_score = 27.0
2023-04-05 07:03:50,234 - Detection -   eval_score = 42.9
2023-04-05 07:03:50,234 - Detection -   train_loss = 2.2436815221258937
2023-04-05 07:03:56,965 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 07:03:56,966 - Detection -   best_eval_score = 42.9
2023-04-05 07:03:56,966 - Detection -   eval_score = 53.1
2023-04-05 07:03:56,966 - Detection -   train_loss = 2.086796451122203
2023-04-05 07:04:03,913 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 07:04:03,913 - Detection -   best_eval_score = 53.1
2023-04-05 07:04:03,913 - Detection -   eval_score = 73.2
2023-04-05 07:04:03,913 - Detection -   train_loss = 1.6632453330019688
2023-04-05 07:04:10,896 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 07:04:10,896 - Detection -   best_eval_score = 73.2
2023-04-05 07:04:10,896 - Detection -   eval_score = 84.8
2023-04-05 07:04:10,896 - Detection -   train_loss = 1.077631969401177
2023-04-05 07:04:17,876 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 07:04:17,876 - Detection -   best_eval_score = 84.8
2023-04-05 07:04:17,876 - Detection -   eval_score = 86.3
2023-04-05 07:04:17,876 - Detection -   train_loss = 0.645343394989663
2023-04-05 07:04:24,862 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 07:04:24,862 - Detection -   best_eval_score = 86.3
2023-04-05 07:04:24,862 - Detection -   eval_score = 86.6
2023-04-05 07:04:24,862 - Detection -   train_loss = 0.47037891377793983
2023-04-05 07:04:31,933 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 07:04:31,934 - Detection -   best_eval_score = 86.6
2023-04-05 07:04:31,934 - Detection -   eval_score = 87.1
2023-04-05 07:04:31,934 - Detection -   train_loss = 0.4067244700928952
2023-04-05 07:04:38,923 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 07:04:38,923 - Detection -   best_eval_score = 87.1
2023-04-05 07:04:38,923 - Detection -   eval_score = 88.4
2023-04-05 07:04:38,923 - Detection -   train_loss = 0.36630177592977564
2023-04-05 07:04:45,897 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 07:04:45,897 - Detection -   best_eval_score = 88.4
2023-04-05 07:04:45,897 - Detection -   eval_score = 88.8
2023-04-05 07:04:45,897 - Detection -   train_loss = 0.3335672363321832
2023-04-05 07:04:52,877 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 07:04:52,877 - Detection -   best_eval_score = 88.8
2023-04-05 07:04:52,877 - Detection -   eval_score = 89.2
2023-04-05 07:04:52,877 - Detection -   train_loss = 0.30077194406631147
2023-04-05 07:04:59,856 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 07:04:59,857 - Detection -   best_eval_score = 89.2
2023-04-05 07:04:59,857 - Detection -   eval_score = 89.2
2023-04-05 07:04:59,857 - Detection -   train_loss = 0.279535691788856
2023-04-05 07:05:06,824 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 07:05:06,824 - Detection -   best_eval_score = 89.2
2023-04-05 07:05:06,824 - Detection -   eval_score = 89.6
2023-04-05 07:05:06,824 - Detection -   train_loss = 0.25942494767777463
2023-04-05 07:05:13,802 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 07:05:13,802 - Detection -   best_eval_score = 89.6
2023-04-05 07:05:13,802 - Detection -   eval_score = 89.5
2023-04-05 07:05:13,803 - Detection -   train_loss = 0.23891520135580224
2023-04-05 07:05:20,758 - Detection - ***** Epoch: 15: Eval results *****
2023-04-05 07:05:20,759 - Detection -   best_eval_score = 89.6
2023-04-05 07:05:20,759 - Detection -   eval_score = 89.3
2023-04-05 07:05:20,759 - Detection -   train_loss = 0.22161434416441209
2023-04-05 07:05:27,720 - Detection - ***** Epoch: 16: Eval results *****
2023-04-05 07:05:27,720 - Detection -   best_eval_score = 89.6
2023-04-05 07:05:27,720 - Detection -   eval_score = 89.6
2023-04-05 07:05:27,720 - Detection -   train_loss = 0.20795134233033402
2023-04-05 07:05:34,687 - Detection - ***** Epoch: 17: Eval results *****
2023-04-05 07:05:34,687 - Detection -   best_eval_score = 89.6
2023-04-05 07:05:34,687 - Detection -   eval_score = 90.0
2023-04-05 07:05:34,687 - Detection -   train_loss = 0.19745495392287032
2023-04-05 07:05:41,675 - Detection - ***** Epoch: 18: Eval results *****
2023-04-05 07:05:41,675 - Detection -   best_eval_score = 90.0
2023-04-05 07:05:41,675 - Detection -   eval_score = 89.7
2023-04-05 07:05:41,675 - Detection -   train_loss = 0.18658673763275146
2023-04-05 07:05:48,659 - Detection - ***** Epoch: 19: Eval results *****
2023-04-05 07:05:48,659 - Detection -   best_eval_score = 90.0
2023-04-05 07:05:48,659 - Detection -   eval_score = 90.5
2023-04-05 07:05:48,659 - Detection -   train_loss = 0.17409221130482694
2023-04-05 07:05:55,631 - Detection - ***** Epoch: 20: Eval results *****
2023-04-05 07:05:55,631 - Detection -   best_eval_score = 90.5
2023-04-05 07:05:55,631 - Detection -   eval_score = 89.7
2023-04-05 07:05:55,631 - Detection -   train_loss = 0.17181108051792104
2023-04-05 07:06:02,590 - Detection - ***** Epoch: 21: Eval results *****
2023-04-05 07:06:02,590 - Detection -   best_eval_score = 90.5
2023-04-05 07:06:02,590 - Detection -   eval_score = 90.5
2023-04-05 07:06:02,590 - Detection -   train_loss = 0.1569379224105084
2023-04-05 07:06:09,527 - Detection - ***** Epoch: 22: Eval results *****
2023-04-05 07:06:09,527 - Detection -   best_eval_score = 90.5
2023-04-05 07:06:09,527 - Detection -   eval_score = 89.9
2023-04-05 07:06:09,527 - Detection -   train_loss = 0.1425258829555613
2023-04-05 07:06:16,455 - Detection - ***** Epoch: 23: Eval results *****
2023-04-05 07:06:16,455 - Detection -   best_eval_score = 90.5
2023-04-05 07:06:16,471 - Detection -   eval_score = 89.8
2023-04-05 07:06:16,471 - Detection -   train_loss = 0.14040689566668044
2023-04-05 07:06:23,402 - Detection - ***** Epoch: 24: Eval results *****
2023-04-05 07:06:23,402 - Detection -   best_eval_score = 90.5
2023-04-05 07:06:23,402 - Detection -   eval_score = 89.8
2023-04-05 07:06:23,402 - Detection -   train_loss = 0.12975724089018842
2023-04-05 07:06:30,328 - Detection - ***** Epoch: 25: Eval results *****
2023-04-05 07:06:30,328 - Detection -   best_eval_score = 90.5
2023-04-05 07:06:30,328 - Detection -   eval_score = 90.6
2023-04-05 07:06:30,328 - Detection -   train_loss = 0.12322637090023528
2023-04-05 07:06:37,262 - Detection - ***** Epoch: 26: Eval results *****
2023-04-05 07:06:37,262 - Detection -   best_eval_score = 90.6
2023-04-05 07:06:37,262 - Detection -   eval_score = 90.2
2023-04-05 07:06:37,262 - Detection -   train_loss = 0.12623993022010682
2023-04-05 07:06:44,190 - Detection - ***** Epoch: 27: Eval results *****
2023-04-05 07:06:44,190 - Detection -   best_eval_score = 90.6
2023-04-05 07:06:44,190 - Detection -   eval_score = 90.7
2023-04-05 07:06:44,190 - Detection -   train_loss = 0.10836734345301668
2023-04-05 07:06:51,126 - Detection - ***** Epoch: 28: Eval results *****
2023-04-05 07:06:51,126 - Detection -   best_eval_score = 90.7
2023-04-05 07:06:51,126 - Detection -   eval_score = 90.6
2023-04-05 07:06:51,126 - Detection -   train_loss = 0.10616828525002966
2023-04-05 07:06:58,051 - Detection - ***** Epoch: 29: Eval results *****
2023-04-05 07:06:58,052 - Detection -   best_eval_score = 90.7
2023-04-05 07:06:58,052 - Detection -   eval_score = 90.4
2023-04-05 07:06:58,052 - Detection -   train_loss = 0.10017299200309084
2023-04-05 07:07:04,963 - Detection - ***** Epoch: 30: Eval results *****
2023-04-05 07:07:04,963 - Detection -   best_eval_score = 90.7
2023-04-05 07:07:04,963 - Detection -   eval_score = 90.3
2023-04-05 07:07:04,963 - Detection -   train_loss = 0.09629425224154553
2023-04-05 07:07:11,994 - Detection - ***** Epoch: 31: Eval results *****
2023-04-05 07:07:11,994 - Detection -   best_eval_score = 90.7
2023-04-05 07:07:11,994 - Detection -   eval_score = 90.3
2023-04-05 07:07:11,994 - Detection -   train_loss = 0.0955647514697085
2023-04-05 07:07:18,906 - Detection - ***** Epoch: 32: Eval results *****
2023-04-05 07:07:18,907 - Detection -   best_eval_score = 90.7
2023-04-05 07:07:18,907 - Detection -   eval_score = 90.4
2023-04-05 07:07:18,907 - Detection -   train_loss = 0.09225502871769539
2023-04-05 07:07:25,808 - Detection - ***** Epoch: 33: Eval results *****
2023-04-05 07:07:25,808 - Detection -   best_eval_score = 90.7
2023-04-05 07:07:25,808 - Detection -   eval_score = 89.7
2023-04-05 07:07:25,808 - Detection -   train_loss = 0.08120671960901707
2023-04-05 07:07:32,698 - Detection - ***** Epoch: 34: Eval results *****
2023-04-05 07:07:32,698 - Detection -   best_eval_score = 90.7
2023-04-05 07:07:32,698 - Detection -   eval_score = 90.6
2023-04-05 07:07:32,698 - Detection -   train_loss = 0.07776546771539018
2023-04-05 07:07:39,594 - Detection - ***** Epoch: 35: Eval results *****
2023-04-05 07:07:39,594 - Detection -   best_eval_score = 90.7
2023-04-05 07:07:39,594 - Detection -   eval_score = 90.5
2023-04-05 07:07:39,594 - Detection -   train_loss = 0.07608469912504896
2023-04-05 07:07:46,484 - Detection - ***** Epoch: 36: Eval results *****
2023-04-05 07:07:46,484 - Detection -   best_eval_score = 90.7
2023-04-05 07:07:46,484 - Detection -   eval_score = 90.6
2023-04-05 07:07:46,484 - Detection -   train_loss = 0.07261445547672028
2023-04-05 07:07:53,376 - Detection - ***** Epoch: 37: Eval results *****
2023-04-05 07:07:53,377 - Detection -   best_eval_score = 90.7
2023-04-05 07:07:53,377 - Detection -   eval_score = 90.7
2023-04-05 07:07:53,377 - Detection -   train_loss = 0.07099567381466956
2023-04-05 07:07:53,377 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_0.5_1.0_bert_9/models
2023-04-05 07:07:53,921 - Detection - Pre-training finished...
2023-04-05 07:07:53,921 - Detection - Training Begin...
2023-04-05 07:08:05,928 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 07:08:05,928 - Detection -   best_eval_score = 0
2023-04-05 07:08:05,928 - Detection -   eval_score = 3.21
2023-04-05 07:08:05,928 - Detection -   train_loss = 8.515658814856346
2023-04-05 07:08:12,750 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 07:08:12,750 - Detection -   best_eval_score = 3.21
2023-04-05 07:08:12,750 - Detection -   eval_score = 49.33
2023-04-05 07:08:12,750 - Detection -   train_loss = 6.24192546276336
2023-04-05 07:08:19,581 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 07:08:19,581 - Detection -   best_eval_score = 49.33
2023-04-05 07:08:19,581 - Detection -   eval_score = 75.11
2023-04-05 07:08:19,581 - Detection -   train_loss = 3.6717655658721924
2023-04-05 07:08:26,412 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 07:08:26,412 - Detection -   best_eval_score = 75.11
2023-04-05 07:08:26,412 - Detection -   eval_score = 79.73
2023-04-05 07:08:26,412 - Detection -   train_loss = 1.8689362622321921
2023-04-05 07:08:33,241 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 07:08:33,241 - Detection -   best_eval_score = 79.73
2023-04-05 07:08:33,241 - Detection -   eval_score = 80.04
2023-04-05 07:08:33,242 - Detection -   train_loss = 1.554307612966984
2023-04-05 07:08:40,076 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 07:08:40,077 - Detection -   best_eval_score = 80.04
2023-04-05 07:08:40,077 - Detection -   eval_score = 80.1
2023-04-05 07:08:40,077 - Detection -   train_loss = 1.5419333057200655
2023-04-05 07:08:46,919 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 07:08:46,920 - Detection -   best_eval_score = 80.1
2023-04-05 07:08:46,920 - Detection -   eval_score = 80.1
2023-04-05 07:08:46,920 - Detection -   train_loss = 1.5722440582640627
2023-04-05 07:08:53,768 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 07:08:53,768 - Detection -   best_eval_score = 80.1
2023-04-05 07:08:53,768 - Detection -   eval_score = 80.1
2023-04-05 07:08:53,768 - Detection -   train_loss = 1.567962220374574
2023-04-05 07:09:00,618 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 07:09:00,618 - Detection -   best_eval_score = 80.1
2023-04-05 07:09:00,618 - Detection -   eval_score = 80.1
2023-04-05 07:09:00,618 - Detection -   train_loss = 1.548983226431177
2023-04-05 07:09:07,463 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 07:09:07,463 - Detection -   best_eval_score = 80.1
2023-04-05 07:09:07,463 - Detection -   eval_score = 80.1
2023-04-05 07:09:07,464 - Detection -   train_loss = 1.5582327487620902
2023-04-05 07:09:14,314 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 07:09:14,314 - Detection -   best_eval_score = 80.1
2023-04-05 07:09:14,314 - Detection -   eval_score = 80.1
2023-04-05 07:09:14,314 - Detection -   train_loss = 1.5647127526871702
2023-04-05 07:09:21,162 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 07:09:21,162 - Detection -   best_eval_score = 80.1
2023-04-05 07:09:21,162 - Detection -   eval_score = 80.1
2023-04-05 07:09:21,162 - Detection -   train_loss = 1.5524106482242017
2023-04-05 07:09:28,004 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 07:09:28,004 - Detection -   best_eval_score = 80.1
2023-04-05 07:09:28,004 - Detection -   eval_score = 80.04
2023-04-05 07:09:28,004 - Detection -   train_loss = 1.5397034071861428
2023-04-05 07:09:34,867 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 07:09:34,867 - Detection -   best_eval_score = 80.1
2023-04-05 07:09:34,867 - Detection -   eval_score = 80.04
2023-04-05 07:09:34,867 - Detection -   train_loss = 1.5581917458392205
2023-04-05 07:09:41,715 - Detection - ***** Epoch: 15: Eval results *****
2023-04-05 07:09:41,715 - Detection -   best_eval_score = 80.1
2023-04-05 07:09:41,715 - Detection -   eval_score = 80.04
2023-04-05 07:09:41,715 - Detection -   train_loss = 1.5803324085600832
2023-04-05 07:09:48,556 - Detection - ***** Epoch: 16: Eval results *****
2023-04-05 07:09:48,557 - Detection -   best_eval_score = 80.1
2023-04-05 07:09:48,557 - Detection -   eval_score = 80.04
2023-04-05 07:09:48,557 - Detection -   train_loss = 1.566802240432577
2023-04-05 07:09:48,558 - Detection - Training Finished...
2023-04-05 07:09:48,558 - Detection - Testing begin...
2023-04-05 07:09:53,938 - Detection - ***** Test: Confusion Matrix *****
2023-04-05 07:09:53,938 - Detection - [[ 203    0    0    0    0    0    1    0    0    0   96]
 [   0  229    0    0    0    0    0    0    0    0   71]
 [   0    0  252    0    4    0    0    0    0    0   44]
 [   0    0    0  241    0    0    0    0    0    1   58]
 [   1    0    2    0  222    0    0    0    0    0   75]
 [   0    0    0    1    0  251    1    0    0    0   47]
 [   2    0    0    0    0    0  228    0    0    0   70]
 [   1    0    0    0    0    0    0  255    0    0   44]
 [   0    0    0    0    0    0    0    0  264    0   36]
 [   0    0    0    0    0    0    0    0    0  253   47]
 [ 117   12    3   12    6   11   35    3    1    0 2800]]
2023-04-05 07:09:53,938 - Detection - ***** Test results *****
2023-04-05 07:09:53,938 - Detection -   Acc = 86.63
2023-04-05 07:09:53,938 - Detection -   F1 = 85.8682
2023-04-05 07:09:53,938 - Detection -   F1-known = 85.6886
2023-04-05 07:09:53,938 - Detection -   F1-open = 87.6644
2023-04-05 07:09:53,938 - Detection - Testing finished...
2023-04-05 07:09:53,938 - Detection - Results saved in results/results_ADB.csv
2023-04-05 07:09:53,957 - Detection - Open Intent Detection Finished...
