2023-04-22 13:14:34,007 - Detection - Open Intent Detection Begin...
2023-04-22 13:14:34,007 - Detection - Parameters Initialization...
2023-04-22 13:14:34,008 - Detection - ============================== Params ==============================
2023-04-22 13:14:34,008 - Detection - type:	open_intent_detection
2023-04-22 13:14:34,008 - Detection - logger_name:	Detection
2023-04-22 13:14:34,008 - Detection - log_dir:	logs
2023-04-22 13:14:34,008 - Detection - dataset:	stackoverflow_cg
2023-04-22 13:14:34,008 - Detection - known_cls_ratio:	0.5
2023-04-22 13:14:34,008 - Detection - labeled_ratio:	1.0
2023-04-22 13:14:34,008 - Detection - method:	DA-ADB
2023-04-22 13:14:34,008 - Detection - train:	True
2023-04-22 13:14:34,008 - Detection - pretrain:	True
2023-04-22 13:14:34,008 - Detection - save_model:	False
2023-04-22 13:14:34,008 - Detection - backbone:	bert_disaware_boost
2023-04-22 13:14:34,008 - Detection - config_file_name:	DA-ADB
2023-04-22 13:14:34,008 - Detection - seed:	7
2023-04-22 13:14:34,008 - Detection - gpu_id:	0
2023-04-22 13:14:34,008 - Detection - pipe_results_path:	pipe_results
2023-04-22 13:14:34,008 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-22 13:14:34,008 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-22 13:14:34,008 - Detection - model_dir:	models
2023-04-22 13:14:34,008 - Detection - load_pretrained_method:	None
2023-04-22 13:14:34,008 - Detection - result_dir:	results
2023-04-22 13:14:34,008 - Detection - results_file_name:	results_DA-ADB-BOOST.csv
2023-04-22 13:14:34,008 - Detection - save_results:	True
2023-04-22 13:14:34,008 - Detection - loss_fct:	CrossEntropyLoss
2023-04-22 13:14:34,008 - Detection - boost_method:	F-10
2023-04-22 13:14:34,008 - Detection - boost_start_score:	0.0
2023-04-22 13:14:34,008 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.5_1.0_bert_disaware_boost_7
2023-04-22 13:14:34,008 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.5_1.0_bert_disaware_boost_7/models
2023-04-22 13:14:34,008 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-22 13:14:34,008 - Detection - num_train_epochs:	100
2023-04-22 13:14:34,008 - Detection - num_labels:	None
2023-04-22 13:14:34,008 - Detection - max_seq_length:	None
2023-04-22 13:14:34,008 - Detection - freeze_backbone_parameters:	True
2023-04-22 13:14:34,008 - Detection - feat_dim:	768
2023-04-22 13:14:34,008 - Detection - warmup_proportion:	0.1
2023-04-22 13:14:34,008 - Detection - scale:	4
2023-04-22 13:14:34,008 - Detection - lr_boundary:	0.05
2023-04-22 13:14:34,008 - Detection - lr:	2e-05
2023-04-22 13:14:34,008 - Detection - activation:	relu
2023-04-22 13:14:34,008 - Detection - train_batch_size:	128
2023-04-22 13:14:34,008 - Detection - eval_batch_size:	64
2023-04-22 13:14:34,008 - Detection - test_batch_size:	64
2023-04-22 13:14:34,008 - Detection - wait_patient:	10
2023-04-22 13:14:34,008 - Detection - ============================== End Params ==============================
2023-04-22 13:14:34,008 - Detection - Data and Model Preparation...
2023-04-22 13:14:34,009 - Detection - The number of known intents is 10
2023-04-22 13:14:34,009 - Detection - Lists of known labels are: ['apache', 'svn', 'bash', 'excel', 'oracle', 'ajax', 'visual-studio', 'haskell', 'qt', 'wordpress']
2023-04-22 13:14:34,018 - Detection - Number of labeled training samples = 1379
2023-04-22 13:14:34,018 - Detection - Number of unlabeled training samples = 1412
2023-04-22 13:14:34,020 - Detection - Number of evaluation samples = 696
2023-04-22 13:14:34,026 - Detection - Number of testing samples = 2905
2023-04-22 13:14:39,601 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-22 13:14:39,682 - Detection - Pre-training Begin...
2023-04-22 13:14:43,155 - Detection - ***** Epoch: 1: Eval results *****
2023-04-22 13:14:43,155 - Detection -   best_eval_score = 0
2023-04-22 13:14:43,155 - Detection -   eval_score = 2.6
2023-04-22 13:14:43,155 - Detection -   train_loss = 2.3123262362046675
2023-04-22 13:15:05,000 - Detection - ***** Epoch: 2: Eval results *****
2023-04-22 13:15:05,000 - Detection -   best_eval_score = 2.6
2023-04-22 13:15:05,000 - Detection -   eval_score = 3.84
2023-04-22 13:15:05,000 - Detection -   train_loss = 2.2912506623701616
2023-04-22 13:15:26,890 - Detection - ***** Epoch: 3: Eval results *****
2023-04-22 13:15:26,891 - Detection -   best_eval_score = 3.84
2023-04-22 13:15:26,891 - Detection -   eval_score = 43.26
2023-04-22 13:15:26,891 - Detection -   train_loss = 2.1710232604633677
2023-04-22 13:15:48,687 - Detection - ***** Epoch: 4: Eval results *****
2023-04-22 13:15:48,687 - Detection -   best_eval_score = 43.26
2023-04-22 13:15:48,687 - Detection -   eval_score = 79.29
2023-04-22 13:15:48,687 - Detection -   train_loss = 1.8416626128283413
2023-04-22 13:16:10,583 - Detection - ***** Epoch: 5: Eval results *****
2023-04-22 13:16:10,583 - Detection -   best_eval_score = 79.29
2023-04-22 13:16:10,583 - Detection -   eval_score = 83.42
2023-04-22 13:16:10,583 - Detection -   train_loss = 1.3464903072877363
2023-04-22 13:16:32,628 - Detection - ***** Epoch: 6: Eval results *****
2023-04-22 13:16:32,628 - Detection -   best_eval_score = 83.42
2023-04-22 13:16:32,628 - Detection -   eval_score = 84.03
2023-04-22 13:16:32,628 - Detection -   train_loss = 1.006927658211101
2023-04-22 13:16:54,399 - Detection - ***** Epoch: 7: Eval results *****
2023-04-22 13:16:54,399 - Detection -   best_eval_score = 84.03
2023-04-22 13:16:54,399 - Detection -   eval_score = 84.9
2023-04-22 13:16:54,399 - Detection -   train_loss = 0.8605485233393583
2023-04-22 13:17:16,227 - Detection - ***** Epoch: 8: Eval results *****
2023-04-22 13:17:16,227 - Detection -   best_eval_score = 84.9
2023-04-22 13:17:16,227 - Detection -   eval_score = 86.11
2023-04-22 13:17:16,227 - Detection -   train_loss = 0.7465364716269753
2023-04-22 13:17:38,352 - Detection - ***** Epoch: 9: Eval results *****
2023-04-22 13:17:38,352 - Detection -   best_eval_score = 86.11
2023-04-22 13:17:38,352 - Detection -   eval_score = 84.78
2023-04-22 13:17:38,352 - Detection -   train_loss = 0.649816935712641
2023-04-22 13:18:00,134 - Detection - ***** Epoch: 10: Eval results *****
2023-04-22 13:18:00,134 - Detection -   best_eval_score = 86.11
2023-04-22 13:18:00,134 - Detection -   eval_score = 85.93
2023-04-22 13:18:00,134 - Detection -   train_loss = 0.579722298817201
2023-04-22 13:18:21,973 - Detection - ***** Epoch: 11: Eval results *****
2023-04-22 13:18:21,973 - Detection -   best_eval_score = 86.11
2023-04-22 13:18:21,973 - Detection -   eval_score = 85.48
2023-04-22 13:18:21,973 - Detection -   train_loss = 0.5125839195468209
2023-04-22 13:18:44,089 - Detection - ***** Epoch: 12: Eval results *****
2023-04-22 13:18:44,090 - Detection -   best_eval_score = 86.11
2023-04-22 13:18:44,090 - Detection -   eval_score = 86.07
2023-04-22 13:18:44,090 - Detection -   train_loss = 0.46923233704133466
2023-04-22 13:19:05,987 - Detection - ***** Epoch: 13: Eval results *****
2023-04-22 13:19:05,987 - Detection -   best_eval_score = 86.11
2023-04-22 13:19:05,987 - Detection -   eval_score = 85.68
2023-04-22 13:19:05,987 - Detection -   train_loss = 0.42336412451483985
2023-04-22 13:19:27,777 - Detection - ***** Epoch: 14: Eval results *****
2023-04-22 13:19:27,777 - Detection -   best_eval_score = 86.11
2023-04-22 13:19:27,777 - Detection -   eval_score = 85.73
2023-04-22 13:19:27,777 - Detection -   train_loss = 0.38365586508404126
2023-04-22 13:19:49,616 - Detection - ***** Epoch: 15: Eval results *****
2023-04-22 13:19:49,616 - Detection -   best_eval_score = 86.11
2023-04-22 13:19:49,617 - Detection -   eval_score = 85.64
2023-04-22 13:19:49,617 - Detection -   train_loss = 0.35036262598904694
2023-04-22 13:20:11,401 - Detection - ***** Epoch: 16: Eval results *****
2023-04-22 13:20:11,401 - Detection -   best_eval_score = 86.11
2023-04-22 13:20:11,401 - Detection -   eval_score = 86.44
2023-04-22 13:20:11,401 - Detection -   train_loss = 0.32230416482145136
2023-04-22 13:20:33,314 - Detection - ***** Epoch: 17: Eval results *****
2023-04-22 13:20:33,314 - Detection -   best_eval_score = 86.44
2023-04-22 13:20:33,314 - Detection -   eval_score = 85.34
2023-04-22 13:20:33,314 - Detection -   train_loss = 0.30495777997103607
2023-04-22 13:20:55,310 - Detection - ***** Epoch: 18: Eval results *****
2023-04-22 13:20:55,310 - Detection -   best_eval_score = 86.44
2023-04-22 13:20:55,310 - Detection -   eval_score = 85.62
2023-04-22 13:20:55,310 - Detection -   train_loss = 0.28963650085709314
2023-04-22 13:21:17,188 - Detection - ***** Epoch: 19: Eval results *****
2023-04-22 13:21:17,188 - Detection -   best_eval_score = 86.44
2023-04-22 13:21:17,188 - Detection -   eval_score = 85.35
2023-04-22 13:21:17,188 - Detection -   train_loss = 0.27578382058577106
2023-04-22 13:21:38,951 - Detection - ***** Epoch: 20: Eval results *****
2023-04-22 13:21:38,951 - Detection -   best_eval_score = 86.44
2023-04-22 13:21:38,951 - Detection -   eval_score = 84.53
2023-04-22 13:21:38,951 - Detection -   train_loss = 0.2672560160810297
2023-04-22 13:22:00,999 - Detection - ***** Epoch: 21: Eval results *****
2023-04-22 13:22:01,000 - Detection -   best_eval_score = 86.44
2023-04-22 13:22:01,000 - Detection -   eval_score = 85.39
2023-04-22 13:22:01,000 - Detection -   train_loss = 0.26366818763993005
2023-04-22 13:22:22,922 - Detection - ***** Epoch: 22: Eval results *****
2023-04-22 13:22:22,922 - Detection -   best_eval_score = 86.44
2023-04-22 13:22:22,922 - Detection -   eval_score = 85.2
2023-04-22 13:22:22,922 - Detection -   train_loss = 0.2564070387320085
2023-04-22 13:22:44,842 - Detection - ***** Epoch: 23: Eval results *****
2023-04-22 13:22:44,842 - Detection -   best_eval_score = 86.44
2023-04-22 13:22:44,842 - Detection -   eval_score = 85.67
2023-04-22 13:22:44,842 - Detection -   train_loss = 0.24019589478319342
2023-04-22 13:23:06,957 - Detection - ***** Epoch: 24: Eval results *****
2023-04-22 13:23:06,958 - Detection -   best_eval_score = 86.44
2023-04-22 13:23:06,958 - Detection -   eval_score = 85.57
2023-04-22 13:23:06,958 - Detection -   train_loss = 0.23405663127248938
2023-04-22 13:23:28,861 - Detection - ***** Epoch: 25: Eval results *****
2023-04-22 13:23:28,861 - Detection -   best_eval_score = 86.44
2023-04-22 13:23:28,861 - Detection -   eval_score = 85.5
2023-04-22 13:23:28,861 - Detection -   train_loss = 0.22281000289050015
2023-04-22 13:23:50,826 - Detection - ***** Epoch: 26: Eval results *****
2023-04-22 13:23:50,826 - Detection -   best_eval_score = 86.44
2023-04-22 13:23:50,826 - Detection -   eval_score = 85.88
2023-04-22 13:23:50,826 - Detection -   train_loss = 0.21301364627751437
2023-04-22 13:23:50,827 - Detection - Pre-training finished...
2023-04-22 13:23:50,827 - Detection - Training Begin...
2023-04-22 13:23:52,689 - Detection - ***** Epoch: 1: Eval results *****
2023-04-22 13:23:52,689 - Detection -   best_eval_score = 0
2023-04-22 13:23:52,689 - Detection -   eval_score = 0.0
2023-04-22 13:23:52,689 - Detection -   train_loss = 5.141664721749046
2023-04-22 13:23:54,552 - Detection - ***** Epoch: 2: Eval results *****
2023-04-22 13:23:54,552 - Detection -   best_eval_score = 0
2023-04-22 13:23:54,552 - Detection -   eval_score = 0.0
2023-04-22 13:23:54,552 - Detection -   train_loss = 4.797905358401212
2023-04-22 13:23:56,416 - Detection - ***** Epoch: 3: Eval results *****
2023-04-22 13:23:56,416 - Detection -   best_eval_score = 0
2023-04-22 13:23:56,416 - Detection -   eval_score = 0.72
2023-04-22 13:23:56,416 - Detection -   train_loss = 4.43513653495095
2023-04-22 13:24:17,056 - Detection - ***** Epoch: 4: Eval results *****
2023-04-22 13:24:17,056 - Detection -   best_eval_score = 0.72
2023-04-22 13:24:17,056 - Detection -   eval_score = 71.61
2023-04-22 13:24:17,056 - Detection -   train_loss = 3.939048918810758
2023-04-22 13:24:37,637 - Detection - ***** Epoch: 5: Eval results *****
2023-04-22 13:24:37,637 - Detection -   best_eval_score = 71.61
2023-04-22 13:24:37,638 - Detection -   eval_score = 71.41
2023-04-22 13:24:37,638 - Detection -   train_loss = 1.1948283368890935
2023-04-22 13:24:58,260 - Detection - ***** Epoch: 6: Eval results *****
2023-04-22 13:24:58,260 - Detection -   best_eval_score = 71.61
2023-04-22 13:24:58,260 - Detection -   eval_score = 71.09
2023-04-22 13:24:58,261 - Detection -   train_loss = 1.1787570823322644
2023-04-22 13:25:18,840 - Detection - ***** Epoch: 7: Eval results *****
2023-04-22 13:25:18,840 - Detection -   best_eval_score = 71.61
2023-04-22 13:25:18,840 - Detection -   eval_score = 70.51
2023-04-22 13:25:18,840 - Detection -   train_loss = 1.1623656966469504
2023-04-22 13:25:39,377 - Detection - ***** Epoch: 8: Eval results *****
2023-04-22 13:25:39,377 - Detection -   best_eval_score = 71.61
2023-04-22 13:25:39,377 - Detection -   eval_score = 71.09
2023-04-22 13:25:39,377 - Detection -   train_loss = 1.2037563757462935
2023-04-22 13:25:59,906 - Detection - ***** Epoch: 9: Eval results *****
2023-04-22 13:25:59,906 - Detection -   best_eval_score = 71.61
2023-04-22 13:25:59,906 - Detection -   eval_score = 72.39
2023-04-22 13:25:59,906 - Detection -   train_loss = 1.1819459795951843
2023-04-22 13:26:20,456 - Detection - ***** Epoch: 10: Eval results *****
2023-04-22 13:26:20,456 - Detection -   best_eval_score = 72.39
2023-04-22 13:26:20,456 - Detection -   eval_score = 72.03
2023-04-22 13:26:20,456 - Detection -   train_loss = 1.1748247038234363
2023-04-22 13:26:41,059 - Detection - ***** Epoch: 11: Eval results *****
2023-04-22 13:26:41,059 - Detection -   best_eval_score = 72.39
2023-04-22 13:26:41,059 - Detection -   eval_score = 71.92
2023-04-22 13:26:41,059 - Detection -   train_loss = 1.141682749444788
2023-04-22 13:27:01,683 - Detection - ***** Epoch: 12: Eval results *****
2023-04-22 13:27:01,683 - Detection -   best_eval_score = 72.39
2023-04-22 13:27:01,683 - Detection -   eval_score = 71.66
2023-04-22 13:27:01,683 - Detection -   train_loss = 1.1295848326249556
2023-04-22 13:27:22,422 - Detection - ***** Epoch: 13: Eval results *****
2023-04-22 13:27:22,422 - Detection -   best_eval_score = 72.39
2023-04-22 13:27:22,422 - Detection -   eval_score = 70.69
2023-04-22 13:27:22,422 - Detection -   train_loss = 1.1821702176874334
2023-04-22 13:27:42,970 - Detection - ***** Epoch: 14: Eval results *****
2023-04-22 13:27:42,970 - Detection -   best_eval_score = 72.39
2023-04-22 13:27:42,970 - Detection -   eval_score = 71.38
2023-04-22 13:27:42,971 - Detection -   train_loss = 1.1710447072982788
2023-04-22 13:28:03,582 - Detection - ***** Epoch: 15: Eval results *****
2023-04-22 13:28:03,582 - Detection -   best_eval_score = 72.39
2023-04-22 13:28:03,582 - Detection -   eval_score = 71.11
2023-04-22 13:28:03,582 - Detection -   train_loss = 1.1722877784208818
2023-04-22 13:28:24,105 - Detection - ***** Epoch: 16: Eval results *****
2023-04-22 13:28:24,105 - Detection -   best_eval_score = 72.39
2023-04-22 13:28:24,105 - Detection -   eval_score = 71.9
2023-04-22 13:28:24,105 - Detection -   train_loss = 1.1900901144201106
2023-04-22 13:28:44,622 - Detection - ***** Epoch: 17: Eval results *****
2023-04-22 13:28:44,622 - Detection -   best_eval_score = 72.39
2023-04-22 13:28:44,622 - Detection -   eval_score = 71.9
2023-04-22 13:28:44,622 - Detection -   train_loss = 1.202239302071658
2023-04-22 13:29:05,151 - Detection - ***** Epoch: 18: Eval results *****
2023-04-22 13:29:05,151 - Detection -   best_eval_score = 72.39
2023-04-22 13:29:05,151 - Detection -   eval_score = 72.07
2023-04-22 13:29:05,151 - Detection -   train_loss = 1.1832658702676946
2023-04-22 13:29:25,791 - Detection - ***** Epoch: 19: Eval results *****
2023-04-22 13:29:25,791 - Detection -   best_eval_score = 72.39
2023-04-22 13:29:25,791 - Detection -   eval_score = 71.59
2023-04-22 13:29:25,791 - Detection -   train_loss = 1.1633079160343518
2023-04-22 13:29:25,791 - Detection - Training Finished...
2023-04-22 13:29:25,791 - Detection - Testing begin...
2023-04-22 13:29:28,210 - Detection - ***** Test: Confusion Matrix *****
2023-04-22 13:29:28,211 - Detection - [[ 102    1    0    0    0    0    0    0    0    1   66]
 [   1  109    0    0    0    0    1    0    1    0   37]
 [   0    0   63    0    0    1    0    1    0    0   74]
 [   0    0    0   92    0    0    0    0    0    0   48]
 [   1    0    0    0  100    0    0    0    0    0   26]
 [   1    0    0    0    0   86    0    0    0    2   71]
 [   1    0    0    0    1    1   40    0    0    0   63]
 [   0    0    0    0    0    0    0   53    0    0   69]
 [   0    0    0    0    0    0    0    1  155    0   16]
 [   1    0    0    0    0    2    0    0    0  112   22]
 [  11    2    2    5   17   24    4   52    6    1 1359]]
2023-04-22 13:29:28,211 - Detection - ***** Test results *****
2023-04-22 13:29:28,211 - Detection -   Acc = 78.18
2023-04-22 13:29:28,211 - Detection -   F1 = 72.7555
2023-04-22 13:29:28,211 - Detection -   F1-known = 71.8787
2023-04-22 13:29:28,211 - Detection -   F1-open = 81.5237
2023-04-22 13:29:28,211 - Detection - Testing finished...
2023-04-22 13:29:28,211 - Detection - Results saved in results/results_DA-ADB-BOOST.csv
2023-04-22 13:29:28,230 - Detection - Open Intent Detection Finished...
