2023-04-05 06:44:30,480 - Detection - Open Intent Detection Begin...
2023-04-05 06:44:30,480 - Detection - Parameters Initialization...
2023-04-05 06:44:30,481 - Detection - ============================== Params ==============================
2023-04-05 06:44:30,481 - Detection - type:	open_intent_detection
2023-04-05 06:44:30,481 - Detection - logger_name:	Detection
2023-04-05 06:44:30,481 - Detection - log_dir:	logs
2023-04-05 06:44:30,481 - Detection - dataset:	stackoverflow
2023-04-05 06:44:30,481 - Detection - known_cls_ratio:	0.5
2023-04-05 06:44:30,481 - Detection - labeled_ratio:	1.0
2023-04-05 06:44:30,481 - Detection - method:	ADB
2023-04-05 06:44:30,481 - Detection - train:	True
2023-04-05 06:44:30,481 - Detection - pretrain:	True
2023-04-05 06:44:30,481 - Detection - save_model:	True
2023-04-05 06:44:30,481 - Detection - backbone:	bert
2023-04-05 06:44:30,481 - Detection - config_file_name:	ADB
2023-04-05 06:44:30,481 - Detection - seed:	6
2023-04-05 06:44:30,481 - Detection - gpu_id:	0
2023-04-05 06:44:30,481 - Detection - pipe_results_path:	pipe_results
2023-04-05 06:44:30,481 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-05 06:44:30,481 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-05 06:44:30,481 - Detection - model_dir:	models
2023-04-05 06:44:30,481 - Detection - load_pretrained_method:	None
2023-04-05 06:44:30,481 - Detection - result_dir:	results
2023-04-05 06:44:30,481 - Detection - results_file_name:	results_ADB.csv
2023-04-05 06:44:30,481 - Detection - save_results:	True
2023-04-05 06:44:30,481 - Detection - loss_fct:	CrossEntropyLoss
2023-04-05 06:44:30,481 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_0.5_1.0_bert_6
2023-04-05 06:44:30,481 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_0.5_1.0_bert_6/models
2023-04-05 06:44:30,481 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-05 06:44:30,481 - Detection - num_train_epochs:	100
2023-04-05 06:44:30,481 - Detection - num_labels:	None
2023-04-05 06:44:30,481 - Detection - max_seq_length:	None
2023-04-05 06:44:30,481 - Detection - freeze_backbone_parameters:	True
2023-04-05 06:44:30,481 - Detection - feat_dim:	768
2023-04-05 06:44:30,481 - Detection - warmup_proportion:	0.1
2023-04-05 06:44:30,481 - Detection - lr_boundary:	0.05
2023-04-05 06:44:30,481 - Detection - lr:	2e-05
2023-04-05 06:44:30,481 - Detection - activation:	relu
2023-04-05 06:44:30,481 - Detection - train_batch_size:	128
2023-04-05 06:44:30,482 - Detection - eval_batch_size:	64
2023-04-05 06:44:30,482 - Detection - test_batch_size:	64
2023-04-05 06:44:30,482 - Detection - wait_patient:	10
2023-04-05 06:44:30,482 - Detection - ============================== End Params ==============================
2023-04-05 06:44:30,482 - Detection - Data and Model Preparation...
2023-04-05 06:44:30,482 - Detection - The number of known intents is 10
2023-04-05 06:44:30,482 - Detection - Lists of known labels are: ['svn', 'hibernate', 'excel', 'haskell', 'linq', 'bash', 'sharepoint', 'scala', 'drupal', 'oracle']
2023-04-05 06:44:30,517 - Detection - Number of labeled training samples = 6000
2023-04-05 06:44:30,517 - Detection - Number of unlabeled training samples = 6000
2023-04-05 06:44:30,521 - Detection - Number of evaluation samples = 1000
2023-04-05 06:44:30,533 - Detection - Number of testing samples = 6000
2023-04-05 06:44:38,202 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-05 06:44:39,848 - Detection - Pre-training Begin...
2023-04-05 06:44:46,830 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 06:44:46,830 - Detection -   best_eval_score = 0
2023-04-05 06:44:46,830 - Detection -   eval_score = 19.6
2023-04-05 06:44:46,830 - Detection -   train_loss = 2.298423726507958
2023-04-05 06:44:53,365 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 06:44:53,365 - Detection -   best_eval_score = 19.6
2023-04-05 06:44:53,365 - Detection -   eval_score = 49.8
2023-04-05 06:44:53,365 - Detection -   train_loss = 2.254118168607671
2023-04-05 06:45:00,094 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 06:45:00,095 - Detection -   best_eval_score = 49.8
2023-04-05 06:45:00,095 - Detection -   eval_score = 65.3
2023-04-05 06:45:00,095 - Detection -   train_loss = 2.1063702360112617
2023-04-05 06:45:07,058 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 06:45:07,058 - Detection -   best_eval_score = 65.3
2023-04-05 06:45:07,058 - Detection -   eval_score = 77.7
2023-04-05 06:45:07,058 - Detection -   train_loss = 1.6309736713450005
2023-04-05 06:45:14,043 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 06:45:14,044 - Detection -   best_eval_score = 77.7
2023-04-05 06:45:14,044 - Detection -   eval_score = 86.0
2023-04-05 06:45:14,044 - Detection -   train_loss = 0.9687703226475005
2023-04-05 06:45:21,023 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 06:45:21,023 - Detection -   best_eval_score = 86.0
2023-04-05 06:45:21,023 - Detection -   eval_score = 87.3
2023-04-05 06:45:21,023 - Detection -   train_loss = 0.5800245670562095
2023-04-05 06:45:28,079 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 06:45:28,079 - Detection -   best_eval_score = 87.3
2023-04-05 06:45:28,079 - Detection -   eval_score = 88.7
2023-04-05 06:45:28,079 - Detection -   train_loss = 0.44438034866718534
2023-04-05 06:45:35,186 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 06:45:35,186 - Detection -   best_eval_score = 88.7
2023-04-05 06:45:35,186 - Detection -   eval_score = 89.3
2023-04-05 06:45:35,186 - Detection -   train_loss = 0.3857571758488391
2023-04-05 06:45:42,188 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 06:45:42,188 - Detection -   best_eval_score = 89.3
2023-04-05 06:45:42,188 - Detection -   eval_score = 90.0
2023-04-05 06:45:42,188 - Detection -   train_loss = 0.3366195350251299
2023-04-05 06:45:49,185 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 06:45:49,185 - Detection -   best_eval_score = 90.0
2023-04-05 06:45:49,185 - Detection -   eval_score = 90.2
2023-04-05 06:45:49,185 - Detection -   train_loss = 0.3072660482944326
2023-04-05 06:45:56,189 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 06:45:56,189 - Detection -   best_eval_score = 90.2
2023-04-05 06:45:56,189 - Detection -   eval_score = 90.7
2023-04-05 06:45:56,189 - Detection -   train_loss = 0.27763494595568233
2023-04-05 06:46:03,198 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 06:46:03,198 - Detection -   best_eval_score = 90.7
2023-04-05 06:46:03,198 - Detection -   eval_score = 90.3
2023-04-05 06:46:03,198 - Detection -   train_loss = 0.25006944797140485
2023-04-05 06:46:10,170 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 06:46:10,170 - Detection -   best_eval_score = 90.7
2023-04-05 06:46:10,171 - Detection -   eval_score = 90.7
2023-04-05 06:46:10,171 - Detection -   train_loss = 0.2389472932257551
2023-04-05 06:46:17,159 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 06:46:17,159 - Detection -   best_eval_score = 90.7
2023-04-05 06:46:17,159 - Detection -   eval_score = 90.8
2023-04-05 06:46:17,159 - Detection -   train_loss = 0.20793749582260213
2023-04-05 06:46:24,147 - Detection - ***** Epoch: 15: Eval results *****
2023-04-05 06:46:24,147 - Detection -   best_eval_score = 90.8
2023-04-05 06:46:24,147 - Detection -   eval_score = 91.2
2023-04-05 06:46:24,147 - Detection -   train_loss = 0.1987581633506937
2023-04-05 06:46:31,137 - Detection - ***** Epoch: 16: Eval results *****
2023-04-05 06:46:31,137 - Detection -   best_eval_score = 91.2
2023-04-05 06:46:31,137 - Detection -   eval_score = 91.1
2023-04-05 06:46:31,137 - Detection -   train_loss = 0.19022296559303364
2023-04-05 06:46:38,122 - Detection - ***** Epoch: 17: Eval results *****
2023-04-05 06:46:38,122 - Detection -   best_eval_score = 91.2
2023-04-05 06:46:38,122 - Detection -   eval_score = 91.1
2023-04-05 06:46:38,123 - Detection -   train_loss = 0.17187868486693564
2023-04-05 06:46:45,114 - Detection - ***** Epoch: 18: Eval results *****
2023-04-05 06:46:45,114 - Detection -   best_eval_score = 91.2
2023-04-05 06:46:45,114 - Detection -   eval_score = 91.4
2023-04-05 06:46:45,114 - Detection -   train_loss = 0.16248843153106404
2023-04-05 06:46:52,104 - Detection - ***** Epoch: 19: Eval results *****
2023-04-05 06:46:52,104 - Detection -   best_eval_score = 91.4
2023-04-05 06:46:52,104 - Detection -   eval_score = 91.4
2023-04-05 06:46:52,104 - Detection -   train_loss = 0.15349576963072128
2023-04-05 06:46:59,074 - Detection - ***** Epoch: 20: Eval results *****
2023-04-05 06:46:59,074 - Detection -   best_eval_score = 91.4
2023-04-05 06:46:59,074 - Detection -   eval_score = 91.3
2023-04-05 06:46:59,074 - Detection -   train_loss = 0.14487485904642877
2023-04-05 06:47:06,033 - Detection - ***** Epoch: 21: Eval results *****
2023-04-05 06:47:06,033 - Detection -   best_eval_score = 91.4
2023-04-05 06:47:06,033 - Detection -   eval_score = 91.5
2023-04-05 06:47:06,033 - Detection -   train_loss = 0.13387006481594227
2023-04-05 06:47:12,993 - Detection - ***** Epoch: 22: Eval results *****
2023-04-05 06:47:12,993 - Detection -   best_eval_score = 91.5
2023-04-05 06:47:12,993 - Detection -   eval_score = 91.7
2023-04-05 06:47:12,993 - Detection -   train_loss = 0.12659723438481066
2023-04-05 06:47:19,947 - Detection - ***** Epoch: 23: Eval results *****
2023-04-05 06:47:19,947 - Detection -   best_eval_score = 91.7
2023-04-05 06:47:19,947 - Detection -   eval_score = 91.9
2023-04-05 06:47:19,947 - Detection -   train_loss = 0.11858452325488658
2023-04-05 06:47:26,896 - Detection - ***** Epoch: 24: Eval results *****
2023-04-05 06:47:26,896 - Detection -   best_eval_score = 91.9
2023-04-05 06:47:26,896 - Detection -   eval_score = 91.7
2023-04-05 06:47:26,896 - Detection -   train_loss = 0.11121777532265541
2023-04-05 06:47:33,829 - Detection - ***** Epoch: 25: Eval results *****
2023-04-05 06:47:33,829 - Detection -   best_eval_score = 91.9
2023-04-05 06:47:33,829 - Detection -   eval_score = 91.6
2023-04-05 06:47:33,829 - Detection -   train_loss = 0.10780798937094972
2023-04-05 06:47:40,762 - Detection - ***** Epoch: 26: Eval results *****
2023-04-05 06:47:40,762 - Detection -   best_eval_score = 91.9
2023-04-05 06:47:40,762 - Detection -   eval_score = 91.5
2023-04-05 06:47:40,762 - Detection -   train_loss = 0.09715351842819377
2023-04-05 06:47:47,704 - Detection - ***** Epoch: 27: Eval results *****
2023-04-05 06:47:47,704 - Detection -   best_eval_score = 91.9
2023-04-05 06:47:47,704 - Detection -   eval_score = 91.2
2023-04-05 06:47:47,704 - Detection -   train_loss = 0.09192509996764203
2023-04-05 06:47:54,641 - Detection - ***** Epoch: 28: Eval results *****
2023-04-05 06:47:54,641 - Detection -   best_eval_score = 91.9
2023-04-05 06:47:54,641 - Detection -   eval_score = 91.3
2023-04-05 06:47:54,641 - Detection -   train_loss = 0.08954624689005791
2023-04-05 06:48:01,582 - Detection - ***** Epoch: 29: Eval results *****
2023-04-05 06:48:01,582 - Detection -   best_eval_score = 91.9
2023-04-05 06:48:01,582 - Detection -   eval_score = 91.5
2023-04-05 06:48:01,582 - Detection -   train_loss = 0.0851039191351292
2023-04-05 06:48:08,600 - Detection - ***** Epoch: 30: Eval results *****
2023-04-05 06:48:08,600 - Detection -   best_eval_score = 91.9
2023-04-05 06:48:08,600 - Detection -   eval_score = 91.4
2023-04-05 06:48:08,600 - Detection -   train_loss = 0.08025736670861854
2023-04-05 06:48:15,535 - Detection - ***** Epoch: 31: Eval results *****
2023-04-05 06:48:15,535 - Detection -   best_eval_score = 91.9
2023-04-05 06:48:15,535 - Detection -   eval_score = 91.3
2023-04-05 06:48:15,535 - Detection -   train_loss = 0.07861999727468541
2023-04-05 06:48:22,460 - Detection - ***** Epoch: 32: Eval results *****
2023-04-05 06:48:22,460 - Detection -   best_eval_score = 91.9
2023-04-05 06:48:22,460 - Detection -   eval_score = 91.2
2023-04-05 06:48:22,460 - Detection -   train_loss = 0.075467789585286
2023-04-05 06:48:29,386 - Detection - ***** Epoch: 33: Eval results *****
2023-04-05 06:48:29,386 - Detection -   best_eval_score = 91.9
2023-04-05 06:48:29,386 - Detection -   eval_score = 91.3
2023-04-05 06:48:29,386 - Detection -   train_loss = 0.06735603130878286
2023-04-05 06:48:29,387 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_0.5_1.0_bert_6/models
2023-04-05 06:48:29,924 - Detection - Pre-training finished...
2023-04-05 06:48:29,924 - Detection - Training Begin...
2023-04-05 06:48:41,956 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 06:48:41,956 - Detection -   best_eval_score = 0
2023-04-05 06:48:41,956 - Detection -   eval_score = 1.92
2023-04-05 06:48:41,956 - Detection -   train_loss = 8.040756286458766
2023-04-05 06:48:48,797 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 06:48:48,797 - Detection -   best_eval_score = 1.92
2023-04-05 06:48:48,797 - Detection -   eval_score = 63.28
2023-04-05 06:48:48,797 - Detection -   train_loss = 5.783584777345049
2023-04-05 06:48:55,661 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 06:48:55,661 - Detection -   best_eval_score = 63.28
2023-04-05 06:48:55,661 - Detection -   eval_score = 80.74
2023-04-05 06:48:55,661 - Detection -   train_loss = 3.2540537651548993
2023-04-05 06:49:02,525 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 06:49:02,525 - Detection -   best_eval_score = 80.74
2023-04-05 06:49:02,525 - Detection -   eval_score = 82.28
2023-04-05 06:49:02,525 - Detection -   train_loss = 1.6745137711788745
2023-04-05 06:49:09,390 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 06:49:09,390 - Detection -   best_eval_score = 82.28
2023-04-05 06:49:09,390 - Detection -   eval_score = 82.29
2023-04-05 06:49:09,390 - Detection -   train_loss = 1.543804019055468
2023-04-05 06:49:16,249 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 06:49:16,249 - Detection -   best_eval_score = 82.29
2023-04-05 06:49:16,249 - Detection -   eval_score = 82.34
2023-04-05 06:49:16,249 - Detection -   train_loss = 1.5383715426668207
2023-04-05 06:49:23,114 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 06:49:23,114 - Detection -   best_eval_score = 82.34
2023-04-05 06:49:23,114 - Detection -   eval_score = 82.23
2023-04-05 06:49:23,114 - Detection -   train_loss = 1.5479839710479086
2023-04-05 06:49:29,995 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 06:49:29,996 - Detection -   best_eval_score = 82.34
2023-04-05 06:49:29,996 - Detection -   eval_score = 82.34
2023-04-05 06:49:29,996 - Detection -   train_loss = 1.5389617732230654
2023-04-05 06:49:36,867 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 06:49:36,867 - Detection -   best_eval_score = 82.34
2023-04-05 06:49:36,867 - Detection -   eval_score = 82.29
2023-04-05 06:49:36,867 - Detection -   train_loss = 1.5350444494409765
2023-04-05 06:49:43,726 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 06:49:43,726 - Detection -   best_eval_score = 82.34
2023-04-05 06:49:43,726 - Detection -   eval_score = 82.29
2023-04-05 06:49:43,726 - Detection -   train_loss = 1.5535580629998065
2023-04-05 06:49:50,571 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 06:49:50,571 - Detection -   best_eval_score = 82.34
2023-04-05 06:49:50,571 - Detection -   eval_score = 82.23
2023-04-05 06:49:50,571 - Detection -   train_loss = 1.5235316550478022
2023-04-05 06:49:57,436 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 06:49:57,437 - Detection -   best_eval_score = 82.34
2023-04-05 06:49:57,437 - Detection -   eval_score = 82.39
2023-04-05 06:49:57,437 - Detection -   train_loss = 1.5427482254961704
2023-04-05 06:50:04,295 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 06:50:04,295 - Detection -   best_eval_score = 82.39
2023-04-05 06:50:04,295 - Detection -   eval_score = 82.29
2023-04-05 06:50:04,295 - Detection -   train_loss = 1.528481808114559
2023-04-05 06:50:11,146 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 06:50:11,146 - Detection -   best_eval_score = 82.39
2023-04-05 06:50:11,146 - Detection -   eval_score = 82.23
2023-04-05 06:50:11,146 - Detection -   train_loss = 1.546495977868425
2023-04-05 06:50:18,005 - Detection - ***** Epoch: 15: Eval results *****
2023-04-05 06:50:18,005 - Detection -   best_eval_score = 82.39
2023-04-05 06:50:18,005 - Detection -   eval_score = 82.34
2023-04-05 06:50:18,005 - Detection -   train_loss = 1.556387596942009
2023-04-05 06:50:24,858 - Detection - ***** Epoch: 16: Eval results *****
2023-04-05 06:50:24,858 - Detection -   best_eval_score = 82.39
2023-04-05 06:50:24,859 - Detection -   eval_score = 82.29
2023-04-05 06:50:24,859 - Detection -   train_loss = 1.5341291300793911
2023-04-05 06:50:31,703 - Detection - ***** Epoch: 17: Eval results *****
2023-04-05 06:50:31,703 - Detection -   best_eval_score = 82.39
2023-04-05 06:50:31,703 - Detection -   eval_score = 82.28
2023-04-05 06:50:31,703 - Detection -   train_loss = 1.5608141828090587
2023-04-05 06:50:38,555 - Detection - ***** Epoch: 18: Eval results *****
2023-04-05 06:50:38,555 - Detection -   best_eval_score = 82.39
2023-04-05 06:50:38,555 - Detection -   eval_score = 82.29
2023-04-05 06:50:38,556 - Detection -   train_loss = 1.5434552507197603
2023-04-05 06:50:45,402 - Detection - ***** Epoch: 19: Eval results *****
2023-04-05 06:50:45,402 - Detection -   best_eval_score = 82.39
2023-04-05 06:50:45,402 - Detection -   eval_score = 82.23
2023-04-05 06:50:45,402 - Detection -   train_loss = 1.5465117008128064
2023-04-05 06:50:52,255 - Detection - ***** Epoch: 20: Eval results *****
2023-04-05 06:50:52,255 - Detection -   best_eval_score = 82.39
2023-04-05 06:50:52,255 - Detection -   eval_score = 82.29
2023-04-05 06:50:52,255 - Detection -   train_loss = 1.5479882524368611
2023-04-05 06:50:59,107 - Detection - ***** Epoch: 21: Eval results *****
2023-04-05 06:50:59,107 - Detection -   best_eval_score = 82.39
2023-04-05 06:50:59,107 - Detection -   eval_score = 82.29
2023-04-05 06:50:59,107 - Detection -   train_loss = 1.5542851077749373
2023-04-05 06:51:05,960 - Detection - ***** Epoch: 22: Eval results *****
2023-04-05 06:51:05,960 - Detection -   best_eval_score = 82.39
2023-04-05 06:51:05,960 - Detection -   eval_score = 82.29
2023-04-05 06:51:05,960 - Detection -   train_loss = 1.5488023783298248
2023-04-05 06:51:05,961 - Detection - Training Finished...
2023-04-05 06:51:05,961 - Detection - Testing begin...
2023-04-05 06:51:11,337 - Detection - ***** Test: Confusion Matrix *****
2023-04-05 06:51:11,337 - Detection - [[ 255    0    0    0    0    0    0    0    0    0   45]
 [   0  252    0    0    0    0    0    0    0    2   46]
 [   0    0  242    0    0    0    0    0    0    1   57]
 [   0    0    0  229    0    0    0    0    0    0   71]
 [   0    0    0    0  256    0    0    1    0    1   42]
 [   0    0    0    1    0  228    0    0    0    0   71]
 [   0    0    1    0    0    1  252    0    0    0   46]
 [   0    1    0    1    0    0    0  238    0    0   60]
 [   0    0    0    0    0    0    0    0  257    0   43]
 [   0    0    0    0    0    0    0    0    0  242   58]
 [   7   36   10   39    0   50   20    1    6    5 2826]]
2023-04-05 06:51:11,337 - Detection - ***** Test results *****
2023-04-05 06:51:11,337 - Detection -   Acc = 87.95
2023-04-05 06:51:11,337 - Detection -   F1 = 87.2025
2023-04-05 06:51:11,337 - Detection -   F1-known = 87.0429
2023-04-05 06:51:11,337 - Detection -   F1-open = 88.7981
2023-04-05 06:51:11,337 - Detection - Testing finished...
2023-04-05 06:51:11,337 - Detection - Results saved in results/results_ADB.csv
2023-04-05 06:51:11,356 - Detection - Open Intent Detection Finished...
