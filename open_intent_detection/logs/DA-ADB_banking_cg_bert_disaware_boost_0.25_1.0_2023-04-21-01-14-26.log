2023-04-21 01:14:26,148 - Detection - Open Intent Detection Begin...
2023-04-21 01:14:26,149 - Detection - Parameters Initialization...
2023-04-21 01:14:26,149 - Detection - ============================== Params ==============================
2023-04-21 01:14:26,149 - Detection - type:	open_intent_detection
2023-04-21 01:14:26,149 - Detection - logger_name:	Detection
2023-04-21 01:14:26,149 - Detection - log_dir:	logs
2023-04-21 01:14:26,149 - Detection - dataset:	banking_cg
2023-04-21 01:14:26,149 - Detection - known_cls_ratio:	0.25
2023-04-21 01:14:26,149 - Detection - labeled_ratio:	1.0
2023-04-21 01:14:26,149 - Detection - method:	DA-ADB
2023-04-21 01:14:26,149 - Detection - train:	True
2023-04-21 01:14:26,149 - Detection - pretrain:	True
2023-04-21 01:14:26,149 - Detection - save_model:	False
2023-04-21 01:14:26,149 - Detection - backbone:	bert_disaware_boost
2023-04-21 01:14:26,149 - Detection - config_file_name:	DA-ADB
2023-04-21 01:14:26,149 - Detection - seed:	9
2023-04-21 01:14:26,149 - Detection - gpu_id:	0
2023-04-21 01:14:26,149 - Detection - pipe_results_path:	pipe_results
2023-04-21 01:14:26,149 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-21 01:14:26,149 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-21 01:14:26,149 - Detection - model_dir:	models
2023-04-21 01:14:26,149 - Detection - load_pretrained_method:	None
2023-04-21 01:14:26,149 - Detection - result_dir:	results
2023-04-21 01:14:26,149 - Detection - results_file_name:	results_DA-ADB-BOOST.csv
2023-04-21 01:14:26,149 - Detection - save_results:	True
2023-04-21 01:14:26,149 - Detection - loss_fct:	CrossEntropyLoss
2023-04-21 01:14:26,149 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_cg_0.25_1.0_bert_disaware_boost_9
2023-04-21 01:14:26,149 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_cg_0.25_1.0_bert_disaware_boost_9/models
2023-04-21 01:14:26,149 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-21 01:14:26,149 - Detection - num_train_epochs:	100
2023-04-21 01:14:26,149 - Detection - num_labels:	None
2023-04-21 01:14:26,149 - Detection - max_seq_length:	None
2023-04-21 01:14:26,149 - Detection - freeze_backbone_parameters:	True
2023-04-21 01:14:26,149 - Detection - feat_dim:	768
2023-04-21 01:14:26,149 - Detection - warmup_proportion:	0.1
2023-04-21 01:14:26,149 - Detection - scale:	4
2023-04-21 01:14:26,149 - Detection - lr_boundary:	0.05
2023-04-21 01:14:26,149 - Detection - lr:	2e-05
2023-04-21 01:14:26,149 - Detection - activation:	relu
2023-04-21 01:14:26,149 - Detection - train_batch_size:	128
2023-04-21 01:14:26,150 - Detection - eval_batch_size:	64
2023-04-21 01:14:26,150 - Detection - test_batch_size:	64
2023-04-21 01:14:26,150 - Detection - wait_patient:	10
2023-04-21 01:14:26,150 - Detection - ============================== End Params ==============================
2023-04-21 01:14:26,150 - Detection - Data and Model Preparation...
2023-04-21 01:14:26,150 - Detection - The number of known intents is 19
2023-04-21 01:14:26,150 - Detection - Lists of known labels are: ['card_payment_not_recognised', 'cash_withdrawal_charge', 'declined_transfer', 'exchange_via_app', 'cash_withdrawal_not_recognised', 'declined_card_payment', 'pending_transfer', 'country_support', 'verify_top_up', 'apple_pay_or_google_pay', 'reverted_card_payment?', 'top_up_reverted', 'passcode_forgotten', 'balance_not_updated_after_bank_transfer', 'card_linking', 'lost_or_stolen_phone', 'failed_transfer', 'card_not_working', 'top_up_by_card_charge']
2023-04-21 01:14:26,158 - Detection - Number of labeled training samples = 725
2023-04-21 01:14:26,158 - Detection - Number of unlabeled training samples = 2047
2023-04-21 01:14:26,160 - Detection - Number of evaluation samples = 223
2023-04-21 01:14:26,164 - Detection - Number of testing samples = 1896
2023-04-21 01:14:31,630 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-21 01:14:31,712 - Detection - Pre-training Begin...
2023-04-21 01:14:33,970 - Detection - ***** Epoch: 1: Eval results *****
2023-04-21 01:14:33,970 - Detection -   best_eval_score = 0
2023-04-21 01:14:33,970 - Detection -   eval_score = 0.46
2023-04-21 01:14:33,970 - Detection -   train_loss = 2.958227515220642
2023-04-21 01:14:48,143 - Detection - ***** Epoch: 2: Eval results *****
2023-04-21 01:14:48,143 - Detection -   best_eval_score = 0.46
2023-04-21 01:14:48,143 - Detection -   eval_score = 2.69
2023-04-21 01:14:48,143 - Detection -   train_loss = 2.938494642575582
2023-04-21 01:15:02,218 - Detection - ***** Epoch: 3: Eval results *****
2023-04-21 01:15:02,218 - Detection -   best_eval_score = 2.69
2023-04-21 01:15:02,219 - Detection -   eval_score = 7.64
2023-04-21 01:15:02,219 - Detection -   train_loss = 2.8114686409632363
2023-04-21 01:15:16,477 - Detection - ***** Epoch: 4: Eval results *****
2023-04-21 01:15:16,477 - Detection -   best_eval_score = 7.64
2023-04-21 01:15:16,477 - Detection -   eval_score = 20.71
2023-04-21 01:15:16,477 - Detection -   train_loss = 2.638321042060852
2023-04-21 01:15:30,533 - Detection - ***** Epoch: 5: Eval results *****
2023-04-21 01:15:30,533 - Detection -   best_eval_score = 20.71
2023-04-21 01:15:30,533 - Detection -   eval_score = 45.44
2023-04-21 01:15:30,533 - Detection -   train_loss = 2.3488148053487143
2023-04-21 01:15:44,660 - Detection - ***** Epoch: 6: Eval results *****
2023-04-21 01:15:44,660 - Detection -   best_eval_score = 45.44
2023-04-21 01:15:44,660 - Detection -   eval_score = 57.88
2023-04-21 01:15:44,660 - Detection -   train_loss = 2.012316882610321
2023-04-21 01:15:58,759 - Detection - ***** Epoch: 7: Eval results *****
2023-04-21 01:15:58,759 - Detection -   best_eval_score = 57.88
2023-04-21 01:15:58,759 - Detection -   eval_score = 72.5
2023-04-21 01:15:58,759 - Detection -   train_loss = 1.6987085541089375
2023-04-21 01:16:12,978 - Detection - ***** Epoch: 8: Eval results *****
2023-04-21 01:16:12,978 - Detection -   best_eval_score = 72.5
2023-04-21 01:16:12,978 - Detection -   eval_score = 73.35
2023-04-21 01:16:12,978 - Detection -   train_loss = 1.3900986711184184
2023-04-21 01:16:27,108 - Detection - ***** Epoch: 9: Eval results *****
2023-04-21 01:16:27,108 - Detection -   best_eval_score = 73.35
2023-04-21 01:16:27,108 - Detection -   eval_score = 82.16
2023-04-21 01:16:27,108 - Detection -   train_loss = 1.0959210793177288
2023-04-21 01:16:41,320 - Detection - ***** Epoch: 10: Eval results *****
2023-04-21 01:16:41,320 - Detection -   best_eval_score = 82.16
2023-04-21 01:16:41,320 - Detection -   eval_score = 81.74
2023-04-21 01:16:41,320 - Detection -   train_loss = 0.9298019607861837
2023-04-21 01:16:55,422 - Detection - ***** Epoch: 11: Eval results *****
2023-04-21 01:16:55,422 - Detection -   best_eval_score = 82.16
2023-04-21 01:16:55,422 - Detection -   eval_score = 83.28
2023-04-21 01:16:55,422 - Detection -   train_loss = 0.832410583893458
2023-04-21 01:17:09,617 - Detection - ***** Epoch: 12: Eval results *****
2023-04-21 01:17:09,618 - Detection -   best_eval_score = 83.28
2023-04-21 01:17:09,618 - Detection -   eval_score = 81.54
2023-04-21 01:17:09,618 - Detection -   train_loss = 0.7619940141836802
2023-04-21 01:17:23,755 - Detection - ***** Epoch: 13: Eval results *****
2023-04-21 01:17:23,755 - Detection -   best_eval_score = 83.28
2023-04-21 01:17:23,755 - Detection -   eval_score = 82.39
2023-04-21 01:17:23,755 - Detection -   train_loss = 0.7086802025636038
2023-04-21 01:17:38,050 - Detection - ***** Epoch: 14: Eval results *****
2023-04-21 01:17:38,050 - Detection -   best_eval_score = 83.28
2023-04-21 01:17:38,050 - Detection -   eval_score = 85.16
2023-04-21 01:17:38,050 - Detection -   train_loss = 0.6732398271560669
2023-04-21 01:17:52,161 - Detection - ***** Epoch: 15: Eval results *****
2023-04-21 01:17:52,161 - Detection -   best_eval_score = 85.16
2023-04-21 01:17:52,161 - Detection -   eval_score = 84.01
2023-04-21 01:17:52,161 - Detection -   train_loss = 0.6294013063112894
2023-04-21 01:18:06,351 - Detection - ***** Epoch: 16: Eval results *****
2023-04-21 01:18:06,351 - Detection -   best_eval_score = 85.16
2023-04-21 01:18:06,351 - Detection -   eval_score = 83.55
2023-04-21 01:18:06,352 - Detection -   train_loss = 0.5980418622493744
2023-04-21 01:18:20,428 - Detection - ***** Epoch: 17: Eval results *****
2023-04-21 01:18:20,428 - Detection -   best_eval_score = 85.16
2023-04-21 01:18:20,428 - Detection -   eval_score = 85.45
2023-04-21 01:18:20,428 - Detection -   train_loss = 0.5785566965738932
2023-04-21 01:18:34,527 - Detection - ***** Epoch: 18: Eval results *****
2023-04-21 01:18:34,527 - Detection -   best_eval_score = 85.45
2023-04-21 01:18:34,527 - Detection -   eval_score = 85.59
2023-04-21 01:18:34,527 - Detection -   train_loss = 0.5592377285162607
2023-04-21 01:18:48,625 - Detection - ***** Epoch: 19: Eval results *****
2023-04-21 01:18:48,625 - Detection -   best_eval_score = 85.59
2023-04-21 01:18:48,625 - Detection -   eval_score = 85.01
2023-04-21 01:18:48,625 - Detection -   train_loss = 0.5359616875648499
2023-04-21 01:19:02,819 - Detection - ***** Epoch: 20: Eval results *****
2023-04-21 01:19:02,819 - Detection -   best_eval_score = 85.59
2023-04-21 01:19:02,819 - Detection -   eval_score = 83.76
2023-04-21 01:19:02,819 - Detection -   train_loss = 0.526412824789683
2023-04-21 01:19:16,932 - Detection - ***** Epoch: 21: Eval results *****
2023-04-21 01:19:16,932 - Detection -   best_eval_score = 85.59
2023-04-21 01:19:16,932 - Detection -   eval_score = 85.14
2023-04-21 01:19:16,932 - Detection -   train_loss = 0.5131703416506449
2023-04-21 01:19:31,136 - Detection - ***** Epoch: 22: Eval results *****
2023-04-21 01:19:31,137 - Detection -   best_eval_score = 85.59
2023-04-21 01:19:31,137 - Detection -   eval_score = 84.14
2023-04-21 01:19:31,137 - Detection -   train_loss = 0.5002835740645727
2023-04-21 01:19:45,309 - Detection - ***** Epoch: 23: Eval results *****
2023-04-21 01:19:45,309 - Detection -   best_eval_score = 85.59
2023-04-21 01:19:45,309 - Detection -   eval_score = 85.15
2023-04-21 01:19:45,309 - Detection -   train_loss = 0.4915463576714198
2023-04-21 01:19:59,524 - Detection - ***** Epoch: 24: Eval results *****
2023-04-21 01:19:59,524 - Detection -   best_eval_score = 85.59
2023-04-21 01:19:59,524 - Detection -   eval_score = 84.86
2023-04-21 01:19:59,524 - Detection -   train_loss = 0.4834993729988734
2023-04-21 01:20:13,583 - Detection - ***** Epoch: 25: Eval results *****
2023-04-21 01:20:13,583 - Detection -   best_eval_score = 85.59
2023-04-21 01:20:13,583 - Detection -   eval_score = 84.65
2023-04-21 01:20:13,583 - Detection -   train_loss = 0.47379570702711743
2023-04-21 01:20:27,813 - Detection - ***** Epoch: 26: Eval results *****
2023-04-21 01:20:27,814 - Detection -   best_eval_score = 85.59
2023-04-21 01:20:27,814 - Detection -   eval_score = 85.07
2023-04-21 01:20:27,814 - Detection -   train_loss = 0.46667107939720154
2023-04-21 01:20:41,981 - Detection - ***** Epoch: 27: Eval results *****
2023-04-21 01:20:41,981 - Detection -   best_eval_score = 85.59
2023-04-21 01:20:41,981 - Detection -   eval_score = 84.15
2023-04-21 01:20:41,981 - Detection -   train_loss = 0.4601597885290782
2023-04-21 01:20:56,236 - Detection - ***** Epoch: 28: Eval results *****
2023-04-21 01:20:56,236 - Detection -   best_eval_score = 85.59
2023-04-21 01:20:56,236 - Detection -   eval_score = 85.52
2023-04-21 01:20:56,236 - Detection -   train_loss = 0.45417719582716626
2023-04-21 01:20:56,236 - Detection - Pre-training finished...
2023-04-21 01:20:56,236 - Detection - Training Begin...
2023-04-21 01:20:57,284 - Detection - ***** Epoch: 1: Eval results *****
2023-04-21 01:20:57,284 - Detection -   best_eval_score = 0
2023-04-21 01:20:57,284 - Detection -   eval_score = 0.0
2023-04-21 01:20:57,285 - Detection -   train_loss = 3.246784051259359
2023-04-21 01:20:58,333 - Detection - ***** Epoch: 2: Eval results *****
2023-04-21 01:20:58,334 - Detection -   best_eval_score = 0
2023-04-21 01:20:58,334 - Detection -   eval_score = 1.82
2023-04-21 01:20:58,334 - Detection -   train_loss = 3.115244150161743
2023-04-21 01:21:11,671 - Detection - ***** Epoch: 3: Eval results *****
2023-04-21 01:21:11,671 - Detection -   best_eval_score = 1.82
2023-04-21 01:21:11,671 - Detection -   eval_score = 53.74
2023-04-21 01:21:11,671 - Detection -   train_loss = 2.961133360862732
2023-04-21 01:21:25,025 - Detection - ***** Epoch: 4: Eval results *****
2023-04-21 01:21:25,025 - Detection -   best_eval_score = 53.74
2023-04-21 01:21:25,025 - Detection -   eval_score = 64.47
2023-04-21 01:21:25,025 - Detection -   train_loss = 0.6024953623612722
2023-04-21 01:21:38,280 - Detection - ***** Epoch: 5: Eval results *****
2023-04-21 01:21:38,280 - Detection -   best_eval_score = 64.47
2023-04-21 01:21:38,280 - Detection -   eval_score = 64.68
2023-04-21 01:21:38,280 - Detection -   train_loss = 0.5282642692327499
2023-04-21 01:21:51,555 - Detection - ***** Epoch: 6: Eval results *****
2023-04-21 01:21:51,555 - Detection -   best_eval_score = 64.68
2023-04-21 01:21:51,555 - Detection -   eval_score = 65.05
2023-04-21 01:21:51,555 - Detection -   train_loss = 0.48767638206481934
2023-04-21 01:22:04,852 - Detection - ***** Epoch: 7: Eval results *****
2023-04-21 01:22:04,852 - Detection -   best_eval_score = 65.05
2023-04-21 01:22:04,852 - Detection -   eval_score = 64.31
2023-04-21 01:22:04,853 - Detection -   train_loss = 0.5156537691752116
2023-04-21 01:22:18,355 - Detection - ***** Epoch: 8: Eval results *****
2023-04-21 01:22:18,355 - Detection -   best_eval_score = 65.05
2023-04-21 01:22:18,355 - Detection -   eval_score = 66.31
2023-04-21 01:22:18,355 - Detection -   train_loss = 0.5033527513345083
2023-04-21 01:22:31,614 - Detection - ***** Epoch: 9: Eval results *****
2023-04-21 01:22:31,615 - Detection -   best_eval_score = 66.31
2023-04-21 01:22:31,615 - Detection -   eval_score = 64.01
2023-04-21 01:22:31,615 - Detection -   train_loss = 0.48917396863301593
2023-04-21 01:22:44,861 - Detection - ***** Epoch: 10: Eval results *****
2023-04-21 01:22:44,861 - Detection -   best_eval_score = 66.31
2023-04-21 01:22:44,861 - Detection -   eval_score = 64.66
2023-04-21 01:22:44,861 - Detection -   train_loss = 0.5092208832502365
2023-04-21 01:22:58,147 - Detection - ***** Epoch: 11: Eval results *****
2023-04-21 01:22:58,148 - Detection -   best_eval_score = 66.31
2023-04-21 01:22:58,148 - Detection -   eval_score = 64.05
2023-04-21 01:22:58,148 - Detection -   train_loss = 0.49834637840588886
2023-04-21 01:23:11,550 - Detection - ***** Epoch: 12: Eval results *****
2023-04-21 01:23:11,550 - Detection -   best_eval_score = 66.31
2023-04-21 01:23:11,550 - Detection -   eval_score = 64.12
2023-04-21 01:23:11,550 - Detection -   train_loss = 0.514763593673706
2023-04-21 01:23:24,836 - Detection - ***** Epoch: 13: Eval results *****
2023-04-21 01:23:24,836 - Detection -   best_eval_score = 66.31
2023-04-21 01:23:24,836 - Detection -   eval_score = 64.47
2023-04-21 01:23:24,836 - Detection -   train_loss = 0.5105872799952825
2023-04-21 01:23:38,204 - Detection - ***** Epoch: 14: Eval results *****
2023-04-21 01:23:38,204 - Detection -   best_eval_score = 66.31
2023-04-21 01:23:38,204 - Detection -   eval_score = 65.24
2023-04-21 01:23:38,204 - Detection -   train_loss = 0.5068723013003668
2023-04-21 01:23:51,444 - Detection - ***** Epoch: 15: Eval results *****
2023-04-21 01:23:51,444 - Detection -   best_eval_score = 66.31
2023-04-21 01:23:51,444 - Detection -   eval_score = 64.61
2023-04-21 01:23:51,444 - Detection -   train_loss = 0.49389121929804486
2023-04-21 01:24:04,849 - Detection - ***** Epoch: 16: Eval results *****
2023-04-21 01:24:04,849 - Detection -   best_eval_score = 66.31
2023-04-21 01:24:04,849 - Detection -   eval_score = 64.73
2023-04-21 01:24:04,849 - Detection -   train_loss = 0.511446346839269
2023-04-21 01:24:18,171 - Detection - ***** Epoch: 17: Eval results *****
2023-04-21 01:24:18,171 - Detection -   best_eval_score = 66.31
2023-04-21 01:24:18,171 - Detection -   eval_score = 66.01
2023-04-21 01:24:18,171 - Detection -   train_loss = 0.5032160629828771
2023-04-21 01:24:31,446 - Detection - ***** Epoch: 18: Eval results *****
2023-04-21 01:24:31,446 - Detection -   best_eval_score = 66.31
2023-04-21 01:24:31,446 - Detection -   eval_score = 65.21
2023-04-21 01:24:31,446 - Detection -   train_loss = 0.5231486956278483
2023-04-21 01:24:31,446 - Detection - Training Finished...
2023-04-21 01:24:31,446 - Detection - Testing begin...
2023-04-21 01:24:33,339 - Detection - ***** Test: Confusion Matrix *****
2023-04-21 01:24:33,339 - Detection - [[   9    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0   11]
 [   0   32    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    2]
 [   0    0   11    0    0    4    0    0    0    0    0    0    0    0
     0    0    0    0    0   11]
 [   0    0    0   19    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    3]
 [   0    0    0    0   13    0    0    0    0    0    0    0    0    0
     0    0    0    0    0   21]
 [   0    0    0    0    0   13    0    0    0    0    0    0    0    0
     0    0    0    1    0   18]
 [   0    0    0    0    0    0   17    0    0    0    0    0    0    3
     0    0    0    0    0   14]
 [   0    0    0    0    0    0    0   14    0    0    0    0    0    0
     0    0    0    0    0    4]
 [   0    0    0    0    0    0    0    0   23    0    0    0    0    0
     0    0    0    0    0    6]
 [   0    0    0    0    0    0    0    0    0   14    0    0    0    0
     0    0    0    0    0    8]
 [   0    0    0    0    0    1    0    0    0    0    8    0    0    0
     0    0    0    0    0   26]
 [   0    0    0    0    0    0    0    0    0    0    0   18    0    0
     0    0    0    0    0    9]
 [   0    0    0    0    0    0    0    0    0    0    0    0   11    0
     0    0    0    0    0    5]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    6
     0    0    0    0    0   19]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
    16    0    0    0    0   12]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0   12    0    0    0   12]
 [   0    0    3    0    0    0    0    0    0    0    0    0    0    0
     0    0    6    0    0   18]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0   15    0    5]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0   10    9]
 [   6   20    2   61    5    2   14    2    0    0    6   31    0   11
     8    0    1   19    0 1216]]
2023-04-21 01:24:33,339 - Detection - ***** Test results *****
2023-04-21 01:24:33,339 - Detection -   Acc = 78.22
2023-04-21 01:24:33,339 - Detection -   F1 = 58.8704
2023-04-21 01:24:33,339 - Detection -   F1-known = 57.4507
2023-04-21 01:24:33,339 - Detection -   F1-open = 85.8454
2023-04-21 01:24:33,339 - Detection - Testing finished...
2023-04-21 01:24:33,339 - Detection - Results saved in results/results_DA-ADB-BOOST.csv
2023-04-21 01:24:33,360 - Detection - Open Intent Detection Finished...
