2023-04-22 23:58:18,494 - Detection - Open Intent Detection Begin...
2023-04-22 23:58:18,494 - Detection - Parameters Initialization...
2023-04-22 23:58:18,494 - Detection - ============================== Params ==============================
2023-04-22 23:58:18,494 - Detection - type:	open_intent_detection
2023-04-22 23:58:18,494 - Detection - logger_name:	Detection
2023-04-22 23:58:18,494 - Detection - log_dir:	logs
2023-04-22 23:58:18,494 - Detection - dataset:	stackoverflow_cg
2023-04-22 23:58:18,494 - Detection - known_cls_ratio:	0.25
2023-04-22 23:58:18,494 - Detection - labeled_ratio:	1.0
2023-04-22 23:58:18,494 - Detection - method:	DA-ADB
2023-04-22 23:58:18,495 - Detection - train:	True
2023-04-22 23:58:18,495 - Detection - pretrain:	True
2023-04-22 23:58:18,495 - Detection - save_model:	False
2023-04-22 23:58:18,495 - Detection - backbone:	bert_disaware_boost
2023-04-22 23:58:18,495 - Detection - config_file_name:	DA-ADB
2023-04-22 23:58:18,495 - Detection - seed:	5
2023-04-22 23:58:18,495 - Detection - gpu_id:	0
2023-04-22 23:58:18,495 - Detection - pipe_results_path:	pipe_results
2023-04-22 23:58:18,495 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-22 23:58:18,495 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-22 23:58:18,495 - Detection - model_dir:	models
2023-04-22 23:58:18,495 - Detection - load_pretrained_method:	None
2023-04-22 23:58:18,495 - Detection - result_dir:	results
2023-04-22 23:58:18,495 - Detection - results_file_name:	results_DA-ADB-BOOST-F-4.csv
2023-04-22 23:58:18,495 - Detection - save_results:	True
2023-04-22 23:58:18,495 - Detection - loss_fct:	CrossEntropyLoss
2023-04-22 23:58:18,495 - Detection - boost_method:	F-4
2023-04-22 23:58:18,495 - Detection - boost_start_score:	0.0
2023-04-22 23:58:18,495 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.25_1.0_bert_disaware_boost_5
2023-04-22 23:58:18,495 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.25_1.0_bert_disaware_boost_5/models
2023-04-22 23:58:18,495 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-22 23:58:18,495 - Detection - num_train_epochs:	100
2023-04-22 23:58:18,495 - Detection - num_labels:	None
2023-04-22 23:58:18,495 - Detection - max_seq_length:	None
2023-04-22 23:58:18,495 - Detection - freeze_backbone_parameters:	True
2023-04-22 23:58:18,495 - Detection - feat_dim:	768
2023-04-22 23:58:18,495 - Detection - warmup_proportion:	0.1
2023-04-22 23:58:18,495 - Detection - scale:	4
2023-04-22 23:58:18,495 - Detection - lr_boundary:	0.05
2023-04-22 23:58:18,495 - Detection - lr:	2e-05
2023-04-22 23:58:18,495 - Detection - activation:	relu
2023-04-22 23:58:18,495 - Detection - train_batch_size:	128
2023-04-22 23:58:18,495 - Detection - eval_batch_size:	64
2023-04-22 23:58:18,495 - Detection - test_batch_size:	64
2023-04-22 23:58:18,495 - Detection - wait_patient:	10
2023-04-22 23:58:18,495 - Detection - ============================== End Params ==============================
2023-04-22 23:58:18,495 - Detection - Data and Model Preparation...
2023-04-22 23:58:18,496 - Detection - The number of known intents is 5
2023-04-22 23:58:18,496 - Detection - Lists of known labels are: ['bash', 'excel', 'svn', 'wordpress', 'osx']
2023-04-22 23:58:18,502 - Detection - Number of labeled training samples = 620
2023-04-22 23:58:18,502 - Detection - Number of unlabeled training samples = 2171
2023-04-22 23:58:18,505 - Detection - Number of evaluation samples = 374
2023-04-22 23:58:18,511 - Detection - Number of testing samples = 2905
2023-04-22 23:58:26,176 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-22 23:58:26,290 - Detection - Pre-training Begin...
2023-04-22 23:58:28,064 - Detection - ***** Epoch: 1: Eval results *****
2023-04-22 23:58:28,064 - Detection -   best_eval_score = 0
2023-04-22 23:58:28,064 - Detection -   eval_score = 10.23
2023-04-22 23:58:28,064 - Detection -   train_loss = 1.6177247524261475
2023-04-22 23:58:32,857 - Detection - ***** Epoch: 2: Eval results *****
2023-04-22 23:58:32,857 - Detection -   best_eval_score = 10.23
2023-04-22 23:58:32,858 - Detection -   eval_score = 8.75
2023-04-22 23:58:32,858 - Detection -   train_loss = 1.6082822799682617
2023-04-22 23:58:37,745 - Detection - ***** Epoch: 3: Eval results *****
2023-04-22 23:58:37,746 - Detection -   best_eval_score = 10.23
2023-04-22 23:58:37,746 - Detection -   eval_score = 15.39
2023-04-22 23:58:37,746 - Detection -   train_loss = 1.5758163213729859
2023-04-22 23:58:42,487 - Detection - ***** Epoch: 4: Eval results *****
2023-04-22 23:58:42,487 - Detection -   best_eval_score = 15.39
2023-04-22 23:58:42,487 - Detection -   eval_score = 33.75
2023-04-22 23:58:42,487 - Detection -   train_loss = 1.514140796661377
2023-04-22 23:58:47,225 - Detection - ***** Epoch: 5: Eval results *****
2023-04-22 23:58:47,225 - Detection -   best_eval_score = 33.75
2023-04-22 23:58:47,225 - Detection -   eval_score = 71.68
2023-04-22 23:58:47,226 - Detection -   train_loss = 1.359370183944702
2023-04-22 23:58:51,874 - Detection - ***** Epoch: 6: Eval results *****
2023-04-22 23:58:51,874 - Detection -   best_eval_score = 71.68
2023-04-22 23:58:51,874 - Detection -   eval_score = 84.96
2023-04-22 23:58:51,874 - Detection -   train_loss = 1.1164852380752563
2023-04-22 23:58:56,775 - Detection - ***** Epoch: 7: Eval results *****
2023-04-22 23:58:56,775 - Detection -   best_eval_score = 84.96
2023-04-22 23:58:56,775 - Detection -   eval_score = 82.05
2023-04-22 23:58:56,775 - Detection -   train_loss = 0.8579290747642517
2023-04-22 23:59:01,592 - Detection - ***** Epoch: 8: Eval results *****
2023-04-22 23:59:01,592 - Detection -   best_eval_score = 84.96
2023-04-22 23:59:01,592 - Detection -   eval_score = 88.28
2023-04-22 23:59:01,593 - Detection -   train_loss = 0.7041218280792236
2023-04-22 23:59:06,414 - Detection - ***** Epoch: 9: Eval results *****
2023-04-22 23:59:06,414 - Detection -   best_eval_score = 88.28
2023-04-22 23:59:06,414 - Detection -   eval_score = 87.09
2023-04-22 23:59:06,415 - Detection -   train_loss = 0.5953754425048828
2023-04-22 23:59:11,183 - Detection - ***** Epoch: 10: Eval results *****
2023-04-22 23:59:11,183 - Detection -   best_eval_score = 88.28
2023-04-22 23:59:11,183 - Detection -   eval_score = 89.52
2023-04-22 23:59:11,183 - Detection -   train_loss = 0.4997773230075836
2023-04-22 23:59:15,562 - Detection - ***** Epoch: 11: Eval results *****
2023-04-22 23:59:15,563 - Detection -   best_eval_score = 89.52
2023-04-22 23:59:15,563 - Detection -   eval_score = 88.95
2023-04-22 23:59:15,563 - Detection -   train_loss = 0.4050179600715637
2023-04-22 23:59:19,942 - Detection - ***** Epoch: 12: Eval results *****
2023-04-22 23:59:19,942 - Detection -   best_eval_score = 89.52
2023-04-22 23:59:19,942 - Detection -   eval_score = 88.15
2023-04-22 23:59:19,942 - Detection -   train_loss = 0.3827451586723328
2023-04-22 23:59:24,113 - Detection - ***** Epoch: 13: Eval results *****
2023-04-22 23:59:24,114 - Detection -   best_eval_score = 89.52
2023-04-22 23:59:24,114 - Detection -   eval_score = 89.75
2023-04-22 23:59:24,114 - Detection -   train_loss = 0.33872565627098083
2023-04-22 23:59:28,307 - Detection - ***** Epoch: 14: Eval results *****
2023-04-22 23:59:28,307 - Detection -   best_eval_score = 89.75
2023-04-22 23:59:28,307 - Detection -   eval_score = 88.66
2023-04-22 23:59:28,307 - Detection -   train_loss = 0.2903988003730774
2023-04-22 23:59:32,497 - Detection - ***** Epoch: 15: Eval results *****
2023-04-22 23:59:32,497 - Detection -   best_eval_score = 89.75
2023-04-22 23:59:32,497 - Detection -   eval_score = 88.91
2023-04-22 23:59:32,497 - Detection -   train_loss = 0.2626176685094833
2023-04-22 23:59:36,702 - Detection - ***** Epoch: 16: Eval results *****
2023-04-22 23:59:36,702 - Detection -   best_eval_score = 89.75
2023-04-22 23:59:36,702 - Detection -   eval_score = 89.71
2023-04-22 23:59:36,702 - Detection -   train_loss = 0.2476159006357193
2023-04-22 23:59:40,949 - Detection - ***** Epoch: 17: Eval results *****
2023-04-22 23:59:40,949 - Detection -   best_eval_score = 89.75
2023-04-22 23:59:40,949 - Detection -   eval_score = 88.94
2023-04-22 23:59:40,949 - Detection -   train_loss = 0.217370468378067
2023-04-22 23:59:45,148 - Detection - ***** Epoch: 18: Eval results *****
2023-04-22 23:59:45,148 - Detection -   best_eval_score = 89.75
2023-04-22 23:59:45,148 - Detection -   eval_score = 89.37
2023-04-22 23:59:45,148 - Detection -   train_loss = 0.1961781919002533
2023-04-22 23:59:49,335 - Detection - ***** Epoch: 19: Eval results *****
2023-04-22 23:59:49,335 - Detection -   best_eval_score = 89.75
2023-04-22 23:59:49,335 - Detection -   eval_score = 89.44
2023-04-22 23:59:49,335 - Detection -   train_loss = 0.19137128591537475
2023-04-22 23:59:53,517 - Detection - ***** Epoch: 20: Eval results *****
2023-04-22 23:59:53,517 - Detection -   best_eval_score = 89.75
2023-04-22 23:59:53,517 - Detection -   eval_score = 89.23
2023-04-22 23:59:53,518 - Detection -   train_loss = 0.1828606903553009
2023-04-22 23:59:57,702 - Detection - ***** Epoch: 21: Eval results *****
2023-04-22 23:59:57,702 - Detection -   best_eval_score = 89.75
2023-04-22 23:59:57,702 - Detection -   eval_score = 89.67
2023-04-22 23:59:57,703 - Detection -   train_loss = 0.17818233668804168
2023-04-23 00:00:01,934 - Detection - ***** Epoch: 22: Eval results *****
2023-04-23 00:00:01,934 - Detection -   best_eval_score = 89.75
2023-04-23 00:00:01,934 - Detection -   eval_score = 89.15
2023-04-23 00:00:01,934 - Detection -   train_loss = 0.1559515655040741
2023-04-23 00:00:06,240 - Detection - ***** Epoch: 23: Eval results *****
2023-04-23 00:00:06,240 - Detection -   best_eval_score = 89.75
2023-04-23 00:00:06,240 - Detection -   eval_score = 89.73
2023-04-23 00:00:06,240 - Detection -   train_loss = 0.15756080746650697
2023-04-23 00:00:06,240 - Detection - Pre-training finished...
2023-04-23 00:00:06,240 - Detection - Training Begin...
2023-04-23 00:00:06,885 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 00:00:06,885 - Detection -   best_eval_score = 0
2023-04-23 00:00:06,885 - Detection -   eval_score = 0.0
2023-04-23 00:00:06,885 - Detection -   train_loss = 4.781380367279053
2023-04-23 00:00:07,530 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 00:00:07,530 - Detection -   best_eval_score = 0
2023-04-23 00:00:07,530 - Detection -   eval_score = 0.41
2023-04-23 00:00:07,530 - Detection -   train_loss = 4.628831195831299
2023-04-23 00:00:11,318 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 00:00:11,318 - Detection -   best_eval_score = 0.41
2023-04-23 00:00:11,318 - Detection -   eval_score = 6.63
2023-04-23 00:00:11,318 - Detection -   train_loss = 4.44321575164795
2023-04-23 00:00:15,123 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 00:00:15,123 - Detection -   best_eval_score = 6.63
2023-04-23 00:00:15,123 - Detection -   eval_score = 26.49
2023-04-23 00:00:15,123 - Detection -   train_loss = 3.5589370727539062
2023-04-23 00:00:19,007 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 00:00:19,007 - Detection -   best_eval_score = 26.49
2023-04-23 00:00:19,007 - Detection -   eval_score = 41.61
2023-04-23 00:00:19,007 - Detection -   train_loss = 2.3853870391845704
2023-04-23 00:00:22,868 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 00:00:22,869 - Detection -   best_eval_score = 41.61
2023-04-23 00:00:22,869 - Detection -   eval_score = 61.58
2023-04-23 00:00:22,869 - Detection -   train_loss = 1.371134352684021
2023-04-23 00:00:26,829 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 00:00:26,829 - Detection -   best_eval_score = 61.58
2023-04-23 00:00:26,829 - Detection -   eval_score = 65.15
2023-04-23 00:00:26,829 - Detection -   train_loss = 1.1718091726303101
2023-04-23 00:00:30,620 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 00:00:30,620 - Detection -   best_eval_score = 65.15
2023-04-23 00:00:30,620 - Detection -   eval_score = 65.18
2023-04-23 00:00:30,620 - Detection -   train_loss = 1.143058443069458
2023-04-23 00:00:34,398 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 00:00:34,399 - Detection -   best_eval_score = 65.18
2023-04-23 00:00:34,399 - Detection -   eval_score = 64.75
2023-04-23 00:00:34,399 - Detection -   train_loss = 1.1389925003051757
2023-04-23 00:00:38,183 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 00:00:38,183 - Detection -   best_eval_score = 65.18
2023-04-23 00:00:38,183 - Detection -   eval_score = 65.58
2023-04-23 00:00:38,183 - Detection -   train_loss = 1.157195520401001
2023-04-23 00:00:41,966 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 00:00:41,966 - Detection -   best_eval_score = 65.58
2023-04-23 00:00:41,966 - Detection -   eval_score = 65.72
2023-04-23 00:00:41,966 - Detection -   train_loss = 1.115251064300537
2023-04-23 00:00:45,874 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 00:00:45,874 - Detection -   best_eval_score = 65.72
2023-04-23 00:00:45,874 - Detection -   eval_score = 64.53
2023-04-23 00:00:45,874 - Detection -   train_loss = 1.1457111597061158
2023-04-23 00:00:49,668 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 00:00:49,668 - Detection -   best_eval_score = 65.72
2023-04-23 00:00:49,668 - Detection -   eval_score = 64.61
2023-04-23 00:00:49,668 - Detection -   train_loss = 1.143748140335083
2023-04-23 00:00:53,470 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 00:00:53,470 - Detection -   best_eval_score = 65.72
2023-04-23 00:00:53,470 - Detection -   eval_score = 64.75
2023-04-23 00:00:53,470 - Detection -   train_loss = 1.1267132997512816
2023-04-23 00:00:57,277 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 00:00:57,277 - Detection -   best_eval_score = 65.72
2023-04-23 00:00:57,277 - Detection -   eval_score = 64.57
2023-04-23 00:00:57,277 - Detection -   train_loss = 1.1430045366287231
2023-04-23 00:01:01,067 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 00:01:01,067 - Detection -   best_eval_score = 65.72
2023-04-23 00:01:01,067 - Detection -   eval_score = 64.75
2023-04-23 00:01:01,068 - Detection -   train_loss = 1.163333010673523
2023-04-23 00:01:04,993 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 00:01:04,993 - Detection -   best_eval_score = 65.72
2023-04-23 00:01:04,993 - Detection -   eval_score = 64.79
2023-04-23 00:01:04,993 - Detection -   train_loss = 1.1230940341949462
2023-04-23 00:01:08,803 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 00:01:08,803 - Detection -   best_eval_score = 65.72
2023-04-23 00:01:08,804 - Detection -   eval_score = 64.97
2023-04-23 00:01:08,804 - Detection -   train_loss = 1.1522415637969972
2023-04-23 00:01:12,598 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 00:01:12,598 - Detection -   best_eval_score = 65.72
2023-04-23 00:01:12,598 - Detection -   eval_score = 63.75
2023-04-23 00:01:12,598 - Detection -   train_loss = 1.1547479510307312
2023-04-23 00:01:16,375 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 00:01:16,376 - Detection -   best_eval_score = 65.72
2023-04-23 00:01:16,376 - Detection -   eval_score = 65.29
2023-04-23 00:01:16,376 - Detection -   train_loss = 1.148076605796814
2023-04-23 00:01:20,188 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 00:01:20,188 - Detection -   best_eval_score = 65.72
2023-04-23 00:01:20,188 - Detection -   eval_score = 65.15
2023-04-23 00:01:20,188 - Detection -   train_loss = 1.152788519859314
2023-04-23 00:01:20,188 - Detection - Training Finished...
2023-04-23 00:01:20,188 - Detection - Testing begin...
2023-04-23 00:01:21,941 - Detection - ***** Test: Confusion Matrix *****
2023-04-23 00:01:21,941 - Detection - [[  86    2    0    1   25   25]
 [   0  100    0    0   17   23]
 [   0    0  107    0    9   33]
 [   0    0    0  110    8   19]
 [   0    1    2    0   56  134]
 [   3  184   56   10 1003  891]]
2023-04-23 00:01:21,941 - Detection - ***** Test results *****
2023-04-23 00:01:21,941 - Detection -   Acc = 46.47
2023-04-23 00:01:21,941 - Detection -   F1 = 56.4511
2023-04-23 00:01:21,941 - Detection -   F1-known = 56.8489
2023-04-23 00:01:21,941 - Detection -   F1-open = 54.4621
2023-04-23 00:01:21,941 - Detection - Testing finished...
2023-04-23 00:01:21,941 - Detection - Results saved in results/results_DA-ADB-BOOST-F-4.csv
2023-04-23 00:01:21,974 - Detection - Open Intent Detection Finished...
