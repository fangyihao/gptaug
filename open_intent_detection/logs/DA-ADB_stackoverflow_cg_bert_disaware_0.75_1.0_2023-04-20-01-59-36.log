2023-04-20 01:59:36,184 - Detection - Open Intent Detection Begin...
2023-04-20 01:59:36,185 - Detection - Parameters Initialization...
2023-04-20 01:59:36,185 - Detection - ============================== Params ==============================
2023-04-20 01:59:36,185 - Detection - type:	open_intent_detection
2023-04-20 01:59:36,185 - Detection - logger_name:	Detection
2023-04-20 01:59:36,185 - Detection - log_dir:	logs
2023-04-20 01:59:36,185 - Detection - dataset:	stackoverflow_cg
2023-04-20 01:59:36,185 - Detection - known_cls_ratio:	0.75
2023-04-20 01:59:36,185 - Detection - labeled_ratio:	1.0
2023-04-20 01:59:36,185 - Detection - method:	DA-ADB
2023-04-20 01:59:36,185 - Detection - train:	True
2023-04-20 01:59:36,185 - Detection - pretrain:	True
2023-04-20 01:59:36,185 - Detection - save_model:	True
2023-04-20 01:59:36,185 - Detection - backbone:	bert_disaware
2023-04-20 01:59:36,185 - Detection - config_file_name:	DA-ADB
2023-04-20 01:59:36,185 - Detection - seed:	3
2023-04-20 01:59:36,185 - Detection - gpu_id:	0
2023-04-20 01:59:36,185 - Detection - pipe_results_path:	pipe_results
2023-04-20 01:59:36,185 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-20 01:59:36,185 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-20 01:59:36,185 - Detection - model_dir:	models
2023-04-20 01:59:36,185 - Detection - load_pretrained_method:	None
2023-04-20 01:59:36,185 - Detection - result_dir:	results
2023-04-20 01:59:36,185 - Detection - results_file_name:	results_DA-ADB.csv
2023-04-20 01:59:36,185 - Detection - save_results:	True
2023-04-20 01:59:36,185 - Detection - loss_fct:	CrossEntropyLoss
2023-04-20 01:59:36,185 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.75_1.0_bert_disaware_3
2023-04-20 01:59:36,185 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.75_1.0_bert_disaware_3/models
2023-04-20 01:59:36,185 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-20 01:59:36,185 - Detection - num_train_epochs:	100
2023-04-20 01:59:36,185 - Detection - num_labels:	None
2023-04-20 01:59:36,185 - Detection - max_seq_length:	None
2023-04-20 01:59:36,185 - Detection - freeze_backbone_parameters:	True
2023-04-20 01:59:36,185 - Detection - feat_dim:	768
2023-04-20 01:59:36,185 - Detection - warmup_proportion:	0.1
2023-04-20 01:59:36,185 - Detection - scale:	4
2023-04-20 01:59:36,185 - Detection - lr_boundary:	0.05
2023-04-20 01:59:36,186 - Detection - lr:	2e-05
2023-04-20 01:59:36,186 - Detection - activation:	relu
2023-04-20 01:59:36,186 - Detection - train_batch_size:	128
2023-04-20 01:59:36,186 - Detection - eval_batch_size:	64
2023-04-20 01:59:36,186 - Detection - test_batch_size:	64
2023-04-20 01:59:36,186 - Detection - wait_patient:	10
2023-04-20 01:59:36,186 - Detection - ============================== End Params ==============================
2023-04-20 01:59:36,186 - Detection - Data and Model Preparation...
2023-04-20 01:59:36,186 - Detection - The number of known intents is 15
2023-04-20 01:59:36,186 - Detection - Lists of known labels are: ['scala', 'bash', 'apache', 'svn', 'drupal', 'spring', 'haskell', 'hibernate', 'sharepoint', 'osx', 'magento', 'oracle', 'wordpress', 'visual-studio', 'qt']
2023-04-20 01:59:36,211 - Detection - Number of labeled training samples = 5845
2023-04-20 01:59:36,211 - Detection - Number of unlabeled training samples = 1972
2023-04-20 01:59:36,215 - Detection - Number of evaluation samples = 1426
2023-04-20 01:59:36,225 - Detection - Number of testing samples = 5082
2023-04-20 01:59:43,287 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-20 01:59:43,369 - Detection - Pre-training Begin...
2023-04-20 01:59:55,069 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 01:59:55,070 - Detection -   best_eval_score = 0
2023-04-20 01:59:55,070 - Detection -   eval_score = 2.9
2023-04-20 01:59:55,070 - Detection -   train_loss = 2.7143811713094297
2023-04-20 02:00:06,325 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 02:00:06,325 - Detection -   best_eval_score = 2.9
2023-04-20 02:00:06,325 - Detection -   eval_score = 5.31
2023-04-20 02:00:06,325 - Detection -   train_loss = 2.7006104925404424
2023-04-20 02:00:17,647 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 02:00:17,647 - Detection -   best_eval_score = 5.31
2023-04-20 02:00:17,647 - Detection -   eval_score = 11.84
2023-04-20 02:00:17,647 - Detection -   train_loss = 2.6815923504207446
2023-04-20 02:00:29,009 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 02:00:29,009 - Detection -   best_eval_score = 11.84
2023-04-20 02:00:29,009 - Detection -   eval_score = 30.64
2023-04-20 02:00:29,009 - Detection -   train_loss = 2.6263077829195107
2023-04-20 02:00:40,413 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 02:00:40,413 - Detection -   best_eval_score = 30.64
2023-04-20 02:00:40,413 - Detection -   eval_score = 56.74
2023-04-20 02:00:40,413 - Detection -   train_loss = 2.437618400739587
2023-04-20 02:00:51,846 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 02:00:51,846 - Detection -   best_eval_score = 56.74
2023-04-20 02:00:51,846 - Detection -   eval_score = 80.44
2023-04-20 02:00:51,846 - Detection -   train_loss = 2.0348947100017383
2023-04-20 02:01:03,253 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 02:01:03,253 - Detection -   best_eval_score = 80.44
2023-04-20 02:01:03,253 - Detection -   eval_score = 83.38
2023-04-20 02:01:03,253 - Detection -   train_loss = 1.5374006084773852
2023-04-20 02:01:14,655 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 02:01:14,655 - Detection -   best_eval_score = 83.38
2023-04-20 02:01:14,655 - Detection -   eval_score = 85.21
2023-04-20 02:01:14,655 - Detection -   train_loss = 1.281824679478355
2023-04-20 02:01:26,057 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 02:01:26,057 - Detection -   best_eval_score = 85.21
2023-04-20 02:01:26,057 - Detection -   eval_score = 85.58
2023-04-20 02:01:26,057 - Detection -   train_loss = 1.1599608400593633
2023-04-20 02:01:37,552 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 02:01:37,553 - Detection -   best_eval_score = 85.58
2023-04-20 02:01:37,553 - Detection -   eval_score = 86.84
2023-04-20 02:01:37,553 - Detection -   train_loss = 1.0813888829687368
2023-04-20 02:01:48,934 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 02:01:48,934 - Detection -   best_eval_score = 86.84
2023-04-20 02:01:48,934 - Detection -   eval_score = 87.33
2023-04-20 02:01:48,934 - Detection -   train_loss = 1.014665601046189
2023-04-20 02:02:00,317 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 02:02:00,317 - Detection -   best_eval_score = 87.33
2023-04-20 02:02:00,317 - Detection -   eval_score = 87.64
2023-04-20 02:02:00,317 - Detection -   train_loss = 0.9649784681589707
2023-04-20 02:02:11,703 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 02:02:11,703 - Detection -   best_eval_score = 87.64
2023-04-20 02:02:11,703 - Detection -   eval_score = 87.74
2023-04-20 02:02:11,703 - Detection -   train_loss = 0.9286061473514723
2023-04-20 02:02:23,072 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 02:02:23,072 - Detection -   best_eval_score = 87.74
2023-04-20 02:02:23,072 - Detection -   eval_score = 87.94
2023-04-20 02:02:23,072 - Detection -   train_loss = 0.8914762981559919
2023-04-20 02:02:34,440 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 02:02:34,440 - Detection -   best_eval_score = 87.94
2023-04-20 02:02:34,440 - Detection -   eval_score = 88.06
2023-04-20 02:02:34,440 - Detection -   train_loss = 0.8605437706346097
2023-04-20 02:02:45,810 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 02:02:45,810 - Detection -   best_eval_score = 88.06
2023-04-20 02:02:45,810 - Detection -   eval_score = 88.36
2023-04-20 02:02:45,810 - Detection -   train_loss = 0.841642685558485
2023-04-20 02:02:57,180 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 02:02:57,180 - Detection -   best_eval_score = 88.36
2023-04-20 02:02:57,181 - Detection -   eval_score = 88.41
2023-04-20 02:02:57,181 - Detection -   train_loss = 0.8219365283198978
2023-04-20 02:03:08,549 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 02:03:08,549 - Detection -   best_eval_score = 88.41
2023-04-20 02:03:08,550 - Detection -   eval_score = 88.42
2023-04-20 02:03:08,550 - Detection -   train_loss = 0.793835655502651
2023-04-20 02:03:19,922 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 02:03:19,923 - Detection -   best_eval_score = 88.42
2023-04-20 02:03:19,923 - Detection -   eval_score = 88.85
2023-04-20 02:03:19,923 - Detection -   train_loss = 0.7806354100289552
2023-04-20 02:03:31,288 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 02:03:31,288 - Detection -   best_eval_score = 88.85
2023-04-20 02:03:31,288 - Detection -   eval_score = 89.0
2023-04-20 02:03:31,288 - Detection -   train_loss = 0.7587763926257258
2023-04-20 02:03:42,757 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 02:03:42,757 - Detection -   best_eval_score = 89.0
2023-04-20 02:03:42,757 - Detection -   eval_score = 89.15
2023-04-20 02:03:42,757 - Detection -   train_loss = 0.7473897985790087
2023-04-20 02:03:54,119 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 02:03:54,119 - Detection -   best_eval_score = 89.15
2023-04-20 02:03:54,119 - Detection -   eval_score = 89.15
2023-04-20 02:03:54,119 - Detection -   train_loss = 0.728906036719032
2023-04-20 02:04:05,468 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 02:04:05,468 - Detection -   best_eval_score = 89.15
2023-04-20 02:04:05,468 - Detection -   eval_score = 88.84
2023-04-20 02:04:05,468 - Detection -   train_loss = 0.7171311417351598
2023-04-20 02:04:16,821 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 02:04:16,821 - Detection -   best_eval_score = 89.15
2023-04-20 02:04:16,821 - Detection -   eval_score = 89.05
2023-04-20 02:04:16,821 - Detection -   train_loss = 0.7044121584166652
2023-04-20 02:04:28,174 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 02:04:28,174 - Detection -   best_eval_score = 89.15
2023-04-20 02:04:28,174 - Detection -   eval_score = 89.42
2023-04-20 02:04:28,174 - Detection -   train_loss = 0.6904911126779474
2023-04-20 02:04:39,539 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 02:04:39,539 - Detection -   best_eval_score = 89.42
2023-04-20 02:04:39,539 - Detection -   eval_score = 89.39
2023-04-20 02:04:39,539 - Detection -   train_loss = 0.6776572660259579
2023-04-20 02:04:50,894 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 02:04:50,894 - Detection -   best_eval_score = 89.42
2023-04-20 02:04:50,894 - Detection -   eval_score = 89.8
2023-04-20 02:04:50,894 - Detection -   train_loss = 0.6673996098663496
2023-04-20 02:05:02,261 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 02:05:02,261 - Detection -   best_eval_score = 89.8
2023-04-20 02:05:02,261 - Detection -   eval_score = 89.31
2023-04-20 02:05:02,261 - Detection -   train_loss = 0.6574792460255001
2023-04-20 02:05:13,607 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 02:05:13,607 - Detection -   best_eval_score = 89.8
2023-04-20 02:05:13,607 - Detection -   eval_score = 89.29
2023-04-20 02:05:13,607 - Detection -   train_loss = 0.6454682350158691
2023-04-20 02:05:24,952 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 02:05:24,952 - Detection -   best_eval_score = 89.8
2023-04-20 02:05:24,952 - Detection -   eval_score = 89.46
2023-04-20 02:05:24,952 - Detection -   train_loss = 0.6396691850993944
2023-04-20 02:05:36,303 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 02:05:36,303 - Detection -   best_eval_score = 89.8
2023-04-20 02:05:36,303 - Detection -   eval_score = 89.4
2023-04-20 02:05:36,303 - Detection -   train_loss = 0.6312572463699009
2023-04-20 02:05:47,653 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 02:05:47,653 - Detection -   best_eval_score = 89.8
2023-04-20 02:05:47,653 - Detection -   eval_score = 89.42
2023-04-20 02:05:47,653 - Detection -   train_loss = 0.6198489938093268
2023-04-20 02:05:59,005 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 02:05:59,005 - Detection -   best_eval_score = 89.8
2023-04-20 02:05:59,005 - Detection -   eval_score = 89.54
2023-04-20 02:05:59,005 - Detection -   train_loss = 0.6114998628263888
2023-04-20 02:06:10,355 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 02:06:10,355 - Detection -   best_eval_score = 89.8
2023-04-20 02:06:10,356 - Detection -   eval_score = 89.61
2023-04-20 02:06:10,356 - Detection -   train_loss = 0.6063983634762142
2023-04-20 02:06:21,810 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 02:06:21,810 - Detection -   best_eval_score = 89.8
2023-04-20 02:06:21,810 - Detection -   eval_score = 89.42
2023-04-20 02:06:21,810 - Detection -   train_loss = 0.5928618363712145
2023-04-20 02:06:33,159 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 02:06:33,159 - Detection -   best_eval_score = 89.8
2023-04-20 02:06:33,159 - Detection -   eval_score = 89.45
2023-04-20 02:06:33,159 - Detection -   train_loss = 0.5885245262280755
2023-04-20 02:06:44,505 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 02:06:44,506 - Detection -   best_eval_score = 89.8
2023-04-20 02:06:44,506 - Detection -   eval_score = 89.27
2023-04-20 02:06:44,506 - Detection -   train_loss = 0.586182771169621
2023-04-20 02:06:44,506 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.75_1.0_bert_disaware_3/models
2023-04-20 02:06:45,059 - Detection - Pre-training finished...
2023-04-20 02:06:45,060 - Detection - Training Begin...
2023-04-20 02:06:51,607 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 02:06:51,607 - Detection -   best_eval_score = 0
2023-04-20 02:06:51,608 - Detection -   eval_score = 29.33
2023-04-20 02:06:51,608 - Detection -   train_loss = 4.088435530662537
2023-04-20 02:06:58,157 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 02:06:58,158 - Detection -   best_eval_score = 29.33
2023-04-20 02:06:58,158 - Detection -   eval_score = 79.8
2023-04-20 02:06:58,158 - Detection -   train_loss = 2.1414083916208018
2023-04-20 02:07:04,713 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 02:07:04,714 - Detection -   best_eval_score = 79.8
2023-04-20 02:07:04,714 - Detection -   eval_score = 82.83
2023-04-20 02:07:04,714 - Detection -   train_loss = 1.2751265258892723
2023-04-20 02:07:11,273 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 02:07:11,273 - Detection -   best_eval_score = 82.83
2023-04-20 02:07:11,273 - Detection -   eval_score = 82.77
2023-04-20 02:07:11,273 - Detection -   train_loss = 1.2513957516006802
2023-04-20 02:07:17,828 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 02:07:17,828 - Detection -   best_eval_score = 82.83
2023-04-20 02:07:17,828 - Detection -   eval_score = 82.78
2023-04-20 02:07:17,828 - Detection -   train_loss = 1.2488870646642602
2023-04-20 02:07:24,383 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 02:07:24,383 - Detection -   best_eval_score = 82.83
2023-04-20 02:07:24,383 - Detection -   eval_score = 82.78
2023-04-20 02:07:24,383 - Detection -   train_loss = 1.2520933928697005
2023-04-20 02:07:30,941 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 02:07:30,941 - Detection -   best_eval_score = 82.83
2023-04-20 02:07:30,941 - Detection -   eval_score = 82.76
2023-04-20 02:07:30,941 - Detection -   train_loss = 1.2439846357573634
2023-04-20 02:07:37,500 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 02:07:37,500 - Detection -   best_eval_score = 82.83
2023-04-20 02:07:37,500 - Detection -   eval_score = 82.78
2023-04-20 02:07:37,500 - Detection -   train_loss = 1.2472455955069999
2023-04-20 02:07:44,063 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 02:07:44,063 - Detection -   best_eval_score = 82.83
2023-04-20 02:07:44,063 - Detection -   eval_score = 82.77
2023-04-20 02:07:44,063 - Detection -   train_loss = 1.2532634398211604
2023-04-20 02:07:50,623 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 02:07:50,623 - Detection -   best_eval_score = 82.83
2023-04-20 02:07:50,623 - Detection -   eval_score = 82.71
2023-04-20 02:07:50,623 - Detection -   train_loss = 1.2481660998385886
2023-04-20 02:07:57,182 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 02:07:57,182 - Detection -   best_eval_score = 82.83
2023-04-20 02:07:57,182 - Detection -   eval_score = 82.58
2023-04-20 02:07:57,182 - Detection -   train_loss = 1.2500239843907563
2023-04-20 02:08:03,744 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 02:08:03,744 - Detection -   best_eval_score = 82.83
2023-04-20 02:08:03,744 - Detection -   eval_score = 82.66
2023-04-20 02:08:03,745 - Detection -   train_loss = 1.244822391997213
2023-04-20 02:08:10,304 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 02:08:10,304 - Detection -   best_eval_score = 82.83
2023-04-20 02:08:10,304 - Detection -   eval_score = 82.79
2023-04-20 02:08:10,304 - Detection -   train_loss = 1.2409675795099009
2023-04-20 02:08:10,305 - Detection - Training Finished...
2023-04-20 02:08:10,305 - Detection - Testing begin...
2023-04-20 02:08:14,526 - Detection - ***** Test: Confusion Matrix *****
2023-04-20 02:08:14,526 - Detection - [[ 201    0    0    0    0    0    0    0    0    1    0    0    0    1
     0   58]
 [   0  184    0    0    0    0    0    0    0    3    0    0    0    0
     0   69]
 [   0    0  173    1    0    0    0    0    0    0    0    0    1    0
     0   70]
 [   0    0    0  218    0    0    0    0    0    0    0    0    0    2
     0   53]
 [   0    0    2    0  197    0    0    0    0    0    0    0    0    0
     0   38]
 [   0    0    0    0    0  177    0    1    1    1    0    0    0    0
     0   66]
 [   0    0    0    0    0    0  206    0    0    0    0    0    0    0
     0   63]
 [   0    0    0    0    0    1    0  206    0    0    0    3    0    0
     0   48]
 [   0    0    0    0    0    0    0    0  205    0    0    0    0    3
     0   54]
 [   0    0    1    1    0    0    0    0    0  210    0    0    0    0
     3   68]
 [   0    0    0    0    0    0    0    0    0    0  211    0    0    0
     1   34]
 [   0    0    0    0    0    0    0    0    0    0    0  212    0    1
     0   50]
 [   0    0    1    0    0    0    0    0    0    0    0    0  202    0
     0   39]
 [   0    0    1    0    0    0    1    0    1    3    0    0    0  162
     0   57]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
   243   20]
 [   1    1   10    0    0    0    5    1    2  126    0   12    1    6
     3 1085]]
2023-04-20 02:08:14,526 - Detection - ***** Test results *****
2023-04-20 02:08:14,526 - Detection -   Acc = 80.52
2023-04-20 02:08:14,526 - Detection -   F1 = 84.7265
2023-04-20 02:08:14,526 - Detection -   F1-known = 85.7456
2023-04-20 02:08:14,526 - Detection -   F1-open = 69.44
2023-04-20 02:08:14,526 - Detection - Testing finished...
2023-04-20 02:08:14,526 - Detection - Results saved in results/results_DA-ADB.csv
2023-04-20 02:08:14,546 - Detection - Open Intent Detection Finished...
