2023-04-19 21:19:21,769 - Detection - Open Intent Detection Begin...
2023-04-19 21:19:21,769 - Detection - Parameters Initialization...
2023-04-19 21:19:21,769 - Detection - ============================== Params ==============================
2023-04-19 21:19:21,769 - Detection - type:	open_intent_detection
2023-04-19 21:19:21,769 - Detection - logger_name:	Detection
2023-04-19 21:19:21,769 - Detection - log_dir:	logs
2023-04-19 21:19:21,769 - Detection - dataset:	oos_cg
2023-04-19 21:19:21,769 - Detection - known_cls_ratio:	0.25
2023-04-19 21:19:21,769 - Detection - labeled_ratio:	1.0
2023-04-19 21:19:21,769 - Detection - method:	DA-ADB
2023-04-19 21:19:21,769 - Detection - train:	True
2023-04-19 21:19:21,769 - Detection - pretrain:	True
2023-04-19 21:19:21,769 - Detection - save_model:	True
2023-04-19 21:19:21,769 - Detection - backbone:	bert_disaware
2023-04-19 21:19:21,769 - Detection - config_file_name:	DA-ADB
2023-04-19 21:19:21,769 - Detection - seed:	2
2023-04-19 21:19:21,769 - Detection - gpu_id:	0
2023-04-19 21:19:21,769 - Detection - pipe_results_path:	pipe_results
2023-04-19 21:19:21,770 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-19 21:19:21,770 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-19 21:19:21,770 - Detection - model_dir:	models
2023-04-19 21:19:21,770 - Detection - load_pretrained_method:	None
2023-04-19 21:19:21,770 - Detection - result_dir:	results
2023-04-19 21:19:21,770 - Detection - results_file_name:	results_DA-ADB.csv
2023-04-19 21:19:21,770 - Detection - save_results:	True
2023-04-19 21:19:21,770 - Detection - loss_fct:	CrossEntropyLoss
2023-04-19 21:19:21,770 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_oos_cg_0.25_1.0_bert_disaware_2
2023-04-19 21:19:21,770 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_oos_cg_0.25_1.0_bert_disaware_2/models
2023-04-19 21:19:21,770 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-19 21:19:21,770 - Detection - num_train_epochs:	100
2023-04-19 21:19:21,770 - Detection - num_labels:	None
2023-04-19 21:19:21,770 - Detection - max_seq_length:	None
2023-04-19 21:19:21,770 - Detection - freeze_backbone_parameters:	True
2023-04-19 21:19:21,770 - Detection - feat_dim:	768
2023-04-19 21:19:21,770 - Detection - warmup_proportion:	0.1
2023-04-19 21:19:21,770 - Detection - scale:	4
2023-04-19 21:19:21,770 - Detection - lr_boundary:	0.05
2023-04-19 21:19:21,770 - Detection - lr:	2e-05
2023-04-19 21:19:21,770 - Detection - activation:	relu
2023-04-19 21:19:21,770 - Detection - train_batch_size:	128
2023-04-19 21:19:21,770 - Detection - eval_batch_size:	64
2023-04-19 21:19:21,770 - Detection - test_batch_size:	64
2023-04-19 21:19:21,770 - Detection - wait_patient:	10
2023-04-19 21:19:21,770 - Detection - ============================== End Params ==============================
2023-04-19 21:19:21,770 - Detection - Data and Model Preparation...
2023-04-19 21:19:21,770 - Detection - The number of known intents is 38
2023-04-19 21:19:21,771 - Detection - Lists of known labels are: ['balance', 'application_status', 'smart_home', 'calendar', 'change_user_name', 'transactions', 'change_volume', 'schedule_maintenance', 'traffic', 'freeze_account', 'gas_type', 'flight_status', 'direct_deposit', 'are_you_a_bot', 'pin_change', 'income', 'find_phone', 'repeat', 'what_song', 'pto_request', 'nutrition_info', 'next_holiday', 'spending_history', 'reminder', 'plug_type', 'credit_limit_change', 'alarm', 'todo_list_update', 'food_last', 'tire_pressure', 'todo_list', 'change_speed', 'lost_luggage', 'taxes', 'payday', 'calories', 'travel_alert', 'pto_used']
2023-04-19 21:19:21,780 - Detection - Number of labeled training samples = 924
2023-04-19 21:19:21,780 - Detection - Number of unlabeled training samples = 2759
2023-04-19 21:19:21,784 - Detection - Number of evaluation samples = 417
2023-04-19 21:19:21,791 - Detection - Number of testing samples = 3632
2023-04-19 21:19:27,643 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-19 21:19:27,725 - Detection - Pre-training Begin...
2023-04-19 21:19:29,596 - Detection - ***** Epoch: 1: Eval results *****
2023-04-19 21:19:29,597 - Detection -   best_eval_score = 0
2023-04-19 21:19:29,597 - Detection -   eval_score = 0.17
2023-04-19 21:19:29,597 - Detection -   train_loss = 3.6520496606826782
2023-04-19 21:19:30,972 - Detection - ***** Epoch: 2: Eval results *****
2023-04-19 21:19:30,973 - Detection -   best_eval_score = 0.17
2023-04-19 21:19:30,973 - Detection -   eval_score = 0.17
2023-04-19 21:19:30,973 - Detection -   train_loss = 3.6294566094875336
2023-04-19 21:19:32,338 - Detection - ***** Epoch: 3: Eval results *****
2023-04-19 21:19:32,338 - Detection -   best_eval_score = 0.17
2023-04-19 21:19:32,338 - Detection -   eval_score = 0.51
2023-04-19 21:19:32,338 - Detection -   train_loss = 3.585068494081497
2023-04-19 21:19:33,714 - Detection - ***** Epoch: 4: Eval results *****
2023-04-19 21:19:33,714 - Detection -   best_eval_score = 0.51
2023-04-19 21:19:33,714 - Detection -   eval_score = 0.81
2023-04-19 21:19:33,714 - Detection -   train_loss = 3.5265313386917114
2023-04-19 21:19:35,092 - Detection - ***** Epoch: 5: Eval results *****
2023-04-19 21:19:35,092 - Detection -   best_eval_score = 0.81
2023-04-19 21:19:35,092 - Detection -   eval_score = 0.78
2023-04-19 21:19:35,092 - Detection -   train_loss = 3.491058886051178
2023-04-19 21:19:36,458 - Detection - ***** Epoch: 6: Eval results *****
2023-04-19 21:19:36,458 - Detection -   best_eval_score = 0.81
2023-04-19 21:19:36,459 - Detection -   eval_score = 2.31
2023-04-19 21:19:36,459 - Detection -   train_loss = 3.4498997032642365
2023-04-19 21:19:37,838 - Detection - ***** Epoch: 7: Eval results *****
2023-04-19 21:19:37,838 - Detection -   best_eval_score = 2.31
2023-04-19 21:19:37,838 - Detection -   eval_score = 3.76
2023-04-19 21:19:37,838 - Detection -   train_loss = 3.354384332895279
2023-04-19 21:19:39,218 - Detection - ***** Epoch: 8: Eval results *****
2023-04-19 21:19:39,218 - Detection -   best_eval_score = 3.76
2023-04-19 21:19:39,218 - Detection -   eval_score = 4.48
2023-04-19 21:19:39,218 - Detection -   train_loss = 3.2569375336170197
2023-04-19 21:19:40,704 - Detection - ***** Epoch: 9: Eval results *****
2023-04-19 21:19:40,704 - Detection -   best_eval_score = 4.48
2023-04-19 21:19:40,704 - Detection -   eval_score = 7.49
2023-04-19 21:19:40,704 - Detection -   train_loss = 3.0997487604618073
2023-04-19 21:19:42,088 - Detection - ***** Epoch: 10: Eval results *****
2023-04-19 21:19:42,088 - Detection -   best_eval_score = 7.49
2023-04-19 21:19:42,088 - Detection -   eval_score = 12.8
2023-04-19 21:19:42,088 - Detection -   train_loss = 2.9306488037109375
2023-04-19 21:19:43,472 - Detection - ***** Epoch: 11: Eval results *****
2023-04-19 21:19:43,472 - Detection -   best_eval_score = 12.8
2023-04-19 21:19:43,472 - Detection -   eval_score = 17.1
2023-04-19 21:19:43,472 - Detection -   train_loss = 2.772526979446411
2023-04-19 21:19:44,856 - Detection - ***** Epoch: 12: Eval results *****
2023-04-19 21:19:44,856 - Detection -   best_eval_score = 17.1
2023-04-19 21:19:44,856 - Detection -   eval_score = 22.12
2023-04-19 21:19:44,856 - Detection -   train_loss = 2.5623999536037445
2023-04-19 21:19:46,241 - Detection - ***** Epoch: 13: Eval results *****
2023-04-19 21:19:46,241 - Detection -   best_eval_score = 22.12
2023-04-19 21:19:46,241 - Detection -   eval_score = 24.86
2023-04-19 21:19:46,241 - Detection -   train_loss = 2.3918025195598602
2023-04-19 21:19:47,625 - Detection - ***** Epoch: 14: Eval results *****
2023-04-19 21:19:47,625 - Detection -   best_eval_score = 24.86
2023-04-19 21:19:47,625 - Detection -   eval_score = 32.38
2023-04-19 21:19:47,625 - Detection -   train_loss = 2.2568488717079163
2023-04-19 21:19:49,011 - Detection - ***** Epoch: 15: Eval results *****
2023-04-19 21:19:49,012 - Detection -   best_eval_score = 32.38
2023-04-19 21:19:49,012 - Detection -   eval_score = 35.98
2023-04-19 21:19:49,012 - Detection -   train_loss = 2.13961198925972
2023-04-19 21:19:50,398 - Detection - ***** Epoch: 16: Eval results *****
2023-04-19 21:19:50,398 - Detection -   best_eval_score = 35.98
2023-04-19 21:19:50,398 - Detection -   eval_score = 40.37
2023-04-19 21:19:50,398 - Detection -   train_loss = 2.032541424036026
2023-04-19 21:19:51,784 - Detection - ***** Epoch: 17: Eval results *****
2023-04-19 21:19:51,784 - Detection -   best_eval_score = 40.37
2023-04-19 21:19:51,784 - Detection -   eval_score = 43.12
2023-04-19 21:19:51,784 - Detection -   train_loss = 1.9457171112298965
2023-04-19 21:19:53,172 - Detection - ***** Epoch: 18: Eval results *****
2023-04-19 21:19:53,172 - Detection -   best_eval_score = 43.12
2023-04-19 21:19:53,172 - Detection -   eval_score = 45.69
2023-04-19 21:19:53,172 - Detection -   train_loss = 1.8859790563583374
2023-04-19 21:19:54,559 - Detection - ***** Epoch: 19: Eval results *****
2023-04-19 21:19:54,559 - Detection -   best_eval_score = 45.69
2023-04-19 21:19:54,559 - Detection -   eval_score = 48.43
2023-04-19 21:19:54,559 - Detection -   train_loss = 1.8086603879928589
2023-04-19 21:19:55,950 - Detection - ***** Epoch: 20: Eval results *****
2023-04-19 21:19:55,950 - Detection -   best_eval_score = 48.43
2023-04-19 21:19:55,950 - Detection -   eval_score = 50.76
2023-04-19 21:19:55,950 - Detection -   train_loss = 1.7559319287538528
2023-04-19 21:19:57,339 - Detection - ***** Epoch: 21: Eval results *****
2023-04-19 21:19:57,339 - Detection -   best_eval_score = 50.76
2023-04-19 21:19:57,339 - Detection -   eval_score = 52.36
2023-04-19 21:19:57,339 - Detection -   train_loss = 1.7036166489124298
2023-04-19 21:19:58,728 - Detection - ***** Epoch: 22: Eval results *****
2023-04-19 21:19:58,728 - Detection -   best_eval_score = 52.36
2023-04-19 21:19:58,728 - Detection -   eval_score = 55.11
2023-04-19 21:19:58,728 - Detection -   train_loss = 1.6811410188674927
2023-04-19 21:20:00,118 - Detection - ***** Epoch: 23: Eval results *****
2023-04-19 21:20:00,118 - Detection -   best_eval_score = 55.11
2023-04-19 21:20:00,118 - Detection -   eval_score = 56.37
2023-04-19 21:20:00,118 - Detection -   train_loss = 1.6262434273958206
2023-04-19 21:20:01,508 - Detection - ***** Epoch: 24: Eval results *****
2023-04-19 21:20:01,508 - Detection -   best_eval_score = 56.37
2023-04-19 21:20:01,508 - Detection -   eval_score = 58.47
2023-04-19 21:20:01,508 - Detection -   train_loss = 1.5906358510255814
2023-04-19 21:20:02,901 - Detection - ***** Epoch: 25: Eval results *****
2023-04-19 21:20:02,901 - Detection -   best_eval_score = 58.47
2023-04-19 21:20:02,901 - Detection -   eval_score = 60.2
2023-04-19 21:20:02,901 - Detection -   train_loss = 1.5749147087335587
2023-04-19 21:20:04,297 - Detection - ***** Epoch: 26: Eval results *****
2023-04-19 21:20:04,297 - Detection -   best_eval_score = 60.2
2023-04-19 21:20:04,297 - Detection -   eval_score = 62.28
2023-04-19 21:20:04,297 - Detection -   train_loss = 1.5580241978168488
2023-04-19 21:20:05,689 - Detection - ***** Epoch: 27: Eval results *****
2023-04-19 21:20:05,689 - Detection -   best_eval_score = 62.28
2023-04-19 21:20:05,690 - Detection -   eval_score = 63.02
2023-04-19 21:20:05,690 - Detection -   train_loss = 1.5060631930828094
2023-04-19 21:20:07,084 - Detection - ***** Epoch: 28: Eval results *****
2023-04-19 21:20:07,084 - Detection -   best_eval_score = 63.02
2023-04-19 21:20:07,084 - Detection -   eval_score = 65.12
2023-04-19 21:20:07,084 - Detection -   train_loss = 1.4924830496311188
2023-04-19 21:20:08,480 - Detection - ***** Epoch: 29: Eval results *****
2023-04-19 21:20:08,480 - Detection -   best_eval_score = 65.12
2023-04-19 21:20:08,480 - Detection -   eval_score = 66.04
2023-04-19 21:20:08,480 - Detection -   train_loss = 1.4679659754037857
2023-04-19 21:20:09,878 - Detection - ***** Epoch: 30: Eval results *****
2023-04-19 21:20:09,878 - Detection -   best_eval_score = 66.04
2023-04-19 21:20:09,878 - Detection -   eval_score = 65.47
2023-04-19 21:20:09,878 - Detection -   train_loss = 1.44107486307621
2023-04-19 21:20:11,264 - Detection - ***** Epoch: 31: Eval results *****
2023-04-19 21:20:11,264 - Detection -   best_eval_score = 66.04
2023-04-19 21:20:11,264 - Detection -   eval_score = 66.94
2023-04-19 21:20:11,264 - Detection -   train_loss = 1.410021424293518
2023-04-19 21:20:12,762 - Detection - ***** Epoch: 32: Eval results *****
2023-04-19 21:20:12,762 - Detection -   best_eval_score = 66.94
2023-04-19 21:20:12,762 - Detection -   eval_score = 66.37
2023-04-19 21:20:12,762 - Detection -   train_loss = 1.4174588918685913
2023-04-19 21:20:14,152 - Detection - ***** Epoch: 33: Eval results *****
2023-04-19 21:20:14,152 - Detection -   best_eval_score = 66.94
2023-04-19 21:20:14,152 - Detection -   eval_score = 67.92
2023-04-19 21:20:14,152 - Detection -   train_loss = 1.3920021802186966
2023-04-19 21:20:15,552 - Detection - ***** Epoch: 34: Eval results *****
2023-04-19 21:20:15,552 - Detection -   best_eval_score = 67.92
2023-04-19 21:20:15,552 - Detection -   eval_score = 67.64
2023-04-19 21:20:15,552 - Detection -   train_loss = 1.3863576501607895
2023-04-19 21:20:16,938 - Detection - ***** Epoch: 35: Eval results *****
2023-04-19 21:20:16,938 - Detection -   best_eval_score = 67.92
2023-04-19 21:20:16,938 - Detection -   eval_score = 68.8
2023-04-19 21:20:16,938 - Detection -   train_loss = 1.3528423756361008
2023-04-19 21:20:18,336 - Detection - ***** Epoch: 36: Eval results *****
2023-04-19 21:20:18,336 - Detection -   best_eval_score = 68.8
2023-04-19 21:20:18,336 - Detection -   eval_score = 69.58
2023-04-19 21:20:18,336 - Detection -   train_loss = 1.3543665558099747
2023-04-19 21:20:19,734 - Detection - ***** Epoch: 37: Eval results *****
2023-04-19 21:20:19,734 - Detection -   best_eval_score = 69.58
2023-04-19 21:20:19,734 - Detection -   eval_score = 69.99
2023-04-19 21:20:19,734 - Detection -   train_loss = 1.3312760889530182
2023-04-19 21:20:21,133 - Detection - ***** Epoch: 38: Eval results *****
2023-04-19 21:20:21,133 - Detection -   best_eval_score = 69.99
2023-04-19 21:20:21,133 - Detection -   eval_score = 70.13
2023-04-19 21:20:21,133 - Detection -   train_loss = 1.3145797103643417
2023-04-19 21:20:22,536 - Detection - ***** Epoch: 39: Eval results *****
2023-04-19 21:20:22,536 - Detection -   best_eval_score = 70.13
2023-04-19 21:20:22,536 - Detection -   eval_score = 70.19
2023-04-19 21:20:22,536 - Detection -   train_loss = 1.3135016709566116
2023-04-19 21:20:23,938 - Detection - ***** Epoch: 40: Eval results *****
2023-04-19 21:20:23,939 - Detection -   best_eval_score = 70.19
2023-04-19 21:20:23,939 - Detection -   eval_score = 70.59
2023-04-19 21:20:23,939 - Detection -   train_loss = 1.2964649200439453
2023-04-19 21:20:25,340 - Detection - ***** Epoch: 41: Eval results *****
2023-04-19 21:20:25,340 - Detection -   best_eval_score = 70.59
2023-04-19 21:20:25,340 - Detection -   eval_score = 71.56
2023-04-19 21:20:25,340 - Detection -   train_loss = 1.3009954988956451
2023-04-19 21:20:26,742 - Detection - ***** Epoch: 42: Eval results *****
2023-04-19 21:20:26,742 - Detection -   best_eval_score = 71.56
2023-04-19 21:20:26,742 - Detection -   eval_score = 71.39
2023-04-19 21:20:26,742 - Detection -   train_loss = 1.300394594669342
2023-04-19 21:20:28,132 - Detection - ***** Epoch: 43: Eval results *****
2023-04-19 21:20:28,133 - Detection -   best_eval_score = 71.56
2023-04-19 21:20:28,133 - Detection -   eval_score = 71.97
2023-04-19 21:20:28,133 - Detection -   train_loss = 1.2844726145267487
2023-04-19 21:20:29,535 - Detection - ***** Epoch: 44: Eval results *****
2023-04-19 21:20:29,535 - Detection -   best_eval_score = 71.97
2023-04-19 21:20:29,535 - Detection -   eval_score = 69.9
2023-04-19 21:20:29,535 - Detection -   train_loss = 1.2622807174921036
2023-04-19 21:20:30,928 - Detection - ***** Epoch: 45: Eval results *****
2023-04-19 21:20:30,928 - Detection -   best_eval_score = 71.97
2023-04-19 21:20:30,928 - Detection -   eval_score = 70.05
2023-04-19 21:20:30,928 - Detection -   train_loss = 1.2654803693294525
2023-04-19 21:20:32,318 - Detection - ***** Epoch: 46: Eval results *****
2023-04-19 21:20:32,319 - Detection -   best_eval_score = 71.97
2023-04-19 21:20:32,319 - Detection -   eval_score = 72.31
2023-04-19 21:20:32,319 - Detection -   train_loss = 1.2498514503240585
2023-04-19 21:20:33,721 - Detection - ***** Epoch: 47: Eval results *****
2023-04-19 21:20:33,721 - Detection -   best_eval_score = 72.31
2023-04-19 21:20:33,721 - Detection -   eval_score = 72.44
2023-04-19 21:20:33,722 - Detection -   train_loss = 1.2428154349327087
2023-04-19 21:20:35,125 - Detection - ***** Epoch: 48: Eval results *****
2023-04-19 21:20:35,125 - Detection -   best_eval_score = 72.44
2023-04-19 21:20:35,125 - Detection -   eval_score = 71.58
2023-04-19 21:20:35,125 - Detection -   train_loss = 1.2463767528533936
2023-04-19 21:20:36,519 - Detection - ***** Epoch: 49: Eval results *****
2023-04-19 21:20:36,519 - Detection -   best_eval_score = 72.44
2023-04-19 21:20:36,519 - Detection -   eval_score = 73.12
2023-04-19 21:20:36,519 - Detection -   train_loss = 1.2419449985027313
2023-04-19 21:20:37,922 - Detection - ***** Epoch: 50: Eval results *****
2023-04-19 21:20:37,922 - Detection -   best_eval_score = 73.12
2023-04-19 21:20:37,922 - Detection -   eval_score = 72.28
2023-04-19 21:20:37,922 - Detection -   train_loss = 1.2337476760149002
2023-04-19 21:20:39,316 - Detection - ***** Epoch: 51: Eval results *****
2023-04-19 21:20:39,316 - Detection -   best_eval_score = 73.12
2023-04-19 21:20:39,317 - Detection -   eval_score = 72.72
2023-04-19 21:20:39,317 - Detection -   train_loss = 1.223736748099327
2023-04-19 21:20:40,706 - Detection - ***** Epoch: 52: Eval results *****
2023-04-19 21:20:40,706 - Detection -   best_eval_score = 73.12
2023-04-19 21:20:40,706 - Detection -   eval_score = 73.92
2023-04-19 21:20:40,706 - Detection -   train_loss = 1.210415780544281
2023-04-19 21:20:42,109 - Detection - ***** Epoch: 53: Eval results *****
2023-04-19 21:20:42,109 - Detection -   best_eval_score = 73.92
2023-04-19 21:20:42,109 - Detection -   eval_score = 73.24
2023-04-19 21:20:42,109 - Detection -   train_loss = 1.2265672832727432
2023-04-19 21:20:43,499 - Detection - ***** Epoch: 54: Eval results *****
2023-04-19 21:20:43,499 - Detection -   best_eval_score = 73.92
2023-04-19 21:20:43,499 - Detection -   eval_score = 73.45
2023-04-19 21:20:43,499 - Detection -   train_loss = 1.2046576142311096
2023-04-19 21:20:44,888 - Detection - ***** Epoch: 55: Eval results *****
2023-04-19 21:20:44,888 - Detection -   best_eval_score = 73.92
2023-04-19 21:20:44,888 - Detection -   eval_score = 73.28
2023-04-19 21:20:44,888 - Detection -   train_loss = 1.210282415151596
2023-04-19 21:20:46,279 - Detection - ***** Epoch: 56: Eval results *****
2023-04-19 21:20:46,279 - Detection -   best_eval_score = 73.92
2023-04-19 21:20:46,279 - Detection -   eval_score = 73.87
2023-04-19 21:20:46,279 - Detection -   train_loss = 1.1808545142412186
2023-04-19 21:20:47,669 - Detection - ***** Epoch: 57: Eval results *****
2023-04-19 21:20:47,669 - Detection -   best_eval_score = 73.92
2023-04-19 21:20:47,669 - Detection -   eval_score = 73.43
2023-04-19 21:20:47,669 - Detection -   train_loss = 1.182292863726616
2023-04-19 21:20:49,059 - Detection - ***** Epoch: 58: Eval results *****
2023-04-19 21:20:49,059 - Detection -   best_eval_score = 73.92
2023-04-19 21:20:49,059 - Detection -   eval_score = 73.87
2023-04-19 21:20:49,059 - Detection -   train_loss = 1.1893597543239594
2023-04-19 21:20:50,449 - Detection - ***** Epoch: 59: Eval results *****
2023-04-19 21:20:50,449 - Detection -   best_eval_score = 73.92
2023-04-19 21:20:50,449 - Detection -   eval_score = 73.28
2023-04-19 21:20:50,449 - Detection -   train_loss = 1.1833010613918304
2023-04-19 21:20:51,837 - Detection - ***** Epoch: 60: Eval results *****
2023-04-19 21:20:51,837 - Detection -   best_eval_score = 73.92
2023-04-19 21:20:51,837 - Detection -   eval_score = 74.31
2023-04-19 21:20:51,837 - Detection -   train_loss = 1.1859344393014908
2023-04-19 21:20:53,237 - Detection - ***** Epoch: 61: Eval results *****
2023-04-19 21:20:53,237 - Detection -   best_eval_score = 74.31
2023-04-19 21:20:53,237 - Detection -   eval_score = 75.12
2023-04-19 21:20:53,237 - Detection -   train_loss = 1.1862105429172516
2023-04-19 21:20:54,636 - Detection - ***** Epoch: 62: Eval results *****
2023-04-19 21:20:54,636 - Detection -   best_eval_score = 75.12
2023-04-19 21:20:54,636 - Detection -   eval_score = 74.61
2023-04-19 21:20:54,636 - Detection -   train_loss = 1.174538016319275
2023-04-19 21:20:56,026 - Detection - ***** Epoch: 63: Eval results *****
2023-04-19 21:20:56,026 - Detection -   best_eval_score = 75.12
2023-04-19 21:20:56,026 - Detection -   eval_score = 74.86
2023-04-19 21:20:56,026 - Detection -   train_loss = 1.1712667346000671
2023-04-19 21:20:57,415 - Detection - ***** Epoch: 64: Eval results *****
2023-04-19 21:20:57,415 - Detection -   best_eval_score = 75.12
2023-04-19 21:20:57,415 - Detection -   eval_score = 74.01
2023-04-19 21:20:57,415 - Detection -   train_loss = 1.1640409082174301
2023-04-19 21:20:58,803 - Detection - ***** Epoch: 65: Eval results *****
2023-04-19 21:20:58,803 - Detection -   best_eval_score = 75.12
2023-04-19 21:20:58,804 - Detection -   eval_score = 74.65
2023-04-19 21:20:58,804 - Detection -   train_loss = 1.1557638049125671
2023-04-19 21:21:00,192 - Detection - ***** Epoch: 66: Eval results *****
2023-04-19 21:21:00,193 - Detection -   best_eval_score = 75.12
2023-04-19 21:21:00,193 - Detection -   eval_score = 74.62
2023-04-19 21:21:00,193 - Detection -   train_loss = 1.160820260643959
2023-04-19 21:21:01,581 - Detection - ***** Epoch: 67: Eval results *****
2023-04-19 21:21:01,581 - Detection -   best_eval_score = 75.12
2023-04-19 21:21:01,581 - Detection -   eval_score = 74.35
2023-04-19 21:21:01,581 - Detection -   train_loss = 1.1621008664369583
2023-04-19 21:21:02,970 - Detection - ***** Epoch: 68: Eval results *****
2023-04-19 21:21:02,970 - Detection -   best_eval_score = 75.12
2023-04-19 21:21:02,970 - Detection -   eval_score = 75.34
2023-04-19 21:21:02,970 - Detection -   train_loss = 1.1541535407304764
2023-04-19 21:21:04,371 - Detection - ***** Epoch: 69: Eval results *****
2023-04-19 21:21:04,371 - Detection -   best_eval_score = 75.34
2023-04-19 21:21:04,371 - Detection -   eval_score = 75.35
2023-04-19 21:21:04,371 - Detection -   train_loss = 1.1765180677175522
2023-04-19 21:21:05,771 - Detection - ***** Epoch: 70: Eval results *****
2023-04-19 21:21:05,771 - Detection -   best_eval_score = 75.35
2023-04-19 21:21:05,771 - Detection -   eval_score = 75.35
2023-04-19 21:21:05,771 - Detection -   train_loss = 1.1610855460166931
2023-04-19 21:21:07,165 - Detection - ***** Epoch: 71: Eval results *****
2023-04-19 21:21:07,165 - Detection -   best_eval_score = 75.35
2023-04-19 21:21:07,165 - Detection -   eval_score = 74.91
2023-04-19 21:21:07,165 - Detection -   train_loss = 1.1539921313524246
2023-04-19 21:21:08,558 - Detection - ***** Epoch: 72: Eval results *****
2023-04-19 21:21:08,558 - Detection -   best_eval_score = 75.35
2023-04-19 21:21:08,558 - Detection -   eval_score = 75.2
2023-04-19 21:21:08,558 - Detection -   train_loss = 1.1565954685211182
2023-04-19 21:21:09,947 - Detection - ***** Epoch: 73: Eval results *****
2023-04-19 21:21:09,947 - Detection -   best_eval_score = 75.35
2023-04-19 21:21:09,947 - Detection -   eval_score = 75.2
2023-04-19 21:21:09,947 - Detection -   train_loss = 1.1385476291179657
2023-04-19 21:21:11,438 - Detection - ***** Epoch: 74: Eval results *****
2023-04-19 21:21:11,438 - Detection -   best_eval_score = 75.35
2023-04-19 21:21:11,438 - Detection -   eval_score = 75.74
2023-04-19 21:21:11,438 - Detection -   train_loss = 1.1398174911737442
2023-04-19 21:21:12,842 - Detection - ***** Epoch: 75: Eval results *****
2023-04-19 21:21:12,842 - Detection -   best_eval_score = 75.74
2023-04-19 21:21:12,842 - Detection -   eval_score = 75.6
2023-04-19 21:21:12,842 - Detection -   train_loss = 1.152960866689682
2023-04-19 21:21:14,233 - Detection - ***** Epoch: 76: Eval results *****
2023-04-19 21:21:14,233 - Detection -   best_eval_score = 75.74
2023-04-19 21:21:14,233 - Detection -   eval_score = 75.43
2023-04-19 21:21:14,233 - Detection -   train_loss = 1.1419302970170975
2023-04-19 21:21:15,621 - Detection - ***** Epoch: 77: Eval results *****
2023-04-19 21:21:15,621 - Detection -   best_eval_score = 75.74
2023-04-19 21:21:15,621 - Detection -   eval_score = 75.74
2023-04-19 21:21:15,621 - Detection -   train_loss = 1.1441276520490646
2023-04-19 21:21:17,011 - Detection - ***** Epoch: 78: Eval results *****
2023-04-19 21:21:17,011 - Detection -   best_eval_score = 75.74
2023-04-19 21:21:17,011 - Detection -   eval_score = 75.25
2023-04-19 21:21:17,011 - Detection -   train_loss = 1.1463406085968018
2023-04-19 21:21:18,398 - Detection - ***** Epoch: 79: Eval results *****
2023-04-19 21:21:18,399 - Detection -   best_eval_score = 75.74
2023-04-19 21:21:18,399 - Detection -   eval_score = 75.66
2023-04-19 21:21:18,399 - Detection -   train_loss = 1.1366141885519028
2023-04-19 21:21:19,788 - Detection - ***** Epoch: 80: Eval results *****
2023-04-19 21:21:19,788 - Detection -   best_eval_score = 75.74
2023-04-19 21:21:19,788 - Detection -   eval_score = 75.66
2023-04-19 21:21:19,788 - Detection -   train_loss = 1.1342401802539825
2023-04-19 21:21:21,176 - Detection - ***** Epoch: 81: Eval results *****
2023-04-19 21:21:21,176 - Detection -   best_eval_score = 75.74
2023-04-19 21:21:21,176 - Detection -   eval_score = 76.04
2023-04-19 21:21:21,176 - Detection -   train_loss = 1.1426897048950195
2023-04-19 21:21:22,575 - Detection - ***** Epoch: 82: Eval results *****
2023-04-19 21:21:22,575 - Detection -   best_eval_score = 76.04
2023-04-19 21:21:22,575 - Detection -   eval_score = 76.22
2023-04-19 21:21:22,575 - Detection -   train_loss = 1.1429484188556671
2023-04-19 21:21:23,977 - Detection - ***** Epoch: 83: Eval results *****
2023-04-19 21:21:23,977 - Detection -   best_eval_score = 76.22
2023-04-19 21:21:23,977 - Detection -   eval_score = 76.22
2023-04-19 21:21:23,977 - Detection -   train_loss = 1.139598086476326
2023-04-19 21:21:25,364 - Detection - ***** Epoch: 84: Eval results *****
2023-04-19 21:21:25,364 - Detection -   best_eval_score = 76.22
2023-04-19 21:21:25,364 - Detection -   eval_score = 75.77
2023-04-19 21:21:25,364 - Detection -   train_loss = 1.1420944184064865
2023-04-19 21:21:26,758 - Detection - ***** Epoch: 85: Eval results *****
2023-04-19 21:21:26,758 - Detection -   best_eval_score = 76.22
2023-04-19 21:21:26,758 - Detection -   eval_score = 75.77
2023-04-19 21:21:26,758 - Detection -   train_loss = 1.1374747455120087
2023-04-19 21:21:28,149 - Detection - ***** Epoch: 86: Eval results *****
2023-04-19 21:21:28,149 - Detection -   best_eval_score = 76.22
2023-04-19 21:21:28,149 - Detection -   eval_score = 75.4
2023-04-19 21:21:28,149 - Detection -   train_loss = 1.1344480961561203
2023-04-19 21:21:29,536 - Detection - ***** Epoch: 87: Eval results *****
2023-04-19 21:21:29,536 - Detection -   best_eval_score = 76.22
2023-04-19 21:21:29,536 - Detection -   eval_score = 75.4
2023-04-19 21:21:29,536 - Detection -   train_loss = 1.1419506072998047
2023-04-19 21:21:30,924 - Detection - ***** Epoch: 88: Eval results *****
2023-04-19 21:21:30,924 - Detection -   best_eval_score = 76.22
2023-04-19 21:21:30,924 - Detection -   eval_score = 75.4
2023-04-19 21:21:30,924 - Detection -   train_loss = 1.1366550028324127
2023-04-19 21:21:32,312 - Detection - ***** Epoch: 89: Eval results *****
2023-04-19 21:21:32,313 - Detection -   best_eval_score = 76.22
2023-04-19 21:21:32,313 - Detection -   eval_score = 75.4
2023-04-19 21:21:32,313 - Detection -   train_loss = 1.143796145915985
2023-04-19 21:21:33,701 - Detection - ***** Epoch: 90: Eval results *****
2023-04-19 21:21:33,701 - Detection -   best_eval_score = 76.22
2023-04-19 21:21:33,701 - Detection -   eval_score = 75.4
2023-04-19 21:21:33,701 - Detection -   train_loss = 1.129326656460762
2023-04-19 21:21:35,090 - Detection - ***** Epoch: 91: Eval results *****
2023-04-19 21:21:35,091 - Detection -   best_eval_score = 76.22
2023-04-19 21:21:35,091 - Detection -   eval_score = 75.4
2023-04-19 21:21:35,091 - Detection -   train_loss = 1.1367867141962051
2023-04-19 21:21:36,477 - Detection - ***** Epoch: 92: Eval results *****
2023-04-19 21:21:36,477 - Detection -   best_eval_score = 76.22
2023-04-19 21:21:36,477 - Detection -   eval_score = 75.4
2023-04-19 21:21:36,477 - Detection -   train_loss = 1.1361039578914642
2023-04-19 21:21:36,478 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_oos_cg_0.25_1.0_bert_disaware_2/models
2023-04-19 21:21:37,029 - Detection - Pre-training finished...
2023-04-19 21:21:37,029 - Detection - Training Begin...
2023-04-19 21:21:37,869 - Detection - ***** Epoch: 1: Eval results *****
2023-04-19 21:21:37,869 - Detection -   best_eval_score = 0
2023-04-19 21:21:37,869 - Detection -   eval_score = 1.25
2023-04-19 21:21:37,870 - Detection -   train_loss = 2.887918144464493
2023-04-19 21:21:38,710 - Detection - ***** Epoch: 2: Eval results *****
2023-04-19 21:21:38,710 - Detection -   best_eval_score = 1.25
2023-04-19 21:21:38,710 - Detection -   eval_score = 1.25
2023-04-19 21:21:38,710 - Detection -   train_loss = 2.6433695554733276
2023-04-19 21:21:39,550 - Detection - ***** Epoch: 3: Eval results *****
2023-04-19 21:21:39,550 - Detection -   best_eval_score = 1.25
2023-04-19 21:21:39,550 - Detection -   eval_score = 3.53
2023-04-19 21:21:39,550 - Detection -   train_loss = 2.4453707933425903
2023-04-19 21:21:40,390 - Detection - ***** Epoch: 4: Eval results *****
2023-04-19 21:21:40,390 - Detection -   best_eval_score = 3.53
2023-04-19 21:21:40,390 - Detection -   eval_score = 7.07
2023-04-19 21:21:40,390 - Detection -   train_loss = 2.127204582095146
2023-04-19 21:21:41,233 - Detection - ***** Epoch: 5: Eval results *****
2023-04-19 21:21:41,234 - Detection -   best_eval_score = 7.07
2023-04-19 21:21:41,234 - Detection -   eval_score = 9.83
2023-04-19 21:21:41,234 - Detection -   train_loss = 1.9222926497459412
2023-04-19 21:21:42,074 - Detection - ***** Epoch: 6: Eval results *****
2023-04-19 21:21:42,074 - Detection -   best_eval_score = 9.83
2023-04-19 21:21:42,074 - Detection -   eval_score = 12.44
2023-04-19 21:21:42,074 - Detection -   train_loss = 1.6009685099124908
2023-04-19 21:21:42,915 - Detection - ***** Epoch: 7: Eval results *****
2023-04-19 21:21:42,915 - Detection -   best_eval_score = 12.44
2023-04-19 21:21:42,915 - Detection -   eval_score = 16.22
2023-04-19 21:21:42,915 - Detection -   train_loss = 1.3098935782909393
2023-04-19 21:21:43,755 - Detection - ***** Epoch: 8: Eval results *****
2023-04-19 21:21:43,755 - Detection -   best_eval_score = 16.22
2023-04-19 21:21:43,755 - Detection -   eval_score = 18.67
2023-04-19 21:21:43,755 - Detection -   train_loss = 0.9970697611570358
2023-04-19 21:21:44,596 - Detection - ***** Epoch: 9: Eval results *****
2023-04-19 21:21:44,596 - Detection -   best_eval_score = 18.67
2023-04-19 21:21:44,596 - Detection -   eval_score = 24.32
2023-04-19 21:21:44,596 - Detection -   train_loss = 0.8351235613226891
2023-04-19 21:21:45,436 - Detection - ***** Epoch: 10: Eval results *****
2023-04-19 21:21:45,436 - Detection -   best_eval_score = 24.32
2023-04-19 21:21:45,436 - Detection -   eval_score = 29.65
2023-04-19 21:21:45,436 - Detection -   train_loss = 0.6454818695783615
2023-04-19 21:21:46,276 - Detection - ***** Epoch: 11: Eval results *****
2023-04-19 21:21:46,277 - Detection -   best_eval_score = 29.65
2023-04-19 21:21:46,277 - Detection -   eval_score = 34.26
2023-04-19 21:21:46,277 - Detection -   train_loss = 0.5439412668347359
2023-04-19 21:21:47,117 - Detection - ***** Epoch: 12: Eval results *****
2023-04-19 21:21:47,117 - Detection -   best_eval_score = 34.26
2023-04-19 21:21:47,117 - Detection -   eval_score = 36.32
2023-04-19 21:21:47,117 - Detection -   train_loss = 0.4667883738875389
2023-04-19 21:21:47,961 - Detection - ***** Epoch: 13: Eval results *****
2023-04-19 21:21:47,961 - Detection -   best_eval_score = 36.32
2023-04-19 21:21:47,961 - Detection -   eval_score = 37.33
2023-04-19 21:21:47,961 - Detection -   train_loss = 0.47651831805706024
2023-04-19 21:21:48,802 - Detection - ***** Epoch: 14: Eval results *****
2023-04-19 21:21:48,802 - Detection -   best_eval_score = 37.33
2023-04-19 21:21:48,802 - Detection -   eval_score = 37.87
2023-04-19 21:21:48,802 - Detection -   train_loss = 0.45895030722022057
2023-04-19 21:21:49,642 - Detection - ***** Epoch: 15: Eval results *****
2023-04-19 21:21:49,643 - Detection -   best_eval_score = 37.87
2023-04-19 21:21:49,643 - Detection -   eval_score = 36.94
2023-04-19 21:21:49,643 - Detection -   train_loss = 0.4615574777126312
2023-04-19 21:21:50,483 - Detection - ***** Epoch: 16: Eval results *****
2023-04-19 21:21:50,483 - Detection -   best_eval_score = 37.87
2023-04-19 21:21:50,483 - Detection -   eval_score = 36.23
2023-04-19 21:21:50,483 - Detection -   train_loss = 0.45622390136122704
2023-04-19 21:21:51,323 - Detection - ***** Epoch: 17: Eval results *****
2023-04-19 21:21:51,323 - Detection -   best_eval_score = 37.87
2023-04-19 21:21:51,323 - Detection -   eval_score = 35.36
2023-04-19 21:21:51,323 - Detection -   train_loss = 0.45580247417092323
2023-04-19 21:21:52,164 - Detection - ***** Epoch: 18: Eval results *****
2023-04-19 21:21:52,164 - Detection -   best_eval_score = 37.87
2023-04-19 21:21:52,164 - Detection -   eval_score = 35.53
2023-04-19 21:21:52,164 - Detection -   train_loss = 0.46097908914089203
2023-04-19 21:21:53,004 - Detection - ***** Epoch: 19: Eval results *****
2023-04-19 21:21:53,005 - Detection -   best_eval_score = 37.87
2023-04-19 21:21:53,005 - Detection -   eval_score = 35.2
2023-04-19 21:21:53,005 - Detection -   train_loss = 0.46160102263092995
2023-04-19 21:21:53,844 - Detection - ***** Epoch: 20: Eval results *****
2023-04-19 21:21:53,844 - Detection -   best_eval_score = 37.87
2023-04-19 21:21:53,844 - Detection -   eval_score = 34.89
2023-04-19 21:21:53,844 - Detection -   train_loss = 0.45835359394550323
2023-04-19 21:21:54,685 - Detection - ***** Epoch: 21: Eval results *****
2023-04-19 21:21:54,685 - Detection -   best_eval_score = 37.87
2023-04-19 21:21:54,685 - Detection -   eval_score = 35.85
2023-04-19 21:21:54,685 - Detection -   train_loss = 0.47807667404413223
2023-04-19 21:21:55,525 - Detection - ***** Epoch: 22: Eval results *****
2023-04-19 21:21:55,526 - Detection -   best_eval_score = 37.87
2023-04-19 21:21:55,526 - Detection -   eval_score = 36.23
2023-04-19 21:21:55,526 - Detection -   train_loss = 0.45772798731923103
2023-04-19 21:21:56,366 - Detection - ***** Epoch: 23: Eval results *****
2023-04-19 21:21:56,366 - Detection -   best_eval_score = 37.87
2023-04-19 21:21:56,366 - Detection -   eval_score = 35.19
2023-04-19 21:21:56,367 - Detection -   train_loss = 0.4549580290913582
2023-04-19 21:21:57,207 - Detection - ***** Epoch: 24: Eval results *****
2023-04-19 21:21:57,207 - Detection -   best_eval_score = 37.87
2023-04-19 21:21:57,207 - Detection -   eval_score = 34.91
2023-04-19 21:21:57,207 - Detection -   train_loss = 0.43740496039390564
2023-04-19 21:21:57,208 - Detection - Training Finished...
2023-04-19 21:21:57,208 - Detection - Testing begin...
2023-04-19 21:21:59,287 - Detection - ***** Test: Confusion Matrix *****
2023-04-19 21:21:59,288 - Detection - [[   0    0    0 ...    0    0   15]
 [   0    7    0 ...    0    0   12]
 [   0    0    0 ...    0    0   22]
 ...
 [   0    0    0 ...    2    0   11]
 [   0    0    0 ...    0    2   18]
 [   1    0    5 ...    1    0 2902]]
2023-04-19 21:21:59,288 - Detection - ***** Test results *****
2023-04-19 21:21:59,288 - Detection -   Acc = 84.91
2023-04-19 21:21:59,288 - Detection -   F1 = 37.3326
2023-04-19 21:21:59,288 - Detection -   F1-known = 35.9085
2023-04-19 21:21:59,288 - Detection -   F1-open = 91.4448
2023-04-19 21:21:59,288 - Detection - Testing finished...
2023-04-19 21:21:59,288 - Detection - Results saved in results/results_DA-ADB.csv
2023-04-19 21:21:59,307 - Detection - Open Intent Detection Finished...
