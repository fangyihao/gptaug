2023-04-19 21:17:07,897 - Detection - Open Intent Detection Begin...
2023-04-19 21:17:07,897 - Detection - Parameters Initialization...
2023-04-19 21:17:07,897 - Detection - ============================== Params ==============================
2023-04-19 21:17:07,897 - Detection - type:	open_intent_detection
2023-04-19 21:17:07,897 - Detection - logger_name:	Detection
2023-04-19 21:17:07,897 - Detection - log_dir:	logs
2023-04-19 21:17:07,897 - Detection - dataset:	oos_cg
2023-04-19 21:17:07,897 - Detection - known_cls_ratio:	0.25
2023-04-19 21:17:07,897 - Detection - labeled_ratio:	1.0
2023-04-19 21:17:07,897 - Detection - method:	DA-ADB
2023-04-19 21:17:07,897 - Detection - train:	True
2023-04-19 21:17:07,897 - Detection - pretrain:	True
2023-04-19 21:17:07,897 - Detection - save_model:	True
2023-04-19 21:17:07,897 - Detection - backbone:	bert_disaware
2023-04-19 21:17:07,897 - Detection - config_file_name:	DA-ADB
2023-04-19 21:17:07,897 - Detection - seed:	1
2023-04-19 21:17:07,897 - Detection - gpu_id:	0
2023-04-19 21:17:07,897 - Detection - pipe_results_path:	pipe_results
2023-04-19 21:17:07,898 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-19 21:17:07,898 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-19 21:17:07,898 - Detection - model_dir:	models
2023-04-19 21:17:07,898 - Detection - load_pretrained_method:	None
2023-04-19 21:17:07,898 - Detection - result_dir:	results
2023-04-19 21:17:07,898 - Detection - results_file_name:	results_DA-ADB.csv
2023-04-19 21:17:07,898 - Detection - save_results:	True
2023-04-19 21:17:07,898 - Detection - loss_fct:	CrossEntropyLoss
2023-04-19 21:17:07,898 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_oos_cg_0.25_1.0_bert_disaware_1
2023-04-19 21:17:07,898 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_oos_cg_0.25_1.0_bert_disaware_1/models
2023-04-19 21:17:07,898 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-19 21:17:07,898 - Detection - num_train_epochs:	100
2023-04-19 21:17:07,898 - Detection - num_labels:	None
2023-04-19 21:17:07,898 - Detection - max_seq_length:	None
2023-04-19 21:17:07,898 - Detection - freeze_backbone_parameters:	True
2023-04-19 21:17:07,898 - Detection - feat_dim:	768
2023-04-19 21:17:07,898 - Detection - warmup_proportion:	0.1
2023-04-19 21:17:07,898 - Detection - scale:	4
2023-04-19 21:17:07,898 - Detection - lr_boundary:	0.05
2023-04-19 21:17:07,898 - Detection - lr:	2e-05
2023-04-19 21:17:07,898 - Detection - activation:	relu
2023-04-19 21:17:07,898 - Detection - train_batch_size:	128
2023-04-19 21:17:07,898 - Detection - eval_batch_size:	64
2023-04-19 21:17:07,898 - Detection - test_batch_size:	64
2023-04-19 21:17:07,898 - Detection - wait_patient:	10
2023-04-19 21:17:07,898 - Detection - ============================== End Params ==============================
2023-04-19 21:17:07,898 - Detection - Data and Model Preparation...
2023-04-19 21:17:07,898 - Detection - The number of known intents is 38
2023-04-19 21:17:07,899 - Detection - Lists of known labels are: ['calories', 'report_fraud', 'next_song', 'cancel_reservation', 'translate', 'ingredients_list', 'what_are_your_hobbies', 'food_last', 'credit_limit_change', 'thank_you', 'reminder', 'are_you_a_bot', 'restaurant_reviews', 'how_busy', 'oil_change_how', 'flight_status', 'recipe', 'maybe', 'current_location', 'direct_deposit', 'pto_request_status', 'payday', 'nutrition_info', 'expiration_date', 'tire_pressure', 'report_lost_card', 'date', 'carry_on', 'new_card', 'whisper_mode', 'pto_used', 'uber', 'measurement_conversion', 'traffic', 'spelling', 'gas_type', 'improve_credit_score', 'credit_limit']
2023-04-19 21:17:07,908 - Detection - Number of labeled training samples = 909
2023-04-19 21:17:07,908 - Detection - Number of unlabeled training samples = 2774
2023-04-19 21:17:07,912 - Detection - Number of evaluation samples = 407
2023-04-19 21:17:07,918 - Detection - Number of testing samples = 3632
2023-04-19 21:17:13,524 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-19 21:17:13,607 - Detection - Pre-training Begin...
2023-04-19 21:17:15,445 - Detection - ***** Epoch: 1: Eval results *****
2023-04-19 21:17:15,445 - Detection -   best_eval_score = 0
2023-04-19 21:17:15,445 - Detection -   eval_score = 0.49
2023-04-19 21:17:15,445 - Detection -   train_loss = 3.6611558496952057
2023-04-19 21:17:16,796 - Detection - ***** Epoch: 2: Eval results *****
2023-04-19 21:17:16,796 - Detection -   best_eval_score = 0.49
2023-04-19 21:17:16,796 - Detection -   eval_score = 0.85
2023-04-19 21:17:16,796 - Detection -   train_loss = 3.6388354301452637
2023-04-19 21:17:18,150 - Detection - ***** Epoch: 3: Eval results *****
2023-04-19 21:17:18,150 - Detection -   best_eval_score = 0.85
2023-04-19 21:17:18,150 - Detection -   eval_score = 0.44
2023-04-19 21:17:18,150 - Detection -   train_loss = 3.5947966277599335
2023-04-19 21:17:19,493 - Detection - ***** Epoch: 4: Eval results *****
2023-04-19 21:17:19,493 - Detection -   best_eval_score = 0.85
2023-04-19 21:17:19,493 - Detection -   eval_score = 0.5
2023-04-19 21:17:19,493 - Detection -   train_loss = 3.56573086977005
2023-04-19 21:17:20,836 - Detection - ***** Epoch: 5: Eval results *****
2023-04-19 21:17:20,836 - Detection -   best_eval_score = 0.85
2023-04-19 21:17:20,836 - Detection -   eval_score = 1.54
2023-04-19 21:17:20,836 - Detection -   train_loss = 3.5444869995117188
2023-04-19 21:17:22,189 - Detection - ***** Epoch: 6: Eval results *****
2023-04-19 21:17:22,189 - Detection -   best_eval_score = 1.54
2023-04-19 21:17:22,189 - Detection -   eval_score = 1.94
2023-04-19 21:17:22,189 - Detection -   train_loss = 3.488545536994934
2023-04-19 21:17:23,543 - Detection - ***** Epoch: 7: Eval results *****
2023-04-19 21:17:23,543 - Detection -   best_eval_score = 1.94
2023-04-19 21:17:23,543 - Detection -   eval_score = 1.82
2023-04-19 21:17:23,543 - Detection -   train_loss = 3.4433817863464355
2023-04-19 21:17:24,895 - Detection - ***** Epoch: 8: Eval results *****
2023-04-19 21:17:24,895 - Detection -   best_eval_score = 1.94
2023-04-19 21:17:24,895 - Detection -   eval_score = 2.23
2023-04-19 21:17:24,895 - Detection -   train_loss = 3.3544422686100006
2023-04-19 21:17:26,250 - Detection - ***** Epoch: 9: Eval results *****
2023-04-19 21:17:26,250 - Detection -   best_eval_score = 2.23
2023-04-19 21:17:26,250 - Detection -   eval_score = 2.87
2023-04-19 21:17:26,250 - Detection -   train_loss = 3.222493499517441
2023-04-19 21:17:27,707 - Detection - ***** Epoch: 10: Eval results *****
2023-04-19 21:17:27,707 - Detection -   best_eval_score = 2.87
2023-04-19 21:17:27,707 - Detection -   eval_score = 11.27
2023-04-19 21:17:27,707 - Detection -   train_loss = 3.0774329602718353
2023-04-19 21:17:29,064 - Detection - ***** Epoch: 11: Eval results *****
2023-04-19 21:17:29,064 - Detection -   best_eval_score = 11.27
2023-04-19 21:17:29,064 - Detection -   eval_score = 20.71
2023-04-19 21:17:29,064 - Detection -   train_loss = 2.909947395324707
2023-04-19 21:17:30,422 - Detection - ***** Epoch: 12: Eval results *****
2023-04-19 21:17:30,422 - Detection -   best_eval_score = 20.71
2023-04-19 21:17:30,422 - Detection -   eval_score = 28.04
2023-04-19 21:17:30,422 - Detection -   train_loss = 2.705803334712982
2023-04-19 21:17:31,781 - Detection - ***** Epoch: 13: Eval results *****
2023-04-19 21:17:31,781 - Detection -   best_eval_score = 28.04
2023-04-19 21:17:31,781 - Detection -   eval_score = 35.39
2023-04-19 21:17:31,781 - Detection -   train_loss = 2.555585741996765
2023-04-19 21:17:33,142 - Detection - ***** Epoch: 14: Eval results *****
2023-04-19 21:17:33,142 - Detection -   best_eval_score = 35.39
2023-04-19 21:17:33,142 - Detection -   eval_score = 44.35
2023-04-19 21:17:33,142 - Detection -   train_loss = 2.357250362634659
2023-04-19 21:17:34,501 - Detection - ***** Epoch: 15: Eval results *****
2023-04-19 21:17:34,501 - Detection -   best_eval_score = 44.35
2023-04-19 21:17:34,501 - Detection -   eval_score = 49.34
2023-04-19 21:17:34,501 - Detection -   train_loss = 2.2517372369766235
2023-04-19 21:17:35,861 - Detection - ***** Epoch: 16: Eval results *****
2023-04-19 21:17:35,861 - Detection -   best_eval_score = 49.34
2023-04-19 21:17:35,861 - Detection -   eval_score = 55.19
2023-04-19 21:17:35,861 - Detection -   train_loss = 2.161226749420166
2023-04-19 21:17:37,222 - Detection - ***** Epoch: 17: Eval results *****
2023-04-19 21:17:37,222 - Detection -   best_eval_score = 55.19
2023-04-19 21:17:37,222 - Detection -   eval_score = 58.89
2023-04-19 21:17:37,222 - Detection -   train_loss = 2.0754387378692627
2023-04-19 21:17:38,586 - Detection - ***** Epoch: 18: Eval results *****
2023-04-19 21:17:38,587 - Detection -   best_eval_score = 58.89
2023-04-19 21:17:38,587 - Detection -   eval_score = 62.01
2023-04-19 21:17:38,587 - Detection -   train_loss = 1.997562050819397
2023-04-19 21:17:39,949 - Detection - ***** Epoch: 19: Eval results *****
2023-04-19 21:17:39,949 - Detection -   best_eval_score = 62.01
2023-04-19 21:17:39,949 - Detection -   eval_score = 62.86
2023-04-19 21:17:39,949 - Detection -   train_loss = 1.9334744065999985
2023-04-19 21:17:41,311 - Detection - ***** Epoch: 20: Eval results *****
2023-04-19 21:17:41,311 - Detection -   best_eval_score = 62.86
2023-04-19 21:17:41,311 - Detection -   eval_score = 65.16
2023-04-19 21:17:41,311 - Detection -   train_loss = 1.8606959879398346
2023-04-19 21:17:42,676 - Detection - ***** Epoch: 21: Eval results *****
2023-04-19 21:17:42,676 - Detection -   best_eval_score = 65.16
2023-04-19 21:17:42,676 - Detection -   eval_score = 66.54
2023-04-19 21:17:42,676 - Detection -   train_loss = 1.8249383866786957
2023-04-19 21:17:44,039 - Detection - ***** Epoch: 22: Eval results *****
2023-04-19 21:17:44,039 - Detection -   best_eval_score = 66.54
2023-04-19 21:17:44,039 - Detection -   eval_score = 69.3
2023-04-19 21:17:44,039 - Detection -   train_loss = 1.773375242948532
2023-04-19 21:17:45,402 - Detection - ***** Epoch: 23: Eval results *****
2023-04-19 21:17:45,402 - Detection -   best_eval_score = 69.3
2023-04-19 21:17:45,402 - Detection -   eval_score = 70.42
2023-04-19 21:17:45,402 - Detection -   train_loss = 1.754006028175354
2023-04-19 21:17:46,771 - Detection - ***** Epoch: 24: Eval results *****
2023-04-19 21:17:46,771 - Detection -   best_eval_score = 70.42
2023-04-19 21:17:46,771 - Detection -   eval_score = 71.49
2023-04-19 21:17:46,771 - Detection -   train_loss = 1.6585337966680527
2023-04-19 21:17:48,139 - Detection - ***** Epoch: 25: Eval results *****
2023-04-19 21:17:48,139 - Detection -   best_eval_score = 71.49
2023-04-19 21:17:48,139 - Detection -   eval_score = 73.7
2023-04-19 21:17:48,139 - Detection -   train_loss = 1.653851106762886
2023-04-19 21:17:49,508 - Detection - ***** Epoch: 26: Eval results *****
2023-04-19 21:17:49,508 - Detection -   best_eval_score = 73.7
2023-04-19 21:17:49,508 - Detection -   eval_score = 74.86
2023-04-19 21:17:49,508 - Detection -   train_loss = 1.628050059080124
2023-04-19 21:17:50,878 - Detection - ***** Epoch: 27: Eval results *****
2023-04-19 21:17:50,878 - Detection -   best_eval_score = 74.86
2023-04-19 21:17:50,878 - Detection -   eval_score = 74.36
2023-04-19 21:17:50,878 - Detection -   train_loss = 1.6167856603860855
2023-04-19 21:17:52,236 - Detection - ***** Epoch: 28: Eval results *****
2023-04-19 21:17:52,237 - Detection -   best_eval_score = 74.86
2023-04-19 21:17:52,237 - Detection -   eval_score = 73.92
2023-04-19 21:17:52,237 - Detection -   train_loss = 1.5820949226617813
2023-04-19 21:17:53,597 - Detection - ***** Epoch: 29: Eval results *****
2023-04-19 21:17:53,597 - Detection -   best_eval_score = 74.86
2023-04-19 21:17:53,597 - Detection -   eval_score = 75.69
2023-04-19 21:17:53,597 - Detection -   train_loss = 1.527379423379898
2023-04-19 21:17:54,967 - Detection - ***** Epoch: 30: Eval results *****
2023-04-19 21:17:54,967 - Detection -   best_eval_score = 75.69
2023-04-19 21:17:54,967 - Detection -   eval_score = 75.97
2023-04-19 21:17:54,967 - Detection -   train_loss = 1.520510047674179
2023-04-19 21:17:56,339 - Detection - ***** Epoch: 31: Eval results *****
2023-04-19 21:17:56,339 - Detection -   best_eval_score = 75.97
2023-04-19 21:17:56,339 - Detection -   eval_score = 75.52
2023-04-19 21:17:56,339 - Detection -   train_loss = 1.5039320290088654
2023-04-19 21:17:57,699 - Detection - ***** Epoch: 32: Eval results *****
2023-04-19 21:17:57,700 - Detection -   best_eval_score = 75.97
2023-04-19 21:17:57,700 - Detection -   eval_score = 76.2
2023-04-19 21:17:57,700 - Detection -   train_loss = 1.491960421204567
2023-04-19 21:17:59,071 - Detection - ***** Epoch: 33: Eval results *****
2023-04-19 21:17:59,071 - Detection -   best_eval_score = 76.2
2023-04-19 21:17:59,071 - Detection -   eval_score = 77.65
2023-04-19 21:17:59,071 - Detection -   train_loss = 1.4677049964666367
2023-04-19 21:18:00,443 - Detection - ***** Epoch: 34: Eval results *****
2023-04-19 21:18:00,443 - Detection -   best_eval_score = 77.65
2023-04-19 21:18:00,443 - Detection -   eval_score = 78.1
2023-04-19 21:18:00,443 - Detection -   train_loss = 1.4485131353139877
2023-04-19 21:18:01,922 - Detection - ***** Epoch: 35: Eval results *****
2023-04-19 21:18:01,922 - Detection -   best_eval_score = 78.1
2023-04-19 21:18:01,922 - Detection -   eval_score = 78.56
2023-04-19 21:18:01,922 - Detection -   train_loss = 1.4560664147138596
2023-04-19 21:18:03,299 - Detection - ***** Epoch: 36: Eval results *****
2023-04-19 21:18:03,299 - Detection -   best_eval_score = 78.56
2023-04-19 21:18:03,299 - Detection -   eval_score = 79.54
2023-04-19 21:18:03,299 - Detection -   train_loss = 1.425771564245224
2023-04-19 21:18:04,672 - Detection - ***** Epoch: 37: Eval results *****
2023-04-19 21:18:04,672 - Detection -   best_eval_score = 79.54
2023-04-19 21:18:04,672 - Detection -   eval_score = 80.5
2023-04-19 21:18:04,672 - Detection -   train_loss = 1.4235004931688309
2023-04-19 21:18:06,044 - Detection - ***** Epoch: 38: Eval results *****
2023-04-19 21:18:06,044 - Detection -   best_eval_score = 80.5
2023-04-19 21:18:06,044 - Detection -   eval_score = 80.32
2023-04-19 21:18:06,044 - Detection -   train_loss = 1.3995905816555023
2023-04-19 21:18:07,406 - Detection - ***** Epoch: 39: Eval results *****
2023-04-19 21:18:07,406 - Detection -   best_eval_score = 80.5
2023-04-19 21:18:07,406 - Detection -   eval_score = 80.97
2023-04-19 21:18:07,406 - Detection -   train_loss = 1.3818694949150085
2023-04-19 21:18:08,780 - Detection - ***** Epoch: 40: Eval results *****
2023-04-19 21:18:08,780 - Detection -   best_eval_score = 80.97
2023-04-19 21:18:08,780 - Detection -   eval_score = 81.34
2023-04-19 21:18:08,780 - Detection -   train_loss = 1.38784159719944
2023-04-19 21:18:10,154 - Detection - ***** Epoch: 41: Eval results *****
2023-04-19 21:18:10,154 - Detection -   best_eval_score = 81.34
2023-04-19 21:18:10,154 - Detection -   eval_score = 80.45
2023-04-19 21:18:10,154 - Detection -   train_loss = 1.3763850331306458
2023-04-19 21:18:11,518 - Detection - ***** Epoch: 42: Eval results *****
2023-04-19 21:18:11,518 - Detection -   best_eval_score = 81.34
2023-04-19 21:18:11,518 - Detection -   eval_score = 81.89
2023-04-19 21:18:11,518 - Detection -   train_loss = 1.355252280831337
2023-04-19 21:18:12,899 - Detection - ***** Epoch: 43: Eval results *****
2023-04-19 21:18:12,899 - Detection -   best_eval_score = 81.89
2023-04-19 21:18:12,899 - Detection -   eval_score = 81.89
2023-04-19 21:18:12,899 - Detection -   train_loss = 1.3495580106973648
2023-04-19 21:18:14,270 - Detection - ***** Epoch: 44: Eval results *****
2023-04-19 21:18:14,270 - Detection -   best_eval_score = 81.89
2023-04-19 21:18:14,270 - Detection -   eval_score = 82.89
2023-04-19 21:18:14,270 - Detection -   train_loss = 1.353746920824051
2023-04-19 21:18:15,644 - Detection - ***** Epoch: 45: Eval results *****
2023-04-19 21:18:15,644 - Detection -   best_eval_score = 82.89
2023-04-19 21:18:15,644 - Detection -   eval_score = 82.22
2023-04-19 21:18:15,644 - Detection -   train_loss = 1.3232693374156952
2023-04-19 21:18:17,007 - Detection - ***** Epoch: 46: Eval results *****
2023-04-19 21:18:17,007 - Detection -   best_eval_score = 82.89
2023-04-19 21:18:17,007 - Detection -   eval_score = 82.25
2023-04-19 21:18:17,007 - Detection -   train_loss = 1.3300743997097015
2023-04-19 21:18:18,370 - Detection - ***** Epoch: 47: Eval results *****
2023-04-19 21:18:18,370 - Detection -   best_eval_score = 82.89
2023-04-19 21:18:18,370 - Detection -   eval_score = 82.62
2023-04-19 21:18:18,370 - Detection -   train_loss = 1.323670119047165
2023-04-19 21:18:19,733 - Detection - ***** Epoch: 48: Eval results *****
2023-04-19 21:18:19,733 - Detection -   best_eval_score = 82.89
2023-04-19 21:18:19,733 - Detection -   eval_score = 82.83
2023-04-19 21:18:19,733 - Detection -   train_loss = 1.3049473762512207
2023-04-19 21:18:21,095 - Detection - ***** Epoch: 49: Eval results *****
2023-04-19 21:18:21,095 - Detection -   best_eval_score = 82.89
2023-04-19 21:18:21,095 - Detection -   eval_score = 83.34
2023-04-19 21:18:21,095 - Detection -   train_loss = 1.3017522394657135
2023-04-19 21:18:22,470 - Detection - ***** Epoch: 50: Eval results *****
2023-04-19 21:18:22,470 - Detection -   best_eval_score = 83.34
2023-04-19 21:18:22,470 - Detection -   eval_score = 83.34
2023-04-19 21:18:22,470 - Detection -   train_loss = 1.2773123383522034
2023-04-19 21:18:23,835 - Detection - ***** Epoch: 51: Eval results *****
2023-04-19 21:18:23,835 - Detection -   best_eval_score = 83.34
2023-04-19 21:18:23,835 - Detection -   eval_score = 82.87
2023-04-19 21:18:23,835 - Detection -   train_loss = 1.288930132985115
2023-04-19 21:18:25,196 - Detection - ***** Epoch: 52: Eval results *****
2023-04-19 21:18:25,196 - Detection -   best_eval_score = 83.34
2023-04-19 21:18:25,196 - Detection -   eval_score = 83.2
2023-04-19 21:18:25,196 - Detection -   train_loss = 1.2940302193164825
2023-04-19 21:18:26,558 - Detection - ***** Epoch: 53: Eval results *****
2023-04-19 21:18:26,558 - Detection -   best_eval_score = 83.34
2023-04-19 21:18:26,559 - Detection -   eval_score = 83.67
2023-04-19 21:18:26,559 - Detection -   train_loss = 1.2906969040632248
2023-04-19 21:18:27,932 - Detection - ***** Epoch: 54: Eval results *****
2023-04-19 21:18:27,933 - Detection -   best_eval_score = 83.67
2023-04-19 21:18:27,933 - Detection -   eval_score = 83.9
2023-04-19 21:18:27,933 - Detection -   train_loss = 1.2872052043676376
2023-04-19 21:18:29,305 - Detection - ***** Epoch: 55: Eval results *****
2023-04-19 21:18:29,305 - Detection -   best_eval_score = 83.9
2023-04-19 21:18:29,305 - Detection -   eval_score = 84.49
2023-04-19 21:18:29,305 - Detection -   train_loss = 1.2557126432657242
2023-04-19 21:18:30,678 - Detection - ***** Epoch: 56: Eval results *****
2023-04-19 21:18:30,678 - Detection -   best_eval_score = 84.49
2023-04-19 21:18:30,679 - Detection -   eval_score = 84.52
2023-04-19 21:18:30,679 - Detection -   train_loss = 1.2675867080688477
2023-04-19 21:18:32,051 - Detection - ***** Epoch: 57: Eval results *****
2023-04-19 21:18:32,051 - Detection -   best_eval_score = 84.52
2023-04-19 21:18:32,051 - Detection -   eval_score = 84.28
2023-04-19 21:18:32,051 - Detection -   train_loss = 1.2595648616552353
2023-04-19 21:18:33,413 - Detection - ***** Epoch: 58: Eval results *****
2023-04-19 21:18:33,413 - Detection -   best_eval_score = 84.52
2023-04-19 21:18:33,413 - Detection -   eval_score = 83.07
2023-04-19 21:18:33,413 - Detection -   train_loss = 1.2587173283100128
2023-04-19 21:18:34,777 - Detection - ***** Epoch: 59: Eval results *****
2023-04-19 21:18:34,777 - Detection -   best_eval_score = 84.52
2023-04-19 21:18:34,777 - Detection -   eval_score = 83.56
2023-04-19 21:18:34,777 - Detection -   train_loss = 1.259675294160843
2023-04-19 21:18:36,139 - Detection - ***** Epoch: 60: Eval results *****
2023-04-19 21:18:36,139 - Detection -   best_eval_score = 84.52
2023-04-19 21:18:36,139 - Detection -   eval_score = 84.28
2023-04-19 21:18:36,139 - Detection -   train_loss = 1.240829959511757
2023-04-19 21:18:37,501 - Detection - ***** Epoch: 61: Eval results *****
2023-04-19 21:18:37,501 - Detection -   best_eval_score = 84.52
2023-04-19 21:18:37,501 - Detection -   eval_score = 84.28
2023-04-19 21:18:37,501 - Detection -   train_loss = 1.2418983429670334
2023-04-19 21:18:38,863 - Detection - ***** Epoch: 62: Eval results *****
2023-04-19 21:18:38,863 - Detection -   best_eval_score = 84.52
2023-04-19 21:18:38,863 - Detection -   eval_score = 84.47
2023-04-19 21:18:38,863 - Detection -   train_loss = 1.231923595070839
2023-04-19 21:18:40,224 - Detection - ***** Epoch: 63: Eval results *****
2023-04-19 21:18:40,224 - Detection -   best_eval_score = 84.52
2023-04-19 21:18:40,224 - Detection -   eval_score = 84.47
2023-04-19 21:18:40,224 - Detection -   train_loss = 1.2428825348615646
2023-04-19 21:18:41,590 - Detection - ***** Epoch: 64: Eval results *****
2023-04-19 21:18:41,590 - Detection -   best_eval_score = 84.52
2023-04-19 21:18:41,590 - Detection -   eval_score = 84.47
2023-04-19 21:18:41,591 - Detection -   train_loss = 1.2476440519094467
2023-04-19 21:18:42,954 - Detection - ***** Epoch: 65: Eval results *****
2023-04-19 21:18:42,954 - Detection -   best_eval_score = 84.52
2023-04-19 21:18:42,954 - Detection -   eval_score = 84.77
2023-04-19 21:18:42,954 - Detection -   train_loss = 1.2184676975011826
2023-04-19 21:18:44,327 - Detection - ***** Epoch: 66: Eval results *****
2023-04-19 21:18:44,327 - Detection -   best_eval_score = 84.77
2023-04-19 21:18:44,328 - Detection -   eval_score = 84.36
2023-04-19 21:18:44,328 - Detection -   train_loss = 1.2482713162899017
2023-04-19 21:18:45,690 - Detection - ***** Epoch: 67: Eval results *****
2023-04-19 21:18:45,690 - Detection -   best_eval_score = 84.77
2023-04-19 21:18:45,690 - Detection -   eval_score = 84.59
2023-04-19 21:18:45,690 - Detection -   train_loss = 1.216869369149208
2023-04-19 21:18:47,052 - Detection - ***** Epoch: 68: Eval results *****
2023-04-19 21:18:47,052 - Detection -   best_eval_score = 84.77
2023-04-19 21:18:47,052 - Detection -   eval_score = 84.26
2023-04-19 21:18:47,052 - Detection -   train_loss = 1.2349042743444443
2023-04-19 21:18:48,416 - Detection - ***** Epoch: 69: Eval results *****
2023-04-19 21:18:48,416 - Detection -   best_eval_score = 84.77
2023-04-19 21:18:48,416 - Detection -   eval_score = 84.24
2023-04-19 21:18:48,416 - Detection -   train_loss = 1.217642992734909
2023-04-19 21:18:49,776 - Detection - ***** Epoch: 70: Eval results *****
2023-04-19 21:18:49,776 - Detection -   best_eval_score = 84.77
2023-04-19 21:18:49,776 - Detection -   eval_score = 84.49
2023-04-19 21:18:49,776 - Detection -   train_loss = 1.221401959657669
2023-04-19 21:18:51,137 - Detection - ***** Epoch: 71: Eval results *****
2023-04-19 21:18:51,137 - Detection -   best_eval_score = 84.77
2023-04-19 21:18:51,137 - Detection -   eval_score = 84.75
2023-04-19 21:18:51,137 - Detection -   train_loss = 1.204689010977745
2023-04-19 21:18:52,498 - Detection - ***** Epoch: 72: Eval results *****
2023-04-19 21:18:52,498 - Detection -   best_eval_score = 84.77
2023-04-19 21:18:52,498 - Detection -   eval_score = 84.74
2023-04-19 21:18:52,498 - Detection -   train_loss = 1.219864621758461
2023-04-19 21:18:53,858 - Detection - ***** Epoch: 73: Eval results *****
2023-04-19 21:18:53,858 - Detection -   best_eval_score = 84.77
2023-04-19 21:18:53,858 - Detection -   eval_score = 84.74
2023-04-19 21:18:53,858 - Detection -   train_loss = 1.218459814786911
2023-04-19 21:18:55,219 - Detection - ***** Epoch: 74: Eval results *****
2023-04-19 21:18:55,219 - Detection -   best_eval_score = 84.77
2023-04-19 21:18:55,219 - Detection -   eval_score = 84.47
2023-04-19 21:18:55,219 - Detection -   train_loss = 1.2143037021160126
2023-04-19 21:18:56,581 - Detection - ***** Epoch: 75: Eval results *****
2023-04-19 21:18:56,581 - Detection -   best_eval_score = 84.77
2023-04-19 21:18:56,581 - Detection -   eval_score = 84.47
2023-04-19 21:18:56,581 - Detection -   train_loss = 1.1953415870666504
2023-04-19 21:18:56,582 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_oos_cg_0.25_1.0_bert_disaware_1/models
2023-04-19 21:18:57,130 - Detection - Pre-training finished...
2023-04-19 21:18:57,130 - Detection - Training Begin...
2023-04-19 21:18:57,950 - Detection - ***** Epoch: 1: Eval results *****
2023-04-19 21:18:57,950 - Detection -   best_eval_score = 0
2023-04-19 21:18:57,950 - Detection -   eval_score = 0.43
2023-04-19 21:18:57,950 - Detection -   train_loss = 2.9849119186401367
2023-04-19 21:18:58,773 - Detection - ***** Epoch: 2: Eval results *****
2023-04-19 21:18:58,773 - Detection -   best_eval_score = 0.43
2023-04-19 21:18:58,773 - Detection -   eval_score = 1.37
2023-04-19 21:18:58,773 - Detection -   train_loss = 2.811562567949295
2023-04-19 21:18:59,595 - Detection - ***** Epoch: 3: Eval results *****
2023-04-19 21:18:59,595 - Detection -   best_eval_score = 1.37
2023-04-19 21:18:59,595 - Detection -   eval_score = 2.42
2023-04-19 21:18:59,595 - Detection -   train_loss = 2.553133100271225
2023-04-19 21:19:00,417 - Detection - ***** Epoch: 4: Eval results *****
2023-04-19 21:19:00,417 - Detection -   best_eval_score = 2.42
2023-04-19 21:19:00,417 - Detection -   eval_score = 3.38
2023-04-19 21:19:00,417 - Detection -   train_loss = 2.331691861152649
2023-04-19 21:19:01,240 - Detection - ***** Epoch: 5: Eval results *****
2023-04-19 21:19:01,240 - Detection -   best_eval_score = 3.38
2023-04-19 21:19:01,240 - Detection -   eval_score = 3.95
2023-04-19 21:19:01,240 - Detection -   train_loss = 2.0777913480997086
2023-04-19 21:19:02,062 - Detection - ***** Epoch: 6: Eval results *****
2023-04-19 21:19:02,062 - Detection -   best_eval_score = 3.95
2023-04-19 21:19:02,062 - Detection -   eval_score = 6.21
2023-04-19 21:19:02,062 - Detection -   train_loss = 1.7957897186279297
2023-04-19 21:19:02,889 - Detection - ***** Epoch: 7: Eval results *****
2023-04-19 21:19:02,889 - Detection -   best_eval_score = 6.21
2023-04-19 21:19:02,889 - Detection -   eval_score = 13.27
2023-04-19 21:19:02,889 - Detection -   train_loss = 1.5378220677375793
2023-04-19 21:19:03,711 - Detection - ***** Epoch: 8: Eval results *****
2023-04-19 21:19:03,711 - Detection -   best_eval_score = 13.27
2023-04-19 21:19:03,711 - Detection -   eval_score = 18.93
2023-04-19 21:19:03,711 - Detection -   train_loss = 1.162978395819664
2023-04-19 21:19:04,533 - Detection - ***** Epoch: 9: Eval results *****
2023-04-19 21:19:04,533 - Detection -   best_eval_score = 18.93
2023-04-19 21:19:04,533 - Detection -   eval_score = 25.94
2023-04-19 21:19:04,533 - Detection -   train_loss = 0.8533241748809814
2023-04-19 21:19:05,356 - Detection - ***** Epoch: 10: Eval results *****
2023-04-19 21:19:05,356 - Detection -   best_eval_score = 25.94
2023-04-19 21:19:05,356 - Detection -   eval_score = 33.76
2023-04-19 21:19:05,356 - Detection -   train_loss = 0.6859731748700142
2023-04-19 21:19:06,179 - Detection - ***** Epoch: 11: Eval results *****
2023-04-19 21:19:06,179 - Detection -   best_eval_score = 33.76
2023-04-19 21:19:06,179 - Detection -   eval_score = 41.82
2023-04-19 21:19:06,179 - Detection -   train_loss = 0.5348896458745003
2023-04-19 21:19:07,002 - Detection - ***** Epoch: 12: Eval results *****
2023-04-19 21:19:07,002 - Detection -   best_eval_score = 41.82
2023-04-19 21:19:07,002 - Detection -   eval_score = 43.41
2023-04-19 21:19:07,002 - Detection -   train_loss = 0.47513457387685776
2023-04-19 21:19:07,825 - Detection - ***** Epoch: 13: Eval results *****
2023-04-19 21:19:07,825 - Detection -   best_eval_score = 43.41
2023-04-19 21:19:07,825 - Detection -   eval_score = 43.86
2023-04-19 21:19:07,825 - Detection -   train_loss = 0.45495468750596046
2023-04-19 21:19:08,648 - Detection - ***** Epoch: 14: Eval results *****
2023-04-19 21:19:08,648 - Detection -   best_eval_score = 43.86
2023-04-19 21:19:08,648 - Detection -   eval_score = 43.19
2023-04-19 21:19:08,648 - Detection -   train_loss = 0.43521732091903687
2023-04-19 21:19:09,469 - Detection - ***** Epoch: 15: Eval results *****
2023-04-19 21:19:09,469 - Detection -   best_eval_score = 43.86
2023-04-19 21:19:09,469 - Detection -   eval_score = 42.01
2023-04-19 21:19:09,469 - Detection -   train_loss = 0.4420854449272156
2023-04-19 21:19:10,294 - Detection - ***** Epoch: 16: Eval results *****
2023-04-19 21:19:10,294 - Detection -   best_eval_score = 43.86
2023-04-19 21:19:10,294 - Detection -   eval_score = 42.66
2023-04-19 21:19:10,294 - Detection -   train_loss = 0.4420989826321602
2023-04-19 21:19:11,122 - Detection - ***** Epoch: 17: Eval results *****
2023-04-19 21:19:11,122 - Detection -   best_eval_score = 43.86
2023-04-19 21:19:11,122 - Detection -   eval_score = 41.95
2023-04-19 21:19:11,122 - Detection -   train_loss = 0.44647885486483574
2023-04-19 21:19:11,944 - Detection - ***** Epoch: 18: Eval results *****
2023-04-19 21:19:11,944 - Detection -   best_eval_score = 43.86
2023-04-19 21:19:11,944 - Detection -   eval_score = 43.79
2023-04-19 21:19:11,944 - Detection -   train_loss = 0.4571639709174633
2023-04-19 21:19:12,766 - Detection - ***** Epoch: 19: Eval results *****
2023-04-19 21:19:12,766 - Detection -   best_eval_score = 43.86
2023-04-19 21:19:12,766 - Detection -   eval_score = 43.36
2023-04-19 21:19:12,766 - Detection -   train_loss = 0.449072502553463
2023-04-19 21:19:13,588 - Detection - ***** Epoch: 20: Eval results *****
2023-04-19 21:19:13,588 - Detection -   best_eval_score = 43.86
2023-04-19 21:19:13,588 - Detection -   eval_score = 42.4
2023-04-19 21:19:13,588 - Detection -   train_loss = 0.44586721807718277
2023-04-19 21:19:14,410 - Detection - ***** Epoch: 21: Eval results *****
2023-04-19 21:19:14,410 - Detection -   best_eval_score = 43.86
2023-04-19 21:19:14,410 - Detection -   eval_score = 41.41
2023-04-19 21:19:14,410 - Detection -   train_loss = 0.44640178605914116
2023-04-19 21:19:15,233 - Detection - ***** Epoch: 22: Eval results *****
2023-04-19 21:19:15,233 - Detection -   best_eval_score = 43.86
2023-04-19 21:19:15,233 - Detection -   eval_score = 43.29
2023-04-19 21:19:15,233 - Detection -   train_loss = 0.46496906876564026
2023-04-19 21:19:16,055 - Detection - ***** Epoch: 23: Eval results *****
2023-04-19 21:19:16,055 - Detection -   best_eval_score = 43.86
2023-04-19 21:19:16,055 - Detection -   eval_score = 42.13
2023-04-19 21:19:16,055 - Detection -   train_loss = 0.44148071482777596
2023-04-19 21:19:16,056 - Detection - Training Finished...
2023-04-19 21:19:16,056 - Detection - Testing begin...
2023-04-19 21:19:18,133 - Detection - ***** Test: Confusion Matrix *****
2023-04-19 21:19:18,134 - Detection - [[   1    0    0 ...    0    0   14]
 [   0    1    0 ...    0    0   14]
 [   0    0    1 ...    0    0    7]
 ...
 [   0    0    0 ...    0    0    8]
 [   0    0    0 ...    0    0   10]
 [   2    1    6 ...    0    0 2893]]
2023-04-19 21:19:18,134 - Detection - ***** Test results *****
2023-04-19 21:19:18,134 - Detection -   Acc = 85.55
2023-04-19 21:19:18,134 - Detection -   F1 = 39.0125
2023-04-19 21:19:18,134 - Detection -   F1-known = 37.6223
2023-04-19 21:19:18,134 - Detection -   F1-open = 91.8413
2023-04-19 21:19:18,134 - Detection - Testing finished...
2023-04-19 21:19:18,134 - Detection - Results saved in results/results_DA-ADB.csv
2023-04-19 21:19:18,154 - Detection - Open Intent Detection Finished...
