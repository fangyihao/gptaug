2023-04-23 20:00:13,992 - Detection - Open Intent Detection Begin...
2023-04-23 20:00:13,992 - Detection - Parameters Initialization...
2023-04-23 20:00:13,993 - Detection - ============================== Params ==============================
2023-04-23 20:00:13,993 - Detection - type:	open_intent_detection
2023-04-23 20:00:13,993 - Detection - logger_name:	Detection
2023-04-23 20:00:13,993 - Detection - log_dir:	logs
2023-04-23 20:00:13,993 - Detection - dataset:	stackoverflow_cg
2023-04-23 20:00:13,993 - Detection - known_cls_ratio:	0.5
2023-04-23 20:00:13,993 - Detection - labeled_ratio:	1.0
2023-04-23 20:00:13,993 - Detection - method:	ADB
2023-04-23 20:00:13,993 - Detection - train:	True
2023-04-23 20:00:13,993 - Detection - pretrain:	True
2023-04-23 20:00:13,993 - Detection - save_model:	False
2023-04-23 20:00:13,993 - Detection - backbone:	bert_boost
2023-04-23 20:00:13,993 - Detection - config_file_name:	ADB
2023-04-23 20:00:13,993 - Detection - seed:	6
2023-04-23 20:00:13,993 - Detection - gpu_id:	0
2023-04-23 20:00:13,993 - Detection - pipe_results_path:	pipe_results
2023-04-23 20:00:13,993 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-23 20:00:13,993 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-23 20:00:13,993 - Detection - model_dir:	models
2023-04-23 20:00:13,993 - Detection - load_pretrained_method:	None
2023-04-23 20:00:13,993 - Detection - result_dir:	results
2023-04-23 20:00:13,993 - Detection - results_file_name:	results_ADB-BOOST-WP-10.csv
2023-04-23 20:00:13,993 - Detection - save_results:	True
2023-04-23 20:00:13,993 - Detection - loss_fct:	CrossEntropyLoss
2023-04-23 20:00:13,993 - Detection - boost_method:	WP-10
2023-04-23 20:00:13,993 - Detection - boost_start_score:	70.0
2023-04-23 20:00:13,993 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.5_1.0_bert_boost_6
2023-04-23 20:00:13,993 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.5_1.0_bert_boost_6/models
2023-04-23 20:00:13,993 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-23 20:00:13,993 - Detection - num_train_epochs:	100
2023-04-23 20:00:13,993 - Detection - num_labels:	None
2023-04-23 20:00:13,993 - Detection - max_seq_length:	None
2023-04-23 20:00:13,993 - Detection - freeze_backbone_parameters:	True
2023-04-23 20:00:13,993 - Detection - feat_dim:	768
2023-04-23 20:00:13,993 - Detection - warmup_proportion:	0.1
2023-04-23 20:00:13,993 - Detection - lr_boundary:	0.05
2023-04-23 20:00:13,993 - Detection - lr:	2e-05
2023-04-23 20:00:13,993 - Detection - activation:	relu
2023-04-23 20:00:13,993 - Detection - train_batch_size:	128
2023-04-23 20:00:13,994 - Detection - eval_batch_size:	64
2023-04-23 20:00:13,994 - Detection - test_batch_size:	64
2023-04-23 20:00:13,994 - Detection - wait_patient:	10
2023-04-23 20:00:13,994 - Detection - ============================== End Params ==============================
2023-04-23 20:00:13,994 - Detection - Data and Model Preparation...
2023-04-23 20:00:13,994 - Detection - The number of known intents is 10
2023-04-23 20:00:13,994 - Detection - Lists of known labels are: ['svn', 'hibernate', 'excel', 'haskell', 'linq', 'bash', 'sharepoint', 'scala', 'drupal', 'oracle']
2023-04-23 20:00:14,002 - Detection - Number of labeled training samples = 1218
2023-04-23 20:00:14,003 - Detection - Number of unlabeled training samples = 1573
2023-04-23 20:00:14,005 - Detection - Number of evaluation samples = 722
2023-04-23 20:00:14,011 - Detection - Number of testing samples = 2905
2023-04-23 20:00:18,149 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-23 20:00:19,810 - Detection - Pre-training Begin...
2023-04-23 20:00:22,157 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 20:00:22,157 - Detection -   best_eval_score = 0
2023-04-23 20:00:22,157 - Detection -   eval_score = 9.42
2023-04-23 20:00:22,157 - Detection -   train_loss = 2.306558609008789
2023-04-23 20:00:23,938 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 20:00:23,938 - Detection -   best_eval_score = 9.42
2023-04-23 20:00:23,938 - Detection -   eval_score = 13.99
2023-04-23 20:00:23,938 - Detection -   train_loss = 2.295027804374695
2023-04-23 20:00:25,722 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 20:00:25,723 - Detection -   best_eval_score = 13.99
2023-04-23 20:00:25,723 - Detection -   eval_score = 21.75
2023-04-23 20:00:25,723 - Detection -   train_loss = 2.270989465713501
2023-04-23 20:00:27,513 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 20:00:27,513 - Detection -   best_eval_score = 21.75
2023-04-23 20:00:27,513 - Detection -   eval_score = 23.13
2023-04-23 20:00:27,513 - Detection -   train_loss = 2.239988827705383
2023-04-23 20:00:29,319 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 20:00:29,319 - Detection -   best_eval_score = 23.13
2023-04-23 20:00:29,319 - Detection -   eval_score = 29.78
2023-04-23 20:00:29,319 - Detection -   train_loss = 2.182626819610596
2023-04-23 20:00:31,114 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 20:00:31,114 - Detection -   best_eval_score = 29.78
2023-04-23 20:00:31,114 - Detection -   eval_score = 38.37
2023-04-23 20:00:31,114 - Detection -   train_loss = 2.0911092281341555
2023-04-23 20:00:32,914 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 20:00:32,914 - Detection -   best_eval_score = 38.37
2023-04-23 20:00:32,914 - Detection -   eval_score = 44.74
2023-04-23 20:00:32,914 - Detection -   train_loss = 1.9308177828788757
2023-04-23 20:00:34,719 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 20:00:34,719 - Detection -   best_eval_score = 44.74
2023-04-23 20:00:34,719 - Detection -   eval_score = 54.71
2023-04-23 20:00:34,719 - Detection -   train_loss = 1.6833338022232056
2023-04-23 20:00:36,543 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 20:00:36,543 - Detection -   best_eval_score = 54.71
2023-04-23 20:00:36,543 - Detection -   eval_score = 67.73
2023-04-23 20:00:36,543 - Detection -   train_loss = 1.4059303283691407
2023-04-23 20:00:38,484 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 20:00:38,484 - Detection -   best_eval_score = 67.73
2023-04-23 20:00:38,484 - Detection -   eval_score = 76.04
2023-04-23 20:00:38,484 - Detection -   train_loss = 1.1067870736122132
2023-04-23 20:00:45,105 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 20:00:45,105 - Detection -   best_eval_score = 76.04
2023-04-23 20:00:45,105 - Detection -   eval_score = 80.33
2023-04-23 20:00:45,105 - Detection -   train_loss = 0.872029161453247
2023-04-23 20:00:50,555 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 20:00:50,555 - Detection -   best_eval_score = 80.33
2023-04-23 20:00:50,555 - Detection -   eval_score = 67.45
2023-04-23 20:00:50,555 - Detection -   train_loss = 0.6620437920093536
2023-04-23 20:00:55,425 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 20:00:55,425 - Detection -   best_eval_score = 80.33
2023-04-23 20:00:55,425 - Detection -   eval_score = 77.7
2023-04-23 20:00:55,425 - Detection -   train_loss = 0.657348221540451
2023-04-23 20:01:00,236 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 20:01:00,236 - Detection -   best_eval_score = 80.33
2023-04-23 20:01:00,236 - Detection -   eval_score = 78.25
2023-04-23 20:01:00,236 - Detection -   train_loss = 0.6350437462329864
2023-04-23 20:01:05,127 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 20:01:05,127 - Detection -   best_eval_score = 80.33
2023-04-23 20:01:05,127 - Detection -   eval_score = 83.8
2023-04-23 20:01:05,127 - Detection -   train_loss = 0.5456163942813873
2023-04-23 20:01:10,143 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 20:01:10,143 - Detection -   best_eval_score = 83.8
2023-04-23 20:01:10,143 - Detection -   eval_score = 86.29
2023-04-23 20:01:10,143 - Detection -   train_loss = 0.42965227663516997
2023-04-23 20:01:14,277 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 20:01:14,278 - Detection -   best_eval_score = 86.29
2023-04-23 20:01:14,278 - Detection -   eval_score = 85.46
2023-04-23 20:01:14,278 - Detection -   train_loss = 0.37859581410884857
2023-04-23 20:01:18,424 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 20:01:18,424 - Detection -   best_eval_score = 86.29
2023-04-23 20:01:18,424 - Detection -   eval_score = 83.8
2023-04-23 20:01:18,424 - Detection -   train_loss = 0.3391299247741699
2023-04-23 20:01:22,562 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 20:01:22,562 - Detection -   best_eval_score = 86.29
2023-04-23 20:01:22,562 - Detection -   eval_score = 85.6
2023-04-23 20:01:22,562 - Detection -   train_loss = 0.33868115246295927
2023-04-23 20:01:26,206 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 20:01:26,206 - Detection -   best_eval_score = 86.29
2023-04-23 20:01:26,206 - Detection -   eval_score = 84.35
2023-04-23 20:01:26,206 - Detection -   train_loss = 0.24795723408460618
2023-04-23 20:01:29,759 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 20:01:29,759 - Detection -   best_eval_score = 86.29
2023-04-23 20:01:29,759 - Detection -   eval_score = 85.18
2023-04-23 20:01:29,759 - Detection -   train_loss = 0.22954722493886948
2023-04-23 20:01:33,173 - Detection - ***** Epoch: 22: Eval results *****
2023-04-23 20:01:33,173 - Detection -   best_eval_score = 86.29
2023-04-23 20:01:33,173 - Detection -   eval_score = 85.87
2023-04-23 20:01:33,173 - Detection -   train_loss = 0.2116122856736183
2023-04-23 20:01:36,621 - Detection - ***** Epoch: 23: Eval results *****
2023-04-23 20:01:36,621 - Detection -   best_eval_score = 86.29
2023-04-23 20:01:36,621 - Detection -   eval_score = 86.29
2023-04-23 20:01:36,621 - Detection -   train_loss = 0.18777433335781096
2023-04-23 20:01:40,081 - Detection - ***** Epoch: 24: Eval results *****
2023-04-23 20:01:40,081 - Detection -   best_eval_score = 86.29
2023-04-23 20:01:40,081 - Detection -   eval_score = 85.73
2023-04-23 20:01:40,081 - Detection -   train_loss = 0.18193759843707086
2023-04-23 20:01:43,552 - Detection - ***** Epoch: 25: Eval results *****
2023-04-23 20:01:43,552 - Detection -   best_eval_score = 86.29
2023-04-23 20:01:43,552 - Detection -   eval_score = 85.73
2023-04-23 20:01:43,552 - Detection -   train_loss = 0.17489491105079652
2023-04-23 20:01:46,491 - Detection - ***** Epoch: 26: Eval results *****
2023-04-23 20:01:46,491 - Detection -   best_eval_score = 86.29
2023-04-23 20:01:46,491 - Detection -   eval_score = 85.87
2023-04-23 20:01:46,491 - Detection -   train_loss = 0.16018628776073457
2023-04-23 20:01:46,491 - Detection - Pre-training finished...
2023-04-23 20:01:46,492 - Detection - Training Begin...
2023-04-23 20:01:49,479 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 20:01:49,479 - Detection -   best_eval_score = 0
2023-04-23 20:01:49,479 - Detection -   eval_score = 0.0
2023-04-23 20:01:49,479 - Detection -   train_loss = 7.712857246398926
2023-04-23 20:01:51,367 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 20:01:51,367 - Detection -   best_eval_score = 0
2023-04-23 20:01:51,368 - Detection -   eval_score = 0.0
2023-04-23 20:01:51,368 - Detection -   train_loss = 7.374112606048584
2023-04-23 20:01:53,253 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 20:01:53,254 - Detection -   best_eval_score = 0
2023-04-23 20:01:53,254 - Detection -   eval_score = 0.0
2023-04-23 20:01:53,254 - Detection -   train_loss = 6.990390777587891
2023-04-23 20:01:55,144 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 20:01:55,144 - Detection -   best_eval_score = 0
2023-04-23 20:01:55,144 - Detection -   eval_score = 0.0
2023-04-23 20:01:55,144 - Detection -   train_loss = 6.583512592315674
2023-04-23 20:01:57,033 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 20:01:57,034 - Detection -   best_eval_score = 0
2023-04-23 20:01:57,034 - Detection -   eval_score = 0.0
2023-04-23 20:01:57,034 - Detection -   train_loss = 6.146034574508667
2023-04-23 20:01:58,917 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 20:01:58,917 - Detection -   best_eval_score = 0
2023-04-23 20:01:58,917 - Detection -   eval_score = 0.51
2023-04-23 20:01:58,917 - Detection -   train_loss = 5.64337010383606
2023-04-23 20:02:00,807 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 20:02:00,808 - Detection -   best_eval_score = 0.51
2023-04-23 20:02:00,808 - Detection -   eval_score = 3.13
2023-04-23 20:02:00,808 - Detection -   train_loss = 5.066409540176392
2023-04-23 20:02:02,694 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 20:02:02,694 - Detection -   best_eval_score = 3.13
2023-04-23 20:02:02,694 - Detection -   eval_score = 11.79
2023-04-23 20:02:02,694 - Detection -   train_loss = 4.543064832687378
2023-04-23 20:02:04,590 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 20:02:04,590 - Detection -   best_eval_score = 11.79
2023-04-23 20:02:04,590 - Detection -   eval_score = 24.11
2023-04-23 20:02:04,590 - Detection -   train_loss = 4.0168557405471805
2023-04-23 20:02:06,515 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 20:02:06,515 - Detection -   best_eval_score = 24.11
2023-04-23 20:02:06,515 - Detection -   eval_score = 43.5
2023-04-23 20:02:06,515 - Detection -   train_loss = 3.461218523979187
2023-04-23 20:02:08,436 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 20:02:08,436 - Detection -   best_eval_score = 43.5
2023-04-23 20:02:08,436 - Detection -   eval_score = 58.78
2023-04-23 20:02:08,436 - Detection -   train_loss = 2.865061044692993
2023-04-23 20:02:10,353 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 20:02:10,354 - Detection -   best_eval_score = 58.78
2023-04-23 20:02:10,354 - Detection -   eval_score = 65.71
2023-04-23 20:02:10,354 - Detection -   train_loss = 2.409116268157959
2023-04-23 20:02:12,277 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 20:02:12,277 - Detection -   best_eval_score = 65.71
2023-04-23 20:02:12,277 - Detection -   eval_score = 71.1
2023-04-23 20:02:12,277 - Detection -   train_loss = 1.9365358471870422
2023-04-23 20:02:20,857 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 20:02:20,857 - Detection -   best_eval_score = 71.1
2023-04-23 20:02:20,857 - Detection -   eval_score = 76.82
2023-04-23 20:02:20,857 - Detection -   train_loss = 1.5927218079566956
2023-04-23 20:02:26,951 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 20:02:26,952 - Detection -   best_eval_score = 76.82
2023-04-23 20:02:26,952 - Detection -   eval_score = 77.48
2023-04-23 20:02:26,952 - Detection -   train_loss = 1.4353824496269225
2023-04-23 20:02:32,254 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 20:02:32,254 - Detection -   best_eval_score = 77.48
2023-04-23 20:02:32,254 - Detection -   eval_score = 77.81
2023-04-23 20:02:32,254 - Detection -   train_loss = 1.5971919536590575
2023-04-23 20:02:37,438 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 20:02:37,438 - Detection -   best_eval_score = 77.81
2023-04-23 20:02:37,438 - Detection -   eval_score = 77.76
2023-04-23 20:02:37,438 - Detection -   train_loss = 1.6909715414047242
2023-04-23 20:02:42,523 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 20:02:42,523 - Detection -   best_eval_score = 77.81
2023-04-23 20:02:42,523 - Detection -   eval_score = 77.92
2023-04-23 20:02:42,523 - Detection -   train_loss = 1.7355477333068847
2023-04-23 20:02:47,570 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 20:02:47,571 - Detection -   best_eval_score = 77.92
2023-04-23 20:02:47,571 - Detection -   eval_score = 77.89
2023-04-23 20:02:47,571 - Detection -   train_loss = 1.7399520397186279
2023-04-23 20:02:52,623 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 20:02:52,623 - Detection -   best_eval_score = 77.92
2023-04-23 20:02:52,623 - Detection -   eval_score = 77.64
2023-04-23 20:02:52,623 - Detection -   train_loss = 1.7831104397773743
2023-04-23 20:02:57,643 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 20:02:57,643 - Detection -   best_eval_score = 77.92
2023-04-23 20:02:57,643 - Detection -   eval_score = 77.75
2023-04-23 20:02:57,643 - Detection -   train_loss = 1.7479750394821167
2023-04-23 20:03:02,754 - Detection - ***** Epoch: 22: Eval results *****
2023-04-23 20:03:02,754 - Detection -   best_eval_score = 77.92
2023-04-23 20:03:02,754 - Detection -   eval_score = 77.76
2023-04-23 20:03:02,754 - Detection -   train_loss = 1.7702307105064392
2023-04-23 20:03:07,836 - Detection - ***** Epoch: 23: Eval results *****
2023-04-23 20:03:07,836 - Detection -   best_eval_score = 77.92
2023-04-23 20:03:07,836 - Detection -   eval_score = 77.83
2023-04-23 20:03:07,836 - Detection -   train_loss = 1.744848620891571
2023-04-23 20:03:13,087 - Detection - ***** Epoch: 24: Eval results *****
2023-04-23 20:03:13,087 - Detection -   best_eval_score = 77.92
2023-04-23 20:03:13,087 - Detection -   eval_score = 77.83
2023-04-23 20:03:13,087 - Detection -   train_loss = 1.7333175182342528
2023-04-23 20:03:18,137 - Detection - ***** Epoch: 25: Eval results *****
2023-04-23 20:03:18,137 - Detection -   best_eval_score = 77.92
2023-04-23 20:03:18,137 - Detection -   eval_score = 77.7
2023-04-23 20:03:18,137 - Detection -   train_loss = 1.8172948718070985
2023-04-23 20:03:23,141 - Detection - ***** Epoch: 26: Eval results *****
2023-04-23 20:03:23,141 - Detection -   best_eval_score = 77.92
2023-04-23 20:03:23,141 - Detection -   eval_score = 77.62
2023-04-23 20:03:23,141 - Detection -   train_loss = 1.7881178498268127
2023-04-23 20:03:28,178 - Detection - ***** Epoch: 27: Eval results *****
2023-04-23 20:03:28,178 - Detection -   best_eval_score = 77.92
2023-04-23 20:03:28,178 - Detection -   eval_score = 77.68
2023-04-23 20:03:28,179 - Detection -   train_loss = 1.7460188508033752
2023-04-23 20:03:33,147 - Detection - ***** Epoch: 28: Eval results *****
2023-04-23 20:03:33,147 - Detection -   best_eval_score = 77.92
2023-04-23 20:03:33,147 - Detection -   eval_score = 77.7
2023-04-23 20:03:33,148 - Detection -   train_loss = 1.7798454523086549
2023-04-23 20:03:33,148 - Detection - Training Finished...
2023-04-23 20:03:33,148 - Detection - Testing begin...
2023-04-23 20:03:35,731 - Detection - ***** Test: Confusion Matrix *****
2023-04-23 20:03:35,731 - Detection - [[120   1   0   5   1   3   0   0   6   1  12]
 [  1  83   0   3   1   2   0   1   2   9  26]
 [  0   0 102   6   0   3   2   7   3   2  15]
 [  0   0   3  99   0   2   1   2   1   0  14]
 [  0   0   1   3 108   0   0   2   2   3  12]
 [  0   0   3  10   0  98   0   2   8   3  15]
 [  0   1   2   2   0   4 127   0   7   0  28]
 [  0   0   0  14   0   0   0  86   2   2  20]
 [  0   0   0   3   1   1   2   0 106   0  15]
 [  0   0   3   3   1   1   1   0   2 103  13]
 [ 44  32  70 229  23 114 117  85 126  41 665]]
2023-04-23 20:03:35,731 - Detection - ***** Test results *****
2023-04-23 20:03:35,731 - Detection -   Acc = 58.42
2023-04-23 20:03:35,731 - Detection -   F1 = 61.639
2023-04-23 20:03:35,731 - Detection -   F1-known = 62.217
2023-04-23 20:03:35,731 - Detection -   F1-open = 55.8589
2023-04-23 20:03:35,731 - Detection - Testing finished...
2023-04-23 20:03:35,731 - Detection - Results saved in results/results_ADB-BOOST-WP-10.csv
2023-04-23 20:03:35,751 - Detection - Open Intent Detection Finished...
