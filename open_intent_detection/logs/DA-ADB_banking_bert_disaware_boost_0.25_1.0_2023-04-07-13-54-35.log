2023-04-07 13:54:35,414 - Detection - Open Intent Detection Begin...
2023-04-07 13:54:35,414 - Detection - Parameters Initialization...
2023-04-07 13:54:35,414 - Detection - ============================== Params ==============================
2023-04-07 13:54:35,414 - Detection - type:	open_intent_detection
2023-04-07 13:54:35,414 - Detection - logger_name:	Detection
2023-04-07 13:54:35,414 - Detection - log_dir:	logs
2023-04-07 13:54:35,414 - Detection - dataset:	banking
2023-04-07 13:54:35,414 - Detection - known_cls_ratio:	0.25
2023-04-07 13:54:35,414 - Detection - labeled_ratio:	1.0
2023-04-07 13:54:35,414 - Detection - method:	DA-ADB
2023-04-07 13:54:35,414 - Detection - train:	True
2023-04-07 13:54:35,414 - Detection - pretrain:	True
2023-04-07 13:54:35,414 - Detection - save_model:	True
2023-04-07 13:54:35,414 - Detection - backbone:	bert_disaware_boost
2023-04-07 13:54:35,414 - Detection - config_file_name:	DA-ADB
2023-04-07 13:54:35,414 - Detection - seed:	0
2023-04-07 13:54:35,414 - Detection - gpu_id:	0
2023-04-07 13:54:35,414 - Detection - pipe_results_path:	pipe_results
2023-04-07 13:54:35,414 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-07 13:54:35,414 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-07 13:54:35,414 - Detection - model_dir:	models
2023-04-07 13:54:35,414 - Detection - load_pretrained_method:	None
2023-04-07 13:54:35,414 - Detection - result_dir:	results
2023-04-07 13:54:35,414 - Detection - results_file_name:	results_DA-ADB-BOOST.csv
2023-04-07 13:54:35,414 - Detection - save_results:	True
2023-04-07 13:54:35,415 - Detection - loss_fct:	CrossEntropyLoss
2023-04-07 13:54:35,415 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_0.25_1.0_bert_disaware_boost_0
2023-04-07 13:54:35,415 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_0.25_1.0_bert_disaware_boost_0/models
2023-04-07 13:54:35,415 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-07 13:54:35,415 - Detection - num_train_epochs:	100
2023-04-07 13:54:35,415 - Detection - num_labels:	None
2023-04-07 13:54:35,415 - Detection - max_seq_length:	None
2023-04-07 13:54:35,415 - Detection - freeze_backbone_parameters:	True
2023-04-07 13:54:35,415 - Detection - feat_dim:	768
2023-04-07 13:54:35,415 - Detection - warmup_proportion:	0.1
2023-04-07 13:54:35,415 - Detection - scale:	4
2023-04-07 13:54:35,415 - Detection - lr_boundary:	0.05
2023-04-07 13:54:35,415 - Detection - lr:	2e-05
2023-04-07 13:54:35,415 - Detection - activation:	relu
2023-04-07 13:54:35,415 - Detection - train_batch_size:	128
2023-04-07 13:54:35,415 - Detection - eval_batch_size:	64
2023-04-07 13:54:35,415 - Detection - test_batch_size:	64
2023-04-07 13:54:35,415 - Detection - wait_patient:	10
2023-04-07 13:54:35,415 - Detection - ============================== End Params ==============================
2023-04-07 13:54:35,415 - Detection - Data and Model Preparation...
2023-04-07 13:54:35,415 - Detection - The number of known intents is 19
2023-04-07 13:54:35,416 - Detection - Lists of known labels are: ['pending_top_up', 'why_verify_identity', 'top_up_failed', 'supported_cards_and_currencies', 'exchange_via_app', 'declined_card_payment', 'unable_to_verify_identity', 'exchange_rate', 'passcode_forgotten', 'verify_my_identity', 'declined_cash_withdrawal', 'top_up_limits', 'apple_pay_or_google_pay', 'lost_or_stolen_card', 'lost_or_stolen_phone', 'balance_not_updated_after_cheque_or_cash_deposit', 'change_pin', 'getting_virtual_card', 'pin_blocked']
2023-04-07 13:54:35,442 - Detection - Number of labeled training samples = 2119
2023-04-07 13:54:35,442 - Detection - Number of unlabeled training samples = 6884
2023-04-07 13:54:35,444 - Detection - Number of evaluation samples = 234
2023-04-07 13:54:35,451 - Detection - Number of testing samples = 3080
2023-04-07 13:54:42,444 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-07 13:54:42,523 - Detection - Pre-training Begin...
2023-04-07 13:54:47,556 - Detection - ***** Epoch: 1: Eval results *****
2023-04-07 13:54:47,556 - Detection -   best_eval_score = 0
2023-04-07 13:54:47,556 - Detection -   eval_score = 0.63
2023-04-07 13:54:47,556 - Detection -   train_loss = 2.945636973661535
2023-04-07 13:54:52,062 - Detection - ***** Epoch: 2: Eval results *****
2023-04-07 13:54:52,062 - Detection -   best_eval_score = 0.63
2023-04-07 13:54:52,062 - Detection -   eval_score = 0.76
2023-04-07 13:54:52,062 - Detection -   train_loss = 2.9285099506378174
2023-04-07 13:54:56,583 - Detection - ***** Epoch: 3: Eval results *****
2023-04-07 13:54:56,583 - Detection -   best_eval_score = 0.76
2023-04-07 13:54:56,584 - Detection -   eval_score = 1.32
2023-04-07 13:54:56,584 - Detection -   train_loss = 2.9088826880735508
2023-04-07 13:55:01,117 - Detection - ***** Epoch: 4: Eval results *****
2023-04-07 13:55:01,117 - Detection -   best_eval_score = 1.32
2023-04-07 13:55:01,117 - Detection -   eval_score = 1.53
2023-04-07 13:55:01,117 - Detection -   train_loss = 2.8899084820466885
2023-04-07 13:55:05,678 - Detection - ***** Epoch: 5: Eval results *****
2023-04-07 13:55:05,678 - Detection -   best_eval_score = 1.53
2023-04-07 13:55:05,679 - Detection -   eval_score = 3.76
2023-04-07 13:55:05,679 - Detection -   train_loss = 2.8544698743259205
2023-04-07 13:55:10,247 - Detection - ***** Epoch: 6: Eval results *****
2023-04-07 13:55:10,247 - Detection -   best_eval_score = 3.76
2023-04-07 13:55:10,247 - Detection -   eval_score = 22.96
2023-04-07 13:55:10,247 - Detection -   train_loss = 2.7718766577103557
2023-04-07 13:55:14,834 - Detection - ***** Epoch: 7: Eval results *****
2023-04-07 13:55:14,834 - Detection -   best_eval_score = 22.96
2023-04-07 13:55:14,834 - Detection -   eval_score = 44.85
2023-04-07 13:55:14,834 - Detection -   train_loss = 2.6004647226894604
2023-04-07 13:55:19,431 - Detection - ***** Epoch: 8: Eval results *****
2023-04-07 13:55:19,431 - Detection -   best_eval_score = 44.85
2023-04-07 13:55:19,431 - Detection -   eval_score = 60.81
2023-04-07 13:55:19,431 - Detection -   train_loss = 2.3313287987428555
2023-04-07 13:55:24,045 - Detection - ***** Epoch: 9: Eval results *****
2023-04-07 13:55:24,045 - Detection -   best_eval_score = 60.81
2023-04-07 13:55:24,045 - Detection -   eval_score = 73.52
2023-04-07 13:55:24,045 - Detection -   train_loss = 1.9804589257520788
2023-04-07 13:57:48,085 - Detection - ***** Epoch: 10: Eval results *****
2023-04-07 13:57:48,085 - Detection -   best_eval_score = 73.52
2023-04-07 13:57:48,085 - Detection -   eval_score = 84.03
2023-04-07 13:57:48,085 - Detection -   train_loss = 1.6642274505951826
2023-04-07 13:59:45,930 - Detection - ***** Epoch: 11: Eval results *****
2023-04-07 13:59:45,930 - Detection -   best_eval_score = 84.03
2023-04-07 13:59:45,931 - Detection -   eval_score = 89.07
2023-04-07 13:59:45,931 - Detection -   train_loss = 1.4550465625875137
2023-04-07 14:01:41,173 - Detection - ***** Epoch: 12: Eval results *****
2023-04-07 14:01:41,173 - Detection -   best_eval_score = 89.07
2023-04-07 14:01:41,173 - Detection -   eval_score = 85.19
2023-04-07 14:01:41,173 - Detection -   train_loss = 1.306377144420848
2023-04-07 14:03:05,715 - Detection - ***** Epoch: 13: Eval results *****
2023-04-07 14:03:05,715 - Detection -   best_eval_score = 89.07
2023-04-07 14:03:05,715 - Detection -   eval_score = 89.68
2023-04-07 14:03:05,715 - Detection -   train_loss = 1.2126955214668722
2023-04-07 14:04:37,549 - Detection - ***** Epoch: 14: Eval results *****
2023-04-07 14:04:37,549 - Detection -   best_eval_score = 89.68
2023-04-07 14:04:37,549 - Detection -   eval_score = 86.74
2023-04-07 14:04:37,549 - Detection -   train_loss = 1.1370927936890547
2023-04-07 14:05:44,413 - Detection - ***** Epoch: 15: Eval results *****
2023-04-07 14:05:44,413 - Detection -   best_eval_score = 89.68
2023-04-07 14:05:44,414 - Detection -   eval_score = 92.29
2023-04-07 14:05:44,414 - Detection -   train_loss = 1.0798267266329598
2023-04-07 14:06:54,384 - Detection - ***** Epoch: 16: Eval results *****
2023-04-07 14:06:54,385 - Detection -   best_eval_score = 92.29
2023-04-07 14:06:54,385 - Detection -   eval_score = 90.63
2023-04-07 14:06:54,385 - Detection -   train_loss = 1.037110521512873
2023-04-07 14:07:50,928 - Detection - ***** Epoch: 17: Eval results *****
2023-04-07 14:07:50,928 - Detection -   best_eval_score = 92.29
2023-04-07 14:07:50,928 - Detection -   eval_score = 93.78
2023-04-07 14:07:50,928 - Detection -   train_loss = 0.9961752155247856
2023-04-07 14:08:47,625 - Detection - ***** Epoch: 18: Eval results *****
2023-04-07 14:08:47,626 - Detection -   best_eval_score = 93.78
2023-04-07 14:08:47,626 - Detection -   eval_score = 93.33
2023-04-07 14:08:47,626 - Detection -   train_loss = 0.9566715289564693
2023-04-07 14:09:36,685 - Detection - ***** Epoch: 19: Eval results *****
2023-04-07 14:09:36,685 - Detection -   best_eval_score = 93.78
2023-04-07 14:09:36,685 - Detection -   eval_score = 94.03
2023-04-07 14:09:36,685 - Detection -   train_loss = 0.9335690456278184
2023-04-07 14:10:24,047 - Detection - ***** Epoch: 20: Eval results *****
2023-04-07 14:10:24,047 - Detection -   best_eval_score = 94.03
2023-04-07 14:10:24,047 - Detection -   eval_score = 93.69
2023-04-07 14:10:24,047 - Detection -   train_loss = 0.9050981297212488
2023-04-07 14:11:06,891 - Detection - ***** Epoch: 21: Eval results *****
2023-04-07 14:11:06,891 - Detection -   best_eval_score = 94.03
2023-04-07 14:11:06,891 - Detection -   eval_score = 94.86
2023-04-07 14:11:06,891 - Detection -   train_loss = 0.8842486283358406
2023-04-07 14:11:51,398 - Detection - ***** Epoch: 22: Eval results *****
2023-04-07 14:11:51,398 - Detection -   best_eval_score = 94.86
2023-04-07 14:11:51,398 - Detection -   eval_score = 94.86
2023-04-07 14:11:51,398 - Detection -   train_loss = 0.8707783502690932
2023-04-07 14:12:31,775 - Detection - ***** Epoch: 23: Eval results *****
2023-04-07 14:12:31,775 - Detection -   best_eval_score = 94.86
2023-04-07 14:12:31,775 - Detection -   eval_score = 95.33
2023-04-07 14:12:31,775 - Detection -   train_loss = 0.8440745262538686
2023-04-07 14:13:09,857 - Detection - ***** Epoch: 24: Eval results *****
2023-04-07 14:13:09,857 - Detection -   best_eval_score = 95.33
2023-04-07 14:13:09,857 - Detection -   eval_score = 95.33
2023-04-07 14:13:09,857 - Detection -   train_loss = 0.82618147836012
2023-04-07 14:13:48,500 - Detection - ***** Epoch: 25: Eval results *****
2023-04-07 14:13:48,500 - Detection -   best_eval_score = 95.33
2023-04-07 14:13:48,500 - Detection -   eval_score = 94.85
2023-04-07 14:13:48,500 - Detection -   train_loss = 0.8090785531436696
2023-04-07 14:14:23,839 - Detection - ***** Epoch: 26: Eval results *****
2023-04-07 14:14:23,839 - Detection -   best_eval_score = 95.33
2023-04-07 14:14:23,839 - Detection -   eval_score = 94.77
2023-04-07 14:14:23,839 - Detection -   train_loss = 0.7954616616753971
2023-04-07 14:14:55,417 - Detection - ***** Epoch: 27: Eval results *****
2023-04-07 14:14:55,417 - Detection -   best_eval_score = 95.33
2023-04-07 14:14:55,417 - Detection -   eval_score = 95.32
2023-04-07 14:14:55,417 - Detection -   train_loss = 0.7791980855605182
2023-04-07 14:15:25,085 - Detection - ***** Epoch: 28: Eval results *****
2023-04-07 14:15:25,085 - Detection -   best_eval_score = 95.33
2023-04-07 14:15:25,085 - Detection -   eval_score = 95.32
2023-04-07 14:15:25,085 - Detection -   train_loss = 0.7730081396944383
2023-04-07 14:15:54,334 - Detection - ***** Epoch: 29: Eval results *****
2023-04-07 14:15:54,334 - Detection -   best_eval_score = 95.33
2023-04-07 14:15:54,334 - Detection -   eval_score = 94.95
2023-04-07 14:15:54,334 - Detection -   train_loss = 0.7571956690619973
2023-04-07 14:16:20,615 - Detection - ***** Epoch: 30: Eval results *****
2023-04-07 14:16:20,615 - Detection -   best_eval_score = 95.33
2023-04-07 14:16:20,615 - Detection -   eval_score = 94.95
2023-04-07 14:16:20,615 - Detection -   train_loss = 0.7477988179992227
2023-04-07 14:16:47,771 - Detection - ***** Epoch: 31: Eval results *****
2023-04-07 14:16:47,772 - Detection -   best_eval_score = 95.33
2023-04-07 14:16:47,772 - Detection -   eval_score = 94.95
2023-04-07 14:16:47,772 - Detection -   train_loss = 0.7397287803537705
2023-04-07 14:17:12,065 - Detection - ***** Epoch: 32: Eval results *****
2023-04-07 14:17:12,066 - Detection -   best_eval_score = 95.33
2023-04-07 14:17:12,066 - Detection -   eval_score = 94.95
2023-04-07 14:17:12,066 - Detection -   train_loss = 0.7271069533684674
2023-04-07 14:17:33,519 - Detection - ***** Epoch: 33: Eval results *****
2023-04-07 14:17:33,519 - Detection -   best_eval_score = 95.33
2023-04-07 14:17:33,520 - Detection -   eval_score = 94.95
2023-04-07 14:17:33,520 - Detection -   train_loss = 0.7202683722271639
2023-04-07 14:17:33,520 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_0.25_1.0_bert_disaware_boost_0/models
2023-04-07 14:17:34,435 - Detection - Pre-training finished...
2023-04-07 14:17:34,436 - Detection - Training Begin...
2023-04-07 14:17:36,969 - Detection - ***** Epoch: 1: Eval results *****
2023-04-07 14:17:36,970 - Detection -   best_eval_score = 0
2023-04-07 14:17:36,970 - Detection -   eval_score = 9.48
2023-04-07 14:17:36,970 - Detection -   train_loss = 3.2054939129773308
2023-04-07 14:17:39,510 - Detection - ***** Epoch: 2: Eval results *****
2023-04-07 14:17:39,510 - Detection -   best_eval_score = 9.48
2023-04-07 14:17:39,510 - Detection -   eval_score = 27.96
2023-04-07 14:17:39,510 - Detection -   train_loss = 2.640421110041001
2023-04-07 14:17:42,058 - Detection - ***** Epoch: 3: Eval results *****
2023-04-07 14:17:42,058 - Detection -   best_eval_score = 27.96
2023-04-07 14:17:42,058 - Detection -   eval_score = 55.97
2023-04-07 14:17:42,058 - Detection -   train_loss = 1.9285924785277422
2023-04-07 14:17:44,608 - Detection - ***** Epoch: 4: Eval results *****
2023-04-07 14:17:44,608 - Detection -   best_eval_score = 55.97
2023-04-07 14:17:44,608 - Detection -   eval_score = 80.36
2023-04-07 14:17:44,608 - Detection -   train_loss = 1.2140057858298807
2023-04-07 14:17:47,160 - Detection - ***** Epoch: 5: Eval results *****
2023-04-07 14:17:47,160 - Detection -   best_eval_score = 80.36
2023-04-07 14:17:47,160 - Detection -   eval_score = 83.56
2023-04-07 14:17:47,160 - Detection -   train_loss = 0.7397721690290114
2023-04-07 14:17:49,719 - Detection - ***** Epoch: 6: Eval results *****
2023-04-07 14:17:49,719 - Detection -   best_eval_score = 83.56
2023-04-07 14:17:49,719 - Detection -   eval_score = 84.52
2023-04-07 14:17:49,719 - Detection -   train_loss = 0.6199164039948407
2023-04-07 14:17:52,283 - Detection - ***** Epoch: 7: Eval results *****
2023-04-07 14:17:52,283 - Detection -   best_eval_score = 84.52
2023-04-07 14:17:52,283 - Detection -   eval_score = 83.81
2023-04-07 14:17:52,283 - Detection -   train_loss = 0.599468445076662
2023-04-07 14:17:54,851 - Detection - ***** Epoch: 8: Eval results *****
2023-04-07 14:17:54,851 - Detection -   best_eval_score = 84.52
2023-04-07 14:17:54,851 - Detection -   eval_score = 84.1
2023-04-07 14:17:54,851 - Detection -   train_loss = 0.5901356830316431
2023-04-07 14:17:57,420 - Detection - ***** Epoch: 9: Eval results *****
2023-04-07 14:17:57,421 - Detection -   best_eval_score = 84.52
2023-04-07 14:17:57,421 - Detection -   eval_score = 84.13
2023-04-07 14:17:57,421 - Detection -   train_loss = 0.603522942346685
2023-04-07 14:17:59,991 - Detection - ***** Epoch: 10: Eval results *****
2023-04-07 14:17:59,991 - Detection -   best_eval_score = 84.52
2023-04-07 14:17:59,991 - Detection -   eval_score = 83.82
2023-04-07 14:17:59,991 - Detection -   train_loss = 0.609749238280689
2023-04-07 14:18:02,568 - Detection - ***** Epoch: 11: Eval results *****
2023-04-07 14:18:02,568 - Detection -   best_eval_score = 84.52
2023-04-07 14:18:02,568 - Detection -   eval_score = 83.63
2023-04-07 14:18:02,568 - Detection -   train_loss = 0.601861340158126
2023-04-07 14:18:05,146 - Detection - ***** Epoch: 12: Eval results *****
2023-04-07 14:18:05,147 - Detection -   best_eval_score = 84.52
2023-04-07 14:18:05,147 - Detection -   eval_score = 84.29
2023-04-07 14:18:05,147 - Detection -   train_loss = 0.6023834189947914
2023-04-07 14:18:07,729 - Detection - ***** Epoch: 13: Eval results *****
2023-04-07 14:18:07,729 - Detection -   best_eval_score = 84.52
2023-04-07 14:18:07,729 - Detection -   eval_score = 84.31
2023-04-07 14:18:07,729 - Detection -   train_loss = 0.600739053067039
2023-04-07 14:18:10,314 - Detection - ***** Epoch: 14: Eval results *****
2023-04-07 14:18:10,314 - Detection -   best_eval_score = 84.52
2023-04-07 14:18:10,314 - Detection -   eval_score = 83.82
2023-04-07 14:18:10,314 - Detection -   train_loss = 0.5999645380412831
2023-04-07 14:18:12,901 - Detection - ***** Epoch: 15: Eval results *****
2023-04-07 14:18:12,901 - Detection -   best_eval_score = 84.52
2023-04-07 14:18:12,902 - Detection -   eval_score = 83.98
2023-04-07 14:18:12,902 - Detection -   train_loss = 0.6092297364683712
2023-04-07 14:18:15,492 - Detection - ***** Epoch: 16: Eval results *****
2023-04-07 14:18:15,492 - Detection -   best_eval_score = 84.52
2023-04-07 14:18:15,492 - Detection -   eval_score = 83.63
2023-04-07 14:18:15,492 - Detection -   train_loss = 0.596077924265581
2023-04-07 14:18:15,493 - Detection - Training Finished...
2023-04-07 14:18:15,493 - Detection - Testing begin...
2023-04-07 14:18:18,527 - Detection - ***** Test: Confusion Matrix *****
2023-04-07 14:18:18,527 - Detection - [[  31    0    2    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    7]
 [   0   27    0    0    0    0    5    0    0    7    0    0    0    0
     0    0    0    0    0    1]
 [   1    0   32    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    7]
 [   0    0    0   34    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    6]
 [   0    0    0    0   35    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    5]
 [   0    0    0    0    0   35    0    0    0    0    0    0    0    0
     0    0    0    0    0    5]
 [   0    2    0    0    0    0   28    0    0    1    0    0    0    0
     0    0    0    0    0    9]
 [   0    0    0    0    0    0    0   38    0    0    0    0    0    0
     0    0    0    0    0    2]
 [   0    0    0    0    0    0    0    0   40    0    0    0    0    0
     0    0    0    0    0    0]
 [   0    5    0    0    0    0    1    0    0   32    0    0    0    0
     0    0    0    0    0    2]
 [   0    0    0    0    0    0    0    0    0    0   37    0    0    0
     0    0    0    0    0    3]
 [   0    0    0    0    0    0    0    0    0    0    0   35    0    0
     0    0    0    0    0    5]
 [   0    0    0    0    0    0    0    0    0    0    0    0   40    0
     0    0    0    0    0    0]
 [   0    1    0    0    0    0    0    0    0    0    0    0    0   32
     0    0    0    0    0    7]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    1
    36    0    0    0    0    3]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0   33    0    0    0    7]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0   36    0    0    4]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0   39    0    1]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0   29   11]
 [   9    0   34   43   33   48    0   24    0    0   96    8    0   23
     0    4    1   55    3 1939]]
2023-04-07 14:18:18,527 - Detection - ***** Test results *****
2023-04-07 14:18:18,527 - Detection -   Acc = 84.03
2023-04-07 14:18:18,527 - Detection -   F1 = 75.6803
2023-04-07 14:18:18,528 - Detection -   F1-known = 74.9649
2023-04-07 14:18:18,528 - Detection -   F1-open = 89.2726
2023-04-07 14:18:18,528 - Detection - Testing finished...
2023-04-07 14:18:18,528 - Detection - Results saved in results/results_DA-ADB-BOOST.csv
2023-04-07 14:18:18,545 - Detection - Open Intent Detection Finished...
