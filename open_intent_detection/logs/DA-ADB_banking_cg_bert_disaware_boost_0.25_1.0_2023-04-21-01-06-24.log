2023-04-21 01:06:24,998 - Detection - Open Intent Detection Begin...
2023-04-21 01:06:24,998 - Detection - Parameters Initialization...
2023-04-21 01:06:24,999 - Detection - ============================== Params ==============================
2023-04-21 01:06:24,999 - Detection - type:	open_intent_detection
2023-04-21 01:06:24,999 - Detection - logger_name:	Detection
2023-04-21 01:06:24,999 - Detection - log_dir:	logs
2023-04-21 01:06:24,999 - Detection - dataset:	banking_cg
2023-04-21 01:06:24,999 - Detection - known_cls_ratio:	0.25
2023-04-21 01:06:24,999 - Detection - labeled_ratio:	1.0
2023-04-21 01:06:24,999 - Detection - method:	DA-ADB
2023-04-21 01:06:24,999 - Detection - train:	True
2023-04-21 01:06:24,999 - Detection - pretrain:	True
2023-04-21 01:06:24,999 - Detection - save_model:	False
2023-04-21 01:06:24,999 - Detection - backbone:	bert_disaware_boost
2023-04-21 01:06:24,999 - Detection - config_file_name:	DA-ADB
2023-04-21 01:06:24,999 - Detection - seed:	8
2023-04-21 01:06:24,999 - Detection - gpu_id:	0
2023-04-21 01:06:24,999 - Detection - pipe_results_path:	pipe_results
2023-04-21 01:06:24,999 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-21 01:06:24,999 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-21 01:06:24,999 - Detection - model_dir:	models
2023-04-21 01:06:24,999 - Detection - load_pretrained_method:	None
2023-04-21 01:06:24,999 - Detection - result_dir:	results
2023-04-21 01:06:24,999 - Detection - results_file_name:	results_DA-ADB-BOOST.csv
2023-04-21 01:06:24,999 - Detection - save_results:	True
2023-04-21 01:06:24,999 - Detection - loss_fct:	CrossEntropyLoss
2023-04-21 01:06:24,999 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_cg_0.25_1.0_bert_disaware_boost_8
2023-04-21 01:06:24,999 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_cg_0.25_1.0_bert_disaware_boost_8/models
2023-04-21 01:06:24,999 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-21 01:06:24,999 - Detection - num_train_epochs:	100
2023-04-21 01:06:24,999 - Detection - num_labels:	None
2023-04-21 01:06:24,999 - Detection - max_seq_length:	None
2023-04-21 01:06:24,999 - Detection - freeze_backbone_parameters:	True
2023-04-21 01:06:24,999 - Detection - feat_dim:	768
2023-04-21 01:06:24,999 - Detection - warmup_proportion:	0.1
2023-04-21 01:06:24,999 - Detection - scale:	4
2023-04-21 01:06:24,999 - Detection - lr_boundary:	0.05
2023-04-21 01:06:24,999 - Detection - lr:	2e-05
2023-04-21 01:06:24,999 - Detection - activation:	relu
2023-04-21 01:06:24,999 - Detection - train_batch_size:	128
2023-04-21 01:06:24,999 - Detection - eval_batch_size:	64
2023-04-21 01:06:24,999 - Detection - test_batch_size:	64
2023-04-21 01:06:24,999 - Detection - wait_patient:	10
2023-04-21 01:06:24,999 - Detection - ============================== End Params ==============================
2023-04-21 01:06:24,999 - Detection - Data and Model Preparation...
2023-04-21 01:06:25,000 - Detection - The number of known intents is 19
2023-04-21 01:06:25,000 - Detection - Lists of known labels are: ['getting_spare_card', 'failed_transfer', 'virtual_card_not_working', 'apple_pay_or_google_pay', 'pending_card_payment', 'order_physical_card', 'activate_my_card', 'card_arrival', 'card_payment_fee_charged', 'card_swallowed', 'verify_top_up', 'exchange_rate', 'passcode_forgotten', 'pending_cash_withdrawal', 'topping_up_by_card', 'exchange_charge', 'pin_blocked', 'compromised_card', 'visa_or_mastercard']
2023-04-21 01:06:25,008 - Detection - Number of labeled training samples = 611
2023-04-21 01:06:25,008 - Detection - Number of unlabeled training samples = 2161
2023-04-21 01:06:25,010 - Detection - Number of evaluation samples = 185
2023-04-21 01:06:25,014 - Detection - Number of testing samples = 1896
2023-04-21 01:06:30,444 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-21 01:06:30,528 - Detection - Pre-training Begin...
2023-04-21 01:06:32,508 - Detection - ***** Epoch: 1: Eval results *****
2023-04-21 01:06:32,508 - Detection -   best_eval_score = 0
2023-04-21 01:06:32,508 - Detection -   eval_score = 1.47
2023-04-21 01:06:32,508 - Detection -   train_loss = 2.9392492294311525
2023-04-21 01:06:43,972 - Detection - ***** Epoch: 2: Eval results *****
2023-04-21 01:06:43,972 - Detection -   best_eval_score = 1.47
2023-04-21 01:06:43,972 - Detection -   eval_score = 0.93
2023-04-21 01:06:43,972 - Detection -   train_loss = 2.9160004615783692
2023-04-21 01:06:55,445 - Detection - ***** Epoch: 3: Eval results *****
2023-04-21 01:06:55,445 - Detection -   best_eval_score = 1.47
2023-04-21 01:06:55,445 - Detection -   eval_score = 1.89
2023-04-21 01:06:55,445 - Detection -   train_loss = 2.778401803970337
2023-04-21 01:07:06,952 - Detection - ***** Epoch: 4: Eval results *****
2023-04-21 01:07:06,953 - Detection -   best_eval_score = 1.89
2023-04-21 01:07:06,953 - Detection -   eval_score = 6.45
2023-04-21 01:07:06,953 - Detection -   train_loss = 2.6369444847106935
2023-04-21 01:07:18,591 - Detection - ***** Epoch: 5: Eval results *****
2023-04-21 01:07:18,591 - Detection -   best_eval_score = 6.45
2023-04-21 01:07:18,591 - Detection -   eval_score = 32.12
2023-04-21 01:07:18,591 - Detection -   train_loss = 2.39785099029541
2023-04-21 01:07:30,114 - Detection - ***** Epoch: 6: Eval results *****
2023-04-21 01:07:30,115 - Detection -   best_eval_score = 32.12
2023-04-21 01:07:30,115 - Detection -   eval_score = 57.31
2023-04-21 01:07:30,115 - Detection -   train_loss = 2.0525991439819338
2023-04-21 01:07:41,767 - Detection - ***** Epoch: 7: Eval results *****
2023-04-21 01:07:41,767 - Detection -   best_eval_score = 57.31
2023-04-21 01:07:41,767 - Detection -   eval_score = 66.23
2023-04-21 01:07:41,767 - Detection -   train_loss = 1.6523892641067506
2023-04-21 01:07:53,275 - Detection - ***** Epoch: 8: Eval results *****
2023-04-21 01:07:53,275 - Detection -   best_eval_score = 66.23
2023-04-21 01:07:53,275 - Detection -   eval_score = 70.55
2023-04-21 01:07:53,275 - Detection -   train_loss = 1.3274600028991699
2023-04-21 01:08:04,929 - Detection - ***** Epoch: 9: Eval results *****
2023-04-21 01:08:04,929 - Detection -   best_eval_score = 70.55
2023-04-21 01:08:04,929 - Detection -   eval_score = 80.08
2023-04-21 01:08:04,929 - Detection -   train_loss = 1.0481591701507569
2023-04-21 01:08:16,501 - Detection - ***** Epoch: 10: Eval results *****
2023-04-21 01:08:16,501 - Detection -   best_eval_score = 80.08
2023-04-21 01:08:16,501 - Detection -   eval_score = 84.75
2023-04-21 01:08:16,501 - Detection -   train_loss = 0.8736598134040833
2023-04-21 01:08:28,240 - Detection - ***** Epoch: 11: Eval results *****
2023-04-21 01:08:28,240 - Detection -   best_eval_score = 84.75
2023-04-21 01:08:28,240 - Detection -   eval_score = 86.54
2023-04-21 01:08:28,241 - Detection -   train_loss = 0.7721782565116883
2023-04-21 01:08:39,755 - Detection - ***** Epoch: 12: Eval results *****
2023-04-21 01:08:39,755 - Detection -   best_eval_score = 86.54
2023-04-21 01:08:39,755 - Detection -   eval_score = 85.87
2023-04-21 01:08:39,755 - Detection -   train_loss = 0.7084431886672974
2023-04-21 01:08:51,530 - Detection - ***** Epoch: 13: Eval results *****
2023-04-21 01:08:51,530 - Detection -   best_eval_score = 86.54
2023-04-21 01:08:51,530 - Detection -   eval_score = 87.49
2023-04-21 01:08:51,530 - Detection -   train_loss = 0.6547369360923767
2023-04-21 01:09:03,028 - Detection - ***** Epoch: 14: Eval results *****
2023-04-21 01:09:03,029 - Detection -   best_eval_score = 87.49
2023-04-21 01:09:03,029 - Detection -   eval_score = 86.83
2023-04-21 01:09:03,029 - Detection -   train_loss = 0.6238806247711182
2023-04-21 01:09:14,559 - Detection - ***** Epoch: 15: Eval results *****
2023-04-21 01:09:14,559 - Detection -   best_eval_score = 87.49
2023-04-21 01:09:14,559 - Detection -   eval_score = 87.91
2023-04-21 01:09:14,559 - Detection -   train_loss = 0.5991745829582215
2023-04-21 01:09:26,109 - Detection - ***** Epoch: 16: Eval results *****
2023-04-21 01:09:26,109 - Detection -   best_eval_score = 87.91
2023-04-21 01:09:26,110 - Detection -   eval_score = 87.84
2023-04-21 01:09:26,110 - Detection -   train_loss = 0.5750659942626953
2023-04-21 01:09:37,623 - Detection - ***** Epoch: 17: Eval results *****
2023-04-21 01:09:37,623 - Detection -   best_eval_score = 87.91
2023-04-21 01:09:37,623 - Detection -   eval_score = 88.35
2023-04-21 01:09:37,623 - Detection -   train_loss = 0.5554959893226623
2023-04-21 01:09:49,359 - Detection - ***** Epoch: 18: Eval results *****
2023-04-21 01:09:49,359 - Detection -   best_eval_score = 88.35
2023-04-21 01:09:49,359 - Detection -   eval_score = 89.01
2023-04-21 01:09:49,359 - Detection -   train_loss = 0.5353209972381592
2023-04-21 01:10:00,918 - Detection - ***** Epoch: 19: Eval results *****
2023-04-21 01:10:00,918 - Detection -   best_eval_score = 89.01
2023-04-21 01:10:00,919 - Detection -   eval_score = 89.3
2023-04-21 01:10:00,919 - Detection -   train_loss = 0.5222756266593933
2023-04-21 01:10:12,491 - Detection - ***** Epoch: 20: Eval results *****
2023-04-21 01:10:12,491 - Detection -   best_eval_score = 89.3
2023-04-21 01:10:12,491 - Detection -   eval_score = 89.95
2023-04-21 01:10:12,491 - Detection -   train_loss = 0.5120372235774994
2023-04-21 01:10:24,177 - Detection - ***** Epoch: 21: Eval results *****
2023-04-21 01:10:24,178 - Detection -   best_eval_score = 89.95
2023-04-21 01:10:24,178 - Detection -   eval_score = 89.95
2023-04-21 01:10:24,178 - Detection -   train_loss = 0.4975078523159027
2023-04-21 01:10:35,707 - Detection - ***** Epoch: 22: Eval results *****
2023-04-21 01:10:35,707 - Detection -   best_eval_score = 89.95
2023-04-21 01:10:35,707 - Detection -   eval_score = 89.3
2023-04-21 01:10:35,707 - Detection -   train_loss = 0.48871899843215943
2023-04-21 01:10:47,205 - Detection - ***** Epoch: 23: Eval results *****
2023-04-21 01:10:47,205 - Detection -   best_eval_score = 89.95
2023-04-21 01:10:47,205 - Detection -   eval_score = 89.3
2023-04-21 01:10:47,205 - Detection -   train_loss = 0.47829999923706057
2023-04-21 01:10:58,948 - Detection - ***** Epoch: 24: Eval results *****
2023-04-21 01:10:58,948 - Detection -   best_eval_score = 89.95
2023-04-21 01:10:58,948 - Detection -   eval_score = 89.3
2023-04-21 01:10:58,949 - Detection -   train_loss = 0.47383227944374084
2023-04-21 01:11:10,457 - Detection - ***** Epoch: 25: Eval results *****
2023-04-21 01:11:10,457 - Detection -   best_eval_score = 89.95
2023-04-21 01:11:10,457 - Detection -   eval_score = 89.3
2023-04-21 01:11:10,457 - Detection -   train_loss = 0.4685722291469574
2023-04-21 01:11:22,134 - Detection - ***** Epoch: 26: Eval results *****
2023-04-21 01:11:22,134 - Detection -   best_eval_score = 89.95
2023-04-21 01:11:22,134 - Detection -   eval_score = 89.3
2023-04-21 01:11:22,134 - Detection -   train_loss = 0.4585867941379547
2023-04-21 01:11:33,653 - Detection - ***** Epoch: 27: Eval results *****
2023-04-21 01:11:33,653 - Detection -   best_eval_score = 89.95
2023-04-21 01:11:33,653 - Detection -   eval_score = 89.3
2023-04-21 01:11:33,653 - Detection -   train_loss = 0.4515477120876312
2023-04-21 01:11:45,320 - Detection - ***** Epoch: 28: Eval results *****
2023-04-21 01:11:45,321 - Detection -   best_eval_score = 89.95
2023-04-21 01:11:45,321 - Detection -   eval_score = 89.3
2023-04-21 01:11:45,321 - Detection -   train_loss = 0.4489100217819214
2023-04-21 01:11:56,837 - Detection - ***** Epoch: 29: Eval results *****
2023-04-21 01:11:56,837 - Detection -   best_eval_score = 89.95
2023-04-21 01:11:56,837 - Detection -   eval_score = 89.3
2023-04-21 01:11:56,837 - Detection -   train_loss = 0.44387948513031006
2023-04-21 01:12:08,357 - Detection - ***** Epoch: 30: Eval results *****
2023-04-21 01:12:08,357 - Detection -   best_eval_score = 89.95
2023-04-21 01:12:08,357 - Detection -   eval_score = 89.3
2023-04-21 01:12:08,357 - Detection -   train_loss = 0.4381181955337524
2023-04-21 01:12:08,357 - Detection - Pre-training finished...
2023-04-21 01:12:08,358 - Detection - Training Begin...
2023-04-21 01:12:09,237 - Detection - ***** Epoch: 1: Eval results *****
2023-04-21 01:12:09,237 - Detection -   best_eval_score = 0
2023-04-21 01:12:09,238 - Detection -   eval_score = 1.0
2023-04-21 01:12:09,238 - Detection -   train_loss = 3.4162049770355223
2023-04-21 01:12:20,341 - Detection - ***** Epoch: 2: Eval results *****
2023-04-21 01:12:20,341 - Detection -   best_eval_score = 1.0
2023-04-21 01:12:20,341 - Detection -   eval_score = 64.92
2023-04-21 01:12:20,342 - Detection -   train_loss = 3.2402532577514647
2023-04-21 01:12:31,242 - Detection - ***** Epoch: 3: Eval results *****
2023-04-21 01:12:31,242 - Detection -   best_eval_score = 64.92
2023-04-21 01:12:31,242 - Detection -   eval_score = 74.8
2023-04-21 01:12:31,242 - Detection -   train_loss = 1.125766968727112
2023-04-21 01:12:42,248 - Detection - ***** Epoch: 4: Eval results *****
2023-04-21 01:12:42,248 - Detection -   best_eval_score = 74.8
2023-04-21 01:12:42,248 - Detection -   eval_score = 74.22
2023-04-21 01:12:42,248 - Detection -   train_loss = 0.4925467252731323
2023-04-21 01:12:53,150 - Detection - ***** Epoch: 5: Eval results *****
2023-04-21 01:12:53,150 - Detection -   best_eval_score = 74.8
2023-04-21 01:12:53,150 - Detection -   eval_score = 74.54
2023-04-21 01:12:53,150 - Detection -   train_loss = 0.49007067680358884
2023-04-21 01:13:04,001 - Detection - ***** Epoch: 6: Eval results *****
2023-04-21 01:13:04,001 - Detection -   best_eval_score = 74.8
2023-04-21 01:13:04,001 - Detection -   eval_score = 74.22
2023-04-21 01:13:04,001 - Detection -   train_loss = 0.48643484711647034
2023-04-21 01:13:15,032 - Detection - ***** Epoch: 7: Eval results *****
2023-04-21 01:13:15,032 - Detection -   best_eval_score = 74.8
2023-04-21 01:13:15,032 - Detection -   eval_score = 74.23
2023-04-21 01:13:15,032 - Detection -   train_loss = 0.484515643119812
2023-04-21 01:13:25,889 - Detection - ***** Epoch: 8: Eval results *****
2023-04-21 01:13:25,889 - Detection -   best_eval_score = 74.8
2023-04-21 01:13:25,889 - Detection -   eval_score = 74.39
2023-04-21 01:13:25,889 - Detection -   train_loss = 0.47085054516792296
2023-04-21 01:13:36,955 - Detection - ***** Epoch: 9: Eval results *****
2023-04-21 01:13:36,956 - Detection -   best_eval_score = 74.8
2023-04-21 01:13:36,956 - Detection -   eval_score = 74.54
2023-04-21 01:13:36,956 - Detection -   train_loss = 0.48107855319976806
2023-04-21 01:13:47,888 - Detection - ***** Epoch: 10: Eval results *****
2023-04-21 01:13:47,888 - Detection -   best_eval_score = 74.8
2023-04-21 01:13:47,888 - Detection -   eval_score = 74.8
2023-04-21 01:13:47,888 - Detection -   train_loss = 0.48460952043533323
2023-04-21 01:13:58,898 - Detection - ***** Epoch: 11: Eval results *****
2023-04-21 01:13:58,898 - Detection -   best_eval_score = 74.8
2023-04-21 01:13:58,898 - Detection -   eval_score = 74.8
2023-04-21 01:13:58,898 - Detection -   train_loss = 0.49299662113189696
2023-04-21 01:14:09,807 - Detection - ***** Epoch: 12: Eval results *****
2023-04-21 01:14:09,807 - Detection -   best_eval_score = 74.8
2023-04-21 01:14:09,807 - Detection -   eval_score = 74.08
2023-04-21 01:14:09,807 - Detection -   train_loss = 0.49022952318191526
2023-04-21 01:14:20,650 - Detection - ***** Epoch: 13: Eval results *****
2023-04-21 01:14:20,650 - Detection -   best_eval_score = 74.8
2023-04-21 01:14:20,650 - Detection -   eval_score = 74.08
2023-04-21 01:14:20,650 - Detection -   train_loss = 0.5103352010250092
2023-04-21 01:14:20,650 - Detection - Training Finished...
2023-04-21 01:14:20,650 - Detection - Testing begin...
2023-04-21 01:14:22,543 - Detection - ***** Test: Confusion Matrix *****
2023-04-21 01:14:22,544 - Detection - [[   2    0    0    0    0    2    0    0    0    0    0    0    0    0
     0    0    0    0    0   25]
 [   0   24    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    3]
 [   0    0    2    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    7]
 [   0    0    0   19    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    3]
 [   0    0    0    0   20    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    6]
 [   1    0    0    0    0    6    0    0    0    0    0    0    0    0
     0    0    0    0    0    8]
 [   0    0    0    0    0    0   26    0    0    0    0    0    0    0
     0    0    0    0    0    5]
 [   0    0    0    0    0    0    0    7    0    0    0    0    0    0
     0    0    0    0    0   17]
 [   0    0    0    0    0    0    0    0   13    0    0    0    0    0
     0    0    0    0    0    4]
 [   0    0    0    0    0    0    0    0    0   10    0    0    0    0
     0    0    0    0    0    7]
 [   0    0    0    0    0    0    0    0    0    0   27    0    0    0
     0    0    0    0    0    2]
 [   0    0    0    0    0    0    0    0    0    0    0   20    0    0
     0    0    0    0    0    2]
 [   0    0    0    0    0    0    0    0    0    0    0    0   10    0
     0    0    0    0    0    6]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0   23
     0    0    0    0    0    6]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     2    0    0    0    0   15]
 [   0    0    0    0    0    0    0    0    0    0    0    1    0    0
     0   18    0    0    0    5]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0   15    0    0    6]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    2    0   16]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0   16    4]
 [   1   74    0    0   17    6    2    2   87    2    1   14    0   57
     2    6   12    3    1 1196]]
2023-04-21 01:14:22,544 - Detection - ***** Test results *****
2023-04-21 01:14:22,544 - Detection -   Acc = 76.9
2023-04-21 01:14:22,544 - Detection -   F1 = 56.7646
2023-04-21 01:14:22,544 - Detection -   F1-known = 55.2973
2023-04-21 01:14:22,544 - Detection -   F1-open = 84.6426
2023-04-21 01:14:22,544 - Detection - Testing finished...
2023-04-21 01:14:22,544 - Detection - Results saved in results/results_DA-ADB-BOOST.csv
2023-04-21 01:14:22,564 - Detection - Open Intent Detection Finished...
