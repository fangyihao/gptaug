2023-04-23 00:48:42,750 - Detection - Open Intent Detection Begin...
2023-04-23 00:48:42,750 - Detection - Parameters Initialization...
2023-04-23 00:48:42,750 - Detection - ============================== Params ==============================
2023-04-23 00:48:42,750 - Detection - type:	open_intent_detection
2023-04-23 00:48:42,750 - Detection - logger_name:	Detection
2023-04-23 00:48:42,750 - Detection - log_dir:	logs
2023-04-23 00:48:42,750 - Detection - dataset:	stackoverflow_cg
2023-04-23 00:48:42,750 - Detection - known_cls_ratio:	0.5
2023-04-23 00:48:42,750 - Detection - labeled_ratio:	1.0
2023-04-23 00:48:42,750 - Detection - method:	DA-ADB
2023-04-23 00:48:42,750 - Detection - train:	True
2023-04-23 00:48:42,750 - Detection - pretrain:	True
2023-04-23 00:48:42,750 - Detection - save_model:	False
2023-04-23 00:48:42,750 - Detection - backbone:	bert_disaware_boost
2023-04-23 00:48:42,750 - Detection - config_file_name:	DA-ADB
2023-04-23 00:48:42,750 - Detection - seed:	5
2023-04-23 00:48:42,750 - Detection - gpu_id:	0
2023-04-23 00:48:42,750 - Detection - pipe_results_path:	pipe_results
2023-04-23 00:48:42,750 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-23 00:48:42,750 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-23 00:48:42,750 - Detection - model_dir:	models
2023-04-23 00:48:42,750 - Detection - load_pretrained_method:	None
2023-04-23 00:48:42,750 - Detection - result_dir:	results
2023-04-23 00:48:42,750 - Detection - results_file_name:	results_DA-ADB-BOOST-F-4.csv
2023-04-23 00:48:42,750 - Detection - save_results:	True
2023-04-23 00:48:42,750 - Detection - loss_fct:	CrossEntropyLoss
2023-04-23 00:48:42,750 - Detection - boost_method:	F-4
2023-04-23 00:48:42,750 - Detection - boost_start_score:	0.0
2023-04-23 00:48:42,750 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.5_1.0_bert_disaware_boost_5
2023-04-23 00:48:42,750 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.5_1.0_bert_disaware_boost_5/models
2023-04-23 00:48:42,750 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-23 00:48:42,750 - Detection - num_train_epochs:	100
2023-04-23 00:48:42,751 - Detection - num_labels:	None
2023-04-23 00:48:42,751 - Detection - max_seq_length:	None
2023-04-23 00:48:42,751 - Detection - freeze_backbone_parameters:	True
2023-04-23 00:48:42,751 - Detection - feat_dim:	768
2023-04-23 00:48:42,751 - Detection - warmup_proportion:	0.1
2023-04-23 00:48:42,751 - Detection - scale:	4
2023-04-23 00:48:42,751 - Detection - lr_boundary:	0.05
2023-04-23 00:48:42,751 - Detection - lr:	2e-05
2023-04-23 00:48:42,751 - Detection - activation:	relu
2023-04-23 00:48:42,751 - Detection - train_batch_size:	128
2023-04-23 00:48:42,751 - Detection - eval_batch_size:	64
2023-04-23 00:48:42,751 - Detection - test_batch_size:	64
2023-04-23 00:48:42,751 - Detection - wait_patient:	10
2023-04-23 00:48:42,751 - Detection - ============================== End Params ==============================
2023-04-23 00:48:42,751 - Detection - Data and Model Preparation...
2023-04-23 00:48:42,751 - Detection - The number of known intents is 10
2023-04-23 00:48:42,751 - Detection - Lists of known labels are: ['bash', 'excel', 'svn', 'wordpress', 'osx', 'apache', 'oracle', 'matlab', 'qt', 'visual-studio']
2023-04-23 00:48:42,759 - Detection - Number of labeled training samples = 1366
2023-04-23 00:48:42,759 - Detection - Number of unlabeled training samples = 1425
2023-04-23 00:48:42,762 - Detection - Number of evaluation samples = 715
2023-04-23 00:48:42,768 - Detection - Number of testing samples = 2905
2023-04-23 00:48:48,318 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-23 00:48:48,432 - Detection - Pre-training Begin...
2023-04-23 00:48:51,349 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 00:48:51,349 - Detection -   best_eval_score = 0
2023-04-23 00:48:51,349 - Detection -   eval_score = 2.94
2023-04-23 00:48:51,349 - Detection -   train_loss = 2.3046804774891245
2023-04-23 00:49:00,095 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 00:49:00,095 - Detection -   best_eval_score = 2.94
2023-04-23 00:49:00,096 - Detection -   eval_score = 1.44
2023-04-23 00:49:00,096 - Detection -   train_loss = 2.2903757745569404
2023-04-23 00:49:08,690 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 00:49:08,690 - Detection -   best_eval_score = 2.94
2023-04-23 00:49:08,690 - Detection -   eval_score = 24.14
2023-04-23 00:49:08,690 - Detection -   train_loss = 2.245976122942838
2023-04-23 00:49:17,308 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 00:49:17,308 - Detection -   best_eval_score = 24.14
2023-04-23 00:49:17,308 - Detection -   eval_score = 41.07
2023-04-23 00:49:17,308 - Detection -   train_loss = 2.115159511566162
2023-04-23 00:49:26,079 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 00:49:26,079 - Detection -   best_eval_score = 41.07
2023-04-23 00:49:26,079 - Detection -   eval_score = 76.9
2023-04-23 00:49:26,079 - Detection -   train_loss = 1.7647710279984907
2023-04-23 00:49:34,712 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 00:49:34,712 - Detection -   best_eval_score = 76.9
2023-04-23 00:49:34,712 - Detection -   eval_score = 81.63
2023-04-23 00:49:34,712 - Detection -   train_loss = 1.3387470245361328
2023-04-23 00:49:43,541 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 00:49:43,541 - Detection -   best_eval_score = 81.63
2023-04-23 00:49:43,541 - Detection -   eval_score = 80.84
2023-04-23 00:49:43,541 - Detection -   train_loss = 1.0663275447758762
2023-04-23 00:49:52,151 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 00:49:52,151 - Detection -   best_eval_score = 81.63
2023-04-23 00:49:52,151 - Detection -   eval_score = 82.79
2023-04-23 00:49:52,151 - Detection -   train_loss = 0.9276767318898981
2023-04-23 00:50:00,787 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 00:50:00,787 - Detection -   best_eval_score = 82.79
2023-04-23 00:50:00,787 - Detection -   eval_score = 82.92
2023-04-23 00:50:00,787 - Detection -   train_loss = 0.8252936168150469
2023-04-23 00:50:09,546 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 00:50:09,546 - Detection -   best_eval_score = 82.92
2023-04-23 00:50:09,547 - Detection -   eval_score = 82.51
2023-04-23 00:50:09,547 - Detection -   train_loss = 0.75705993717367
2023-04-23 00:50:18,148 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 00:50:18,148 - Detection -   best_eval_score = 82.92
2023-04-23 00:50:18,148 - Detection -   eval_score = 82.33
2023-04-23 00:50:18,148 - Detection -   train_loss = 0.6821827834302728
2023-04-23 00:50:26,950 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 00:50:26,950 - Detection -   best_eval_score = 82.92
2023-04-23 00:50:26,950 - Detection -   eval_score = 82.12
2023-04-23 00:50:26,950 - Detection -   train_loss = 0.6374161785299127
2023-04-23 00:50:35,573 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 00:50:35,573 - Detection -   best_eval_score = 82.92
2023-04-23 00:50:35,573 - Detection -   eval_score = 83.29
2023-04-23 00:50:35,573 - Detection -   train_loss = 0.6049063314091075
2023-04-23 00:50:44,226 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 00:50:44,226 - Detection -   best_eval_score = 83.29
2023-04-23 00:50:44,226 - Detection -   eval_score = 82.05
2023-04-23 00:50:44,226 - Detection -   train_loss = 0.5505478111180392
2023-04-23 00:50:52,968 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 00:50:52,969 - Detection -   best_eval_score = 83.29
2023-04-23 00:50:52,969 - Detection -   eval_score = 83.87
2023-04-23 00:50:52,969 - Detection -   train_loss = 0.536901365626942
2023-04-23 00:51:01,599 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 00:51:01,599 - Detection -   best_eval_score = 83.87
2023-04-23 00:51:01,600 - Detection -   eval_score = 83.44
2023-04-23 00:51:01,600 - Detection -   train_loss = 0.4718651148405942
2023-04-23 00:51:10,366 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 00:51:10,366 - Detection -   best_eval_score = 83.87
2023-04-23 00:51:10,366 - Detection -   eval_score = 83.55
2023-04-23 00:51:10,366 - Detection -   train_loss = 0.4466093534773046
2023-04-23 00:51:18,999 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 00:51:18,999 - Detection -   best_eval_score = 83.87
2023-04-23 00:51:18,999 - Detection -   eval_score = 83.64
2023-04-23 00:51:18,999 - Detection -   train_loss = 0.43470689112489874
2023-04-23 00:51:27,664 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 00:51:27,664 - Detection -   best_eval_score = 83.87
2023-04-23 00:51:27,664 - Detection -   eval_score = 84.29
2023-04-23 00:51:27,664 - Detection -   train_loss = 0.417982743545012
2023-04-23 00:51:36,425 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 00:51:36,425 - Detection -   best_eval_score = 84.29
2023-04-23 00:51:36,425 - Detection -   eval_score = 84.17
2023-04-23 00:51:36,425 - Detection -   train_loss = 0.39280552484772424
2023-04-23 00:51:45,238 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 00:51:45,238 - Detection -   best_eval_score = 84.29
2023-04-23 00:51:45,238 - Detection -   eval_score = 84.19
2023-04-23 00:51:45,238 - Detection -   train_loss = 0.3703182746063579
2023-04-23 00:51:53,868 - Detection - ***** Epoch: 22: Eval results *****
2023-04-23 00:51:53,868 - Detection -   best_eval_score = 84.29
2023-04-23 00:51:53,868 - Detection -   eval_score = 84.38
2023-04-23 00:51:53,868 - Detection -   train_loss = 0.3514784709973769
2023-04-23 00:52:02,607 - Detection - ***** Epoch: 23: Eval results *****
2023-04-23 00:52:02,607 - Detection -   best_eval_score = 84.38
2023-04-23 00:52:02,607 - Detection -   eval_score = 84.44
2023-04-23 00:52:02,608 - Detection -   train_loss = 0.3386129980737513
2023-04-23 00:52:11,305 - Detection - ***** Epoch: 24: Eval results *****
2023-04-23 00:52:11,305 - Detection -   best_eval_score = 84.44
2023-04-23 00:52:11,305 - Detection -   eval_score = 84.01
2023-04-23 00:52:11,305 - Detection -   train_loss = 0.325897986238653
2023-04-23 00:52:20,059 - Detection - ***** Epoch: 25: Eval results *****
2023-04-23 00:52:20,059 - Detection -   best_eval_score = 84.44
2023-04-23 00:52:20,059 - Detection -   eval_score = 84.32
2023-04-23 00:52:20,059 - Detection -   train_loss = 0.32118040323257446
2023-04-23 00:52:28,731 - Detection - ***** Epoch: 26: Eval results *****
2023-04-23 00:52:28,731 - Detection -   best_eval_score = 84.44
2023-04-23 00:52:28,731 - Detection -   eval_score = 83.96
2023-04-23 00:52:28,731 - Detection -   train_loss = 0.30845738540996204
2023-04-23 00:52:37,364 - Detection - ***** Epoch: 27: Eval results *****
2023-04-23 00:52:37,364 - Detection -   best_eval_score = 84.44
2023-04-23 00:52:37,364 - Detection -   eval_score = 84.26
2023-04-23 00:52:37,364 - Detection -   train_loss = 0.2994822588833896
2023-04-23 00:52:46,157 - Detection - ***** Epoch: 28: Eval results *****
2023-04-23 00:52:46,157 - Detection -   best_eval_score = 84.44
2023-04-23 00:52:46,157 - Detection -   eval_score = 84.19
2023-04-23 00:52:46,157 - Detection -   train_loss = 0.2867285527966239
2023-04-23 00:52:54,800 - Detection - ***** Epoch: 29: Eval results *****
2023-04-23 00:52:54,800 - Detection -   best_eval_score = 84.44
2023-04-23 00:52:54,800 - Detection -   eval_score = 84.4
2023-04-23 00:52:54,800 - Detection -   train_loss = 0.28108196366917004
2023-04-23 00:53:03,588 - Detection - ***** Epoch: 30: Eval results *****
2023-04-23 00:53:03,588 - Detection -   best_eval_score = 84.44
2023-04-23 00:53:03,588 - Detection -   eval_score = 84.27
2023-04-23 00:53:03,588 - Detection -   train_loss = 0.27614964409308
2023-04-23 00:53:12,238 - Detection - ***** Epoch: 31: Eval results *****
2023-04-23 00:53:12,238 - Detection -   best_eval_score = 84.44
2023-04-23 00:53:12,238 - Detection -   eval_score = 83.87
2023-04-23 00:53:12,238 - Detection -   train_loss = 0.26548941839825024
2023-04-23 00:53:20,872 - Detection - ***** Epoch: 32: Eval results *****
2023-04-23 00:53:20,872 - Detection -   best_eval_score = 84.44
2023-04-23 00:53:20,872 - Detection -   eval_score = 84.09
2023-04-23 00:53:20,872 - Detection -   train_loss = 0.2634535350582816
2023-04-23 00:53:29,625 - Detection - ***** Epoch: 33: Eval results *****
2023-04-23 00:53:29,625 - Detection -   best_eval_score = 84.44
2023-04-23 00:53:29,625 - Detection -   eval_score = 83.93
2023-04-23 00:53:29,625 - Detection -   train_loss = 0.25775112076239154
2023-04-23 00:53:29,626 - Detection - Pre-training finished...
2023-04-23 00:53:29,626 - Detection - Training Begin...
2023-04-23 00:53:30,986 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 00:53:30,986 - Detection -   best_eval_score = 0
2023-04-23 00:53:30,986 - Detection -   eval_score = 0.0
2023-04-23 00:53:30,986 - Detection -   train_loss = 5.106385144320401
2023-04-23 00:53:32,342 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 00:53:32,343 - Detection -   best_eval_score = 0
2023-04-23 00:53:32,343 - Detection -   eval_score = 0.0
2023-04-23 00:53:32,343 - Detection -   train_loss = 4.803523973985151
2023-04-23 00:53:33,701 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 00:53:33,701 - Detection -   best_eval_score = 0
2023-04-23 00:53:33,701 - Detection -   eval_score = 1.05
2023-04-23 00:53:33,701 - Detection -   train_loss = 4.404386173595082
2023-04-23 00:53:41,468 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 00:53:41,468 - Detection -   best_eval_score = 1.05
2023-04-23 00:53:41,468 - Detection -   eval_score = 70.55
2023-04-23 00:53:41,468 - Detection -   train_loss = 3.9336804259907114
2023-04-23 00:53:49,325 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 00:53:49,325 - Detection -   best_eval_score = 70.55
2023-04-23 00:53:49,325 - Detection -   eval_score = 75.39
2023-04-23 00:53:49,325 - Detection -   train_loss = 1.3457415754144841
2023-04-23 00:53:57,088 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 00:53:57,088 - Detection -   best_eval_score = 75.39
2023-04-23 00:53:57,088 - Detection -   eval_score = 75.51
2023-04-23 00:53:57,088 - Detection -   train_loss = 1.1008907014673406
2023-04-23 00:54:04,937 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 00:54:04,937 - Detection -   best_eval_score = 75.51
2023-04-23 00:54:04,937 - Detection -   eval_score = 75.37
2023-04-23 00:54:04,937 - Detection -   train_loss = 1.1488906145095825
2023-04-23 00:54:12,675 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 00:54:12,675 - Detection -   best_eval_score = 75.51
2023-04-23 00:54:12,675 - Detection -   eval_score = 75.35
2023-04-23 00:54:12,675 - Detection -   train_loss = 1.1170441833409397
2023-04-23 00:54:20,438 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 00:54:20,438 - Detection -   best_eval_score = 75.51
2023-04-23 00:54:20,438 - Detection -   eval_score = 75.28
2023-04-23 00:54:20,438 - Detection -   train_loss = 1.107137674635107
2023-04-23 00:54:28,379 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 00:54:28,379 - Detection -   best_eval_score = 75.51
2023-04-23 00:54:28,379 - Detection -   eval_score = 75.26
2023-04-23 00:54:28,379 - Detection -   train_loss = 1.1324678225950762
2023-04-23 00:54:36,234 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 00:54:36,234 - Detection -   best_eval_score = 75.51
2023-04-23 00:54:36,234 - Detection -   eval_score = 75.43
2023-04-23 00:54:36,234 - Detection -   train_loss = 1.1143840822306545
2023-04-23 00:54:44,083 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 00:54:44,084 - Detection -   best_eval_score = 75.51
2023-04-23 00:54:44,084 - Detection -   eval_score = 75.51
2023-04-23 00:54:44,084 - Detection -   train_loss = 1.1093628027222373
2023-04-23 00:54:51,803 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 00:54:51,803 - Detection -   best_eval_score = 75.51
2023-04-23 00:54:51,803 - Detection -   eval_score = 75.37
2023-04-23 00:54:51,803 - Detection -   train_loss = 1.1326264468106357
2023-04-23 00:54:59,501 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 00:54:59,501 - Detection -   best_eval_score = 75.51
2023-04-23 00:54:59,501 - Detection -   eval_score = 75.27
2023-04-23 00:54:59,501 - Detection -   train_loss = 1.146532123739069
2023-04-23 00:55:07,405 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 00:55:07,405 - Detection -   best_eval_score = 75.51
2023-04-23 00:55:07,405 - Detection -   eval_score = 75.44
2023-04-23 00:55:07,405 - Detection -   train_loss = 1.0898403037678113
2023-04-23 00:55:15,186 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 00:55:15,186 - Detection -   best_eval_score = 75.51
2023-04-23 00:55:15,186 - Detection -   eval_score = 75.18
2023-04-23 00:55:15,186 - Detection -   train_loss = 1.130525903268294
2023-04-23 00:55:15,186 - Detection - Training Finished...
2023-04-23 00:55:15,186 - Detection - Testing begin...
2023-04-23 00:55:16,936 - Detection - ***** Test: Confusion Matrix *****
2023-04-23 00:55:16,936 - Detection - [[  83    0    0    0    2    0    0    0    0    0   54]
 [   0   91    0    0    0    0    0    0    0    0   49]
 [   0    0  111    0    0    3    1    0    1    0   33]
 [   0    0    0  110    0    1    0    0    0    0   26]
 [   0    1    1    0  118    1    1    0    2    0   69]
 [   1    0    2    2    0  114    0    0    0    0   51]
 [   0    0    0    0    0    1   98    0    0    0   28]
 [   0    0    0    0    2    0    1  134    0    0   27]
 [   0    0    0    0    0    0    0    0  155    0   17]
 [   0    1    0    0    2    1    0    0    0   41   61]
 [   2    3    5    4   91   31   20    1    4    7 1240]]
2023-04-23 00:55:16,936 - Detection - ***** Test results *****
2023-04-23 00:55:16,936 - Detection -   Acc = 79.0
2023-04-23 00:55:16,937 - Detection -   F1 = 76.821
2023-04-23 00:55:16,937 - Detection -   F1-known = 76.4065
2023-04-23 00:55:16,937 - Detection -   F1-open = 80.9664
2023-04-23 00:55:16,937 - Detection - Testing finished...
2023-04-23 00:55:16,937 - Detection - Results saved in results/results_DA-ADB-BOOST-F-4.csv
2023-04-23 00:55:16,955 - Detection - Open Intent Detection Finished...
