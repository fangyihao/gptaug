2023-04-04 22:22:02,391 - Detection - Open Intent Detection Begin...
2023-04-04 22:22:02,391 - Detection - Parameters Initialization...
2023-04-04 22:22:02,392 - Detection - ============================== Params ==============================
2023-04-04 22:22:02,392 - Detection - type:	open_intent_detection
2023-04-04 22:22:02,392 - Detection - logger_name:	Detection
2023-04-04 22:22:02,392 - Detection - log_dir:	logs
2023-04-04 22:22:02,392 - Detection - dataset:	banking
2023-04-04 22:22:02,392 - Detection - known_cls_ratio:	0.25
2023-04-04 22:22:02,392 - Detection - labeled_ratio:	1.0
2023-04-04 22:22:02,392 - Detection - method:	ADB
2023-04-04 22:22:02,392 - Detection - train:	True
2023-04-04 22:22:02,392 - Detection - pretrain:	True
2023-04-04 22:22:02,392 - Detection - save_model:	True
2023-04-04 22:22:02,392 - Detection - backbone:	bert
2023-04-04 22:22:02,392 - Detection - config_file_name:	ADB
2023-04-04 22:22:02,392 - Detection - seed:	7
2023-04-04 22:22:02,392 - Detection - gpu_id:	0
2023-04-04 22:22:02,392 - Detection - pipe_results_path:	pipe_results
2023-04-04 22:22:02,392 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-04 22:22:02,392 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-04 22:22:02,392 - Detection - model_dir:	models
2023-04-04 22:22:02,392 - Detection - load_pretrained_method:	None
2023-04-04 22:22:02,392 - Detection - result_dir:	results
2023-04-04 22:22:02,392 - Detection - results_file_name:	results_ADB.csv
2023-04-04 22:22:02,392 - Detection - save_results:	True
2023-04-04 22:22:02,392 - Detection - loss_fct:	CrossEntropyLoss
2023-04-04 22:22:02,392 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_0.25_1.0_bert_7
2023-04-04 22:22:02,392 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_0.25_1.0_bert_7/models
2023-04-04 22:22:02,392 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-04 22:22:02,392 - Detection - num_train_epochs:	100
2023-04-04 22:22:02,392 - Detection - num_labels:	None
2023-04-04 22:22:02,392 - Detection - max_seq_length:	None
2023-04-04 22:22:02,392 - Detection - freeze_backbone_parameters:	True
2023-04-04 22:22:02,392 - Detection - feat_dim:	768
2023-04-04 22:22:02,392 - Detection - warmup_proportion:	0.1
2023-04-04 22:22:02,392 - Detection - lr_boundary:	0.05
2023-04-04 22:22:02,392 - Detection - lr:	2e-05
2023-04-04 22:22:02,392 - Detection - activation:	relu
2023-04-04 22:22:02,392 - Detection - train_batch_size:	128
2023-04-04 22:22:02,392 - Detection - eval_batch_size:	64
2023-04-04 22:22:02,392 - Detection - test_batch_size:	64
2023-04-04 22:22:02,392 - Detection - wait_patient:	10
2023-04-04 22:22:02,392 - Detection - ============================== End Params ==============================
2023-04-04 22:22:02,392 - Detection - Data and Model Preparation...
2023-04-04 22:22:02,393 - Detection - The number of known intents is 19
2023-04-04 22:22:02,393 - Detection - Lists of known labels are: ['supported_cards_and_currencies', 'failed_transfer', 'top_up_failed', 'card_payment_not_recognised', 'getting_virtual_card', 'card_arrival', 'declined_cash_withdrawal', 'card_not_working', 'getting_spare_card', 'age_limit', 'fiat_currency_support', 'card_delivery_estimate', 'top_up_limits', 'disposable_card_limits', 'request_refund', 'top_up_reverted', 'card_payment_wrong_exchange_rate', 'change_pin', 'cash_withdrawal_charge']
2023-04-04 22:22:02,418 - Detection - Number of labeled training samples = 2330
2023-04-04 22:22:02,418 - Detection - Number of unlabeled training samples = 6673
2023-04-04 22:22:02,420 - Detection - Number of evaluation samples = 261
2023-04-04 22:22:02,427 - Detection - Number of testing samples = 3080
2023-04-04 22:22:09,397 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-04 22:22:11,069 - Detection - Pre-training Begin...
2023-04-04 22:22:14,640 - Detection - ***** Epoch: 1: Eval results *****
2023-04-04 22:22:14,640 - Detection -   best_eval_score = 0
2023-04-04 22:22:14,640 - Detection -   eval_score = 8.05
2023-04-04 22:22:14,640 - Detection -   train_loss = 2.9492224768588415
2023-04-04 22:22:17,631 - Detection - ***** Epoch: 2: Eval results *****
2023-04-04 22:22:17,631 - Detection -   best_eval_score = 8.05
2023-04-04 22:22:17,631 - Detection -   eval_score = 19.54
2023-04-04 22:22:17,631 - Detection -   train_loss = 2.9235621753491854
2023-04-04 22:22:20,627 - Detection - ***** Epoch: 3: Eval results *****
2023-04-04 22:22:20,627 - Detection -   best_eval_score = 19.54
2023-04-04 22:22:20,627 - Detection -   eval_score = 40.23
2023-04-04 22:22:20,627 - Detection -   train_loss = 2.871073057777003
2023-04-04 22:22:23,631 - Detection - ***** Epoch: 4: Eval results *****
2023-04-04 22:22:23,631 - Detection -   best_eval_score = 40.23
2023-04-04 22:22:23,631 - Detection -   eval_score = 54.41
2023-04-04 22:22:23,631 - Detection -   train_loss = 2.767782713237562
2023-04-04 22:22:26,646 - Detection - ***** Epoch: 5: Eval results *****
2023-04-04 22:22:26,646 - Detection -   best_eval_score = 54.41
2023-04-04 22:22:26,646 - Detection -   eval_score = 65.52
2023-04-04 22:22:26,646 - Detection -   train_loss = 2.5084569454193115
2023-04-04 22:22:29,705 - Detection - ***** Epoch: 6: Eval results *****
2023-04-04 22:22:29,705 - Detection -   best_eval_score = 65.52
2023-04-04 22:22:29,705 - Detection -   eval_score = 75.86
2023-04-04 22:22:29,705 - Detection -   train_loss = 1.9762034102490074
2023-04-04 22:22:32,822 - Detection - ***** Epoch: 7: Eval results *****
2023-04-04 22:22:32,822 - Detection -   best_eval_score = 75.86
2023-04-04 22:22:32,822 - Detection -   eval_score = 85.06
2023-04-04 22:22:32,822 - Detection -   train_loss = 1.3457487758837248
2023-04-04 22:22:35,982 - Detection - ***** Epoch: 8: Eval results *****
2023-04-04 22:22:35,982 - Detection -   best_eval_score = 85.06
2023-04-04 22:22:35,982 - Detection -   eval_score = 88.12
2023-04-04 22:22:35,982 - Detection -   train_loss = 0.8906997881437603
2023-04-04 22:22:39,174 - Detection - ***** Epoch: 9: Eval results *****
2023-04-04 22:22:39,174 - Detection -   best_eval_score = 88.12
2023-04-04 22:22:39,174 - Detection -   eval_score = 90.8
2023-04-04 22:22:39,174 - Detection -   train_loss = 0.59186211385225
2023-04-04 22:22:42,387 - Detection - ***** Epoch: 10: Eval results *****
2023-04-04 22:22:42,387 - Detection -   best_eval_score = 90.8
2023-04-04 22:22:42,387 - Detection -   eval_score = 92.34
2023-04-04 22:22:42,387 - Detection -   train_loss = 0.4253544164331336
2023-04-04 22:22:45,612 - Detection - ***** Epoch: 11: Eval results *****
2023-04-04 22:22:45,612 - Detection -   best_eval_score = 92.34
2023-04-04 22:22:45,612 - Detection -   eval_score = 95.02
2023-04-04 22:22:45,612 - Detection -   train_loss = 0.31921500751846715
2023-04-04 22:22:48,849 - Detection - ***** Epoch: 12: Eval results *****
2023-04-04 22:22:48,849 - Detection -   best_eval_score = 95.02
2023-04-04 22:22:48,849 - Detection -   eval_score = 94.25
2023-04-04 22:22:48,849 - Detection -   train_loss = 0.2651983656381306
2023-04-04 22:22:52,073 - Detection - ***** Epoch: 13: Eval results *****
2023-04-04 22:22:52,073 - Detection -   best_eval_score = 95.02
2023-04-04 22:22:52,073 - Detection -   eval_score = 93.49
2023-04-04 22:22:52,073 - Detection -   train_loss = 0.21200304517620489
2023-04-04 22:22:55,289 - Detection - ***** Epoch: 14: Eval results *****
2023-04-04 22:22:55,289 - Detection -   best_eval_score = 95.02
2023-04-04 22:22:55,289 - Detection -   eval_score = 95.4
2023-04-04 22:22:55,289 - Detection -   train_loss = 0.1842520629104815
2023-04-04 22:22:58,510 - Detection - ***** Epoch: 15: Eval results *****
2023-04-04 22:22:58,510 - Detection -   best_eval_score = 95.4
2023-04-04 22:22:58,510 - Detection -   eval_score = 96.17
2023-04-04 22:22:58,510 - Detection -   train_loss = 0.16331399428217033
2023-04-04 22:23:01,750 - Detection - ***** Epoch: 16: Eval results *****
2023-04-04 22:23:01,750 - Detection -   best_eval_score = 96.17
2023-04-04 22:23:01,750 - Detection -   eval_score = 95.79
2023-04-04 22:23:01,750 - Detection -   train_loss = 0.14817460508723007
2023-04-04 22:23:04,956 - Detection - ***** Epoch: 17: Eval results *****
2023-04-04 22:23:04,956 - Detection -   best_eval_score = 96.17
2023-04-04 22:23:04,956 - Detection -   eval_score = 95.4
2023-04-04 22:23:04,956 - Detection -   train_loss = 0.12713517601552762
2023-04-04 22:23:08,175 - Detection - ***** Epoch: 18: Eval results *****
2023-04-04 22:23:08,175 - Detection -   best_eval_score = 96.17
2023-04-04 22:23:08,175 - Detection -   eval_score = 95.79
2023-04-04 22:23:08,175 - Detection -   train_loss = 0.12130851298570633
2023-04-04 22:23:11,389 - Detection - ***** Epoch: 19: Eval results *****
2023-04-04 22:23:11,389 - Detection -   best_eval_score = 96.17
2023-04-04 22:23:11,389 - Detection -   eval_score = 96.17
2023-04-04 22:23:11,389 - Detection -   train_loss = 0.1062452400985517
2023-04-04 22:23:14,602 - Detection - ***** Epoch: 20: Eval results *****
2023-04-04 22:23:14,602 - Detection -   best_eval_score = 96.17
2023-04-04 22:23:14,602 - Detection -   eval_score = 95.79
2023-04-04 22:23:14,602 - Detection -   train_loss = 0.104714193626454
2023-04-04 22:23:17,814 - Detection - ***** Epoch: 21: Eval results *****
2023-04-04 22:23:17,814 - Detection -   best_eval_score = 96.17
2023-04-04 22:23:17,814 - Detection -   eval_score = 95.02
2023-04-04 22:23:17,814 - Detection -   train_loss = 0.09155979281977604
2023-04-04 22:23:21,029 - Detection - ***** Epoch: 22: Eval results *****
2023-04-04 22:23:21,029 - Detection -   best_eval_score = 96.17
2023-04-04 22:23:21,029 - Detection -   eval_score = 95.4
2023-04-04 22:23:21,029 - Detection -   train_loss = 0.08288243903141272
2023-04-04 22:23:24,245 - Detection - ***** Epoch: 23: Eval results *****
2023-04-04 22:23:24,245 - Detection -   best_eval_score = 96.17
2023-04-04 22:23:24,245 - Detection -   eval_score = 95.79
2023-04-04 22:23:24,245 - Detection -   train_loss = 0.07464207983330677
2023-04-04 22:23:27,460 - Detection - ***** Epoch: 24: Eval results *****
2023-04-04 22:23:27,460 - Detection -   best_eval_score = 96.17
2023-04-04 22:23:27,460 - Detection -   eval_score = 95.4
2023-04-04 22:23:27,460 - Detection -   train_loss = 0.0734615600422809
2023-04-04 22:23:30,676 - Detection - ***** Epoch: 25: Eval results *****
2023-04-04 22:23:30,676 - Detection -   best_eval_score = 96.17
2023-04-04 22:23:30,676 - Detection -   eval_score = 95.79
2023-04-04 22:23:30,676 - Detection -   train_loss = 0.07362297314562295
2023-04-04 22:23:30,677 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_0.25_1.0_bert_7/models
2023-04-04 22:23:31,231 - Detection - Pre-training finished...
2023-04-04 22:23:31,232 - Detection - Training Begin...
2023-04-04 22:23:36,891 - Detection - ***** Epoch: 1: Eval results *****
2023-04-04 22:23:36,891 - Detection -   best_eval_score = 0
2023-04-04 22:23:36,891 - Detection -   eval_score = 0.77
2023-04-04 22:23:36,891 - Detection -   train_loss = 8.249189552507902
2023-04-04 22:23:40,062 - Detection - ***** Epoch: 2: Eval results *****
2023-04-04 22:23:40,062 - Detection -   best_eval_score = 0.77
2023-04-04 22:23:40,062 - Detection -   eval_score = 3.06
2023-04-04 22:23:40,062 - Detection -   train_loss = 7.595790612070184
2023-04-04 22:23:43,234 - Detection - ***** Epoch: 3: Eval results *****
2023-04-04 22:23:43,234 - Detection -   best_eval_score = 3.06
2023-04-04 22:23:43,234 - Detection -   eval_score = 11.69
2023-04-04 22:23:43,234 - Detection -   train_loss = 6.825704624778346
2023-04-04 22:23:46,403 - Detection - ***** Epoch: 4: Eval results *****
2023-04-04 22:23:46,403 - Detection -   best_eval_score = 11.69
2023-04-04 22:23:46,403 - Detection -   eval_score = 28.15
2023-04-04 22:23:46,403 - Detection -   train_loss = 5.887365040026213
2023-04-04 22:23:49,567 - Detection - ***** Epoch: 5: Eval results *****
2023-04-04 22:23:49,567 - Detection -   best_eval_score = 28.15
2023-04-04 22:23:49,567 - Detection -   eval_score = 46.57
2023-04-04 22:23:49,567 - Detection -   train_loss = 4.890799949043675
2023-04-04 22:23:52,739 - Detection - ***** Epoch: 6: Eval results *****
2023-04-04 22:23:52,739 - Detection -   best_eval_score = 46.57
2023-04-04 22:23:52,739 - Detection -   eval_score = 64.28
2023-04-04 22:23:52,739 - Detection -   train_loss = 3.846638616762663
2023-04-04 22:23:55,904 - Detection - ***** Epoch: 7: Eval results *****
2023-04-04 22:23:55,904 - Detection -   best_eval_score = 64.28
2023-04-04 22:23:55,904 - Detection -   eval_score = 73.75
2023-04-04 22:23:55,904 - Detection -   train_loss = 2.8853342031177722
2023-04-04 22:23:59,067 - Detection - ***** Epoch: 8: Eval results *****
2023-04-04 22:23:59,067 - Detection -   best_eval_score = 73.75
2023-04-04 22:23:59,067 - Detection -   eval_score = 81.99
2023-04-04 22:23:59,067 - Detection -   train_loss = 2.065259626037196
2023-04-04 22:24:02,227 - Detection - ***** Epoch: 9: Eval results *****
2023-04-04 22:24:02,227 - Detection -   best_eval_score = 81.99
2023-04-04 22:24:02,227 - Detection -   eval_score = 84.2
2023-04-04 22:24:02,227 - Detection -   train_loss = 1.4863566662135876
2023-04-04 22:24:05,385 - Detection - ***** Epoch: 10: Eval results *****
2023-04-04 22:24:05,385 - Detection -   best_eval_score = 84.2
2023-04-04 22:24:05,385 - Detection -   eval_score = 85.11
2023-04-04 22:24:05,385 - Detection -   train_loss = 1.1710419403879266
2023-04-04 22:24:08,550 - Detection - ***** Epoch: 11: Eval results *****
2023-04-04 22:24:08,550 - Detection -   best_eval_score = 85.11
2023-04-04 22:24:08,550 - Detection -   eval_score = 85.77
2023-04-04 22:24:08,550 - Detection -   train_loss = 1.1396439357807762
2023-04-04 22:24:11,714 - Detection - ***** Epoch: 12: Eval results *****
2023-04-04 22:24:11,714 - Detection -   best_eval_score = 85.77
2023-04-04 22:24:11,714 - Detection -   eval_score = 85.77
2023-04-04 22:24:11,714 - Detection -   train_loss = 1.07771099554865
2023-04-04 22:24:14,871 - Detection - ***** Epoch: 13: Eval results *****
2023-04-04 22:24:14,871 - Detection -   best_eval_score = 85.77
2023-04-04 22:24:14,871 - Detection -   eval_score = 85.77
2023-04-04 22:24:14,871 - Detection -   train_loss = 1.1061426934443022
2023-04-04 22:24:18,029 - Detection - ***** Epoch: 14: Eval results *****
2023-04-04 22:24:18,030 - Detection -   best_eval_score = 85.77
2023-04-04 22:24:18,030 - Detection -   eval_score = 85.77
2023-04-04 22:24:18,030 - Detection -   train_loss = 1.073556175357417
2023-04-04 22:24:21,187 - Detection - ***** Epoch: 15: Eval results *****
2023-04-04 22:24:21,187 - Detection -   best_eval_score = 85.77
2023-04-04 22:24:21,187 - Detection -   eval_score = 85.77
2023-04-04 22:24:21,187 - Detection -   train_loss = 1.0807710948743319
2023-04-04 22:24:24,349 - Detection - ***** Epoch: 16: Eval results *****
2023-04-04 22:24:24,349 - Detection -   best_eval_score = 85.77
2023-04-04 22:24:24,349 - Detection -   eval_score = 85.77
2023-04-04 22:24:24,350 - Detection -   train_loss = 1.0641468826093172
2023-04-04 22:24:27,603 - Detection - ***** Epoch: 17: Eval results *****
2023-04-04 22:24:27,603 - Detection -   best_eval_score = 85.77
2023-04-04 22:24:27,603 - Detection -   eval_score = 85.77
2023-04-04 22:24:27,603 - Detection -   train_loss = 1.0690586912004572
2023-04-04 22:24:30,750 - Detection - ***** Epoch: 18: Eval results *****
2023-04-04 22:24:30,750 - Detection -   best_eval_score = 85.77
2023-04-04 22:24:30,750 - Detection -   eval_score = 85.77
2023-04-04 22:24:30,751 - Detection -   train_loss = 1.0725373719867908
2023-04-04 22:24:33,903 - Detection - ***** Epoch: 19: Eval results *****
2023-04-04 22:24:33,903 - Detection -   best_eval_score = 85.77
2023-04-04 22:24:33,903 - Detection -   eval_score = 85.77
2023-04-04 22:24:33,903 - Detection -   train_loss = 1.0743796511700279
2023-04-04 22:24:37,055 - Detection - ***** Epoch: 20: Eval results *****
2023-04-04 22:24:37,055 - Detection -   best_eval_score = 85.77
2023-04-04 22:24:37,055 - Detection -   eval_score = 85.77
2023-04-04 22:24:37,055 - Detection -   train_loss = 1.0932288922761615
2023-04-04 22:24:40,209 - Detection - ***** Epoch: 21: Eval results *****
2023-04-04 22:24:40,209 - Detection -   best_eval_score = 85.77
2023-04-04 22:24:40,209 - Detection -   eval_score = 85.77
2023-04-04 22:24:40,209 - Detection -   train_loss = 1.0565388265408968
2023-04-04 22:24:40,210 - Detection - Training Finished...
2023-04-04 22:24:40,211 - Detection - Testing begin...
2023-04-04 22:24:43,558 - Detection - ***** Test: Confusion Matrix *****
2023-04-04 22:24:43,559 - Detection - [[  25    0    0    0    0    0    0    0    1    0    7    0    0    0
     0    0    0    0    0    7]
 [   0   37    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    3]
 [   0    0   36    0    0    0    0    0    0    0    0    0    0    0
     0    1    0    0    0    3]
 [   0    0    0   34    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    6]
 [   0    0    0    0   36    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    4]
 [   0    0    0    0    0   32    0    0    0    0    0    7    0    0
     0    0    0    0    0    1]
 [   0    0    0    0    0    0   37    0    0    0    0    0    0    0
     0    0    0    0    0    3]
 [   0    0    0    0    0    0    0   35    0    0    0    0    0    0
     0    0    0    0    0    5]
 [   0    0    0    0    0    0    0    0   33    0    0    0    0    0
     0    0    0    0    0    7]
 [   0    0    0    0    0    0    0    0    0   40    0    0    0    0
     0    0    0    0    0    0]
 [   1    0    0    0    0    0    0    0    0    0   38    0    0    0
     0    0    0    0    0    1]
 [   0    0    0    0    0    0    0    0    0    0    0   35    0    0
     0    0    0    0    0    5]
 [   0    0    0    0    0    0    0    0    0    0    0    0   38    0
     0    0    0    0    0    2]
 [   0    0    0    0    1    0    0    0    0    0    0    0    0   36
     0    0    0    0    0    3]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
    36    0    0    0    0    4]
 [   0    0    3    0    0    0    0    0    0    0    0    0    0    0
     0   33    0    0    0    4]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0   38    0    0    2]
 [   0    0    0    0    0    0    0    0    1    0    0    0    0    0
     0    0    0   35    0    4]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0   37    3]
 [  28   88   41   30   11   26   50   38   18    0   48    7   10   27
    30   31   34   23   20 1760]]
2023-04-04 22:24:43,559 - Detection - ***** Test results *****
2023-04-04 22:24:43,559 - Detection -   Acc = 78.93
2023-04-04 22:24:43,559 - Detection -   F1 = 69.2515
2023-04-04 22:24:43,559 - Detection -   F1-known = 68.4289
2023-04-04 22:24:43,559 - Detection -   F1-open = 84.8806
2023-04-04 22:24:43,559 - Detection - Testing finished...
2023-04-04 22:24:43,559 - Detection - Results saved in results/results_ADB.csv
2023-04-04 22:24:43,576 - Detection - Open Intent Detection Finished...
