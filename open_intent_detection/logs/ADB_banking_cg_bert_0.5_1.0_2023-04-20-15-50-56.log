2023-04-20 15:50:56,633 - Detection - Open Intent Detection Begin...
2023-04-20 15:50:56,633 - Detection - Parameters Initialization...
2023-04-20 15:50:56,633 - Detection - ============================== Params ==============================
2023-04-20 15:50:56,633 - Detection - type:	open_intent_detection
2023-04-20 15:50:56,633 - Detection - logger_name:	Detection
2023-04-20 15:50:56,633 - Detection - log_dir:	logs
2023-04-20 15:50:56,633 - Detection - dataset:	banking_cg
2023-04-20 15:50:56,633 - Detection - known_cls_ratio:	0.5
2023-04-20 15:50:56,633 - Detection - labeled_ratio:	1.0
2023-04-20 15:50:56,633 - Detection - method:	ADB
2023-04-20 15:50:56,633 - Detection - train:	True
2023-04-20 15:50:56,633 - Detection - pretrain:	True
2023-04-20 15:50:56,633 - Detection - save_model:	True
2023-04-20 15:50:56,633 - Detection - backbone:	bert
2023-04-20 15:50:56,633 - Detection - config_file_name:	ADB
2023-04-20 15:50:56,633 - Detection - seed:	0
2023-04-20 15:50:56,633 - Detection - gpu_id:	0
2023-04-20 15:50:56,633 - Detection - pipe_results_path:	pipe_results
2023-04-20 15:50:56,633 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-20 15:50:56,633 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-20 15:50:56,633 - Detection - model_dir:	models
2023-04-20 15:50:56,633 - Detection - load_pretrained_method:	None
2023-04-20 15:50:56,633 - Detection - result_dir:	results
2023-04-20 15:50:56,633 - Detection - results_file_name:	results_ADB.csv
2023-04-20 15:50:56,633 - Detection - save_results:	True
2023-04-20 15:50:56,633 - Detection - loss_fct:	CrossEntropyLoss
2023-04-20 15:50:56,633 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.5_1.0_bert_0
2023-04-20 15:50:56,633 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.5_1.0_bert_0/models
2023-04-20 15:50:56,633 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-20 15:50:56,633 - Detection - num_train_epochs:	100
2023-04-20 15:50:56,633 - Detection - num_labels:	None
2023-04-20 15:50:56,633 - Detection - max_seq_length:	None
2023-04-20 15:50:56,633 - Detection - freeze_backbone_parameters:	True
2023-04-20 15:50:56,633 - Detection - feat_dim:	768
2023-04-20 15:50:56,633 - Detection - warmup_proportion:	0.1
2023-04-20 15:50:56,633 - Detection - lr_boundary:	0.05
2023-04-20 15:50:56,634 - Detection - lr:	2e-05
2023-04-20 15:50:56,634 - Detection - activation:	relu
2023-04-20 15:50:56,634 - Detection - train_batch_size:	128
2023-04-20 15:50:56,634 - Detection - eval_batch_size:	64
2023-04-20 15:50:56,634 - Detection - test_batch_size:	64
2023-04-20 15:50:56,634 - Detection - wait_patient:	10
2023-04-20 15:50:56,634 - Detection - ============================== End Params ==============================
2023-04-20 15:50:56,634 - Detection - Data and Model Preparation...
2023-04-20 15:50:56,634 - Detection - The number of known intents is 38
2023-04-20 15:50:56,634 - Detection - Lists of known labels are: ['pending_top_up', 'why_verify_identity', 'top_up_failed', 'supported_cards_and_currencies', 'exchange_via_app', 'declined_card_payment', 'unable_to_verify_identity', 'exchange_rate', 'passcode_forgotten', 'verify_my_identity', 'declined_cash_withdrawal', 'top_up_limits', 'apple_pay_or_google_pay', 'lost_or_stolen_card', 'lost_or_stolen_phone', 'balance_not_updated_after_cheque_or_cash_deposit', 'change_pin', 'getting_virtual_card', 'pin_blocked', 'get_disposable_virtual_card', 'top_up_reverted', 'reverted_card_payment?', 'topping_up_by_card', 'top_up_by_bank_transfer_charge', 'virtual_card_not_working', 'balance_not_updated_after_bank_transfer', 'request_refund', 'verify_source_of_funds', 'atm_support', 'disposable_card_limits', 'pending_transfer', 'age_limit', 'declined_transfer', 'card_acceptance', 'compromised_card', 'card_about_to_expire', 'edit_personal_details', 'getting_spare_card']
2023-04-20 15:50:56,644 - Detection - Number of labeled training samples = 1149
2023-04-20 15:50:56,644 - Detection - Number of unlabeled training samples = 1623
2023-04-20 15:50:56,645 - Detection - Number of evaluation samples = 370
2023-04-20 15:50:56,650 - Detection - Number of testing samples = 1896
2023-04-20 15:51:00,569 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-20 15:51:02,252 - Detection - Pre-training Begin...
2023-04-20 15:51:04,479 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 15:51:04,479 - Detection -   best_eval_score = 0
2023-04-20 15:51:04,479 - Detection -   eval_score = 3.51
2023-04-20 15:51:04,479 - Detection -   train_loss = 3.6424014038509793
2023-04-20 15:51:06,238 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 15:51:06,238 - Detection -   best_eval_score = 3.51
2023-04-20 15:51:06,238 - Detection -   eval_score = 5.41
2023-04-20 15:51:06,238 - Detection -   train_loss = 3.6310138967302112
2023-04-20 15:51:08,001 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 15:51:08,001 - Detection -   best_eval_score = 5.41
2023-04-20 15:51:08,001 - Detection -   eval_score = 5.95
2023-04-20 15:51:08,002 - Detection -   train_loss = 3.6043626732296414
2023-04-20 15:51:09,747 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 15:51:09,747 - Detection -   best_eval_score = 5.95
2023-04-20 15:51:09,747 - Detection -   eval_score = 6.76
2023-04-20 15:51:09,747 - Detection -   train_loss = 3.5716584258609347
2023-04-20 15:51:11,517 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 15:51:11,517 - Detection -   best_eval_score = 6.76
2023-04-20 15:51:11,517 - Detection -   eval_score = 5.95
2023-04-20 15:51:11,517 - Detection -   train_loss = 3.5220276514689126
2023-04-20 15:51:13,313 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 15:51:13,313 - Detection -   best_eval_score = 6.76
2023-04-20 15:51:13,313 - Detection -   eval_score = 5.14
2023-04-20 15:51:13,313 - Detection -   train_loss = 3.4474515120188394
2023-04-20 15:51:15,179 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 15:51:15,179 - Detection -   best_eval_score = 6.76
2023-04-20 15:51:15,179 - Detection -   eval_score = 7.84
2023-04-20 15:51:15,179 - Detection -   train_loss = 3.335446410708957
2023-04-20 15:51:16,989 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 15:51:16,989 - Detection -   best_eval_score = 7.84
2023-04-20 15:51:16,989 - Detection -   eval_score = 21.08
2023-04-20 15:51:16,989 - Detection -   train_loss = 3.1473102834489612
2023-04-20 15:51:18,824 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 15:51:18,824 - Detection -   best_eval_score = 21.08
2023-04-20 15:51:18,824 - Detection -   eval_score = 30.0
2023-04-20 15:51:18,824 - Detection -   train_loss = 2.8761584758758545
2023-04-20 15:51:20,701 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 15:51:20,701 - Detection -   best_eval_score = 30.0
2023-04-20 15:51:20,701 - Detection -   eval_score = 35.41
2023-04-20 15:51:20,701 - Detection -   train_loss = 2.538861221737332
2023-04-20 15:51:22,550 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 15:51:22,550 - Detection -   best_eval_score = 35.41
2023-04-20 15:51:22,550 - Detection -   eval_score = 42.16
2023-04-20 15:51:22,550 - Detection -   train_loss = 2.170349637667338
2023-04-20 15:51:24,374 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 15:51:24,374 - Detection -   best_eval_score = 42.16
2023-04-20 15:51:24,374 - Detection -   eval_score = 49.46
2023-04-20 15:51:24,374 - Detection -   train_loss = 1.8274158371819391
2023-04-20 15:51:26,293 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 15:51:26,293 - Detection -   best_eval_score = 49.46
2023-04-20 15:51:26,293 - Detection -   eval_score = 56.22
2023-04-20 15:51:26,293 - Detection -   train_loss = 1.5465199682447646
2023-04-20 15:51:28,196 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 15:51:28,196 - Detection -   best_eval_score = 56.22
2023-04-20 15:51:28,196 - Detection -   eval_score = 59.73
2023-04-20 15:51:28,196 - Detection -   train_loss = 1.3082674079471164
2023-04-20 15:51:30,039 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 15:51:30,039 - Detection -   best_eval_score = 59.73
2023-04-20 15:51:30,039 - Detection -   eval_score = 63.51
2023-04-20 15:51:30,039 - Detection -   train_loss = 1.1261772976981268
2023-04-20 15:51:31,983 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 15:51:31,983 - Detection -   best_eval_score = 63.51
2023-04-20 15:51:31,983 - Detection -   eval_score = 64.86
2023-04-20 15:51:31,983 - Detection -   train_loss = 0.9752905633714464
2023-04-20 15:51:33,830 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 15:51:33,830 - Detection -   best_eval_score = 64.86
2023-04-20 15:51:33,830 - Detection -   eval_score = 67.03
2023-04-20 15:51:33,830 - Detection -   train_loss = 0.8561481965912713
2023-04-20 15:51:35,685 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 15:51:35,685 - Detection -   best_eval_score = 67.03
2023-04-20 15:51:35,685 - Detection -   eval_score = 68.92
2023-04-20 15:51:35,685 - Detection -   train_loss = 0.762484073638916
2023-04-20 15:51:37,548 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 15:51:37,548 - Detection -   best_eval_score = 68.92
2023-04-20 15:51:37,548 - Detection -   eval_score = 70.81
2023-04-20 15:51:37,548 - Detection -   train_loss = 0.6875427696439955
2023-04-20 15:51:39,412 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 15:51:39,412 - Detection -   best_eval_score = 70.81
2023-04-20 15:51:39,412 - Detection -   eval_score = 72.43
2023-04-20 15:51:39,412 - Detection -   train_loss = 0.6243681973881192
2023-04-20 15:51:41,284 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 15:51:41,284 - Detection -   best_eval_score = 72.43
2023-04-20 15:51:41,284 - Detection -   eval_score = 73.51
2023-04-20 15:51:41,284 - Detection -   train_loss = 0.5599353677696652
2023-04-20 15:51:43,151 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 15:51:43,151 - Detection -   best_eval_score = 73.51
2023-04-20 15:51:43,151 - Detection -   eval_score = 72.97
2023-04-20 15:51:43,151 - Detection -   train_loss = 0.5183463593324026
2023-04-20 15:51:45,005 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 15:51:45,005 - Detection -   best_eval_score = 73.51
2023-04-20 15:51:45,005 - Detection -   eval_score = 74.59
2023-04-20 15:51:45,005 - Detection -   train_loss = 0.4781705273522271
2023-04-20 15:51:46,877 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 15:51:46,877 - Detection -   best_eval_score = 74.59
2023-04-20 15:51:46,877 - Detection -   eval_score = 75.14
2023-04-20 15:51:46,877 - Detection -   train_loss = 0.43923694226476884
2023-04-20 15:51:48,735 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 15:51:48,735 - Detection -   best_eval_score = 75.14
2023-04-20 15:51:48,735 - Detection -   eval_score = 75.95
2023-04-20 15:51:48,735 - Detection -   train_loss = 0.398488677210278
2023-04-20 15:51:50,720 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 15:51:50,720 - Detection -   best_eval_score = 75.95
2023-04-20 15:51:50,720 - Detection -   eval_score = 75.68
2023-04-20 15:51:50,720 - Detection -   train_loss = 0.3809083534611596
2023-04-20 15:51:52,657 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 15:51:52,657 - Detection -   best_eval_score = 75.95
2023-04-20 15:51:52,657 - Detection -   eval_score = 77.03
2023-04-20 15:51:52,657 - Detection -   train_loss = 0.35691121882862514
2023-04-20 15:51:54,536 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 15:51:54,536 - Detection -   best_eval_score = 77.03
2023-04-20 15:51:54,536 - Detection -   eval_score = 76.22
2023-04-20 15:51:54,536 - Detection -   train_loss = 0.33664725555313957
2023-04-20 15:51:56,439 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 15:51:56,439 - Detection -   best_eval_score = 77.03
2023-04-20 15:51:56,439 - Detection -   eval_score = 77.3
2023-04-20 15:51:56,439 - Detection -   train_loss = 0.3126275771194034
2023-04-20 15:51:58,329 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 15:51:58,329 - Detection -   best_eval_score = 77.3
2023-04-20 15:51:58,329 - Detection -   eval_score = 78.11
2023-04-20 15:51:58,329 - Detection -   train_loss = 0.2997702459494273
2023-04-20 15:52:00,239 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 15:52:00,239 - Detection -   best_eval_score = 78.11
2023-04-20 15:52:00,239 - Detection -   eval_score = 77.57
2023-04-20 15:52:00,239 - Detection -   train_loss = 0.28211698598331875
2023-04-20 15:52:02,160 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 15:52:02,160 - Detection -   best_eval_score = 78.11
2023-04-20 15:52:02,160 - Detection -   eval_score = 78.11
2023-04-20 15:52:02,160 - Detection -   train_loss = 0.25851651695039535
2023-04-20 15:52:04,038 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 15:52:04,038 - Detection -   best_eval_score = 78.11
2023-04-20 15:52:04,038 - Detection -   eval_score = 78.11
2023-04-20 15:52:04,038 - Detection -   train_loss = 0.24926367236508262
2023-04-20 15:52:05,909 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 15:52:05,909 - Detection -   best_eval_score = 78.11
2023-04-20 15:52:05,909 - Detection -   eval_score = 78.11
2023-04-20 15:52:05,909 - Detection -   train_loss = 0.2401522265540229
2023-04-20 15:52:07,778 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 15:52:07,778 - Detection -   best_eval_score = 78.11
2023-04-20 15:52:07,778 - Detection -   eval_score = 79.19
2023-04-20 15:52:07,778 - Detection -   train_loss = 0.23225793739159903
2023-04-20 15:52:09,679 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 15:52:09,679 - Detection -   best_eval_score = 79.19
2023-04-20 15:52:09,679 - Detection -   eval_score = 78.38
2023-04-20 15:52:09,679 - Detection -   train_loss = 0.212781579958068
2023-04-20 15:52:11,609 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 15:52:11,609 - Detection -   best_eval_score = 79.19
2023-04-20 15:52:11,609 - Detection -   eval_score = 79.73
2023-04-20 15:52:11,609 - Detection -   train_loss = 0.20626130368974474
2023-04-20 15:52:13,552 - Detection - ***** Epoch: 38: Eval results *****
2023-04-20 15:52:13,553 - Detection -   best_eval_score = 79.73
2023-04-20 15:52:13,553 - Detection -   eval_score = 79.46
2023-04-20 15:52:13,553 - Detection -   train_loss = 0.19924556215604147
2023-04-20 15:52:15,425 - Detection - ***** Epoch: 39: Eval results *****
2023-04-20 15:52:15,425 - Detection -   best_eval_score = 79.73
2023-04-20 15:52:15,425 - Detection -   eval_score = 79.19
2023-04-20 15:52:15,425 - Detection -   train_loss = 0.1888620505730311
2023-04-20 15:52:17,293 - Detection - ***** Epoch: 40: Eval results *****
2023-04-20 15:52:17,294 - Detection -   best_eval_score = 79.73
2023-04-20 15:52:17,294 - Detection -   eval_score = 79.46
2023-04-20 15:52:17,294 - Detection -   train_loss = 0.18279683921072218
2023-04-20 15:52:19,160 - Detection - ***** Epoch: 41: Eval results *****
2023-04-20 15:52:19,160 - Detection -   best_eval_score = 79.73
2023-04-20 15:52:19,160 - Detection -   eval_score = 79.19
2023-04-20 15:52:19,160 - Detection -   train_loss = 0.17356224523650277
2023-04-20 15:52:21,047 - Detection - ***** Epoch: 42: Eval results *****
2023-04-20 15:52:21,047 - Detection -   best_eval_score = 79.73
2023-04-20 15:52:21,047 - Detection -   eval_score = 80.27
2023-04-20 15:52:21,047 - Detection -   train_loss = 0.17182644539409214
2023-04-20 15:52:22,907 - Detection - ***** Epoch: 43: Eval results *****
2023-04-20 15:52:22,907 - Detection -   best_eval_score = 80.27
2023-04-20 15:52:22,907 - Detection -   eval_score = 80.54
2023-04-20 15:52:22,907 - Detection -   train_loss = 0.159053482943111
2023-04-20 15:52:24,826 - Detection - ***** Epoch: 44: Eval results *****
2023-04-20 15:52:24,826 - Detection -   best_eval_score = 80.54
2023-04-20 15:52:24,826 - Detection -   eval_score = 79.19
2023-04-20 15:52:24,826 - Detection -   train_loss = 0.1585125293996599
2023-04-20 15:52:26,727 - Detection - ***** Epoch: 45: Eval results *****
2023-04-20 15:52:26,727 - Detection -   best_eval_score = 80.54
2023-04-20 15:52:26,727 - Detection -   eval_score = 79.46
2023-04-20 15:52:26,728 - Detection -   train_loss = 0.15750818120108712
2023-04-20 15:52:28,627 - Detection - ***** Epoch: 46: Eval results *****
2023-04-20 15:52:28,627 - Detection -   best_eval_score = 80.54
2023-04-20 15:52:28,627 - Detection -   eval_score = 80.54
2023-04-20 15:52:28,627 - Detection -   train_loss = 0.14606404966778225
2023-04-20 15:52:30,604 - Detection - ***** Epoch: 47: Eval results *****
2023-04-20 15:52:30,604 - Detection -   best_eval_score = 80.54
2023-04-20 15:52:30,604 - Detection -   eval_score = 79.73
2023-04-20 15:52:30,604 - Detection -   train_loss = 0.14716358648406136
2023-04-20 15:52:32,561 - Detection - ***** Epoch: 48: Eval results *****
2023-04-20 15:52:32,561 - Detection -   best_eval_score = 80.54
2023-04-20 15:52:32,561 - Detection -   eval_score = 79.73
2023-04-20 15:52:32,561 - Detection -   train_loss = 0.14162685142623055
2023-04-20 15:52:34,477 - Detection - ***** Epoch: 49: Eval results *****
2023-04-20 15:52:34,477 - Detection -   best_eval_score = 80.54
2023-04-20 15:52:34,477 - Detection -   eval_score = 80.27
2023-04-20 15:52:34,477 - Detection -   train_loss = 0.13752955943346024
2023-04-20 15:52:36,370 - Detection - ***** Epoch: 50: Eval results *****
2023-04-20 15:52:36,370 - Detection -   best_eval_score = 80.54
2023-04-20 15:52:36,370 - Detection -   eval_score = 80.27
2023-04-20 15:52:36,371 - Detection -   train_loss = 0.12927836759222877
2023-04-20 15:52:38,230 - Detection - ***** Epoch: 51: Eval results *****
2023-04-20 15:52:38,230 - Detection -   best_eval_score = 80.54
2023-04-20 15:52:38,230 - Detection -   eval_score = 80.81
2023-04-20 15:52:38,230 - Detection -   train_loss = 0.12310194224119186
2023-04-20 15:52:40,100 - Detection - ***** Epoch: 52: Eval results *****
2023-04-20 15:52:40,100 - Detection -   best_eval_score = 80.81
2023-04-20 15:52:40,100 - Detection -   eval_score = 80.0
2023-04-20 15:52:40,100 - Detection -   train_loss = 0.12036324292421341
2023-04-20 15:52:41,995 - Detection - ***** Epoch: 53: Eval results *****
2023-04-20 15:52:41,995 - Detection -   best_eval_score = 80.81
2023-04-20 15:52:41,995 - Detection -   eval_score = 79.46
2023-04-20 15:52:41,995 - Detection -   train_loss = 0.11875104738606347
2023-04-20 15:52:43,909 - Detection - ***** Epoch: 54: Eval results *****
2023-04-20 15:52:43,909 - Detection -   best_eval_score = 80.81
2023-04-20 15:52:43,909 - Detection -   eval_score = 80.54
2023-04-20 15:52:43,909 - Detection -   train_loss = 0.12041120562288496
2023-04-20 15:52:45,821 - Detection - ***** Epoch: 55: Eval results *****
2023-04-20 15:52:45,821 - Detection -   best_eval_score = 80.81
2023-04-20 15:52:45,821 - Detection -   eval_score = 79.73
2023-04-20 15:52:45,821 - Detection -   train_loss = 0.11581430087486903
2023-04-20 15:52:47,787 - Detection - ***** Epoch: 56: Eval results *****
2023-04-20 15:52:47,787 - Detection -   best_eval_score = 80.81
2023-04-20 15:52:47,787 - Detection -   eval_score = 80.0
2023-04-20 15:52:47,787 - Detection -   train_loss = 0.11285342690017489
2023-04-20 15:52:49,724 - Detection - ***** Epoch: 57: Eval results *****
2023-04-20 15:52:49,724 - Detection -   best_eval_score = 80.81
2023-04-20 15:52:49,724 - Detection -   eval_score = 80.0
2023-04-20 15:52:49,724 - Detection -   train_loss = 0.10722291304005517
2023-04-20 15:52:51,622 - Detection - ***** Epoch: 58: Eval results *****
2023-04-20 15:52:51,622 - Detection -   best_eval_score = 80.81
2023-04-20 15:52:51,622 - Detection -   eval_score = 80.27
2023-04-20 15:52:51,622 - Detection -   train_loss = 0.10977103147241804
2023-04-20 15:52:53,572 - Detection - ***** Epoch: 59: Eval results *****
2023-04-20 15:52:53,572 - Detection -   best_eval_score = 80.81
2023-04-20 15:52:53,572 - Detection -   eval_score = 80.27
2023-04-20 15:52:53,572 - Detection -   train_loss = 0.1030993875530031
2023-04-20 15:52:55,529 - Detection - ***** Epoch: 60: Eval results *****
2023-04-20 15:52:55,529 - Detection -   best_eval_score = 80.81
2023-04-20 15:52:55,529 - Detection -   eval_score = 80.54
2023-04-20 15:52:55,529 - Detection -   train_loss = 0.10614501188198726
2023-04-20 15:52:57,446 - Detection - ***** Epoch: 61: Eval results *****
2023-04-20 15:52:57,446 - Detection -   best_eval_score = 80.81
2023-04-20 15:52:57,446 - Detection -   eval_score = 80.54
2023-04-20 15:52:57,446 - Detection -   train_loss = 0.09548785537481308
2023-04-20 15:52:57,446 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.5_1.0_bert_0/models
2023-04-20 15:52:57,993 - Detection - Pre-training finished...
2023-04-20 15:52:57,993 - Detection - Training Begin...
2023-04-20 15:53:01,070 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 15:53:01,070 - Detection -   best_eval_score = 0
2023-04-20 15:53:01,070 - Detection -   eval_score = 0.0
2023-04-20 15:53:01,070 - Detection -   train_loss = 11.005827056037056
2023-04-20 15:53:02,917 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 15:53:02,917 - Detection -   best_eval_score = 0
2023-04-20 15:53:02,917 - Detection -   eval_score = 0.0
2023-04-20 15:53:02,917 - Detection -   train_loss = 10.78900040520562
2023-04-20 15:53:04,811 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 15:53:04,812 - Detection -   best_eval_score = 0
2023-04-20 15:53:04,812 - Detection -   eval_score = 0.0
2023-04-20 15:53:04,812 - Detection -   train_loss = 10.490855640835232
2023-04-20 15:53:06,722 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 15:53:06,723 - Detection -   best_eval_score = 0
2023-04-20 15:53:06,723 - Detection -   eval_score = 0.0
2023-04-20 15:53:06,723 - Detection -   train_loss = 10.20189348856608
2023-04-20 15:53:08,559 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 15:53:08,560 - Detection -   best_eval_score = 0
2023-04-20 15:53:08,560 - Detection -   eval_score = 0.0
2023-04-20 15:53:08,560 - Detection -   train_loss = 9.851789050632053
2023-04-20 15:53:10,407 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 15:53:10,407 - Detection -   best_eval_score = 0
2023-04-20 15:53:10,407 - Detection -   eval_score = 0.0
2023-04-20 15:53:10,407 - Detection -   train_loss = 9.431655883789062
2023-04-20 15:53:12,268 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 15:53:12,268 - Detection -   best_eval_score = 0
2023-04-20 15:53:12,269 - Detection -   eval_score = 0.0
2023-04-20 15:53:12,269 - Detection -   train_loss = 8.995226118299696
2023-04-20 15:53:14,163 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 15:53:14,163 - Detection -   best_eval_score = 0
2023-04-20 15:53:14,163 - Detection -   eval_score = 0.0
2023-04-20 15:53:14,163 - Detection -   train_loss = 8.555397987365723
2023-04-20 15:53:16,089 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 15:53:16,089 - Detection -   best_eval_score = 0
2023-04-20 15:53:16,089 - Detection -   eval_score = 0.0
2023-04-20 15:53:16,089 - Detection -   train_loss = 8.085450967152914
2023-04-20 15:53:18,029 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 15:53:18,030 - Detection -   best_eval_score = 0
2023-04-20 15:53:18,030 - Detection -   eval_score = 0.32
2023-04-20 15:53:18,030 - Detection -   train_loss = 7.667170471615261
2023-04-20 15:53:19,871 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 15:53:19,871 - Detection -   best_eval_score = 0.32
2023-04-20 15:53:19,871 - Detection -   eval_score = 3.81
2023-04-20 15:53:19,871 - Detection -   train_loss = 7.1570102373758955
2023-04-20 15:53:21,745 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 15:53:21,745 - Detection -   best_eval_score = 3.81
2023-04-20 15:53:21,745 - Detection -   eval_score = 6.27
2023-04-20 15:53:21,745 - Detection -   train_loss = 6.681031703948975
2023-04-20 15:53:23,632 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 15:53:23,632 - Detection -   best_eval_score = 6.27
2023-04-20 15:53:23,633 - Detection -   eval_score = 9.47
2023-04-20 15:53:23,633 - Detection -   train_loss = 6.227532439761692
2023-04-20 15:53:25,492 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 15:53:25,492 - Detection -   best_eval_score = 9.47
2023-04-20 15:53:25,492 - Detection -   eval_score = 15.0
2023-04-20 15:53:25,492 - Detection -   train_loss = 5.714325533972846
2023-04-20 15:53:27,329 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 15:53:27,329 - Detection -   best_eval_score = 15.0
2023-04-20 15:53:27,329 - Detection -   eval_score = 18.52
2023-04-20 15:53:27,329 - Detection -   train_loss = 5.30298466152615
2023-04-20 15:53:29,189 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 15:53:29,189 - Detection -   best_eval_score = 18.52
2023-04-20 15:53:29,189 - Detection -   eval_score = 25.93
2023-04-20 15:53:29,189 - Detection -   train_loss = 4.857094075944689
2023-04-20 15:53:31,146 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 15:53:31,146 - Detection -   best_eval_score = 25.93
2023-04-20 15:53:31,146 - Detection -   eval_score = 30.08
2023-04-20 15:53:31,146 - Detection -   train_loss = 4.40823491414388
2023-04-20 15:53:32,984 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 15:53:32,985 - Detection -   best_eval_score = 30.08
2023-04-20 15:53:32,985 - Detection -   eval_score = 36.75
2023-04-20 15:53:32,985 - Detection -   train_loss = 3.9470475249820285
2023-04-20 15:53:34,930 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 15:53:34,930 - Detection -   best_eval_score = 36.75
2023-04-20 15:53:34,930 - Detection -   eval_score = 42.12
2023-04-20 15:53:34,930 - Detection -   train_loss = 3.5322634908888073
2023-04-20 15:53:36,881 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 15:53:36,881 - Detection -   best_eval_score = 42.12
2023-04-20 15:53:36,881 - Detection -   eval_score = 44.46
2023-04-20 15:53:36,881 - Detection -   train_loss = 3.083588123321533
2023-04-20 15:53:38,712 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 15:53:38,712 - Detection -   best_eval_score = 44.46
2023-04-20 15:53:38,712 - Detection -   eval_score = 47.03
2023-04-20 15:53:38,713 - Detection -   train_loss = 2.6799134413401284
2023-04-20 15:53:40,557 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 15:53:40,557 - Detection -   best_eval_score = 47.03
2023-04-20 15:53:40,557 - Detection -   eval_score = 49.29
2023-04-20 15:53:40,557 - Detection -   train_loss = 2.3081377347310386
2023-04-20 15:53:42,498 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 15:53:42,498 - Detection -   best_eval_score = 49.29
2023-04-20 15:53:42,498 - Detection -   eval_score = 54.45
2023-04-20 15:53:42,498 - Detection -   train_loss = 2.00409287876553
2023-04-20 15:53:44,462 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 15:53:44,462 - Detection -   best_eval_score = 54.45
2023-04-20 15:53:44,462 - Detection -   eval_score = 56.23
2023-04-20 15:53:44,462 - Detection -   train_loss = 1.7416034274631076
2023-04-20 15:53:46,415 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 15:53:46,416 - Detection -   best_eval_score = 56.23
2023-04-20 15:53:46,416 - Detection -   eval_score = 58.51
2023-04-20 15:53:46,416 - Detection -   train_loss = 1.5534292062123616
2023-04-20 15:53:48,366 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 15:53:48,366 - Detection -   best_eval_score = 58.51
2023-04-20 15:53:48,366 - Detection -   eval_score = 59.59
2023-04-20 15:53:48,366 - Detection -   train_loss = 1.3905763891008165
2023-04-20 15:53:50,328 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 15:53:50,328 - Detection -   best_eval_score = 59.59
2023-04-20 15:53:50,328 - Detection -   eval_score = 60.32
2023-04-20 15:53:50,328 - Detection -   train_loss = 1.3433048062854342
2023-04-20 15:53:52,168 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 15:53:52,168 - Detection -   best_eval_score = 60.32
2023-04-20 15:53:52,168 - Detection -   eval_score = 61.28
2023-04-20 15:53:52,168 - Detection -   train_loss = 1.3364479939142864
2023-04-20 15:53:53,998 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 15:53:53,998 - Detection -   best_eval_score = 61.28
2023-04-20 15:53:53,998 - Detection -   eval_score = 62.77
2023-04-20 15:53:53,998 - Detection -   train_loss = 1.2624102301067777
2023-04-20 15:53:55,828 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 15:53:55,828 - Detection -   best_eval_score = 62.77
2023-04-20 15:53:55,828 - Detection -   eval_score = 62.62
2023-04-20 15:53:55,828 - Detection -   train_loss = 1.2220587730407715
2023-04-20 15:53:57,662 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 15:53:57,662 - Detection -   best_eval_score = 62.77
2023-04-20 15:53:57,662 - Detection -   eval_score = 63.5
2023-04-20 15:53:57,662 - Detection -   train_loss = 1.23812022474077
2023-04-20 15:53:59,520 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 15:53:59,520 - Detection -   best_eval_score = 63.5
2023-04-20 15:53:59,520 - Detection -   eval_score = 64.36
2023-04-20 15:53:59,520 - Detection -   train_loss = 1.2673776414659288
2023-04-20 15:54:01,410 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 15:54:01,410 - Detection -   best_eval_score = 64.36
2023-04-20 15:54:01,410 - Detection -   eval_score = 64.57
2023-04-20 15:54:01,410 - Detection -   train_loss = 1.275142788887024
2023-04-20 15:54:03,281 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 15:54:03,281 - Detection -   best_eval_score = 64.57
2023-04-20 15:54:03,281 - Detection -   eval_score = 64.95
2023-04-20 15:54:03,281 - Detection -   train_loss = 1.2290919489330716
2023-04-20 15:54:05,228 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 15:54:05,228 - Detection -   best_eval_score = 64.95
2023-04-20 15:54:05,228 - Detection -   eval_score = 64.73
2023-04-20 15:54:05,228 - Detection -   train_loss = 1.2848099337683783
2023-04-20 15:54:07,140 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 15:54:07,140 - Detection -   best_eval_score = 64.95
2023-04-20 15:54:07,140 - Detection -   eval_score = 64.97
2023-04-20 15:54:07,140 - Detection -   train_loss = 1.254050890604655
2023-04-20 15:54:09,056 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 15:54:09,056 - Detection -   best_eval_score = 64.97
2023-04-20 15:54:09,056 - Detection -   eval_score = 64.76
2023-04-20 15:54:09,056 - Detection -   train_loss = 1.2286123434702556
2023-04-20 15:54:10,904 - Detection - ***** Epoch: 38: Eval results *****
2023-04-20 15:54:10,904 - Detection -   best_eval_score = 64.97
2023-04-20 15:54:10,904 - Detection -   eval_score = 65.2
2023-04-20 15:54:10,904 - Detection -   train_loss = 1.262016110950046
2023-04-20 15:54:12,749 - Detection - ***** Epoch: 39: Eval results *****
2023-04-20 15:54:12,749 - Detection -   best_eval_score = 65.2
2023-04-20 15:54:12,749 - Detection -   eval_score = 65.42
2023-04-20 15:54:12,749 - Detection -   train_loss = 1.2502849631839328
2023-04-20 15:54:14,630 - Detection - ***** Epoch: 40: Eval results *****
2023-04-20 15:54:14,630 - Detection -   best_eval_score = 65.42
2023-04-20 15:54:14,630 - Detection -   eval_score = 65.19
2023-04-20 15:54:14,630 - Detection -   train_loss = 1.2404637469185724
2023-04-20 15:54:16,495 - Detection - ***** Epoch: 41: Eval results *****
2023-04-20 15:54:16,495 - Detection -   best_eval_score = 65.42
2023-04-20 15:54:16,495 - Detection -   eval_score = 65.06
2023-04-20 15:54:16,495 - Detection -   train_loss = 1.2590641842948065
2023-04-20 15:54:18,347 - Detection - ***** Epoch: 42: Eval results *****
2023-04-20 15:54:18,347 - Detection -   best_eval_score = 65.42
2023-04-20 15:54:18,347 - Detection -   eval_score = 64.84
2023-04-20 15:54:18,347 - Detection -   train_loss = 1.2630945576561823
2023-04-20 15:54:20,192 - Detection - ***** Epoch: 43: Eval results *****
2023-04-20 15:54:20,192 - Detection -   best_eval_score = 65.42
2023-04-20 15:54:20,192 - Detection -   eval_score = 64.75
2023-04-20 15:54:20,192 - Detection -   train_loss = 1.2318075233035617
2023-04-20 15:54:22,042 - Detection - ***** Epoch: 44: Eval results *****
2023-04-20 15:54:22,043 - Detection -   best_eval_score = 65.42
2023-04-20 15:54:22,043 - Detection -   eval_score = 65.09
2023-04-20 15:54:22,043 - Detection -   train_loss = 1.2459454006618924
2023-04-20 15:54:23,886 - Detection - ***** Epoch: 45: Eval results *****
2023-04-20 15:54:23,886 - Detection -   best_eval_score = 65.42
2023-04-20 15:54:23,886 - Detection -   eval_score = 64.75
2023-04-20 15:54:23,886 - Detection -   train_loss = 1.2428401708602905
2023-04-20 15:54:25,710 - Detection - ***** Epoch: 46: Eval results *****
2023-04-20 15:54:25,710 - Detection -   best_eval_score = 65.42
2023-04-20 15:54:25,710 - Detection -   eval_score = 64.75
2023-04-20 15:54:25,710 - Detection -   train_loss = 1.2864817910724216
2023-04-20 15:54:27,546 - Detection - ***** Epoch: 47: Eval results *****
2023-04-20 15:54:27,547 - Detection -   best_eval_score = 65.42
2023-04-20 15:54:27,547 - Detection -   eval_score = 64.86
2023-04-20 15:54:27,547 - Detection -   train_loss = 1.2234468989902072
2023-04-20 15:54:29,373 - Detection - ***** Epoch: 48: Eval results *****
2023-04-20 15:54:29,373 - Detection -   best_eval_score = 65.42
2023-04-20 15:54:29,373 - Detection -   eval_score = 64.86
2023-04-20 15:54:29,373 - Detection -   train_loss = 1.2236457533306546
2023-04-20 15:54:31,214 - Detection - ***** Epoch: 49: Eval results *****
2023-04-20 15:54:31,214 - Detection -   best_eval_score = 65.42
2023-04-20 15:54:31,214 - Detection -   eval_score = 65.19
2023-04-20 15:54:31,214 - Detection -   train_loss = 1.2435926066504583
2023-04-20 15:54:31,215 - Detection - Training Finished...
2023-04-20 15:54:31,215 - Detection - Testing begin...
2023-04-20 15:54:33,297 - Detection - ***** Test: Confusion Matrix *****
2023-04-20 15:54:33,297 - Detection - [[ 15   0   1 ...   0   0   7]
 [  0  17   0 ...   0   0   0]
 [  0   0   8 ...   0   0   8]
 ...
 [  0   0   0 ...  20   0   7]
 [  0   0   0 ...   0   8  20]
 [  2   1   0 ...   0   3 710]]
2023-04-20 15:54:33,297 - Detection - ***** Test results *****
2023-04-20 15:54:33,297 - Detection -   Acc = 66.51
2023-04-20 15:54:33,297 - Detection -   F1 = 57.8161
2023-04-20 15:54:33,297 - Detection -   F1-known = 57.4427
2023-04-20 15:54:33,297 - Detection -   F1-open = 72.0081
2023-04-20 15:54:33,297 - Detection - Testing finished...
2023-04-20 15:54:33,297 - Detection - Results saved in results/results_ADB.csv
2023-04-20 15:54:33,317 - Detection - Open Intent Detection Finished...
