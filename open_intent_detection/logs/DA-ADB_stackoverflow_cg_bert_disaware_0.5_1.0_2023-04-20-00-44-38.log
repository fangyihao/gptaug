2023-04-20 00:44:38,147 - Detection - Open Intent Detection Begin...
2023-04-20 00:44:38,147 - Detection - Parameters Initialization...
2023-04-20 00:44:38,147 - Detection - ============================== Params ==============================
2023-04-20 00:44:38,147 - Detection - type:	open_intent_detection
2023-04-20 00:44:38,147 - Detection - logger_name:	Detection
2023-04-20 00:44:38,147 - Detection - log_dir:	logs
2023-04-20 00:44:38,147 - Detection - dataset:	stackoverflow_cg
2023-04-20 00:44:38,147 - Detection - known_cls_ratio:	0.5
2023-04-20 00:44:38,147 - Detection - labeled_ratio:	1.0
2023-04-20 00:44:38,147 - Detection - method:	DA-ADB
2023-04-20 00:44:38,147 - Detection - train:	True
2023-04-20 00:44:38,147 - Detection - pretrain:	True
2023-04-20 00:44:38,147 - Detection - save_model:	True
2023-04-20 00:44:38,147 - Detection - backbone:	bert_disaware
2023-04-20 00:44:38,147 - Detection - config_file_name:	DA-ADB
2023-04-20 00:44:38,147 - Detection - seed:	4
2023-04-20 00:44:38,148 - Detection - gpu_id:	0
2023-04-20 00:44:38,148 - Detection - pipe_results_path:	pipe_results
2023-04-20 00:44:38,148 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-20 00:44:38,148 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-20 00:44:38,148 - Detection - model_dir:	models
2023-04-20 00:44:38,148 - Detection - load_pretrained_method:	None
2023-04-20 00:44:38,148 - Detection - result_dir:	results
2023-04-20 00:44:38,148 - Detection - results_file_name:	results_DA-ADB.csv
2023-04-20 00:44:38,148 - Detection - save_results:	True
2023-04-20 00:44:38,148 - Detection - loss_fct:	CrossEntropyLoss
2023-04-20 00:44:38,148 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.5_1.0_bert_disaware_4
2023-04-20 00:44:38,148 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.5_1.0_bert_disaware_4/models
2023-04-20 00:44:38,148 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-20 00:44:38,148 - Detection - num_train_epochs:	100
2023-04-20 00:44:38,148 - Detection - num_labels:	None
2023-04-20 00:44:38,148 - Detection - max_seq_length:	None
2023-04-20 00:44:38,148 - Detection - freeze_backbone_parameters:	True
2023-04-20 00:44:38,148 - Detection - feat_dim:	768
2023-04-20 00:44:38,148 - Detection - warmup_proportion:	0.1
2023-04-20 00:44:38,148 - Detection - scale:	4
2023-04-20 00:44:38,148 - Detection - lr_boundary:	0.05
2023-04-20 00:44:38,148 - Detection - lr:	2e-05
2023-04-20 00:44:38,148 - Detection - activation:	relu
2023-04-20 00:44:38,148 - Detection - train_batch_size:	128
2023-04-20 00:44:38,148 - Detection - eval_batch_size:	64
2023-04-20 00:44:38,148 - Detection - test_batch_size:	64
2023-04-20 00:44:38,148 - Detection - wait_patient:	10
2023-04-20 00:44:38,148 - Detection - ============================== End Params ==============================
2023-04-20 00:44:38,148 - Detection - Data and Model Preparation...
2023-04-20 00:44:38,149 - Detection - The number of known intents is 10
2023-04-20 00:44:38,149 - Detection - Lists of known labels are: ['wordpress', 'cocoa', 'visual-studio', 'haskell', 'qt', 'drupal', 'ajax', 'svn', 'osx', 'oracle']
2023-04-20 00:44:38,172 - Detection - Number of labeled training samples = 3896
2023-04-20 00:44:38,172 - Detection - Number of unlabeled training samples = 3921
2023-04-20 00:44:38,176 - Detection - Number of evaluation samples = 952
2023-04-20 00:44:38,187 - Detection - Number of testing samples = 5082
2023-04-20 00:44:45,204 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-20 00:44:45,286 - Detection - Pre-training Begin...
2023-04-20 00:44:53,291 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 00:44:53,291 - Detection -   best_eval_score = 0
2023-04-20 00:44:53,292 - Detection -   eval_score = 8.07
2023-04-20 00:44:53,292 - Detection -   train_loss = 2.3021934186258624
2023-04-20 00:45:00,790 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 00:45:00,790 - Detection -   best_eval_score = 8.07
2023-04-20 00:45:00,790 - Detection -   eval_score = 8.52
2023-04-20 00:45:00,790 - Detection -   train_loss = 2.2914233207702637
2023-04-20 00:45:08,315 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 00:45:08,315 - Detection -   best_eval_score = 8.52
2023-04-20 00:45:08,315 - Detection -   eval_score = 23.09
2023-04-20 00:45:08,315 - Detection -   train_loss = 2.2714636018199306
2023-04-20 00:45:15,865 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 00:45:15,865 - Detection -   best_eval_score = 23.09
2023-04-20 00:45:15,866 - Detection -   eval_score = 33.31
2023-04-20 00:45:15,866 - Detection -   train_loss = 2.2194779534493723
2023-04-20 00:45:23,439 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 00:45:23,439 - Detection -   best_eval_score = 33.31
2023-04-20 00:45:23,439 - Detection -   eval_score = 56.37
2023-04-20 00:45:23,439 - Detection -   train_loss = 2.065950451358672
2023-04-20 00:45:31,030 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 00:45:31,030 - Detection -   best_eval_score = 56.37
2023-04-20 00:45:31,030 - Detection -   eval_score = 77.3
2023-04-20 00:45:31,030 - Detection -   train_loss = 1.739200884296048
2023-04-20 00:45:38,646 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 00:45:38,646 - Detection -   best_eval_score = 77.3
2023-04-20 00:45:38,646 - Detection -   eval_score = 83.53
2023-04-20 00:45:38,646 - Detection -   train_loss = 1.3147393272769066
2023-04-20 00:45:46,278 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 00:45:46,278 - Detection -   best_eval_score = 83.53
2023-04-20 00:45:46,278 - Detection -   eval_score = 85.0
2023-04-20 00:45:46,278 - Detection -   train_loss = 1.070189118385315
2023-04-20 00:45:53,908 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 00:45:53,908 - Detection -   best_eval_score = 85.0
2023-04-20 00:45:53,908 - Detection -   eval_score = 86.27
2023-04-20 00:45:53,908 - Detection -   train_loss = 0.9422216588451017
2023-04-20 00:46:01,535 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 00:46:01,535 - Detection -   best_eval_score = 86.27
2023-04-20 00:46:01,535 - Detection -   eval_score = 86.02
2023-04-20 00:46:01,535 - Detection -   train_loss = 0.8653061428377705
2023-04-20 00:46:09,145 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 00:46:09,145 - Detection -   best_eval_score = 86.27
2023-04-20 00:46:09,145 - Detection -   eval_score = 87.13
2023-04-20 00:46:09,145 - Detection -   train_loss = 0.8133049511140392
2023-04-20 00:46:16,761 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 00:46:16,761 - Detection -   best_eval_score = 87.13
2023-04-20 00:46:16,761 - Detection -   eval_score = 87.26
2023-04-20 00:46:16,762 - Detection -   train_loss = 0.7658690329520933
2023-04-20 00:46:24,469 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 00:46:24,469 - Detection -   best_eval_score = 87.26
2023-04-20 00:46:24,469 - Detection -   eval_score = 87.02
2023-04-20 00:46:24,469 - Detection -   train_loss = 0.736102198400805
2023-04-20 00:46:32,058 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 00:46:32,058 - Detection -   best_eval_score = 87.26
2023-04-20 00:46:32,058 - Detection -   eval_score = 87.52
2023-04-20 00:46:32,058 - Detection -   train_loss = 0.7113767458546546
2023-04-20 00:46:39,668 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 00:46:39,668 - Detection -   best_eval_score = 87.52
2023-04-20 00:46:39,668 - Detection -   eval_score = 88.03
2023-04-20 00:46:39,668 - Detection -   train_loss = 0.6863305799422725
2023-04-20 00:46:47,274 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 00:46:47,274 - Detection -   best_eval_score = 88.03
2023-04-20 00:46:47,274 - Detection -   eval_score = 87.5
2023-04-20 00:46:47,274 - Detection -   train_loss = 0.6634889514215531
2023-04-20 00:46:54,864 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 00:46:54,864 - Detection -   best_eval_score = 88.03
2023-04-20 00:46:54,864 - Detection -   eval_score = 87.23
2023-04-20 00:46:54,864 - Detection -   train_loss = 0.645476596970712
2023-04-20 00:47:02,450 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 00:47:02,451 - Detection -   best_eval_score = 88.03
2023-04-20 00:47:02,451 - Detection -   eval_score = 86.93
2023-04-20 00:47:02,451 - Detection -   train_loss = 0.6287736296653748
2023-04-20 00:47:10,041 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 00:47:10,041 - Detection -   best_eval_score = 88.03
2023-04-20 00:47:10,041 - Detection -   eval_score = 86.98
2023-04-20 00:47:10,041 - Detection -   train_loss = 0.602815184862383
2023-04-20 00:47:17,625 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 00:47:17,625 - Detection -   best_eval_score = 88.03
2023-04-20 00:47:17,625 - Detection -   eval_score = 87.72
2023-04-20 00:47:17,625 - Detection -   train_loss = 0.593383914039981
2023-04-20 00:47:25,214 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 00:47:25,214 - Detection -   best_eval_score = 88.03
2023-04-20 00:47:25,214 - Detection -   eval_score = 87.46
2023-04-20 00:47:25,214 - Detection -   train_loss = 0.5786639336616762
2023-04-20 00:47:32,805 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 00:47:32,805 - Detection -   best_eval_score = 88.03
2023-04-20 00:47:32,805 - Detection -   eval_score = 87.22
2023-04-20 00:47:32,805 - Detection -   train_loss = 0.5645624995231628
2023-04-20 00:47:40,393 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 00:47:40,393 - Detection -   best_eval_score = 88.03
2023-04-20 00:47:40,393 - Detection -   eval_score = 87.68
2023-04-20 00:47:40,393 - Detection -   train_loss = 0.5516968907848481
2023-04-20 00:47:47,976 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 00:47:47,977 - Detection -   best_eval_score = 88.03
2023-04-20 00:47:47,977 - Detection -   eval_score = 87.57
2023-04-20 00:47:47,977 - Detection -   train_loss = 0.5381613527574847
2023-04-20 00:47:55,560 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 00:47:55,560 - Detection -   best_eval_score = 88.03
2023-04-20 00:47:55,560 - Detection -   eval_score = 87.49
2023-04-20 00:47:55,560 - Detection -   train_loss = 0.5373825248210661
2023-04-20 00:47:55,560 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.5_1.0_bert_disaware_4/models
2023-04-20 00:47:56,107 - Detection - Pre-training finished...
2023-04-20 00:47:56,107 - Detection - Training Begin...
2023-04-20 00:48:00,481 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 00:48:00,481 - Detection -   best_eval_score = 0
2023-04-20 00:48:00,481 - Detection -   eval_score = 0.19
2023-04-20 00:48:00,481 - Detection -   train_loss = 4.057527849751134
2023-04-20 00:48:04,854 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 00:48:04,854 - Detection -   best_eval_score = 0.19
2023-04-20 00:48:04,854 - Detection -   eval_score = 39.67
2023-04-20 00:48:04,854 - Detection -   train_loss = 2.822561494765743
2023-04-20 00:48:09,226 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 00:48:09,226 - Detection -   best_eval_score = 39.67
2023-04-20 00:48:09,226 - Detection -   eval_score = 77.19
2023-04-20 00:48:09,226 - Detection -   train_loss = 1.3921513845843654
2023-04-20 00:48:13,603 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 00:48:13,603 - Detection -   best_eval_score = 77.19
2023-04-20 00:48:13,603 - Detection -   eval_score = 78.14
2023-04-20 00:48:13,603 - Detection -   train_loss = 1.0462289375643576
2023-04-20 00:48:17,976 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 00:48:17,976 - Detection -   best_eval_score = 78.14
2023-04-20 00:48:17,976 - Detection -   eval_score = 77.93
2023-04-20 00:48:17,976 - Detection -   train_loss = 1.0232552847554606
2023-04-20 00:48:22,349 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 00:48:22,349 - Detection -   best_eval_score = 78.14
2023-04-20 00:48:22,349 - Detection -   eval_score = 78.09
2023-04-20 00:48:22,349 - Detection -   train_loss = 1.0293410285826652
2023-04-20 00:48:26,725 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 00:48:26,726 - Detection -   best_eval_score = 78.14
2023-04-20 00:48:26,726 - Detection -   eval_score = 78.24
2023-04-20 00:48:26,726 - Detection -   train_loss = 1.0243826720022386
2023-04-20 00:48:31,102 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 00:48:31,102 - Detection -   best_eval_score = 78.24
2023-04-20 00:48:31,102 - Detection -   eval_score = 77.86
2023-04-20 00:48:31,102 - Detection -   train_loss = 1.0426839359344975
2023-04-20 00:48:35,483 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 00:48:35,483 - Detection -   best_eval_score = 78.24
2023-04-20 00:48:35,483 - Detection -   eval_score = 77.75
2023-04-20 00:48:35,483 - Detection -   train_loss = 1.01659389849632
2023-04-20 00:48:39,858 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 00:48:39,859 - Detection -   best_eval_score = 78.24
2023-04-20 00:48:39,859 - Detection -   eval_score = 77.91
2023-04-20 00:48:39,859 - Detection -   train_loss = 1.0325490332418872
2023-04-20 00:48:44,233 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 00:48:44,233 - Detection -   best_eval_score = 78.24
2023-04-20 00:48:44,233 - Detection -   eval_score = 78.18
2023-04-20 00:48:44,233 - Detection -   train_loss = 1.0245772465582816
2023-04-20 00:48:48,609 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 00:48:48,609 - Detection -   best_eval_score = 78.24
2023-04-20 00:48:48,609 - Detection -   eval_score = 77.35
2023-04-20 00:48:48,609 - Detection -   train_loss = 1.0280807172098467
2023-04-20 00:48:52,986 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 00:48:52,986 - Detection -   best_eval_score = 78.24
2023-04-20 00:48:52,986 - Detection -   eval_score = 77.9
2023-04-20 00:48:52,986 - Detection -   train_loss = 1.0246590645082536
2023-04-20 00:48:57,359 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 00:48:57,359 - Detection -   best_eval_score = 78.24
2023-04-20 00:48:57,359 - Detection -   eval_score = 77.84
2023-04-20 00:48:57,359 - Detection -   train_loss = 1.0421843240337987
2023-04-20 00:49:01,733 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 00:49:01,733 - Detection -   best_eval_score = 78.24
2023-04-20 00:49:01,733 - Detection -   eval_score = 77.33
2023-04-20 00:49:01,734 - Detection -   train_loss = 1.0373238382800933
2023-04-20 00:49:06,109 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 00:49:06,109 - Detection -   best_eval_score = 78.24
2023-04-20 00:49:06,109 - Detection -   eval_score = 77.97
2023-04-20 00:49:06,109 - Detection -   train_loss = 1.0311631233461442
2023-04-20 00:49:10,483 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 00:49:10,483 - Detection -   best_eval_score = 78.24
2023-04-20 00:49:10,483 - Detection -   eval_score = 77.66
2023-04-20 00:49:10,483 - Detection -   train_loss = 1.0301975992418104
2023-04-20 00:49:10,484 - Detection - Training Finished...
2023-04-20 00:49:10,484 - Detection - Testing begin...
2023-04-20 00:49:14,703 - Detection - ***** Test: Confusion Matrix *****
2023-04-20 00:49:14,703 - Detection - [[ 200    0    0    0    0    0    1    0    0    0   41]
 [   0  141    0    2    3    0    0    0   16    1   73]
 [   0    3  150    1    0    0    0    0    1    1   69]
 [   0    0    0  216    0    0    0    0    2    0   51]
 [   0    0    0    0  243    0    0    0    2    0   18]
 [   0    0    0    0    0  194    2    0    1    0   40]
 [   2    0    0    0    0    0  199    0    0    1   59]
 [   0    1    1    0    0    0    0  215    1    0   55]
 [   0   23    0    0    3    0    0    1  181    1   74]
 [   0    1    1    0    0    0    0    0    0  218   43]
 [   2   67   13   41    1    1   73    3   40   46 2243]]
2023-04-20 00:49:14,703 - Detection - ***** Test results *****
2023-04-20 00:49:14,703 - Detection -   Acc = 82.64
2023-04-20 00:49:14,703 - Detection -   F1 = 80.8843
2023-04-20 00:49:14,703 - Detection -   F1-known = 80.5022
2023-04-20 00:49:14,703 - Detection -   F1-open = 84.7054
2023-04-20 00:49:14,703 - Detection - Testing finished...
2023-04-20 00:49:14,703 - Detection - Results saved in results/results_DA-ADB.csv
2023-04-20 00:49:14,723 - Detection - Open Intent Detection Finished...
