2023-04-20 14:05:05,676 - Detection - Open Intent Detection Begin...
2023-04-20 14:05:05,676 - Detection - Parameters Initialization...
2023-04-20 14:05:05,677 - Detection - ============================== Params ==============================
2023-04-20 14:05:05,677 - Detection - type:	open_intent_detection
2023-04-20 14:05:05,677 - Detection - logger_name:	Detection
2023-04-20 14:05:05,677 - Detection - log_dir:	logs
2023-04-20 14:05:05,677 - Detection - dataset:	banking_cg
2023-04-20 14:05:05,677 - Detection - known_cls_ratio:	0.5
2023-04-20 14:05:05,677 - Detection - labeled_ratio:	1.0
2023-04-20 14:05:05,677 - Detection - method:	ADB
2023-04-20 14:05:05,677 - Detection - train:	True
2023-04-20 14:05:05,677 - Detection - pretrain:	True
2023-04-20 14:05:05,677 - Detection - save_model:	True
2023-04-20 14:05:05,677 - Detection - backbone:	bert
2023-04-20 14:05:05,677 - Detection - config_file_name:	ADB
2023-04-20 14:05:05,677 - Detection - seed:	1
2023-04-20 14:05:05,677 - Detection - gpu_id:	0
2023-04-20 14:05:05,677 - Detection - pipe_results_path:	pipe_results
2023-04-20 14:05:05,677 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-20 14:05:05,677 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-20 14:05:05,677 - Detection - model_dir:	models
2023-04-20 14:05:05,677 - Detection - load_pretrained_method:	None
2023-04-20 14:05:05,677 - Detection - result_dir:	results
2023-04-20 14:05:05,677 - Detection - results_file_name:	results_ADB.csv
2023-04-20 14:05:05,677 - Detection - save_results:	True
2023-04-20 14:05:05,677 - Detection - loss_fct:	CrossEntropyLoss
2023-04-20 14:05:05,677 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.5_1.0_bert_1
2023-04-20 14:05:05,677 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.5_1.0_bert_1/models
2023-04-20 14:05:05,677 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-20 14:05:05,677 - Detection - num_train_epochs:	100
2023-04-20 14:05:05,677 - Detection - num_labels:	None
2023-04-20 14:05:05,677 - Detection - max_seq_length:	None
2023-04-20 14:05:05,677 - Detection - freeze_backbone_parameters:	True
2023-04-20 14:05:05,677 - Detection - feat_dim:	768
2023-04-20 14:05:05,677 - Detection - warmup_proportion:	0.1
2023-04-20 14:05:05,677 - Detection - lr_boundary:	0.05
2023-04-20 14:05:05,677 - Detection - lr:	2e-05
2023-04-20 14:05:05,677 - Detection - activation:	relu
2023-04-20 14:05:05,677 - Detection - train_batch_size:	128
2023-04-20 14:05:05,677 - Detection - eval_batch_size:	64
2023-04-20 14:05:05,677 - Detection - test_batch_size:	64
2023-04-20 14:05:05,677 - Detection - wait_patient:	10
2023-04-20 14:05:05,677 - Detection - ============================== End Params ==============================
2023-04-20 14:05:05,677 - Detection - Data and Model Preparation...
2023-04-20 14:05:05,678 - Detection - The number of known intents is 38
2023-04-20 14:05:05,678 - Detection - Lists of known labels are: ['edit_personal_details', 'lost_or_stolen_phone', 'declined_card_payment', 'why_verify_identity', 'top_up_by_cash_or_cheque', 'top_up_failed', 'top_up_reverted', 'receiving_money', 'failed_transfer', 'top_up_by_card_charge', 'card_about_to_expire', 'reverted_card_payment?', 'exchange_via_app', 'age_limit', 'verify_top_up', 'declined_cash_withdrawal', 'pending_card_payment', 'card_not_working', 'passcode_forgotten', 'card_swallowed', 'wrong_exchange_rate_for_cash_withdrawal', 'verify_source_of_funds', 'transaction_charged_twice', 'wrong_amount_of_cash_received', 'topping_up_by_card', 'extra_charge_on_statement', 'get_disposable_virtual_card', 'terminate_account', 'exchange_rate', 'transfer_timing', 'getting_spare_card', 'cash_withdrawal_not_recognised', 'unable_to_verify_identity', 'apple_pay_or_google_pay', 'order_physical_card', 'top_up_by_bank_transfer_charge', 'get_physical_card', 'pending_cash_withdrawal']
2023-04-20 14:05:05,687 - Detection - Number of labeled training samples = 1201
2023-04-20 14:05:05,687 - Detection - Number of unlabeled training samples = 1572
2023-04-20 14:05:05,689 - Detection - Number of evaluation samples = 397
2023-04-20 14:05:05,694 - Detection - Number of testing samples = 1896
2023-04-20 14:05:09,594 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-20 14:05:11,256 - Detection - Pre-training Begin...
2023-04-20 14:05:13,588 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 14:05:13,588 - Detection -   best_eval_score = 0
2023-04-20 14:05:13,588 - Detection -   eval_score = 2.02
2023-04-20 14:05:13,589 - Detection -   train_loss = 3.6437975406646728
2023-04-20 14:05:15,414 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 14:05:15,414 - Detection -   best_eval_score = 2.02
2023-04-20 14:05:15,414 - Detection -   eval_score = 2.77
2023-04-20 14:05:15,414 - Detection -   train_loss = 3.6296096086502074
2023-04-20 14:05:17,242 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 14:05:17,243 - Detection -   best_eval_score = 2.77
2023-04-20 14:05:17,243 - Detection -   eval_score = 6.8
2023-04-20 14:05:17,243 - Detection -   train_loss = 3.601590633392334
2023-04-20 14:05:19,074 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 14:05:19,074 - Detection -   best_eval_score = 6.8
2023-04-20 14:05:19,074 - Detection -   eval_score = 5.79
2023-04-20 14:05:19,074 - Detection -   train_loss = 3.5594207048416138
2023-04-20 14:05:20,897 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 14:05:20,897 - Detection -   best_eval_score = 6.8
2023-04-20 14:05:20,897 - Detection -   eval_score = 5.54
2023-04-20 14:05:20,897 - Detection -   train_loss = 3.495874810218811
2023-04-20 14:05:22,723 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 14:05:22,723 - Detection -   best_eval_score = 6.8
2023-04-20 14:05:22,723 - Detection -   eval_score = 6.3
2023-04-20 14:05:22,723 - Detection -   train_loss = 3.4016782522201536
2023-04-20 14:05:24,552 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 14:05:24,552 - Detection -   best_eval_score = 6.8
2023-04-20 14:05:24,552 - Detection -   eval_score = 17.63
2023-04-20 14:05:24,552 - Detection -   train_loss = 3.2559887170791626
2023-04-20 14:05:26,394 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 14:05:26,394 - Detection -   best_eval_score = 17.63
2023-04-20 14:05:26,394 - Detection -   eval_score = 28.72
2023-04-20 14:05:26,394 - Detection -   train_loss = 3.023286056518555
2023-04-20 14:05:28,248 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 14:05:28,249 - Detection -   best_eval_score = 28.72
2023-04-20 14:05:28,249 - Detection -   eval_score = 35.77
2023-04-20 14:05:28,249 - Detection -   train_loss = 2.7215062379837036
2023-04-20 14:05:30,118 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 14:05:30,118 - Detection -   best_eval_score = 35.77
2023-04-20 14:05:30,118 - Detection -   eval_score = 39.8
2023-04-20 14:05:30,119 - Detection -   train_loss = 2.3770352363586427
2023-04-20 14:05:32,006 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 14:05:32,006 - Detection -   best_eval_score = 39.8
2023-04-20 14:05:32,006 - Detection -   eval_score = 45.09
2023-04-20 14:05:32,006 - Detection -   train_loss = 2.0234278440475464
2023-04-20 14:05:33,901 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 14:05:33,901 - Detection -   best_eval_score = 45.09
2023-04-20 14:05:33,901 - Detection -   eval_score = 51.39
2023-04-20 14:05:33,901 - Detection -   train_loss = 1.7249624133110046
2023-04-20 14:05:35,813 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 14:05:35,813 - Detection -   best_eval_score = 51.39
2023-04-20 14:05:35,813 - Detection -   eval_score = 58.19
2023-04-20 14:05:35,813 - Detection -   train_loss = 1.4631510138511659
2023-04-20 14:05:37,744 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 14:05:37,744 - Detection -   best_eval_score = 58.19
2023-04-20 14:05:37,744 - Detection -   eval_score = 65.74
2023-04-20 14:05:37,744 - Detection -   train_loss = 1.2690135836601257
2023-04-20 14:05:39,676 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 14:05:39,676 - Detection -   best_eval_score = 65.74
2023-04-20 14:05:39,676 - Detection -   eval_score = 67.25
2023-04-20 14:05:39,676 - Detection -   train_loss = 1.105798500776291
2023-04-20 14:05:41,612 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 14:05:41,612 - Detection -   best_eval_score = 67.25
2023-04-20 14:05:41,612 - Detection -   eval_score = 70.53
2023-04-20 14:05:41,612 - Detection -   train_loss = 0.9387868404388428
2023-04-20 14:05:43,646 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 14:05:43,646 - Detection -   best_eval_score = 70.53
2023-04-20 14:05:43,646 - Detection -   eval_score = 72.04
2023-04-20 14:05:43,646 - Detection -   train_loss = 0.8225301504135132
2023-04-20 14:05:45,595 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 14:05:45,595 - Detection -   best_eval_score = 72.04
2023-04-20 14:05:45,595 - Detection -   eval_score = 73.55
2023-04-20 14:05:45,595 - Detection -   train_loss = 0.7377370834350586
2023-04-20 14:05:47,542 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 14:05:47,543 - Detection -   best_eval_score = 73.55
2023-04-20 14:05:47,543 - Detection -   eval_score = 74.56
2023-04-20 14:05:47,543 - Detection -   train_loss = 0.6674528777599334
2023-04-20 14:05:49,497 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 14:05:49,498 - Detection -   best_eval_score = 74.56
2023-04-20 14:05:49,498 - Detection -   eval_score = 76.07
2023-04-20 14:05:49,498 - Detection -   train_loss = 0.6079452872276306
2023-04-20 14:05:51,455 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 14:05:51,455 - Detection -   best_eval_score = 76.07
2023-04-20 14:05:51,455 - Detection -   eval_score = 76.57
2023-04-20 14:05:51,455 - Detection -   train_loss = 0.5474713623523713
2023-04-20 14:05:53,416 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 14:05:53,416 - Detection -   best_eval_score = 76.57
2023-04-20 14:05:53,416 - Detection -   eval_score = 76.57
2023-04-20 14:05:53,416 - Detection -   train_loss = 0.5021046608686447
2023-04-20 14:05:55,370 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 14:05:55,370 - Detection -   best_eval_score = 76.57
2023-04-20 14:05:55,370 - Detection -   eval_score = 77.08
2023-04-20 14:05:55,370 - Detection -   train_loss = 0.46258815824985505
2023-04-20 14:05:57,334 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 14:05:57,334 - Detection -   best_eval_score = 77.08
2023-04-20 14:05:57,334 - Detection -   eval_score = 76.83
2023-04-20 14:05:57,334 - Detection -   train_loss = 0.4172411859035492
2023-04-20 14:05:59,288 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 14:05:59,288 - Detection -   best_eval_score = 77.08
2023-04-20 14:05:59,288 - Detection -   eval_score = 77.33
2023-04-20 14:05:59,288 - Detection -   train_loss = 0.3887774646282196
2023-04-20 14:06:01,252 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 14:06:01,252 - Detection -   best_eval_score = 77.33
2023-04-20 14:06:01,252 - Detection -   eval_score = 76.83
2023-04-20 14:06:01,252 - Detection -   train_loss = 0.36901578307151794
2023-04-20 14:06:03,205 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 14:06:03,205 - Detection -   best_eval_score = 77.33
2023-04-20 14:06:03,205 - Detection -   eval_score = 78.59
2023-04-20 14:06:03,205 - Detection -   train_loss = 0.34428061842918395
2023-04-20 14:06:05,170 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 14:06:05,170 - Detection -   best_eval_score = 78.59
2023-04-20 14:06:05,170 - Detection -   eval_score = 78.59
2023-04-20 14:06:05,170 - Detection -   train_loss = 0.3163801908493042
2023-04-20 14:06:07,128 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 14:06:07,128 - Detection -   best_eval_score = 78.59
2023-04-20 14:06:07,128 - Detection -   eval_score = 78.84
2023-04-20 14:06:07,128 - Detection -   train_loss = 0.29891767501831057
2023-04-20 14:06:09,088 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 14:06:09,088 - Detection -   best_eval_score = 78.84
2023-04-20 14:06:09,088 - Detection -   eval_score = 80.1
2023-04-20 14:06:09,088 - Detection -   train_loss = 0.29121900498867037
2023-04-20 14:06:11,053 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 14:06:11,054 - Detection -   best_eval_score = 80.1
2023-04-20 14:06:11,054 - Detection -   eval_score = 78.34
2023-04-20 14:06:11,054 - Detection -   train_loss = 0.2716096192598343
2023-04-20 14:06:13,008 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 14:06:13,008 - Detection -   best_eval_score = 80.1
2023-04-20 14:06:13,008 - Detection -   eval_score = 80.1
2023-04-20 14:06:13,008 - Detection -   train_loss = 0.26482990831136705
2023-04-20 14:06:14,962 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 14:06:14,962 - Detection -   best_eval_score = 80.1
2023-04-20 14:06:14,962 - Detection -   eval_score = 79.35
2023-04-20 14:06:14,962 - Detection -   train_loss = 0.24568612426519393
2023-04-20 14:06:16,911 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 14:06:16,911 - Detection -   best_eval_score = 80.1
2023-04-20 14:06:16,911 - Detection -   eval_score = 79.85
2023-04-20 14:06:16,911 - Detection -   train_loss = 0.2421707645058632
2023-04-20 14:06:18,865 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 14:06:18,865 - Detection -   best_eval_score = 80.1
2023-04-20 14:06:18,865 - Detection -   eval_score = 80.1
2023-04-20 14:06:18,865 - Detection -   train_loss = 0.22055332362651825
2023-04-20 14:06:20,817 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 14:06:20,817 - Detection -   best_eval_score = 80.1
2023-04-20 14:06:20,817 - Detection -   eval_score = 80.6
2023-04-20 14:06:20,817 - Detection -   train_loss = 0.20607281923294068
2023-04-20 14:06:22,787 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 14:06:22,787 - Detection -   best_eval_score = 80.6
2023-04-20 14:06:22,787 - Detection -   eval_score = 80.1
2023-04-20 14:06:22,787 - Detection -   train_loss = 0.20288733690977095
2023-04-20 14:06:24,744 - Detection - ***** Epoch: 38: Eval results *****
2023-04-20 14:06:24,744 - Detection -   best_eval_score = 80.6
2023-04-20 14:06:24,744 - Detection -   eval_score = 80.1
2023-04-20 14:06:24,744 - Detection -   train_loss = 0.1876268595457077
2023-04-20 14:06:26,695 - Detection - ***** Epoch: 39: Eval results *****
2023-04-20 14:06:26,695 - Detection -   best_eval_score = 80.6
2023-04-20 14:06:26,695 - Detection -   eval_score = 81.11
2023-04-20 14:06:26,695 - Detection -   train_loss = 0.17983371764421463
2023-04-20 14:06:28,661 - Detection - ***** Epoch: 40: Eval results *****
2023-04-20 14:06:28,661 - Detection -   best_eval_score = 81.11
2023-04-20 14:06:28,661 - Detection -   eval_score = 80.6
2023-04-20 14:06:28,661 - Detection -   train_loss = 0.17174134254455567
2023-04-20 14:06:30,613 - Detection - ***** Epoch: 41: Eval results *****
2023-04-20 14:06:30,613 - Detection -   best_eval_score = 81.11
2023-04-20 14:06:30,613 - Detection -   eval_score = 80.6
2023-04-20 14:06:30,613 - Detection -   train_loss = 0.16405653059482575
2023-04-20 14:06:32,563 - Detection - ***** Epoch: 42: Eval results *****
2023-04-20 14:06:32,563 - Detection -   best_eval_score = 81.11
2023-04-20 14:06:32,563 - Detection -   eval_score = 81.36
2023-04-20 14:06:32,563 - Detection -   train_loss = 0.16916027218103408
2023-04-20 14:06:34,531 - Detection - ***** Epoch: 43: Eval results *****
2023-04-20 14:06:34,531 - Detection -   best_eval_score = 81.36
2023-04-20 14:06:34,531 - Detection -   eval_score = 80.86
2023-04-20 14:06:34,531 - Detection -   train_loss = 0.1556151896715164
2023-04-20 14:06:36,480 - Detection - ***** Epoch: 44: Eval results *****
2023-04-20 14:06:36,480 - Detection -   best_eval_score = 81.36
2023-04-20 14:06:36,480 - Detection -   eval_score = 80.86
2023-04-20 14:06:36,480 - Detection -   train_loss = 0.15348039269447328
2023-04-20 14:06:38,435 - Detection - ***** Epoch: 45: Eval results *****
2023-04-20 14:06:38,435 - Detection -   best_eval_score = 81.36
2023-04-20 14:06:38,435 - Detection -   eval_score = 80.86
2023-04-20 14:06:38,435 - Detection -   train_loss = 0.14575316458940507
2023-04-20 14:06:40,391 - Detection - ***** Epoch: 46: Eval results *****
2023-04-20 14:06:40,391 - Detection -   best_eval_score = 81.36
2023-04-20 14:06:40,391 - Detection -   eval_score = 81.36
2023-04-20 14:06:40,392 - Detection -   train_loss = 0.1436816468834877
2023-04-20 14:06:42,341 - Detection - ***** Epoch: 47: Eval results *****
2023-04-20 14:06:42,341 - Detection -   best_eval_score = 81.36
2023-04-20 14:06:42,341 - Detection -   eval_score = 81.11
2023-04-20 14:06:42,341 - Detection -   train_loss = 0.13973112255334855
2023-04-20 14:06:44,292 - Detection - ***** Epoch: 48: Eval results *****
2023-04-20 14:06:44,292 - Detection -   best_eval_score = 81.36
2023-04-20 14:06:44,292 - Detection -   eval_score = 81.86
2023-04-20 14:06:44,292 - Detection -   train_loss = 0.13276896998286247
2023-04-20 14:06:46,267 - Detection - ***** Epoch: 49: Eval results *****
2023-04-20 14:06:46,267 - Detection -   best_eval_score = 81.86
2023-04-20 14:06:46,267 - Detection -   eval_score = 81.86
2023-04-20 14:06:46,267 - Detection -   train_loss = 0.13296744152903556
2023-04-20 14:06:48,223 - Detection - ***** Epoch: 50: Eval results *****
2023-04-20 14:06:48,223 - Detection -   best_eval_score = 81.86
2023-04-20 14:06:48,223 - Detection -   eval_score = 81.86
2023-04-20 14:06:48,223 - Detection -   train_loss = 0.12973631396889687
2023-04-20 14:06:50,176 - Detection - ***** Epoch: 51: Eval results *****
2023-04-20 14:06:50,176 - Detection -   best_eval_score = 81.86
2023-04-20 14:06:50,176 - Detection -   eval_score = 82.12
2023-04-20 14:06:50,176 - Detection -   train_loss = 0.12476123720407487
2023-04-20 14:06:52,146 - Detection - ***** Epoch: 52: Eval results *****
2023-04-20 14:06:52,146 - Detection -   best_eval_score = 82.12
2023-04-20 14:06:52,146 - Detection -   eval_score = 81.86
2023-04-20 14:06:52,146 - Detection -   train_loss = 0.12170133665204048
2023-04-20 14:06:54,102 - Detection - ***** Epoch: 53: Eval results *****
2023-04-20 14:06:54,102 - Detection -   best_eval_score = 82.12
2023-04-20 14:06:54,102 - Detection -   eval_score = 81.61
2023-04-20 14:06:54,102 - Detection -   train_loss = 0.11442763954401017
2023-04-20 14:06:56,055 - Detection - ***** Epoch: 54: Eval results *****
2023-04-20 14:06:56,055 - Detection -   best_eval_score = 82.12
2023-04-20 14:06:56,055 - Detection -   eval_score = 81.61
2023-04-20 14:06:56,055 - Detection -   train_loss = 0.1131804533302784
2023-04-20 14:06:58,008 - Detection - ***** Epoch: 55: Eval results *****
2023-04-20 14:06:58,008 - Detection -   best_eval_score = 82.12
2023-04-20 14:06:58,008 - Detection -   eval_score = 82.12
2023-04-20 14:06:58,008 - Detection -   train_loss = 0.1152667872607708
2023-04-20 14:06:59,959 - Detection - ***** Epoch: 56: Eval results *****
2023-04-20 14:06:59,959 - Detection -   best_eval_score = 82.12
2023-04-20 14:06:59,959 - Detection -   eval_score = 82.12
2023-04-20 14:06:59,959 - Detection -   train_loss = 0.11469759419560432
2023-04-20 14:07:01,903 - Detection - ***** Epoch: 57: Eval results *****
2023-04-20 14:07:01,903 - Detection -   best_eval_score = 82.12
2023-04-20 14:07:01,903 - Detection -   eval_score = 81.86
2023-04-20 14:07:01,903 - Detection -   train_loss = 0.1025258645415306
2023-04-20 14:07:03,842 - Detection - ***** Epoch: 58: Eval results *****
2023-04-20 14:07:03,843 - Detection -   best_eval_score = 82.12
2023-04-20 14:07:03,843 - Detection -   eval_score = 81.11
2023-04-20 14:07:03,843 - Detection -   train_loss = 0.10801508873701096
2023-04-20 14:07:05,788 - Detection - ***** Epoch: 59: Eval results *****
2023-04-20 14:07:05,788 - Detection -   best_eval_score = 82.12
2023-04-20 14:07:05,788 - Detection -   eval_score = 81.11
2023-04-20 14:07:05,788 - Detection -   train_loss = 0.09991698935627938
2023-04-20 14:07:07,732 - Detection - ***** Epoch: 60: Eval results *****
2023-04-20 14:07:07,732 - Detection -   best_eval_score = 82.12
2023-04-20 14:07:07,732 - Detection -   eval_score = 81.11
2023-04-20 14:07:07,732 - Detection -   train_loss = 0.09811239093542098
2023-04-20 14:07:09,676 - Detection - ***** Epoch: 61: Eval results *****
2023-04-20 14:07:09,676 - Detection -   best_eval_score = 82.12
2023-04-20 14:07:09,676 - Detection -   eval_score = 81.86
2023-04-20 14:07:09,676 - Detection -   train_loss = 0.10117536336183548
2023-04-20 14:07:09,676 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.5_1.0_bert_1/models
2023-04-20 14:07:10,218 - Detection - Pre-training finished...
2023-04-20 14:07:10,218 - Detection - Training Begin...
2023-04-20 14:07:13,418 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 14:07:13,418 - Detection -   best_eval_score = 0
2023-04-20 14:07:13,418 - Detection -   eval_score = 0.0
2023-04-20 14:07:13,419 - Detection -   train_loss = 11.337388134002685
2023-04-20 14:07:15,335 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 14:07:15,335 - Detection -   best_eval_score = 0
2023-04-20 14:07:15,335 - Detection -   eval_score = 0.0
2023-04-20 14:07:15,335 - Detection -   train_loss = 11.049053478240968
2023-04-20 14:07:17,260 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 14:07:17,260 - Detection -   best_eval_score = 0
2023-04-20 14:07:17,260 - Detection -   eval_score = 0.0
2023-04-20 14:07:17,260 - Detection -   train_loss = 10.715829658508301
2023-04-20 14:07:19,186 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 14:07:19,186 - Detection -   best_eval_score = 0
2023-04-20 14:07:19,186 - Detection -   eval_score = 0.0
2023-04-20 14:07:19,186 - Detection -   train_loss = 10.339863491058349
2023-04-20 14:07:21,106 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 14:07:21,106 - Detection -   best_eval_score = 0
2023-04-20 14:07:21,106 - Detection -   eval_score = 0.0
2023-04-20 14:07:21,106 - Detection -   train_loss = 9.932588672637939
2023-04-20 14:07:23,033 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 14:07:23,033 - Detection -   best_eval_score = 0
2023-04-20 14:07:23,033 - Detection -   eval_score = 0.0
2023-04-20 14:07:23,033 - Detection -   train_loss = 9.46134157180786
2023-04-20 14:07:24,956 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 14:07:24,956 - Detection -   best_eval_score = 0
2023-04-20 14:07:24,956 - Detection -   eval_score = 0.0
2023-04-20 14:07:24,956 - Detection -   train_loss = 9.048204708099366
2023-04-20 14:07:26,880 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 14:07:26,880 - Detection -   best_eval_score = 0
2023-04-20 14:07:26,880 - Detection -   eval_score = 0.0
2023-04-20 14:07:26,880 - Detection -   train_loss = 8.559250926971435
2023-04-20 14:07:28,806 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 14:07:28,806 - Detection -   best_eval_score = 0
2023-04-20 14:07:28,806 - Detection -   eval_score = 0.28
2023-04-20 14:07:28,806 - Detection -   train_loss = 8.018721675872802
2023-04-20 14:07:30,729 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 14:07:30,729 - Detection -   best_eval_score = 0.28
2023-04-20 14:07:30,729 - Detection -   eval_score = 2.65
2023-04-20 14:07:30,729 - Detection -   train_loss = 7.505667018890381
2023-04-20 14:07:32,657 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 14:07:32,657 - Detection -   best_eval_score = 2.65
2023-04-20 14:07:32,657 - Detection -   eval_score = 6.54
2023-04-20 14:07:32,657 - Detection -   train_loss = 6.988113594055176
2023-04-20 14:07:34,583 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 14:07:34,584 - Detection -   best_eval_score = 6.54
2023-04-20 14:07:34,584 - Detection -   eval_score = 10.41
2023-04-20 14:07:34,584 - Detection -   train_loss = 6.52511248588562
2023-04-20 14:07:36,512 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 14:07:36,512 - Detection -   best_eval_score = 10.41
2023-04-20 14:07:36,512 - Detection -   eval_score = 15.4
2023-04-20 14:07:36,512 - Detection -   train_loss = 6.006581115722656
2023-04-20 14:07:38,437 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 14:07:38,437 - Detection -   best_eval_score = 15.4
2023-04-20 14:07:38,437 - Detection -   eval_score = 19.56
2023-04-20 14:07:38,437 - Detection -   train_loss = 5.539661312103272
2023-04-20 14:07:40,355 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 14:07:40,356 - Detection -   best_eval_score = 19.56
2023-04-20 14:07:40,356 - Detection -   eval_score = 21.93
2023-04-20 14:07:40,356 - Detection -   train_loss = 5.004423904418945
2023-04-20 14:07:42,281 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 14:07:42,281 - Detection -   best_eval_score = 21.93
2023-04-20 14:07:42,281 - Detection -   eval_score = 26.72
2023-04-20 14:07:42,281 - Detection -   train_loss = 4.565030479431153
2023-04-20 14:07:44,209 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 14:07:44,209 - Detection -   best_eval_score = 26.72
2023-04-20 14:07:44,209 - Detection -   eval_score = 32.46
2023-04-20 14:07:44,209 - Detection -   train_loss = 4.0711753368377686
2023-04-20 14:07:46,138 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 14:07:46,138 - Detection -   best_eval_score = 32.46
2023-04-20 14:07:46,138 - Detection -   eval_score = 39.71
2023-04-20 14:07:46,138 - Detection -   train_loss = 3.601123833656311
2023-04-20 14:07:48,065 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 14:07:48,065 - Detection -   best_eval_score = 39.71
2023-04-20 14:07:48,065 - Detection -   eval_score = 45.56
2023-04-20 14:07:48,065 - Detection -   train_loss = 3.139050555229187
2023-04-20 14:07:49,985 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 14:07:49,985 - Detection -   best_eval_score = 45.56
2023-04-20 14:07:49,985 - Detection -   eval_score = 50.43
2023-04-20 14:07:49,985 - Detection -   train_loss = 2.6689544916152954
2023-04-20 14:07:51,916 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 14:07:51,916 - Detection -   best_eval_score = 50.43
2023-04-20 14:07:51,916 - Detection -   eval_score = 56.34
2023-04-20 14:07:51,916 - Detection -   train_loss = 2.3023874044418333
2023-04-20 14:07:53,843 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 14:07:53,843 - Detection -   best_eval_score = 56.34
2023-04-20 14:07:53,843 - Detection -   eval_score = 59.03
2023-04-20 14:07:53,843 - Detection -   train_loss = 1.9438390374183654
2023-04-20 14:07:55,772 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 14:07:55,772 - Detection -   best_eval_score = 59.03
2023-04-20 14:07:55,772 - Detection -   eval_score = 60.24
2023-04-20 14:07:55,772 - Detection -   train_loss = 1.7419532537460327
2023-04-20 14:07:57,696 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 14:07:57,696 - Detection -   best_eval_score = 60.24
2023-04-20 14:07:57,696 - Detection -   eval_score = 62.57
2023-04-20 14:07:57,696 - Detection -   train_loss = 1.523679518699646
2023-04-20 14:07:59,619 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 14:07:59,619 - Detection -   best_eval_score = 62.57
2023-04-20 14:07:59,619 - Detection -   eval_score = 64.76
2023-04-20 14:07:59,619 - Detection -   train_loss = 1.472267246246338
2023-04-20 14:08:01,544 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 14:08:01,544 - Detection -   best_eval_score = 64.76
2023-04-20 14:08:01,544 - Detection -   eval_score = 66.13
2023-04-20 14:08:01,544 - Detection -   train_loss = 1.398759162425995
2023-04-20 14:08:03,470 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 14:08:03,471 - Detection -   best_eval_score = 66.13
2023-04-20 14:08:03,471 - Detection -   eval_score = 67.73
2023-04-20 14:08:03,471 - Detection -   train_loss = 1.3596417427062988
2023-04-20 14:08:05,398 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 14:08:05,398 - Detection -   best_eval_score = 67.73
2023-04-20 14:08:05,398 - Detection -   eval_score = 67.84
2023-04-20 14:08:05,398 - Detection -   train_loss = 1.3086097836494446
2023-04-20 14:08:07,329 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 14:08:07,329 - Detection -   best_eval_score = 67.84
2023-04-20 14:08:07,329 - Detection -   eval_score = 68.21
2023-04-20 14:08:07,329 - Detection -   train_loss = 1.3007784843444825
2023-04-20 14:08:09,258 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 14:08:09,258 - Detection -   best_eval_score = 68.21
2023-04-20 14:08:09,258 - Detection -   eval_score = 68.4
2023-04-20 14:08:09,258 - Detection -   train_loss = 1.2805077672004699
2023-04-20 14:08:11,275 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 14:08:11,275 - Detection -   best_eval_score = 68.4
2023-04-20 14:08:11,275 - Detection -   eval_score = 68.71
2023-04-20 14:08:11,275 - Detection -   train_loss = 1.281531071662903
2023-04-20 14:08:13,199 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 14:08:13,199 - Detection -   best_eval_score = 68.71
2023-04-20 14:08:13,199 - Detection -   eval_score = 68.68
2023-04-20 14:08:13,199 - Detection -   train_loss = 1.3332122325897218
2023-04-20 14:08:15,121 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 14:08:15,121 - Detection -   best_eval_score = 68.71
2023-04-20 14:08:15,121 - Detection -   eval_score = 68.68
2023-04-20 14:08:15,121 - Detection -   train_loss = 1.2965530157089233
2023-04-20 14:08:17,042 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 14:08:17,042 - Detection -   best_eval_score = 68.71
2023-04-20 14:08:17,042 - Detection -   eval_score = 68.57
2023-04-20 14:08:17,042 - Detection -   train_loss = 1.2890579223632812
2023-04-20 14:08:18,965 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 14:08:18,965 - Detection -   best_eval_score = 68.71
2023-04-20 14:08:18,965 - Detection -   eval_score = 69.26
2023-04-20 14:08:18,965 - Detection -   train_loss = 1.2875834465026856
2023-04-20 14:08:20,892 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 14:08:20,892 - Detection -   best_eval_score = 69.26
2023-04-20 14:08:20,892 - Detection -   eval_score = 68.49
2023-04-20 14:08:20,892 - Detection -   train_loss = 1.29253488779068
2023-04-20 14:08:22,818 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 14:08:22,818 - Detection -   best_eval_score = 69.26
2023-04-20 14:08:22,818 - Detection -   eval_score = 68.86
2023-04-20 14:08:22,818 - Detection -   train_loss = 1.265070867538452
2023-04-20 14:08:24,734 - Detection - ***** Epoch: 38: Eval results *****
2023-04-20 14:08:24,734 - Detection -   best_eval_score = 69.26
2023-04-20 14:08:24,734 - Detection -   eval_score = 68.62
2023-04-20 14:08:24,734 - Detection -   train_loss = 1.2592759728431702
2023-04-20 14:08:26,657 - Detection - ***** Epoch: 39: Eval results *****
2023-04-20 14:08:26,657 - Detection -   best_eval_score = 69.26
2023-04-20 14:08:26,658 - Detection -   eval_score = 68.73
2023-04-20 14:08:26,658 - Detection -   train_loss = 1.281674873828888
2023-04-20 14:08:28,585 - Detection - ***** Epoch: 40: Eval results *****
2023-04-20 14:08:28,585 - Detection -   best_eval_score = 69.26
2023-04-20 14:08:28,585 - Detection -   eval_score = 69.81
2023-04-20 14:08:28,585 - Detection -   train_loss = 1.2788453102111816
2023-04-20 14:08:30,506 - Detection - ***** Epoch: 41: Eval results *****
2023-04-20 14:08:30,506 - Detection -   best_eval_score = 69.81
2023-04-20 14:08:30,506 - Detection -   eval_score = 69.9
2023-04-20 14:08:30,506 - Detection -   train_loss = 1.3122649550437928
2023-04-20 14:08:32,429 - Detection - ***** Epoch: 42: Eval results *****
2023-04-20 14:08:32,429 - Detection -   best_eval_score = 69.9
2023-04-20 14:08:32,429 - Detection -   eval_score = 68.71
2023-04-20 14:08:32,429 - Detection -   train_loss = 1.281362807750702
2023-04-20 14:08:34,350 - Detection - ***** Epoch: 43: Eval results *****
2023-04-20 14:08:34,350 - Detection -   best_eval_score = 69.9
2023-04-20 14:08:34,350 - Detection -   eval_score = 69.0
2023-04-20 14:08:34,350 - Detection -   train_loss = 1.2716479778289795
2023-04-20 14:08:36,272 - Detection - ***** Epoch: 44: Eval results *****
2023-04-20 14:08:36,272 - Detection -   best_eval_score = 69.9
2023-04-20 14:08:36,272 - Detection -   eval_score = 69.0
2023-04-20 14:08:36,272 - Detection -   train_loss = 1.277543580532074
2023-04-20 14:08:38,196 - Detection - ***** Epoch: 45: Eval results *****
2023-04-20 14:08:38,196 - Detection -   best_eval_score = 69.9
2023-04-20 14:08:38,196 - Detection -   eval_score = 69.0
2023-04-20 14:08:38,196 - Detection -   train_loss = 1.2684824824333192
2023-04-20 14:08:40,124 - Detection - ***** Epoch: 46: Eval results *****
2023-04-20 14:08:40,124 - Detection -   best_eval_score = 69.9
2023-04-20 14:08:40,124 - Detection -   eval_score = 69.0
2023-04-20 14:08:40,124 - Detection -   train_loss = 1.3346819043159486
2023-04-20 14:08:42,052 - Detection - ***** Epoch: 47: Eval results *****
2023-04-20 14:08:42,052 - Detection -   best_eval_score = 69.9
2023-04-20 14:08:42,052 - Detection -   eval_score = 68.95
2023-04-20 14:08:42,052 - Detection -   train_loss = 1.2564780116081238
2023-04-20 14:08:43,971 - Detection - ***** Epoch: 48: Eval results *****
2023-04-20 14:08:43,971 - Detection -   best_eval_score = 69.9
2023-04-20 14:08:43,971 - Detection -   eval_score = 68.44
2023-04-20 14:08:43,971 - Detection -   train_loss = 1.286353302001953
2023-04-20 14:08:45,891 - Detection - ***** Epoch: 49: Eval results *****
2023-04-20 14:08:45,891 - Detection -   best_eval_score = 69.9
2023-04-20 14:08:45,891 - Detection -   eval_score = 68.84
2023-04-20 14:08:45,891 - Detection -   train_loss = 1.2718083024024964
2023-04-20 14:08:47,816 - Detection - ***** Epoch: 50: Eval results *****
2023-04-20 14:08:47,817 - Detection -   best_eval_score = 69.9
2023-04-20 14:08:47,817 - Detection -   eval_score = 68.84
2023-04-20 14:08:47,817 - Detection -   train_loss = 1.2927833199501038
2023-04-20 14:08:49,735 - Detection - ***** Epoch: 51: Eval results *****
2023-04-20 14:08:49,735 - Detection -   best_eval_score = 69.9
2023-04-20 14:08:49,735 - Detection -   eval_score = 68.84
2023-04-20 14:08:49,735 - Detection -   train_loss = 1.3122944831848145
2023-04-20 14:08:49,736 - Detection - Training Finished...
2023-04-20 14:08:49,736 - Detection - Testing begin...
2023-04-20 14:08:51,804 - Detection - ***** Test: Confusion Matrix *****
2023-04-20 14:08:51,804 - Detection - [[ 23   0   0 ...   0   0   4]
 [  0  18   0 ...   0   0   5]
 [  0   0  18 ...   0   0  10]
 ...
 [  0   0   0 ...  12   0   6]
 [  0   0   0 ...   0  19   7]
 [  0   2  10 ...   6   2 612]]
2023-04-20 14:08:51,804 - Detection - ***** Test results *****
2023-04-20 14:08:51,804 - Detection -   Acc = 65.72
2023-04-20 14:08:51,805 - Detection -   F1 = 62.2175
2023-04-20 14:08:51,805 - Detection -   F1-known = 62.0411
2023-04-20 14:08:51,805 - Detection -   F1-open = 68.9189
2023-04-20 14:08:51,805 - Detection - Testing finished...
2023-04-20 14:08:51,805 - Detection - Results saved in results/results_ADB.csv
2023-04-20 14:08:51,824 - Detection - Open Intent Detection Finished...
