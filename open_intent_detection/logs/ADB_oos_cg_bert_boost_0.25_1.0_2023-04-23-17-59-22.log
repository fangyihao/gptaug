2023-04-23 17:59:22,264 - Detection - Open Intent Detection Begin...
2023-04-23 17:59:22,264 - Detection - Parameters Initialization...
2023-04-23 17:59:22,264 - Detection - ============================== Params ==============================
2023-04-23 17:59:22,264 - Detection - type:	open_intent_detection
2023-04-23 17:59:22,264 - Detection - logger_name:	Detection
2023-04-23 17:59:22,264 - Detection - log_dir:	logs
2023-04-23 17:59:22,264 - Detection - dataset:	oos_cg
2023-04-23 17:59:22,264 - Detection - known_cls_ratio:	0.25
2023-04-23 17:59:22,264 - Detection - labeled_ratio:	1.0
2023-04-23 17:59:22,264 - Detection - method:	ADB
2023-04-23 17:59:22,264 - Detection - train:	True
2023-04-23 17:59:22,265 - Detection - pretrain:	True
2023-04-23 17:59:22,265 - Detection - save_model:	False
2023-04-23 17:59:22,265 - Detection - backbone:	bert_boost
2023-04-23 17:59:22,265 - Detection - config_file_name:	ADB
2023-04-23 17:59:22,265 - Detection - seed:	8
2023-04-23 17:59:22,265 - Detection - gpu_id:	0
2023-04-23 17:59:22,265 - Detection - pipe_results_path:	pipe_results
2023-04-23 17:59:22,265 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-23 17:59:22,265 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-23 17:59:22,265 - Detection - model_dir:	models
2023-04-23 17:59:22,265 - Detection - load_pretrained_method:	None
2023-04-23 17:59:22,265 - Detection - result_dir:	results
2023-04-23 17:59:22,265 - Detection - results_file_name:	results_ADB-BOOST-F-4.csv
2023-04-23 17:59:22,265 - Detection - save_results:	True
2023-04-23 17:59:22,265 - Detection - loss_fct:	CrossEntropyLoss
2023-04-23 17:59:22,265 - Detection - boost_method:	F-4
2023-04-23 17:59:22,265 - Detection - boost_start_score:	0.0
2023-04-23 17:59:22,265 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_cg_0.25_1.0_bert_boost_8
2023-04-23 17:59:22,265 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_cg_0.25_1.0_bert_boost_8/models
2023-04-23 17:59:22,265 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-23 17:59:22,265 - Detection - num_train_epochs:	100
2023-04-23 17:59:22,265 - Detection - num_labels:	None
2023-04-23 17:59:22,265 - Detection - max_seq_length:	None
2023-04-23 17:59:22,265 - Detection - freeze_backbone_parameters:	True
2023-04-23 17:59:22,265 - Detection - feat_dim:	768
2023-04-23 17:59:22,265 - Detection - warmup_proportion:	0.1
2023-04-23 17:59:22,265 - Detection - lr_boundary:	0.05
2023-04-23 17:59:22,265 - Detection - lr:	2e-05
2023-04-23 17:59:22,265 - Detection - activation:	relu
2023-04-23 17:59:22,265 - Detection - train_batch_size:	128
2023-04-23 17:59:22,265 - Detection - eval_batch_size:	64
2023-04-23 17:59:22,265 - Detection - test_batch_size:	64
2023-04-23 17:59:22,265 - Detection - wait_patient:	10
2023-04-23 17:59:22,265 - Detection - ============================== End Params ==============================
2023-04-23 17:59:22,265 - Detection - Data and Model Preparation...
2023-04-23 17:59:22,266 - Detection - The number of known intents is 38
2023-04-23 17:59:22,266 - Detection - Lists of known labels are: ['apr', 'credit_limit_change', 'cook_time', 'what_are_your_hobbies', 'make_call', 'definition', 'change_speed', 'where_are_you_from', 'travel_alert', 'next_holiday', 'ingredients_list', 'credit_score', 'rollover_401k', 'greeting', 'text', 'whisper_mode', 'user_name', 'todo_list_update', 'meeting_schedule', 'transactions', 'how_old_are_you', 'account_blocked', 'meal_suggestion', 'pto_request', 'replacement_card_duration', 'accept_reservations', 'thank_you', 'application_status', 'car_rental', 'taxes', 'food_last', 'calendar', 'change_language', 'tire_change', 'pto_request_status', 'no', 'travel_suggestion', 'pto_balance']
2023-04-23 17:59:22,276 - Detection - Number of labeled training samples = 1039
2023-04-23 17:59:22,276 - Detection - Number of unlabeled training samples = 2644
2023-04-23 17:59:22,280 - Detection - Number of evaluation samples = 415
2023-04-23 17:59:22,286 - Detection - Number of testing samples = 3632
2023-04-23 17:59:26,230 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-23 17:59:27,958 - Detection - Pre-training Begin...
2023-04-23 17:59:29,385 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 17:59:29,386 - Detection -   best_eval_score = 0
2023-04-23 17:59:29,386 - Detection -   eval_score = 4.34
2023-04-23 17:59:29,386 - Detection -   train_loss = 3.6420031918419733
2023-04-23 17:59:34,165 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 17:59:34,165 - Detection -   best_eval_score = 4.34
2023-04-23 17:59:34,165 - Detection -   eval_score = 14.46
2023-04-23 17:59:34,165 - Detection -   train_loss = 3.6261110570695667
2023-04-23 17:59:38,746 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 17:59:38,746 - Detection -   best_eval_score = 14.46
2023-04-23 17:59:38,746 - Detection -   eval_score = 21.69
2023-04-23 17:59:38,746 - Detection -   train_loss = 3.4508242342207165
2023-04-23 17:59:43,326 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 17:59:43,326 - Detection -   best_eval_score = 21.69
2023-04-23 17:59:43,326 - Detection -   eval_score = 36.63
2023-04-23 17:59:43,326 - Detection -   train_loss = 2.9630543655819364
2023-04-23 17:59:48,012 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 17:59:48,012 - Detection -   best_eval_score = 36.63
2023-04-23 17:59:48,012 - Detection -   eval_score = 56.39
2023-04-23 17:59:48,012 - Detection -   train_loss = 1.9789395994610257
2023-04-23 17:59:52,607 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 17:59:52,607 - Detection -   best_eval_score = 56.39
2023-04-23 17:59:52,607 - Detection -   eval_score = 70.36
2023-04-23 17:59:52,607 - Detection -   train_loss = 1.188042892350091
2023-04-23 17:59:57,265 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 17:59:57,265 - Detection -   best_eval_score = 70.36
2023-04-23 17:59:57,265 - Detection -   eval_score = 77.11
2023-04-23 17:59:57,265 - Detection -   train_loss = 0.7018682029512193
2023-04-23 18:00:01,955 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 18:00:01,955 - Detection -   best_eval_score = 77.11
2023-04-23 18:00:01,955 - Detection -   eval_score = 82.41
2023-04-23 18:00:01,955 - Detection -   train_loss = 0.47822221120198566
2023-04-23 18:00:06,557 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 18:00:06,557 - Detection -   best_eval_score = 82.41
2023-04-23 18:00:06,557 - Detection -   eval_score = 84.82
2023-04-23 18:00:06,557 - Detection -   train_loss = 0.2983428438504537
2023-04-23 18:00:11,188 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 18:00:11,188 - Detection -   best_eval_score = 84.82
2023-04-23 18:00:11,188 - Detection -   eval_score = 86.02
2023-04-23 18:00:11,188 - Detection -   train_loss = 0.21462316645516288
2023-04-23 18:00:15,931 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 18:00:15,931 - Detection -   best_eval_score = 86.02
2023-04-23 18:00:15,931 - Detection -   eval_score = 86.75
2023-04-23 18:00:15,931 - Detection -   train_loss = 0.16154317557811737
2023-04-23 18:00:20,535 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 18:00:20,535 - Detection -   best_eval_score = 86.75
2023-04-23 18:00:20,535 - Detection -   eval_score = 86.51
2023-04-23 18:00:20,535 - Detection -   train_loss = 0.12045160763793522
2023-04-23 18:00:25,111 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 18:00:25,111 - Detection -   best_eval_score = 86.75
2023-04-23 18:00:25,111 - Detection -   eval_score = 88.43
2023-04-23 18:00:25,111 - Detection -   train_loss = 0.1039685673183865
2023-04-23 18:00:29,814 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 18:00:29,814 - Detection -   best_eval_score = 88.43
2023-04-23 18:00:29,814 - Detection -   eval_score = 88.92
2023-04-23 18:00:29,814 - Detection -   train_loss = 0.0822374899354246
2023-04-23 18:00:34,533 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 18:00:34,533 - Detection -   best_eval_score = 88.92
2023-04-23 18:00:34,533 - Detection -   eval_score = 89.4
2023-04-23 18:00:34,533 - Detection -   train_loss = 0.0721207997865147
2023-04-23 18:00:39,157 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 18:00:39,157 - Detection -   best_eval_score = 89.4
2023-04-23 18:00:39,157 - Detection -   eval_score = 88.43
2023-04-23 18:00:39,157 - Detection -   train_loss = 0.0680411925746335
2023-04-23 18:00:43,895 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 18:00:43,895 - Detection -   best_eval_score = 89.4
2023-04-23 18:00:43,895 - Detection -   eval_score = 89.16
2023-04-23 18:00:43,895 - Detection -   train_loss = 0.054572266423039965
2023-04-23 18:00:48,498 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 18:00:48,498 - Detection -   best_eval_score = 89.4
2023-04-23 18:00:48,498 - Detection -   eval_score = 89.16
2023-04-23 18:00:48,498 - Detection -   train_loss = 0.05068122512764401
2023-04-23 18:00:53,102 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 18:00:53,102 - Detection -   best_eval_score = 89.4
2023-04-23 18:00:53,102 - Detection -   eval_score = 89.16
2023-04-23 18:00:53,102 - Detection -   train_loss = 0.045071732666757375
2023-04-23 18:00:57,761 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 18:00:57,761 - Detection -   best_eval_score = 89.4
2023-04-23 18:00:57,761 - Detection -   eval_score = 88.92
2023-04-23 18:00:57,761 - Detection -   train_loss = 0.04034859976834721
2023-04-23 18:01:02,425 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 18:01:02,425 - Detection -   best_eval_score = 89.4
2023-04-23 18:01:02,425 - Detection -   eval_score = 89.16
2023-04-23 18:01:02,425 - Detection -   train_loss = 0.04024200720919503
2023-04-23 18:01:07,037 - Detection - ***** Epoch: 22: Eval results *****
2023-04-23 18:01:07,037 - Detection -   best_eval_score = 89.4
2023-04-23 18:01:07,037 - Detection -   eval_score = 88.92
2023-04-23 18:01:07,037 - Detection -   train_loss = 0.029446853117810354
2023-04-23 18:01:11,751 - Detection - ***** Epoch: 23: Eval results *****
2023-04-23 18:01:11,751 - Detection -   best_eval_score = 89.4
2023-04-23 18:01:11,752 - Detection -   eval_score = 88.92
2023-04-23 18:01:11,752 - Detection -   train_loss = 0.03493421110841963
2023-04-23 18:01:16,346 - Detection - ***** Epoch: 24: Eval results *****
2023-04-23 18:01:16,346 - Detection -   best_eval_score = 89.4
2023-04-23 18:01:16,346 - Detection -   eval_score = 88.43
2023-04-23 18:01:16,346 - Detection -   train_loss = 0.026373062282800674
2023-04-23 18:01:21,002 - Detection - ***** Epoch: 25: Eval results *****
2023-04-23 18:01:21,003 - Detection -   best_eval_score = 89.4
2023-04-23 18:01:21,003 - Detection -   eval_score = 88.92
2023-04-23 18:01:21,003 - Detection -   train_loss = 0.023351941878596943
2023-04-23 18:01:21,003 - Detection - Pre-training finished...
2023-04-23 18:01:21,003 - Detection - Training Begin...
2023-04-23 18:01:22,117 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 18:01:22,117 - Detection -   best_eval_score = 0
2023-04-23 18:01:22,117 - Detection -   eval_score = 0.0
2023-04-23 18:01:22,117 - Detection -   train_loss = 9.42080561319987
2023-04-23 18:01:22,782 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 18:01:22,782 - Detection -   best_eval_score = 0
2023-04-23 18:01:22,782 - Detection -   eval_score = 0.0
2023-04-23 18:01:22,782 - Detection -   train_loss = 9.224449475606283
2023-04-23 18:01:23,446 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 18:01:23,447 - Detection -   best_eval_score = 0
2023-04-23 18:01:23,447 - Detection -   eval_score = 0.0
2023-04-23 18:01:23,447 - Detection -   train_loss = 8.998022185431587
2023-04-23 18:01:24,113 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 18:01:24,113 - Detection -   best_eval_score = 0
2023-04-23 18:01:24,113 - Detection -   eval_score = 0.0
2023-04-23 18:01:24,113 - Detection -   train_loss = 8.65256150563558
2023-04-23 18:01:24,777 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 18:01:24,777 - Detection -   best_eval_score = 0
2023-04-23 18:01:24,777 - Detection -   eval_score = 0.0
2023-04-23 18:01:24,777 - Detection -   train_loss = 8.297949949900309
2023-04-23 18:01:25,444 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 18:01:25,444 - Detection -   best_eval_score = 0
2023-04-23 18:01:25,444 - Detection -   eval_score = 0.0
2023-04-23 18:01:25,444 - Detection -   train_loss = 7.964617040422228
2023-04-23 18:01:26,112 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 18:01:26,112 - Detection -   best_eval_score = 0
2023-04-23 18:01:26,113 - Detection -   eval_score = 0.0
2023-04-23 18:01:26,113 - Detection -   train_loss = 7.55542336569892
2023-04-23 18:01:26,780 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 18:01:26,780 - Detection -   best_eval_score = 0
2023-04-23 18:01:26,780 - Detection -   eval_score = 0.91
2023-04-23 18:01:26,780 - Detection -   train_loss = 7.134371386633979
2023-04-23 18:01:31,462 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 18:01:31,462 - Detection -   best_eval_score = 0.91
2023-04-23 18:01:31,462 - Detection -   eval_score = 6.79
2023-04-23 18:01:31,462 - Detection -   train_loss = 6.799552546607123
2023-04-23 18:01:36,073 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 18:01:36,073 - Detection -   best_eval_score = 6.79
2023-04-23 18:01:36,073 - Detection -   eval_score = 28.62
2023-04-23 18:01:36,073 - Detection -   train_loss = 4.7425235112508135
2023-04-23 18:01:40,637 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 18:01:40,637 - Detection -   best_eval_score = 28.62
2023-04-23 18:01:40,637 - Detection -   eval_score = 49.94
2023-04-23 18:01:40,637 - Detection -   train_loss = 2.758086919784546
2023-04-23 18:01:45,215 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 18:01:45,215 - Detection -   best_eval_score = 49.94
2023-04-23 18:01:45,215 - Detection -   eval_score = 57.75
2023-04-23 18:01:45,215 - Detection -   train_loss = 1.4614538616604276
2023-04-23 18:01:49,878 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 18:01:49,878 - Detection -   best_eval_score = 57.75
2023-04-23 18:01:49,878 - Detection -   eval_score = 60.49
2023-04-23 18:01:49,878 - Detection -   train_loss = 1.1318363613552518
2023-04-23 18:01:54,456 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 18:01:54,456 - Detection -   best_eval_score = 60.49
2023-04-23 18:01:54,457 - Detection -   eval_score = 60.63
2023-04-23 18:01:54,457 - Detection -   train_loss = 1.139798363049825
2023-04-23 18:01:59,051 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 18:01:59,051 - Detection -   best_eval_score = 60.63
2023-04-23 18:01:59,051 - Detection -   eval_score = 60.28
2023-04-23 18:01:59,051 - Detection -   train_loss = 1.1437000963422987
2023-04-23 18:02:03,732 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 18:02:03,732 - Detection -   best_eval_score = 60.63
2023-04-23 18:02:03,732 - Detection -   eval_score = 61.12
2023-04-23 18:02:03,732 - Detection -   train_loss = 1.0416690707206726
2023-04-23 18:02:08,305 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 18:02:08,305 - Detection -   best_eval_score = 61.12
2023-04-23 18:02:08,305 - Detection -   eval_score = 60.38
2023-04-23 18:02:08,305 - Detection -   train_loss = 1.1281277272436354
2023-04-23 18:02:12,915 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 18:02:12,915 - Detection -   best_eval_score = 61.12
2023-04-23 18:02:12,915 - Detection -   eval_score = 60.09
2023-04-23 18:02:12,915 - Detection -   train_loss = 1.0635704398155212
2023-04-23 18:02:17,493 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 18:02:17,493 - Detection -   best_eval_score = 61.12
2023-04-23 18:02:17,493 - Detection -   eval_score = 60.32
2023-04-23 18:02:17,493 - Detection -   train_loss = 1.0609137217203777
2023-04-23 18:02:22,101 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 18:02:22,102 - Detection -   best_eval_score = 61.12
2023-04-23 18:02:22,102 - Detection -   eval_score = 59.85
2023-04-23 18:02:22,102 - Detection -   train_loss = 1.0419803791575961
2023-04-23 18:02:26,768 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 18:02:26,768 - Detection -   best_eval_score = 61.12
2023-04-23 18:02:26,768 - Detection -   eval_score = 60.74
2023-04-23 18:02:26,768 - Detection -   train_loss = 1.0923023555013869
2023-04-23 18:02:31,520 - Detection - ***** Epoch: 22: Eval results *****
2023-04-23 18:02:31,520 - Detection -   best_eval_score = 61.12
2023-04-23 18:02:31,520 - Detection -   eval_score = 60.49
2023-04-23 18:02:31,520 - Detection -   train_loss = 1.061129543516371
2023-04-23 18:02:36,069 - Detection - ***** Epoch: 23: Eval results *****
2023-04-23 18:02:36,069 - Detection -   best_eval_score = 61.12
2023-04-23 18:02:36,070 - Detection -   eval_score = 60.3
2023-04-23 18:02:36,070 - Detection -   train_loss = 1.1589629583888583
2023-04-23 18:02:40,742 - Detection - ***** Epoch: 24: Eval results *****
2023-04-23 18:02:40,742 - Detection -   best_eval_score = 61.12
2023-04-23 18:02:40,742 - Detection -   eval_score = 60.27
2023-04-23 18:02:40,742 - Detection -   train_loss = 1.061162405543857
2023-04-23 18:02:45,314 - Detection - ***** Epoch: 25: Eval results *****
2023-04-23 18:02:45,314 - Detection -   best_eval_score = 61.12
2023-04-23 18:02:45,314 - Detection -   eval_score = 60.67
2023-04-23 18:02:45,314 - Detection -   train_loss = 1.0874408218595717
2023-04-23 18:02:49,877 - Detection - ***** Epoch: 26: Eval results *****
2023-04-23 18:02:49,877 - Detection -   best_eval_score = 61.12
2023-04-23 18:02:49,877 - Detection -   eval_score = 60.82
2023-04-23 18:02:49,877 - Detection -   train_loss = 1.136389176050822
2023-04-23 18:02:49,877 - Detection - Training Finished...
2023-04-23 18:02:49,877 - Detection - Testing begin...
2023-04-23 18:02:51,382 - Detection - ***** Test: Confusion Matrix *****
2023-04-23 18:02:51,383 - Detection - [[   1    0    0 ...    0    0   10]
 [   0   11    0 ...    0    0   10]
 [   0    0    2 ...    0    0    6]
 ...
 [   0    0    0 ...    5    0   10]
 [   0    0    0 ...    0    1    8]
 [   1    3    1 ...   11    3 2781]]
2023-04-23 18:02:51,383 - Detection - ***** Test results *****
2023-04-23 18:02:51,383 - Detection -   Acc = 84.64
2023-04-23 18:02:51,383 - Detection -   F1 = 45.3533
2023-04-23 18:02:51,383 - Detection -   F1-known = 44.1489
2023-04-23 18:02:51,383 - Detection -   F1-open = 91.1206
2023-04-23 18:02:51,383 - Detection - Testing finished...
2023-04-23 18:02:51,383 - Detection - Results saved in results/results_ADB-BOOST-F-4.csv
2023-04-23 18:02:51,404 - Detection - Open Intent Detection Finished...
