2023-04-19 23:54:12,450 - Detection - Open Intent Detection Begin...
2023-04-19 23:54:12,450 - Detection - Parameters Initialization...
2023-04-19 23:54:12,450 - Detection - ============================== Params ==============================
2023-04-19 23:54:12,450 - Detection - type:	open_intent_detection
2023-04-19 23:54:12,450 - Detection - logger_name:	Detection
2023-04-19 23:54:12,450 - Detection - log_dir:	logs
2023-04-19 23:54:12,450 - Detection - dataset:	stackoverflow_cg
2023-04-19 23:54:12,450 - Detection - known_cls_ratio:	0.25
2023-04-19 23:54:12,450 - Detection - labeled_ratio:	1.0
2023-04-19 23:54:12,450 - Detection - method:	DA-ADB
2023-04-19 23:54:12,450 - Detection - train:	True
2023-04-19 23:54:12,450 - Detection - pretrain:	True
2023-04-19 23:54:12,450 - Detection - save_model:	True
2023-04-19 23:54:12,450 - Detection - backbone:	bert_disaware
2023-04-19 23:54:12,450 - Detection - config_file_name:	DA-ADB
2023-04-19 23:54:12,450 - Detection - seed:	2
2023-04-19 23:54:12,450 - Detection - gpu_id:	0
2023-04-19 23:54:12,450 - Detection - pipe_results_path:	pipe_results
2023-04-19 23:54:12,450 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-19 23:54:12,450 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-19 23:54:12,450 - Detection - model_dir:	models
2023-04-19 23:54:12,450 - Detection - load_pretrained_method:	None
2023-04-19 23:54:12,450 - Detection - result_dir:	results
2023-04-19 23:54:12,450 - Detection - results_file_name:	results_DA-ADB.csv
2023-04-19 23:54:12,450 - Detection - save_results:	True
2023-04-19 23:54:12,450 - Detection - loss_fct:	CrossEntropyLoss
2023-04-19 23:54:12,450 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.25_1.0_bert_disaware_2
2023-04-19 23:54:12,450 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.25_1.0_bert_disaware_2/models
2023-04-19 23:54:12,451 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-19 23:54:12,451 - Detection - num_train_epochs:	100
2023-04-19 23:54:12,451 - Detection - num_labels:	None
2023-04-19 23:54:12,451 - Detection - max_seq_length:	None
2023-04-19 23:54:12,451 - Detection - freeze_backbone_parameters:	True
2023-04-19 23:54:12,451 - Detection - feat_dim:	768
2023-04-19 23:54:12,451 - Detection - warmup_proportion:	0.1
2023-04-19 23:54:12,451 - Detection - scale:	4
2023-04-19 23:54:12,451 - Detection - lr_boundary:	0.05
2023-04-19 23:54:12,451 - Detection - lr:	2e-05
2023-04-19 23:54:12,451 - Detection - activation:	relu
2023-04-19 23:54:12,451 - Detection - train_batch_size:	128
2023-04-19 23:54:12,451 - Detection - eval_batch_size:	64
2023-04-19 23:54:12,451 - Detection - test_batch_size:	64
2023-04-19 23:54:12,451 - Detection - wait_patient:	10
2023-04-19 23:54:12,451 - Detection - ============================== End Params ==============================
2023-04-19 23:54:12,451 - Detection - Data and Model Preparation...
2023-04-19 23:54:12,451 - Detection - The number of known intents is 5
2023-04-19 23:54:12,451 - Detection - Lists of known labels are: ['osx', 'drupal', 'visual-studio', 'ajax', 'magento']
2023-04-19 23:54:12,470 - Detection - Number of labeled training samples = 1974
2023-04-19 23:54:12,470 - Detection - Number of unlabeled training samples = 5843
2023-04-19 23:54:12,473 - Detection - Number of evaluation samples = 474
2023-04-19 23:54:12,483 - Detection - Number of testing samples = 5082
2023-04-19 23:54:19,489 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-19 23:54:19,570 - Detection - Pre-training Begin...
2023-04-19 23:54:23,860 - Detection - ***** Epoch: 1: Eval results *****
2023-04-19 23:54:23,860 - Detection -   best_eval_score = 0
2023-04-19 23:54:23,860 - Detection -   eval_score = 6.45
2023-04-19 23:54:23,860 - Detection -   train_loss = 1.6124136969447136
2023-04-19 23:54:27,660 - Detection - ***** Epoch: 2: Eval results *****
2023-04-19 23:54:27,660 - Detection -   best_eval_score = 6.45
2023-04-19 23:54:27,660 - Detection -   eval_score = 25.71
2023-04-19 23:54:27,660 - Detection -   train_loss = 1.598372295498848
2023-04-19 23:54:31,468 - Detection - ***** Epoch: 3: Eval results *****
2023-04-19 23:54:31,469 - Detection -   best_eval_score = 25.71
2023-04-19 23:54:31,469 - Detection -   eval_score = 22.89
2023-04-19 23:54:31,469 - Detection -   train_loss = 1.5797290578484535
2023-04-19 23:54:35,274 - Detection - ***** Epoch: 4: Eval results *****
2023-04-19 23:54:35,274 - Detection -   best_eval_score = 25.71
2023-04-19 23:54:35,274 - Detection -   eval_score = 33.69
2023-04-19 23:54:35,274 - Detection -   train_loss = 1.54648769646883
2023-04-19 23:54:39,092 - Detection - ***** Epoch: 5: Eval results *****
2023-04-19 23:54:39,092 - Detection -   best_eval_score = 33.69
2023-04-19 23:54:39,092 - Detection -   eval_score = 63.76
2023-04-19 23:54:39,092 - Detection -   train_loss = 1.4717945381999016
2023-04-19 23:54:42,920 - Detection - ***** Epoch: 6: Eval results *****
2023-04-19 23:54:42,920 - Detection -   best_eval_score = 63.76
2023-04-19 23:54:42,920 - Detection -   eval_score = 75.5
2023-04-19 23:54:42,920 - Detection -   train_loss = 1.3103342577815056
2023-04-19 23:54:46,749 - Detection - ***** Epoch: 7: Eval results *****
2023-04-19 23:54:46,749 - Detection -   best_eval_score = 75.5
2023-04-19 23:54:46,749 - Detection -   eval_score = 81.15
2023-04-19 23:54:46,749 - Detection -   train_loss = 1.0398427471518517
2023-04-19 23:54:50,585 - Detection - ***** Epoch: 8: Eval results *****
2023-04-19 23:54:50,585 - Detection -   best_eval_score = 81.15
2023-04-19 23:54:50,586 - Detection -   eval_score = 87.54
2023-04-19 23:54:50,586 - Detection -   train_loss = 0.7313203662633896
2023-04-19 23:54:54,427 - Detection - ***** Epoch: 9: Eval results *****
2023-04-19 23:54:54,428 - Detection -   best_eval_score = 87.54
2023-04-19 23:54:54,428 - Detection -   eval_score = 87.6
2023-04-19 23:54:54,428 - Detection -   train_loss = 0.5930663198232651
2023-04-19 23:54:58,276 - Detection - ***** Epoch: 10: Eval results *****
2023-04-19 23:54:58,276 - Detection -   best_eval_score = 87.6
2023-04-19 23:54:58,276 - Detection -   eval_score = 88.04
2023-04-19 23:54:58,276 - Detection -   train_loss = 0.5136909186840057
2023-04-19 23:55:02,131 - Detection - ***** Epoch: 11: Eval results *****
2023-04-19 23:55:02,131 - Detection -   best_eval_score = 88.04
2023-04-19 23:55:02,131 - Detection -   eval_score = 88.85
2023-04-19 23:55:02,131 - Detection -   train_loss = 0.45459735952317715
2023-04-19 23:55:05,988 - Detection - ***** Epoch: 12: Eval results *****
2023-04-19 23:55:05,988 - Detection -   best_eval_score = 88.85
2023-04-19 23:55:05,988 - Detection -   eval_score = 90.24
2023-04-19 23:55:05,988 - Detection -   train_loss = 0.4338900353759527
2023-04-19 23:55:09,853 - Detection - ***** Epoch: 13: Eval results *****
2023-04-19 23:55:09,853 - Detection -   best_eval_score = 90.24
2023-04-19 23:55:09,853 - Detection -   eval_score = 89.25
2023-04-19 23:55:09,853 - Detection -   train_loss = 0.40817926824092865
2023-04-19 23:55:13,711 - Detection - ***** Epoch: 14: Eval results *****
2023-04-19 23:55:13,711 - Detection -   best_eval_score = 90.24
2023-04-19 23:55:13,711 - Detection -   eval_score = 89.53
2023-04-19 23:55:13,711 - Detection -   train_loss = 0.3972114659845829
2023-04-19 23:55:17,575 - Detection - ***** Epoch: 15: Eval results *****
2023-04-19 23:55:17,575 - Detection -   best_eval_score = 90.24
2023-04-19 23:55:17,575 - Detection -   eval_score = 90.06
2023-04-19 23:55:17,575 - Detection -   train_loss = 0.3678546417504549
2023-04-19 23:55:21,441 - Detection - ***** Epoch: 16: Eval results *****
2023-04-19 23:55:21,441 - Detection -   best_eval_score = 90.24
2023-04-19 23:55:21,441 - Detection -   eval_score = 91.14
2023-04-19 23:55:21,441 - Detection -   train_loss = 0.3475556578487158
2023-04-19 23:55:25,317 - Detection - ***** Epoch: 17: Eval results *****
2023-04-19 23:55:25,318 - Detection -   best_eval_score = 91.14
2023-04-19 23:55:25,318 - Detection -   eval_score = 90.35
2023-04-19 23:55:25,318 - Detection -   train_loss = 0.3260009530931711
2023-04-19 23:55:29,279 - Detection - ***** Epoch: 18: Eval results *****
2023-04-19 23:55:29,280 - Detection -   best_eval_score = 91.14
2023-04-19 23:55:29,280 - Detection -   eval_score = 91.36
2023-04-19 23:55:29,280 - Detection -   train_loss = 0.3186849020421505
2023-04-19 23:55:33,144 - Detection - ***** Epoch: 19: Eval results *****
2023-04-19 23:55:33,144 - Detection -   best_eval_score = 91.36
2023-04-19 23:55:33,144 - Detection -   eval_score = 91.18
2023-04-19 23:55:33,144 - Detection -   train_loss = 0.29336367174983025
2023-04-19 23:55:36,998 - Detection - ***** Epoch: 20: Eval results *****
2023-04-19 23:55:36,998 - Detection -   best_eval_score = 91.36
2023-04-19 23:55:36,998 - Detection -   eval_score = 90.94
2023-04-19 23:55:36,998 - Detection -   train_loss = 0.27728298772126436
2023-04-19 23:55:40,853 - Detection - ***** Epoch: 21: Eval results *****
2023-04-19 23:55:40,853 - Detection -   best_eval_score = 91.36
2023-04-19 23:55:40,853 - Detection -   eval_score = 91.81
2023-04-19 23:55:40,853 - Detection -   train_loss = 0.28351494390517473
2023-04-19 23:55:44,716 - Detection - ***** Epoch: 22: Eval results *****
2023-04-19 23:55:44,716 - Detection -   best_eval_score = 91.81
2023-04-19 23:55:44,716 - Detection -   eval_score = 90.77
2023-04-19 23:55:44,716 - Detection -   train_loss = 0.2626379048451781
2023-04-19 23:55:48,570 - Detection - ***** Epoch: 23: Eval results *****
2023-04-19 23:55:48,570 - Detection -   best_eval_score = 91.81
2023-04-19 23:55:48,570 - Detection -   eval_score = 90.73
2023-04-19 23:55:48,570 - Detection -   train_loss = 0.2599024325609207
2023-04-19 23:55:52,427 - Detection - ***** Epoch: 24: Eval results *****
2023-04-19 23:55:52,428 - Detection -   best_eval_score = 91.81
2023-04-19 23:55:52,428 - Detection -   eval_score = 90.54
2023-04-19 23:55:52,428 - Detection -   train_loss = 0.24560360796749592
2023-04-19 23:55:56,277 - Detection - ***** Epoch: 25: Eval results *****
2023-04-19 23:55:56,277 - Detection -   best_eval_score = 91.81
2023-04-19 23:55:56,278 - Detection -   eval_score = 90.95
2023-04-19 23:55:56,278 - Detection -   train_loss = 0.2385969152674079
2023-04-19 23:56:00,131 - Detection - ***** Epoch: 26: Eval results *****
2023-04-19 23:56:00,131 - Detection -   best_eval_score = 91.81
2023-04-19 23:56:00,131 - Detection -   eval_score = 90.98
2023-04-19 23:56:00,131 - Detection -   train_loss = 0.2307382384315133
2023-04-19 23:56:03,988 - Detection - ***** Epoch: 27: Eval results *****
2023-04-19 23:56:03,988 - Detection -   best_eval_score = 91.81
2023-04-19 23:56:03,988 - Detection -   eval_score = 91.2
2023-04-19 23:56:03,988 - Detection -   train_loss = 0.23079984821379185
2023-04-19 23:56:07,837 - Detection - ***** Epoch: 28: Eval results *****
2023-04-19 23:56:07,837 - Detection -   best_eval_score = 91.81
2023-04-19 23:56:07,837 - Detection -   eval_score = 90.99
2023-04-19 23:56:07,837 - Detection -   train_loss = 0.22356160916388035
2023-04-19 23:56:11,687 - Detection - ***** Epoch: 29: Eval results *****
2023-04-19 23:56:11,687 - Detection -   best_eval_score = 91.81
2023-04-19 23:56:11,688 - Detection -   eval_score = 91.61
2023-04-19 23:56:11,688 - Detection -   train_loss = 0.22213233821094036
2023-04-19 23:56:15,538 - Detection - ***** Epoch: 30: Eval results *****
2023-04-19 23:56:15,538 - Detection -   best_eval_score = 91.81
2023-04-19 23:56:15,538 - Detection -   eval_score = 90.76
2023-04-19 23:56:15,538 - Detection -   train_loss = 0.20776548981666565
2023-04-19 23:56:19,392 - Detection - ***** Epoch: 31: Eval results *****
2023-04-19 23:56:19,392 - Detection -   best_eval_score = 91.81
2023-04-19 23:56:19,392 - Detection -   eval_score = 91.37
2023-04-19 23:56:19,392 - Detection -   train_loss = 0.2035882966592908
2023-04-19 23:56:19,393 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.25_1.0_bert_disaware_2/models
2023-04-19 23:56:19,936 - Detection - Pre-training finished...
2023-04-19 23:56:19,937 - Detection - Training Begin...
2023-04-19 23:56:22,155 - Detection - ***** Epoch: 1: Eval results *****
2023-04-19 23:56:22,155 - Detection -   best_eval_score = 0
2023-04-19 23:56:22,155 - Detection -   eval_score = 2.52
2023-04-19 23:56:22,155 - Detection -   train_loss = 3.5693365782499313
2023-04-19 23:56:24,376 - Detection - ***** Epoch: 2: Eval results *****
2023-04-19 23:56:24,376 - Detection -   best_eval_score = 2.52
2023-04-19 23:56:24,376 - Detection -   eval_score = 18.79
2023-04-19 23:56:24,376 - Detection -   train_loss = 3.0002754032611847
2023-04-19 23:56:26,594 - Detection - ***** Epoch: 3: Eval results *****
2023-04-19 23:56:26,594 - Detection -   best_eval_score = 18.79
2023-04-19 23:56:26,594 - Detection -   eval_score = 45.26
2023-04-19 23:56:26,594 - Detection -   train_loss = 2.340418979525566
2023-04-19 23:56:28,813 - Detection - ***** Epoch: 4: Eval results *****
2023-04-19 23:56:28,813 - Detection -   best_eval_score = 45.26
2023-04-19 23:56:28,813 - Detection -   eval_score = 61.35
2023-04-19 23:56:28,813 - Detection -   train_loss = 1.6361263915896416
2023-04-19 23:56:31,033 - Detection - ***** Epoch: 5: Eval results *****
2023-04-19 23:56:31,033 - Detection -   best_eval_score = 61.35
2023-04-19 23:56:31,033 - Detection -   eval_score = 70.5
2023-04-19 23:56:31,033 - Detection -   train_loss = 1.1950777657330036
2023-04-19 23:56:33,249 - Detection - ***** Epoch: 6: Eval results *****
2023-04-19 23:56:33,249 - Detection -   best_eval_score = 70.5
2023-04-19 23:56:33,249 - Detection -   eval_score = 73.62
2023-04-19 23:56:33,249 - Detection -   train_loss = 1.0149479918181896
2023-04-19 23:56:35,465 - Detection - ***** Epoch: 7: Eval results *****
2023-04-19 23:56:35,465 - Detection -   best_eval_score = 73.62
2023-04-19 23:56:35,465 - Detection -   eval_score = 73.74
2023-04-19 23:56:35,465 - Detection -   train_loss = 0.9853246062994003
2023-04-19 23:56:37,682 - Detection - ***** Epoch: 8: Eval results *****
2023-04-19 23:56:37,683 - Detection -   best_eval_score = 73.74
2023-04-19 23:56:37,683 - Detection -   eval_score = 73.74
2023-04-19 23:56:37,683 - Detection -   train_loss = 0.9613562561571598
2023-04-19 23:56:39,901 - Detection - ***** Epoch: 9: Eval results *****
2023-04-19 23:56:39,901 - Detection -   best_eval_score = 73.74
2023-04-19 23:56:39,901 - Detection -   eval_score = 73.15
2023-04-19 23:56:39,901 - Detection -   train_loss = 0.9883399978280067
2023-04-19 23:56:42,118 - Detection - ***** Epoch: 10: Eval results *****
2023-04-19 23:56:42,118 - Detection -   best_eval_score = 73.74
2023-04-19 23:56:42,118 - Detection -   eval_score = 73.26
2023-04-19 23:56:42,118 - Detection -   train_loss = 0.9901541844010353
2023-04-19 23:56:44,339 - Detection - ***** Epoch: 11: Eval results *****
2023-04-19 23:56:44,339 - Detection -   best_eval_score = 73.74
2023-04-19 23:56:44,339 - Detection -   eval_score = 73.74
2023-04-19 23:56:44,339 - Detection -   train_loss = 0.9724860787391663
2023-04-19 23:56:46,556 - Detection - ***** Epoch: 12: Eval results *****
2023-04-19 23:56:46,556 - Detection -   best_eval_score = 73.74
2023-04-19 23:56:46,556 - Detection -   eval_score = 73.74
2023-04-19 23:56:46,556 - Detection -   train_loss = 0.9650151133537292
2023-04-19 23:56:48,772 - Detection - ***** Epoch: 13: Eval results *****
2023-04-19 23:56:48,772 - Detection -   best_eval_score = 73.74
2023-04-19 23:56:48,772 - Detection -   eval_score = 73.74
2023-04-19 23:56:48,772 - Detection -   train_loss = 0.9852211512625217
2023-04-19 23:56:50,990 - Detection - ***** Epoch: 14: Eval results *****
2023-04-19 23:56:50,990 - Detection -   best_eval_score = 73.74
2023-04-19 23:56:50,990 - Detection -   eval_score = 73.62
2023-04-19 23:56:50,990 - Detection -   train_loss = 0.9843653067946434
2023-04-19 23:56:53,206 - Detection - ***** Epoch: 15: Eval results *****
2023-04-19 23:56:53,206 - Detection -   best_eval_score = 73.74
2023-04-19 23:56:53,206 - Detection -   eval_score = 73.26
2023-04-19 23:56:53,206 - Detection -   train_loss = 0.9973387755453587
2023-04-19 23:56:55,419 - Detection - ***** Epoch: 16: Eval results *****
2023-04-19 23:56:55,419 - Detection -   best_eval_score = 73.74
2023-04-19 23:56:55,419 - Detection -   eval_score = 73.26
2023-04-19 23:56:55,419 - Detection -   train_loss = 0.9771774746477604
2023-04-19 23:56:57,636 - Detection - ***** Epoch: 17: Eval results *****
2023-04-19 23:56:57,636 - Detection -   best_eval_score = 73.74
2023-04-19 23:56:57,636 - Detection -   eval_score = 72.75
2023-04-19 23:56:57,637 - Detection -   train_loss = 0.9791033156216145
2023-04-19 23:56:57,637 - Detection - Training Finished...
2023-04-19 23:56:57,638 - Detection - Testing begin...
2023-04-19 23:57:01,859 - Detection - ***** Test: Confusion Matrix *****
2023-04-19 23:57:01,859 - Detection - [[ 193    0    0    0    0   90]
 [   0  196    0    1    0   40]
 [   2    0  164    1    0   58]
 [   1    0    0  209    0   51]
 [   0    0    1    0  209   36]
 [ 225    2   70  127    0 3406]]
2023-04-19 23:57:01,859 - Detection - ***** Test results *****
2023-04-19 23:57:01,859 - Detection -   Acc = 86.13
2023-04-19 23:57:01,859 - Detection -   F1 = 78.0989
2023-04-19 23:57:01,859 - Detection -   F1-known = 75.58
2023-04-19 23:57:01,859 - Detection -   F1-open = 90.6936
2023-04-19 23:57:01,859 - Detection - Testing finished...
2023-04-19 23:57:01,859 - Detection - Results saved in results/results_DA-ADB.csv
2023-04-19 23:57:01,879 - Detection - Open Intent Detection Finished...
