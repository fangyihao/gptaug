2023-04-22 15:55:28,292 - Detection - Open Intent Detection Begin...
2023-04-22 15:55:28,292 - Detection - Parameters Initialization...
2023-04-22 15:55:28,292 - Detection - ============================== Params ==============================
2023-04-22 15:55:28,292 - Detection - type:	open_intent_detection
2023-04-22 15:55:28,292 - Detection - logger_name:	Detection
2023-04-22 15:55:28,292 - Detection - log_dir:	logs
2023-04-22 15:55:28,292 - Detection - dataset:	stackoverflow_cg
2023-04-22 15:55:28,293 - Detection - known_cls_ratio:	0.75
2023-04-22 15:55:28,293 - Detection - labeled_ratio:	1.0
2023-04-22 15:55:28,293 - Detection - method:	DA-ADB
2023-04-22 15:55:28,293 - Detection - train:	True
2023-04-22 15:55:28,293 - Detection - pretrain:	True
2023-04-22 15:55:28,293 - Detection - save_model:	False
2023-04-22 15:55:28,293 - Detection - backbone:	bert_disaware_boost
2023-04-22 15:55:28,293 - Detection - config_file_name:	DA-ADB
2023-04-22 15:55:28,293 - Detection - seed:	4
2023-04-22 15:55:28,293 - Detection - gpu_id:	0
2023-04-22 15:55:28,293 - Detection - pipe_results_path:	pipe_results
2023-04-22 15:55:28,293 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-22 15:55:28,293 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-22 15:55:28,293 - Detection - model_dir:	models
2023-04-22 15:55:28,293 - Detection - load_pretrained_method:	None
2023-04-22 15:55:28,293 - Detection - result_dir:	results
2023-04-22 15:55:28,293 - Detection - results_file_name:	results_DA-ADB-BOOST.csv
2023-04-22 15:55:28,293 - Detection - save_results:	True
2023-04-22 15:55:28,293 - Detection - loss_fct:	CrossEntropyLoss
2023-04-22 15:55:28,293 - Detection - boost_method:	F-10
2023-04-22 15:55:28,293 - Detection - boost_start_score:	0.0
2023-04-22 15:55:28,293 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.75_1.0_bert_disaware_boost_4
2023-04-22 15:55:28,293 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.75_1.0_bert_disaware_boost_4/models
2023-04-22 15:55:28,293 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-22 15:55:28,293 - Detection - num_train_epochs:	100
2023-04-22 15:55:28,293 - Detection - num_labels:	None
2023-04-22 15:55:28,293 - Detection - max_seq_length:	None
2023-04-22 15:55:28,293 - Detection - freeze_backbone_parameters:	True
2023-04-22 15:55:28,293 - Detection - feat_dim:	768
2023-04-22 15:55:28,293 - Detection - warmup_proportion:	0.1
2023-04-22 15:55:28,293 - Detection - scale:	4
2023-04-22 15:55:28,293 - Detection - lr_boundary:	0.05
2023-04-22 15:55:28,293 - Detection - lr:	2e-05
2023-04-22 15:55:28,293 - Detection - activation:	relu
2023-04-22 15:55:28,293 - Detection - train_batch_size:	128
2023-04-22 15:55:28,293 - Detection - eval_batch_size:	64
2023-04-22 15:55:28,293 - Detection - test_batch_size:	64
2023-04-22 15:55:28,293 - Detection - wait_patient:	10
2023-04-22 15:55:28,293 - Detection - ============================== End Params ==============================
2023-04-22 15:55:28,293 - Detection - Data and Model Preparation...
2023-04-22 15:55:28,294 - Detection - The number of known intents is 15
2023-04-22 15:55:28,294 - Detection - Lists of known labels are: ['wordpress', 'cocoa', 'visual-studio', 'haskell', 'qt', 'drupal', 'ajax', 'svn', 'osx', 'oracle', 'sharepoint', 'matlab', 'magento', 'bash', 'spring']
2023-04-22 15:55:28,303 - Detection - Number of labeled training samples = 2172
2023-04-22 15:55:28,303 - Detection - Number of unlabeled training samples = 619
2023-04-22 15:55:28,306 - Detection - Number of evaluation samples = 1054
2023-04-22 15:55:28,312 - Detection - Number of testing samples = 2905
2023-04-22 15:55:33,928 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-22 15:55:34,007 - Detection - Pre-training Begin...
2023-04-22 15:55:39,250 - Detection - ***** Epoch: 1: Eval results *****
2023-04-22 15:55:39,250 - Detection -   best_eval_score = 0
2023-04-22 15:55:39,250 - Detection -   eval_score = 1.17
2023-04-22 15:55:39,250 - Detection -   train_loss = 2.703086081673117
2023-04-22 15:56:13,249 - Detection - ***** Epoch: 2: Eval results *****
2023-04-22 15:56:13,249 - Detection -   best_eval_score = 1.17
2023-04-22 15:56:13,249 - Detection -   eval_score = 1.67
2023-04-22 15:56:13,250 - Detection -   train_loss = 2.6869375425226547
2023-04-22 15:56:47,516 - Detection - ***** Epoch: 3: Eval results *****
2023-04-22 15:56:47,516 - Detection -   best_eval_score = 1.67
2023-04-22 15:56:47,517 - Detection -   eval_score = 41.35
2023-04-22 15:56:47,517 - Detection -   train_loss = 2.571458339691162
2023-04-22 15:57:21,541 - Detection - ***** Epoch: 4: Eval results *****
2023-04-22 15:57:21,541 - Detection -   best_eval_score = 41.35
2023-04-22 15:57:21,541 - Detection -   eval_score = 76.98
2023-04-22 15:57:21,541 - Detection -   train_loss = 2.187546730041504
2023-04-22 15:57:55,513 - Detection - ***** Epoch: 5: Eval results *****
2023-04-22 15:57:55,514 - Detection -   best_eval_score = 76.98
2023-04-22 15:57:55,514 - Detection -   eval_score = 80.17
2023-04-22 15:57:55,514 - Detection -   train_loss = 1.6497570626875933
2023-04-22 15:58:29,673 - Detection - ***** Epoch: 6: Eval results *****
2023-04-22 15:58:29,673 - Detection -   best_eval_score = 80.17
2023-04-22 15:58:29,673 - Detection -   eval_score = 80.64
2023-04-22 15:58:29,673 - Detection -   train_loss = 1.3236951757879818
2023-04-22 15:59:03,592 - Detection - ***** Epoch: 7: Eval results *****
2023-04-22 15:59:03,592 - Detection -   best_eval_score = 80.64
2023-04-22 15:59:03,592 - Detection -   eval_score = 80.89
2023-04-22 15:59:03,592 - Detection -   train_loss = 1.159584087484023
2023-04-22 15:59:38,693 - Detection - ***** Epoch: 8: Eval results *****
2023-04-22 15:59:38,693 - Detection -   best_eval_score = 80.89
2023-04-22 15:59:38,693 - Detection -   eval_score = 81.42
2023-04-22 15:59:38,693 - Detection -   train_loss = 1.0406771793084986
2023-04-22 16:00:12,791 - Detection - ***** Epoch: 9: Eval results *****
2023-04-22 16:00:12,792 - Detection -   best_eval_score = 81.42
2023-04-22 16:00:12,792 - Detection -   eval_score = 81.74
2023-04-22 16:00:12,792 - Detection -   train_loss = 0.941697944613064
2023-04-22 16:00:47,277 - Detection - ***** Epoch: 10: Eval results *****
2023-04-22 16:00:47,277 - Detection -   best_eval_score = 81.74
2023-04-22 16:00:47,277 - Detection -   eval_score = 81.28
2023-04-22 16:00:47,277 - Detection -   train_loss = 0.857044987818774
2023-04-22 16:01:21,536 - Detection - ***** Epoch: 11: Eval results *****
2023-04-22 16:01:21,536 - Detection -   best_eval_score = 81.74
2023-04-22 16:01:21,536 - Detection -   eval_score = 81.33
2023-04-22 16:01:21,536 - Detection -   train_loss = 0.7690877423566931
2023-04-22 16:01:55,745 - Detection - ***** Epoch: 12: Eval results *****
2023-04-22 16:01:55,746 - Detection -   best_eval_score = 81.74
2023-04-22 16:01:55,746 - Detection -   eval_score = 81.21
2023-04-22 16:01:55,746 - Detection -   train_loss = 0.6969480198972365
2023-04-22 16:02:29,725 - Detection - ***** Epoch: 13: Eval results *****
2023-04-22 16:02:29,725 - Detection -   best_eval_score = 81.74
2023-04-22 16:02:29,725 - Detection -   eval_score = 80.96
2023-04-22 16:02:29,725 - Detection -   train_loss = 0.6418345360194936
2023-04-22 16:03:03,900 - Detection - ***** Epoch: 14: Eval results *****
2023-04-22 16:03:03,900 - Detection -   best_eval_score = 81.74
2023-04-22 16:03:03,900 - Detection -   eval_score = 80.67
2023-04-22 16:03:03,900 - Detection -   train_loss = 0.6070428350392509
2023-04-22 16:03:37,796 - Detection - ***** Epoch: 15: Eval results *****
2023-04-22 16:03:37,796 - Detection -   best_eval_score = 81.74
2023-04-22 16:03:37,796 - Detection -   eval_score = 80.75
2023-04-22 16:03:37,796 - Detection -   train_loss = 0.5569868683815002
2023-04-22 16:04:11,954 - Detection - ***** Epoch: 16: Eval results *****
2023-04-22 16:04:11,954 - Detection -   best_eval_score = 81.74
2023-04-22 16:04:11,954 - Detection -   eval_score = 80.8
2023-04-22 16:04:11,954 - Detection -   train_loss = 0.5325619034907397
2023-04-22 16:04:46,135 - Detection - ***** Epoch: 17: Eval results *****
2023-04-22 16:04:46,135 - Detection -   best_eval_score = 81.74
2023-04-22 16:04:46,135 - Detection -   eval_score = 80.27
2023-04-22 16:04:46,135 - Detection -   train_loss = 0.5083580350174624
2023-04-22 16:05:20,096 - Detection - ***** Epoch: 18: Eval results *****
2023-04-22 16:05:20,096 - Detection -   best_eval_score = 81.74
2023-04-22 16:05:20,096 - Detection -   eval_score = 80.28
2023-04-22 16:05:20,096 - Detection -   train_loss = 0.47411173757384806
2023-04-22 16:05:54,313 - Detection - ***** Epoch: 19: Eval results *****
2023-04-22 16:05:54,313 - Detection -   best_eval_score = 81.74
2023-04-22 16:05:54,313 - Detection -   eval_score = 80.64
2023-04-22 16:05:54,313 - Detection -   train_loss = 0.45805254052667055
2023-04-22 16:05:54,314 - Detection - Pre-training finished...
2023-04-22 16:05:54,314 - Detection - Training Begin...
2023-04-22 16:05:57,195 - Detection - ***** Epoch: 1: Eval results *****
2023-04-22 16:05:57,195 - Detection -   best_eval_score = 0
2023-04-22 16:05:57,195 - Detection -   eval_score = 0.0
2023-04-22 16:05:57,195 - Detection -   train_loss = 4.322218782761517
2023-04-22 16:06:00,085 - Detection - ***** Epoch: 2: Eval results *****
2023-04-22 16:06:00,085 - Detection -   best_eval_score = 0
2023-04-22 16:06:00,085 - Detection -   eval_score = 0.68
2023-04-22 16:06:00,085 - Detection -   train_loss = 3.762898992089664
2023-04-22 16:06:32,321 - Detection - ***** Epoch: 3: Eval results *****
2023-04-22 16:06:32,321 - Detection -   best_eval_score = 0.68
2023-04-22 16:06:32,321 - Detection -   eval_score = 72.99
2023-04-22 16:06:32,321 - Detection -   train_loss = 3.030462952221141
2023-04-22 16:07:04,238 - Detection - ***** Epoch: 4: Eval results *****
2023-04-22 16:07:04,238 - Detection -   best_eval_score = 72.99
2023-04-22 16:07:04,238 - Detection -   eval_score = 72.37
2023-04-22 16:07:04,238 - Detection -   train_loss = 0.9899287995170144
2023-04-22 16:07:36,802 - Detection - ***** Epoch: 5: Eval results *****
2023-04-22 16:07:36,802 - Detection -   best_eval_score = 72.99
2023-04-22 16:07:36,802 - Detection -   eval_score = 72.16
2023-04-22 16:07:36,802 - Detection -   train_loss = 1.0020845532417297
2023-04-22 16:08:09,788 - Detection - ***** Epoch: 6: Eval results *****
2023-04-22 16:08:09,788 - Detection -   best_eval_score = 72.99
2023-04-22 16:08:09,788 - Detection -   eval_score = 72.61
2023-04-22 16:08:09,788 - Detection -   train_loss = 0.9869445316931781
2023-04-22 16:08:42,591 - Detection - ***** Epoch: 7: Eval results *****
2023-04-22 16:08:42,591 - Detection -   best_eval_score = 72.99
2023-04-22 16:08:42,591 - Detection -   eval_score = 73.1
2023-04-22 16:08:42,591 - Detection -   train_loss = 0.9917255569906795
2023-04-22 16:09:14,626 - Detection - ***** Epoch: 8: Eval results *****
2023-04-22 16:09:14,626 - Detection -   best_eval_score = 73.1
2023-04-22 16:09:14,626 - Detection -   eval_score = 72.94
2023-04-22 16:09:14,626 - Detection -   train_loss = 0.9840908892014447
2023-04-22 16:09:46,651 - Detection - ***** Epoch: 9: Eval results *****
2023-04-22 16:09:46,651 - Detection -   best_eval_score = 73.1
2023-04-22 16:09:46,651 - Detection -   eval_score = 72.61
2023-04-22 16:09:46,651 - Detection -   train_loss = 0.9849525619955624
2023-04-22 16:10:18,728 - Detection - ***** Epoch: 10: Eval results *****
2023-04-22 16:10:18,728 - Detection -   best_eval_score = 73.1
2023-04-22 16:10:18,728 - Detection -   eval_score = 72.78
2023-04-22 16:10:18,728 - Detection -   train_loss = 0.9723472419907065
2023-04-22 16:10:50,676 - Detection - ***** Epoch: 11: Eval results *****
2023-04-22 16:10:50,677 - Detection -   best_eval_score = 73.1
2023-04-22 16:10:50,677 - Detection -   eval_score = 73.32
2023-04-22 16:10:50,677 - Detection -   train_loss = 0.9693515090381398
2023-04-22 16:11:22,619 - Detection - ***** Epoch: 12: Eval results *****
2023-04-22 16:11:22,619 - Detection -   best_eval_score = 73.32
2023-04-22 16:11:22,619 - Detection -   eval_score = 72.83
2023-04-22 16:11:22,620 - Detection -   train_loss = 0.9697117034126731
2023-04-22 16:11:54,641 - Detection - ***** Epoch: 13: Eval results *****
2023-04-22 16:11:54,641 - Detection -   best_eval_score = 73.32
2023-04-22 16:11:54,641 - Detection -   eval_score = 72.37
2023-04-22 16:11:54,641 - Detection -   train_loss = 0.994071364402771
2023-04-22 16:12:26,571 - Detection - ***** Epoch: 14: Eval results *****
2023-04-22 16:12:26,571 - Detection -   best_eval_score = 73.32
2023-04-22 16:12:26,571 - Detection -   eval_score = 71.55
2023-04-22 16:12:26,571 - Detection -   train_loss = 0.9826347126680262
2023-04-22 16:12:58,686 - Detection - ***** Epoch: 15: Eval results *****
2023-04-22 16:12:58,686 - Detection -   best_eval_score = 73.32
2023-04-22 16:12:58,686 - Detection -   eval_score = 72.89
2023-04-22 16:12:58,686 - Detection -   train_loss = 1.0033689141273499
2023-04-22 16:13:30,713 - Detection - ***** Epoch: 16: Eval results *****
2023-04-22 16:13:30,714 - Detection -   best_eval_score = 73.32
2023-04-22 16:13:30,714 - Detection -   eval_score = 73.03
2023-04-22 16:13:30,714 - Detection -   train_loss = 0.9918655227212345
2023-04-22 16:14:02,624 - Detection - ***** Epoch: 17: Eval results *****
2023-04-22 16:14:02,624 - Detection -   best_eval_score = 73.32
2023-04-22 16:14:02,624 - Detection -   eval_score = 72.48
2023-04-22 16:14:02,624 - Detection -   train_loss = 1.0031058753238005
2023-04-22 16:14:34,922 - Detection - ***** Epoch: 18: Eval results *****
2023-04-22 16:14:34,922 - Detection -   best_eval_score = 73.32
2023-04-22 16:14:34,922 - Detection -   eval_score = 72.72
2023-04-22 16:14:34,922 - Detection -   train_loss = 0.9832653753897723
2023-04-22 16:15:06,844 - Detection - ***** Epoch: 19: Eval results *****
2023-04-22 16:15:06,844 - Detection -   best_eval_score = 73.32
2023-04-22 16:15:06,844 - Detection -   eval_score = 72.68
2023-04-22 16:15:06,844 - Detection -   train_loss = 0.9916748369441313
2023-04-22 16:15:38,901 - Detection - ***** Epoch: 20: Eval results *****
2023-04-22 16:15:38,901 - Detection -   best_eval_score = 73.32
2023-04-22 16:15:38,901 - Detection -   eval_score = 72.81
2023-04-22 16:15:38,901 - Detection -   train_loss = 0.9954420889125151
2023-04-22 16:16:10,838 - Detection - ***** Epoch: 21: Eval results *****
2023-04-22 16:16:10,839 - Detection -   best_eval_score = 73.32
2023-04-22 16:16:10,839 - Detection -   eval_score = 72.15
2023-04-22 16:16:10,839 - Detection -   train_loss = 0.9708042705760282
2023-04-22 16:16:10,839 - Detection - Training Finished...
2023-04-22 16:16:10,839 - Detection - Testing begin...
2023-04-22 16:16:13,257 - Detection - ***** Test: Confusion Matrix *****
2023-04-22 16:16:13,257 - Detection - [[114   0   0   0   0   4   1   0   0   0   1   0   0   1   0  16]
 [  0  81   0   2   3   3   0   0  19   1   4   0   0   0   0  48]
 [  0   6  46   1   0   1   1   0   9   1   5   0   0   0   0  36]
 [  0   1   0  68   0   0   0   0   2   0   1   0   0   0   0  50]
 [  0   3   0   2 155   0   0   0   3   0   1   0   0   0   0   8]
 [  1   1   0   2   0  99   0   0   0   0   4   0   0   0   0  21]
 [  2   0   0   0   0   5 104   0   1   0   3   0   0   0   0  45]
 [  0   2   2   0   0   1   0 118   6   0   1   0   0   0   0  19]
 [  0  24   0   1   2   3   0   1 130   1   0   0   0   0   0  31]
 [  0   0   0   4   0   2   0   0   0 100   3   0   0   0   0  18]
 [  0   0   4   0   0   1   1   0   2   0 136   0   0   0   0  27]
 [  0   5   0   1   0   0   0   0   1   0   0 135   0   0   0  22]
 [  0   1   0   1   1   0   0   0   0   0   6   0 104   0   0  19]
 [  0   7   0   7   0   3   1   0   7   0   1   1   0  64   0  48]
 [  0   0   0   2   0   0   0   0   1   0   0   0   0   0 113  35]
 [  2  23  20  83   0   9  24   2  34  13  11   1   0   3  45 423]]
2023-04-22 16:16:13,257 - Detection - ***** Test results *****
2023-04-22 16:16:13,257 - Detection -   Acc = 68.5
2023-04-22 16:16:13,257 - Detection -   F1 = 72.3482
2023-04-22 16:16:13,258 - Detection -   F1-known = 73.5537
2023-04-22 16:16:13,258 - Detection -   F1-open = 54.2656
2023-04-22 16:16:13,258 - Detection - Testing finished...
2023-04-22 16:16:13,258 - Detection - Results saved in results/results_DA-ADB-BOOST.csv
2023-04-22 16:16:13,276 - Detection - Open Intent Detection Finished...
