2023-04-20 15:22:21,122 - Detection - Open Intent Detection Begin...
2023-04-20 15:22:21,122 - Detection - Parameters Initialization...
2023-04-20 15:22:21,122 - Detection - ============================== Params ==============================
2023-04-20 15:22:21,122 - Detection - type:	open_intent_detection
2023-04-20 15:22:21,122 - Detection - logger_name:	Detection
2023-04-20 15:22:21,122 - Detection - log_dir:	logs
2023-04-20 15:22:21,122 - Detection - dataset:	banking_cg
2023-04-20 15:22:21,122 - Detection - known_cls_ratio:	0.75
2023-04-20 15:22:21,122 - Detection - labeled_ratio:	1.0
2023-04-20 15:22:21,122 - Detection - method:	ADB
2023-04-20 15:22:21,122 - Detection - train:	True
2023-04-20 15:22:21,122 - Detection - pretrain:	True
2023-04-20 15:22:21,122 - Detection - save_model:	True
2023-04-20 15:22:21,122 - Detection - backbone:	bert
2023-04-20 15:22:21,122 - Detection - config_file_name:	ADB
2023-04-20 15:22:21,122 - Detection - seed:	7
2023-04-20 15:22:21,122 - Detection - gpu_id:	0
2023-04-20 15:22:21,122 - Detection - pipe_results_path:	pipe_results
2023-04-20 15:22:21,122 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-20 15:22:21,122 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-20 15:22:21,122 - Detection - model_dir:	models
2023-04-20 15:22:21,122 - Detection - load_pretrained_method:	None
2023-04-20 15:22:21,122 - Detection - result_dir:	results
2023-04-20 15:22:21,123 - Detection - results_file_name:	results_ADB.csv
2023-04-20 15:22:21,123 - Detection - save_results:	True
2023-04-20 15:22:21,123 - Detection - loss_fct:	CrossEntropyLoss
2023-04-20 15:22:21,123 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.75_1.0_bert_7
2023-04-20 15:22:21,123 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.75_1.0_bert_7/models
2023-04-20 15:22:21,123 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-20 15:22:21,123 - Detection - num_train_epochs:	100
2023-04-20 15:22:21,123 - Detection - num_labels:	None
2023-04-20 15:22:21,123 - Detection - max_seq_length:	None
2023-04-20 15:22:21,123 - Detection - freeze_backbone_parameters:	True
2023-04-20 15:22:21,123 - Detection - feat_dim:	768
2023-04-20 15:22:21,123 - Detection - warmup_proportion:	0.1
2023-04-20 15:22:21,123 - Detection - lr_boundary:	0.05
2023-04-20 15:22:21,123 - Detection - lr:	2e-05
2023-04-20 15:22:21,123 - Detection - activation:	relu
2023-04-20 15:22:21,123 - Detection - train_batch_size:	128
2023-04-20 15:22:21,123 - Detection - eval_batch_size:	64
2023-04-20 15:22:21,123 - Detection - test_batch_size:	64
2023-04-20 15:22:21,123 - Detection - wait_patient:	10
2023-04-20 15:22:21,123 - Detection - ============================== End Params ==============================
2023-04-20 15:22:21,123 - Detection - Data and Model Preparation...
2023-04-20 15:22:21,123 - Detection - The number of known intents is 58
2023-04-20 15:22:21,124 - Detection - Lists of known labels are: ['supported_cards_and_currencies', 'failed_transfer', 'top_up_failed', 'card_payment_not_recognised', 'getting_virtual_card', 'card_arrival', 'declined_cash_withdrawal', 'card_not_working', 'getting_spare_card', 'age_limit', 'fiat_currency_support', 'card_delivery_estimate', 'top_up_limits', 'disposable_card_limits', 'request_refund', 'top_up_reverted', 'card_payment_wrong_exchange_rate', 'change_pin', 'cash_withdrawal_charge', 'why_verify_identity', 'transfer_not_received_by_recipient', 'lost_or_stolen_phone', 'pending_card_payment', 'cash_withdrawal_not_recognised', 'pin_blocked', 'declined_card_payment', 'exchange_charge', 'exchange_rate', 'wrong_exchange_rate_for_cash_withdrawal', 'wrong_amount_of_cash_received', 'passcode_forgotten', 'card_about_to_expire', 'top_up_by_bank_transfer_charge', 'transfer_fee_charged', 'declined_transfer', 'direct_debit_payment_not_recognised', 'edit_personal_details', 'card_payment_fee_charged', 'receiving_money', 'activate_my_card', 'verify_top_up', 'visa_or_mastercard', 'apple_pay_or_google_pay', 'extra_charge_on_statement', 'verify_my_identity', 'pending_transfer', 'atm_support', 'get_disposable_virtual_card', 'verify_source_of_funds', 'cancel_transfer', 'exchange_via_app', 'topping_up_by_card', 'transfer_into_account', 'reverted_card_payment?', 'contactless_not_working', 'automatic_top_up', 'transaction_charged_twice', 'card_swallowed']
2023-04-20 15:22:21,134 - Detection - Number of labeled training samples = 2178
2023-04-20 15:22:21,134 - Detection - Number of unlabeled training samples = 595
2023-04-20 15:22:21,136 - Detection - Number of evaluation samples = 630
2023-04-20 15:22:21,141 - Detection - Number of testing samples = 1896
2023-04-20 15:22:25,222 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-20 15:22:26,932 - Detection - Pre-training Begin...
2023-04-20 15:22:30,745 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 15:22:30,745 - Detection -   best_eval_score = 0
2023-04-20 15:22:30,745 - Detection -   eval_score = 3.65
2023-04-20 15:22:30,745 - Detection -   train_loss = 4.065650092230903
2023-04-20 15:22:34,019 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 15:22:34,019 - Detection -   best_eval_score = 3.65
2023-04-20 15:22:34,019 - Detection -   eval_score = 1.9
2023-04-20 15:22:34,019 - Detection -   train_loss = 4.046448495652941
2023-04-20 15:22:37,356 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 15:22:37,356 - Detection -   best_eval_score = 3.65
2023-04-20 15:22:37,356 - Detection -   eval_score = 1.43
2023-04-20 15:22:37,356 - Detection -   train_loss = 4.018512037065294
2023-04-20 15:22:40,623 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 15:22:40,623 - Detection -   best_eval_score = 3.65
2023-04-20 15:22:40,623 - Detection -   eval_score = 1.75
2023-04-20 15:22:40,623 - Detection -   train_loss = 3.966647889879015
2023-04-20 15:22:43,904 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 15:22:43,904 - Detection -   best_eval_score = 3.65
2023-04-20 15:22:43,904 - Detection -   eval_score = 1.75
2023-04-20 15:22:43,904 - Detection -   train_loss = 3.927211708492703
2023-04-20 15:22:47,224 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 15:22:47,224 - Detection -   best_eval_score = 3.65
2023-04-20 15:22:47,224 - Detection -   eval_score = 3.97
2023-04-20 15:22:47,224 - Detection -   train_loss = 3.8242511086993747
2023-04-20 15:22:50,623 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 15:22:50,623 - Detection -   best_eval_score = 3.97
2023-04-20 15:22:50,623 - Detection -   eval_score = 9.84
2023-04-20 15:22:50,623 - Detection -   train_loss = 3.646499594052633
2023-04-20 15:22:54,036 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 15:22:54,037 - Detection -   best_eval_score = 9.84
2023-04-20 15:22:54,037 - Detection -   eval_score = 14.92
2023-04-20 15:22:54,037 - Detection -   train_loss = 3.410093148549398
2023-04-20 15:22:57,502 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 15:22:57,502 - Detection -   best_eval_score = 14.92
2023-04-20 15:22:57,502 - Detection -   eval_score = 20.63
2023-04-20 15:22:57,502 - Detection -   train_loss = 3.0604186521636114
2023-04-20 15:23:01,021 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 15:23:01,021 - Detection -   best_eval_score = 20.63
2023-04-20 15:23:01,021 - Detection -   eval_score = 26.03
2023-04-20 15:23:01,021 - Detection -   train_loss = 2.8282564216189914
2023-04-20 15:23:04,513 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 15:23:04,513 - Detection -   best_eval_score = 26.03
2023-04-20 15:23:04,513 - Detection -   eval_score = 30.48
2023-04-20 15:23:04,513 - Detection -   train_loss = 2.546831488609314
2023-04-20 15:23:08,073 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 15:23:08,073 - Detection -   best_eval_score = 30.48
2023-04-20 15:23:08,074 - Detection -   eval_score = 36.51
2023-04-20 15:23:08,074 - Detection -   train_loss = 2.333202693197462
2023-04-20 15:23:11,548 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 15:23:11,548 - Detection -   best_eval_score = 36.51
2023-04-20 15:23:11,548 - Detection -   eval_score = 43.02
2023-04-20 15:23:11,548 - Detection -   train_loss = 2.05785831477907
2023-04-20 15:23:15,030 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 15:23:15,030 - Detection -   best_eval_score = 43.02
2023-04-20 15:23:15,030 - Detection -   eval_score = 42.06
2023-04-20 15:23:15,030 - Detection -   train_loss = 1.8660579456223383
2023-04-20 15:23:18,507 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 15:23:18,507 - Detection -   best_eval_score = 43.02
2023-04-20 15:23:18,507 - Detection -   eval_score = 47.94
2023-04-20 15:23:18,507 - Detection -   train_loss = 1.6905213925573561
2023-04-20 15:23:21,995 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 15:23:21,995 - Detection -   best_eval_score = 47.94
2023-04-20 15:23:21,995 - Detection -   eval_score = 52.86
2023-04-20 15:23:21,995 - Detection -   train_loss = 1.5699209835794237
2023-04-20 15:23:25,483 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 15:23:25,484 - Detection -   best_eval_score = 52.86
2023-04-20 15:23:25,484 - Detection -   eval_score = 53.49
2023-04-20 15:23:25,484 - Detection -   train_loss = 1.4360197815630171
2023-04-20 15:23:28,972 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 15:23:28,972 - Detection -   best_eval_score = 53.49
2023-04-20 15:23:28,972 - Detection -   eval_score = 56.98
2023-04-20 15:23:28,972 - Detection -   train_loss = 1.3943704631593492
2023-04-20 15:23:32,465 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 15:23:32,465 - Detection -   best_eval_score = 56.98
2023-04-20 15:23:32,465 - Detection -   eval_score = 59.68
2023-04-20 15:23:32,465 - Detection -   train_loss = 1.2165558205710516
2023-04-20 15:23:35,962 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 15:23:35,962 - Detection -   best_eval_score = 59.68
2023-04-20 15:23:35,962 - Detection -   eval_score = 60.16
2023-04-20 15:23:35,962 - Detection -   train_loss = 1.2251059148046706
2023-04-20 15:23:39,479 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 15:23:39,479 - Detection -   best_eval_score = 60.16
2023-04-20 15:23:39,479 - Detection -   eval_score = 61.27
2023-04-20 15:23:39,479 - Detection -   train_loss = 1.0983602934413486
2023-04-20 15:23:42,986 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 15:23:42,987 - Detection -   best_eval_score = 61.27
2023-04-20 15:23:42,987 - Detection -   eval_score = 62.54
2023-04-20 15:23:42,987 - Detection -   train_loss = 1.0256451335218217
2023-04-20 15:23:46,493 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 15:23:46,493 - Detection -   best_eval_score = 62.54
2023-04-20 15:23:46,493 - Detection -   eval_score = 63.65
2023-04-20 15:23:46,493 - Detection -   train_loss = 1.0154067973295848
2023-04-20 15:23:49,982 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 15:23:49,982 - Detection -   best_eval_score = 63.65
2023-04-20 15:23:49,982 - Detection -   eval_score = 64.6
2023-04-20 15:23:49,982 - Detection -   train_loss = 0.9298495716518826
2023-04-20 15:23:53,478 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 15:23:53,478 - Detection -   best_eval_score = 64.6
2023-04-20 15:23:53,478 - Detection -   eval_score = 65.4
2023-04-20 15:23:53,478 - Detection -   train_loss = 0.8800031344095866
2023-04-20 15:23:56,969 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 15:23:56,969 - Detection -   best_eval_score = 65.4
2023-04-20 15:23:56,969 - Detection -   eval_score = 65.87
2023-04-20 15:23:56,969 - Detection -   train_loss = 0.8905584149890475
2023-04-20 15:24:00,464 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 15:24:00,464 - Detection -   best_eval_score = 65.87
2023-04-20 15:24:00,464 - Detection -   eval_score = 66.67
2023-04-20 15:24:00,464 - Detection -   train_loss = 0.833862284819285
2023-04-20 15:24:03,946 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 15:24:03,946 - Detection -   best_eval_score = 66.67
2023-04-20 15:24:03,946 - Detection -   eval_score = 67.3
2023-04-20 15:24:03,946 - Detection -   train_loss = 0.8081791069772508
2023-04-20 15:24:07,439 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 15:24:07,439 - Detection -   best_eval_score = 67.3
2023-04-20 15:24:07,439 - Detection -   eval_score = 67.3
2023-04-20 15:24:07,439 - Detection -   train_loss = 0.7451173133320279
2023-04-20 15:24:10,912 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 15:24:10,912 - Detection -   best_eval_score = 67.3
2023-04-20 15:24:10,912 - Detection -   eval_score = 67.94
2023-04-20 15:24:10,912 - Detection -   train_loss = 0.7853008144431644
2023-04-20 15:24:14,390 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 15:24:14,390 - Detection -   best_eval_score = 67.94
2023-04-20 15:24:14,390 - Detection -   eval_score = 68.73
2023-04-20 15:24:14,390 - Detection -   train_loss = 0.7368616527981229
2023-04-20 15:24:17,868 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 15:24:17,868 - Detection -   best_eval_score = 68.73
2023-04-20 15:24:17,868 - Detection -   eval_score = 69.37
2023-04-20 15:24:17,868 - Detection -   train_loss = 0.6629769330223402
2023-04-20 15:24:21,346 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 15:24:21,346 - Detection -   best_eval_score = 69.37
2023-04-20 15:24:21,346 - Detection -   eval_score = 69.05
2023-04-20 15:24:21,346 - Detection -   train_loss = 0.6834213899241554
2023-04-20 15:24:24,820 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 15:24:24,820 - Detection -   best_eval_score = 69.37
2023-04-20 15:24:24,820 - Detection -   eval_score = 69.68
2023-04-20 15:24:24,820 - Detection -   train_loss = 0.6718945105870565
2023-04-20 15:24:28,308 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 15:24:28,308 - Detection -   best_eval_score = 69.68
2023-04-20 15:24:28,308 - Detection -   eval_score = 70.16
2023-04-20 15:24:28,308 - Detection -   train_loss = 0.6416385339366065
2023-04-20 15:24:31,879 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 15:24:31,879 - Detection -   best_eval_score = 70.16
2023-04-20 15:24:31,879 - Detection -   eval_score = 70.79
2023-04-20 15:24:31,879 - Detection -   train_loss = 0.6226675344838036
2023-04-20 15:24:35,355 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 15:24:35,355 - Detection -   best_eval_score = 70.79
2023-04-20 15:24:35,356 - Detection -   eval_score = 71.43
2023-04-20 15:24:35,356 - Detection -   train_loss = 0.576802541812261
2023-04-20 15:24:38,895 - Detection - ***** Epoch: 38: Eval results *****
2023-04-20 15:24:38,895 - Detection -   best_eval_score = 71.43
2023-04-20 15:24:38,895 - Detection -   eval_score = 70.79
2023-04-20 15:24:38,895 - Detection -   train_loss = 0.6103794276714325
2023-04-20 15:24:42,451 - Detection - ***** Epoch: 39: Eval results *****
2023-04-20 15:24:42,451 - Detection -   best_eval_score = 71.43
2023-04-20 15:24:42,451 - Detection -   eval_score = 70.63
2023-04-20 15:24:42,451 - Detection -   train_loss = 0.6019331481721666
2023-04-20 15:24:45,967 - Detection - ***** Epoch: 40: Eval results *****
2023-04-20 15:24:45,968 - Detection -   best_eval_score = 71.43
2023-04-20 15:24:45,968 - Detection -   eval_score = 71.27
2023-04-20 15:24:45,968 - Detection -   train_loss = 0.5828308910131454
2023-04-20 15:24:49,500 - Detection - ***** Epoch: 41: Eval results *****
2023-04-20 15:24:49,500 - Detection -   best_eval_score = 71.43
2023-04-20 15:24:49,500 - Detection -   eval_score = 71.27
2023-04-20 15:24:49,500 - Detection -   train_loss = 0.5283774203724332
2023-04-20 15:24:52,973 - Detection - ***** Epoch: 42: Eval results *****
2023-04-20 15:24:52,973 - Detection -   best_eval_score = 71.43
2023-04-20 15:24:52,973 - Detection -   eval_score = 71.11
2023-04-20 15:24:52,973 - Detection -   train_loss = 0.5213235865036646
2023-04-20 15:24:56,542 - Detection - ***** Epoch: 43: Eval results *****
2023-04-20 15:24:56,542 - Detection -   best_eval_score = 71.43
2023-04-20 15:24:56,542 - Detection -   eval_score = 71.75
2023-04-20 15:24:56,542 - Detection -   train_loss = 0.49829815493689644
2023-04-20 15:25:00,145 - Detection - ***** Epoch: 44: Eval results *****
2023-04-20 15:25:00,145 - Detection -   best_eval_score = 71.75
2023-04-20 15:25:00,146 - Detection -   eval_score = 71.43
2023-04-20 15:25:00,146 - Detection -   train_loss = 0.5036898404359818
2023-04-20 15:25:03,738 - Detection - ***** Epoch: 45: Eval results *****
2023-04-20 15:25:03,738 - Detection -   best_eval_score = 71.75
2023-04-20 15:25:03,738 - Detection -   eval_score = 71.11
2023-04-20 15:25:03,738 - Detection -   train_loss = 0.4843585027588738
2023-04-20 15:25:07,339 - Detection - ***** Epoch: 46: Eval results *****
2023-04-20 15:25:07,339 - Detection -   best_eval_score = 71.75
2023-04-20 15:25:07,339 - Detection -   eval_score = 71.11
2023-04-20 15:25:07,339 - Detection -   train_loss = 0.4725577872660425
2023-04-20 15:25:10,946 - Detection - ***** Epoch: 47: Eval results *****
2023-04-20 15:25:10,947 - Detection -   best_eval_score = 71.75
2023-04-20 15:25:10,947 - Detection -   eval_score = 71.75
2023-04-20 15:25:10,947 - Detection -   train_loss = 0.47130157550175983
2023-04-20 15:25:14,548 - Detection - ***** Epoch: 48: Eval results *****
2023-04-20 15:25:14,548 - Detection -   best_eval_score = 71.75
2023-04-20 15:25:14,548 - Detection -   eval_score = 71.75
2023-04-20 15:25:14,548 - Detection -   train_loss = 0.45814332862695056
2023-04-20 15:25:18,045 - Detection - ***** Epoch: 49: Eval results *****
2023-04-20 15:25:18,045 - Detection -   best_eval_score = 71.75
2023-04-20 15:25:18,045 - Detection -   eval_score = 71.9
2023-04-20 15:25:18,045 - Detection -   train_loss = 0.46142522825135124
2023-04-20 15:25:21,555 - Detection - ***** Epoch: 50: Eval results *****
2023-04-20 15:25:21,555 - Detection -   best_eval_score = 71.9
2023-04-20 15:25:21,555 - Detection -   eval_score = 71.59
2023-04-20 15:25:21,555 - Detection -   train_loss = 0.474920897020234
2023-04-20 15:25:25,003 - Detection - ***** Epoch: 51: Eval results *****
2023-04-20 15:25:25,003 - Detection -   best_eval_score = 71.9
2023-04-20 15:25:25,003 - Detection -   eval_score = 71.9
2023-04-20 15:25:25,003 - Detection -   train_loss = 0.48584458066357505
2023-04-20 15:25:28,613 - Detection - ***** Epoch: 52: Eval results *****
2023-04-20 15:25:28,613 - Detection -   best_eval_score = 71.9
2023-04-20 15:25:28,613 - Detection -   eval_score = 71.59
2023-04-20 15:25:28,613 - Detection -   train_loss = 0.43849509457747143
2023-04-20 15:25:32,102 - Detection - ***** Epoch: 53: Eval results *****
2023-04-20 15:25:32,102 - Detection -   best_eval_score = 71.9
2023-04-20 15:25:32,102 - Detection -   eval_score = 72.22
2023-04-20 15:25:32,102 - Detection -   train_loss = 0.43229080239931744
2023-04-20 15:25:35,708 - Detection - ***** Epoch: 54: Eval results *****
2023-04-20 15:25:35,708 - Detection -   best_eval_score = 72.22
2023-04-20 15:25:35,708 - Detection -   eval_score = 72.22
2023-04-20 15:25:35,708 - Detection -   train_loss = 0.4150922546784083
2023-04-20 15:25:39,372 - Detection - ***** Epoch: 55: Eval results *****
2023-04-20 15:25:39,372 - Detection -   best_eval_score = 72.22
2023-04-20 15:25:39,373 - Detection -   eval_score = 72.22
2023-04-20 15:25:39,373 - Detection -   train_loss = 0.4081685882475641
2023-04-20 15:25:42,822 - Detection - ***** Epoch: 56: Eval results *****
2023-04-20 15:25:42,822 - Detection -   best_eval_score = 72.22
2023-04-20 15:25:42,822 - Detection -   eval_score = 72.54
2023-04-20 15:25:42,822 - Detection -   train_loss = 0.41072390642431045
2023-04-20 15:25:46,276 - Detection - ***** Epoch: 57: Eval results *****
2023-04-20 15:25:46,276 - Detection -   best_eval_score = 72.54
2023-04-20 15:25:46,276 - Detection -   eval_score = 72.06
2023-04-20 15:25:46,276 - Detection -   train_loss = 0.399358203013738
2023-04-20 15:25:49,716 - Detection - ***** Epoch: 58: Eval results *****
2023-04-20 15:25:49,716 - Detection -   best_eval_score = 72.54
2023-04-20 15:25:49,716 - Detection -   eval_score = 72.38
2023-04-20 15:25:49,716 - Detection -   train_loss = 0.4062691777944565
2023-04-20 15:25:53,195 - Detection - ***** Epoch: 59: Eval results *****
2023-04-20 15:25:53,195 - Detection -   best_eval_score = 72.54
2023-04-20 15:25:53,195 - Detection -   eval_score = 72.7
2023-04-20 15:25:53,195 - Detection -   train_loss = 0.3834804946349727
2023-04-20 15:25:56,684 - Detection - ***** Epoch: 60: Eval results *****
2023-04-20 15:25:56,685 - Detection -   best_eval_score = 72.7
2023-04-20 15:25:56,685 - Detection -   eval_score = 72.22
2023-04-20 15:25:56,685 - Detection -   train_loss = 0.402864212791125
2023-04-20 15:26:00,138 - Detection - ***** Epoch: 61: Eval results *****
2023-04-20 15:26:00,138 - Detection -   best_eval_score = 72.7
2023-04-20 15:26:00,138 - Detection -   eval_score = 72.54
2023-04-20 15:26:00,138 - Detection -   train_loss = 0.37298540936575997
2023-04-20 15:26:03,594 - Detection - ***** Epoch: 62: Eval results *****
2023-04-20 15:26:03,594 - Detection -   best_eval_score = 72.7
2023-04-20 15:26:03,594 - Detection -   eval_score = 72.06
2023-04-20 15:26:03,594 - Detection -   train_loss = 0.4082029081053204
2023-04-20 15:26:07,065 - Detection - ***** Epoch: 63: Eval results *****
2023-04-20 15:26:07,065 - Detection -   best_eval_score = 72.7
2023-04-20 15:26:07,065 - Detection -   eval_score = 72.38
2023-04-20 15:26:07,065 - Detection -   train_loss = 0.3716821223497391
2023-04-20 15:26:10,513 - Detection - ***** Epoch: 64: Eval results *****
2023-04-20 15:26:10,513 - Detection -   best_eval_score = 72.7
2023-04-20 15:26:10,513 - Detection -   eval_score = 72.38
2023-04-20 15:26:10,513 - Detection -   train_loss = 0.3622691192560726
2023-04-20 15:26:13,963 - Detection - ***** Epoch: 65: Eval results *****
2023-04-20 15:26:13,963 - Detection -   best_eval_score = 72.7
2023-04-20 15:26:13,963 - Detection -   eval_score = 72.54
2023-04-20 15:26:13,963 - Detection -   train_loss = 0.3767894092533324
2023-04-20 15:26:17,455 - Detection - ***** Epoch: 66: Eval results *****
2023-04-20 15:26:17,455 - Detection -   best_eval_score = 72.7
2023-04-20 15:26:17,455 - Detection -   eval_score = 72.54
2023-04-20 15:26:17,455 - Detection -   train_loss = 0.36987771921687657
2023-04-20 15:26:20,944 - Detection - ***** Epoch: 67: Eval results *****
2023-04-20 15:26:20,944 - Detection -   best_eval_score = 72.7
2023-04-20 15:26:20,944 - Detection -   eval_score = 72.06
2023-04-20 15:26:20,944 - Detection -   train_loss = 0.3596605600582229
2023-04-20 15:26:24,423 - Detection - ***** Epoch: 68: Eval results *****
2023-04-20 15:26:24,423 - Detection -   best_eval_score = 72.7
2023-04-20 15:26:24,424 - Detection -   eval_score = 71.9
2023-04-20 15:26:24,424 - Detection -   train_loss = 0.36719339258140987
2023-04-20 15:26:27,904 - Detection - ***** Epoch: 69: Eval results *****
2023-04-20 15:26:27,904 - Detection -   best_eval_score = 72.7
2023-04-20 15:26:27,904 - Detection -   eval_score = 72.7
2023-04-20 15:26:27,904 - Detection -   train_loss = 0.3798561559783088
2023-04-20 15:26:27,904 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.75_1.0_bert_7/models
2023-04-20 15:26:28,444 - Detection - Pre-training finished...
2023-04-20 15:26:28,445 - Detection - Training Begin...
2023-04-20 15:26:34,271 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 15:26:34,271 - Detection -   best_eval_score = 0
2023-04-20 15:26:34,271 - Detection -   eval_score = 0.0
2023-04-20 15:26:34,271 - Detection -   train_loss = 11.743928856319851
2023-04-20 15:26:37,697 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 15:26:37,697 - Detection -   best_eval_score = 0
2023-04-20 15:26:37,697 - Detection -   eval_score = 0.0
2023-04-20 15:26:37,697 - Detection -   train_loss = 11.522739993201363
2023-04-20 15:26:41,143 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 15:26:41,143 - Detection -   best_eval_score = 0
2023-04-20 15:26:41,143 - Detection -   eval_score = 0.0
2023-04-20 15:26:41,143 - Detection -   train_loss = 10.569760587480333
2023-04-20 15:26:44,590 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 15:26:44,590 - Detection -   best_eval_score = 0
2023-04-20 15:26:44,590 - Detection -   eval_score = 0.18
2023-04-20 15:26:44,590 - Detection -   train_loss = 10.020872328016493
2023-04-20 15:26:48,032 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 15:26:48,032 - Detection -   best_eval_score = 0.18
2023-04-20 15:26:48,032 - Detection -   eval_score = 0.62
2023-04-20 15:26:48,032 - Detection -   train_loss = 9.460751745435926
2023-04-20 15:26:51,466 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 15:26:51,467 - Detection -   best_eval_score = 0.62
2023-04-20 15:26:51,467 - Detection -   eval_score = 1.71
2023-04-20 15:26:51,467 - Detection -   train_loss = 8.588843186696371
2023-04-20 15:26:54,882 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 15:26:54,882 - Detection -   best_eval_score = 1.71
2023-04-20 15:26:54,882 - Detection -   eval_score = 5.22
2023-04-20 15:26:54,882 - Detection -   train_loss = 7.811509132385254
2023-04-20 15:26:58,309 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 15:26:58,309 - Detection -   best_eval_score = 5.22
2023-04-20 15:26:58,309 - Detection -   eval_score = 9.83
2023-04-20 15:26:58,309 - Detection -   train_loss = 7.004616075091892
2023-04-20 15:27:01,730 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 15:27:01,730 - Detection -   best_eval_score = 9.83
2023-04-20 15:27:01,730 - Detection -   eval_score = 17.51
2023-04-20 15:27:01,730 - Detection -   train_loss = 6.372441821628147
2023-04-20 15:27:05,148 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 15:27:05,148 - Detection -   best_eval_score = 17.51
2023-04-20 15:27:05,148 - Detection -   eval_score = 24.37
2023-04-20 15:27:05,148 - Detection -   train_loss = 5.693957328796387
2023-04-20 15:27:08,573 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 15:27:08,573 - Detection -   best_eval_score = 24.37
2023-04-20 15:27:08,573 - Detection -   eval_score = 31.84
2023-04-20 15:27:08,573 - Detection -   train_loss = 5.042128165562947
2023-04-20 15:27:11,979 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 15:27:11,979 - Detection -   best_eval_score = 31.84
2023-04-20 15:27:11,979 - Detection -   eval_score = 38.21
2023-04-20 15:27:11,979 - Detection -   train_loss = 4.306262294451396
2023-04-20 15:27:15,415 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 15:27:15,415 - Detection -   best_eval_score = 38.21
2023-04-20 15:27:15,415 - Detection -   eval_score = 43.67
2023-04-20 15:27:15,415 - Detection -   train_loss = 3.704952915509542
2023-04-20 15:27:18,898 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 15:27:18,898 - Detection -   best_eval_score = 43.67
2023-04-20 15:27:18,898 - Detection -   eval_score = 47.97
2023-04-20 15:27:18,898 - Detection -   train_loss = 3.1154015991422863
2023-04-20 15:27:22,454 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 15:27:22,454 - Detection -   best_eval_score = 47.97
2023-04-20 15:27:22,454 - Detection -   eval_score = 50.58
2023-04-20 15:27:22,454 - Detection -   train_loss = 2.708629568417867
2023-04-20 15:27:25,877 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 15:27:25,877 - Detection -   best_eval_score = 50.58
2023-04-20 15:27:25,877 - Detection -   eval_score = 53.2
2023-04-20 15:27:25,877 - Detection -   train_loss = 2.4532637198766074
2023-04-20 15:27:29,365 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 15:27:29,366 - Detection -   best_eval_score = 53.2
2023-04-20 15:27:29,366 - Detection -   eval_score = 55.34
2023-04-20 15:27:29,366 - Detection -   train_loss = 2.256117026011149
2023-04-20 15:27:32,816 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 15:27:32,817 - Detection -   best_eval_score = 55.34
2023-04-20 15:27:32,817 - Detection -   eval_score = 57.49
2023-04-20 15:27:32,817 - Detection -   train_loss = 2.0365314616097345
2023-04-20 15:27:36,280 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 15:27:36,280 - Detection -   best_eval_score = 57.49
2023-04-20 15:27:36,281 - Detection -   eval_score = 58.69
2023-04-20 15:27:36,281 - Detection -   train_loss = 1.8804926209979587
2023-04-20 15:27:39,698 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 15:27:39,699 - Detection -   best_eval_score = 58.69
2023-04-20 15:27:39,699 - Detection -   eval_score = 60.75
2023-04-20 15:27:39,699 - Detection -   train_loss = 1.7555320660273235
2023-04-20 15:27:43,145 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 15:27:43,146 - Detection -   best_eval_score = 60.75
2023-04-20 15:27:43,146 - Detection -   eval_score = 61.89
2023-04-20 15:27:43,146 - Detection -   train_loss = 1.7926974693934123
2023-04-20 15:27:46,651 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 15:27:46,651 - Detection -   best_eval_score = 61.89
2023-04-20 15:27:46,651 - Detection -   eval_score = 62.25
2023-04-20 15:27:46,651 - Detection -   train_loss = 1.6480213469929166
2023-04-20 15:27:50,079 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 15:27:50,079 - Detection -   best_eval_score = 62.25
2023-04-20 15:27:50,079 - Detection -   eval_score = 62.66
2023-04-20 15:27:50,079 - Detection -   train_loss = 1.6089288658565946
2023-04-20 15:27:53,508 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 15:27:53,508 - Detection -   best_eval_score = 62.66
2023-04-20 15:27:53,508 - Detection -   eval_score = 63.27
2023-04-20 15:27:53,508 - Detection -   train_loss = 1.4752623438835144
2023-04-20 15:27:56,930 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 15:27:56,930 - Detection -   best_eval_score = 63.27
2023-04-20 15:27:56,930 - Detection -   eval_score = 62.76
2023-04-20 15:27:56,931 - Detection -   train_loss = 1.4606972071859572
2023-04-20 15:28:00,347 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 15:28:00,347 - Detection -   best_eval_score = 63.27
2023-04-20 15:28:00,347 - Detection -   eval_score = 63.05
2023-04-20 15:28:00,347 - Detection -   train_loss = 1.5397862262196012
2023-04-20 15:28:03,755 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 15:28:03,756 - Detection -   best_eval_score = 63.27
2023-04-20 15:28:03,756 - Detection -   eval_score = 63.11
2023-04-20 15:28:03,756 - Detection -   train_loss = 1.5872851146592035
2023-04-20 15:28:07,162 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 15:28:07,162 - Detection -   best_eval_score = 63.27
2023-04-20 15:28:07,162 - Detection -   eval_score = 63.15
2023-04-20 15:28:07,162 - Detection -   train_loss = 1.5430588722229004
2023-04-20 15:28:10,695 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 15:28:10,695 - Detection -   best_eval_score = 63.27
2023-04-20 15:28:10,695 - Detection -   eval_score = 63.22
2023-04-20 15:28:10,695 - Detection -   train_loss = 1.427338765727149
2023-04-20 15:28:14,109 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 15:28:14,110 - Detection -   best_eval_score = 63.27
2023-04-20 15:28:14,110 - Detection -   eval_score = 63.0
2023-04-20 15:28:14,110 - Detection -   train_loss = 1.4992232587602403
2023-04-20 15:28:17,538 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 15:28:17,538 - Detection -   best_eval_score = 63.27
2023-04-20 15:28:17,538 - Detection -   eval_score = 63.18
2023-04-20 15:28:17,538 - Detection -   train_loss = 1.4584340519375272
2023-04-20 15:28:20,950 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 15:28:20,950 - Detection -   best_eval_score = 63.27
2023-04-20 15:28:20,950 - Detection -   eval_score = 63.0
2023-04-20 15:28:20,950 - Detection -   train_loss = 1.4559258818626404
2023-04-20 15:28:24,384 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 15:28:24,384 - Detection -   best_eval_score = 63.27
2023-04-20 15:28:24,385 - Detection -   eval_score = 63.06
2023-04-20 15:28:24,385 - Detection -   train_loss = 1.480898121992747
2023-04-20 15:28:27,830 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 15:28:27,830 - Detection -   best_eval_score = 63.27
2023-04-20 15:28:27,830 - Detection -   eval_score = 63.14
2023-04-20 15:28:27,830 - Detection -   train_loss = 1.4905007084210713
2023-04-20 15:28:27,831 - Detection - Training Finished...
2023-04-20 15:28:27,831 - Detection - Testing begin...
2023-04-20 15:28:29,935 - Detection - ***** Test: Confusion Matrix *****
2023-04-20 15:28:29,935 - Detection - [[  1   0   0 ...   0   0   7]
 [  0  15   0 ...   0   0   2]
 [  0   0   2 ...   0   0   3]
 ...
 [  0   0   0 ...  24   0   1]
 [  0   0   0 ...   0   8   0]
 [  4  16   2 ...   0   0 265]]
2023-04-20 15:28:29,935 - Detection - ***** Test results *****
2023-04-20 15:28:29,936 - Detection -   Acc = 60.44
2023-04-20 15:28:29,936 - Detection -   F1 = 61.3242
2023-04-20 15:28:29,936 - Detection -   F1-known = 61.5095
2023-04-20 15:28:29,936 - Detection -   F1-open = 50.5725
2023-04-20 15:28:29,936 - Detection - Testing finished...
2023-04-20 15:28:29,936 - Detection - Results saved in results/results_ADB.csv
2023-04-20 15:28:29,955 - Detection - Open Intent Detection Finished...
