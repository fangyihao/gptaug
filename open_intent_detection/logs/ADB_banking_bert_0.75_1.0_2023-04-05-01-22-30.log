2023-04-05 01:22:30,116 - Detection - Open Intent Detection Begin...
2023-04-05 01:22:30,116 - Detection - Parameters Initialization...
2023-04-05 01:22:30,116 - Detection - ============================== Params ==============================
2023-04-05 01:22:30,116 - Detection - type:	open_intent_detection
2023-04-05 01:22:30,116 - Detection - logger_name:	Detection
2023-04-05 01:22:30,116 - Detection - log_dir:	logs
2023-04-05 01:22:30,116 - Detection - dataset:	banking
2023-04-05 01:22:30,116 - Detection - known_cls_ratio:	0.75
2023-04-05 01:22:30,116 - Detection - labeled_ratio:	1.0
2023-04-05 01:22:30,116 - Detection - method:	ADB
2023-04-05 01:22:30,116 - Detection - train:	True
2023-04-05 01:22:30,116 - Detection - pretrain:	True
2023-04-05 01:22:30,116 - Detection - save_model:	True
2023-04-05 01:22:30,116 - Detection - backbone:	bert
2023-04-05 01:22:30,116 - Detection - config_file_name:	ADB
2023-04-05 01:22:30,116 - Detection - seed:	9
2023-04-05 01:22:30,116 - Detection - gpu_id:	0
2023-04-05 01:22:30,116 - Detection - pipe_results_path:	pipe_results
2023-04-05 01:22:30,116 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-05 01:22:30,116 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-05 01:22:30,116 - Detection - model_dir:	models
2023-04-05 01:22:30,116 - Detection - load_pretrained_method:	None
2023-04-05 01:22:30,116 - Detection - result_dir:	results
2023-04-05 01:22:30,116 - Detection - results_file_name:	results_ADB.csv
2023-04-05 01:22:30,116 - Detection - save_results:	True
2023-04-05 01:22:30,116 - Detection - loss_fct:	CrossEntropyLoss
2023-04-05 01:22:30,116 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_0.75_1.0_bert_9
2023-04-05 01:22:30,116 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_0.75_1.0_bert_9/models
2023-04-05 01:22:30,117 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-05 01:22:30,117 - Detection - num_train_epochs:	100
2023-04-05 01:22:30,117 - Detection - num_labels:	None
2023-04-05 01:22:30,117 - Detection - max_seq_length:	None
2023-04-05 01:22:30,117 - Detection - freeze_backbone_parameters:	True
2023-04-05 01:22:30,117 - Detection - feat_dim:	768
2023-04-05 01:22:30,117 - Detection - warmup_proportion:	0.1
2023-04-05 01:22:30,117 - Detection - lr_boundary:	0.05
2023-04-05 01:22:30,117 - Detection - lr:	2e-05
2023-04-05 01:22:30,117 - Detection - activation:	relu
2023-04-05 01:22:30,117 - Detection - train_batch_size:	128
2023-04-05 01:22:30,117 - Detection - eval_batch_size:	64
2023-04-05 01:22:30,117 - Detection - test_batch_size:	64
2023-04-05 01:22:30,117 - Detection - wait_patient:	10
2023-04-05 01:22:30,117 - Detection - ============================== End Params ==============================
2023-04-05 01:22:30,117 - Detection - Data and Model Preparation...
2023-04-05 01:22:30,117 - Detection - The number of known intents is 58
2023-04-05 01:22:30,118 - Detection - Lists of known labels are: ['card_payment_not_recognised', 'cash_withdrawal_charge', 'declined_transfer', 'exchange_via_app', 'cash_withdrawal_not_recognised', 'declined_card_payment', 'pending_transfer', 'country_support', 'verify_top_up', 'apple_pay_or_google_pay', 'reverted_card_payment?', 'top_up_reverted', 'passcode_forgotten', 'balance_not_updated_after_bank_transfer', 'card_linking', 'lost_or_stolen_phone', 'failed_transfer', 'card_not_working', 'top_up_by_card_charge', 'balance_not_updated_after_cheque_or_cash_deposit', 'compromised_card', 'exchange_charge', 'top_up_by_cash_or_cheque', 'order_physical_card', 'age_limit', 'terminate_account', 'pin_blocked', 'edit_personal_details', 'declined_cash_withdrawal', 'get_physical_card', 'beneficiary_not_allowed', 'disposable_card_limits', 'receiving_money', 'contactless_not_working', 'automatic_top_up', 'getting_virtual_card', 'pending_top_up', 'card_about_to_expire', 'transfer_timing', 'wrong_exchange_rate_for_cash_withdrawal', 'atm_support', 'pending_cash_withdrawal', 'visa_or_mastercard', 'transaction_charged_twice', 'pending_card_payment', 'unable_to_verify_identity', 'card_delivery_estimate', 'verify_my_identity', 'card_payment_fee_charged', 'cancel_transfer', 'get_disposable_virtual_card', 'card_swallowed', 'fiat_currency_support', 'card_acceptance', 'extra_charge_on_statement', 'activate_my_card', 'virtual_card_not_working', 'card_payment_wrong_exchange_rate']
2023-04-05 01:22:30,151 - Detection - Number of labeled training samples = 6692
2023-04-05 01:22:30,151 - Detection - Number of unlabeled training samples = 2311
2023-04-05 01:22:30,154 - Detection - Number of evaluation samples = 745
2023-04-05 01:22:30,161 - Detection - Number of testing samples = 3080
2023-04-05 01:22:36,703 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-05 01:22:38,372 - Detection - Pre-training Begin...
2023-04-05 01:22:47,486 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 01:22:47,486 - Detection -   best_eval_score = 0
2023-04-05 01:22:47,486 - Detection -   eval_score = 4.03
2023-04-05 01:22:47,486 - Detection -   train_loss = 4.058432174178789
2023-04-05 01:22:56,126 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 01:22:56,126 - Detection -   best_eval_score = 4.03
2023-04-05 01:22:56,126 - Detection -   eval_score = 7.11
2023-04-05 01:22:56,126 - Detection -   train_loss = 4.02967162402171
2023-04-05 01:23:05,155 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 01:23:05,155 - Detection -   best_eval_score = 7.11
2023-04-05 01:23:05,155 - Detection -   eval_score = 18.26
2023-04-05 01:23:05,156 - Detection -   train_loss = 3.963051678999415
2023-04-05 01:23:14,338 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 01:23:14,338 - Detection -   best_eval_score = 18.26
2023-04-05 01:23:14,338 - Detection -   eval_score = 36.91
2023-04-05 01:23:14,338 - Detection -   train_loss = 3.7461509299728104
2023-04-05 01:23:23,535 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 01:23:23,535 - Detection -   best_eval_score = 36.91
2023-04-05 01:23:23,535 - Detection -   eval_score = 52.21
2023-04-05 01:23:23,535 - Detection -   train_loss = 3.1977694439438156
2023-04-05 01:23:32,727 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 01:23:32,727 - Detection -   best_eval_score = 52.21
2023-04-05 01:23:32,727 - Detection -   eval_score = 64.16
2023-04-05 01:23:32,727 - Detection -   train_loss = 2.527914784989267
2023-04-05 01:23:41,916 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 01:23:41,916 - Detection -   best_eval_score = 64.16
2023-04-05 01:23:41,916 - Detection -   eval_score = 74.36
2023-04-05 01:23:41,916 - Detection -   train_loss = 1.9284091198219444
2023-04-05 01:23:51,112 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 01:23:51,112 - Detection -   best_eval_score = 74.36
2023-04-05 01:23:51,112 - Detection -   eval_score = 79.06
2023-04-05 01:23:51,112 - Detection -   train_loss = 1.4420384168624878
2023-04-05 01:24:00,302 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 01:24:00,302 - Detection -   best_eval_score = 79.06
2023-04-05 01:24:00,302 - Detection -   eval_score = 84.16
2023-04-05 01:24:00,302 - Detection -   train_loss = 1.0872866758760416
2023-04-05 01:24:09,497 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 01:24:09,498 - Detection -   best_eval_score = 84.16
2023-04-05 01:24:09,498 - Detection -   eval_score = 87.38
2023-04-05 01:24:09,498 - Detection -   train_loss = 0.8490958911068035
2023-04-05 01:24:18,698 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 01:24:18,698 - Detection -   best_eval_score = 87.38
2023-04-05 01:24:18,698 - Detection -   eval_score = 88.59
2023-04-05 01:24:18,698 - Detection -   train_loss = 0.6840280451864567
2023-04-05 01:24:27,865 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 01:24:27,865 - Detection -   best_eval_score = 88.59
2023-04-05 01:24:27,865 - Detection -   eval_score = 89.66
2023-04-05 01:24:27,865 - Detection -   train_loss = 0.5731627294477427
2023-04-05 01:24:37,008 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 01:24:37,008 - Detection -   best_eval_score = 89.66
2023-04-05 01:24:37,008 - Detection -   eval_score = 90.34
2023-04-05 01:24:37,008 - Detection -   train_loss = 0.48845601812848505
2023-04-05 01:24:46,130 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 01:24:46,130 - Detection -   best_eval_score = 90.34
2023-04-05 01:24:46,130 - Detection -   eval_score = 91.14
2023-04-05 01:24:46,130 - Detection -   train_loss = 0.43147709740782686
2023-04-05 01:24:55,340 - Detection - ***** Epoch: 15: Eval results *****
2023-04-05 01:24:55,341 - Detection -   best_eval_score = 91.14
2023-04-05 01:24:55,341 - Detection -   eval_score = 92.08
2023-04-05 01:24:55,341 - Detection -   train_loss = 0.38540860448243486
2023-04-05 01:25:04,460 - Detection - ***** Epoch: 16: Eval results *****
2023-04-05 01:25:04,460 - Detection -   best_eval_score = 92.08
2023-04-05 01:25:04,460 - Detection -   eval_score = 92.21
2023-04-05 01:25:04,460 - Detection -   train_loss = 0.3510220514715843
2023-04-05 01:25:13,577 - Detection - ***** Epoch: 17: Eval results *****
2023-04-05 01:25:13,577 - Detection -   best_eval_score = 92.21
2023-04-05 01:25:13,577 - Detection -   eval_score = 92.48
2023-04-05 01:25:13,577 - Detection -   train_loss = 0.3199795990620019
2023-04-05 01:25:22,682 - Detection - ***** Epoch: 18: Eval results *****
2023-04-05 01:25:22,682 - Detection -   best_eval_score = 92.48
2023-04-05 01:25:22,682 - Detection -   eval_score = 92.21
2023-04-05 01:25:22,682 - Detection -   train_loss = 0.29670740945159263
2023-04-05 01:25:31,766 - Detection - ***** Epoch: 19: Eval results *****
2023-04-05 01:25:31,766 - Detection -   best_eval_score = 92.48
2023-04-05 01:25:31,766 - Detection -   eval_score = 93.02
2023-04-05 01:25:31,766 - Detection -   train_loss = 0.27245062224145206
2023-04-05 01:25:40,863 - Detection - ***** Epoch: 20: Eval results *****
2023-04-05 01:25:40,863 - Detection -   best_eval_score = 93.02
2023-04-05 01:25:40,863 - Detection -   eval_score = 92.48
2023-04-05 01:25:40,863 - Detection -   train_loss = 0.2530663696662435
2023-04-05 01:25:49,944 - Detection - ***** Epoch: 21: Eval results *****
2023-04-05 01:25:49,944 - Detection -   best_eval_score = 93.02
2023-04-05 01:25:49,944 - Detection -   eval_score = 92.48
2023-04-05 01:25:49,944 - Detection -   train_loss = 0.2390959158820926
2023-04-05 01:25:59,023 - Detection - ***** Epoch: 22: Eval results *****
2023-04-05 01:25:59,023 - Detection -   best_eval_score = 93.02
2023-04-05 01:25:59,023 - Detection -   eval_score = 93.15
2023-04-05 01:25:59,023 - Detection -   train_loss = 0.22912095177848385
2023-04-05 01:26:08,113 - Detection - ***** Epoch: 23: Eval results *****
2023-04-05 01:26:08,113 - Detection -   best_eval_score = 93.15
2023-04-05 01:26:08,113 - Detection -   eval_score = 93.15
2023-04-05 01:26:08,113 - Detection -   train_loss = 0.20968616093104742
2023-04-05 01:26:17,190 - Detection - ***** Epoch: 24: Eval results *****
2023-04-05 01:26:17,191 - Detection -   best_eval_score = 93.15
2023-04-05 01:26:17,191 - Detection -   eval_score = 93.15
2023-04-05 01:26:17,191 - Detection -   train_loss = 0.2001615914533723
2023-04-05 01:26:26,265 - Detection - ***** Epoch: 25: Eval results *****
2023-04-05 01:26:26,265 - Detection -   best_eval_score = 93.15
2023-04-05 01:26:26,265 - Detection -   eval_score = 93.15
2023-04-05 01:26:26,265 - Detection -   train_loss = 0.18903801997877517
2023-04-05 01:26:35,334 - Detection - ***** Epoch: 26: Eval results *****
2023-04-05 01:26:35,334 - Detection -   best_eval_score = 93.15
2023-04-05 01:26:35,334 - Detection -   eval_score = 93.69
2023-04-05 01:26:35,334 - Detection -   train_loss = 0.17811158186984513
2023-04-05 01:26:44,408 - Detection - ***** Epoch: 27: Eval results *****
2023-04-05 01:26:44,408 - Detection -   best_eval_score = 93.69
2023-04-05 01:26:44,408 - Detection -   eval_score = 93.29
2023-04-05 01:26:44,408 - Detection -   train_loss = 0.16921107724027815
2023-04-05 01:26:53,466 - Detection - ***** Epoch: 28: Eval results *****
2023-04-05 01:26:53,466 - Detection -   best_eval_score = 93.69
2023-04-05 01:26:53,466 - Detection -   eval_score = 93.56
2023-04-05 01:26:53,466 - Detection -   train_loss = 0.16188616474282067
2023-04-05 01:27:02,512 - Detection - ***** Epoch: 29: Eval results *****
2023-04-05 01:27:02,512 - Detection -   best_eval_score = 93.69
2023-04-05 01:27:02,512 - Detection -   eval_score = 93.56
2023-04-05 01:27:02,512 - Detection -   train_loss = 0.1573335386390956
2023-04-05 01:27:11,563 - Detection - ***** Epoch: 30: Eval results *****
2023-04-05 01:27:11,563 - Detection -   best_eval_score = 93.69
2023-04-05 01:27:11,563 - Detection -   eval_score = 93.56
2023-04-05 01:27:11,563 - Detection -   train_loss = 0.14477398344930612
2023-04-05 01:27:20,616 - Detection - ***** Epoch: 31: Eval results *****
2023-04-05 01:27:20,616 - Detection -   best_eval_score = 93.69
2023-04-05 01:27:20,616 - Detection -   eval_score = 93.83
2023-04-05 01:27:20,616 - Detection -   train_loss = 0.1375560999478934
2023-04-05 01:27:29,672 - Detection - ***** Epoch: 32: Eval results *****
2023-04-05 01:27:29,672 - Detection -   best_eval_score = 93.83
2023-04-05 01:27:29,672 - Detection -   eval_score = 93.69
2023-04-05 01:27:29,672 - Detection -   train_loss = 0.13593114926567618
2023-04-05 01:27:38,703 - Detection - ***** Epoch: 33: Eval results *****
2023-04-05 01:27:38,703 - Detection -   best_eval_score = 93.83
2023-04-05 01:27:38,703 - Detection -   eval_score = 94.09
2023-04-05 01:27:38,703 - Detection -   train_loss = 0.12779734578897367
2023-04-05 01:27:47,748 - Detection - ***** Epoch: 34: Eval results *****
2023-04-05 01:27:47,748 - Detection -   best_eval_score = 94.09
2023-04-05 01:27:47,748 - Detection -   eval_score = 94.23
2023-04-05 01:27:47,748 - Detection -   train_loss = 0.12576813602222586
2023-04-05 01:27:56,882 - Detection - ***** Epoch: 35: Eval results *****
2023-04-05 01:27:56,882 - Detection -   best_eval_score = 94.23
2023-04-05 01:27:56,883 - Detection -   eval_score = 94.09
2023-04-05 01:27:56,883 - Detection -   train_loss = 0.12056577036965568
2023-04-05 01:28:05,908 - Detection - ***** Epoch: 36: Eval results *****
2023-04-05 01:28:05,908 - Detection -   best_eval_score = 94.23
2023-04-05 01:28:05,908 - Detection -   eval_score = 94.23
2023-04-05 01:28:05,908 - Detection -   train_loss = 0.11298558411170852
2023-04-05 01:28:14,943 - Detection - ***** Epoch: 37: Eval results *****
2023-04-05 01:28:14,943 - Detection -   best_eval_score = 94.23
2023-04-05 01:28:14,943 - Detection -   eval_score = 94.09
2023-04-05 01:28:14,943 - Detection -   train_loss = 0.10936096170038548
2023-04-05 01:28:23,966 - Detection - ***** Epoch: 38: Eval results *****
2023-04-05 01:28:23,966 - Detection -   best_eval_score = 94.23
2023-04-05 01:28:23,966 - Detection -   eval_score = 93.96
2023-04-05 01:28:23,966 - Detection -   train_loss = 0.10386483265825038
2023-04-05 01:28:32,998 - Detection - ***** Epoch: 39: Eval results *****
2023-04-05 01:28:32,999 - Detection -   best_eval_score = 94.23
2023-04-05 01:28:32,999 - Detection -   eval_score = 94.23
2023-04-05 01:28:32,999 - Detection -   train_loss = 0.10040646109659716
2023-04-05 01:28:42,022 - Detection - ***** Epoch: 40: Eval results *****
2023-04-05 01:28:42,023 - Detection -   best_eval_score = 94.23
2023-04-05 01:28:42,023 - Detection -   eval_score = 93.96
2023-04-05 01:28:42,023 - Detection -   train_loss = 0.09736361642772297
2023-04-05 01:28:51,045 - Detection - ***** Epoch: 41: Eval results *****
2023-04-05 01:28:51,045 - Detection -   best_eval_score = 94.23
2023-04-05 01:28:51,045 - Detection -   eval_score = 94.23
2023-04-05 01:28:51,045 - Detection -   train_loss = 0.09650684401111782
2023-04-05 01:29:00,093 - Detection - ***** Epoch: 42: Eval results *****
2023-04-05 01:29:00,093 - Detection -   best_eval_score = 94.23
2023-04-05 01:29:00,093 - Detection -   eval_score = 94.36
2023-04-05 01:29:00,093 - Detection -   train_loss = 0.09185663224110063
2023-04-05 01:29:09,128 - Detection - ***** Epoch: 43: Eval results *****
2023-04-05 01:29:09,128 - Detection -   best_eval_score = 94.36
2023-04-05 01:29:09,128 - Detection -   eval_score = 94.23
2023-04-05 01:29:09,128 - Detection -   train_loss = 0.0868490182987924
2023-04-05 01:29:18,150 - Detection - ***** Epoch: 44: Eval results *****
2023-04-05 01:29:18,150 - Detection -   best_eval_score = 94.36
2023-04-05 01:29:18,150 - Detection -   eval_score = 94.63
2023-04-05 01:29:18,150 - Detection -   train_loss = 0.0864674023721578
2023-04-05 01:29:27,195 - Detection - ***** Epoch: 45: Eval results *****
2023-04-05 01:29:27,195 - Detection -   best_eval_score = 94.63
2023-04-05 01:29:27,195 - Detection -   eval_score = 94.5
2023-04-05 01:29:27,195 - Detection -   train_loss = 0.08402893446245284
2023-04-05 01:29:36,216 - Detection - ***** Epoch: 46: Eval results *****
2023-04-05 01:29:36,216 - Detection -   best_eval_score = 94.63
2023-04-05 01:29:36,216 - Detection -   eval_score = 94.36
2023-04-05 01:29:36,216 - Detection -   train_loss = 0.0780182587650587
2023-04-05 01:29:45,236 - Detection - ***** Epoch: 47: Eval results *****
2023-04-05 01:29:45,236 - Detection -   best_eval_score = 94.63
2023-04-05 01:29:45,236 - Detection -   eval_score = 94.77
2023-04-05 01:29:45,236 - Detection -   train_loss = 0.07750680768546069
2023-04-05 01:29:54,277 - Detection - ***** Epoch: 48: Eval results *****
2023-04-05 01:29:54,277 - Detection -   best_eval_score = 94.77
2023-04-05 01:29:54,277 - Detection -   eval_score = 94.5
2023-04-05 01:29:54,277 - Detection -   train_loss = 0.07451054689316254
2023-04-05 01:30:03,298 - Detection - ***** Epoch: 49: Eval results *****
2023-04-05 01:30:03,298 - Detection -   best_eval_score = 94.77
2023-04-05 01:30:03,299 - Detection -   eval_score = 94.5
2023-04-05 01:30:03,299 - Detection -   train_loss = 0.07017146549978347
2023-04-05 01:30:12,325 - Detection - ***** Epoch: 50: Eval results *****
2023-04-05 01:30:12,326 - Detection -   best_eval_score = 94.77
2023-04-05 01:30:12,326 - Detection -   eval_score = 94.9
2023-04-05 01:30:12,326 - Detection -   train_loss = 0.06951454872230314
2023-04-05 01:30:21,362 - Detection - ***** Epoch: 51: Eval results *****
2023-04-05 01:30:21,362 - Detection -   best_eval_score = 94.9
2023-04-05 01:30:21,362 - Detection -   eval_score = 95.03
2023-04-05 01:30:21,362 - Detection -   train_loss = 0.06914343565421284
2023-04-05 01:30:30,392 - Detection - ***** Epoch: 52: Eval results *****
2023-04-05 01:30:30,392 - Detection -   best_eval_score = 95.03
2023-04-05 01:30:30,392 - Detection -   eval_score = 94.77
2023-04-05 01:30:30,392 - Detection -   train_loss = 0.06633318756830017
2023-04-05 01:30:39,415 - Detection - ***** Epoch: 53: Eval results *****
2023-04-05 01:30:39,415 - Detection -   best_eval_score = 95.03
2023-04-05 01:30:39,415 - Detection -   eval_score = 94.63
2023-04-05 01:30:39,415 - Detection -   train_loss = 0.0652794729707376
2023-04-05 01:30:48,433 - Detection - ***** Epoch: 54: Eval results *****
2023-04-05 01:30:48,433 - Detection -   best_eval_score = 95.03
2023-04-05 01:30:48,433 - Detection -   eval_score = 94.9
2023-04-05 01:30:48,433 - Detection -   train_loss = 0.0637594517671837
2023-04-05 01:30:57,456 - Detection - ***** Epoch: 55: Eval results *****
2023-04-05 01:30:57,456 - Detection -   best_eval_score = 95.03
2023-04-05 01:30:57,456 - Detection -   eval_score = 94.36
2023-04-05 01:30:57,456 - Detection -   train_loss = 0.06277359769029438
2023-04-05 01:31:06,478 - Detection - ***** Epoch: 56: Eval results *****
2023-04-05 01:31:06,478 - Detection -   best_eval_score = 95.03
2023-04-05 01:31:06,478 - Detection -   eval_score = 94.63
2023-04-05 01:31:06,478 - Detection -   train_loss = 0.06002617908536263
2023-04-05 01:31:15,490 - Detection - ***** Epoch: 57: Eval results *****
2023-04-05 01:31:15,490 - Detection -   best_eval_score = 95.03
2023-04-05 01:31:15,490 - Detection -   eval_score = 94.77
2023-04-05 01:31:15,490 - Detection -   train_loss = 0.05844437323932378
2023-04-05 01:31:24,593 - Detection - ***** Epoch: 58: Eval results *****
2023-04-05 01:31:24,593 - Detection -   best_eval_score = 95.03
2023-04-05 01:31:24,593 - Detection -   eval_score = 94.63
2023-04-05 01:31:24,593 - Detection -   train_loss = 0.056503017063973086
2023-04-05 01:31:33,612 - Detection - ***** Epoch: 59: Eval results *****
2023-04-05 01:31:33,612 - Detection -   best_eval_score = 95.03
2023-04-05 01:31:33,612 - Detection -   eval_score = 94.77
2023-04-05 01:31:33,612 - Detection -   train_loss = 0.05485797068982754
2023-04-05 01:31:42,633 - Detection - ***** Epoch: 60: Eval results *****
2023-04-05 01:31:42,633 - Detection -   best_eval_score = 95.03
2023-04-05 01:31:42,633 - Detection -   eval_score = 94.5
2023-04-05 01:31:42,633 - Detection -   train_loss = 0.054641148462048116
2023-04-05 01:31:51,651 - Detection - ***** Epoch: 61: Eval results *****
2023-04-05 01:31:51,651 - Detection -   best_eval_score = 95.03
2023-04-05 01:31:51,651 - Detection -   eval_score = 94.77
2023-04-05 01:31:51,651 - Detection -   train_loss = 0.05296686470930306
2023-04-05 01:31:51,651 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_0.75_1.0_bert_9/models
2023-04-05 01:31:52,191 - Detection - Pre-training finished...
2023-04-05 01:31:52,192 - Detection - Training Begin...
2023-04-05 01:32:08,176 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 01:32:08,176 - Detection -   best_eval_score = 0
2023-04-05 01:32:08,176 - Detection -   eval_score = 0.0
2023-04-05 01:32:08,176 - Detection -   train_loss = 13.951004460172832
2023-04-05 01:32:17,116 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 01:32:17,116 - Detection -   best_eval_score = 0
2023-04-05 01:32:17,117 - Detection -   eval_score = 1.98
2023-04-05 01:32:17,117 - Detection -   train_loss = 11.73552099263893
2023-04-05 01:32:26,049 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 01:32:26,049 - Detection -   best_eval_score = 1.98
2023-04-05 01:32:26,049 - Detection -   eval_score = 27.71
2023-04-05 01:32:26,049 - Detection -   train_loss = 9.284792207322031
2023-04-05 01:32:34,991 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 01:32:34,991 - Detection -   best_eval_score = 27.71
2023-04-05 01:32:34,991 - Detection -   eval_score = 61.11
2023-04-05 01:32:34,991 - Detection -   train_loss = 6.8912727607871
2023-04-05 01:32:43,947 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 01:32:43,947 - Detection -   best_eval_score = 61.11
2023-04-05 01:32:43,947 - Detection -   eval_score = 80.6
2023-04-05 01:32:43,947 - Detection -   train_loss = 4.53670713136781
2023-04-05 01:32:52,901 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 01:32:52,901 - Detection -   best_eval_score = 80.6
2023-04-05 01:32:52,901 - Detection -   eval_score = 87.29
2023-04-05 01:32:52,902 - Detection -   train_loss = 2.6055586697920314
2023-04-05 01:33:01,848 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 01:33:01,848 - Detection -   best_eval_score = 87.29
2023-04-05 01:33:01,848 - Detection -   eval_score = 89.28
2023-04-05 01:33:01,848 - Detection -   train_loss = 1.762216736685555
2023-04-05 01:33:10,811 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 01:33:10,812 - Detection -   best_eval_score = 89.28
2023-04-05 01:33:10,812 - Detection -   eval_score = 89.64
2023-04-05 01:33:10,812 - Detection -   train_loss = 1.6050823049725227
2023-04-05 01:33:19,776 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 01:33:19,776 - Detection -   best_eval_score = 89.64
2023-04-05 01:33:19,776 - Detection -   eval_score = 89.65
2023-04-05 01:33:19,776 - Detection -   train_loss = 1.601364844250229
2023-04-05 01:33:28,738 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 01:33:28,738 - Detection -   best_eval_score = 89.65
2023-04-05 01:33:28,738 - Detection -   eval_score = 89.65
2023-04-05 01:33:28,738 - Detection -   train_loss = 1.6070443414292246
2023-04-05 01:33:37,693 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 01:33:37,693 - Detection -   best_eval_score = 89.65
2023-04-05 01:33:37,693 - Detection -   eval_score = 89.81
2023-04-05 01:33:37,693 - Detection -   train_loss = 1.5988203219647676
2023-04-05 01:33:46,641 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 01:33:46,641 - Detection -   best_eval_score = 89.81
2023-04-05 01:33:46,641 - Detection -   eval_score = 89.76
2023-04-05 01:33:46,641 - Detection -   train_loss = 1.598265270017228
2023-04-05 01:33:55,602 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 01:33:55,602 - Detection -   best_eval_score = 89.81
2023-04-05 01:33:55,602 - Detection -   eval_score = 89.65
2023-04-05 01:33:55,602 - Detection -   train_loss = 1.6098767294074006
2023-04-05 01:34:04,555 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 01:34:04,555 - Detection -   best_eval_score = 89.81
2023-04-05 01:34:04,555 - Detection -   eval_score = 89.8
2023-04-05 01:34:04,555 - Detection -   train_loss = 1.611216036778576
2023-04-05 01:34:13,498 - Detection - ***** Epoch: 15: Eval results *****
2023-04-05 01:34:13,498 - Detection -   best_eval_score = 89.81
2023-04-05 01:34:13,498 - Detection -   eval_score = 89.8
2023-04-05 01:34:13,498 - Detection -   train_loss = 1.6283248213102233
2023-04-05 01:34:22,451 - Detection - ***** Epoch: 16: Eval results *****
2023-04-05 01:34:22,451 - Detection -   best_eval_score = 89.81
2023-04-05 01:34:22,451 - Detection -   eval_score = 89.75
2023-04-05 01:34:22,451 - Detection -   train_loss = 1.589698112235879
2023-04-05 01:34:31,406 - Detection - ***** Epoch: 17: Eval results *****
2023-04-05 01:34:31,406 - Detection -   best_eval_score = 89.81
2023-04-05 01:34:31,406 - Detection -   eval_score = 89.75
2023-04-05 01:34:31,406 - Detection -   train_loss = 1.6242437182732348
2023-04-05 01:34:40,362 - Detection - ***** Epoch: 18: Eval results *****
2023-04-05 01:34:40,362 - Detection -   best_eval_score = 89.81
2023-04-05 01:34:40,362 - Detection -   eval_score = 89.65
2023-04-05 01:34:40,362 - Detection -   train_loss = 1.6068618432530817
2023-04-05 01:34:49,316 - Detection - ***** Epoch: 19: Eval results *****
2023-04-05 01:34:49,316 - Detection -   best_eval_score = 89.81
2023-04-05 01:34:49,316 - Detection -   eval_score = 89.65
2023-04-05 01:34:49,316 - Detection -   train_loss = 1.6160647621694602
2023-04-05 01:34:58,269 - Detection - ***** Epoch: 20: Eval results *****
2023-04-05 01:34:58,269 - Detection -   best_eval_score = 89.81
2023-04-05 01:34:58,269 - Detection -   eval_score = 89.73
2023-04-05 01:34:58,269 - Detection -   train_loss = 1.6007151288806267
2023-04-05 01:35:07,222 - Detection - ***** Epoch: 21: Eval results *****
2023-04-05 01:35:07,222 - Detection -   best_eval_score = 89.81
2023-04-05 01:35:07,222 - Detection -   eval_score = 89.65
2023-04-05 01:35:07,222 - Detection -   train_loss = 1.6096256049174182
2023-04-05 01:35:07,223 - Detection - Training Finished...
2023-04-05 01:35:07,223 - Detection - Testing begin...
2023-04-05 01:35:10,538 - Detection - ***** Test: Confusion Matrix *****
2023-04-05 01:35:10,538 - Detection - [[ 29   0   0 ...   0   0   9]
 [  0  37   0 ...   0   0   2]
 [  0   0  28 ...   0   0  10]
 ...
 [  0   0   0 ...  31   0   5]
 [  0   0   0 ...   0  37   2]
 [ 11   0   0 ...   0   0 514]]
2023-04-05 01:35:10,538 - Detection - ***** Test results *****
2023-04-05 01:35:10,538 - Detection -   Acc = 82.18
2023-04-05 01:35:10,538 - Detection -   F1 = 86.754
2023-04-05 01:35:10,538 - Detection -   F1-known = 87.0713
2023-04-05 01:35:10,538 - Detection -   F1-open = 68.3511
2023-04-05 01:35:10,538 - Detection - Testing finished...
2023-04-05 01:35:10,538 - Detection - Results saved in results/results_ADB.csv
2023-04-05 01:35:10,559 - Detection - Open Intent Detection Finished...
