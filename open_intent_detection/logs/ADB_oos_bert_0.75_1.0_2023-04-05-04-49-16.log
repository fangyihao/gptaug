2023-04-05 04:49:16,874 - Detection - Open Intent Detection Begin...
2023-04-05 04:49:16,874 - Detection - Parameters Initialization...
2023-04-05 04:49:16,874 - Detection - ============================== Params ==============================
2023-04-05 04:49:16,874 - Detection - type:	open_intent_detection
2023-04-05 04:49:16,874 - Detection - logger_name:	Detection
2023-04-05 04:49:16,874 - Detection - log_dir:	logs
2023-04-05 04:49:16,874 - Detection - dataset:	oos
2023-04-05 04:49:16,874 - Detection - known_cls_ratio:	0.75
2023-04-05 04:49:16,874 - Detection - labeled_ratio:	1.0
2023-04-05 04:49:16,874 - Detection - method:	ADB
2023-04-05 04:49:16,874 - Detection - train:	True
2023-04-05 04:49:16,874 - Detection - pretrain:	True
2023-04-05 04:49:16,874 - Detection - save_model:	True
2023-04-05 04:49:16,874 - Detection - backbone:	bert
2023-04-05 04:49:16,874 - Detection - config_file_name:	ADB
2023-04-05 04:49:16,874 - Detection - seed:	7
2023-04-05 04:49:16,874 - Detection - gpu_id:	0
2023-04-05 04:49:16,874 - Detection - pipe_results_path:	pipe_results
2023-04-05 04:49:16,874 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-05 04:49:16,874 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-05 04:49:16,874 - Detection - model_dir:	models
2023-04-05 04:49:16,874 - Detection - load_pretrained_method:	None
2023-04-05 04:49:16,874 - Detection - result_dir:	results
2023-04-05 04:49:16,874 - Detection - results_file_name:	results_ADB.csv
2023-04-05 04:49:16,875 - Detection - save_results:	True
2023-04-05 04:49:16,875 - Detection - loss_fct:	CrossEntropyLoss
2023-04-05 04:49:16,875 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_0.75_1.0_bert_7
2023-04-05 04:49:16,875 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_0.75_1.0_bert_7/models
2023-04-05 04:49:16,875 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-05 04:49:16,875 - Detection - num_train_epochs:	100
2023-04-05 04:49:16,875 - Detection - num_labels:	None
2023-04-05 04:49:16,875 - Detection - max_seq_length:	None
2023-04-05 04:49:16,875 - Detection - freeze_backbone_parameters:	True
2023-04-05 04:49:16,875 - Detection - feat_dim:	768
2023-04-05 04:49:16,875 - Detection - warmup_proportion:	0.1
2023-04-05 04:49:16,875 - Detection - lr_boundary:	0.05
2023-04-05 04:49:16,875 - Detection - lr:	2e-05
2023-04-05 04:49:16,875 - Detection - activation:	relu
2023-04-05 04:49:16,875 - Detection - train_batch_size:	128
2023-04-05 04:49:16,875 - Detection - eval_batch_size:	64
2023-04-05 04:49:16,875 - Detection - test_batch_size:	64
2023-04-05 04:49:16,875 - Detection - wait_patient:	10
2023-04-05 04:49:16,875 - Detection - ============================== End Params ==============================
2023-04-05 04:49:16,875 - Detection - Data and Model Preparation...
2023-04-05 04:49:16,875 - Detection - The number of known intents is 112
2023-04-05 04:49:16,876 - Detection - Lists of known labels are: ['yes', 'payday', 'expiration_date', 'maybe', 'rollover_401k', 'find_phone', 'how_old_are_you', 'reminder', 'calculator', 'how_busy', 'nutrition_info', 'pin_change', 'damaged_card', 'schedule_meeting', 'credit_limit', 'meeting_schedule', 'schedule_maintenance', 'user_name', 'fun_fact', 'distance', 'order_status', 'thank_you', 'last_maintenance', 'text', 'transactions', 'vaccines', 'replacement_card_duration', 'order', 'restaurant_reservation', 'weather', 'todo_list', 'oil_change_when', 'change_language', 'w2', 'next_holiday', 'freeze_account', 'directions', 'are_you_a_bot', 'car_rental', 'restaurant_reviews', 'tire_change', 'no', 'travel_alert', 'sync_device', 'reminder_update', 'goodbye', 'make_call', 'jump_start', 'shopping_list', 'credit_limit_change', 'application_status', 'exchange_rate', 'taxes', 'calendar_update', 'reset_settings', 'order_checks', 'international_fees', 'income', 'confirm_reservation', 'bill_due', 'flip_coin', 'play_music', 'routing', 'pto_request_status', 'interest_rate', 'cancel', 'tire_pressure', 'change_accent', 'calories', 'travel_suggestion', 'smart_home', 'calendar', 'rewards_balance', 'gas', 'insurance_change', 'where_are_you_from', 'pto_used', 'card_declined', 'greeting', 'alarm', 'who_do_you_work_for', 'tell_joke', 'insurance', 'credit_score', 'date', 'pto_balance', 'spending_history', 'cook_time', 'translate', 'spelling', 'repeat', 'change_ai_name', 'report_fraud', 'bill_balance', 'timer', 'roll_dice', 'direct_deposit', 'book_hotel', 'what_song', 'min_payment', 'whisper_mode', 'transfer', 'redeem_rewards', 'current_location', 'cancel_reservation', 'time', 'account_blocked', 'gas_type', 'pay_bill', 'what_is_your_name', 'who_made_you', 'report_lost_card']
2023-04-05 04:49:16,933 - Detection - Number of labeled training samples = 11200
2023-04-05 04:49:16,933 - Detection - Number of unlabeled training samples = 3800
2023-04-05 04:49:16,940 - Detection - Number of evaluation samples = 2240
2023-04-05 04:49:16,954 - Detection - Number of testing samples = 5700
2023-04-05 04:49:24,412 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-05 04:49:26,068 - Detection - Pre-training Begin...
2023-04-05 04:49:35,341 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 04:49:35,341 - Detection -   best_eval_score = 0
2023-04-05 04:49:35,341 - Detection -   eval_score = 1.52
2023-04-05 04:49:35,341 - Detection -   train_loss = 4.713744477792219
2023-04-05 04:49:44,142 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 04:49:44,142 - Detection -   best_eval_score = 1.52
2023-04-05 04:49:44,142 - Detection -   eval_score = 8.62
2023-04-05 04:49:44,142 - Detection -   train_loss = 4.682820049199191
2023-04-05 04:49:53,356 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 04:49:53,356 - Detection -   best_eval_score = 8.62
2023-04-05 04:49:53,356 - Detection -   eval_score = 26.74
2023-04-05 04:49:53,356 - Detection -   train_loss = 4.584410754117099
2023-04-05 04:50:02,677 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 04:50:02,677 - Detection -   best_eval_score = 26.74
2023-04-05 04:50:02,677 - Detection -   eval_score = 52.63
2023-04-05 04:50:02,677 - Detection -   train_loss = 4.209877030415968
2023-04-05 04:50:12,102 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 04:50:12,102 - Detection -   best_eval_score = 52.63
2023-04-05 04:50:12,102 - Detection -   eval_score = 67.81
2023-04-05 04:50:12,102 - Detection -   train_loss = 3.464035226540132
2023-04-05 04:50:21,424 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 04:50:21,424 - Detection -   best_eval_score = 67.81
2023-04-05 04:50:21,424 - Detection -   eval_score = 76.74
2023-04-05 04:50:21,425 - Detection -   train_loss = 2.637980035760186
2023-04-05 04:50:30,757 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 04:50:30,757 - Detection -   best_eval_score = 76.74
2023-04-05 04:50:30,757 - Detection -   eval_score = 83.79
2023-04-05 04:50:30,757 - Detection -   train_loss = 1.9194537035443566
2023-04-05 04:50:40,103 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 04:50:40,103 - Detection -   best_eval_score = 83.79
2023-04-05 04:50:40,103 - Detection -   eval_score = 88.75
2023-04-05 04:50:40,103 - Detection -   train_loss = 1.3707792379639365
2023-04-05 04:50:49,433 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 04:50:49,433 - Detection -   best_eval_score = 88.75
2023-04-05 04:50:49,433 - Detection -   eval_score = 91.25
2023-04-05 04:50:49,433 - Detection -   train_loss = 0.9831723286346956
2023-04-05 04:50:58,769 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 04:50:58,770 - Detection -   best_eval_score = 91.25
2023-04-05 04:50:58,770 - Detection -   eval_score = 92.41
2023-04-05 04:50:58,770 - Detection -   train_loss = 0.7327257110313936
2023-04-05 04:51:08,076 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 04:51:08,076 - Detection -   best_eval_score = 92.41
2023-04-05 04:51:08,076 - Detection -   eval_score = 93.66
2023-04-05 04:51:08,076 - Detection -   train_loss = 0.5612187517637556
2023-04-05 04:51:17,387 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 04:51:17,387 - Detection -   best_eval_score = 93.66
2023-04-05 04:51:17,387 - Detection -   eval_score = 94.06
2023-04-05 04:51:17,387 - Detection -   train_loss = 0.45082884789867833
2023-04-05 04:51:26,686 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 04:51:26,686 - Detection -   best_eval_score = 94.06
2023-04-05 04:51:26,686 - Detection -   eval_score = 94.87
2023-04-05 04:51:26,686 - Detection -   train_loss = 0.38061772964217444
2023-04-05 04:51:36,016 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 04:51:36,016 - Detection -   best_eval_score = 94.87
2023-04-05 04:51:36,016 - Detection -   eval_score = 94.51
2023-04-05 04:51:36,016 - Detection -   train_loss = 0.3250310927290808
2023-04-05 04:51:45,336 - Detection - ***** Epoch: 15: Eval results *****
2023-04-05 04:51:45,336 - Detection -   best_eval_score = 94.87
2023-04-05 04:51:45,336 - Detection -   eval_score = 95.04
2023-04-05 04:51:45,336 - Detection -   train_loss = 0.2819995107975873
2023-04-05 04:51:54,727 - Detection - ***** Epoch: 16: Eval results *****
2023-04-05 04:51:54,727 - Detection -   best_eval_score = 95.04
2023-04-05 04:51:54,727 - Detection -   eval_score = 94.87
2023-04-05 04:51:54,727 - Detection -   train_loss = 0.24785160036249596
2023-04-05 04:52:04,004 - Detection - ***** Epoch: 17: Eval results *****
2023-04-05 04:52:04,005 - Detection -   best_eval_score = 95.04
2023-04-05 04:52:04,005 - Detection -   eval_score = 95.09
2023-04-05 04:52:04,005 - Detection -   train_loss = 0.2210466331717643
2023-04-05 04:52:13,278 - Detection - ***** Epoch: 18: Eval results *****
2023-04-05 04:52:13,278 - Detection -   best_eval_score = 95.09
2023-04-05 04:52:13,278 - Detection -   eval_score = 95.09
2023-04-05 04:52:13,278 - Detection -   train_loss = 0.20058139735324818
2023-04-05 04:52:22,547 - Detection - ***** Epoch: 19: Eval results *****
2023-04-05 04:52:22,547 - Detection -   best_eval_score = 95.09
2023-04-05 04:52:22,547 - Detection -   eval_score = 95.22
2023-04-05 04:52:22,547 - Detection -   train_loss = 0.18507567928595978
2023-04-05 04:52:31,808 - Detection - ***** Epoch: 20: Eval results *****
2023-04-05 04:52:31,808 - Detection -   best_eval_score = 95.22
2023-04-05 04:52:31,808 - Detection -   eval_score = 95.27
2023-04-05 04:52:31,808 - Detection -   train_loss = 0.16649896643039855
2023-04-05 04:52:41,063 - Detection - ***** Epoch: 21: Eval results *****
2023-04-05 04:52:41,063 - Detection -   best_eval_score = 95.27
2023-04-05 04:52:41,063 - Detection -   eval_score = 95.27
2023-04-05 04:52:41,063 - Detection -   train_loss = 0.15481167659163475
2023-04-05 04:52:50,316 - Detection - ***** Epoch: 22: Eval results *****
2023-04-05 04:52:50,316 - Detection -   best_eval_score = 95.27
2023-04-05 04:52:50,316 - Detection -   eval_score = 94.96
2023-04-05 04:52:50,316 - Detection -   train_loss = 0.1437555601481687
2023-04-05 04:52:59,569 - Detection - ***** Epoch: 23: Eval results *****
2023-04-05 04:52:59,570 - Detection -   best_eval_score = 95.27
2023-04-05 04:52:59,570 - Detection -   eval_score = 95.45
2023-04-05 04:52:59,570 - Detection -   train_loss = 0.13359273606064645
2023-04-05 04:53:08,827 - Detection - ***** Epoch: 24: Eval results *****
2023-04-05 04:53:08,827 - Detection -   best_eval_score = 95.45
2023-04-05 04:53:08,828 - Detection -   eval_score = 95.54
2023-04-05 04:53:08,828 - Detection -   train_loss = 0.12289737097241661
2023-04-05 04:53:18,085 - Detection - ***** Epoch: 25: Eval results *****
2023-04-05 04:53:18,085 - Detection -   best_eval_score = 95.54
2023-04-05 04:53:18,085 - Detection -   eval_score = 95.45
2023-04-05 04:53:18,085 - Detection -   train_loss = 0.11554587115956978
2023-04-05 04:53:27,324 - Detection - ***** Epoch: 26: Eval results *****
2023-04-05 04:53:27,324 - Detection -   best_eval_score = 95.54
2023-04-05 04:53:27,324 - Detection -   eval_score = 95.58
2023-04-05 04:53:27,324 - Detection -   train_loss = 0.10953782219439745
2023-04-05 04:53:36,567 - Detection - ***** Epoch: 27: Eval results *****
2023-04-05 04:53:36,567 - Detection -   best_eval_score = 95.58
2023-04-05 04:53:36,567 - Detection -   eval_score = 95.54
2023-04-05 04:53:36,567 - Detection -   train_loss = 0.09961429797112942
2023-04-05 04:53:45,796 - Detection - ***** Epoch: 28: Eval results *****
2023-04-05 04:53:45,796 - Detection -   best_eval_score = 95.58
2023-04-05 04:53:45,796 - Detection -   eval_score = 95.58
2023-04-05 04:53:45,796 - Detection -   train_loss = 0.09848376977342096
2023-04-05 04:53:55,028 - Detection - ***** Epoch: 29: Eval results *****
2023-04-05 04:53:55,028 - Detection -   best_eval_score = 95.58
2023-04-05 04:53:55,028 - Detection -   eval_score = 95.62
2023-04-05 04:53:55,028 - Detection -   train_loss = 0.09144570733505217
2023-04-05 04:54:04,365 - Detection - ***** Epoch: 30: Eval results *****
2023-04-05 04:54:04,366 - Detection -   best_eval_score = 95.62
2023-04-05 04:54:04,366 - Detection -   eval_score = 95.49
2023-04-05 04:54:04,366 - Detection -   train_loss = 0.08661293898793784
2023-04-05 04:54:13,596 - Detection - ***** Epoch: 31: Eval results *****
2023-04-05 04:54:13,596 - Detection -   best_eval_score = 95.62
2023-04-05 04:54:13,596 - Detection -   eval_score = 95.71
2023-04-05 04:54:13,596 - Detection -   train_loss = 0.08052269686860117
2023-04-05 04:54:22,833 - Detection - ***** Epoch: 32: Eval results *****
2023-04-05 04:54:22,833 - Detection -   best_eval_score = 95.71
2023-04-05 04:54:22,834 - Detection -   eval_score = 95.76
2023-04-05 04:54:22,834 - Detection -   train_loss = 0.07753269374370575
2023-04-05 04:54:32,070 - Detection - ***** Epoch: 33: Eval results *****
2023-04-05 04:54:32,070 - Detection -   best_eval_score = 95.76
2023-04-05 04:54:32,070 - Detection -   eval_score = 95.89
2023-04-05 04:54:32,070 - Detection -   train_loss = 0.07214495903727683
2023-04-05 04:54:41,298 - Detection - ***** Epoch: 34: Eval results *****
2023-04-05 04:54:41,298 - Detection -   best_eval_score = 95.89
2023-04-05 04:54:41,299 - Detection -   eval_score = 95.85
2023-04-05 04:54:41,299 - Detection -   train_loss = 0.07096316902474924
2023-04-05 04:54:50,537 - Detection - ***** Epoch: 35: Eval results *****
2023-04-05 04:54:50,537 - Detection -   best_eval_score = 95.89
2023-04-05 04:54:50,537 - Detection -   eval_score = 95.94
2023-04-05 04:54:50,537 - Detection -   train_loss = 0.06517974329604344
2023-04-05 04:54:59,748 - Detection - ***** Epoch: 36: Eval results *****
2023-04-05 04:54:59,748 - Detection -   best_eval_score = 95.94
2023-04-05 04:54:59,748 - Detection -   eval_score = 95.98
2023-04-05 04:54:59,748 - Detection -   train_loss = 0.06485758954659104
2023-04-05 04:55:08,943 - Detection - ***** Epoch: 37: Eval results *****
2023-04-05 04:55:08,943 - Detection -   best_eval_score = 95.98
2023-04-05 04:55:08,943 - Detection -   eval_score = 96.07
2023-04-05 04:55:08,943 - Detection -   train_loss = 0.06090980531139807
2023-04-05 04:55:18,150 - Detection - ***** Epoch: 38: Eval results *****
2023-04-05 04:55:18,151 - Detection -   best_eval_score = 96.07
2023-04-05 04:55:18,151 - Detection -   eval_score = 95.98
2023-04-05 04:55:18,151 - Detection -   train_loss = 0.05703360168263316
2023-04-05 04:55:27,331 - Detection - ***** Epoch: 39: Eval results *****
2023-04-05 04:55:27,331 - Detection -   best_eval_score = 96.07
2023-04-05 04:55:27,331 - Detection -   eval_score = 95.98
2023-04-05 04:55:27,331 - Detection -   train_loss = 0.05652342268943109
2023-04-05 04:55:36,532 - Detection - ***** Epoch: 40: Eval results *****
2023-04-05 04:55:36,532 - Detection -   best_eval_score = 96.07
2023-04-05 04:55:36,532 - Detection -   eval_score = 95.98
2023-04-05 04:55:36,532 - Detection -   train_loss = 0.052486537214876575
2023-04-05 04:55:45,722 - Detection - ***** Epoch: 41: Eval results *****
2023-04-05 04:55:45,723 - Detection -   best_eval_score = 96.07
2023-04-05 04:55:45,723 - Detection -   eval_score = 95.98
2023-04-05 04:55:45,723 - Detection -   train_loss = 0.051764433780177074
2023-04-05 04:55:54,921 - Detection - ***** Epoch: 42: Eval results *****
2023-04-05 04:55:54,921 - Detection -   best_eval_score = 96.07
2023-04-05 04:55:54,921 - Detection -   eval_score = 96.03
2023-04-05 04:55:54,921 - Detection -   train_loss = 0.04981058617969128
2023-04-05 04:56:04,113 - Detection - ***** Epoch: 43: Eval results *****
2023-04-05 04:56:04,113 - Detection -   best_eval_score = 96.07
2023-04-05 04:56:04,113 - Detection -   eval_score = 96.03
2023-04-05 04:56:04,113 - Detection -   train_loss = 0.04762396411123601
2023-04-05 04:56:13,408 - Detection - ***** Epoch: 44: Eval results *****
2023-04-05 04:56:13,408 - Detection -   best_eval_score = 96.07
2023-04-05 04:56:13,408 - Detection -   eval_score = 96.03
2023-04-05 04:56:13,408 - Detection -   train_loss = 0.04657686971635981
2023-04-05 04:56:22,617 - Detection - ***** Epoch: 45: Eval results *****
2023-04-05 04:56:22,617 - Detection -   best_eval_score = 96.07
2023-04-05 04:56:22,618 - Detection -   eval_score = 96.07
2023-04-05 04:56:22,618 - Detection -   train_loss = 0.04470670769329776
2023-04-05 04:56:31,820 - Detection - ***** Epoch: 46: Eval results *****
2023-04-05 04:56:31,820 - Detection -   best_eval_score = 96.07
2023-04-05 04:56:31,820 - Detection -   eval_score = 96.12
2023-04-05 04:56:31,820 - Detection -   train_loss = 0.04425445321778005
2023-04-05 04:56:41,010 - Detection - ***** Epoch: 47: Eval results *****
2023-04-05 04:56:41,010 - Detection -   best_eval_score = 96.12
2023-04-05 04:56:41,010 - Detection -   eval_score = 96.12
2023-04-05 04:56:41,010 - Detection -   train_loss = 0.0413584623655135
2023-04-05 04:56:50,212 - Detection - ***** Epoch: 48: Eval results *****
2023-04-05 04:56:50,212 - Detection -   best_eval_score = 96.12
2023-04-05 04:56:50,212 - Detection -   eval_score = 96.12
2023-04-05 04:56:50,212 - Detection -   train_loss = 0.04092441035688601
2023-04-05 04:56:59,407 - Detection - ***** Epoch: 49: Eval results *****
2023-04-05 04:56:59,407 - Detection -   best_eval_score = 96.12
2023-04-05 04:56:59,407 - Detection -   eval_score = 96.07
2023-04-05 04:56:59,408 - Detection -   train_loss = 0.03824644152667712
2023-04-05 04:57:08,618 - Detection - ***** Epoch: 50: Eval results *****
2023-04-05 04:57:08,618 - Detection -   best_eval_score = 96.12
2023-04-05 04:57:08,618 - Detection -   eval_score = 96.03
2023-04-05 04:57:08,618 - Detection -   train_loss = 0.0389823392033577
2023-04-05 04:57:17,827 - Detection - ***** Epoch: 51: Eval results *****
2023-04-05 04:57:17,827 - Detection -   best_eval_score = 96.12
2023-04-05 04:57:17,827 - Detection -   eval_score = 96.07
2023-04-05 04:57:17,827 - Detection -   train_loss = 0.03591553765264424
2023-04-05 04:57:27,051 - Detection - ***** Epoch: 52: Eval results *****
2023-04-05 04:57:27,051 - Detection -   best_eval_score = 96.12
2023-04-05 04:57:27,051 - Detection -   eval_score = 96.07
2023-04-05 04:57:27,051 - Detection -   train_loss = 0.03515137164768847
2023-04-05 04:57:36,247 - Detection - ***** Epoch: 53: Eval results *****
2023-04-05 04:57:36,247 - Detection -   best_eval_score = 96.12
2023-04-05 04:57:36,247 - Detection -   eval_score = 96.12
2023-04-05 04:57:36,247 - Detection -   train_loss = 0.03410296040502461
2023-04-05 04:57:45,455 - Detection - ***** Epoch: 54: Eval results *****
2023-04-05 04:57:45,455 - Detection -   best_eval_score = 96.12
2023-04-05 04:57:45,455 - Detection -   eval_score = 96.12
2023-04-05 04:57:45,455 - Detection -   train_loss = 0.03412070519036867
2023-04-05 04:57:54,661 - Detection - ***** Epoch: 55: Eval results *****
2023-04-05 04:57:54,661 - Detection -   best_eval_score = 96.12
2023-04-05 04:57:54,661 - Detection -   eval_score = 96.21
2023-04-05 04:57:54,661 - Detection -   train_loss = 0.032028966286981646
2023-04-05 04:58:03,883 - Detection - ***** Epoch: 56: Eval results *****
2023-04-05 04:58:03,883 - Detection -   best_eval_score = 96.21
2023-04-05 04:58:03,883 - Detection -   eval_score = 96.07
2023-04-05 04:58:03,883 - Detection -   train_loss = 0.031034378133798866
2023-04-05 04:58:13,078 - Detection - ***** Epoch: 57: Eval results *****
2023-04-05 04:58:13,078 - Detection -   best_eval_score = 96.21
2023-04-05 04:58:13,078 - Detection -   eval_score = 96.03
2023-04-05 04:58:13,078 - Detection -   train_loss = 0.030003183605996044
2023-04-05 04:58:22,290 - Detection - ***** Epoch: 58: Eval results *****
2023-04-05 04:58:22,290 - Detection -   best_eval_score = 96.21
2023-04-05 04:58:22,290 - Detection -   eval_score = 96.16
2023-04-05 04:58:22,290 - Detection -   train_loss = 0.029841254772195083
2023-04-05 04:58:31,507 - Detection - ***** Epoch: 59: Eval results *****
2023-04-05 04:58:31,507 - Detection -   best_eval_score = 96.21
2023-04-05 04:58:31,507 - Detection -   eval_score = 96.12
2023-04-05 04:58:31,507 - Detection -   train_loss = 0.027178202004341238
2023-04-05 04:58:40,810 - Detection - ***** Epoch: 60: Eval results *****
2023-04-05 04:58:40,811 - Detection -   best_eval_score = 96.21
2023-04-05 04:58:40,811 - Detection -   eval_score = 96.07
2023-04-05 04:58:40,811 - Detection -   train_loss = 0.0286979604808783
2023-04-05 04:58:49,997 - Detection - ***** Epoch: 61: Eval results *****
2023-04-05 04:58:49,997 - Detection -   best_eval_score = 96.21
2023-04-05 04:58:49,997 - Detection -   eval_score = 96.03
2023-04-05 04:58:49,997 - Detection -   train_loss = 0.027406721090135925
2023-04-05 04:58:59,167 - Detection - ***** Epoch: 62: Eval results *****
2023-04-05 04:58:59,167 - Detection -   best_eval_score = 96.21
2023-04-05 04:58:59,167 - Detection -   eval_score = 96.12
2023-04-05 04:58:59,167 - Detection -   train_loss = 0.025722051653164355
2023-04-05 04:59:08,349 - Detection - ***** Epoch: 63: Eval results *****
2023-04-05 04:59:08,349 - Detection -   best_eval_score = 96.21
2023-04-05 04:59:08,349 - Detection -   eval_score = 96.16
2023-04-05 04:59:08,349 - Detection -   train_loss = 0.02582802027675577
2023-04-05 04:59:17,527 - Detection - ***** Epoch: 64: Eval results *****
2023-04-05 04:59:17,527 - Detection -   best_eval_score = 96.21
2023-04-05 04:59:17,527 - Detection -   eval_score = 96.12
2023-04-05 04:59:17,527 - Detection -   train_loss = 0.025719519947994162
2023-04-05 04:59:26,699 - Detection - ***** Epoch: 65: Eval results *****
2023-04-05 04:59:26,699 - Detection -   best_eval_score = 96.21
2023-04-05 04:59:26,699 - Detection -   eval_score = 96.03
2023-04-05 04:59:26,699 - Detection -   train_loss = 0.02482329469851472
2023-04-05 04:59:26,700 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_0.75_1.0_bert_7/models
2023-04-05 04:59:27,245 - Detection - Pre-training finished...
2023-04-05 04:59:27,245 - Detection - Training Begin...
2023-04-05 04:59:43,126 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 04:59:43,126 - Detection -   best_eval_score = 0
2023-04-05 04:59:43,126 - Detection -   eval_score = 0.08
2023-04-05 04:59:43,126 - Detection -   train_loss = 16.114074772054497
2023-04-05 04:59:52,207 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 04:59:52,207 - Detection -   best_eval_score = 0.08
2023-04-05 04:59:52,207 - Detection -   eval_score = 14.11
2023-04-05 04:59:52,207 - Detection -   train_loss = 12.631892962889237
2023-04-05 05:00:01,295 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 05:00:01,296 - Detection -   best_eval_score = 14.11
2023-04-05 05:00:01,296 - Detection -   eval_score = 59.95
2023-04-05 05:00:01,296 - Detection -   train_loss = 9.133116911758076
2023-04-05 05:00:10,394 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 05:00:10,394 - Detection -   best_eval_score = 59.95
2023-04-05 05:00:10,394 - Detection -   eval_score = 83.55
2023-04-05 05:00:10,394 - Detection -   train_loss = 5.724918617443605
2023-04-05 05:00:19,503 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 05:00:19,503 - Detection -   best_eval_score = 83.55
2023-04-05 05:00:19,503 - Detection -   eval_score = 91.06
2023-04-05 05:00:19,503 - Detection -   train_loss = 2.8419678197665648
2023-04-05 05:00:28,610 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 05:00:28,610 - Detection -   best_eval_score = 91.06
2023-04-05 05:00:28,610 - Detection -   eval_score = 92.45
2023-04-05 05:00:28,610 - Detection -   train_loss = 1.7996688661250202
2023-04-05 05:00:37,736 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 05:00:37,736 - Detection -   best_eval_score = 92.45
2023-04-05 05:00:37,736 - Detection -   eval_score = 92.79
2023-04-05 05:00:37,736 - Detection -   train_loss = 1.7059765647758136
2023-04-05 05:00:46,855 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 05:00:46,856 - Detection -   best_eval_score = 92.79
2023-04-05 05:00:46,856 - Detection -   eval_score = 92.65
2023-04-05 05:00:46,856 - Detection -   train_loss = 1.6928022111004049
2023-04-05 05:00:55,970 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 05:00:55,970 - Detection -   best_eval_score = 92.79
2023-04-05 05:00:55,970 - Detection -   eval_score = 92.73
2023-04-05 05:00:55,970 - Detection -   train_loss = 1.6964984319426797
2023-04-05 05:01:05,084 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 05:01:05,084 - Detection -   best_eval_score = 92.79
2023-04-05 05:01:05,084 - Detection -   eval_score = 92.76
2023-04-05 05:01:05,084 - Detection -   train_loss = 1.678943694992499
2023-04-05 05:01:14,204 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 05:01:14,204 - Detection -   best_eval_score = 92.79
2023-04-05 05:01:14,204 - Detection -   eval_score = 92.76
2023-04-05 05:01:14,204 - Detection -   train_loss = 1.687680186195807
2023-04-05 05:01:23,405 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 05:01:23,405 - Detection -   best_eval_score = 92.79
2023-04-05 05:01:23,405 - Detection -   eval_score = 92.76
2023-04-05 05:01:23,405 - Detection -   train_loss = 1.6845498179847544
2023-04-05 05:01:32,525 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 05:01:32,525 - Detection -   best_eval_score = 92.79
2023-04-05 05:01:32,525 - Detection -   eval_score = 92.73
2023-04-05 05:01:32,525 - Detection -   train_loss = 1.6891559199853377
2023-04-05 05:01:41,630 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 05:01:41,630 - Detection -   best_eval_score = 92.79
2023-04-05 05:01:41,630 - Detection -   eval_score = 92.72
2023-04-05 05:01:41,630 - Detection -   train_loss = 1.6715268140489405
2023-04-05 05:01:50,742 - Detection - ***** Epoch: 15: Eval results *****
2023-04-05 05:01:50,742 - Detection -   best_eval_score = 92.79
2023-04-05 05:01:50,742 - Detection -   eval_score = 92.81
2023-04-05 05:01:50,742 - Detection -   train_loss = 1.707773276350715
2023-04-05 05:01:59,848 - Detection - ***** Epoch: 16: Eval results *****
2023-04-05 05:01:59,848 - Detection -   best_eval_score = 92.81
2023-04-05 05:01:59,848 - Detection -   eval_score = 92.81
2023-04-05 05:01:59,848 - Detection -   train_loss = 1.6943724345077167
2023-04-05 05:02:08,994 - Detection - ***** Epoch: 17: Eval results *****
2023-04-05 05:02:08,994 - Detection -   best_eval_score = 92.81
2023-04-05 05:02:08,994 - Detection -   eval_score = 92.84
2023-04-05 05:02:08,994 - Detection -   train_loss = 1.679439815607938
2023-04-05 05:02:18,106 - Detection - ***** Epoch: 18: Eval results *****
2023-04-05 05:02:18,106 - Detection -   best_eval_score = 92.84
2023-04-05 05:02:18,106 - Detection -   eval_score = 92.79
2023-04-05 05:02:18,106 - Detection -   train_loss = 1.6912299475886605
2023-04-05 05:02:27,197 - Detection - ***** Epoch: 19: Eval results *****
2023-04-05 05:02:27,197 - Detection -   best_eval_score = 92.84
2023-04-05 05:02:27,197 - Detection -   eval_score = 92.77
2023-04-05 05:02:27,197 - Detection -   train_loss = 1.6999722190878608
2023-04-05 05:02:36,288 - Detection - ***** Epoch: 20: Eval results *****
2023-04-05 05:02:36,288 - Detection -   best_eval_score = 92.84
2023-04-05 05:02:36,288 - Detection -   eval_score = 92.85
2023-04-05 05:02:36,288 - Detection -   train_loss = 1.6961485702883115
2023-04-05 05:02:45,400 - Detection - ***** Epoch: 21: Eval results *****
2023-04-05 05:02:45,400 - Detection -   best_eval_score = 92.85
2023-04-05 05:02:45,400 - Detection -   eval_score = 92.76
2023-04-05 05:02:45,400 - Detection -   train_loss = 1.686116408218037
2023-04-05 05:02:54,501 - Detection - ***** Epoch: 22: Eval results *****
2023-04-05 05:02:54,501 - Detection -   best_eval_score = 92.85
2023-04-05 05:02:54,502 - Detection -   eval_score = 92.8
2023-04-05 05:02:54,502 - Detection -   train_loss = 1.691477197137746
2023-04-05 05:03:03,607 - Detection - ***** Epoch: 23: Eval results *****
2023-04-05 05:03:03,608 - Detection -   best_eval_score = 92.85
2023-04-05 05:03:03,608 - Detection -   eval_score = 92.64
2023-04-05 05:03:03,608 - Detection -   train_loss = 1.6999678747220472
2023-04-05 05:03:12,725 - Detection - ***** Epoch: 24: Eval results *****
2023-04-05 05:03:12,725 - Detection -   best_eval_score = 92.85
2023-04-05 05:03:12,725 - Detection -   eval_score = 92.76
2023-04-05 05:03:12,725 - Detection -   train_loss = 1.6869976439259269
2023-04-05 05:03:21,831 - Detection - ***** Epoch: 25: Eval results *****
2023-04-05 05:03:21,831 - Detection -   best_eval_score = 92.85
2023-04-05 05:03:21,831 - Detection -   eval_score = 92.82
2023-04-05 05:03:21,831 - Detection -   train_loss = 1.696117104454474
2023-04-05 05:03:30,929 - Detection - ***** Epoch: 26: Eval results *****
2023-04-05 05:03:30,929 - Detection -   best_eval_score = 92.85
2023-04-05 05:03:30,929 - Detection -   eval_score = 92.82
2023-04-05 05:03:30,929 - Detection -   train_loss = 1.6928383938290856
2023-04-05 05:03:40,019 - Detection - ***** Epoch: 27: Eval results *****
2023-04-05 05:03:40,019 - Detection -   best_eval_score = 92.85
2023-04-05 05:03:40,019 - Detection -   eval_score = 92.83
2023-04-05 05:03:40,019 - Detection -   train_loss = 1.6903940994631161
2023-04-05 05:03:49,142 - Detection - ***** Epoch: 28: Eval results *****
2023-04-05 05:03:49,142 - Detection -   best_eval_score = 92.85
2023-04-05 05:03:49,142 - Detection -   eval_score = 92.74
2023-04-05 05:03:49,142 - Detection -   train_loss = 1.6773089265281504
2023-04-05 05:03:58,354 - Detection - ***** Epoch: 29: Eval results *****
2023-04-05 05:03:58,354 - Detection -   best_eval_score = 92.85
2023-04-05 05:03:58,354 - Detection -   eval_score = 92.88
2023-04-05 05:03:58,354 - Detection -   train_loss = 1.703736188736829
2023-04-05 05:04:07,454 - Detection - ***** Epoch: 30: Eval results *****
2023-04-05 05:04:07,454 - Detection -   best_eval_score = 92.88
2023-04-05 05:04:07,454 - Detection -   eval_score = 92.8
2023-04-05 05:04:07,454 - Detection -   train_loss = 1.689080991528251
2023-04-05 05:04:16,574 - Detection - ***** Epoch: 31: Eval results *****
2023-04-05 05:04:16,574 - Detection -   best_eval_score = 92.88
2023-04-05 05:04:16,574 - Detection -   eval_score = 92.85
2023-04-05 05:04:16,574 - Detection -   train_loss = 1.6960410557009957
2023-04-05 05:04:25,688 - Detection - ***** Epoch: 32: Eval results *****
2023-04-05 05:04:25,688 - Detection -   best_eval_score = 92.88
2023-04-05 05:04:25,688 - Detection -   eval_score = 92.8
2023-04-05 05:04:25,688 - Detection -   train_loss = 1.6774052869189868
2023-04-05 05:04:34,807 - Detection - ***** Epoch: 33: Eval results *****
2023-04-05 05:04:34,807 - Detection -   best_eval_score = 92.88
2023-04-05 05:04:34,807 - Detection -   eval_score = 92.82
2023-04-05 05:04:34,807 - Detection -   train_loss = 1.7113112739541314
2023-04-05 05:04:43,929 - Detection - ***** Epoch: 34: Eval results *****
2023-04-05 05:04:43,929 - Detection -   best_eval_score = 92.88
2023-04-05 05:04:43,929 - Detection -   eval_score = 92.63
2023-04-05 05:04:43,929 - Detection -   train_loss = 1.6977760656313463
2023-04-05 05:04:53,038 - Detection - ***** Epoch: 35: Eval results *****
2023-04-05 05:04:53,038 - Detection -   best_eval_score = 92.88
2023-04-05 05:04:53,038 - Detection -   eval_score = 92.73
2023-04-05 05:04:53,038 - Detection -   train_loss = 1.6846484717997638
2023-04-05 05:05:02,143 - Detection - ***** Epoch: 36: Eval results *****
2023-04-05 05:05:02,144 - Detection -   best_eval_score = 92.88
2023-04-05 05:05:02,144 - Detection -   eval_score = 92.84
2023-04-05 05:05:02,144 - Detection -   train_loss = 1.6856064525517551
2023-04-05 05:05:11,240 - Detection - ***** Epoch: 37: Eval results *****
2023-04-05 05:05:11,240 - Detection -   best_eval_score = 92.88
2023-04-05 05:05:11,240 - Detection -   eval_score = 92.66
2023-04-05 05:05:11,240 - Detection -   train_loss = 1.6981535255908966
2023-04-05 05:05:20,326 - Detection - ***** Epoch: 38: Eval results *****
2023-04-05 05:05:20,326 - Detection -   best_eval_score = 92.88
2023-04-05 05:05:20,326 - Detection -   eval_score = 92.83
2023-04-05 05:05:20,326 - Detection -   train_loss = 1.6912925947796216
2023-04-05 05:05:29,423 - Detection - ***** Epoch: 39: Eval results *****
2023-04-05 05:05:29,423 - Detection -   best_eval_score = 92.88
2023-04-05 05:05:29,423 - Detection -   eval_score = 92.72
2023-04-05 05:05:29,423 - Detection -   train_loss = 1.6947552941062234
2023-04-05 05:05:29,425 - Detection - Training Finished...
2023-04-05 05:05:29,425 - Detection - Testing begin...
2023-04-05 05:05:32,920 - Detection - ***** Test: Confusion Matrix *****
2023-04-05 05:05:32,920 - Detection - [[  19    0    0 ...    0    0   11]
 [   0   24    0 ...    0    0    4]
 [   0    0   25 ...    0    0    2]
 ...
 [   0    0    0 ...   25    0    5]
 [   0    0    0 ...    0   25    3]
 [   0    0    1 ...    2    3 1962]]
2023-04-05 05:05:32,920 - Detection - ***** Test results *****
2023-04-05 05:05:32,920 - Detection -   Acc = 87.4
2023-04-05 05:05:32,920 - Detection -   F1 = 89.1268
2023-04-05 05:05:32,920 - Detection -   F1-known = 89.1584
2023-04-05 05:05:32,920 - Detection -   F1-open = 85.5834
2023-04-05 05:05:32,920 - Detection - Testing finished...
2023-04-05 05:05:32,920 - Detection - Results saved in results/results_ADB.csv
2023-04-05 05:05:32,945 - Detection - Open Intent Detection Finished...
