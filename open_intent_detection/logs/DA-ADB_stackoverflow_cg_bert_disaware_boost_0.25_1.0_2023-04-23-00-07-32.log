2023-04-23 00:07:32,030 - Detection - Open Intent Detection Begin...
2023-04-23 00:07:32,030 - Detection - Parameters Initialization...
2023-04-23 00:07:32,030 - Detection - ============================== Params ==============================
2023-04-23 00:07:32,030 - Detection - type:	open_intent_detection
2023-04-23 00:07:32,030 - Detection - logger_name:	Detection
2023-04-23 00:07:32,030 - Detection - log_dir:	logs
2023-04-23 00:07:32,030 - Detection - dataset:	stackoverflow_cg
2023-04-23 00:07:32,030 - Detection - known_cls_ratio:	0.25
2023-04-23 00:07:32,030 - Detection - labeled_ratio:	1.0
2023-04-23 00:07:32,030 - Detection - method:	DA-ADB
2023-04-23 00:07:32,030 - Detection - train:	True
2023-04-23 00:07:32,030 - Detection - pretrain:	True
2023-04-23 00:07:32,030 - Detection - save_model:	False
2023-04-23 00:07:32,030 - Detection - backbone:	bert_disaware_boost
2023-04-23 00:07:32,030 - Detection - config_file_name:	DA-ADB
2023-04-23 00:07:32,030 - Detection - seed:	8
2023-04-23 00:07:32,030 - Detection - gpu_id:	0
2023-04-23 00:07:32,030 - Detection - pipe_results_path:	pipe_results
2023-04-23 00:07:32,030 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-23 00:07:32,030 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-23 00:07:32,030 - Detection - model_dir:	models
2023-04-23 00:07:32,030 - Detection - load_pretrained_method:	None
2023-04-23 00:07:32,030 - Detection - result_dir:	results
2023-04-23 00:07:32,031 - Detection - results_file_name:	results_DA-ADB-BOOST-F-4.csv
2023-04-23 00:07:32,031 - Detection - save_results:	True
2023-04-23 00:07:32,031 - Detection - loss_fct:	CrossEntropyLoss
2023-04-23 00:07:32,031 - Detection - boost_method:	F-4
2023-04-23 00:07:32,031 - Detection - boost_start_score:	0.0
2023-04-23 00:07:32,031 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.25_1.0_bert_disaware_boost_8
2023-04-23 00:07:32,031 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.25_1.0_bert_disaware_boost_8/models
2023-04-23 00:07:32,031 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-23 00:07:32,031 - Detection - num_train_epochs:	100
2023-04-23 00:07:32,031 - Detection - num_labels:	None
2023-04-23 00:07:32,031 - Detection - max_seq_length:	None
2023-04-23 00:07:32,031 - Detection - freeze_backbone_parameters:	True
2023-04-23 00:07:32,031 - Detection - feat_dim:	768
2023-04-23 00:07:32,031 - Detection - warmup_proportion:	0.1
2023-04-23 00:07:32,031 - Detection - scale:	4
2023-04-23 00:07:32,031 - Detection - lr_boundary:	0.05
2023-04-23 00:07:32,031 - Detection - lr:	2e-05
2023-04-23 00:07:32,031 - Detection - activation:	relu
2023-04-23 00:07:32,031 - Detection - train_batch_size:	128
2023-04-23 00:07:32,031 - Detection - eval_batch_size:	64
2023-04-23 00:07:32,031 - Detection - test_batch_size:	64
2023-04-23 00:07:32,031 - Detection - wait_patient:	10
2023-04-23 00:07:32,031 - Detection - ============================== End Params ==============================
2023-04-23 00:07:32,031 - Detection - Data and Model Preparation...
2023-04-23 00:07:32,031 - Detection - The number of known intents is 5
2023-04-23 00:07:32,032 - Detection - Lists of known labels are: ['hibernate', 'oracle', 'haskell', 'sharepoint', 'visual-studio']
2023-04-23 00:07:32,039 - Detection - Number of labeled training samples = 720
2023-04-23 00:07:32,039 - Detection - Number of unlabeled training samples = 2071
2023-04-23 00:07:32,042 - Detection - Number of evaluation samples = 319
2023-04-23 00:07:32,048 - Detection - Number of testing samples = 2905
2023-04-23 00:07:37,525 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-23 00:07:37,639 - Detection - Pre-training Begin...
2023-04-23 00:07:39,498 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 00:07:39,498 - Detection -   best_eval_score = 0
2023-04-23 00:07:39,498 - Detection -   eval_score = 5.25
2023-04-23 00:07:39,498 - Detection -   train_loss = 1.603974719842275
2023-04-23 00:07:44,261 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 00:07:44,261 - Detection -   best_eval_score = 5.25
2023-04-23 00:07:44,261 - Detection -   eval_score = 4.65
2023-04-23 00:07:44,261 - Detection -   train_loss = 1.5963230927785237
2023-04-23 00:07:48,966 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 00:07:48,966 - Detection -   best_eval_score = 5.25
2023-04-23 00:07:48,966 - Detection -   eval_score = 21.43
2023-04-23 00:07:48,966 - Detection -   train_loss = 1.5645578304926555
2023-04-23 00:07:53,661 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 00:07:53,661 - Detection -   best_eval_score = 21.43
2023-04-23 00:07:53,661 - Detection -   eval_score = 44.94
2023-04-23 00:07:53,661 - Detection -   train_loss = 1.4746161699295044
2023-04-23 00:07:58,378 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 00:07:58,378 - Detection -   best_eval_score = 44.94
2023-04-23 00:07:58,378 - Detection -   eval_score = 76.21
2023-04-23 00:07:58,378 - Detection -   train_loss = 1.2487732768058777
2023-04-23 00:08:03,089 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 00:08:03,089 - Detection -   best_eval_score = 76.21
2023-04-23 00:08:03,089 - Detection -   eval_score = 81.49
2023-04-23 00:08:03,089 - Detection -   train_loss = 0.8897495965162913
2023-04-23 00:08:07,946 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 00:08:07,946 - Detection -   best_eval_score = 81.49
2023-04-23 00:08:07,946 - Detection -   eval_score = 80.3
2023-04-23 00:08:07,946 - Detection -   train_loss = 0.6478132009506226
2023-04-23 00:08:12,671 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 00:08:12,671 - Detection -   best_eval_score = 81.49
2023-04-23 00:08:12,671 - Detection -   eval_score = 83.26
2023-04-23 00:08:12,671 - Detection -   train_loss = 0.5151191751162211
2023-04-23 00:08:17,380 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 00:08:17,380 - Detection -   best_eval_score = 83.26
2023-04-23 00:08:17,380 - Detection -   eval_score = 81.9
2023-04-23 00:08:17,380 - Detection -   train_loss = 0.42753371596336365
2023-04-23 00:08:22,131 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 00:08:22,131 - Detection -   best_eval_score = 83.26
2023-04-23 00:08:22,131 - Detection -   eval_score = 80.64
2023-04-23 00:08:22,131 - Detection -   train_loss = 0.3808814386526744
2023-04-23 00:08:26,957 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 00:08:26,957 - Detection -   best_eval_score = 83.26
2023-04-23 00:08:26,957 - Detection -   eval_score = 83.19
2023-04-23 00:08:26,957 - Detection -   train_loss = 0.3550146669149399
2023-04-23 00:08:31,674 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 00:08:31,674 - Detection -   best_eval_score = 83.26
2023-04-23 00:08:31,674 - Detection -   eval_score = 82.96
2023-04-23 00:08:31,674 - Detection -   train_loss = 0.27395738412936527
2023-04-23 00:08:36,388 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 00:08:36,388 - Detection -   best_eval_score = 83.26
2023-04-23 00:08:36,388 - Detection -   eval_score = 83.58
2023-04-23 00:08:36,388 - Detection -   train_loss = 0.22935809940099716
2023-04-23 00:08:41,101 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 00:08:41,101 - Detection -   best_eval_score = 83.58
2023-04-23 00:08:41,101 - Detection -   eval_score = 84.25
2023-04-23 00:08:41,101 - Detection -   train_loss = 0.21149974316358566
2023-04-23 00:08:46,034 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 00:08:46,034 - Detection -   best_eval_score = 84.25
2023-04-23 00:08:46,035 - Detection -   eval_score = 83.75
2023-04-23 00:08:46,035 - Detection -   train_loss = 0.19052723546822867
2023-04-23 00:08:50,872 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 00:08:50,872 - Detection -   best_eval_score = 84.25
2023-04-23 00:08:50,872 - Detection -   eval_score = 83.11
2023-04-23 00:08:50,872 - Detection -   train_loss = 0.1811540573835373
2023-04-23 00:08:55,597 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 00:08:55,597 - Detection -   best_eval_score = 84.25
2023-04-23 00:08:55,597 - Detection -   eval_score = 83.63
2023-04-23 00:08:55,597 - Detection -   train_loss = 0.16935228059689203
2023-04-23 00:09:00,320 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 00:09:00,320 - Detection -   best_eval_score = 84.25
2023-04-23 00:09:00,321 - Detection -   eval_score = 82.53
2023-04-23 00:09:00,321 - Detection -   train_loss = 0.1529244656364123
2023-04-23 00:09:05,145 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 00:09:05,145 - Detection -   best_eval_score = 84.25
2023-04-23 00:09:05,145 - Detection -   eval_score = 83.21
2023-04-23 00:09:05,145 - Detection -   train_loss = 0.14434046298265457
2023-04-23 00:09:09,890 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 00:09:09,890 - Detection -   best_eval_score = 84.25
2023-04-23 00:09:09,890 - Detection -   eval_score = 83.32
2023-04-23 00:09:09,890 - Detection -   train_loss = 0.147383543352286
2023-04-23 00:09:14,635 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 00:09:14,635 - Detection -   best_eval_score = 84.25
2023-04-23 00:09:14,635 - Detection -   eval_score = 82.22
2023-04-23 00:09:14,635 - Detection -   train_loss = 0.13164040942986807
2023-04-23 00:09:19,348 - Detection - ***** Epoch: 22: Eval results *****
2023-04-23 00:09:19,349 - Detection -   best_eval_score = 84.25
2023-04-23 00:09:19,349 - Detection -   eval_score = 83.08
2023-04-23 00:09:19,349 - Detection -   train_loss = 0.12729840104778609
2023-04-23 00:09:24,118 - Detection - ***** Epoch: 23: Eval results *****
2023-04-23 00:09:24,118 - Detection -   best_eval_score = 84.25
2023-04-23 00:09:24,118 - Detection -   eval_score = 82.96
2023-04-23 00:09:24,118 - Detection -   train_loss = 0.12032085781296094
2023-04-23 00:09:28,948 - Detection - ***** Epoch: 24: Eval results *****
2023-04-23 00:09:28,948 - Detection -   best_eval_score = 84.25
2023-04-23 00:09:28,948 - Detection -   eval_score = 83.35
2023-04-23 00:09:28,948 - Detection -   train_loss = 0.1144818589091301
2023-04-23 00:09:28,948 - Detection - Pre-training finished...
2023-04-23 00:09:28,948 - Detection - Training Begin...
2023-04-23 00:09:29,629 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 00:09:29,629 - Detection -   best_eval_score = 0
2023-04-23 00:09:29,629 - Detection -   eval_score = 0.0
2023-04-23 00:09:29,630 - Detection -   train_loss = 4.046487331390381
2023-04-23 00:09:30,310 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 00:09:30,310 - Detection -   best_eval_score = 0
2023-04-23 00:09:30,310 - Detection -   eval_score = 0.44
2023-04-23 00:09:30,310 - Detection -   train_loss = 3.8783242305119834
2023-04-23 00:09:34,582 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 00:09:34,583 - Detection -   best_eval_score = 0.44
2023-04-23 00:09:34,583 - Detection -   eval_score = 27.61
2023-04-23 00:09:34,583 - Detection -   train_loss = 3.6606717507044473
2023-04-23 00:09:38,830 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 00:09:38,830 - Detection -   best_eval_score = 27.61
2023-04-23 00:09:38,830 - Detection -   eval_score = 50.49
2023-04-23 00:09:38,830 - Detection -   train_loss = 2.3472711642583213
2023-04-23 00:09:43,111 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 00:09:43,111 - Detection -   best_eval_score = 50.49
2023-04-23 00:09:43,111 - Detection -   eval_score = 59.46
2023-04-23 00:09:43,111 - Detection -   train_loss = 1.1504366000493367
2023-04-23 00:09:47,383 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 00:09:47,383 - Detection -   best_eval_score = 59.46
2023-04-23 00:09:47,383 - Detection -   eval_score = 61.37
2023-04-23 00:09:47,383 - Detection -   train_loss = 0.9538070559501648
2023-04-23 00:09:51,749 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 00:09:51,749 - Detection -   best_eval_score = 61.37
2023-04-23 00:09:51,749 - Detection -   eval_score = 60.83
2023-04-23 00:09:51,749 - Detection -   train_loss = 0.941305140654246
2023-04-23 00:09:56,024 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 00:09:56,024 - Detection -   best_eval_score = 61.37
2023-04-23 00:09:56,024 - Detection -   eval_score = 60.28
2023-04-23 00:09:56,024 - Detection -   train_loss = 0.983651598294576
2023-04-23 00:10:00,290 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 00:10:00,290 - Detection -   best_eval_score = 61.37
2023-04-23 00:10:00,290 - Detection -   eval_score = 61.2
2023-04-23 00:10:00,291 - Detection -   train_loss = 0.9607811272144318
2023-04-23 00:10:04,541 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 00:10:04,541 - Detection -   best_eval_score = 61.37
2023-04-23 00:10:04,541 - Detection -   eval_score = 61.1
2023-04-23 00:10:04,541 - Detection -   train_loss = 0.9285981158415476
2023-04-23 00:10:08,926 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 00:10:08,926 - Detection -   best_eval_score = 61.37
2023-04-23 00:10:08,926 - Detection -   eval_score = 61.02
2023-04-23 00:10:08,926 - Detection -   train_loss = 0.9491210480531057
2023-04-23 00:10:13,182 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 00:10:13,183 - Detection -   best_eval_score = 61.37
2023-04-23 00:10:13,183 - Detection -   eval_score = 60.83
2023-04-23 00:10:13,183 - Detection -   train_loss = 0.913174569606781
2023-04-23 00:10:17,466 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 00:10:17,466 - Detection -   best_eval_score = 61.37
2023-04-23 00:10:17,466 - Detection -   eval_score = 60.75
2023-04-23 00:10:17,466 - Detection -   train_loss = 0.9219937423865
2023-04-23 00:10:21,721 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 00:10:21,721 - Detection -   best_eval_score = 61.37
2023-04-23 00:10:21,721 - Detection -   eval_score = 61.02
2023-04-23 00:10:21,721 - Detection -   train_loss = 0.9806143939495087
2023-04-23 00:10:26,000 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 00:10:26,000 - Detection -   best_eval_score = 61.37
2023-04-23 00:10:26,000 - Detection -   eval_score = 60.48
2023-04-23 00:10:26,000 - Detection -   train_loss = 0.9619149963061014
2023-04-23 00:10:30,439 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 00:10:30,439 - Detection -   best_eval_score = 61.37
2023-04-23 00:10:30,439 - Detection -   eval_score = 61.1
2023-04-23 00:10:30,439 - Detection -   train_loss = 0.9135414759318033
2023-04-23 00:10:30,440 - Detection - Training Finished...
2023-04-23 00:10:30,440 - Detection - Testing begin...
2023-04-23 00:10:32,192 - Detection - ***** Test: Confusion Matrix *****
2023-04-23 00:10:32,192 - Detection - [[  85    7    2    1    0   33]
 [   0  102    3    1    1   20]
 [   0    1   52    1    1   67]
 [   0    0    0  137    2   32]
 [   0    1    1    4   42   58]
 [  17   39  185  135   77 1798]]
2023-04-23 00:10:32,192 - Detection - ***** Test results *****
2023-04-23 00:10:32,192 - Detection -   Acc = 76.28
2023-04-23 00:10:32,192 - Detection -   F1 = 59.6759
2023-04-23 00:10:32,192 - Detection -   F1-known = 54.7245
2023-04-23 00:10:32,192 - Detection -   F1-open = 84.433
2023-04-23 00:10:32,192 - Detection - Testing finished...
2023-04-23 00:10:32,192 - Detection - Results saved in results/results_DA-ADB-BOOST-F-4.csv
2023-04-23 00:10:32,211 - Detection - Open Intent Detection Finished...
