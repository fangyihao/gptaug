2023-04-04 13:39:39,917 - Detection - Open Intent Detection Begin...
2023-04-04 13:39:39,917 - Detection - Parameters Initialization...
2023-04-04 13:39:39,917 - Detection - ============================== Params ==============================
2023-04-04 13:39:39,917 - Detection - type:	open_intent_detection
2023-04-04 13:39:39,917 - Detection - logger_name:	Detection
2023-04-04 13:39:39,917 - Detection - log_dir:	logs
2023-04-04 13:39:39,917 - Detection - dataset:	banking
2023-04-04 13:39:39,917 - Detection - known_cls_ratio:	0.5
2023-04-04 13:39:39,917 - Detection - labeled_ratio:	1.0
2023-04-04 13:39:39,917 - Detection - method:	DA-ADB
2023-04-04 13:39:39,917 - Detection - train:	True
2023-04-04 13:39:39,917 - Detection - pretrain:	True
2023-04-04 13:39:39,917 - Detection - save_model:	True
2023-04-04 13:39:39,917 - Detection - backbone:	bert_disaware
2023-04-04 13:39:39,917 - Detection - config_file_name:	DA-ADB
2023-04-04 13:39:39,917 - Detection - seed:	1
2023-04-04 13:39:39,917 - Detection - gpu_id:	0
2023-04-04 13:39:39,917 - Detection - pipe_results_path:	pipe_results
2023-04-04 13:39:39,917 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-04 13:39:39,917 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-04 13:39:39,917 - Detection - model_dir:	models
2023-04-04 13:39:39,917 - Detection - load_pretrained_method:	None
2023-04-04 13:39:39,917 - Detection - result_dir:	results
2023-04-04 13:39:39,917 - Detection - results_file_name:	results_DA-ADB.csv
2023-04-04 13:39:39,917 - Detection - save_results:	True
2023-04-04 13:39:39,917 - Detection - loss_fct:	CrossEntropyLoss
2023-04-04 13:39:39,917 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_0.5_1.0_bert_disaware_1
2023-04-04 13:39:39,917 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_0.5_1.0_bert_disaware_1/models
2023-04-04 13:39:39,918 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-04 13:39:39,918 - Detection - num_train_epochs:	100
2023-04-04 13:39:39,918 - Detection - num_labels:	None
2023-04-04 13:39:39,918 - Detection - max_seq_length:	None
2023-04-04 13:39:39,918 - Detection - freeze_backbone_parameters:	True
2023-04-04 13:39:39,918 - Detection - feat_dim:	768
2023-04-04 13:39:39,918 - Detection - warmup_proportion:	0.1
2023-04-04 13:39:39,918 - Detection - scale:	4
2023-04-04 13:39:39,918 - Detection - lr_boundary:	0.05
2023-04-04 13:39:39,918 - Detection - lr:	2e-05
2023-04-04 13:39:39,918 - Detection - activation:	relu
2023-04-04 13:39:39,918 - Detection - train_batch_size:	128
2023-04-04 13:39:39,918 - Detection - eval_batch_size:	64
2023-04-04 13:39:39,918 - Detection - test_batch_size:	64
2023-04-04 13:39:39,918 - Detection - wait_patient:	10
2023-04-04 13:39:39,918 - Detection - ============================== End Params ==============================
2023-04-04 13:39:39,918 - Detection - Data and Model Preparation...
2023-04-04 13:39:39,918 - Detection - The number of known intents is 38
2023-04-04 13:39:39,919 - Detection - Lists of known labels are: ['edit_personal_details', 'lost_or_stolen_phone', 'declined_card_payment', 'why_verify_identity', 'top_up_by_cash_or_cheque', 'top_up_failed', 'top_up_reverted', 'receiving_money', 'failed_transfer', 'top_up_by_card_charge', 'card_about_to_expire', 'reverted_card_payment?', 'exchange_via_app', 'age_limit', 'verify_top_up', 'declined_cash_withdrawal', 'pending_card_payment', 'card_not_working', 'passcode_forgotten', 'card_swallowed', 'wrong_exchange_rate_for_cash_withdrawal', 'verify_source_of_funds', 'transaction_charged_twice', 'wrong_amount_of_cash_received', 'topping_up_by_card', 'extra_charge_on_statement', 'get_disposable_virtual_card', 'terminate_account', 'exchange_rate', 'transfer_timing', 'getting_spare_card', 'cash_withdrawal_not_recognised', 'unable_to_verify_identity', 'apple_pay_or_google_pay', 'order_physical_card', 'top_up_by_bank_transfer_charge', 'get_physical_card', 'pending_cash_withdrawal']
2023-04-04 13:39:39,949 - Detection - Number of labeled training samples = 4378
2023-04-04 13:39:39,949 - Detection - Number of unlabeled training samples = 4625
2023-04-04 13:39:39,952 - Detection - Number of evaluation samples = 485
2023-04-04 13:39:39,959 - Detection - Number of testing samples = 3080
2023-04-04 13:39:48,773 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-04 13:39:48,853 - Detection - Pre-training Begin...
2023-04-04 13:39:59,155 - Detection - ***** Epoch: 1: Eval results *****
2023-04-04 13:39:59,155 - Detection -   best_eval_score = 0
2023-04-04 13:39:59,155 - Detection -   eval_score = 0.49
2023-04-04 13:39:59,155 - Detection -   train_loss = 3.6463588510240825
2023-04-04 13:40:08,901 - Detection - ***** Epoch: 2: Eval results *****
2023-04-04 13:40:08,902 - Detection -   best_eval_score = 0.49
2023-04-04 13:40:08,902 - Detection -   eval_score = 0.32
2023-04-04 13:40:08,902 - Detection -   train_loss = 3.6256682872772217
2023-04-04 13:40:18,669 - Detection - ***** Epoch: 3: Eval results *****
2023-04-04 13:40:18,669 - Detection -   best_eval_score = 0.49
2023-04-04 13:40:18,669 - Detection -   eval_score = 2.01
2023-04-04 13:40:18,669 - Detection -   train_loss = 3.6019188812800818
2023-04-04 13:40:28,488 - Detection - ***** Epoch: 4: Eval results *****
2023-04-04 13:40:28,488 - Detection -   best_eval_score = 2.01
2023-04-04 13:40:28,488 - Detection -   eval_score = 2.6
2023-04-04 13:40:28,488 - Detection -   train_loss = 3.574113927568708
2023-04-04 13:40:38,335 - Detection - ***** Epoch: 5: Eval results *****
2023-04-04 13:40:38,335 - Detection -   best_eval_score = 2.6
2023-04-04 13:40:38,335 - Detection -   eval_score = 16.77
2023-04-04 13:40:38,335 - Detection -   train_loss = 3.5009098461696078
2023-04-04 13:40:48,203 - Detection - ***** Epoch: 6: Eval results *****
2023-04-04 13:40:48,203 - Detection -   best_eval_score = 16.77
2023-04-04 13:40:48,203 - Detection -   eval_score = 45.32
2023-04-04 13:40:48,203 - Detection -   train_loss = 3.296893583025251
2023-04-04 13:40:58,103 - Detection - ***** Epoch: 7: Eval results *****
2023-04-04 13:40:58,103 - Detection -   best_eval_score = 45.32
2023-04-04 13:40:58,103 - Detection -   eval_score = 60.37
2023-04-04 13:40:58,103 - Detection -   train_loss = 2.968093524660383
2023-04-04 13:41:07,993 - Detection - ***** Epoch: 8: Eval results *****
2023-04-04 13:41:07,993 - Detection -   best_eval_score = 60.37
2023-04-04 13:41:07,993 - Detection -   eval_score = 74.52
2023-04-04 13:41:07,993 - Detection -   train_loss = 2.6260643890925817
2023-04-04 13:41:17,875 - Detection - ***** Epoch: 9: Eval results *****
2023-04-04 13:41:17,876 - Detection -   best_eval_score = 74.52
2023-04-04 13:41:17,876 - Detection -   eval_score = 77.99
2023-04-04 13:41:17,876 - Detection -   train_loss = 2.3508076395307267
2023-04-04 13:41:27,757 - Detection - ***** Epoch: 10: Eval results *****
2023-04-04 13:41:27,757 - Detection -   best_eval_score = 77.99
2023-04-04 13:41:27,757 - Detection -   eval_score = 81.53
2023-04-04 13:41:27,758 - Detection -   train_loss = 2.1433240618024554
2023-04-04 13:41:37,636 - Detection - ***** Epoch: 11: Eval results *****
2023-04-04 13:41:37,636 - Detection -   best_eval_score = 81.53
2023-04-04 13:41:37,636 - Detection -   eval_score = 85.93
2023-04-04 13:41:37,636 - Detection -   train_loss = 1.9778553690229144
2023-04-04 13:41:47,511 - Detection - ***** Epoch: 12: Eval results *****
2023-04-04 13:41:47,511 - Detection -   best_eval_score = 85.93
2023-04-04 13:41:47,511 - Detection -   eval_score = 86.58
2023-04-04 13:41:47,511 - Detection -   train_loss = 1.8514541012900216
2023-04-04 13:41:57,387 - Detection - ***** Epoch: 13: Eval results *****
2023-04-04 13:41:57,388 - Detection -   best_eval_score = 86.58
2023-04-04 13:41:57,388 - Detection -   eval_score = 89.45
2023-04-04 13:41:57,388 - Detection -   train_loss = 1.7470571211406163
2023-04-04 13:42:07,362 - Detection - ***** Epoch: 14: Eval results *****
2023-04-04 13:42:07,362 - Detection -   best_eval_score = 89.45
2023-04-04 13:42:07,362 - Detection -   eval_score = 90.8
2023-04-04 13:42:07,362 - Detection -   train_loss = 1.6642196655273438
2023-04-04 13:42:17,229 - Detection - ***** Epoch: 15: Eval results *****
2023-04-04 13:42:17,229 - Detection -   best_eval_score = 90.8
2023-04-04 13:42:17,229 - Detection -   eval_score = 91.46
2023-04-04 13:42:17,229 - Detection -   train_loss = 1.593560573032924
2023-04-04 13:42:27,093 - Detection - ***** Epoch: 16: Eval results *****
2023-04-04 13:42:27,093 - Detection -   best_eval_score = 91.46
2023-04-04 13:42:27,093 - Detection -   eval_score = 91.3
2023-04-04 13:42:27,093 - Detection -   train_loss = 1.5412025213241578
2023-04-04 13:42:36,940 - Detection - ***** Epoch: 17: Eval results *****
2023-04-04 13:42:36,940 - Detection -   best_eval_score = 91.46
2023-04-04 13:42:36,940 - Detection -   eval_score = 92.13
2023-04-04 13:42:36,940 - Detection -   train_loss = 1.4893405982426235
2023-04-04 13:42:46,793 - Detection - ***** Epoch: 18: Eval results *****
2023-04-04 13:42:46,793 - Detection -   best_eval_score = 92.13
2023-04-04 13:42:46,793 - Detection -   eval_score = 92.67
2023-04-04 13:42:46,793 - Detection -   train_loss = 1.4433202368872506
2023-04-04 13:42:56,639 - Detection - ***** Epoch: 19: Eval results *****
2023-04-04 13:42:56,639 - Detection -   best_eval_score = 92.67
2023-04-04 13:42:56,639 - Detection -   eval_score = 93.01
2023-04-04 13:42:56,640 - Detection -   train_loss = 1.4070716891969954
2023-04-04 13:43:06,490 - Detection - ***** Epoch: 20: Eval results *****
2023-04-04 13:43:06,490 - Detection -   best_eval_score = 93.01
2023-04-04 13:43:06,490 - Detection -   eval_score = 93.17
2023-04-04 13:43:06,490 - Detection -   train_loss = 1.369776885850089
2023-04-04 13:43:16,339 - Detection - ***** Epoch: 21: Eval results *****
2023-04-04 13:43:16,339 - Detection -   best_eval_score = 93.17
2023-04-04 13:43:16,339 - Detection -   eval_score = 93.27
2023-04-04 13:43:16,339 - Detection -   train_loss = 1.3393226725714547
2023-04-04 13:43:26,187 - Detection - ***** Epoch: 22: Eval results *****
2023-04-04 13:43:26,187 - Detection -   best_eval_score = 93.27
2023-04-04 13:43:26,187 - Detection -   eval_score = 93.28
2023-04-04 13:43:26,187 - Detection -   train_loss = 1.306926577431815
2023-04-04 13:43:36,038 - Detection - ***** Epoch: 23: Eval results *****
2023-04-04 13:43:36,039 - Detection -   best_eval_score = 93.28
2023-04-04 13:43:36,039 - Detection -   eval_score = 94.36
2023-04-04 13:43:36,039 - Detection -   train_loss = 1.280363859449114
2023-04-04 13:43:45,884 - Detection - ***** Epoch: 24: Eval results *****
2023-04-04 13:43:45,884 - Detection -   best_eval_score = 94.36
2023-04-04 13:43:45,885 - Detection -   eval_score = 95.06
2023-04-04 13:43:45,885 - Detection -   train_loss = 1.256434461048671
2023-04-04 13:43:55,734 - Detection - ***** Epoch: 25: Eval results *****
2023-04-04 13:43:55,734 - Detection -   best_eval_score = 95.06
2023-04-04 13:43:55,734 - Detection -   eval_score = 95.06
2023-04-04 13:43:55,734 - Detection -   train_loss = 1.232993643624442
2023-04-04 13:44:05,567 - Detection - ***** Epoch: 26: Eval results *****
2023-04-04 13:44:05,567 - Detection -   best_eval_score = 95.06
2023-04-04 13:44:05,567 - Detection -   eval_score = 95.53
2023-04-04 13:44:05,567 - Detection -   train_loss = 1.2165693998336793
2023-04-04 13:44:15,515 - Detection - ***** Epoch: 27: Eval results *****
2023-04-04 13:44:15,515 - Detection -   best_eval_score = 95.53
2023-04-04 13:44:15,515 - Detection -   eval_score = 95.56
2023-04-04 13:44:15,515 - Detection -   train_loss = 1.1925584656851633
2023-04-04 13:44:25,367 - Detection - ***** Epoch: 28: Eval results *****
2023-04-04 13:44:25,367 - Detection -   best_eval_score = 95.56
2023-04-04 13:44:25,367 - Detection -   eval_score = 95.66
2023-04-04 13:44:25,367 - Detection -   train_loss = 1.1796753815242222
2023-04-04 13:44:35,221 - Detection - ***** Epoch: 29: Eval results *****
2023-04-04 13:44:35,221 - Detection -   best_eval_score = 95.66
2023-04-04 13:44:35,221 - Detection -   eval_score = 95.16
2023-04-04 13:44:35,221 - Detection -   train_loss = 1.1563314471926007
2023-04-04 13:44:45,063 - Detection - ***** Epoch: 30: Eval results *****
2023-04-04 13:44:45,063 - Detection -   best_eval_score = 95.66
2023-04-04 13:44:45,063 - Detection -   eval_score = 95.58
2023-04-04 13:44:45,063 - Detection -   train_loss = 1.1473467792783465
2023-04-04 13:44:54,904 - Detection - ***** Epoch: 31: Eval results *****
2023-04-04 13:44:54,905 - Detection -   best_eval_score = 95.66
2023-04-04 13:44:54,905 - Detection -   eval_score = 94.81
2023-04-04 13:44:54,905 - Detection -   train_loss = 1.1271027139254979
2023-04-04 13:45:04,742 - Detection - ***** Epoch: 32: Eval results *****
2023-04-04 13:45:04,742 - Detection -   best_eval_score = 95.66
2023-04-04 13:45:04,742 - Detection -   eval_score = 95.2
2023-04-04 13:45:04,742 - Detection -   train_loss = 1.117459385735648
2023-04-04 13:45:14,567 - Detection - ***** Epoch: 33: Eval results *****
2023-04-04 13:45:14,567 - Detection -   best_eval_score = 95.66
2023-04-04 13:45:14,567 - Detection -   eval_score = 95.37
2023-04-04 13:45:14,567 - Detection -   train_loss = 1.1049225739070347
2023-04-04 13:45:24,398 - Detection - ***** Epoch: 34: Eval results *****
2023-04-04 13:45:24,398 - Detection -   best_eval_score = 95.66
2023-04-04 13:45:24,398 - Detection -   eval_score = 95.64
2023-04-04 13:45:24,398 - Detection -   train_loss = 1.0937998294830322
2023-04-04 13:45:34,233 - Detection - ***** Epoch: 35: Eval results *****
2023-04-04 13:45:34,233 - Detection -   best_eval_score = 95.66
2023-04-04 13:45:34,233 - Detection -   eval_score = 95.43
2023-04-04 13:45:34,233 - Detection -   train_loss = 1.0822821004050118
2023-04-04 13:45:44,067 - Detection - ***** Epoch: 36: Eval results *****
2023-04-04 13:45:44,067 - Detection -   best_eval_score = 95.66
2023-04-04 13:45:44,067 - Detection -   eval_score = 95.43
2023-04-04 13:45:44,067 - Detection -   train_loss = 1.07707085950034
2023-04-04 13:45:53,905 - Detection - ***** Epoch: 37: Eval results *****
2023-04-04 13:45:53,905 - Detection -   best_eval_score = 95.66
2023-04-04 13:45:53,905 - Detection -   eval_score = 95.45
2023-04-04 13:45:53,905 - Detection -   train_loss = 1.058082493713924
2023-04-04 13:46:03,748 - Detection - ***** Epoch: 38: Eval results *****
2023-04-04 13:46:03,748 - Detection -   best_eval_score = 95.66
2023-04-04 13:46:03,748 - Detection -   eval_score = 95.64
2023-04-04 13:46:03,748 - Detection -   train_loss = 1.0564228466578893
2023-04-04 13:46:03,748 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_0.5_1.0_bert_disaware_1/models
2023-04-04 13:46:04,300 - Detection - Pre-training finished...
2023-04-04 13:46:04,300 - Detection - Training Begin...
2023-04-04 13:46:09,739 - Detection - ***** Epoch: 1: Eval results *****
2023-04-04 13:46:09,739 - Detection -   best_eval_score = 0
2023-04-04 13:46:09,739 - Detection -   eval_score = 34.65
2023-04-04 13:46:09,739 - Detection -   train_loss = 2.8125369821275985
2023-04-04 13:46:15,178 - Detection - ***** Epoch: 2: Eval results *****
2023-04-04 13:46:15,178 - Detection -   best_eval_score = 34.65
2023-04-04 13:46:15,178 - Detection -   eval_score = 75.76
2023-04-04 13:46:15,178 - Detection -   train_loss = 1.5925966330936976
2023-04-04 13:46:20,618 - Detection - ***** Epoch: 3: Eval results *****
2023-04-04 13:46:20,618 - Detection -   best_eval_score = 75.76
2023-04-04 13:46:20,618 - Detection -   eval_score = 87.27
2023-04-04 13:46:20,618 - Detection -   train_loss = 0.7626926524298532
2023-04-04 13:46:26,059 - Detection - ***** Epoch: 4: Eval results *****
2023-04-04 13:46:26,059 - Detection -   best_eval_score = 87.27
2023-04-04 13:46:26,059 - Detection -   eval_score = 87.21
2023-04-04 13:46:26,059 - Detection -   train_loss = 0.6500435471534729
2023-04-04 13:46:31,499 - Detection - ***** Epoch: 5: Eval results *****
2023-04-04 13:46:31,499 - Detection -   best_eval_score = 87.27
2023-04-04 13:46:31,499 - Detection -   eval_score = 86.92
2023-04-04 13:46:31,499 - Detection -   train_loss = 0.6510329621178763
2023-04-04 13:46:36,936 - Detection - ***** Epoch: 6: Eval results *****
2023-04-04 13:46:36,936 - Detection -   best_eval_score = 87.27
2023-04-04 13:46:36,936 - Detection -   eval_score = 87.07
2023-04-04 13:46:36,936 - Detection -   train_loss = 0.6448548998151507
2023-04-04 13:46:42,374 - Detection - ***** Epoch: 7: Eval results *****
2023-04-04 13:46:42,375 - Detection -   best_eval_score = 87.27
2023-04-04 13:46:42,375 - Detection -   eval_score = 86.88
2023-04-04 13:46:42,375 - Detection -   train_loss = 0.6589416427271707
2023-04-04 13:46:47,814 - Detection - ***** Epoch: 8: Eval results *****
2023-04-04 13:46:47,814 - Detection -   best_eval_score = 87.27
2023-04-04 13:46:47,814 - Detection -   eval_score = 86.72
2023-04-04 13:46:47,814 - Detection -   train_loss = 0.6405349884714399
2023-04-04 13:46:53,253 - Detection - ***** Epoch: 9: Eval results *****
2023-04-04 13:46:53,253 - Detection -   best_eval_score = 87.27
2023-04-04 13:46:53,253 - Detection -   eval_score = 86.86
2023-04-04 13:46:53,253 - Detection -   train_loss = 0.6490249463490078
2023-04-04 13:46:58,694 - Detection - ***** Epoch: 10: Eval results *****
2023-04-04 13:46:58,694 - Detection -   best_eval_score = 87.27
2023-04-04 13:46:58,694 - Detection -   eval_score = 87.2
2023-04-04 13:46:58,694 - Detection -   train_loss = 0.6443790367671421
2023-04-04 13:47:04,137 - Detection - ***** Epoch: 11: Eval results *****
2023-04-04 13:47:04,138 - Detection -   best_eval_score = 87.27
2023-04-04 13:47:04,138 - Detection -   eval_score = 87.0
2023-04-04 13:47:04,138 - Detection -   train_loss = 0.6541221959250314
2023-04-04 13:47:09,575 - Detection - ***** Epoch: 12: Eval results *****
2023-04-04 13:47:09,575 - Detection -   best_eval_score = 87.27
2023-04-04 13:47:09,575 - Detection -   eval_score = 86.99
2023-04-04 13:47:09,575 - Detection -   train_loss = 0.6626967583383833
2023-04-04 13:47:15,010 - Detection - ***** Epoch: 13: Eval results *****
2023-04-04 13:47:15,010 - Detection -   best_eval_score = 87.27
2023-04-04 13:47:15,010 - Detection -   eval_score = 86.55
2023-04-04 13:47:15,010 - Detection -   train_loss = 0.6631850259644645
2023-04-04 13:47:15,011 - Detection - Training Finished...
2023-04-04 13:47:15,011 - Detection - Testing begin...
2023-04-04 13:47:18,095 - Detection - ***** Test: Confusion Matrix *****
2023-04-04 13:47:18,095 - Detection - [[  39    0    0 ...    0    0    1]
 [   0   34    0 ...    0    0    6]
 [   0    0   31 ...    0    0    7]
 ...
 [   0    0    0 ...   37    0    3]
 [   0    0    0 ...    0   29   10]
 [   0    0    5 ...   50    0 1218]]
2023-04-04 13:47:18,095 - Detection - ***** Test results *****
2023-04-04 13:47:18,095 - Detection -   Acc = 81.69
2023-04-04 13:47:18,096 - Detection -   F1 = 82.9603
2023-04-04 13:47:18,096 - Detection -   F1-known = 82.9894
2023-04-04 13:47:18,096 - Detection -   F1-open = 81.8548
2023-04-04 13:47:18,096 - Detection - Testing finished...
2023-04-04 13:47:18,096 - Detection - Results saved in results/results_DA-ADB.csv
2023-04-04 13:47:18,113 - Detection - Open Intent Detection Finished...
