2023-04-22 17:59:02,682 - Detection - Open Intent Detection Begin...
2023-04-22 17:59:02,682 - Detection - Parameters Initialization...
2023-04-22 17:59:02,683 - Detection - ============================== Params ==============================
2023-04-22 17:59:02,683 - Detection - type:	open_intent_detection
2023-04-22 17:59:02,683 - Detection - logger_name:	Detection
2023-04-22 17:59:02,683 - Detection - log_dir:	logs
2023-04-22 17:59:02,683 - Detection - dataset:	stackoverflow_cg
2023-04-22 17:59:02,683 - Detection - known_cls_ratio:	0.75
2023-04-22 17:59:02,683 - Detection - labeled_ratio:	1.0
2023-04-22 17:59:02,683 - Detection - method:	DA-ADB
2023-04-22 17:59:02,683 - Detection - train:	True
2023-04-22 17:59:02,683 - Detection - pretrain:	True
2023-04-22 17:59:02,683 - Detection - save_model:	False
2023-04-22 17:59:02,683 - Detection - backbone:	bert_disaware_boost
2023-04-22 17:59:02,683 - Detection - config_file_name:	DA-ADB
2023-04-22 17:59:02,683 - Detection - seed:	9
2023-04-22 17:59:02,683 - Detection - gpu_id:	0
2023-04-22 17:59:02,683 - Detection - pipe_results_path:	pipe_results
2023-04-22 17:59:02,683 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-22 17:59:02,683 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-22 17:59:02,683 - Detection - model_dir:	models
2023-04-22 17:59:02,683 - Detection - load_pretrained_method:	None
2023-04-22 17:59:02,683 - Detection - result_dir:	results
2023-04-22 17:59:02,683 - Detection - results_file_name:	results_DA-ADB-BOOST.csv
2023-04-22 17:59:02,683 - Detection - save_results:	True
2023-04-22 17:59:02,683 - Detection - loss_fct:	CrossEntropyLoss
2023-04-22 17:59:02,683 - Detection - boost_method:	F-10
2023-04-22 17:59:02,683 - Detection - boost_start_score:	0.0
2023-04-22 17:59:02,683 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.75_1.0_bert_disaware_boost_9
2023-04-22 17:59:02,683 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.75_1.0_bert_disaware_boost_9/models
2023-04-22 17:59:02,683 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-22 17:59:02,683 - Detection - num_train_epochs:	100
2023-04-22 17:59:02,683 - Detection - num_labels:	None
2023-04-22 17:59:02,683 - Detection - max_seq_length:	None
2023-04-22 17:59:02,683 - Detection - freeze_backbone_parameters:	True
2023-04-22 17:59:02,683 - Detection - feat_dim:	768
2023-04-22 17:59:02,683 - Detection - warmup_proportion:	0.1
2023-04-22 17:59:02,683 - Detection - scale:	4
2023-04-22 17:59:02,683 - Detection - lr_boundary:	0.05
2023-04-22 17:59:02,683 - Detection - lr:	2e-05
2023-04-22 17:59:02,683 - Detection - activation:	relu
2023-04-22 17:59:02,683 - Detection - train_batch_size:	128
2023-04-22 17:59:02,684 - Detection - eval_batch_size:	64
2023-04-22 17:59:02,684 - Detection - test_batch_size:	64
2023-04-22 17:59:02,684 - Detection - wait_patient:	10
2023-04-22 17:59:02,684 - Detection - ============================== End Params ==============================
2023-04-22 17:59:02,684 - Detection - Data and Model Preparation...
2023-04-22 17:59:02,684 - Detection - The number of known intents is 15
2023-04-22 17:59:02,684 - Detection - Lists of known labels are: ['cocoa', 'haskell', 'hibernate', 'excel', 'spring', 'sharepoint', 'bash', 'drupal', 'magento', 'matlab', 'visual-studio', 'oracle', 'scala', 'ajax', 'osx']
2023-04-22 17:59:02,694 - Detection - Number of labeled training samples = 2125
2023-04-22 17:59:02,694 - Detection - Number of unlabeled training samples = 666
2023-04-22 17:59:02,697 - Detection - Number of evaluation samples = 1048
2023-04-22 17:59:02,702 - Detection - Number of testing samples = 2905
2023-04-22 17:59:08,384 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-22 17:59:08,464 - Detection - Pre-training Begin...
2023-04-22 17:59:13,602 - Detection - ***** Epoch: 1: Eval results *****
2023-04-22 17:59:13,602 - Detection -   best_eval_score = 0
2023-04-22 17:59:13,602 - Detection -   eval_score = 1.55
2023-04-22 17:59:13,602 - Detection -   train_loss = 2.7214240887585808
2023-04-22 17:59:46,912 - Detection - ***** Epoch: 2: Eval results *****
2023-04-22 17:59:46,912 - Detection -   best_eval_score = 1.55
2023-04-22 17:59:46,912 - Detection -   eval_score = 1.99
2023-04-22 17:59:46,912 - Detection -   train_loss = 2.697884265114279
2023-04-22 18:00:20,327 - Detection - ***** Epoch: 3: Eval results *****
2023-04-22 18:00:20,327 - Detection -   best_eval_score = 1.99
2023-04-22 18:00:20,327 - Detection -   eval_score = 19.83
2023-04-22 18:00:20,327 - Detection -   train_loss = 2.5806967230404125
2023-04-22 18:00:53,691 - Detection - ***** Epoch: 4: Eval results *****
2023-04-22 18:00:53,691 - Detection -   best_eval_score = 19.83
2023-04-22 18:00:53,691 - Detection -   eval_score = 70.36
2023-04-22 18:00:53,691 - Detection -   train_loss = 2.330016627031214
2023-04-22 18:01:26,955 - Detection - ***** Epoch: 5: Eval results *****
2023-04-22 18:01:26,955 - Detection -   best_eval_score = 70.36
2023-04-22 18:01:26,955 - Detection -   eval_score = 78.12
2023-04-22 18:01:26,955 - Detection -   train_loss = 1.8492774402394014
2023-04-22 18:02:00,366 - Detection - ***** Epoch: 6: Eval results *****
2023-04-22 18:02:00,366 - Detection -   best_eval_score = 78.12
2023-04-22 18:02:00,366 - Detection -   eval_score = 80.28
2023-04-22 18:02:00,366 - Detection -   train_loss = 1.442432915463167
2023-04-22 18:02:33,831 - Detection - ***** Epoch: 7: Eval results *****
2023-04-22 18:02:33,831 - Detection -   best_eval_score = 80.28
2023-04-22 18:02:33,831 - Detection -   eval_score = 80.84
2023-04-22 18:02:33,831 - Detection -   train_loss = 1.2362460739472334
2023-04-22 18:03:07,141 - Detection - ***** Epoch: 8: Eval results *****
2023-04-22 18:03:07,141 - Detection -   best_eval_score = 80.84
2023-04-22 18:03:07,141 - Detection -   eval_score = 80.19
2023-04-22 18:03:07,141 - Detection -   train_loss = 1.1167087835424088
2023-04-22 18:03:40,704 - Detection - ***** Epoch: 9: Eval results *****
2023-04-22 18:03:40,704 - Detection -   best_eval_score = 80.84
2023-04-22 18:03:40,704 - Detection -   eval_score = 79.99
2023-04-22 18:03:40,704 - Detection -   train_loss = 1.0175704324946684
2023-04-22 18:04:14,139 - Detection - ***** Epoch: 10: Eval results *****
2023-04-22 18:04:14,139 - Detection -   best_eval_score = 80.84
2023-04-22 18:04:14,139 - Detection -   eval_score = 80.44
2023-04-22 18:04:14,139 - Detection -   train_loss = 0.9368775486946106
2023-04-22 18:04:47,606 - Detection - ***** Epoch: 11: Eval results *****
2023-04-22 18:04:47,606 - Detection -   best_eval_score = 80.84
2023-04-22 18:04:47,606 - Detection -   eval_score = 79.51
2023-04-22 18:04:47,606 - Detection -   train_loss = 0.8478307022767908
2023-04-22 18:05:21,000 - Detection - ***** Epoch: 12: Eval results *****
2023-04-22 18:05:21,000 - Detection -   best_eval_score = 80.84
2023-04-22 18:05:21,000 - Detection -   eval_score = 79.72
2023-04-22 18:05:21,000 - Detection -   train_loss = 0.7726306810098535
2023-04-22 18:05:54,456 - Detection - ***** Epoch: 13: Eval results *****
2023-04-22 18:05:54,456 - Detection -   best_eval_score = 80.84
2023-04-22 18:05:54,456 - Detection -   eval_score = 80.36
2023-04-22 18:05:54,456 - Detection -   train_loss = 0.7093129929374246
2023-04-22 18:06:27,741 - Detection - ***** Epoch: 14: Eval results *****
2023-04-22 18:06:27,741 - Detection -   best_eval_score = 80.84
2023-04-22 18:06:27,741 - Detection -   eval_score = 79.91
2023-04-22 18:06:27,741 - Detection -   train_loss = 0.6512326422859641
2023-04-22 18:07:01,081 - Detection - ***** Epoch: 15: Eval results *****
2023-04-22 18:07:01,081 - Detection -   best_eval_score = 80.84
2023-04-22 18:07:01,081 - Detection -   eval_score = 79.61
2023-04-22 18:07:01,081 - Detection -   train_loss = 0.6084685080191669
2023-04-22 18:07:34,435 - Detection - ***** Epoch: 16: Eval results *****
2023-04-22 18:07:34,435 - Detection -   best_eval_score = 80.84
2023-04-22 18:07:34,435 - Detection -   eval_score = 79.57
2023-04-22 18:07:34,435 - Detection -   train_loss = 0.5687719197834239
2023-04-22 18:08:07,811 - Detection - ***** Epoch: 17: Eval results *****
2023-04-22 18:08:07,811 - Detection -   best_eval_score = 80.84
2023-04-22 18:08:07,811 - Detection -   eval_score = 79.09
2023-04-22 18:08:07,811 - Detection -   train_loss = 0.5369251756107106
2023-04-22 18:08:07,811 - Detection - Pre-training finished...
2023-04-22 18:08:07,812 - Detection - Training Begin...
2023-04-22 18:08:10,654 - Detection - ***** Epoch: 1: Eval results *****
2023-04-22 18:08:10,654 - Detection -   best_eval_score = 0
2023-04-22 18:08:10,654 - Detection -   eval_score = 0.0
2023-04-22 18:08:10,654 - Detection -   train_loss = 4.004617256276748
2023-04-22 18:08:13,499 - Detection - ***** Epoch: 2: Eval results *****
2023-04-22 18:08:13,499 - Detection -   best_eval_score = 0
2023-04-22 18:08:13,499 - Detection -   eval_score = 0.36
2023-04-22 18:08:13,499 - Detection -   train_loss = 3.4512625021093033
2023-04-22 18:08:44,826 - Detection - ***** Epoch: 3: Eval results *****
2023-04-22 18:08:44,826 - Detection -   best_eval_score = 0.36
2023-04-22 18:08:44,826 - Detection -   eval_score = 69.01
2023-04-22 18:08:44,826 - Detection -   train_loss = 2.748785313437967
2023-04-22 18:09:16,166 - Detection - ***** Epoch: 4: Eval results *****
2023-04-22 18:09:16,166 - Detection -   best_eval_score = 69.01
2023-04-22 18:09:16,166 - Detection -   eval_score = 69.1
2023-04-22 18:09:16,166 - Detection -   train_loss = 0.9224244145786061
2023-04-22 18:09:47,575 - Detection - ***** Epoch: 5: Eval results *****
2023-04-22 18:09:47,575 - Detection -   best_eval_score = 69.1
2023-04-22 18:09:47,575 - Detection -   eval_score = 68.67
2023-04-22 18:09:47,575 - Detection -   train_loss = 0.8948070266667534
2023-04-22 18:10:18,973 - Detection - ***** Epoch: 6: Eval results *****
2023-04-22 18:10:18,973 - Detection -   best_eval_score = 69.1
2023-04-22 18:10:18,973 - Detection -   eval_score = 68.85
2023-04-22 18:10:18,973 - Detection -   train_loss = 0.8823216101702522
2023-04-22 18:10:50,265 - Detection - ***** Epoch: 7: Eval results *****
2023-04-22 18:10:50,265 - Detection -   best_eval_score = 69.1
2023-04-22 18:10:50,265 - Detection -   eval_score = 69.34
2023-04-22 18:10:50,265 - Detection -   train_loss = 0.9177329224698684
2023-04-22 18:11:21,609 - Detection - ***** Epoch: 8: Eval results *****
2023-04-22 18:11:21,609 - Detection -   best_eval_score = 69.34
2023-04-22 18:11:21,609 - Detection -   eval_score = 68.36
2023-04-22 18:11:21,609 - Detection -   train_loss = 0.9091219972161686
2023-04-22 18:11:52,993 - Detection - ***** Epoch: 9: Eval results *****
2023-04-22 18:11:52,993 - Detection -   best_eval_score = 69.34
2023-04-22 18:11:52,993 - Detection -   eval_score = 69.1
2023-04-22 18:11:52,993 - Detection -   train_loss = 0.9133451125201058
2023-04-22 18:12:24,445 - Detection - ***** Epoch: 10: Eval results *****
2023-04-22 18:12:24,445 - Detection -   best_eval_score = 69.34
2023-04-22 18:12:24,445 - Detection -   eval_score = 68.98
2023-04-22 18:12:24,445 - Detection -   train_loss = 0.9446297813864315
2023-04-22 18:12:55,967 - Detection - ***** Epoch: 11: Eval results *****
2023-04-22 18:12:55,967 - Detection -   best_eval_score = 69.34
2023-04-22 18:12:55,967 - Detection -   eval_score = 68.97
2023-04-22 18:12:55,967 - Detection -   train_loss = 0.9125507228514728
2023-04-22 18:13:27,514 - Detection - ***** Epoch: 12: Eval results *****
2023-04-22 18:13:27,514 - Detection -   best_eval_score = 69.34
2023-04-22 18:13:27,514 - Detection -   eval_score = 68.54
2023-04-22 18:13:27,514 - Detection -   train_loss = 0.9304153814035303
2023-04-22 18:13:58,927 - Detection - ***** Epoch: 13: Eval results *****
2023-04-22 18:13:58,927 - Detection -   best_eval_score = 69.34
2023-04-22 18:13:58,927 - Detection -   eval_score = 69.13
2023-04-22 18:13:58,927 - Detection -   train_loss = 0.8964426762917462
2023-04-22 18:14:30,426 - Detection - ***** Epoch: 14: Eval results *****
2023-04-22 18:14:30,426 - Detection -   best_eval_score = 69.34
2023-04-22 18:14:30,426 - Detection -   eval_score = 69.33
2023-04-22 18:14:30,426 - Detection -   train_loss = 0.9209717652376961
2023-04-22 18:15:01,636 - Detection - ***** Epoch: 15: Eval results *****
2023-04-22 18:15:01,636 - Detection -   best_eval_score = 69.34
2023-04-22 18:15:01,636 - Detection -   eval_score = 69.04
2023-04-22 18:15:01,636 - Detection -   train_loss = 0.9001389987328473
2023-04-22 18:15:33,147 - Detection - ***** Epoch: 16: Eval results *****
2023-04-22 18:15:33,147 - Detection -   best_eval_score = 69.34
2023-04-22 18:15:33,147 - Detection -   eval_score = 69.52
2023-04-22 18:15:33,147 - Detection -   train_loss = 0.900852340109208
2023-04-22 18:16:04,537 - Detection - ***** Epoch: 17: Eval results *****
2023-04-22 18:16:04,537 - Detection -   best_eval_score = 69.52
2023-04-22 18:16:04,537 - Detection -   eval_score = 69.22
2023-04-22 18:16:04,538 - Detection -   train_loss = 0.8954032940023086
2023-04-22 18:16:35,916 - Detection - ***** Epoch: 18: Eval results *****
2023-04-22 18:16:35,916 - Detection -   best_eval_score = 69.52
2023-04-22 18:16:35,916 - Detection -   eval_score = 68.87
2023-04-22 18:16:35,916 - Detection -   train_loss = 0.8766905735520756
2023-04-22 18:17:07,194 - Detection - ***** Epoch: 19: Eval results *****
2023-04-22 18:17:07,194 - Detection -   best_eval_score = 69.52
2023-04-22 18:17:07,194 - Detection -   eval_score = 69.27
2023-04-22 18:17:07,194 - Detection -   train_loss = 0.8701291785520666
2023-04-22 18:17:38,499 - Detection - ***** Epoch: 20: Eval results *****
2023-04-22 18:17:38,499 - Detection -   best_eval_score = 69.52
2023-04-22 18:17:38,499 - Detection -   eval_score = 68.54
2023-04-22 18:17:38,499 - Detection -   train_loss = 0.9429210950346554
2023-04-22 18:18:09,946 - Detection - ***** Epoch: 21: Eval results *****
2023-04-22 18:18:09,946 - Detection -   best_eval_score = 69.52
2023-04-22 18:18:09,946 - Detection -   eval_score = 69.23
2023-04-22 18:18:09,946 - Detection -   train_loss = 0.8813966687987832
2023-04-22 18:18:41,289 - Detection - ***** Epoch: 22: Eval results *****
2023-04-22 18:18:41,290 - Detection -   best_eval_score = 69.52
2023-04-22 18:18:41,290 - Detection -   eval_score = 69.23
2023-04-22 18:18:41,290 - Detection -   train_loss = 0.9194358902819016
2023-04-22 18:19:12,562 - Detection - ***** Epoch: 23: Eval results *****
2023-04-22 18:19:12,562 - Detection -   best_eval_score = 69.52
2023-04-22 18:19:12,562 - Detection -   eval_score = 68.74
2023-04-22 18:19:12,562 - Detection -   train_loss = 0.899350173333112
2023-04-22 18:19:43,845 - Detection - ***** Epoch: 24: Eval results *****
2023-04-22 18:19:43,845 - Detection -   best_eval_score = 69.52
2023-04-22 18:19:43,845 - Detection -   eval_score = 69.06
2023-04-22 18:19:43,845 - Detection -   train_loss = 0.9086251013419208
2023-04-22 18:20:15,429 - Detection - ***** Epoch: 25: Eval results *****
2023-04-22 18:20:15,429 - Detection -   best_eval_score = 69.52
2023-04-22 18:20:15,429 - Detection -   eval_score = 69.24
2023-04-22 18:20:15,429 - Detection -   train_loss = 0.9049040955655715
2023-04-22 18:20:46,668 - Detection - ***** Epoch: 26: Eval results *****
2023-04-22 18:20:46,668 - Detection -   best_eval_score = 69.52
2023-04-22 18:20:46,668 - Detection -   eval_score = 68.78
2023-04-22 18:20:46,668 - Detection -   train_loss = 0.9203555513830746
2023-04-22 18:20:46,668 - Detection - Training Finished...
2023-04-22 18:20:46,668 - Detection - Testing begin...
2023-04-22 18:20:49,092 - Detection - ***** Test: Confusion Matrix *****
2023-04-22 18:20:49,093 - Detection - [[ 88   7   0   0   6   7   2   2   1   0   0   1   1   0  22  24]
 [  0  65   0   2   3   2   2   0   1   2   0   0   2   0   2  41]
 [  3  10  85   0  10   1   2   2   0   0   0   5   1   0   1   8]
 [  3   9   0  91   0   6   1   0   0   1   1   1   6   1  11   9]
 [  0   4   4   0  88   1   0   0   0   0   0   0   1   0   4  49]
 [  0   1   0   1   1 143   4   2   0   0   5   1   1   1   3   8]
 [  6  17   0   0   1   1  74   2   0   1   0   0   4   1  11  21]
 [  1   5   0   0   0   7   0 110   0   0   0   0   2   2   1   0]
 [  3   5   0   0   1  12   0   2 105   0   0   0   0   0   1   3]
 [  5   8   0   0   0   0   1   0   0 135   0   0   5   1   3   6]
 [  8  10   0   1   2   9   1   7   0   0  44   2   1   1  18   2]
 [  0  11   0   0   0   5   1   3   0   0   0  99   0   0   4   4]
 [  0  18   0   0   5   1   1   0   0   0   0   0  84   0   1  14]
 [  1   9   1   1   1   9   1   5   0   0   1   0   1 118  10   2]
 [ 23   5   0   1   3   3   2   1   0   0   0   1   2   0 134  18]
 [ 28 177   1   7  33 135  67  40   4   3   8  22   7  39 139  49]]
2023-04-22 18:20:49,093 - Detection - ***** Test results *****
2023-04-22 18:20:49,093 - Detection -   Acc = 52.05
2023-04-22 18:20:49,093 - Detection -   F1 = 60.7697
2023-04-22 18:20:49,093 - Detection -   F1-known = 64.1786
2023-04-22 18:20:49,093 - Detection -   F1-open = 9.6362
2023-04-22 18:20:49,093 - Detection - Testing finished...
2023-04-22 18:20:49,093 - Detection - Results saved in results/results_DA-ADB-BOOST.csv
2023-04-22 18:20:49,113 - Detection - Open Intent Detection Finished...
