2023-04-05 11:27:14,771 - Detection - Open Intent Detection Begin...
2023-04-05 11:27:14,771 - Detection - Parameters Initialization...
2023-04-05 11:27:14,772 - Detection - ============================== Params ==============================
2023-04-05 11:27:14,772 - Detection - type:	open_intent_detection
2023-04-05 11:27:14,772 - Detection - logger_name:	Detection
2023-04-05 11:27:14,772 - Detection - log_dir:	logs
2023-04-05 11:27:14,772 - Detection - dataset:	stackoverflow
2023-04-05 11:27:14,772 - Detection - known_cls_ratio:	0.25
2023-04-05 11:27:14,772 - Detection - labeled_ratio:	1.0
2023-04-05 11:27:14,772 - Detection - method:	DA-ADB
2023-04-05 11:27:14,772 - Detection - train:	True
2023-04-05 11:27:14,772 - Detection - pretrain:	True
2023-04-05 11:27:14,772 - Detection - save_model:	True
2023-04-05 11:27:14,772 - Detection - backbone:	bert_disaware
2023-04-05 11:27:14,772 - Detection - config_file_name:	DA-ADB
2023-04-05 11:27:14,772 - Detection - seed:	4
2023-04-05 11:27:14,772 - Detection - gpu_id:	0
2023-04-05 11:27:14,772 - Detection - pipe_results_path:	pipe_results
2023-04-05 11:27:14,772 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-05 11:27:14,772 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-05 11:27:14,772 - Detection - model_dir:	models
2023-04-05 11:27:14,772 - Detection - load_pretrained_method:	None
2023-04-05 11:27:14,772 - Detection - result_dir:	results
2023-04-05 11:27:14,772 - Detection - results_file_name:	results_DA-ADB.csv
2023-04-05 11:27:14,772 - Detection - save_results:	True
2023-04-05 11:27:14,772 - Detection - loss_fct:	CrossEntropyLoss
2023-04-05 11:27:14,772 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_0.25_1.0_bert_disaware_4
2023-04-05 11:27:14,772 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_0.25_1.0_bert_disaware_4/models
2023-04-05 11:27:14,772 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-05 11:27:14,772 - Detection - num_train_epochs:	100
2023-04-05 11:27:14,772 - Detection - num_labels:	None
2023-04-05 11:27:14,772 - Detection - max_seq_length:	None
2023-04-05 11:27:14,772 - Detection - freeze_backbone_parameters:	True
2023-04-05 11:27:14,772 - Detection - feat_dim:	768
2023-04-05 11:27:14,772 - Detection - warmup_proportion:	0.1
2023-04-05 11:27:14,772 - Detection - scale:	4
2023-04-05 11:27:14,772 - Detection - lr_boundary:	0.05
2023-04-05 11:27:14,772 - Detection - lr:	2e-05
2023-04-05 11:27:14,772 - Detection - activation:	relu
2023-04-05 11:27:14,772 - Detection - train_batch_size:	128
2023-04-05 11:27:14,772 - Detection - eval_batch_size:	64
2023-04-05 11:27:14,772 - Detection - test_batch_size:	64
2023-04-05 11:27:14,772 - Detection - wait_patient:	10
2023-04-05 11:27:14,772 - Detection - ============================== End Params ==============================
2023-04-05 11:27:14,773 - Detection - Data and Model Preparation...
2023-04-05 11:27:14,773 - Detection - The number of known intents is 5
2023-04-05 11:27:14,773 - Detection - Lists of known labels are: ['wordpress', 'cocoa', 'visual-studio', 'haskell', 'qt']
2023-04-05 11:27:14,803 - Detection - Number of labeled training samples = 3000
2023-04-05 11:27:14,803 - Detection - Number of unlabeled training samples = 9000
2023-04-05 11:27:14,807 - Detection - Number of evaluation samples = 500
2023-04-05 11:27:14,818 - Detection - Number of testing samples = 6000
2023-04-05 11:27:22,725 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-05 11:27:22,808 - Detection - Pre-training Begin...
2023-04-05 11:27:28,933 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 11:27:28,933 - Detection -   best_eval_score = 0
2023-04-05 11:27:28,933 - Detection -   eval_score = 22.96
2023-04-05 11:27:28,934 - Detection -   train_loss = 1.6086109777291615
2023-04-05 11:27:34,510 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 11:27:34,510 - Detection -   best_eval_score = 22.96
2023-04-05 11:27:34,510 - Detection -   eval_score = 33.7
2023-04-05 11:27:34,510 - Detection -   train_loss = 1.5966257452964783
2023-04-05 11:27:40,097 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 11:27:40,097 - Detection -   best_eval_score = 33.7
2023-04-05 11:27:40,097 - Detection -   eval_score = 33.41
2023-04-05 11:27:40,097 - Detection -   train_loss = 1.5687041928370793
2023-04-05 11:27:45,682 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 11:27:45,682 - Detection -   best_eval_score = 33.7
2023-04-05 11:27:45,682 - Detection -   eval_score = 55.8
2023-04-05 11:27:45,682 - Detection -   train_loss = 1.4784632573525112
2023-04-05 11:27:51,298 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 11:27:51,298 - Detection -   best_eval_score = 55.8
2023-04-05 11:27:51,298 - Detection -   eval_score = 71.9
2023-04-05 11:27:51,298 - Detection -   train_loss = 1.2204571664333344
2023-04-05 11:27:56,924 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 11:27:56,924 - Detection -   best_eval_score = 71.9
2023-04-05 11:27:56,924 - Detection -   eval_score = 83.36
2023-04-05 11:27:56,924 - Detection -   train_loss = 0.8637615789969763
2023-04-05 11:28:02,562 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 11:28:02,562 - Detection -   best_eval_score = 83.36
2023-04-05 11:28:02,562 - Detection -   eval_score = 89.02
2023-04-05 11:28:02,562 - Detection -   train_loss = 0.5949987570444742
2023-04-05 11:28:08,213 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 11:28:08,213 - Detection -   best_eval_score = 89.02
2023-04-05 11:28:08,213 - Detection -   eval_score = 89.94
2023-04-05 11:28:08,213 - Detection -   train_loss = 0.47400568798184395
2023-04-05 11:28:13,870 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 11:28:13,870 - Detection -   best_eval_score = 89.94
2023-04-05 11:28:13,870 - Detection -   eval_score = 91.19
2023-04-05 11:28:13,870 - Detection -   train_loss = 0.40957120185097057
2023-04-05 11:28:19,643 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 11:28:19,643 - Detection -   best_eval_score = 91.19
2023-04-05 11:28:19,643 - Detection -   eval_score = 90.42
2023-04-05 11:28:19,643 - Detection -   train_loss = 0.3669206090271473
2023-04-05 11:28:25,313 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 11:28:25,313 - Detection -   best_eval_score = 91.19
2023-04-05 11:28:25,313 - Detection -   eval_score = 91.37
2023-04-05 11:28:25,313 - Detection -   train_loss = 0.33760451152920723
2023-04-05 11:28:30,989 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 11:28:30,989 - Detection -   best_eval_score = 91.37
2023-04-05 11:28:30,989 - Detection -   eval_score = 91.44
2023-04-05 11:28:30,989 - Detection -   train_loss = 0.3123851828277111
2023-04-05 11:28:36,675 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 11:28:36,675 - Detection -   best_eval_score = 91.44
2023-04-05 11:28:36,675 - Detection -   eval_score = 91.82
2023-04-05 11:28:36,676 - Detection -   train_loss = 0.2922192644327879
2023-04-05 11:28:42,359 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 11:28:42,359 - Detection -   best_eval_score = 91.82
2023-04-05 11:28:42,359 - Detection -   eval_score = 91.53
2023-04-05 11:28:42,359 - Detection -   train_loss = 0.27976625226438046
2023-04-05 11:28:48,025 - Detection - ***** Epoch: 15: Eval results *****
2023-04-05 11:28:48,025 - Detection -   best_eval_score = 91.82
2023-04-05 11:28:48,025 - Detection -   eval_score = 91.34
2023-04-05 11:28:48,025 - Detection -   train_loss = 0.26838198366264504
2023-04-05 11:28:53,690 - Detection - ***** Epoch: 16: Eval results *****
2023-04-05 11:28:53,690 - Detection -   best_eval_score = 91.82
2023-04-05 11:28:53,690 - Detection -   eval_score = 92.78
2023-04-05 11:28:53,690 - Detection -   train_loss = 0.255700118218859
2023-04-05 11:28:59,370 - Detection - ***** Epoch: 17: Eval results *****
2023-04-05 11:28:59,370 - Detection -   best_eval_score = 92.78
2023-04-05 11:28:59,370 - Detection -   eval_score = 92.18
2023-04-05 11:28:59,370 - Detection -   train_loss = 0.23980828188359737
2023-04-05 11:29:05,029 - Detection - ***** Epoch: 18: Eval results *****
2023-04-05 11:29:05,029 - Detection -   best_eval_score = 92.78
2023-04-05 11:29:05,029 - Detection -   eval_score = 92.98
2023-04-05 11:29:05,029 - Detection -   train_loss = 0.2239184956997633
2023-04-05 11:29:10,698 - Detection - ***** Epoch: 19: Eval results *****
2023-04-05 11:29:10,698 - Detection -   best_eval_score = 92.98
2023-04-05 11:29:10,698 - Detection -   eval_score = 93.37
2023-04-05 11:29:10,698 - Detection -   train_loss = 0.21858871976534525
2023-04-05 11:29:16,364 - Detection - ***** Epoch: 20: Eval results *****
2023-04-05 11:29:16,364 - Detection -   best_eval_score = 93.37
2023-04-05 11:29:16,364 - Detection -   eval_score = 92.98
2023-04-05 11:29:16,364 - Detection -   train_loss = 0.21002277173101902
2023-04-05 11:29:22,013 - Detection - ***** Epoch: 21: Eval results *****
2023-04-05 11:29:22,013 - Detection -   best_eval_score = 93.37
2023-04-05 11:29:22,013 - Detection -   eval_score = 92.59
2023-04-05 11:29:22,013 - Detection -   train_loss = 0.20545434641341367
2023-04-05 11:29:27,665 - Detection - ***** Epoch: 22: Eval results *****
2023-04-05 11:29:27,666 - Detection -   best_eval_score = 93.37
2023-04-05 11:29:27,666 - Detection -   eval_score = 92.4
2023-04-05 11:29:27,666 - Detection -   train_loss = 0.19286394057174525
2023-04-05 11:29:33,320 - Detection - ***** Epoch: 23: Eval results *****
2023-04-05 11:29:33,320 - Detection -   best_eval_score = 93.37
2023-04-05 11:29:33,320 - Detection -   eval_score = 92.61
2023-04-05 11:29:33,320 - Detection -   train_loss = 0.18902098139127096
2023-04-05 11:29:38,984 - Detection - ***** Epoch: 24: Eval results *****
2023-04-05 11:29:38,984 - Detection -   best_eval_score = 93.37
2023-04-05 11:29:38,984 - Detection -   eval_score = 93.0
2023-04-05 11:29:38,984 - Detection -   train_loss = 0.18106542093058428
2023-04-05 11:29:44,639 - Detection - ***** Epoch: 25: Eval results *****
2023-04-05 11:29:44,639 - Detection -   best_eval_score = 93.37
2023-04-05 11:29:44,639 - Detection -   eval_score = 92.98
2023-04-05 11:29:44,639 - Detection -   train_loss = 0.17163491497437158
2023-04-05 11:29:50,293 - Detection - ***** Epoch: 26: Eval results *****
2023-04-05 11:29:50,293 - Detection -   best_eval_score = 93.37
2023-04-05 11:29:50,293 - Detection -   eval_score = 92.57
2023-04-05 11:29:50,293 - Detection -   train_loss = 0.16886046218375364
2023-04-05 11:29:55,946 - Detection - ***** Epoch: 27: Eval results *****
2023-04-05 11:29:55,947 - Detection -   best_eval_score = 93.37
2023-04-05 11:29:55,947 - Detection -   eval_score = 92.94
2023-04-05 11:29:55,947 - Detection -   train_loss = 0.16255326506992182
2023-04-05 11:30:01,605 - Detection - ***** Epoch: 28: Eval results *****
2023-04-05 11:30:01,605 - Detection -   best_eval_score = 93.37
2023-04-05 11:30:01,605 - Detection -   eval_score = 92.57
2023-04-05 11:30:01,605 - Detection -   train_loss = 0.1623336716244618
2023-04-05 11:30:07,255 - Detection - ***** Epoch: 29: Eval results *****
2023-04-05 11:30:07,255 - Detection -   best_eval_score = 93.37
2023-04-05 11:30:07,255 - Detection -   eval_score = 92.6
2023-04-05 11:30:07,255 - Detection -   train_loss = 0.15322719452281794
2023-04-05 11:30:07,255 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_0.25_1.0_bert_disaware_4/models
2023-04-05 11:30:07,804 - Detection - Pre-training finished...
2023-04-05 11:30:07,804 - Detection - Training Begin...
2023-04-05 11:30:10,981 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 11:30:10,981 - Detection -   best_eval_score = 0
2023-04-05 11:30:10,981 - Detection -   eval_score = 17.49
2023-04-05 11:30:10,981 - Detection -   train_loss = 3.7721986969312034
2023-04-05 11:30:14,156 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 11:30:14,157 - Detection -   best_eval_score = 17.49
2023-04-05 11:30:14,157 - Detection -   eval_score = 29.8
2023-04-05 11:30:14,157 - Detection -   train_loss = 2.8951500256856284
2023-04-05 11:30:17,332 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 11:30:17,332 - Detection -   best_eval_score = 29.8
2023-04-05 11:30:17,333 - Detection -   eval_score = 69.13
2023-04-05 11:30:17,333 - Detection -   train_loss = 1.7534261494874954
2023-04-05 11:30:20,510 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 11:30:20,510 - Detection -   best_eval_score = 69.13
2023-04-05 11:30:20,510 - Detection -   eval_score = 73.63
2023-04-05 11:30:20,510 - Detection -   train_loss = 1.0437273308634758
2023-04-05 11:30:23,684 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 11:30:23,685 - Detection -   best_eval_score = 73.63
2023-04-05 11:30:23,685 - Detection -   eval_score = 73.63
2023-04-05 11:30:23,685 - Detection -   train_loss = 0.9203173220157623
2023-04-05 11:30:26,864 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 11:30:26,864 - Detection -   best_eval_score = 73.63
2023-04-05 11:30:26,864 - Detection -   eval_score = 73.42
2023-04-05 11:30:26,864 - Detection -   train_loss = 0.9127954170107841
2023-04-05 11:30:30,041 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 11:30:30,041 - Detection -   best_eval_score = 73.63
2023-04-05 11:30:30,041 - Detection -   eval_score = 73.52
2023-04-05 11:30:30,041 - Detection -   train_loss = 0.8894218529264132
2023-04-05 11:30:33,218 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 11:30:33,218 - Detection -   best_eval_score = 73.63
2023-04-05 11:30:33,218 - Detection -   eval_score = 73.63
2023-04-05 11:30:33,218 - Detection -   train_loss = 0.9213651046156883
2023-04-05 11:30:36,395 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 11:30:36,395 - Detection -   best_eval_score = 73.63
2023-04-05 11:30:36,395 - Detection -   eval_score = 73.42
2023-04-05 11:30:36,395 - Detection -   train_loss = 0.9057732423146566
2023-04-05 11:30:39,574 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 11:30:39,574 - Detection -   best_eval_score = 73.63
2023-04-05 11:30:39,574 - Detection -   eval_score = 73.63
2023-04-05 11:30:39,574 - Detection -   train_loss = 0.9205493777990341
2023-04-05 11:30:42,753 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 11:30:42,753 - Detection -   best_eval_score = 73.63
2023-04-05 11:30:42,753 - Detection -   eval_score = 73.52
2023-04-05 11:30:42,753 - Detection -   train_loss = 0.909978836774826
2023-04-05 11:30:46,033 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 11:30:46,033 - Detection -   best_eval_score = 73.63
2023-04-05 11:30:46,033 - Detection -   eval_score = 73.52
2023-04-05 11:30:46,033 - Detection -   train_loss = 0.8999320318301519
2023-04-05 11:30:49,211 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 11:30:49,211 - Detection -   best_eval_score = 73.63
2023-04-05 11:30:49,211 - Detection -   eval_score = 73.63
2023-04-05 11:30:49,211 - Detection -   train_loss = 0.8961447874704996
2023-04-05 11:30:52,391 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 11:30:52,391 - Detection -   best_eval_score = 73.63
2023-04-05 11:30:52,391 - Detection -   eval_score = 73.63
2023-04-05 11:30:52,391 - Detection -   train_loss = 0.908773772418499
2023-04-05 11:30:52,392 - Detection - Training Finished...
2023-04-05 11:30:52,392 - Detection - Testing begin...
2023-04-05 11:30:57,378 - Detection - ***** Test: Confusion Matrix *****
2023-04-05 11:30:57,378 - Detection - [[ 265    0    0    0    0   35]
 [   0  204    0    0    5   91]
 [   0    3  234    1    0   62]
 [   0    1    0  245    0   54]
 [   0    0    0    0  279   21]
 [  12  232   57  113    5 4081]]
2023-04-05 11:30:57,378 - Detection - ***** Test results *****
2023-04-05 11:30:57,378 - Detection -   Acc = 88.47
2023-04-05 11:30:57,378 - Detection -   F1 = 81.2596
2023-04-05 11:30:57,378 - Detection -   F1-known = 79.0539
2023-04-05 11:30:57,378 - Detection -   F1-open = 92.2886
2023-04-05 11:30:57,378 - Detection - Testing finished...
2023-04-05 11:30:57,379 - Detection - Results saved in results/results_DA-ADB.csv
2023-04-05 11:30:57,398 - Detection - Open Intent Detection Finished...
