2023-04-21 19:08:16,929 - Detection - Open Intent Detection Begin...
2023-04-21 19:08:16,929 - Detection - Parameters Initialization...
2023-04-21 19:08:16,929 - Detection - ============================== Params ==============================
2023-04-21 19:08:16,929 - Detection - type:	open_intent_detection
2023-04-21 19:08:16,929 - Detection - logger_name:	Detection
2023-04-21 19:08:16,929 - Detection - log_dir:	logs
2023-04-21 19:08:16,929 - Detection - dataset:	oos_cg
2023-04-21 19:08:16,929 - Detection - known_cls_ratio:	0.5
2023-04-21 19:08:16,929 - Detection - labeled_ratio:	1.0
2023-04-21 19:08:16,929 - Detection - method:	DA-ADB
2023-04-21 19:08:16,929 - Detection - train:	True
2023-04-21 19:08:16,929 - Detection - pretrain:	True
2023-04-21 19:08:16,929 - Detection - save_model:	False
2023-04-21 19:08:16,929 - Detection - backbone:	bert_disaware_boost
2023-04-21 19:08:16,929 - Detection - config_file_name:	DA-ADB
2023-04-21 19:08:16,929 - Detection - seed:	8
2023-04-21 19:08:16,929 - Detection - gpu_id:	0
2023-04-21 19:08:16,929 - Detection - pipe_results_path:	pipe_results
2023-04-21 19:08:16,929 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-21 19:08:16,929 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-21 19:08:16,929 - Detection - model_dir:	models
2023-04-21 19:08:16,929 - Detection - load_pretrained_method:	None
2023-04-21 19:08:16,929 - Detection - result_dir:	results
2023-04-21 19:08:16,929 - Detection - results_file_name:	results_DA-ADB-BOOST.csv
2023-04-21 19:08:16,929 - Detection - save_results:	True
2023-04-21 19:08:16,929 - Detection - loss_fct:	CrossEntropyLoss
2023-04-21 19:08:16,929 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_oos_cg_0.5_1.0_bert_disaware_boost_8
2023-04-21 19:08:16,929 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_oos_cg_0.5_1.0_bert_disaware_boost_8/models
2023-04-21 19:08:16,929 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-21 19:08:16,929 - Detection - num_train_epochs:	100
2023-04-21 19:08:16,929 - Detection - num_labels:	None
2023-04-21 19:08:16,929 - Detection - max_seq_length:	None
2023-04-21 19:08:16,929 - Detection - freeze_backbone_parameters:	True
2023-04-21 19:08:16,929 - Detection - feat_dim:	768
2023-04-21 19:08:16,930 - Detection - warmup_proportion:	0.1
2023-04-21 19:08:16,930 - Detection - scale:	4
2023-04-21 19:08:16,930 - Detection - lr_boundary:	0.05
2023-04-21 19:08:16,930 - Detection - lr:	2e-05
2023-04-21 19:08:16,930 - Detection - activation:	relu
2023-04-21 19:08:16,930 - Detection - train_batch_size:	128
2023-04-21 19:08:16,930 - Detection - eval_batch_size:	64
2023-04-21 19:08:16,930 - Detection - test_batch_size:	64
2023-04-21 19:08:16,930 - Detection - wait_patient:	10
2023-04-21 19:08:16,930 - Detection - ============================== End Params ==============================
2023-04-21 19:08:16,930 - Detection - Data and Model Preparation...
2023-04-21 19:08:16,930 - Detection - The number of known intents is 75
2023-04-21 19:08:16,930 - Detection - Lists of known labels are: ['apr', 'credit_limit_change', 'cook_time', 'what_are_your_hobbies', 'make_call', 'definition', 'change_speed', 'where_are_you_from', 'travel_alert', 'next_holiday', 'ingredients_list', 'credit_score', 'rollover_401k', 'greeting', 'text', 'whisper_mode', 'user_name', 'todo_list_update', 'meeting_schedule', 'transactions', 'how_old_are_you', 'account_blocked', 'meal_suggestion', 'pto_request', 'replacement_card_duration', 'accept_reservations', 'thank_you', 'application_status', 'car_rental', 'taxes', 'food_last', 'calendar', 'change_language', 'tire_change', 'pto_request_status', 'no', 'travel_suggestion', 'pto_balance', 'date', 'repeat', 'measurement_conversion', 'find_phone', 'oil_change_how', 'insurance_change', 'yes', 'goodbye', 'flip_coin', 'expiration_date', 'w2', 'shopping_list', 'smart_home', 'translate', 'change_volume', 'bill_due', 'jump_start', 'order', 'insurance', 'calculator', 'direct_deposit', 'nutrition_info', 'reset_settings', 'are_you_a_bot', 'report_lost_card', 'vaccines', 'oil_change_when', 'change_user_name', 'what_song', 'plug_type', 'ingredient_substitution', 'cancel_reservation', 'next_song', 'what_is_your_name', 'timer', 'carry_on', 'time']
2023-04-21 19:08:16,942 - Detection - Number of labeled training samples = 1933
2023-04-21 19:08:16,942 - Detection - Number of unlabeled training samples = 1750
2023-04-21 19:08:16,946 - Detection - Number of evaluation samples = 831
2023-04-21 19:08:16,954 - Detection - Number of testing samples = 3632
2023-04-21 19:08:22,537 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-21 19:08:22,616 - Detection - Pre-training Begin...
2023-04-21 19:08:25,926 - Detection - ***** Epoch: 1: Eval results *****
2023-04-21 19:08:25,926 - Detection -   best_eval_score = 0
2023-04-21 19:08:25,926 - Detection -   eval_score = 0.22
2023-04-21 19:08:25,926 - Detection -   train_loss = 4.317075729370117
2023-04-21 19:08:47,949 - Detection - ***** Epoch: 2: Eval results *****
2023-04-21 19:08:47,949 - Detection -   best_eval_score = 0.22
2023-04-21 19:08:47,949 - Detection -   eval_score = 0.39
2023-04-21 19:08:47,949 - Detection -   train_loss = 4.29194575548172
2023-04-21 19:09:09,935 - Detection - ***** Epoch: 3: Eval results *****
2023-04-21 19:09:09,935 - Detection -   best_eval_score = 0.39
2023-04-21 19:09:09,935 - Detection -   eval_score = 6.78
2023-04-21 19:09:09,935 - Detection -   train_loss = 4.129103571176529
2023-04-21 19:09:31,888 - Detection - ***** Epoch: 4: Eval results *****
2023-04-21 19:09:31,889 - Detection -   best_eval_score = 6.78
2023-04-21 19:09:31,889 - Detection -   eval_score = 16.5
2023-04-21 19:09:31,889 - Detection -   train_loss = 3.7820128053426743
2023-04-21 19:09:53,924 - Detection - ***** Epoch: 5: Eval results *****
2023-04-21 19:09:53,925 - Detection -   best_eval_score = 16.5
2023-04-21 19:09:53,925 - Detection -   eval_score = 27.99
2023-04-21 19:09:53,925 - Detection -   train_loss = 3.2759189903736115
2023-04-21 19:10:16,025 - Detection - ***** Epoch: 6: Eval results *****
2023-04-21 19:10:16,026 - Detection -   best_eval_score = 27.99
2023-04-21 19:10:16,026 - Detection -   eval_score = 40.55
2023-04-21 19:10:16,026 - Detection -   train_loss = 2.7588547617197037
2023-04-21 19:10:38,114 - Detection - ***** Epoch: 7: Eval results *****
2023-04-21 19:10:38,114 - Detection -   best_eval_score = 40.55
2023-04-21 19:10:38,114 - Detection -   eval_score = 47.39
2023-04-21 19:10:38,114 - Detection -   train_loss = 2.437926024198532
2023-04-21 19:11:00,076 - Detection - ***** Epoch: 8: Eval results *****
2023-04-21 19:11:00,076 - Detection -   best_eval_score = 47.39
2023-04-21 19:11:00,076 - Detection -   eval_score = 54.11
2023-04-21 19:11:00,076 - Detection -   train_loss = 2.226117432117462
2023-04-21 19:11:22,083 - Detection - ***** Epoch: 9: Eval results *****
2023-04-21 19:11:22,083 - Detection -   best_eval_score = 54.11
2023-04-21 19:11:22,083 - Detection -   eval_score = 60.08
2023-04-21 19:11:22,083 - Detection -   train_loss = 2.0315644070506096
2023-04-21 19:11:44,063 - Detection - ***** Epoch: 10: Eval results *****
2023-04-21 19:11:44,063 - Detection -   best_eval_score = 60.08
2023-04-21 19:11:44,063 - Detection -   eval_score = 64.61
2023-04-21 19:11:44,063 - Detection -   train_loss = 1.868662342429161
2023-04-21 19:12:06,267 - Detection - ***** Epoch: 11: Eval results *****
2023-04-21 19:12:06,267 - Detection -   best_eval_score = 64.61
2023-04-21 19:12:06,267 - Detection -   eval_score = 66.24
2023-04-21 19:12:06,267 - Detection -   train_loss = 1.7527088224887848
2023-04-21 19:12:28,306 - Detection - ***** Epoch: 12: Eval results *****
2023-04-21 19:12:28,306 - Detection -   best_eval_score = 66.24
2023-04-21 19:12:28,306 - Detection -   eval_score = 68.35
2023-04-21 19:12:28,306 - Detection -   train_loss = 1.6901667937636375
2023-04-21 19:12:50,250 - Detection - ***** Epoch: 13: Eval results *****
2023-04-21 19:12:50,250 - Detection -   best_eval_score = 68.35
2023-04-21 19:12:50,250 - Detection -   eval_score = 70.3
2023-04-21 19:12:50,250 - Detection -   train_loss = 1.5901993066072464
2023-04-21 19:13:12,331 - Detection - ***** Epoch: 14: Eval results *****
2023-04-21 19:13:12,331 - Detection -   best_eval_score = 70.3
2023-04-21 19:13:12,331 - Detection -   eval_score = 70.94
2023-04-21 19:13:12,331 - Detection -   train_loss = 1.5419592261314392
2023-04-21 19:13:34,331 - Detection - ***** Epoch: 15: Eval results *****
2023-04-21 19:13:34,331 - Detection -   best_eval_score = 70.94
2023-04-21 19:13:34,331 - Detection -   eval_score = 72.37
2023-04-21 19:13:34,331 - Detection -   train_loss = 1.493848592042923
2023-04-21 19:13:56,601 - Detection - ***** Epoch: 16: Eval results *****
2023-04-21 19:13:56,601 - Detection -   best_eval_score = 72.37
2023-04-21 19:13:56,601 - Detection -   eval_score = 73.15
2023-04-21 19:13:56,601 - Detection -   train_loss = 1.4560731127858162
2023-04-21 19:14:18,590 - Detection - ***** Epoch: 17: Eval results *****
2023-04-21 19:14:18,590 - Detection -   best_eval_score = 73.15
2023-04-21 19:14:18,590 - Detection -   eval_score = 73.44
2023-04-21 19:14:18,590 - Detection -   train_loss = 1.405537188053131
2023-04-21 19:14:40,550 - Detection - ***** Epoch: 18: Eval results *****
2023-04-21 19:14:40,551 - Detection -   best_eval_score = 73.44
2023-04-21 19:14:40,551 - Detection -   eval_score = 74.18
2023-04-21 19:14:40,551 - Detection -   train_loss = 1.3772902935743332
2023-04-21 19:15:02,515 - Detection - ***** Epoch: 19: Eval results *****
2023-04-21 19:15:02,515 - Detection -   best_eval_score = 74.18
2023-04-21 19:15:02,515 - Detection -   eval_score = 75.61
2023-04-21 19:15:02,515 - Detection -   train_loss = 1.3488597050309181
2023-04-21 19:15:24,488 - Detection - ***** Epoch: 20: Eval results *****
2023-04-21 19:15:24,488 - Detection -   best_eval_score = 75.61
2023-04-21 19:15:24,488 - Detection -   eval_score = 75.37
2023-04-21 19:15:24,488 - Detection -   train_loss = 1.3288863897323608
2023-04-21 19:15:46,506 - Detection - ***** Epoch: 21: Eval results *****
2023-04-21 19:15:46,506 - Detection -   best_eval_score = 75.61
2023-04-21 19:15:46,506 - Detection -   eval_score = 76.54
2023-04-21 19:15:46,506 - Detection -   train_loss = 1.308203600347042
2023-04-21 19:16:08,472 - Detection - ***** Epoch: 22: Eval results *****
2023-04-21 19:16:08,472 - Detection -   best_eval_score = 76.54
2023-04-21 19:16:08,472 - Detection -   eval_score = 76.28
2023-04-21 19:16:08,472 - Detection -   train_loss = 1.2863382622599602
2023-04-21 19:16:30,472 - Detection - ***** Epoch: 23: Eval results *****
2023-04-21 19:16:30,472 - Detection -   best_eval_score = 76.54
2023-04-21 19:16:30,472 - Detection -   eval_score = 76.63
2023-04-21 19:16:30,472 - Detection -   train_loss = 1.2671129629015923
2023-04-21 19:16:52,582 - Detection - ***** Epoch: 24: Eval results *****
2023-04-21 19:16:52,582 - Detection -   best_eval_score = 76.63
2023-04-21 19:16:52,582 - Detection -   eval_score = 77.25
2023-04-21 19:16:52,582 - Detection -   train_loss = 1.258232481777668
2023-04-21 19:17:14,677 - Detection - ***** Epoch: 25: Eval results *****
2023-04-21 19:17:14,677 - Detection -   best_eval_score = 77.25
2023-04-21 19:17:14,677 - Detection -   eval_score = 76.54
2023-04-21 19:17:14,677 - Detection -   train_loss = 1.2374804466962814
2023-04-21 19:17:36,634 - Detection - ***** Epoch: 26: Eval results *****
2023-04-21 19:17:36,634 - Detection -   best_eval_score = 77.25
2023-04-21 19:17:36,634 - Detection -   eval_score = 77.28
2023-04-21 19:17:36,634 - Detection -   train_loss = 1.2308324202895164
2023-04-21 19:17:58,772 - Detection - ***** Epoch: 27: Eval results *****
2023-04-21 19:17:58,772 - Detection -   best_eval_score = 77.28
2023-04-21 19:17:58,772 - Detection -   eval_score = 77.31
2023-04-21 19:17:58,772 - Detection -   train_loss = 1.2163091897964478
2023-04-21 19:18:20,860 - Detection - ***** Epoch: 28: Eval results *****
2023-04-21 19:18:20,860 - Detection -   best_eval_score = 77.31
2023-04-21 19:18:20,860 - Detection -   eval_score = 77.73
2023-04-21 19:18:20,861 - Detection -   train_loss = 1.2106075137853622
2023-04-21 19:18:42,858 - Detection - ***** Epoch: 29: Eval results *****
2023-04-21 19:18:42,858 - Detection -   best_eval_score = 77.73
2023-04-21 19:18:42,858 - Detection -   eval_score = 77.1
2023-04-21 19:18:42,858 - Detection -   train_loss = 1.1944570392370224
2023-04-21 19:19:04,870 - Detection - ***** Epoch: 30: Eval results *****
2023-04-21 19:19:04,870 - Detection -   best_eval_score = 77.73
2023-04-21 19:19:04,870 - Detection -   eval_score = 76.78
2023-04-21 19:19:04,870 - Detection -   train_loss = 1.1896732673048973
2023-04-21 19:19:26,930 - Detection - ***** Epoch: 31: Eval results *****
2023-04-21 19:19:26,930 - Detection -   best_eval_score = 77.73
2023-04-21 19:19:26,930 - Detection -   eval_score = 76.67
2023-04-21 19:19:26,930 - Detection -   train_loss = 1.1881302297115326
2023-04-21 19:19:49,004 - Detection - ***** Epoch: 32: Eval results *****
2023-04-21 19:19:49,004 - Detection -   best_eval_score = 77.73
2023-04-21 19:19:49,005 - Detection -   eval_score = 77.52
2023-04-21 19:19:49,005 - Detection -   train_loss = 1.1852579191327095
2023-04-21 19:20:10,956 - Detection - ***** Epoch: 33: Eval results *****
2023-04-21 19:20:10,956 - Detection -   best_eval_score = 77.73
2023-04-21 19:20:10,956 - Detection -   eval_score = 76.88
2023-04-21 19:20:10,956 - Detection -   train_loss = 1.1648101657629013
2023-04-21 19:20:32,966 - Detection - ***** Epoch: 34: Eval results *****
2023-04-21 19:20:32,966 - Detection -   best_eval_score = 77.73
2023-04-21 19:20:32,966 - Detection -   eval_score = 76.72
2023-04-21 19:20:32,966 - Detection -   train_loss = 1.1581391990184784
2023-04-21 19:20:54,966 - Detection - ***** Epoch: 35: Eval results *****
2023-04-21 19:20:54,966 - Detection -   best_eval_score = 77.73
2023-04-21 19:20:54,966 - Detection -   eval_score = 76.91
2023-04-21 19:20:54,966 - Detection -   train_loss = 1.157698579132557
2023-04-21 19:21:17,102 - Detection - ***** Epoch: 36: Eval results *****
2023-04-21 19:21:17,102 - Detection -   best_eval_score = 77.73
2023-04-21 19:21:17,102 - Detection -   eval_score = 76.54
2023-04-21 19:21:17,102 - Detection -   train_loss = 1.1524564027786255
2023-04-21 19:21:39,110 - Detection - ***** Epoch: 37: Eval results *****
2023-04-21 19:21:39,110 - Detection -   best_eval_score = 77.73
2023-04-21 19:21:39,110 - Detection -   eval_score = 76.27
2023-04-21 19:21:39,110 - Detection -   train_loss = 1.1429514288902283
2023-04-21 19:22:01,204 - Detection - ***** Epoch: 38: Eval results *****
2023-04-21 19:22:01,204 - Detection -   best_eval_score = 77.73
2023-04-21 19:22:01,204 - Detection -   eval_score = 77.14
2023-04-21 19:22:01,204 - Detection -   train_loss = 1.1416640430688858
2023-04-21 19:22:01,205 - Detection - Pre-training finished...
2023-04-21 19:22:01,205 - Detection - Training Begin...
2023-04-21 19:22:02,914 - Detection - ***** Epoch: 1: Eval results *****
2023-04-21 19:22:02,914 - Detection -   best_eval_score = 0
2023-04-21 19:22:02,914 - Detection -   eval_score = 2.44
2023-04-21 19:22:02,914 - Detection -   train_loss = 3.0318979769945145
2023-04-21 19:22:23,521 - Detection - ***** Epoch: 2: Eval results *****
2023-04-21 19:22:23,521 - Detection -   best_eval_score = 2.44
2023-04-21 19:22:23,521 - Detection -   eval_score = 34.78
2023-04-21 19:22:23,521 - Detection -   train_loss = 2.6294606029987335
2023-04-21 19:22:44,182 - Detection - ***** Epoch: 3: Eval results *****
2023-04-21 19:22:44,182 - Detection -   best_eval_score = 34.78
2023-04-21 19:22:44,182 - Detection -   eval_score = 36.38
2023-04-21 19:22:44,182 - Detection -   train_loss = 0.5665436089038849
2023-04-21 19:23:04,855 - Detection - ***** Epoch: 4: Eval results *****
2023-04-21 19:23:04,856 - Detection -   best_eval_score = 36.38
2023-04-21 19:23:04,856 - Detection -   eval_score = 35.35
2023-04-21 19:23:04,856 - Detection -   train_loss = 0.5401630029082298
2023-04-21 19:23:25,611 - Detection - ***** Epoch: 5: Eval results *****
2023-04-21 19:23:25,611 - Detection -   best_eval_score = 36.38
2023-04-21 19:23:25,611 - Detection -   eval_score = 35.89
2023-04-21 19:23:25,611 - Detection -   train_loss = 0.5449702329933643
2023-04-21 19:23:46,196 - Detection - ***** Epoch: 6: Eval results *****
2023-04-21 19:23:46,196 - Detection -   best_eval_score = 36.38
2023-04-21 19:23:46,196 - Detection -   eval_score = 34.85
2023-04-21 19:23:46,196 - Detection -   train_loss = 0.5354766733944416
2023-04-21 19:24:06,787 - Detection - ***** Epoch: 7: Eval results *****
2023-04-21 19:24:06,787 - Detection -   best_eval_score = 36.38
2023-04-21 19:24:06,787 - Detection -   eval_score = 34.59
2023-04-21 19:24:06,787 - Detection -   train_loss = 0.536026731133461
2023-04-21 19:24:27,522 - Detection - ***** Epoch: 8: Eval results *****
2023-04-21 19:24:27,522 - Detection -   best_eval_score = 36.38
2023-04-21 19:24:27,522 - Detection -   eval_score = 34.35
2023-04-21 19:24:27,522 - Detection -   train_loss = 0.5418273434042931
2023-04-21 19:24:48,213 - Detection - ***** Epoch: 9: Eval results *****
2023-04-21 19:24:48,213 - Detection -   best_eval_score = 36.38
2023-04-21 19:24:48,213 - Detection -   eval_score = 35.54
2023-04-21 19:24:48,213 - Detection -   train_loss = 0.542989632114768
2023-04-21 19:25:08,948 - Detection - ***** Epoch: 10: Eval results *****
2023-04-21 19:25:08,948 - Detection -   best_eval_score = 36.38
2023-04-21 19:25:08,948 - Detection -   eval_score = 35.49
2023-04-21 19:25:08,948 - Detection -   train_loss = 0.561438363045454
2023-04-21 19:25:29,643 - Detection - ***** Epoch: 11: Eval results *****
2023-04-21 19:25:29,643 - Detection -   best_eval_score = 36.38
2023-04-21 19:25:29,643 - Detection -   eval_score = 35.22
2023-04-21 19:25:29,643 - Detection -   train_loss = 0.5449668671935797
2023-04-21 19:25:50,287 - Detection - ***** Epoch: 12: Eval results *****
2023-04-21 19:25:50,287 - Detection -   best_eval_score = 36.38
2023-04-21 19:25:50,287 - Detection -   eval_score = 34.42
2023-04-21 19:25:50,287 - Detection -   train_loss = 0.5484280306845903
2023-04-21 19:26:10,925 - Detection - ***** Epoch: 13: Eval results *****
2023-04-21 19:26:10,925 - Detection -   best_eval_score = 36.38
2023-04-21 19:26:10,925 - Detection -   eval_score = 35.03
2023-04-21 19:26:10,925 - Detection -   train_loss = 0.5489181876182556
2023-04-21 19:26:10,925 - Detection - Training Finished...
2023-04-21 19:26:10,926 - Detection - Testing begin...
2023-04-21 19:26:12,989 - Detection - ***** Test: Confusion Matrix *****
2023-04-21 19:26:12,989 - Detection - [[   0    0    0 ...    0    0   11]
 [   0   11    0 ...    0    0   10]
 [   0    0    0 ...    0    0    8]
 ...
 [   0    0    0 ...   16    0    6]
 [   0    0    0 ...    0    1    9]
 [   1    1    3 ...    1    7 2330]]
2023-04-21 19:26:12,989 - Detection - ***** Test results *****
2023-04-21 19:26:12,989 - Detection -   Acc = 74.34
2023-04-21 19:26:12,989 - Detection -   F1 = 37.0398
2023-04-21 19:26:12,989 - Detection -   F1-known = 36.418
2023-04-21 19:26:12,989 - Detection -   F1-open = 83.6775
2023-04-21 19:26:12,989 - Detection - Testing finished...
2023-04-21 19:26:12,989 - Detection - Results saved in results/results_DA-ADB-BOOST.csv
2023-04-21 19:26:13,008 - Detection - Open Intent Detection Finished...
