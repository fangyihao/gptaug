2023-04-24 11:58:57,510 - Detection - Open Intent Detection Begin...
2023-04-24 11:58:57,510 - Detection - Parameters Initialization...
2023-04-24 11:58:57,510 - Detection - ============================== Params ==============================
2023-04-24 11:58:57,510 - Detection - type:	open_intent_detection
2023-04-24 11:58:57,510 - Detection - logger_name:	Detection
2023-04-24 11:58:57,510 - Detection - log_dir:	logs
2023-04-24 11:58:57,510 - Detection - dataset:	stackoverflow_cg
2023-04-24 11:58:57,510 - Detection - known_cls_ratio:	0.5
2023-04-24 11:58:57,510 - Detection - labeled_ratio:	1.0
2023-04-24 11:58:57,510 - Detection - method:	ADB
2023-04-24 11:58:57,510 - Detection - train:	True
2023-04-24 11:58:57,510 - Detection - pretrain:	True
2023-04-24 11:58:57,510 - Detection - save_model:	False
2023-04-24 11:58:57,510 - Detection - backbone:	bert_boost
2023-04-24 11:58:57,510 - Detection - config_file_name:	ADB
2023-04-24 11:58:57,510 - Detection - seed:	7
2023-04-24 11:58:57,510 - Detection - gpu_id:	0
2023-04-24 11:58:57,510 - Detection - pipe_results_path:	pipe_results
2023-04-24 11:58:57,510 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-24 11:58:57,510 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-24 11:58:57,510 - Detection - model_dir:	models
2023-04-24 11:58:57,510 - Detection - load_pretrained_method:	None
2023-04-24 11:58:57,510 - Detection - result_dir:	results
2023-04-24 11:58:57,510 - Detection - results_file_name:	results_ADB-BOOST-F-10.csv
2023-04-24 11:58:57,510 - Detection - save_results:	True
2023-04-24 11:58:57,510 - Detection - loss_fct:	CrossEntropyLoss
2023-04-24 11:58:57,510 - Detection - boost_method:	F-10
2023-04-24 11:58:57,510 - Detection - boost_start_score:	0.0
2023-04-24 11:58:57,510 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.5_1.0_bert_boost_7
2023-04-24 11:58:57,510 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.5_1.0_bert_boost_7/models
2023-04-24 11:58:57,510 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-24 11:58:57,511 - Detection - num_train_epochs:	100
2023-04-24 11:58:57,511 - Detection - num_labels:	None
2023-04-24 11:58:57,511 - Detection - max_seq_length:	None
2023-04-24 11:58:57,511 - Detection - freeze_backbone_parameters:	True
2023-04-24 11:58:57,511 - Detection - feat_dim:	768
2023-04-24 11:58:57,511 - Detection - warmup_proportion:	0.1
2023-04-24 11:58:57,511 - Detection - lr_boundary:	0.05
2023-04-24 11:58:57,511 - Detection - lr:	2e-05
2023-04-24 11:58:57,511 - Detection - activation:	relu
2023-04-24 11:58:57,511 - Detection - train_batch_size:	128
2023-04-24 11:58:57,511 - Detection - eval_batch_size:	64
2023-04-24 11:58:57,511 - Detection - test_batch_size:	64
2023-04-24 11:58:57,511 - Detection - wait_patient:	10
2023-04-24 11:58:57,511 - Detection - ============================== End Params ==============================
2023-04-24 11:58:57,511 - Detection - Data and Model Preparation...
2023-04-24 11:58:57,511 - Detection - The number of known intents is 10
2023-04-24 11:58:57,511 - Detection - Lists of known labels are: ['apache', 'svn', 'bash', 'excel', 'oracle', 'ajax', 'visual-studio', 'haskell', 'qt', 'wordpress']
2023-04-24 11:58:57,519 - Detection - Number of labeled training samples = 1379
2023-04-24 11:58:57,520 - Detection - Number of unlabeled training samples = 1412
2023-04-24 11:58:57,522 - Detection - Number of evaluation samples = 696
2023-04-24 11:58:57,528 - Detection - Number of testing samples = 2905
2023-04-24 11:59:01,615 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-24 11:59:03,277 - Detection - Pre-training Begin...
2023-04-24 11:59:05,613 - Detection - ***** Epoch: 1: Eval results *****
2023-04-24 11:59:05,613 - Detection -   best_eval_score = 0
2023-04-24 11:59:05,613 - Detection -   eval_score = 8.19
2023-04-24 11:59:05,613 - Detection -   train_loss = 2.2979366562583228
2023-04-24 11:59:26,137 - Detection - ***** Epoch: 2: Eval results *****
2023-04-24 11:59:26,137 - Detection -   best_eval_score = 8.19
2023-04-24 11:59:26,137 - Detection -   eval_score = 46.12
2023-04-24 11:59:26,137 - Detection -   train_loss = 2.2836114059795034
2023-04-24 11:59:46,677 - Detection - ***** Epoch: 3: Eval results *****
2023-04-24 11:59:46,677 - Detection -   best_eval_score = 46.12
2023-04-24 11:59:46,677 - Detection -   eval_score = 78.88
2023-04-24 11:59:46,677 - Detection -   train_loss = 1.8325450203635476
2023-04-24 12:00:07,178 - Detection - ***** Epoch: 4: Eval results *****
2023-04-24 12:00:07,179 - Detection -   best_eval_score = 78.88
2023-04-24 12:00:07,179 - Detection -   eval_score = 82.04
2023-04-24 12:00:07,179 - Detection -   train_loss = 0.9586815400557085
2023-04-24 12:00:27,724 - Detection - ***** Epoch: 5: Eval results *****
2023-04-24 12:00:27,724 - Detection -   best_eval_score = 82.04
2023-04-24 12:00:27,724 - Detection -   eval_score = 84.91
2023-04-24 12:00:27,724 - Detection -   train_loss = 0.6674435030330311
2023-04-24 12:00:48,282 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 12:00:48,282 - Detection -   best_eval_score = 84.91
2023-04-24 12:00:48,282 - Detection -   eval_score = 84.63
2023-04-24 12:00:48,282 - Detection -   train_loss = 0.514085674827749
2023-04-24 12:01:08,807 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 12:01:08,808 - Detection -   best_eval_score = 84.91
2023-04-24 12:01:08,808 - Detection -   eval_score = 84.77
2023-04-24 12:01:08,808 - Detection -   train_loss = 0.3845313137227839
2023-04-24 12:01:29,269 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 12:01:29,269 - Detection -   best_eval_score = 84.91
2023-04-24 12:01:29,269 - Detection -   eval_score = 85.06
2023-04-24 12:01:29,269 - Detection -   train_loss = 0.28861490298401227
2023-04-24 12:01:50,025 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 12:01:50,025 - Detection -   best_eval_score = 85.06
2023-04-24 12:01:50,025 - Detection -   eval_score = 84.63
2023-04-24 12:01:50,025 - Detection -   train_loss = 0.22377269647338174
2023-04-24 12:02:10,609 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 12:02:10,609 - Detection -   best_eval_score = 85.06
2023-04-24 12:02:10,609 - Detection -   eval_score = 83.62
2023-04-24 12:02:10,609 - Detection -   train_loss = 0.16142499582334
2023-04-24 12:02:31,206 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 12:02:31,206 - Detection -   best_eval_score = 85.06
2023-04-24 12:02:31,206 - Detection -   eval_score = 84.48
2023-04-24 12:02:31,206 - Detection -   train_loss = 0.13054363835941662
2023-04-24 12:02:51,800 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 12:02:51,800 - Detection -   best_eval_score = 85.06
2023-04-24 12:02:51,800 - Detection -   eval_score = 85.06
2023-04-24 12:02:51,800 - Detection -   train_loss = 0.10539454289458015
2023-04-24 12:03:12,348 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 12:03:12,348 - Detection -   best_eval_score = 85.06
2023-04-24 12:03:12,348 - Detection -   eval_score = 85.2
2023-04-24 12:03:12,348 - Detection -   train_loss = 0.09554107351736589
2023-04-24 12:03:32,953 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 12:03:32,953 - Detection -   best_eval_score = 85.2
2023-04-24 12:03:32,953 - Detection -   eval_score = 85.2
2023-04-24 12:03:32,953 - Detection -   train_loss = 0.06509275124831633
2023-04-24 12:03:53,483 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 12:03:53,483 - Detection -   best_eval_score = 85.2
2023-04-24 12:03:53,483 - Detection -   eval_score = 84.34
2023-04-24 12:03:53,483 - Detection -   train_loss = 0.052795233712954956
2023-04-24 12:04:14,037 - Detection - ***** Epoch: 16: Eval results *****
2023-04-24 12:04:14,037 - Detection -   best_eval_score = 85.2
2023-04-24 12:04:14,037 - Detection -   eval_score = 85.06
2023-04-24 12:04:14,037 - Detection -   train_loss = 0.05498445118692788
2023-04-24 12:04:34,646 - Detection - ***** Epoch: 17: Eval results *****
2023-04-24 12:04:34,647 - Detection -   best_eval_score = 85.2
2023-04-24 12:04:34,647 - Detection -   eval_score = 85.34
2023-04-24 12:04:34,647 - Detection -   train_loss = 0.04362895525991917
2023-04-24 12:04:55,207 - Detection - ***** Epoch: 18: Eval results *****
2023-04-24 12:04:55,207 - Detection -   best_eval_score = 85.34
2023-04-24 12:04:55,208 - Detection -   eval_score = 85.34
2023-04-24 12:04:55,208 - Detection -   train_loss = 0.04523907195438038
2023-04-24 12:05:15,714 - Detection - ***** Epoch: 19: Eval results *****
2023-04-24 12:05:15,715 - Detection -   best_eval_score = 85.34
2023-04-24 12:05:15,715 - Detection -   eval_score = 85.06
2023-04-24 12:05:15,715 - Detection -   train_loss = 0.030728338624943386
2023-04-24 12:05:36,249 - Detection - ***** Epoch: 20: Eval results *****
2023-04-24 12:05:36,249 - Detection -   best_eval_score = 85.34
2023-04-24 12:05:36,249 - Detection -   eval_score = 85.06
2023-04-24 12:05:36,249 - Detection -   train_loss = 0.029985554854978214
2023-04-24 12:05:56,829 - Detection - ***** Epoch: 21: Eval results *****
2023-04-24 12:05:56,829 - Detection -   best_eval_score = 85.34
2023-04-24 12:05:56,829 - Detection -   eval_score = 84.63
2023-04-24 12:05:56,829 - Detection -   train_loss = 0.028083950027146122
2023-04-24 12:06:17,366 - Detection - ***** Epoch: 22: Eval results *****
2023-04-24 12:06:17,366 - Detection -   best_eval_score = 85.34
2023-04-24 12:06:17,366 - Detection -   eval_score = 85.06
2023-04-24 12:06:17,366 - Detection -   train_loss = 0.026777728884057564
2023-04-24 12:06:38,097 - Detection - ***** Epoch: 23: Eval results *****
2023-04-24 12:06:38,097 - Detection -   best_eval_score = 85.34
2023-04-24 12:06:38,097 - Detection -   eval_score = 85.2
2023-04-24 12:06:38,097 - Detection -   train_loss = 0.024904461958530275
2023-04-24 12:06:58,755 - Detection - ***** Epoch: 24: Eval results *****
2023-04-24 12:06:58,755 - Detection -   best_eval_score = 85.34
2023-04-24 12:06:58,755 - Detection -   eval_score = 84.91
2023-04-24 12:06:58,755 - Detection -   train_loss = 0.02657424785535444
2023-04-24 12:07:19,280 - Detection - ***** Epoch: 25: Eval results *****
2023-04-24 12:07:19,280 - Detection -   best_eval_score = 85.34
2023-04-24 12:07:19,280 - Detection -   eval_score = 84.63
2023-04-24 12:07:19,281 - Detection -   train_loss = 0.021588661369274963
2023-04-24 12:07:39,805 - Detection - ***** Epoch: 26: Eval results *****
2023-04-24 12:07:39,805 - Detection -   best_eval_score = 85.34
2023-04-24 12:07:39,805 - Detection -   eval_score = 84.77
2023-04-24 12:07:39,805 - Detection -   train_loss = 0.014476937030188063
2023-04-24 12:08:00,331 - Detection - ***** Epoch: 27: Eval results *****
2023-04-24 12:08:00,331 - Detection -   best_eval_score = 85.34
2023-04-24 12:08:00,331 - Detection -   eval_score = 84.77
2023-04-24 12:08:00,331 - Detection -   train_loss = 0.025836996480145237
2023-04-24 12:08:00,332 - Detection - Pre-training finished...
2023-04-24 12:08:00,332 - Detection - Training Begin...
2023-04-24 12:08:03,293 - Detection - ***** Epoch: 1: Eval results *****
2023-04-24 12:08:03,293 - Detection -   best_eval_score = 0
2023-04-24 12:08:03,293 - Detection -   eval_score = 0.0
2023-04-24 12:08:03,293 - Detection -   train_loss = 11.526676698164506
2023-04-24 12:08:05,137 - Detection - ***** Epoch: 2: Eval results *****
2023-04-24 12:08:05,137 - Detection -   best_eval_score = 0
2023-04-24 12:08:05,137 - Detection -   eval_score = 0.0
2023-04-24 12:08:05,137 - Detection -   train_loss = 11.169299992648037
2023-04-24 12:08:06,982 - Detection - ***** Epoch: 3: Eval results *****
2023-04-24 12:08:06,982 - Detection -   best_eval_score = 0
2023-04-24 12:08:06,982 - Detection -   eval_score = 0.0
2023-04-24 12:08:06,982 - Detection -   train_loss = 10.818745092912154
2023-04-24 12:08:08,830 - Detection - ***** Epoch: 4: Eval results *****
2023-04-24 12:08:08,830 - Detection -   best_eval_score = 0
2023-04-24 12:08:08,830 - Detection -   eval_score = 0.0
2023-04-24 12:08:08,830 - Detection -   train_loss = 10.34070907939564
2023-04-24 12:08:10,679 - Detection - ***** Epoch: 5: Eval results *****
2023-04-24 12:08:10,679 - Detection -   best_eval_score = 0
2023-04-24 12:08:10,679 - Detection -   eval_score = 0.0
2023-04-24 12:08:10,679 - Detection -   train_loss = 9.885051553899592
2023-04-24 12:08:12,530 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 12:08:12,530 - Detection -   best_eval_score = 0
2023-04-24 12:08:12,530 - Detection -   eval_score = 0.31
2023-04-24 12:08:12,530 - Detection -   train_loss = 9.2235858223655
2023-04-24 12:08:33,000 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 12:08:33,000 - Detection -   best_eval_score = 0.31
2023-04-24 12:08:33,000 - Detection -   eval_score = 69.17
2023-04-24 12:08:33,000 - Detection -   train_loss = 8.664692878723145
2023-04-24 12:08:53,563 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 12:08:53,563 - Detection -   best_eval_score = 69.17
2023-04-24 12:08:53,563 - Detection -   eval_score = 75.61
2023-04-24 12:08:53,563 - Detection -   train_loss = 2.389130462299694
2023-04-24 12:09:13,961 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 12:09:13,961 - Detection -   best_eval_score = 75.61
2023-04-24 12:09:13,961 - Detection -   eval_score = 75.55
2023-04-24 12:09:13,961 - Detection -   train_loss = 1.67745840549469
2023-04-24 12:09:34,407 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 12:09:34,408 - Detection -   best_eval_score = 75.61
2023-04-24 12:09:34,408 - Detection -   eval_score = 75.43
2023-04-24 12:09:34,408 - Detection -   train_loss = 1.7403099536895752
2023-04-24 12:09:54,887 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 12:09:54,887 - Detection -   best_eval_score = 75.61
2023-04-24 12:09:54,887 - Detection -   eval_score = 75.38
2023-04-24 12:09:54,887 - Detection -   train_loss = 1.6549722823229702
2023-04-24 12:10:15,281 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 12:10:15,282 - Detection -   best_eval_score = 75.61
2023-04-24 12:10:15,282 - Detection -   eval_score = 75.61
2023-04-24 12:10:15,282 - Detection -   train_loss = 1.722312168641524
2023-04-24 12:10:35,672 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 12:10:35,673 - Detection -   best_eval_score = 75.61
2023-04-24 12:10:35,673 - Detection -   eval_score = 75.34
2023-04-24 12:10:35,673 - Detection -   train_loss = 1.7169808907942339
2023-04-24 12:10:56,063 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 12:10:56,063 - Detection -   best_eval_score = 75.61
2023-04-24 12:10:56,063 - Detection -   eval_score = 75.51
2023-04-24 12:10:56,063 - Detection -   train_loss = 1.6697009151632136
2023-04-24 12:11:16,446 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 12:11:16,446 - Detection -   best_eval_score = 75.61
2023-04-24 12:11:16,447 - Detection -   eval_score = 75.45
2023-04-24 12:11:16,447 - Detection -   train_loss = 1.7092238881371238
2023-04-24 12:11:36,828 - Detection - ***** Epoch: 16: Eval results *****
2023-04-24 12:11:36,828 - Detection -   best_eval_score = 75.61
2023-04-24 12:11:36,828 - Detection -   eval_score = 75.43
2023-04-24 12:11:36,828 - Detection -   train_loss = 1.6932401115244085
2023-04-24 12:11:57,308 - Detection - ***** Epoch: 17: Eval results *****
2023-04-24 12:11:57,308 - Detection -   best_eval_score = 75.61
2023-04-24 12:11:57,308 - Detection -   eval_score = 75.44
2023-04-24 12:11:57,308 - Detection -   train_loss = 1.665623502297835
2023-04-24 12:12:17,726 - Detection - ***** Epoch: 18: Eval results *****
2023-04-24 12:12:17,726 - Detection -   best_eval_score = 75.61
2023-04-24 12:12:17,726 - Detection -   eval_score = 75.28
2023-04-24 12:12:17,727 - Detection -   train_loss = 1.7337777506221423
2023-04-24 12:12:17,727 - Detection - Training Finished...
2023-04-24 12:12:17,727 - Detection - Testing begin...
2023-04-24 12:12:20,127 - Detection - ***** Test: Confusion Matrix *****
2023-04-24 12:12:20,127 - Detection - [[  89    1    0    0    0    1    0    0    0    1   78]
 [   2  100    0    0    0    0    2    0    0    0   45]
 [   1    0   82    0    0    0    0    1    0    0   55]
 [   0    0    0   89    1    1    0    1    0    0   48]
 [   0    0    0    0   95    0    1    1    0    0   30]
 [   1    0    0    0    0  109    0    0    0    1   49]
 [   1    1    0    1    0    2   41    0    0    0   60]
 [   0    0    0    1    0    0    0   80    0    0   41]
 [   0    0    0    0    0    0    0    0  147    0   25]
 [   3    0    0    0    0    1    0    0    0  103   30]
 [  15    6    5   10   26   35    8   73    5    3 1297]]
2023-04-24 12:12:20,127 - Detection - ***** Test results *****
2023-04-24 12:12:20,127 - Detection -   Acc = 76.83
2023-04-24 12:12:20,127 - Detection -   F1 = 72.594
2023-04-24 12:12:20,127 - Detection -   F1-known = 71.8497
2023-04-24 12:12:20,127 - Detection -   F1-open = 80.037
2023-04-24 12:12:20,127 - Detection - Testing finished...
2023-04-24 12:12:20,127 - Detection - Results saved in results/results_ADB-BOOST-F-10.csv
2023-04-24 12:12:20,146 - Detection - Open Intent Detection Finished...
