2023-04-03 14:04:30,645 - Detection - Open Intent Detection Begin...
2023-04-03 14:04:30,645 - Detection - Parameters Initialization...
2023-04-03 14:04:30,646 - Detection - ============================== Params ==============================
2023-04-03 14:04:30,646 - Detection - type:	open_intent_detection
2023-04-03 14:04:30,646 - Detection - logger_name:	Detection
2023-04-03 14:04:30,646 - Detection - log_dir:	logs
2023-04-03 14:04:30,646 - Detection - dataset:	stackoverflow
2023-04-03 14:04:30,646 - Detection - known_cls_ratio:	0.25
2023-04-03 14:04:30,646 - Detection - labeled_ratio:	1.0
2023-04-03 14:04:30,646 - Detection - method:	ADB
2023-04-03 14:04:30,646 - Detection - train:	True
2023-04-03 14:04:30,646 - Detection - pretrain:	True
2023-04-03 14:04:30,646 - Detection - save_model:	True
2023-04-03 14:04:30,646 - Detection - backbone:	bert
2023-04-03 14:04:30,646 - Detection - config_file_name:	ADB
2023-04-03 14:04:30,646 - Detection - seed:	1
2023-04-03 14:04:30,646 - Detection - gpu_id:	0
2023-04-03 14:04:30,646 - Detection - pipe_results_path:	pipe_results
2023-04-03 14:04:30,646 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-03 14:04:30,646 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-03 14:04:30,646 - Detection - model_dir:	models
2023-04-03 14:04:30,646 - Detection - load_pretrained_method:	None
2023-04-03 14:04:30,646 - Detection - result_dir:	results
2023-04-03 14:04:30,646 - Detection - results_file_name:	results_ADB.csv
2023-04-03 14:04:30,646 - Detection - save_results:	True
2023-04-03 14:04:30,646 - Detection - loss_fct:	CrossEntropyLoss
2023-04-03 14:04:30,646 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_0.25_1.0_bert_1
2023-04-03 14:04:30,646 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_0.25_1.0_bert_1/models
2023-04-03 14:04:30,646 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-03 14:04:30,646 - Detection - num_train_epochs:	100
2023-04-03 14:04:30,646 - Detection - num_labels:	None
2023-04-03 14:04:30,646 - Detection - max_seq_length:	None
2023-04-03 14:04:30,646 - Detection - freeze_backbone_parameters:	True
2023-04-03 14:04:30,646 - Detection - feat_dim:	768
2023-04-03 14:04:30,646 - Detection - warmup_proportion:	0.1
2023-04-03 14:04:30,646 - Detection - lr_boundary:	0.05
2023-04-03 14:04:30,646 - Detection - lr:	2e-05
2023-04-03 14:04:30,646 - Detection - activation:	relu
2023-04-03 14:04:30,646 - Detection - train_batch_size:	128
2023-04-03 14:04:30,646 - Detection - eval_batch_size:	64
2023-04-03 14:04:30,646 - Detection - test_batch_size:	64
2023-04-03 14:04:30,646 - Detection - wait_patient:	10
2023-04-03 14:04:30,646 - Detection - ============================== End Params ==============================
2023-04-03 14:04:30,646 - Detection - Data and Model Preparation...
2023-04-03 14:04:30,647 - Detection - The number of known intents is 5
2023-04-03 14:04:30,647 - Detection - Lists of known labels are: ['cocoa', 'spring', 'haskell', 'matlab', 'bash']
2023-04-03 14:04:30,677 - Detection - Number of labeled training samples = 3000
2023-04-03 14:04:30,677 - Detection - Number of unlabeled training samples = 9000
2023-04-03 14:04:30,680 - Detection - Number of evaluation samples = 500
2023-04-03 14:04:30,692 - Detection - Number of testing samples = 6000
2023-04-03 14:04:38,082 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-03 14:04:39,742 - Detection - Pre-training Begin...
2023-04-03 14:04:43,393 - Detection - ***** Epoch: 1: Eval results *****
2023-04-03 14:04:43,393 - Detection -   best_eval_score = 0
2023-04-03 14:04:43,393 - Detection -   eval_score = 39.4
2023-04-03 14:04:43,393 - Detection -   train_loss = 1.6064126193523407
2023-04-03 14:04:46,553 - Detection - ***** Epoch: 2: Eval results *****
2023-04-03 14:04:46,553 - Detection -   best_eval_score = 39.4
2023-04-03 14:04:46,553 - Detection -   eval_score = 53.0
2023-04-03 14:04:46,554 - Detection -   train_loss = 1.5705311795075734
2023-04-03 14:04:49,723 - Detection - ***** Epoch: 3: Eval results *****
2023-04-03 14:04:49,723 - Detection -   best_eval_score = 53.0
2023-04-03 14:04:49,723 - Detection -   eval_score = 67.2
2023-04-03 14:04:49,723 - Detection -   train_loss = 1.4860299477974575
2023-04-03 14:04:52,895 - Detection - ***** Epoch: 4: Eval results *****
2023-04-03 14:04:52,895 - Detection -   best_eval_score = 67.2
2023-04-03 14:04:52,895 - Detection -   eval_score = 80.4
2023-04-03 14:04:52,895 - Detection -   train_loss = 1.2722011059522629
2023-04-03 14:04:56,072 - Detection - ***** Epoch: 5: Eval results *****
2023-04-03 14:04:56,072 - Detection -   best_eval_score = 80.4
2023-04-03 14:04:56,072 - Detection -   eval_score = 86.6
2023-04-03 14:04:56,072 - Detection -   train_loss = 0.8605837027231852
2023-04-03 14:04:59,253 - Detection - ***** Epoch: 6: Eval results *****
2023-04-03 14:04:59,253 - Detection -   best_eval_score = 86.6
2023-04-03 14:04:59,253 - Detection -   eval_score = 87.2
2023-04-03 14:04:59,253 - Detection -   train_loss = 0.5093026459217072
2023-04-03 14:05:02,439 - Detection - ***** Epoch: 7: Eval results *****
2023-04-03 14:05:02,440 - Detection -   best_eval_score = 87.2
2023-04-03 14:05:02,440 - Detection -   eval_score = 88.0
2023-04-03 14:05:02,440 - Detection -   train_loss = 0.36154163380463916
2023-04-03 14:05:05,629 - Detection - ***** Epoch: 8: Eval results *****
2023-04-03 14:05:05,629 - Detection -   best_eval_score = 88.0
2023-04-03 14:05:05,629 - Detection -   eval_score = 87.6
2023-04-03 14:05:05,629 - Detection -   train_loss = 0.31357006914913654
2023-04-03 14:05:08,815 - Detection - ***** Epoch: 9: Eval results *****
2023-04-03 14:05:08,815 - Detection -   best_eval_score = 88.0
2023-04-03 14:05:08,815 - Detection -   eval_score = 88.8
2023-04-03 14:05:08,815 - Detection -   train_loss = 0.26704387180507183
2023-04-03 14:05:12,012 - Detection - ***** Epoch: 10: Eval results *****
2023-04-03 14:05:12,012 - Detection -   best_eval_score = 88.8
2023-04-03 14:05:12,013 - Detection -   eval_score = 87.8
2023-04-03 14:05:12,013 - Detection -   train_loss = 0.2377004399895668
2023-04-03 14:05:15,202 - Detection - ***** Epoch: 11: Eval results *****
2023-04-03 14:05:15,202 - Detection -   best_eval_score = 88.8
2023-04-03 14:05:15,202 - Detection -   eval_score = 89.2
2023-04-03 14:05:15,202 - Detection -   train_loss = 0.2186633882423242
2023-04-03 14:05:18,406 - Detection - ***** Epoch: 12: Eval results *****
2023-04-03 14:05:18,406 - Detection -   best_eval_score = 89.2
2023-04-03 14:05:18,406 - Detection -   eval_score = 88.2
2023-04-03 14:05:18,406 - Detection -   train_loss = 0.20807500649243593
2023-04-03 14:05:21,601 - Detection - ***** Epoch: 13: Eval results *****
2023-04-03 14:05:21,601 - Detection -   best_eval_score = 89.2
2023-04-03 14:05:21,601 - Detection -   eval_score = 88.6
2023-04-03 14:05:21,601 - Detection -   train_loss = 0.19734388465682665
2023-04-03 14:05:24,798 - Detection - ***** Epoch: 14: Eval results *****
2023-04-03 14:05:24,798 - Detection -   best_eval_score = 89.2
2023-04-03 14:05:24,799 - Detection -   eval_score = 88.4
2023-04-03 14:05:24,799 - Detection -   train_loss = 0.1857821081454555
2023-04-03 14:05:27,999 - Detection - ***** Epoch: 15: Eval results *****
2023-04-03 14:05:27,999 - Detection -   best_eval_score = 89.2
2023-04-03 14:05:27,999 - Detection -   eval_score = 88.8
2023-04-03 14:05:27,999 - Detection -   train_loss = 0.16362219955772161
2023-04-03 14:05:31,201 - Detection - ***** Epoch: 16: Eval results *****
2023-04-03 14:05:31,201 - Detection -   best_eval_score = 89.2
2023-04-03 14:05:31,201 - Detection -   eval_score = 90.2
2023-04-03 14:05:31,201 - Detection -   train_loss = 0.1533335940912366
2023-04-03 14:05:34,516 - Detection - ***** Epoch: 17: Eval results *****
2023-04-03 14:05:34,516 - Detection -   best_eval_score = 90.2
2023-04-03 14:05:34,516 - Detection -   eval_score = 89.4
2023-04-03 14:05:34,516 - Detection -   train_loss = 0.1284089400433004
2023-04-03 14:05:37,724 - Detection - ***** Epoch: 18: Eval results *****
2023-04-03 14:05:37,724 - Detection -   best_eval_score = 90.2
2023-04-03 14:05:37,724 - Detection -   eval_score = 89.6
2023-04-03 14:05:37,724 - Detection -   train_loss = 0.12374633954217036
2023-04-03 14:05:40,936 - Detection - ***** Epoch: 19: Eval results *****
2023-04-03 14:05:40,936 - Detection -   best_eval_score = 90.2
2023-04-03 14:05:40,936 - Detection -   eval_score = 89.6
2023-04-03 14:05:40,936 - Detection -   train_loss = 0.11238213426743944
2023-04-03 14:05:44,153 - Detection - ***** Epoch: 20: Eval results *****
2023-04-03 14:05:44,153 - Detection -   best_eval_score = 90.2
2023-04-03 14:05:44,153 - Detection -   eval_score = 89.0
2023-04-03 14:05:44,153 - Detection -   train_loss = 0.10751562876005967
2023-04-03 14:05:47,373 - Detection - ***** Epoch: 21: Eval results *****
2023-04-03 14:05:47,373 - Detection -   best_eval_score = 90.2
2023-04-03 14:05:47,373 - Detection -   eval_score = 90.2
2023-04-03 14:05:47,373 - Detection -   train_loss = 0.09640219171221058
2023-04-03 14:05:50,588 - Detection - ***** Epoch: 22: Eval results *****
2023-04-03 14:05:50,588 - Detection -   best_eval_score = 90.2
2023-04-03 14:05:50,588 - Detection -   eval_score = 89.6
2023-04-03 14:05:50,588 - Detection -   train_loss = 0.09470520028844476
2023-04-03 14:05:53,805 - Detection - ***** Epoch: 23: Eval results *****
2023-04-03 14:05:53,805 - Detection -   best_eval_score = 90.2
2023-04-03 14:05:53,805 - Detection -   eval_score = 90.6
2023-04-03 14:05:53,805 - Detection -   train_loss = 0.08793135996287067
2023-04-03 14:05:57,031 - Detection - ***** Epoch: 24: Eval results *****
2023-04-03 14:05:57,031 - Detection -   best_eval_score = 90.6
2023-04-03 14:05:57,031 - Detection -   eval_score = 89.6
2023-04-03 14:05:57,031 - Detection -   train_loss = 0.08192167694990833
2023-04-03 14:06:00,242 - Detection - ***** Epoch: 25: Eval results *****
2023-04-03 14:06:00,242 - Detection -   best_eval_score = 90.6
2023-04-03 14:06:00,242 - Detection -   eval_score = 89.0
2023-04-03 14:06:00,242 - Detection -   train_loss = 0.07072141176710527
2023-04-03 14:06:03,457 - Detection - ***** Epoch: 26: Eval results *****
2023-04-03 14:06:03,457 - Detection -   best_eval_score = 90.6
2023-04-03 14:06:03,457 - Detection -   eval_score = 89.4
2023-04-03 14:06:03,457 - Detection -   train_loss = 0.06764427262047927
2023-04-03 14:06:06,667 - Detection - ***** Epoch: 27: Eval results *****
2023-04-03 14:06:06,667 - Detection -   best_eval_score = 90.6
2023-04-03 14:06:06,667 - Detection -   eval_score = 90.0
2023-04-03 14:06:06,667 - Detection -   train_loss = 0.06406986294314265
2023-04-03 14:06:09,874 - Detection - ***** Epoch: 28: Eval results *****
2023-04-03 14:06:09,874 - Detection -   best_eval_score = 90.6
2023-04-03 14:06:09,874 - Detection -   eval_score = 90.0
2023-04-03 14:06:09,874 - Detection -   train_loss = 0.059437310633560024
2023-04-03 14:06:13,084 - Detection - ***** Epoch: 29: Eval results *****
2023-04-03 14:06:13,084 - Detection -   best_eval_score = 90.6
2023-04-03 14:06:13,085 - Detection -   eval_score = 89.4
2023-04-03 14:06:13,085 - Detection -   train_loss = 0.05159043714714547
2023-04-03 14:06:16,291 - Detection - ***** Epoch: 30: Eval results *****
2023-04-03 14:06:16,291 - Detection -   best_eval_score = 90.6
2023-04-03 14:06:16,291 - Detection -   eval_score = 90.6
2023-04-03 14:06:16,291 - Detection -   train_loss = 0.05514860261852542
2023-04-03 14:06:19,495 - Detection - ***** Epoch: 31: Eval results *****
2023-04-03 14:06:19,495 - Detection -   best_eval_score = 90.6
2023-04-03 14:06:19,495 - Detection -   eval_score = 90.0
2023-04-03 14:06:19,495 - Detection -   train_loss = 0.04904430041400095
2023-04-03 14:06:22,697 - Detection - ***** Epoch: 32: Eval results *****
2023-04-03 14:06:22,697 - Detection -   best_eval_score = 90.6
2023-04-03 14:06:22,697 - Detection -   eval_score = 90.6
2023-04-03 14:06:22,697 - Detection -   train_loss = 0.04464294877834618
2023-04-03 14:06:25,903 - Detection - ***** Epoch: 33: Eval results *****
2023-04-03 14:06:25,903 - Detection -   best_eval_score = 90.6
2023-04-03 14:06:25,903 - Detection -   eval_score = 89.6
2023-04-03 14:06:25,903 - Detection -   train_loss = 0.045009687232474484
2023-04-03 14:06:25,904 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_0.25_1.0_bert_1/models
2023-04-03 14:06:26,448 - Detection - Pre-training finished...
2023-04-03 14:06:26,449 - Detection - Training Begin...
2023-04-03 14:06:32,043 - Detection - ***** Epoch: 1: Eval results *****
2023-04-03 14:06:32,043 - Detection -   best_eval_score = 0
2023-04-03 14:06:32,043 - Detection -   eval_score = 4.06
2023-04-03 14:06:32,043 - Detection -   train_loss = 6.835446000099182
2023-04-03 14:06:35,212 - Detection - ***** Epoch: 2: Eval results *****
2023-04-03 14:06:35,212 - Detection -   best_eval_score = 4.06
2023-04-03 14:06:35,212 - Detection -   eval_score = 26.75
2023-04-03 14:06:35,212 - Detection -   train_loss = 5.841651022434235
2023-04-03 14:06:38,379 - Detection - ***** Epoch: 3: Eval results *****
2023-04-03 14:06:38,379 - Detection -   best_eval_score = 26.75
2023-04-03 14:06:38,379 - Detection -   eval_score = 50.4
2023-04-03 14:06:38,379 - Detection -   train_loss = 4.746790210405986
2023-04-03 14:06:41,545 - Detection - ***** Epoch: 4: Eval results *****
2023-04-03 14:06:41,545 - Detection -   best_eval_score = 50.4
2023-04-03 14:06:41,546 - Detection -   eval_score = 57.73
2023-04-03 14:06:41,546 - Detection -   train_loss = 3.4216898878415427
2023-04-03 14:06:44,709 - Detection - ***** Epoch: 5: Eval results *****
2023-04-03 14:06:44,709 - Detection -   best_eval_score = 57.73
2023-04-03 14:06:44,709 - Detection -   eval_score = 68.67
2023-04-03 14:06:44,709 - Detection -   train_loss = 2.2726538429657617
2023-04-03 14:06:47,873 - Detection - ***** Epoch: 6: Eval results *****
2023-04-03 14:06:47,873 - Detection -   best_eval_score = 68.67
2023-04-03 14:06:47,874 - Detection -   eval_score = 71.14
2023-04-03 14:06:47,874 - Detection -   train_loss = 1.6137155493100483
2023-04-03 14:06:51,038 - Detection - ***** Epoch: 7: Eval results *****
2023-04-03 14:06:51,038 - Detection -   best_eval_score = 71.14
2023-04-03 14:06:51,038 - Detection -   eval_score = 71.87
2023-04-03 14:06:51,038 - Detection -   train_loss = 1.3869238644838333
2023-04-03 14:06:54,204 - Detection - ***** Epoch: 8: Eval results *****
2023-04-03 14:06:54,204 - Detection -   best_eval_score = 71.87
2023-04-03 14:06:54,204 - Detection -   eval_score = 71.99
2023-04-03 14:06:54,204 - Detection -   train_loss = 1.3529022336006165
2023-04-03 14:06:57,369 - Detection - ***** Epoch: 9: Eval results *****
2023-04-03 14:06:57,369 - Detection -   best_eval_score = 71.99
2023-04-03 14:06:57,369 - Detection -   eval_score = 71.77
2023-04-03 14:06:57,370 - Detection -   train_loss = 1.356003647049268
2023-04-03 14:07:00,535 - Detection - ***** Epoch: 10: Eval results *****
2023-04-03 14:07:00,535 - Detection -   best_eval_score = 71.99
2023-04-03 14:07:00,535 - Detection -   eval_score = 71.88
2023-04-03 14:07:00,535 - Detection -   train_loss = 1.3711000432570775
2023-04-03 14:07:03,702 - Detection - ***** Epoch: 11: Eval results *****
2023-04-03 14:07:03,702 - Detection -   best_eval_score = 71.99
2023-04-03 14:07:03,702 - Detection -   eval_score = 71.99
2023-04-03 14:07:03,702 - Detection -   train_loss = 1.3539482454458873
2023-04-03 14:07:06,866 - Detection - ***** Epoch: 12: Eval results *****
2023-04-03 14:07:06,867 - Detection -   best_eval_score = 71.99
2023-04-03 14:07:06,867 - Detection -   eval_score = 71.88
2023-04-03 14:07:06,867 - Detection -   train_loss = 1.371545414129893
2023-04-03 14:07:10,032 - Detection - ***** Epoch: 13: Eval results *****
2023-04-03 14:07:10,032 - Detection -   best_eval_score = 71.99
2023-04-03 14:07:10,032 - Detection -   eval_score = 71.99
2023-04-03 14:07:10,032 - Detection -   train_loss = 1.3435168862342834
2023-04-03 14:07:13,197 - Detection - ***** Epoch: 14: Eval results *****
2023-04-03 14:07:13,197 - Detection -   best_eval_score = 71.99
2023-04-03 14:07:13,197 - Detection -   eval_score = 71.88
2023-04-03 14:07:13,197 - Detection -   train_loss = 1.3632365465164185
2023-04-03 14:07:16,363 - Detection - ***** Epoch: 15: Eval results *****
2023-04-03 14:07:16,364 - Detection -   best_eval_score = 71.99
2023-04-03 14:07:16,364 - Detection -   eval_score = 71.77
2023-04-03 14:07:16,364 - Detection -   train_loss = 1.3534429669380188
2023-04-03 14:07:19,531 - Detection - ***** Epoch: 16: Eval results *****
2023-04-03 14:07:19,531 - Detection -   best_eval_score = 71.99
2023-04-03 14:07:19,531 - Detection -   eval_score = 71.88
2023-04-03 14:07:19,531 - Detection -   train_loss = 1.3781144469976425
2023-04-03 14:07:22,695 - Detection - ***** Epoch: 17: Eval results *****
2023-04-03 14:07:22,696 - Detection -   best_eval_score = 71.99
2023-04-03 14:07:22,696 - Detection -   eval_score = 71.99
2023-04-03 14:07:22,696 - Detection -   train_loss = 1.3930706828832626
2023-04-03 14:07:25,858 - Detection - ***** Epoch: 18: Eval results *****
2023-04-03 14:07:25,858 - Detection -   best_eval_score = 71.99
2023-04-03 14:07:25,858 - Detection -   eval_score = 71.77
2023-04-03 14:07:25,858 - Detection -   train_loss = 1.353762758274873
2023-04-03 14:07:25,859 - Detection - Training Finished...
2023-04-03 14:07:25,859 - Detection - Testing begin...
2023-04-03 14:07:30,831 - Detection - ***** Test: Confusion Matrix *****
2023-04-03 14:07:30,832 - Detection - [[ 226    0    0    0    1   73]
 [   1  250    0    0    0   49]
 [   0    0  239    0    1   60]
 [   0    0    1  256    0   43]
 [   4    0    1    1  227   67]
 [ 399   72   32    2  138 3857]]
2023-04-03 14:07:30,832 - Detection - ***** Test results *****
2023-04-03 14:07:30,832 - Detection -   Acc = 84.25
2023-04-03 14:07:30,832 - Detection -   F1 = 76.876
2023-04-03 14:07:30,832 - Detection -   F1-known = 74.4133
2023-04-03 14:07:30,832 - Detection -   F1-open = 89.1895
2023-04-03 14:07:30,832 - Detection - Testing finished...
2023-04-03 14:07:30,832 - Detection - Results saved in results/results_ADB.csv
2023-04-03 14:07:30,849 - Detection - Open Intent Detection Finished...
