2023-04-23 13:18:16,663 - Detection - Open Intent Detection Begin...
2023-04-23 13:18:16,664 - Detection - Parameters Initialization...
2023-04-23 13:18:16,664 - Detection - ============================== Params ==============================
2023-04-23 13:18:16,664 - Detection - type:	open_intent_detection
2023-04-23 13:18:16,664 - Detection - logger_name:	Detection
2023-04-23 13:18:16,664 - Detection - log_dir:	logs
2023-04-23 13:18:16,664 - Detection - dataset:	banking_cg
2023-04-23 13:18:16,664 - Detection - known_cls_ratio:	0.25
2023-04-23 13:18:16,664 - Detection - labeled_ratio:	1.0
2023-04-23 13:18:16,664 - Detection - method:	ADB
2023-04-23 13:18:16,664 - Detection - train:	True
2023-04-23 13:18:16,664 - Detection - pretrain:	True
2023-04-23 13:18:16,664 - Detection - save_model:	False
2023-04-23 13:18:16,664 - Detection - backbone:	bert_boost
2023-04-23 13:18:16,664 - Detection - config_file_name:	ADB
2023-04-23 13:18:16,664 - Detection - seed:	3
2023-04-23 13:18:16,664 - Detection - gpu_id:	0
2023-04-23 13:18:16,664 - Detection - pipe_results_path:	pipe_results
2023-04-23 13:18:16,664 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-23 13:18:16,664 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-23 13:18:16,664 - Detection - model_dir:	models
2023-04-23 13:18:16,664 - Detection - load_pretrained_method:	None
2023-04-23 13:18:16,664 - Detection - result_dir:	results
2023-04-23 13:18:16,664 - Detection - results_file_name:	results_ADB-BOOST-F-10.csv
2023-04-23 13:18:16,664 - Detection - save_results:	True
2023-04-23 13:18:16,664 - Detection - loss_fct:	CrossEntropyLoss
2023-04-23 13:18:16,664 - Detection - boost_method:	F-10
2023-04-23 13:18:16,664 - Detection - boost_start_score:	0.0
2023-04-23 13:18:16,664 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.25_1.0_bert_boost_3
2023-04-23 13:18:16,664 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.25_1.0_bert_boost_3/models
2023-04-23 13:18:16,664 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-23 13:18:16,664 - Detection - num_train_epochs:	100
2023-04-23 13:18:16,664 - Detection - num_labels:	None
2023-04-23 13:18:16,664 - Detection - max_seq_length:	None
2023-04-23 13:18:16,664 - Detection - freeze_backbone_parameters:	True
2023-04-23 13:18:16,664 - Detection - feat_dim:	768
2023-04-23 13:18:16,664 - Detection - warmup_proportion:	0.1
2023-04-23 13:18:16,664 - Detection - lr_boundary:	0.05
2023-04-23 13:18:16,664 - Detection - lr:	2e-05
2023-04-23 13:18:16,664 - Detection - activation:	relu
2023-04-23 13:18:16,664 - Detection - train_batch_size:	128
2023-04-23 13:18:16,665 - Detection - eval_batch_size:	64
2023-04-23 13:18:16,665 - Detection - test_batch_size:	64
2023-04-23 13:18:16,665 - Detection - wait_patient:	10
2023-04-23 13:18:16,665 - Detection - ============================== End Params ==============================
2023-04-23 13:18:16,665 - Detection - Data and Model Preparation...
2023-04-23 13:18:16,665 - Detection - The number of known intents is 19
2023-04-23 13:18:16,665 - Detection - Lists of known labels are: ['edit_personal_details', 'exchange_charge', 'compromised_card', 'top_up_limits', 'beneficiary_not_allowed', 'balance_not_updated_after_bank_transfer', 'request_refund', 'cancel_transfer', 'card_arrival', 'declined_cash_withdrawal', 'verify_source_of_funds', 'supported_cards_and_currencies', 'card_delivery_estimate', 'country_support', 'passcode_forgotten', 'verify_my_identity', 'card_payment_fee_charged', 'wrong_amount_of_cash_received', 'atm_support']
2023-04-23 13:18:16,674 - Detection - Number of labeled training samples = 745
2023-04-23 13:18:16,674 - Detection - Number of unlabeled training samples = 2027
2023-04-23 13:18:16,676 - Detection - Number of evaluation samples = 213
2023-04-23 13:18:16,680 - Detection - Number of testing samples = 1896
2023-04-23 13:18:25,556 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-23 13:18:27,190 - Detection - Pre-training Begin...
2023-04-23 13:18:28,806 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 13:18:28,806 - Detection -   best_eval_score = 0
2023-04-23 13:18:28,806 - Detection -   eval_score = 7.04
2023-04-23 13:18:28,806 - Detection -   train_loss = 2.941261092821757
2023-04-23 13:18:43,019 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 13:18:43,019 - Detection -   best_eval_score = 7.04
2023-04-23 13:18:43,019 - Detection -   eval_score = 9.39
2023-04-23 13:18:43,020 - Detection -   train_loss = 2.9271066188812256
2023-04-23 13:18:57,707 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 13:18:57,707 - Detection -   best_eval_score = 9.39
2023-04-23 13:18:57,707 - Detection -   eval_score = 40.38
2023-04-23 13:18:57,707 - Detection -   train_loss = 2.622740864753723
2023-04-23 13:19:12,188 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 13:19:12,188 - Detection -   best_eval_score = 40.38
2023-04-23 13:19:12,188 - Detection -   eval_score = 70.89
2023-04-23 13:19:12,188 - Detection -   train_loss = 1.8085348804791768
2023-04-23 13:19:26,668 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 13:19:26,668 - Detection -   best_eval_score = 70.89
2023-04-23 13:19:26,668 - Detection -   eval_score = 87.32
2023-04-23 13:19:26,668 - Detection -   train_loss = 0.9310784538586935
2023-04-23 13:19:41,567 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 13:19:41,567 - Detection -   best_eval_score = 87.32
2023-04-23 13:19:41,567 - Detection -   eval_score = 91.08
2023-04-23 13:19:41,567 - Detection -   train_loss = 0.480817511677742
2023-04-23 13:19:56,203 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 13:19:56,203 - Detection -   best_eval_score = 91.08
2023-04-23 13:19:56,203 - Detection -   eval_score = 92.49
2023-04-23 13:19:56,203 - Detection -   train_loss = 0.2793177018562953
2023-04-23 13:20:10,166 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 13:20:10,166 - Detection -   best_eval_score = 92.49
2023-04-23 13:20:10,166 - Detection -   eval_score = 92.02
2023-04-23 13:20:10,166 - Detection -   train_loss = 0.20147533963123956
2023-04-23 13:20:24,695 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 13:20:24,695 - Detection -   best_eval_score = 92.49
2023-04-23 13:20:24,695 - Detection -   eval_score = 93.9
2023-04-23 13:20:24,695 - Detection -   train_loss = 0.12752744555473328
2023-04-23 13:20:39,162 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 13:20:39,162 - Detection -   best_eval_score = 93.9
2023-04-23 13:20:39,162 - Detection -   eval_score = 93.9
2023-04-23 13:20:39,162 - Detection -   train_loss = 0.09301513309280078
2023-04-23 13:20:53,772 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 13:20:53,772 - Detection -   best_eval_score = 93.9
2023-04-23 13:20:53,772 - Detection -   eval_score = 93.9
2023-04-23 13:20:53,772 - Detection -   train_loss = 0.07311239714423816
2023-04-23 13:21:08,502 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 13:21:08,502 - Detection -   best_eval_score = 93.9
2023-04-23 13:21:08,502 - Detection -   eval_score = 94.37
2023-04-23 13:21:08,502 - Detection -   train_loss = 0.0465612600867947
2023-04-23 13:21:23,106 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 13:21:23,106 - Detection -   best_eval_score = 94.37
2023-04-23 13:21:23,106 - Detection -   eval_score = 94.37
2023-04-23 13:21:23,106 - Detection -   train_loss = 0.04346059045443932
2023-04-23 13:21:36,641 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 13:21:36,641 - Detection -   best_eval_score = 94.37
2023-04-23 13:21:36,641 - Detection -   eval_score = 94.84
2023-04-23 13:21:36,641 - Detection -   train_loss = 0.038652087561786175
2023-04-23 13:21:51,503 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 13:21:51,503 - Detection -   best_eval_score = 94.84
2023-04-23 13:21:51,503 - Detection -   eval_score = 94.37
2023-04-23 13:21:51,503 - Detection -   train_loss = 0.0262827156111598
2023-04-23 13:22:05,426 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 13:22:05,426 - Detection -   best_eval_score = 94.84
2023-04-23 13:22:05,426 - Detection -   eval_score = 94.84
2023-04-23 13:22:05,426 - Detection -   train_loss = 0.021644585765898228
2023-04-23 13:22:18,935 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 13:22:18,935 - Detection -   best_eval_score = 94.84
2023-04-23 13:22:18,936 - Detection -   eval_score = 94.84
2023-04-23 13:22:18,936 - Detection -   train_loss = 0.021277928724884987
2023-04-23 13:22:33,649 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 13:22:33,649 - Detection -   best_eval_score = 94.84
2023-04-23 13:22:33,649 - Detection -   eval_score = 94.84
2023-04-23 13:22:33,649 - Detection -   train_loss = 0.015413109368334213
2023-04-23 13:22:48,237 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 13:22:48,237 - Detection -   best_eval_score = 94.84
2023-04-23 13:22:48,237 - Detection -   eval_score = 94.84
2023-04-23 13:22:48,237 - Detection -   train_loss = 0.018481042080869276
2023-04-23 13:23:02,783 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 13:23:02,783 - Detection -   best_eval_score = 94.84
2023-04-23 13:23:02,783 - Detection -   eval_score = 94.37
2023-04-23 13:23:02,783 - Detection -   train_loss = 0.015087617406000694
2023-04-23 13:23:16,751 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 13:23:16,751 - Detection -   best_eval_score = 94.84
2023-04-23 13:23:16,751 - Detection -   eval_score = 94.84
2023-04-23 13:23:16,751 - Detection -   train_loss = 0.017954718011120956
2023-04-23 13:23:31,050 - Detection - ***** Epoch: 22: Eval results *****
2023-04-23 13:23:31,050 - Detection -   best_eval_score = 94.84
2023-04-23 13:23:31,050 - Detection -   eval_score = 94.84
2023-04-23 13:23:31,050 - Detection -   train_loss = 0.011764990476270517
2023-04-23 13:23:44,819 - Detection - ***** Epoch: 23: Eval results *****
2023-04-23 13:23:44,819 - Detection -   best_eval_score = 94.84
2023-04-23 13:23:44,819 - Detection -   eval_score = 94.84
2023-04-23 13:23:44,819 - Detection -   train_loss = 0.011993069046487411
2023-04-23 13:23:58,644 - Detection - ***** Epoch: 24: Eval results *****
2023-04-23 13:23:58,644 - Detection -   best_eval_score = 94.84
2023-04-23 13:23:58,644 - Detection -   eval_score = 94.37
2023-04-23 13:23:58,645 - Detection -   train_loss = 0.009287405914316574
2023-04-23 13:23:58,645 - Detection - Pre-training finished...
2023-04-23 13:23:58,645 - Detection - Training Begin...
2023-04-23 13:24:00,465 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 13:24:00,465 - Detection -   best_eval_score = 0
2023-04-23 13:24:00,465 - Detection -   eval_score = 0.0
2023-04-23 13:24:00,465 - Detection -   train_loss = 9.780093351999918
2023-04-23 13:24:01,535 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 13:24:01,535 - Detection -   best_eval_score = 0
2023-04-23 13:24:01,535 - Detection -   eval_score = 0.0
2023-04-23 13:24:01,536 - Detection -   train_loss = 9.65066130956014
2023-04-23 13:24:02,607 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 13:24:02,607 - Detection -   best_eval_score = 0
2023-04-23 13:24:02,607 - Detection -   eval_score = 0.0
2023-04-23 13:24:02,607 - Detection -   train_loss = 9.449373245239258
2023-04-23 13:24:03,678 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 13:24:03,678 - Detection -   best_eval_score = 0
2023-04-23 13:24:03,678 - Detection -   eval_score = 0.0
2023-04-23 13:24:03,678 - Detection -   train_loss = 9.257340908050537
2023-04-23 13:24:04,749 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 13:24:04,750 - Detection -   best_eval_score = 0
2023-04-23 13:24:04,750 - Detection -   eval_score = 0.0
2023-04-23 13:24:04,750 - Detection -   train_loss = 9.075264771779379
2023-04-23 13:24:05,822 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 13:24:05,822 - Detection -   best_eval_score = 0
2023-04-23 13:24:05,822 - Detection -   eval_score = 0.0
2023-04-23 13:24:05,822 - Detection -   train_loss = 8.80060609181722
2023-04-23 13:24:06,894 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 13:24:06,894 - Detection -   best_eval_score = 0
2023-04-23 13:24:06,894 - Detection -   eval_score = 1.0
2023-04-23 13:24:06,894 - Detection -   train_loss = 8.558137893676758
2023-04-23 13:24:20,787 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 13:24:20,787 - Detection -   best_eval_score = 1.0
2023-04-23 13:24:20,787 - Detection -   eval_score = 20.27
2023-04-23 13:24:20,787 - Detection -   train_loss = 8.24447480837504
2023-04-23 13:24:34,356 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 13:24:34,356 - Detection -   best_eval_score = 20.27
2023-04-23 13:24:34,356 - Detection -   eval_score = 65.77
2023-04-23 13:24:34,356 - Detection -   train_loss = 4.7327094078063965
2023-04-23 13:24:48,214 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 13:24:48,214 - Detection -   best_eval_score = 65.77
2023-04-23 13:24:48,214 - Detection -   eval_score = 74.41
2023-04-23 13:24:48,214 - Detection -   train_loss = 1.7115429838498433
2023-04-23 13:25:02,019 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 13:25:02,020 - Detection -   best_eval_score = 74.41
2023-04-23 13:25:02,020 - Detection -   eval_score = 74.62
2023-04-23 13:25:02,020 - Detection -   train_loss = 1.1087258458137512
2023-04-23 13:25:15,825 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 13:25:15,825 - Detection -   best_eval_score = 74.62
2023-04-23 13:25:15,825 - Detection -   eval_score = 74.96
2023-04-23 13:25:15,825 - Detection -   train_loss = 1.1674559116363525
2023-04-23 13:25:30,296 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 13:25:30,296 - Detection -   best_eval_score = 74.96
2023-04-23 13:25:30,296 - Detection -   eval_score = 74.46
2023-04-23 13:25:30,296 - Detection -   train_loss = 1.0989481210708618
2023-04-23 13:25:44,280 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 13:25:44,280 - Detection -   best_eval_score = 74.96
2023-04-23 13:25:44,280 - Detection -   eval_score = 74.84
2023-04-23 13:25:44,280 - Detection -   train_loss = 1.1490970849990845
2023-04-23 13:25:58,082 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 13:25:58,082 - Detection -   best_eval_score = 74.96
2023-04-23 13:25:58,082 - Detection -   eval_score = 74.62
2023-04-23 13:25:58,082 - Detection -   train_loss = 1.1681902805964153
2023-04-23 13:26:11,526 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 13:26:11,527 - Detection -   best_eval_score = 74.96
2023-04-23 13:26:11,527 - Detection -   eval_score = 74.68
2023-04-23 13:26:11,527 - Detection -   train_loss = 1.1611757278442383
2023-04-23 13:26:24,834 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 13:26:24,834 - Detection -   best_eval_score = 74.96
2023-04-23 13:26:24,834 - Detection -   eval_score = 74.84
2023-04-23 13:26:24,834 - Detection -   train_loss = 1.1839170058568318
2023-04-23 13:26:38,242 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 13:26:38,242 - Detection -   best_eval_score = 74.96
2023-04-23 13:26:38,242 - Detection -   eval_score = 74.84
2023-04-23 13:26:38,242 - Detection -   train_loss = 1.1438588400681813
2023-04-23 13:26:51,542 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 13:26:51,542 - Detection -   best_eval_score = 74.96
2023-04-23 13:26:51,542 - Detection -   eval_score = 74.46
2023-04-23 13:26:51,542 - Detection -   train_loss = 1.1710386077562969
2023-04-23 13:27:05,124 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 13:27:05,125 - Detection -   best_eval_score = 74.96
2023-04-23 13:27:05,125 - Detection -   eval_score = 74.62
2023-04-23 13:27:05,125 - Detection -   train_loss = 1.1599049766858418
2023-04-23 13:27:18,462 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 13:27:18,462 - Detection -   best_eval_score = 74.96
2023-04-23 13:27:18,462 - Detection -   eval_score = 74.96
2023-04-23 13:27:18,462 - Detection -   train_loss = 1.150277316570282
2023-04-23 13:27:31,807 - Detection - ***** Epoch: 22: Eval results *****
2023-04-23 13:27:31,807 - Detection -   best_eval_score = 74.96
2023-04-23 13:27:31,807 - Detection -   eval_score = 74.02
2023-04-23 13:27:31,807 - Detection -   train_loss = 1.1741318901379902
2023-04-23 13:27:31,807 - Detection - Training Finished...
2023-04-23 13:27:31,808 - Detection - Testing begin...
2023-04-23 13:27:33,711 - Detection - ***** Test: Confusion Matrix *****
2023-04-23 13:27:33,712 - Detection - [[  22    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    5]
 [   0   21    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    3]
 [   0    0    7    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0   11]
 [   0    0    0   14    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    5]
 [   0    0    0    0   24    0    0    0    0    0    0    0    0    0
     0    0    0    0    0   13]
 [   0    0    0    0    1   11    0    0    0    0    0    0    0    0
     0    0    0    0    0   13]
 [   0    0    0    0    0    0   30    0    0    0    0    0    0    0
     0    0    0    0    0    6]
 [   0    0    0    0    0    0    0   18    0    0    0    0    0    0
     0    0    0    0    0   11]
 [   0    0    0    0    0    0    0    0   10    0    0    0    1    0
     0    0    0    0    0   13]
 [   0    0    0    0    0    0    0    0    0   31    0    0    0    0
     0    0    0    0    0    4]
 [   0    0    0    0    0    0    0    0    0    0   26    0    0    0
     0    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0    2    0    0
     0    0    0    0    0   22]
 [   0    0    0    0    0    0    0    0    2    0    0    0    4    0
     0    0    0    0    0   17]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0   16
     0    0    0    0    0    2]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     7    0    0    0    0    9]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0   17    0    0    0    4]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0   13    0    0    4]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0   25    0    4]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0   16    4]
 [   0   24   13    4   30   36   16    0    8   38    0    7    0    6
    12   13   69   13    0 1139]]
2023-04-23 13:27:33,712 - Detection - ***** Test results *****
2023-04-23 13:27:33,712 - Detection -   Acc = 76.64
2023-04-23 13:27:33,712 - Detection -   F1 = 60.0865
2023-04-23 13:27:33,712 - Detection -   F1-known = 58.8361
2023-04-23 13:27:33,712 - Detection -   F1-open = 83.8425
2023-04-23 13:27:33,712 - Detection - Testing finished...
2023-04-23 13:27:33,712 - Detection - Results saved in results/results_ADB-BOOST-F-10.csv
2023-04-23 13:27:33,728 - Detection - Open Intent Detection Finished...
