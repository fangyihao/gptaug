2023-04-24 10:19:23,694 - Detection - Open Intent Detection Begin...
2023-04-24 10:19:23,694 - Detection - Parameters Initialization...
2023-04-24 10:19:23,694 - Detection - ============================== Params ==============================
2023-04-24 10:19:23,694 - Detection - type:	open_intent_detection
2023-04-24 10:19:23,694 - Detection - logger_name:	Detection
2023-04-24 10:19:23,694 - Detection - log_dir:	logs
2023-04-24 10:19:23,694 - Detection - dataset:	stackoverflow_cg
2023-04-24 10:19:23,694 - Detection - known_cls_ratio:	0.5
2023-04-24 10:19:23,694 - Detection - labeled_ratio:	1.0
2023-04-24 10:19:23,694 - Detection - method:	ADB
2023-04-24 10:19:23,694 - Detection - train:	True
2023-04-24 10:19:23,694 - Detection - pretrain:	True
2023-04-24 10:19:23,694 - Detection - save_model:	False
2023-04-24 10:19:23,694 - Detection - backbone:	bert_boost
2023-04-24 10:19:23,694 - Detection - config_file_name:	ADB
2023-04-24 10:19:23,694 - Detection - seed:	1
2023-04-24 10:19:23,694 - Detection - gpu_id:	0
2023-04-24 10:19:23,694 - Detection - pipe_results_path:	pipe_results
2023-04-24 10:19:23,694 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-24 10:19:23,694 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-24 10:19:23,694 - Detection - model_dir:	models
2023-04-24 10:19:23,694 - Detection - load_pretrained_method:	None
2023-04-24 10:19:23,694 - Detection - result_dir:	results
2023-04-24 10:19:23,694 - Detection - results_file_name:	results_ADB-BOOST-F-10.csv
2023-04-24 10:19:23,694 - Detection - save_results:	True
2023-04-24 10:19:23,694 - Detection - loss_fct:	CrossEntropyLoss
2023-04-24 10:19:23,695 - Detection - boost_method:	F-10
2023-04-24 10:19:23,695 - Detection - boost_start_score:	0.0
2023-04-24 10:19:23,695 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.5_1.0_bert_boost_1
2023-04-24 10:19:23,695 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.5_1.0_bert_boost_1/models
2023-04-24 10:19:23,695 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-24 10:19:23,695 - Detection - num_train_epochs:	100
2023-04-24 10:19:23,695 - Detection - num_labels:	None
2023-04-24 10:19:23,695 - Detection - max_seq_length:	None
2023-04-24 10:19:23,695 - Detection - freeze_backbone_parameters:	True
2023-04-24 10:19:23,695 - Detection - feat_dim:	768
2023-04-24 10:19:23,695 - Detection - warmup_proportion:	0.1
2023-04-24 10:19:23,695 - Detection - lr_boundary:	0.05
2023-04-24 10:19:23,695 - Detection - lr:	2e-05
2023-04-24 10:19:23,695 - Detection - activation:	relu
2023-04-24 10:19:23,695 - Detection - train_batch_size:	128
2023-04-24 10:19:23,695 - Detection - eval_batch_size:	64
2023-04-24 10:19:23,695 - Detection - test_batch_size:	64
2023-04-24 10:19:23,695 - Detection - wait_patient:	10
2023-04-24 10:19:23,695 - Detection - ============================== End Params ==============================
2023-04-24 10:19:23,695 - Detection - Data and Model Preparation...
2023-04-24 10:19:23,695 - Detection - The number of known intents is 10
2023-04-24 10:19:23,695 - Detection - Lists of known labels are: ['cocoa', 'spring', 'haskell', 'matlab', 'bash', 'scala', 'drupal', 'svn', 'hibernate', 'apache']
2023-04-24 10:19:23,703 - Detection - Number of labeled training samples = 1405
2023-04-24 10:19:23,703 - Detection - Number of unlabeled training samples = 1386
2023-04-24 10:19:23,706 - Detection - Number of evaluation samples = 722
2023-04-24 10:19:23,712 - Detection - Number of testing samples = 2905
2023-04-24 10:19:27,817 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-24 10:19:29,487 - Detection - Pre-training Begin...
2023-04-24 10:19:31,863 - Detection - ***** Epoch: 1: Eval results *****
2023-04-24 10:19:31,863 - Detection -   best_eval_score = 0
2023-04-24 10:19:31,863 - Detection -   eval_score = 8.59
2023-04-24 10:19:31,863 - Detection -   train_loss = 2.2990955222736704
2023-04-24 10:19:52,684 - Detection - ***** Epoch: 2: Eval results *****
2023-04-24 10:19:52,685 - Detection -   best_eval_score = 8.59
2023-04-24 10:19:52,685 - Detection -   eval_score = 35.18
2023-04-24 10:19:52,685 - Detection -   train_loss = 2.2861465324055064
2023-04-24 10:20:13,457 - Detection - ***** Epoch: 3: Eval results *****
2023-04-24 10:20:13,457 - Detection -   best_eval_score = 35.18
2023-04-24 10:20:13,457 - Detection -   eval_score = 70.22
2023-04-24 10:20:13,457 - Detection -   train_loss = 1.9509453990242698
2023-04-24 10:20:34,336 - Detection - ***** Epoch: 4: Eval results *****
2023-04-24 10:20:34,336 - Detection -   best_eval_score = 70.22
2023-04-24 10:20:34,336 - Detection -   eval_score = 81.3
2023-04-24 10:20:34,336 - Detection -   train_loss = 1.1013578122312373
2023-04-24 10:20:55,211 - Detection - ***** Epoch: 5: Eval results *****
2023-04-24 10:20:55,211 - Detection -   best_eval_score = 81.3
2023-04-24 10:20:55,211 - Detection -   eval_score = 83.93
2023-04-24 10:20:55,211 - Detection -   train_loss = 0.7020110162821683
2023-04-24 10:21:16,137 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 10:21:16,137 - Detection -   best_eval_score = 83.93
2023-04-24 10:21:16,137 - Detection -   eval_score = 84.21
2023-04-24 10:21:16,137 - Detection -   train_loss = 0.5149628763849085
2023-04-24 10:21:37,047 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 10:21:37,047 - Detection -   best_eval_score = 84.21
2023-04-24 10:21:37,047 - Detection -   eval_score = 84.21
2023-04-24 10:21:37,047 - Detection -   train_loss = 0.39302333105694165
2023-04-24 10:21:57,964 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 10:21:57,965 - Detection -   best_eval_score = 84.21
2023-04-24 10:21:57,965 - Detection -   eval_score = 83.52
2023-04-24 10:21:57,965 - Detection -   train_loss = 0.29502150145444
2023-04-24 10:22:18,873 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 10:22:18,873 - Detection -   best_eval_score = 84.21
2023-04-24 10:22:18,873 - Detection -   eval_score = 84.63
2023-04-24 10:22:18,873 - Detection -   train_loss = 0.22587164017287167
2023-04-24 10:22:39,751 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 10:22:39,751 - Detection -   best_eval_score = 84.63
2023-04-24 10:22:39,751 - Detection -   eval_score = 84.35
2023-04-24 10:22:39,751 - Detection -   train_loss = 0.17200021852146496
2023-04-24 10:23:00,471 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 10:23:00,471 - Detection -   best_eval_score = 84.63
2023-04-24 10:23:00,471 - Detection -   eval_score = 84.9
2023-04-24 10:23:00,471 - Detection -   train_loss = 0.14375902170484717
2023-04-24 10:23:21,274 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 10:23:21,274 - Detection -   best_eval_score = 84.9
2023-04-24 10:23:21,274 - Detection -   eval_score = 84.21
2023-04-24 10:23:21,275 - Detection -   train_loss = 0.12181924283504486
2023-04-24 10:23:42,139 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 10:23:42,139 - Detection -   best_eval_score = 84.9
2023-04-24 10:23:42,139 - Detection -   eval_score = 84.35
2023-04-24 10:23:42,139 - Detection -   train_loss = 0.11025602235035463
2023-04-24 10:24:02,975 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 10:24:02,975 - Detection -   best_eval_score = 84.9
2023-04-24 10:24:02,975 - Detection -   eval_score = 84.49
2023-04-24 10:24:02,975 - Detection -   train_loss = 0.09657624533230608
2023-04-24 10:24:23,891 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 10:24:23,891 - Detection -   best_eval_score = 84.9
2023-04-24 10:24:23,891 - Detection -   eval_score = 83.93
2023-04-24 10:24:23,891 - Detection -   train_loss = 0.06642250886017625
2023-04-24 10:24:44,797 - Detection - ***** Epoch: 16: Eval results *****
2023-04-24 10:24:44,797 - Detection -   best_eval_score = 84.9
2023-04-24 10:24:44,797 - Detection -   eval_score = 83.52
2023-04-24 10:24:44,797 - Detection -   train_loss = 0.05672900294038383
2023-04-24 10:25:05,982 - Detection - ***** Epoch: 17: Eval results *****
2023-04-24 10:25:05,982 - Detection -   best_eval_score = 84.9
2023-04-24 10:25:05,982 - Detection -   eval_score = 84.76
2023-04-24 10:25:05,982 - Detection -   train_loss = 0.04526201991195029
2023-04-24 10:25:26,916 - Detection - ***** Epoch: 18: Eval results *****
2023-04-24 10:25:26,917 - Detection -   best_eval_score = 84.9
2023-04-24 10:25:26,917 - Detection -   eval_score = 84.35
2023-04-24 10:25:26,917 - Detection -   train_loss = 0.041276119141416115
2023-04-24 10:25:47,615 - Detection - ***** Epoch: 19: Eval results *****
2023-04-24 10:25:47,615 - Detection -   best_eval_score = 84.9
2023-04-24 10:25:47,615 - Detection -   eval_score = 84.35
2023-04-24 10:25:47,615 - Detection -   train_loss = 0.03718478520485488
2023-04-24 10:26:08,489 - Detection - ***** Epoch: 20: Eval results *****
2023-04-24 10:26:08,489 - Detection -   best_eval_score = 84.9
2023-04-24 10:26:08,489 - Detection -   eval_score = 84.21
2023-04-24 10:26:08,489 - Detection -   train_loss = 0.025451982478526505
2023-04-24 10:26:29,516 - Detection - ***** Epoch: 21: Eval results *****
2023-04-24 10:26:29,516 - Detection -   best_eval_score = 84.9
2023-04-24 10:26:29,516 - Detection -   eval_score = 84.9
2023-04-24 10:26:29,516 - Detection -   train_loss = 0.035423259674148125
2023-04-24 10:26:29,516 - Detection - Pre-training finished...
2023-04-24 10:26:29,517 - Detection - Training Begin...
2023-04-24 10:26:32,537 - Detection - ***** Epoch: 1: Eval results *****
2023-04-24 10:26:32,537 - Detection -   best_eval_score = 0
2023-04-24 10:26:32,537 - Detection -   eval_score = 0.0
2023-04-24 10:26:32,537 - Detection -   train_loss = 10.218317378651012
2023-04-24 10:26:34,422 - Detection - ***** Epoch: 2: Eval results *****
2023-04-24 10:26:34,422 - Detection -   best_eval_score = 0
2023-04-24 10:26:34,422 - Detection -   eval_score = 0.0
2023-04-24 10:26:34,422 - Detection -   train_loss = 9.921082583340732
2023-04-24 10:26:36,309 - Detection - ***** Epoch: 3: Eval results *****
2023-04-24 10:26:36,309 - Detection -   best_eval_score = 0
2023-04-24 10:26:36,309 - Detection -   eval_score = 0.24
2023-04-24 10:26:36,309 - Detection -   train_loss = 9.522179343483664
2023-04-24 10:26:56,889 - Detection - ***** Epoch: 4: Eval results *****
2023-04-24 10:26:56,889 - Detection -   best_eval_score = 0.24
2023-04-24 10:26:56,889 - Detection -   eval_score = 59.35
2023-04-24 10:26:56,889 - Detection -   train_loss = 9.028112324801358
2023-04-24 10:27:17,680 - Detection - ***** Epoch: 5: Eval results *****
2023-04-24 10:27:17,680 - Detection -   best_eval_score = 59.35
2023-04-24 10:27:17,680 - Detection -   eval_score = 73.22
2023-04-24 10:27:17,680 - Detection -   train_loss = 2.657645810734142
2023-04-24 10:27:38,455 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 10:27:38,455 - Detection -   best_eval_score = 73.22
2023-04-24 10:27:38,455 - Detection -   eval_score = 73.23
2023-04-24 10:27:38,455 - Detection -   train_loss = 1.5448167432438245
2023-04-24 10:27:59,164 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 10:27:59,164 - Detection -   best_eval_score = 73.23
2023-04-24 10:27:59,164 - Detection -   eval_score = 73.33
2023-04-24 10:27:59,164 - Detection -   train_loss = 1.5350537625226108
2023-04-24 10:28:19,958 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 10:28:19,958 - Detection -   best_eval_score = 73.33
2023-04-24 10:28:19,958 - Detection -   eval_score = 73.46
2023-04-24 10:28:19,958 - Detection -   train_loss = 1.5077394572171299
2023-04-24 10:28:40,694 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 10:28:40,694 - Detection -   best_eval_score = 73.46
2023-04-24 10:28:40,694 - Detection -   eval_score = 73.26
2023-04-24 10:28:40,694 - Detection -   train_loss = 1.5307610685175115
2023-04-24 10:29:01,446 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 10:29:01,446 - Detection -   best_eval_score = 73.46
2023-04-24 10:29:01,446 - Detection -   eval_score = 73.18
2023-04-24 10:29:01,446 - Detection -   train_loss = 1.503214792771773
2023-04-24 10:29:22,111 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 10:29:22,111 - Detection -   best_eval_score = 73.46
2023-04-24 10:29:22,111 - Detection -   eval_score = 73.02
2023-04-24 10:29:22,111 - Detection -   train_loss = 1.5199767784638838
2023-04-24 10:29:43,051 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 10:29:43,051 - Detection -   best_eval_score = 73.46
2023-04-24 10:29:43,051 - Detection -   eval_score = 73.23
2023-04-24 10:29:43,051 - Detection -   train_loss = 1.5230881842699917
2023-04-24 10:30:03,663 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 10:30:03,663 - Detection -   best_eval_score = 73.46
2023-04-24 10:30:03,663 - Detection -   eval_score = 73.34
2023-04-24 10:30:03,663 - Detection -   train_loss = 1.5557277310978284
2023-04-24 10:30:24,246 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 10:30:24,246 - Detection -   best_eval_score = 73.46
2023-04-24 10:30:24,246 - Detection -   eval_score = 72.85
2023-04-24 10:30:24,246 - Detection -   train_loss = 1.5167415033687244
2023-04-24 10:30:44,806 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 10:30:44,806 - Detection -   best_eval_score = 73.46
2023-04-24 10:30:44,806 - Detection -   eval_score = 72.92
2023-04-24 10:30:44,806 - Detection -   train_loss = 1.5606586933135986
2023-04-24 10:31:05,510 - Detection - ***** Epoch: 16: Eval results *****
2023-04-24 10:31:05,510 - Detection -   best_eval_score = 73.46
2023-04-24 10:31:05,511 - Detection -   eval_score = 73.2
2023-04-24 10:31:05,511 - Detection -   train_loss = 1.51208665154197
2023-04-24 10:31:26,058 - Detection - ***** Epoch: 17: Eval results *****
2023-04-24 10:31:26,058 - Detection -   best_eval_score = 73.46
2023-04-24 10:31:26,058 - Detection -   eval_score = 73.1
2023-04-24 10:31:26,058 - Detection -   train_loss = 1.5142027031291614
2023-04-24 10:31:46,697 - Detection - ***** Epoch: 18: Eval results *****
2023-04-24 10:31:46,697 - Detection -   best_eval_score = 73.46
2023-04-24 10:31:46,697 - Detection -   eval_score = 73.0
2023-04-24 10:31:46,697 - Detection -   train_loss = 1.554067524996671
2023-04-24 10:31:46,697 - Detection - Training Finished...
2023-04-24 10:31:46,697 - Detection - Testing begin...
2023-04-24 10:31:49,095 - Detection - ***** Test: Confusion Matrix *****
2023-04-24 10:31:49,096 - Detection - [[  65    1    2    0    0    0    0    1    0    1   91]
 [   0  108    0    0    1    0    0    0    4    0   38]
 [   0    0   90    1    1    1    0    0    0    0   29]
 [   1    0    1  134    0    0    0    0    0    0   28]
 [   7    0    5    0   83    1    0    0    0    0   43]
 [   0    0    3    0    0   76    0    0    0    0   45]
 [   0    0    0    0    0    0  100    0    0    0   28]
 [   0    0    1    0    0    0    1  107    0    2   38]
 [   0    3    0    0    0    0    0    0   84    0   41]
 [   2    0    1    0    1    0    0    2    1   97   66]
 [  83    8   31    3   14    6   22    5    3   52 1242]]
2023-04-24 10:31:49,096 - Detection - ***** Test results *****
2023-04-24 10:31:49,096 - Detection -   Acc = 75.25
2023-04-24 10:31:49,096 - Detection -   F1 = 72.5505
2023-04-24 10:31:49,096 - Detection -   F1-known = 71.9398
2023-04-24 10:31:49,096 - Detection -   F1-open = 78.6574
2023-04-24 10:31:49,096 - Detection - Testing finished...
2023-04-24 10:31:49,096 - Detection - Results saved in results/results_ADB-BOOST-F-10.csv
2023-04-24 10:31:49,114 - Detection - Open Intent Detection Finished...
