2023-04-05 04:40:21,567 - Detection - Open Intent Detection Begin...
2023-04-05 04:40:21,567 - Detection - Parameters Initialization...
2023-04-05 04:40:21,568 - Detection - ============================== Params ==============================
2023-04-05 04:40:21,568 - Detection - type:	open_intent_detection
2023-04-05 04:40:21,568 - Detection - logger_name:	Detection
2023-04-05 04:40:21,568 - Detection - log_dir:	logs
2023-04-05 04:40:21,568 - Detection - dataset:	oos
2023-04-05 04:40:21,568 - Detection - known_cls_ratio:	0.25
2023-04-05 04:40:21,568 - Detection - labeled_ratio:	1.0
2023-04-05 04:40:21,568 - Detection - method:	DA-ADB
2023-04-05 04:40:21,568 - Detection - train:	True
2023-04-05 04:40:21,568 - Detection - pretrain:	True
2023-04-05 04:40:21,568 - Detection - save_model:	True
2023-04-05 04:40:21,568 - Detection - backbone:	bert_disaware
2023-04-05 04:40:21,568 - Detection - config_file_name:	DA-ADB
2023-04-05 04:40:21,568 - Detection - seed:	4
2023-04-05 04:40:21,568 - Detection - gpu_id:	0
2023-04-05 04:40:21,568 - Detection - pipe_results_path:	pipe_results
2023-04-05 04:40:21,568 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-05 04:40:21,568 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-05 04:40:21,568 - Detection - model_dir:	models
2023-04-05 04:40:21,568 - Detection - load_pretrained_method:	None
2023-04-05 04:40:21,568 - Detection - result_dir:	results
2023-04-05 04:40:21,568 - Detection - results_file_name:	results_DA-ADB.csv
2023-04-05 04:40:21,568 - Detection - save_results:	True
2023-04-05 04:40:21,568 - Detection - loss_fct:	CrossEntropyLoss
2023-04-05 04:40:21,568 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_oos_0.25_1.0_bert_disaware_4
2023-04-05 04:40:21,568 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_oos_0.25_1.0_bert_disaware_4/models
2023-04-05 04:40:21,568 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-05 04:40:21,568 - Detection - num_train_epochs:	100
2023-04-05 04:40:21,568 - Detection - num_labels:	None
2023-04-05 04:40:21,568 - Detection - max_seq_length:	None
2023-04-05 04:40:21,568 - Detection - freeze_backbone_parameters:	True
2023-04-05 04:40:21,568 - Detection - feat_dim:	768
2023-04-05 04:40:21,568 - Detection - warmup_proportion:	0.1
2023-04-05 04:40:21,568 - Detection - scale:	4
2023-04-05 04:40:21,568 - Detection - lr_boundary:	0.05
2023-04-05 04:40:21,568 - Detection - lr:	2e-05
2023-04-05 04:40:21,569 - Detection - activation:	relu
2023-04-05 04:40:21,569 - Detection - train_batch_size:	128
2023-04-05 04:40:21,569 - Detection - eval_batch_size:	64
2023-04-05 04:40:21,569 - Detection - test_batch_size:	64
2023-04-05 04:40:21,569 - Detection - wait_patient:	10
2023-04-05 04:40:21,569 - Detection - ============================== End Params ==============================
2023-04-05 04:40:21,569 - Detection - Data and Model Preparation...
2023-04-05 04:40:21,569 - Detection - The number of known intents is 38
2023-04-05 04:40:21,569 - Detection - Lists of known labels are: ['traffic', 'card_declined', 'transfer', 'roll_dice', 'routing', 'oil_change_how', 'pay_bill', 'calories', 'are_you_a_bot', 'travel_notification', 'change_volume', 'calculator', 'calendar', 'last_maintenance', 'smart_home', 'definition', 'international_fees', 'alarm', 'change_user_name', 'timezone', 'direct_deposit', 'tire_change', 'meaning_of_life', 'confirm_reservation', 'credit_limit_change', 'carry_on', 'find_phone', 'cancel_reservation', 'change_accent', 'restaurant_reservation', 'payday', 'gas', 'schedule_maintenance', 'account_blocked', 'redeem_rewards', 'what_song', 'tire_pressure', 'recipe']
2023-04-05 04:40:21,610 - Detection - Number of labeled training samples = 3800
2023-04-05 04:40:21,610 - Detection - Number of unlabeled training samples = 11200
2023-04-05 04:40:21,617 - Detection - Number of evaluation samples = 760
2023-04-05 04:40:21,627 - Detection - Number of testing samples = 5700
2023-04-05 04:40:30,441 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-05 04:40:30,526 - Detection - Pre-training Begin...
2023-04-05 04:40:36,040 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 04:40:36,040 - Detection -   best_eval_score = 0
2023-04-05 04:40:36,040 - Detection -   eval_score = 0.4
2023-04-05 04:40:36,040 - Detection -   train_loss = 3.6369258085886638
2023-04-05 04:40:41,067 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 04:40:41,067 - Detection -   best_eval_score = 0.4
2023-04-05 04:40:41,067 - Detection -   eval_score = 7.8
2023-04-05 04:40:41,067 - Detection -   train_loss = 3.614065742492676
2023-04-05 04:40:46,210 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 04:40:46,210 - Detection -   best_eval_score = 7.8
2023-04-05 04:40:46,210 - Detection -   eval_score = 26.59
2023-04-05 04:40:46,210 - Detection -   train_loss = 3.564728299776713
2023-04-05 04:40:51,260 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 04:40:51,260 - Detection -   best_eval_score = 26.59
2023-04-05 04:40:51,260 - Detection -   eval_score = 50.31
2023-04-05 04:40:51,260 - Detection -   train_loss = 3.4399261713027953
2023-04-05 04:40:56,319 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 04:40:56,320 - Detection -   best_eval_score = 50.31
2023-04-05 04:40:56,320 - Detection -   eval_score = 72.02
2023-04-05 04:40:56,320 - Detection -   train_loss = 3.208834258715312
2023-04-05 04:41:01,396 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 04:41:01,396 - Detection -   best_eval_score = 72.02
2023-04-05 04:41:01,396 - Detection -   eval_score = 83.95
2023-04-05 04:41:01,396 - Detection -   train_loss = 2.883250101407369
2023-04-05 04:41:06,475 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 04:41:06,476 - Detection -   best_eval_score = 83.95
2023-04-05 04:41:06,476 - Detection -   eval_score = 89.72
2023-04-05 04:41:06,476 - Detection -   train_loss = 2.484214727083842
2023-04-05 04:41:11,559 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 04:41:11,560 - Detection -   best_eval_score = 89.72
2023-04-05 04:41:11,560 - Detection -   eval_score = 92.37
2023-04-05 04:41:11,560 - Detection -   train_loss = 2.1441179752349853
2023-04-05 04:41:16,653 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 04:41:16,653 - Detection -   best_eval_score = 92.37
2023-04-05 04:41:16,654 - Detection -   eval_score = 93.2
2023-04-05 04:41:16,654 - Detection -   train_loss = 1.8928107857704162
2023-04-05 04:41:21,759 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 04:41:21,759 - Detection -   best_eval_score = 93.2
2023-04-05 04:41:21,759 - Detection -   eval_score = 94.9
2023-04-05 04:41:21,759 - Detection -   train_loss = 1.715973695119222
2023-04-05 04:41:26,872 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 04:41:26,872 - Detection -   best_eval_score = 94.9
2023-04-05 04:41:26,872 - Detection -   eval_score = 96.95
2023-04-05 04:41:26,872 - Detection -   train_loss = 1.5807464679082235
2023-04-05 04:41:31,983 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 04:41:31,983 - Detection -   best_eval_score = 96.95
2023-04-05 04:41:31,983 - Detection -   eval_score = 97.6
2023-04-05 04:41:31,983 - Detection -   train_loss = 1.4829571882883708
2023-04-05 04:41:37,102 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 04:41:37,102 - Detection -   best_eval_score = 97.6
2023-04-05 04:41:37,102 - Detection -   eval_score = 97.59
2023-04-05 04:41:37,102 - Detection -   train_loss = 1.4042026996612549
2023-04-05 04:41:42,204 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 04:41:42,204 - Detection -   best_eval_score = 97.6
2023-04-05 04:41:42,204 - Detection -   eval_score = 97.75
2023-04-05 04:41:42,204 - Detection -   train_loss = 1.3427032748858134
2023-04-05 04:41:47,321 - Detection - ***** Epoch: 15: Eval results *****
2023-04-05 04:41:47,321 - Detection -   best_eval_score = 97.75
2023-04-05 04:41:47,322 - Detection -   eval_score = 97.87
2023-04-05 04:41:47,322 - Detection -   train_loss = 1.2898226936658224
2023-04-05 04:41:52,437 - Detection - ***** Epoch: 16: Eval results *****
2023-04-05 04:41:52,437 - Detection -   best_eval_score = 97.87
2023-04-05 04:41:52,437 - Detection -   eval_score = 97.73
2023-04-05 04:41:52,437 - Detection -   train_loss = 1.2486314813296
2023-04-05 04:41:57,542 - Detection - ***** Epoch: 17: Eval results *****
2023-04-05 04:41:57,543 - Detection -   best_eval_score = 97.87
2023-04-05 04:41:57,543 - Detection -   eval_score = 98.0
2023-04-05 04:41:57,543 - Detection -   train_loss = 1.2140828688939413
2023-04-05 04:42:02,760 - Detection - ***** Epoch: 18: Eval results *****
2023-04-05 04:42:02,761 - Detection -   best_eval_score = 98.0
2023-04-05 04:42:02,761 - Detection -   eval_score = 98.14
2023-04-05 04:42:02,761 - Detection -   train_loss = 1.1790955503781637
2023-04-05 04:42:07,874 - Detection - ***** Epoch: 19: Eval results *****
2023-04-05 04:42:07,874 - Detection -   best_eval_score = 98.14
2023-04-05 04:42:07,874 - Detection -   eval_score = 98.01
2023-04-05 04:42:07,874 - Detection -   train_loss = 1.1493442177772522
2023-04-05 04:42:12,974 - Detection - ***** Epoch: 20: Eval results *****
2023-04-05 04:42:12,974 - Detection -   best_eval_score = 98.14
2023-04-05 04:42:12,974 - Detection -   eval_score = 98.27
2023-04-05 04:42:12,974 - Detection -   train_loss = 1.1258996884028116
2023-04-05 04:42:18,089 - Detection - ***** Epoch: 21: Eval results *****
2023-04-05 04:42:18,089 - Detection -   best_eval_score = 98.27
2023-04-05 04:42:18,089 - Detection -   eval_score = 98.27
2023-04-05 04:42:18,089 - Detection -   train_loss = 1.1026675899823506
2023-04-05 04:42:23,187 - Detection - ***** Epoch: 22: Eval results *****
2023-04-05 04:42:23,187 - Detection -   best_eval_score = 98.27
2023-04-05 04:42:23,187 - Detection -   eval_score = 98.27
2023-04-05 04:42:23,187 - Detection -   train_loss = 1.0845919251441956
2023-04-05 04:42:28,289 - Detection - ***** Epoch: 23: Eval results *****
2023-04-05 04:42:28,289 - Detection -   best_eval_score = 98.27
2023-04-05 04:42:28,289 - Detection -   eval_score = 98.27
2023-04-05 04:42:28,289 - Detection -   train_loss = 1.0642729640007018
2023-04-05 04:42:33,390 - Detection - ***** Epoch: 24: Eval results *****
2023-04-05 04:42:33,390 - Detection -   best_eval_score = 98.27
2023-04-05 04:42:33,390 - Detection -   eval_score = 98.13
2023-04-05 04:42:33,390 - Detection -   train_loss = 1.0468190352121989
2023-04-05 04:42:38,489 - Detection - ***** Epoch: 25: Eval results *****
2023-04-05 04:42:38,489 - Detection -   best_eval_score = 98.27
2023-04-05 04:42:38,489 - Detection -   eval_score = 98.27
2023-04-05 04:42:38,489 - Detection -   train_loss = 1.0344455401102701
2023-04-05 04:42:43,585 - Detection - ***** Epoch: 26: Eval results *****
2023-04-05 04:42:43,585 - Detection -   best_eval_score = 98.27
2023-04-05 04:42:43,585 - Detection -   eval_score = 98.13
2023-04-05 04:42:43,585 - Detection -   train_loss = 1.018878710269928
2023-04-05 04:42:48,677 - Detection - ***** Epoch: 27: Eval results *****
2023-04-05 04:42:48,678 - Detection -   best_eval_score = 98.27
2023-04-05 04:42:48,678 - Detection -   eval_score = 98.13
2023-04-05 04:42:48,678 - Detection -   train_loss = 1.007498848438263
2023-04-05 04:42:53,773 - Detection - ***** Epoch: 28: Eval results *****
2023-04-05 04:42:53,773 - Detection -   best_eval_score = 98.27
2023-04-05 04:42:53,773 - Detection -   eval_score = 98.13
2023-04-05 04:42:53,773 - Detection -   train_loss = 0.9934601306915283
2023-04-05 04:42:58,869 - Detection - ***** Epoch: 29: Eval results *****
2023-04-05 04:42:58,869 - Detection -   best_eval_score = 98.27
2023-04-05 04:42:58,869 - Detection -   eval_score = 98.13
2023-04-05 04:42:58,869 - Detection -   train_loss = 0.9814083655675252
2023-04-05 04:43:03,965 - Detection - ***** Epoch: 30: Eval results *****
2023-04-05 04:43:03,965 - Detection -   best_eval_score = 98.27
2023-04-05 04:43:03,965 - Detection -   eval_score = 98.27
2023-04-05 04:43:03,965 - Detection -   train_loss = 0.9737442990144094
2023-04-05 04:43:03,966 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_oos_0.25_1.0_bert_disaware_4/models
2023-04-05 04:43:04,511 - Detection - Pre-training finished...
2023-04-05 04:43:04,512 - Detection - Training Begin...
2023-04-05 04:43:07,382 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 04:43:07,382 - Detection -   best_eval_score = 0
2023-04-05 04:43:07,382 - Detection -   eval_score = 47.16
2023-04-05 04:43:07,382 - Detection -   train_loss = 2.2235547065734864
2023-04-05 04:43:10,253 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 04:43:10,253 - Detection -   best_eval_score = 47.16
2023-04-05 04:43:10,253 - Detection -   eval_score = 83.52
2023-04-05 04:43:10,253 - Detection -   train_loss = 1.2635738372802734
2023-04-05 04:43:13,125 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 04:43:13,125 - Detection -   best_eval_score = 83.52
2023-04-05 04:43:13,125 - Detection -   eval_score = 91.31
2023-04-05 04:43:13,125 - Detection -   train_loss = 0.5996395568052928
2023-04-05 04:43:15,997 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 04:43:15,997 - Detection -   best_eval_score = 91.31
2023-04-05 04:43:15,997 - Detection -   eval_score = 91.24
2023-04-05 04:43:15,997 - Detection -   train_loss = 0.46004806061585746
2023-04-05 04:43:18,868 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 04:43:18,868 - Detection -   best_eval_score = 91.31
2023-04-05 04:43:18,868 - Detection -   eval_score = 91.26
2023-04-05 04:43:18,868 - Detection -   train_loss = 0.45658346911271414
2023-04-05 04:43:21,737 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 04:43:21,737 - Detection -   best_eval_score = 91.31
2023-04-05 04:43:21,738 - Detection -   eval_score = 91.04
2023-04-05 04:43:21,738 - Detection -   train_loss = 0.4542385478814443
2023-04-05 04:43:24,606 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 04:43:24,606 - Detection -   best_eval_score = 91.31
2023-04-05 04:43:24,606 - Detection -   eval_score = 91.53
2023-04-05 04:43:24,606 - Detection -   train_loss = 0.45549077888329825
2023-04-05 04:43:27,475 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 04:43:27,475 - Detection -   best_eval_score = 91.53
2023-04-05 04:43:27,475 - Detection -   eval_score = 91.14
2023-04-05 04:43:27,475 - Detection -   train_loss = 0.44710433185100557
2023-04-05 04:43:30,346 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 04:43:30,346 - Detection -   best_eval_score = 91.53
2023-04-05 04:43:30,346 - Detection -   eval_score = 91.13
2023-04-05 04:43:30,346 - Detection -   train_loss = 0.46049018303553263
2023-04-05 04:43:33,218 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 04:43:33,219 - Detection -   best_eval_score = 91.53
2023-04-05 04:43:33,219 - Detection -   eval_score = 91.04
2023-04-05 04:43:33,219 - Detection -   train_loss = 0.4527489175399145
2023-04-05 04:43:36,090 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 04:43:36,090 - Detection -   best_eval_score = 91.53
2023-04-05 04:43:36,090 - Detection -   eval_score = 91.4
2023-04-05 04:43:36,090 - Detection -   train_loss = 0.4561748057603836
2023-04-05 04:43:38,962 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 04:43:38,962 - Detection -   best_eval_score = 91.53
2023-04-05 04:43:38,963 - Detection -   eval_score = 91.14
2023-04-05 04:43:38,963 - Detection -   train_loss = 0.4540066927671432
2023-04-05 04:43:41,833 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 04:43:41,834 - Detection -   best_eval_score = 91.53
2023-04-05 04:43:41,834 - Detection -   eval_score = 91.38
2023-04-05 04:43:41,834 - Detection -   train_loss = 0.45301131208737694
2023-04-05 04:43:44,704 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 04:43:44,704 - Detection -   best_eval_score = 91.53
2023-04-05 04:43:44,704 - Detection -   eval_score = 91.32
2023-04-05 04:43:44,704 - Detection -   train_loss = 0.44922463099161786
2023-04-05 04:43:47,574 - Detection - ***** Epoch: 15: Eval results *****
2023-04-05 04:43:47,575 - Detection -   best_eval_score = 91.53
2023-04-05 04:43:47,575 - Detection -   eval_score = 91.28
2023-04-05 04:43:47,575 - Detection -   train_loss = 0.45519939959049227
2023-04-05 04:43:50,446 - Detection - ***** Epoch: 16: Eval results *****
2023-04-05 04:43:50,447 - Detection -   best_eval_score = 91.53
2023-04-05 04:43:50,447 - Detection -   eval_score = 91.23
2023-04-05 04:43:50,447 - Detection -   train_loss = 0.4535926928122838
2023-04-05 04:43:53,320 - Detection - ***** Epoch: 17: Eval results *****
2023-04-05 04:43:53,320 - Detection -   best_eval_score = 91.53
2023-04-05 04:43:53,320 - Detection -   eval_score = 91.53
2023-04-05 04:43:53,320 - Detection -   train_loss = 0.451159198085467
2023-04-05 04:43:53,321 - Detection - Training Finished...
2023-04-05 04:43:53,321 - Detection - Testing begin...
2023-04-05 04:43:56,577 - Detection - ***** Test: Confusion Matrix *****
2023-04-05 04:43:56,577 - Detection - [[  29    0    0 ...    0    0    1]
 [   0   22    0 ...    0    0    7]
 [   0    0   26 ...    0    0    4]
 ...
 [   0    0    0 ...   30    0    0]
 [   0    0    0 ...    0   29    1]
 [   0   25    1 ...    0   37 4212]]
2023-04-05 04:43:56,577 - Detection - ***** Test results *****
2023-04-05 04:43:56,577 - Detection -   Acc = 91.63
2023-04-05 04:43:56,577 - Detection -   F1 = 83.4336
2023-04-05 04:43:56,577 - Detection -   F1-known = 83.1384
2023-04-05 04:43:56,577 - Detection -   F1-open = 94.6517
2023-04-05 04:43:56,578 - Detection - Testing finished...
2023-04-05 04:43:56,578 - Detection - Results saved in results/results_DA-ADB.csv
2023-04-05 04:43:56,598 - Detection - Open Intent Detection Finished...
