2023-04-24 15:59:18,134 - Detection - Open Intent Detection Begin...
2023-04-24 15:59:18,134 - Detection - Parameters Initialization...
2023-04-24 15:59:18,134 - Detection - ============================== Params ==============================
2023-04-24 15:59:18,134 - Detection - type:	open_intent_detection
2023-04-24 15:59:18,134 - Detection - logger_name:	Detection
2023-04-24 15:59:18,134 - Detection - log_dir:	logs
2023-04-24 15:59:18,134 - Detection - dataset:	stackoverflow_cg
2023-04-24 15:59:18,134 - Detection - known_cls_ratio:	0.75
2023-04-24 15:59:18,134 - Detection - labeled_ratio:	1.0
2023-04-24 15:59:18,134 - Detection - method:	ADB
2023-04-24 15:59:18,134 - Detection - train:	True
2023-04-24 15:59:18,134 - Detection - pretrain:	True
2023-04-24 15:59:18,134 - Detection - save_model:	False
2023-04-24 15:59:18,134 - Detection - backbone:	bert_boost
2023-04-24 15:59:18,134 - Detection - config_file_name:	ADB
2023-04-24 15:59:18,134 - Detection - seed:	8
2023-04-24 15:59:18,135 - Detection - gpu_id:	0
2023-04-24 15:59:18,135 - Detection - pipe_results_path:	pipe_results
2023-04-24 15:59:18,135 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-24 15:59:18,135 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-24 15:59:18,135 - Detection - model_dir:	models
2023-04-24 15:59:18,135 - Detection - load_pretrained_method:	None
2023-04-24 15:59:18,135 - Detection - result_dir:	results
2023-04-24 15:59:18,135 - Detection - results_file_name:	results_ADB-BOOST-F-10.csv
2023-04-24 15:59:18,135 - Detection - save_results:	True
2023-04-24 15:59:18,135 - Detection - loss_fct:	CrossEntropyLoss
2023-04-24 15:59:18,135 - Detection - boost_method:	F-10
2023-04-24 15:59:18,135 - Detection - boost_start_score:	0.0
2023-04-24 15:59:18,135 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.75_1.0_bert_boost_8
2023-04-24 15:59:18,135 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.75_1.0_bert_boost_8/models
2023-04-24 15:59:18,135 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-24 15:59:18,135 - Detection - num_train_epochs:	100
2023-04-24 15:59:18,135 - Detection - num_labels:	None
2023-04-24 15:59:18,135 - Detection - max_seq_length:	None
2023-04-24 15:59:18,135 - Detection - freeze_backbone_parameters:	True
2023-04-24 15:59:18,135 - Detection - feat_dim:	768
2023-04-24 15:59:18,135 - Detection - warmup_proportion:	0.1
2023-04-24 15:59:18,135 - Detection - lr_boundary:	0.05
2023-04-24 15:59:18,135 - Detection - lr:	2e-05
2023-04-24 15:59:18,135 - Detection - activation:	relu
2023-04-24 15:59:18,135 - Detection - train_batch_size:	128
2023-04-24 15:59:18,135 - Detection - eval_batch_size:	64
2023-04-24 15:59:18,135 - Detection - test_batch_size:	64
2023-04-24 15:59:18,135 - Detection - wait_patient:	10
2023-04-24 15:59:18,135 - Detection - ============================== End Params ==============================
2023-04-24 15:59:18,135 - Detection - Data and Model Preparation...
2023-04-24 15:59:18,135 - Detection - The number of known intents is 15
2023-04-24 15:59:18,136 - Detection - Lists of known labels are: ['hibernate', 'oracle', 'haskell', 'sharepoint', 'visual-studio', 'drupal', 'osx', 'bash', 'qt', 'apache', 'spring', 'ajax', 'scala', 'wordpress', 'linq']
2023-04-24 15:59:18,145 - Detection - Number of labeled training samples = 2092
2023-04-24 15:59:18,145 - Detection - Number of unlabeled training samples = 699
2023-04-24 15:59:18,148 - Detection - Number of evaluation samples = 1072
2023-04-24 15:59:18,154 - Detection - Number of testing samples = 2905
2023-04-24 15:59:22,207 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-24 15:59:23,869 - Detection - Pre-training Begin...
2023-04-24 15:59:27,155 - Detection - ***** Epoch: 1: Eval results *****
2023-04-24 15:59:27,155 - Detection -   best_eval_score = 0
2023-04-24 15:59:27,155 - Detection -   eval_score = 9.42
2023-04-24 15:59:27,155 - Detection -   train_loss = 2.7073604780084946
2023-04-24 15:59:57,824 - Detection - ***** Epoch: 2: Eval results *****
2023-04-24 15:59:57,825 - Detection -   best_eval_score = 9.42
2023-04-24 15:59:57,825 - Detection -   eval_score = 42.35
2023-04-24 15:59:57,825 - Detection -   train_loss = 2.692457647884593
2023-04-24 16:00:28,810 - Detection - ***** Epoch: 3: Eval results *****
2023-04-24 16:00:28,810 - Detection -   best_eval_score = 42.35
2023-04-24 16:00:28,810 - Detection -   eval_score = 75.56
2023-04-24 16:00:28,810 - Detection -   train_loss = 2.1281957766588997
2023-04-24 16:00:59,581 - Detection - ***** Epoch: 4: Eval results *****
2023-04-24 16:00:59,581 - Detection -   best_eval_score = 75.56
2023-04-24 16:00:59,581 - Detection -   eval_score = 80.41
2023-04-24 16:00:59,581 - Detection -   train_loss = 1.1976256861406214
2023-04-24 16:01:30,435 - Detection - ***** Epoch: 5: Eval results *****
2023-04-24 16:01:30,435 - Detection -   best_eval_score = 80.41
2023-04-24 16:01:30,435 - Detection -   eval_score = 80.97
2023-04-24 16:01:30,435 - Detection -   train_loss = 0.863148478900685
2023-04-24 16:02:01,170 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 16:02:01,170 - Detection -   best_eval_score = 80.97
2023-04-24 16:02:01,170 - Detection -   eval_score = 81.06
2023-04-24 16:02:01,170 - Detection -   train_loss = 0.6832097137675566
2023-04-24 16:02:32,000 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 16:02:32,000 - Detection -   best_eval_score = 81.06
2023-04-24 16:02:32,000 - Detection -   eval_score = 81.34
2023-04-24 16:02:32,001 - Detection -   train_loss = 0.541211724281311
2023-04-24 16:03:02,815 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 16:03:02,815 - Detection -   best_eval_score = 81.34
2023-04-24 16:03:02,815 - Detection -   eval_score = 81.06
2023-04-24 16:03:02,815 - Detection -   train_loss = 0.43780290379243736
2023-04-24 16:03:33,656 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 16:03:33,656 - Detection -   best_eval_score = 81.34
2023-04-24 16:03:33,656 - Detection -   eval_score = 80.22
2023-04-24 16:03:33,656 - Detection -   train_loss = 0.3184392934336382
2023-04-24 16:04:04,504 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 16:04:04,504 - Detection -   best_eval_score = 81.34
2023-04-24 16:04:04,504 - Detection -   eval_score = 80.69
2023-04-24 16:04:04,504 - Detection -   train_loss = 0.2565290805171518
2023-04-24 16:04:35,211 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 16:04:35,212 - Detection -   best_eval_score = 81.34
2023-04-24 16:04:35,212 - Detection -   eval_score = 80.88
2023-04-24 16:04:35,212 - Detection -   train_loss = 0.20764794419793522
2023-04-24 16:05:05,957 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 16:05:05,957 - Detection -   best_eval_score = 81.34
2023-04-24 16:05:05,957 - Detection -   eval_score = 80.41
2023-04-24 16:05:05,957 - Detection -   train_loss = 0.14924802894101424
2023-04-24 16:05:36,659 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 16:05:36,659 - Detection -   best_eval_score = 81.34
2023-04-24 16:05:36,659 - Detection -   eval_score = 80.78
2023-04-24 16:05:36,659 - Detection -   train_loss = 0.1354888585560462
2023-04-24 16:06:07,580 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 16:06:07,580 - Detection -   best_eval_score = 81.34
2023-04-24 16:06:07,580 - Detection -   eval_score = 81.53
2023-04-24 16:06:07,580 - Detection -   train_loss = 0.10402681678533554
2023-04-24 16:06:38,362 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 16:06:38,363 - Detection -   best_eval_score = 81.53
2023-04-24 16:06:38,363 - Detection -   eval_score = 81.72
2023-04-24 16:06:38,363 - Detection -   train_loss = 0.10106360167264938
2023-04-24 16:07:09,172 - Detection - ***** Epoch: 16: Eval results *****
2023-04-24 16:07:09,172 - Detection -   best_eval_score = 81.72
2023-04-24 16:07:09,172 - Detection -   eval_score = 81.34
2023-04-24 16:07:09,172 - Detection -   train_loss = 0.08219010360977229
2023-04-24 16:07:40,055 - Detection - ***** Epoch: 17: Eval results *****
2023-04-24 16:07:40,055 - Detection -   best_eval_score = 81.72
2023-04-24 16:07:40,055 - Detection -   eval_score = 81.44
2023-04-24 16:07:40,055 - Detection -   train_loss = 0.07583737504832885
2023-04-24 16:08:10,992 - Detection - ***** Epoch: 18: Eval results *****
2023-04-24 16:08:10,992 - Detection -   best_eval_score = 81.72
2023-04-24 16:08:10,992 - Detection -   eval_score = 81.53
2023-04-24 16:08:10,992 - Detection -   train_loss = 0.06721964763367877
2023-04-24 16:08:42,004 - Detection - ***** Epoch: 19: Eval results *****
2023-04-24 16:08:42,004 - Detection -   best_eval_score = 81.72
2023-04-24 16:08:42,004 - Detection -   eval_score = 82.37
2023-04-24 16:08:42,004 - Detection -   train_loss = 0.06583912078948582
2023-04-24 16:09:12,781 - Detection - ***** Epoch: 20: Eval results *****
2023-04-24 16:09:12,781 - Detection -   best_eval_score = 82.37
2023-04-24 16:09:12,781 - Detection -   eval_score = 81.44
2023-04-24 16:09:12,781 - Detection -   train_loss = 0.06252633341971565
2023-04-24 16:09:43,632 - Detection - ***** Epoch: 21: Eval results *****
2023-04-24 16:09:43,632 - Detection -   best_eval_score = 82.37
2023-04-24 16:09:43,632 - Detection -   eval_score = 81.72
2023-04-24 16:09:43,632 - Detection -   train_loss = 0.053286411306437326
2023-04-24 16:10:14,511 - Detection - ***** Epoch: 22: Eval results *****
2023-04-24 16:10:14,511 - Detection -   best_eval_score = 82.37
2023-04-24 16:10:14,511 - Detection -   eval_score = 82.09
2023-04-24 16:10:14,511 - Detection -   train_loss = 0.03998990477446247
2023-04-24 16:10:45,372 - Detection - ***** Epoch: 23: Eval results *****
2023-04-24 16:10:45,372 - Detection -   best_eval_score = 82.37
2023-04-24 16:10:45,372 - Detection -   eval_score = 81.62
2023-04-24 16:10:45,372 - Detection -   train_loss = 0.0418810417108676
2023-04-24 16:11:16,200 - Detection - ***** Epoch: 24: Eval results *****
2023-04-24 16:11:16,200 - Detection -   best_eval_score = 82.37
2023-04-24 16:11:16,200 - Detection -   eval_score = 81.62
2023-04-24 16:11:16,200 - Detection -   train_loss = 0.031224108355886796
2023-04-24 16:11:47,024 - Detection - ***** Epoch: 25: Eval results *****
2023-04-24 16:11:47,024 - Detection -   best_eval_score = 82.37
2023-04-24 16:11:47,024 - Detection -   eval_score = 81.72
2023-04-24 16:11:47,024 - Detection -   train_loss = 0.04127166869447512
2023-04-24 16:12:17,960 - Detection - ***** Epoch: 26: Eval results *****
2023-04-24 16:12:17,961 - Detection -   best_eval_score = 82.37
2023-04-24 16:12:17,961 - Detection -   eval_score = 81.25
2023-04-24 16:12:17,961 - Detection -   train_loss = 0.029157386764007455
2023-04-24 16:12:48,801 - Detection - ***** Epoch: 27: Eval results *****
2023-04-24 16:12:48,802 - Detection -   best_eval_score = 82.37
2023-04-24 16:12:48,802 - Detection -   eval_score = 81.25
2023-04-24 16:12:48,802 - Detection -   train_loss = 0.02396867928259513
2023-04-24 16:13:19,654 - Detection - ***** Epoch: 28: Eval results *****
2023-04-24 16:13:19,654 - Detection -   best_eval_score = 82.37
2023-04-24 16:13:19,654 - Detection -   eval_score = 81.53
2023-04-24 16:13:19,654 - Detection -   train_loss = 0.028086675330996513
2023-04-24 16:13:50,390 - Detection - ***** Epoch: 29: Eval results *****
2023-04-24 16:13:50,390 - Detection -   best_eval_score = 82.37
2023-04-24 16:13:50,391 - Detection -   eval_score = 81.72
2023-04-24 16:13:50,391 - Detection -   train_loss = 0.029574362780241406
2023-04-24 16:13:50,391 - Detection - Pre-training finished...
2023-04-24 16:13:50,391 - Detection - Training Begin...
2023-04-24 16:13:54,888 - Detection - ***** Epoch: 1: Eval results *****
2023-04-24 16:13:54,888 - Detection -   best_eval_score = 0
2023-04-24 16:13:54,889 - Detection -   eval_score = 0.0
2023-04-24 16:13:54,889 - Detection -   train_loss = 13.686120930839987
2023-04-24 16:13:57,696 - Detection - ***** Epoch: 2: Eval results *****
2023-04-24 16:13:57,696 - Detection -   best_eval_score = 0
2023-04-24 16:13:57,696 - Detection -   eval_score = 0.0
2023-04-24 16:13:57,696 - Detection -   train_loss = 13.145714254940257
2023-04-24 16:14:00,505 - Detection - ***** Epoch: 3: Eval results *****
2023-04-24 16:14:00,505 - Detection -   best_eval_score = 0
2023-04-24 16:14:00,505 - Detection -   eval_score = 0.0
2023-04-24 16:14:00,505 - Detection -   train_loss = 12.339430472430061
2023-04-24 16:14:03,316 - Detection - ***** Epoch: 4: Eval results *****
2023-04-24 16:14:03,316 - Detection -   best_eval_score = 0
2023-04-24 16:14:03,316 - Detection -   eval_score = 0.0
2023-04-24 16:14:03,316 - Detection -   train_loss = 11.56218433380127
2023-04-24 16:14:06,133 - Detection - ***** Epoch: 5: Eval results *****
2023-04-24 16:14:06,133 - Detection -   best_eval_score = 0
2023-04-24 16:14:06,133 - Detection -   eval_score = 0.0
2023-04-24 16:14:06,133 - Detection -   train_loss = 10.616637847002815
2023-04-24 16:14:08,952 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 16:14:08,952 - Detection -   best_eval_score = 0
2023-04-24 16:14:08,952 - Detection -   eval_score = 0.67
2023-04-24 16:14:08,952 - Detection -   train_loss = 9.67369550817153
2023-04-24 16:14:39,786 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 16:14:39,786 - Detection -   best_eval_score = 0.67
2023-04-24 16:14:39,786 - Detection -   eval_score = 74.36
2023-04-24 16:14:39,786 - Detection -   train_loss = 8.80564296946806
2023-04-24 16:15:10,331 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 16:15:10,331 - Detection -   best_eval_score = 74.36
2023-04-24 16:15:10,331 - Detection -   eval_score = 75.67
2023-04-24 16:15:10,331 - Detection -   train_loss = 1.8572532850153305
2023-04-24 16:15:40,929 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 16:15:40,929 - Detection -   best_eval_score = 75.67
2023-04-24 16:15:40,929 - Detection -   eval_score = 75.55
2023-04-24 16:15:40,929 - Detection -   train_loss = 1.8251640796661377
2023-04-24 16:16:11,579 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 16:16:11,579 - Detection -   best_eval_score = 75.67
2023-04-24 16:16:11,579 - Detection -   eval_score = 75.5
2023-04-24 16:16:11,579 - Detection -   train_loss = 1.8235596208011402
2023-04-24 16:16:42,203 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 16:16:42,203 - Detection -   best_eval_score = 75.67
2023-04-24 16:16:42,203 - Detection -   eval_score = 75.55
2023-04-24 16:16:42,203 - Detection -   train_loss = 1.831296359791475
2023-04-24 16:17:12,836 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 16:17:12,836 - Detection -   best_eval_score = 75.67
2023-04-24 16:17:12,836 - Detection -   eval_score = 75.62
2023-04-24 16:17:12,837 - Detection -   train_loss = 1.818522895083708
2023-04-24 16:17:43,397 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 16:17:43,397 - Detection -   best_eval_score = 75.67
2023-04-24 16:17:43,397 - Detection -   eval_score = 75.74
2023-04-24 16:17:43,397 - Detection -   train_loss = 1.8153786869610058
2023-04-24 16:18:14,118 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 16:18:14,118 - Detection -   best_eval_score = 75.74
2023-04-24 16:18:14,118 - Detection -   eval_score = 75.59
2023-04-24 16:18:14,118 - Detection -   train_loss = 1.8418367470011991
2023-04-24 16:18:44,823 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 16:18:44,823 - Detection -   best_eval_score = 75.74
2023-04-24 16:18:44,823 - Detection -   eval_score = 75.41
2023-04-24 16:18:44,823 - Detection -   train_loss = 1.818280444425695
2023-04-24 16:19:15,477 - Detection - ***** Epoch: 16: Eval results *****
2023-04-24 16:19:15,477 - Detection -   best_eval_score = 75.74
2023-04-24 16:19:15,477 - Detection -   eval_score = 75.4
2023-04-24 16:19:15,477 - Detection -   train_loss = 1.8097127325394575
2023-04-24 16:19:50,196 - Detection - ***** Epoch: 17: Eval results *****
2023-04-24 16:19:50,196 - Detection -   best_eval_score = 75.74
2023-04-24 16:19:50,196 - Detection -   eval_score = 75.66
2023-04-24 16:19:50,196 - Detection -   train_loss = 1.8419983386993408
2023-04-24 16:20:27,594 - Detection - ***** Epoch: 18: Eval results *****
2023-04-24 16:20:27,595 - Detection -   best_eval_score = 75.74
2023-04-24 16:20:27,595 - Detection -   eval_score = 75.52
2023-04-24 16:20:27,595 - Detection -   train_loss = 1.82319096957936
2023-04-24 16:21:08,792 - Detection - ***** Epoch: 19: Eval results *****
2023-04-24 16:21:08,793 - Detection -   best_eval_score = 75.74
2023-04-24 16:21:08,793 - Detection -   eval_score = 75.56
2023-04-24 16:21:08,793 - Detection -   train_loss = 1.8675365377874935
2023-04-24 16:21:55,369 - Detection - ***** Epoch: 20: Eval results *****
2023-04-24 16:21:55,369 - Detection -   best_eval_score = 75.74
2023-04-24 16:21:55,369 - Detection -   eval_score = 75.48
2023-04-24 16:21:55,369 - Detection -   train_loss = 1.8168572608162374
2023-04-24 16:22:46,922 - Detection - ***** Epoch: 21: Eval results *****
2023-04-24 16:22:46,922 - Detection -   best_eval_score = 75.74
2023-04-24 16:22:46,922 - Detection -   eval_score = 75.53
2023-04-24 16:22:46,922 - Detection -   train_loss = 1.7946570971432854
2023-04-24 16:23:44,755 - Detection - ***** Epoch: 22: Eval results *****
2023-04-24 16:23:44,755 - Detection -   best_eval_score = 75.74
2023-04-24 16:23:44,756 - Detection -   eval_score = 75.41
2023-04-24 16:23:44,756 - Detection -   train_loss = 1.798287356601042
2023-04-24 16:24:45,002 - Detection - ***** Epoch: 23: Eval results *****
2023-04-24 16:24:45,002 - Detection -   best_eval_score = 75.74
2023-04-24 16:24:45,002 - Detection -   eval_score = 75.7
2023-04-24 16:24:45,002 - Detection -   train_loss = 1.8222394760917215
2023-04-24 16:24:45,002 - Detection - Training Finished...
2023-04-24 16:24:45,002 - Detection - Testing begin...
2023-04-24 16:24:47,350 - Detection - ***** Test: Confusion Matrix *****
2023-04-24 16:24:47,351 - Detection - [[ 76   2   0   0   0   0   0   0   0   0   4   0   0   0   0  46]
 [  0  99   1   1   0   0   0   0   0   0   0   0   0   0   0  26]
 [  0   0  85   0   0   0   0   0   0   0   0   0   1   0   0  36]
 [  1   0   0 109   2   0   1   0   0   0   0   1   0   0   0  57]
 [  0   0   0   1  46   0   2   0   0   0   0   2   0   0   0  55]
 [  0   0   0   0   0  95   0   0   0   0   0   1   0   0   0  32]
 [  0   0   1   0   1   0 117   0   2   1   0   0   0   0   0  71]
 [  0   0   2   0   0   0   5  82   0   0   0   1   0   0   0  49]
 [  0   0   1   0   0   0   0   0 148   0   0   0   0   0   0  23]
 [  0   0   0   0   0   1   0   1   0  95   0   1   0   1   0  71]
 [  4   0   0   0   0   0   0   0   0   0 110   0   0   0   0  37]
 [  0   0   0   1   1   0   0   0   0   0   0 111   0   1   0  46]
 [  0   0   1   0   0   0   0   0   0   0   1   0  75   0   0  47]
 [  0   0   0   0   0   0   0   0   0   2   0   0   0 104   0  31]
 [  0   0   0   0   0   0   0   0   0   0   0   0   1   0 101  29]
 [  1   7   2   3  36   2  97   7   4   4   1   5  22   0   0 555]]
2023-04-24 16:24:47,351 - Detection - ***** Test results *****
2023-04-24 16:24:47,351 - Detection -   Acc = 69.12
2023-04-24 16:24:47,351 - Detection -   F1 = 74.3962
2023-04-24 16:24:47,351 - Detection -   F1-known = 75.5746
2023-04-24 16:24:47,351 - Detection -   F1-open = 56.7195
2023-04-24 16:24:47,351 - Detection - Testing finished...
2023-04-24 16:24:47,351 - Detection - Results saved in results/results_ADB-BOOST-F-10.csv
2023-04-24 16:24:47,370 - Detection - Open Intent Detection Finished...
