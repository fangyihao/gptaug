2023-04-23 21:52:03,548 - Detection - Open Intent Detection Begin...
2023-04-23 21:52:03,548 - Detection - Parameters Initialization...
2023-04-23 21:52:03,548 - Detection - ============================== Params ==============================
2023-04-23 21:52:03,548 - Detection - type:	open_intent_detection
2023-04-23 21:52:03,548 - Detection - logger_name:	Detection
2023-04-23 21:52:03,548 - Detection - log_dir:	logs
2023-04-23 21:52:03,548 - Detection - dataset:	stackoverflow_cg
2023-04-23 21:52:03,548 - Detection - known_cls_ratio:	0.25
2023-04-23 21:52:03,548 - Detection - labeled_ratio:	1.0
2023-04-23 21:52:03,548 - Detection - method:	ADB
2023-04-23 21:52:03,548 - Detection - train:	True
2023-04-23 21:52:03,548 - Detection - pretrain:	True
2023-04-23 21:52:03,549 - Detection - save_model:	False
2023-04-23 21:52:03,549 - Detection - backbone:	bert_boost
2023-04-23 21:52:03,549 - Detection - config_file_name:	ADB
2023-04-23 21:52:03,549 - Detection - seed:	7
2023-04-23 21:52:03,549 - Detection - gpu_id:	0
2023-04-23 21:52:03,549 - Detection - pipe_results_path:	pipe_results
2023-04-23 21:52:03,549 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-23 21:52:03,549 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-23 21:52:03,549 - Detection - model_dir:	models
2023-04-23 21:52:03,549 - Detection - load_pretrained_method:	None
2023-04-23 21:52:03,549 - Detection - result_dir:	results
2023-04-23 21:52:03,549 - Detection - results_file_name:	results_ADB-BOOST-F-4.csv
2023-04-23 21:52:03,549 - Detection - save_results:	True
2023-04-23 21:52:03,549 - Detection - loss_fct:	CrossEntropyLoss
2023-04-23 21:52:03,549 - Detection - boost_method:	F-4
2023-04-23 21:52:03,549 - Detection - boost_start_score:	0.0
2023-04-23 21:52:03,549 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.25_1.0_bert_boost_7
2023-04-23 21:52:03,549 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.25_1.0_bert_boost_7/models
2023-04-23 21:52:03,549 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-23 21:52:03,549 - Detection - num_train_epochs:	100
2023-04-23 21:52:03,549 - Detection - num_labels:	None
2023-04-23 21:52:03,549 - Detection - max_seq_length:	None
2023-04-23 21:52:03,549 - Detection - freeze_backbone_parameters:	True
2023-04-23 21:52:03,549 - Detection - feat_dim:	768
2023-04-23 21:52:03,549 - Detection - warmup_proportion:	0.1
2023-04-23 21:52:03,549 - Detection - lr_boundary:	0.05
2023-04-23 21:52:03,549 - Detection - lr:	2e-05
2023-04-23 21:52:03,549 - Detection - activation:	relu
2023-04-23 21:52:03,549 - Detection - train_batch_size:	128
2023-04-23 21:52:03,549 - Detection - eval_batch_size:	64
2023-04-23 21:52:03,549 - Detection - test_batch_size:	64
2023-04-23 21:52:03,549 - Detection - wait_patient:	10
2023-04-23 21:52:03,549 - Detection - ============================== End Params ==============================
2023-04-23 21:52:03,549 - Detection - Data and Model Preparation...
2023-04-23 21:52:03,550 - Detection - The number of known intents is 5
2023-04-23 21:52:03,550 - Detection - Lists of known labels are: ['apache', 'svn', 'bash', 'excel', 'oracle']
2023-04-23 21:52:03,557 - Detection - Number of labeled training samples = 593
2023-04-23 21:52:03,557 - Detection - Number of unlabeled training samples = 2198
2023-04-23 21:52:03,559 - Detection - Number of evaluation samples = 368
2023-04-23 21:52:03,565 - Detection - Number of testing samples = 2905
2023-04-23 21:52:07,432 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-23 21:52:09,131 - Detection - Pre-training Begin...
2023-04-23 21:52:10,501 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 21:52:10,501 - Detection -   best_eval_score = 0
2023-04-23 21:52:10,501 - Detection -   eval_score = 21.47
2023-04-23 21:52:10,501 - Detection -   train_loss = 1.6107864856719971
2023-04-23 21:52:14,190 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 21:52:14,190 - Detection -   best_eval_score = 21.47
2023-04-23 21:52:14,190 - Detection -   eval_score = 27.99
2023-04-23 21:52:14,190 - Detection -   train_loss = 1.606118083000183
2023-04-23 21:52:17,973 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 21:52:17,974 - Detection -   best_eval_score = 27.99
2023-04-23 21:52:17,974 - Detection -   eval_score = 60.87
2023-04-23 21:52:17,974 - Detection -   train_loss = 1.524963116645813
2023-04-23 21:52:21,657 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 21:52:21,658 - Detection -   best_eval_score = 60.87
2023-04-23 21:52:21,658 - Detection -   eval_score = 77.45
2023-04-23 21:52:21,658 - Detection -   train_loss = 1.333361530303955
2023-04-23 21:52:25,358 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 21:52:25,358 - Detection -   best_eval_score = 77.45
2023-04-23 21:52:25,358 - Detection -   eval_score = 85.6
2023-04-23 21:52:25,358 - Detection -   train_loss = 0.9096467018127441
2023-04-23 21:52:29,095 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 21:52:29,095 - Detection -   best_eval_score = 85.6
2023-04-23 21:52:29,095 - Detection -   eval_score = 85.87
2023-04-23 21:52:29,095 - Detection -   train_loss = 0.5722569465637207
2023-04-23 21:52:32,800 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 21:52:32,801 - Detection -   best_eval_score = 85.87
2023-04-23 21:52:32,801 - Detection -   eval_score = 88.04
2023-04-23 21:52:32,801 - Detection -   train_loss = 0.43581604957580566
2023-04-23 21:52:36,591 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 21:52:36,591 - Detection -   best_eval_score = 88.04
2023-04-23 21:52:36,591 - Detection -   eval_score = 88.59
2023-04-23 21:52:36,591 - Detection -   train_loss = 0.3322773277759552
2023-04-23 21:52:40,305 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 21:52:40,305 - Detection -   best_eval_score = 88.59
2023-04-23 21:52:40,305 - Detection -   eval_score = 88.59
2023-04-23 21:52:40,305 - Detection -   train_loss = 0.2596587061882019
2023-04-23 21:52:43,998 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 21:52:43,998 - Detection -   best_eval_score = 88.59
2023-04-23 21:52:43,998 - Detection -   eval_score = 88.32
2023-04-23 21:52:43,998 - Detection -   train_loss = 0.1824101537466049
2023-04-23 21:52:47,714 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 21:52:47,715 - Detection -   best_eval_score = 88.59
2023-04-23 21:52:47,715 - Detection -   eval_score = 89.13
2023-04-23 21:52:47,715 - Detection -   train_loss = 0.11930208653211594
2023-04-23 21:52:51,438 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 21:52:51,438 - Detection -   best_eval_score = 89.13
2023-04-23 21:52:51,438 - Detection -   eval_score = 88.86
2023-04-23 21:52:51,438 - Detection -   train_loss = 0.09654041975736619
2023-04-23 21:52:55,257 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 21:52:55,258 - Detection -   best_eval_score = 89.13
2023-04-23 21:52:55,258 - Detection -   eval_score = 89.95
2023-04-23 21:52:55,258 - Detection -   train_loss = 0.07763762399554253
2023-04-23 21:52:58,954 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 21:52:58,954 - Detection -   best_eval_score = 89.95
2023-04-23 21:52:58,954 - Detection -   eval_score = 88.59
2023-04-23 21:52:58,954 - Detection -   train_loss = 0.07036068886518479
2023-04-23 21:53:02,648 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 21:53:02,648 - Detection -   best_eval_score = 89.95
2023-04-23 21:53:02,648 - Detection -   eval_score = 88.59
2023-04-23 21:53:02,648 - Detection -   train_loss = 0.05797897726297378
2023-04-23 21:53:06,331 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 21:53:06,331 - Detection -   best_eval_score = 89.95
2023-04-23 21:53:06,331 - Detection -   eval_score = 89.95
2023-04-23 21:53:06,331 - Detection -   train_loss = 0.053659604489803316
2023-04-23 21:53:10,031 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 21:53:10,031 - Detection -   best_eval_score = 89.95
2023-04-23 21:53:10,031 - Detection -   eval_score = 89.4
2023-04-23 21:53:10,031 - Detection -   train_loss = 0.03708023875951767
2023-04-23 21:53:13,837 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 21:53:13,837 - Detection -   best_eval_score = 89.95
2023-04-23 21:53:13,837 - Detection -   eval_score = 88.32
2023-04-23 21:53:13,838 - Detection -   train_loss = 0.024129811301827432
2023-04-23 21:53:17,539 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 21:53:17,539 - Detection -   best_eval_score = 89.95
2023-04-23 21:53:17,539 - Detection -   eval_score = 89.13
2023-04-23 21:53:17,539 - Detection -   train_loss = 0.029425667971372603
2023-04-23 21:53:21,298 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 21:53:21,298 - Detection -   best_eval_score = 89.95
2023-04-23 21:53:21,298 - Detection -   eval_score = 88.86
2023-04-23 21:53:21,298 - Detection -   train_loss = 0.03431472107768059
2023-04-23 21:53:24,962 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 21:53:24,962 - Detection -   best_eval_score = 89.95
2023-04-23 21:53:24,962 - Detection -   eval_score = 88.32
2023-04-23 21:53:24,962 - Detection -   train_loss = 0.02686677686870098
2023-04-23 21:53:28,637 - Detection - ***** Epoch: 22: Eval results *****
2023-04-23 21:53:28,637 - Detection -   best_eval_score = 89.95
2023-04-23 21:53:28,637 - Detection -   eval_score = 88.86
2023-04-23 21:53:28,637 - Detection -   train_loss = 0.019762165471911432
2023-04-23 21:53:32,351 - Detection - ***** Epoch: 23: Eval results *****
2023-04-23 21:53:32,351 - Detection -   best_eval_score = 89.95
2023-04-23 21:53:32,351 - Detection -   eval_score = 88.86
2023-04-23 21:53:32,351 - Detection -   train_loss = 0.013845234364271163
2023-04-23 21:53:32,351 - Detection - Pre-training finished...
2023-04-23 21:53:32,352 - Detection - Training Begin...
2023-04-23 21:53:33,333 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 21:53:33,333 - Detection -   best_eval_score = 0
2023-04-23 21:53:33,333 - Detection -   eval_score = 0.0
2023-04-23 21:53:33,333 - Detection -   train_loss = 7.967975711822509
2023-04-23 21:53:33,957 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 21:53:33,958 - Detection -   best_eval_score = 0
2023-04-23 21:53:33,958 - Detection -   eval_score = 0.0
2023-04-23 21:53:33,958 - Detection -   train_loss = 7.737144851684571
2023-04-23 21:53:34,582 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 21:53:34,582 - Detection -   best_eval_score = 0
2023-04-23 21:53:34,582 - Detection -   eval_score = 0.0
2023-04-23 21:53:34,582 - Detection -   train_loss = 7.668899631500244
2023-04-23 21:53:35,205 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 21:53:35,205 - Detection -   best_eval_score = 0
2023-04-23 21:53:35,206 - Detection -   eval_score = 0.0
2023-04-23 21:53:35,206 - Detection -   train_loss = 7.532256984710694
2023-04-23 21:53:35,829 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 21:53:35,829 - Detection -   best_eval_score = 0
2023-04-23 21:53:35,829 - Detection -   eval_score = 0.0
2023-04-23 21:53:35,829 - Detection -   train_loss = 7.284009265899658
2023-04-23 21:53:36,453 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 21:53:36,453 - Detection -   best_eval_score = 0
2023-04-23 21:53:36,454 - Detection -   eval_score = 0.0
2023-04-23 21:53:36,454 - Detection -   train_loss = 7.125934410095215
2023-04-23 21:53:37,077 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 21:53:37,077 - Detection -   best_eval_score = 0
2023-04-23 21:53:37,077 - Detection -   eval_score = 0.0
2023-04-23 21:53:37,077 - Detection -   train_loss = 6.8333111763000485
2023-04-23 21:53:37,701 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 21:53:37,701 - Detection -   best_eval_score = 0
2023-04-23 21:53:37,702 - Detection -   eval_score = 0.0
2023-04-23 21:53:37,702 - Detection -   train_loss = 6.647791481018066
2023-04-23 21:53:38,328 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 21:53:38,328 - Detection -   best_eval_score = 0
2023-04-23 21:53:38,328 - Detection -   eval_score = 0.0
2023-04-23 21:53:38,328 - Detection -   train_loss = 6.4201713562011715
2023-04-23 21:53:38,951 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 21:53:38,952 - Detection -   best_eval_score = 0
2023-04-23 21:53:38,952 - Detection -   eval_score = 0.41
2023-04-23 21:53:38,952 - Detection -   train_loss = 6.1860535621643065
2023-04-23 21:53:42,726 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 21:53:42,727 - Detection -   best_eval_score = 0.41
2023-04-23 21:53:42,727 - Detection -   eval_score = 18.74
2023-04-23 21:53:42,727 - Detection -   train_loss = 5.829647827148437
2023-04-23 21:53:46,389 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 21:53:46,389 - Detection -   best_eval_score = 18.74
2023-04-23 21:53:46,389 - Detection -   eval_score = 60.07
2023-04-23 21:53:46,389 - Detection -   train_loss = 4.545098876953125
2023-04-23 21:53:50,088 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 21:53:50,088 - Detection -   best_eval_score = 60.07
2023-04-23 21:53:50,088 - Detection -   eval_score = 69.96
2023-04-23 21:53:50,088 - Detection -   train_loss = 3.232207441329956
2023-04-23 21:53:53,773 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 21:53:53,773 - Detection -   best_eval_score = 69.96
2023-04-23 21:53:53,773 - Detection -   eval_score = 72.31
2023-04-23 21:53:53,773 - Detection -   train_loss = 1.8777557849884032
2023-04-23 21:53:57,468 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 21:53:57,468 - Detection -   best_eval_score = 72.31
2023-04-23 21:53:57,468 - Detection -   eval_score = 73.19
2023-04-23 21:53:57,468 - Detection -   train_loss = 1.351208543777466
2023-04-23 21:54:01,238 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 21:54:01,238 - Detection -   best_eval_score = 73.19
2023-04-23 21:54:01,238 - Detection -   eval_score = 73.05
2023-04-23 21:54:01,238 - Detection -   train_loss = 1.2426686525344848
2023-04-23 21:54:04,899 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 21:54:04,899 - Detection -   best_eval_score = 73.19
2023-04-23 21:54:04,899 - Detection -   eval_score = 73.05
2023-04-23 21:54:04,899 - Detection -   train_loss = 1.2206011295318604
2023-04-23 21:54:08,602 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 21:54:08,602 - Detection -   best_eval_score = 73.19
2023-04-23 21:54:08,602 - Detection -   eval_score = 73.05
2023-04-23 21:54:08,602 - Detection -   train_loss = 1.1830606698989867
2023-04-23 21:54:12,325 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 21:54:12,325 - Detection -   best_eval_score = 73.19
2023-04-23 21:54:12,325 - Detection -   eval_score = 73.05
2023-04-23 21:54:12,325 - Detection -   train_loss = 1.2849442958831787
2023-04-23 21:54:15,985 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 21:54:15,985 - Detection -   best_eval_score = 73.19
2023-04-23 21:54:15,985 - Detection -   eval_score = 73.05
2023-04-23 21:54:15,985 - Detection -   train_loss = 1.300683069229126
2023-04-23 21:54:19,883 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 21:54:19,883 - Detection -   best_eval_score = 73.19
2023-04-23 21:54:19,883 - Detection -   eval_score = 73.05
2023-04-23 21:54:19,883 - Detection -   train_loss = 1.2917983293533326
2023-04-23 21:54:23,550 - Detection - ***** Epoch: 22: Eval results *****
2023-04-23 21:54:23,550 - Detection -   best_eval_score = 73.19
2023-04-23 21:54:23,550 - Detection -   eval_score = 73.05
2023-04-23 21:54:23,550 - Detection -   train_loss = 1.2587100982666015
2023-04-23 21:54:27,276 - Detection - ***** Epoch: 23: Eval results *****
2023-04-23 21:54:27,276 - Detection -   best_eval_score = 73.19
2023-04-23 21:54:27,276 - Detection -   eval_score = 73.05
2023-04-23 21:54:27,276 - Detection -   train_loss = 1.2830585718154908
2023-04-23 21:54:30,946 - Detection - ***** Epoch: 24: Eval results *****
2023-04-23 21:54:30,946 - Detection -   best_eval_score = 73.19
2023-04-23 21:54:30,946 - Detection -   eval_score = 73.05
2023-04-23 21:54:30,946 - Detection -   train_loss = 1.2082050561904907
2023-04-23 21:54:34,620 - Detection - ***** Epoch: 25: Eval results *****
2023-04-23 21:54:34,620 - Detection -   best_eval_score = 73.19
2023-04-23 21:54:34,620 - Detection -   eval_score = 73.05
2023-04-23 21:54:34,620 - Detection -   train_loss = 1.2604387998580933
2023-04-23 21:54:34,621 - Detection - Training Finished...
2023-04-23 21:54:34,621 - Detection - Testing begin...
2023-04-23 21:54:36,369 - Detection - ***** Test: Confusion Matrix *****
2023-04-23 21:54:36,369 - Detection - [[ 102    1    1    0    0   66]
 [   3  110    0    0    0   36]
 [   3    0   93    0    0   43]
 [   1    0    1   97    1   40]
 [   0    0    2    0   97   28]
 [ 176   32   55   55  121 1741]]
2023-04-23 21:54:36,369 - Detection - ***** Test results *****
2023-04-23 21:54:36,369 - Detection -   Acc = 77.11
2023-04-23 21:54:36,369 - Detection -   F1 = 65.1385
2023-04-23 21:54:36,369 - Detection -   F1-known = 61.3206
2023-04-23 21:54:36,369 - Detection -   F1-open = 84.2284
2023-04-23 21:54:36,369 - Detection - Testing finished...
2023-04-23 21:54:36,369 - Detection - Results saved in results/results_ADB-BOOST-F-4.csv
2023-04-23 21:54:36,388 - Detection - Open Intent Detection Finished...
