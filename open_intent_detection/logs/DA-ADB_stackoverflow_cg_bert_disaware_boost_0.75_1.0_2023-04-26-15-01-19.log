2023-04-26 15:01:19,489 - Detection - Open Intent Detection Begin...
2023-04-26 15:01:19,490 - Detection - Parameters Initialization...
2023-04-26 15:01:19,490 - Detection - ============================== Params ==============================
2023-04-26 15:01:19,490 - Detection - type:	open_intent_detection
2023-04-26 15:01:19,490 - Detection - logger_name:	Detection
2023-04-26 15:01:19,490 - Detection - log_dir:	logs
2023-04-26 15:01:19,490 - Detection - dataset:	stackoverflow_cg
2023-04-26 15:01:19,490 - Detection - known_cls_ratio:	0.75
2023-04-26 15:01:19,490 - Detection - labeled_ratio:	1.0
2023-04-26 15:01:19,490 - Detection - method:	DA-ADB
2023-04-26 15:01:19,490 - Detection - train:	True
2023-04-26 15:01:19,490 - Detection - pretrain:	True
2023-04-26 15:01:19,490 - Detection - save_model:	False
2023-04-26 15:01:19,490 - Detection - backbone:	bert_disaware_boost
2023-04-26 15:01:19,490 - Detection - config_file_name:	DA-ADB
2023-04-26 15:01:19,490 - Detection - seed:	9
2023-04-26 15:01:19,490 - Detection - gpu_id:	0
2023-04-26 15:01:19,490 - Detection - pipe_results_path:	pipe_results
2023-04-26 15:01:19,490 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-26 15:01:19,490 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-26 15:01:19,490 - Detection - model_dir:	models
2023-04-26 15:01:19,490 - Detection - load_pretrained_method:	None
2023-04-26 15:01:19,490 - Detection - result_dir:	results
2023-04-26 15:01:19,490 - Detection - results_file_name:	results_DA-ADB-BOOST-F-10.csv
2023-04-26 15:01:19,490 - Detection - save_results:	True
2023-04-26 15:01:19,490 - Detection - loss_fct:	CrossEntropyLoss
2023-04-26 15:01:19,490 - Detection - boost_method:	F-10
2023-04-26 15:01:19,490 - Detection - boost_start_score:	0.0
2023-04-26 15:01:19,490 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.75_1.0_bert_disaware_boost_9
2023-04-26 15:01:19,490 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.75_1.0_bert_disaware_boost_9/models
2023-04-26 15:01:19,490 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-26 15:01:19,490 - Detection - num_train_epochs:	100
2023-04-26 15:01:19,490 - Detection - num_labels:	None
2023-04-26 15:01:19,490 - Detection - max_seq_length:	None
2023-04-26 15:01:19,490 - Detection - freeze_backbone_parameters:	True
2023-04-26 15:01:19,490 - Detection - feat_dim:	768
2023-04-26 15:01:19,491 - Detection - warmup_proportion:	0.1
2023-04-26 15:01:19,491 - Detection - scale:	4
2023-04-26 15:01:19,491 - Detection - lr_boundary:	0.05
2023-04-26 15:01:19,491 - Detection - lr:	2e-05
2023-04-26 15:01:19,491 - Detection - activation:	relu
2023-04-26 15:01:19,491 - Detection - train_batch_size:	128
2023-04-26 15:01:19,491 - Detection - eval_batch_size:	64
2023-04-26 15:01:19,491 - Detection - test_batch_size:	64
2023-04-26 15:01:19,491 - Detection - wait_patient:	10
2023-04-26 15:01:19,491 - Detection - ============================== End Params ==============================
2023-04-26 15:01:19,491 - Detection - Data and Model Preparation...
2023-04-26 15:01:19,491 - Detection - The number of known intents is 15
2023-04-26 15:01:19,491 - Detection - Lists of known labels are: ['cocoa', 'haskell', 'hibernate', 'excel', 'spring', 'sharepoint', 'bash', 'drupal', 'magento', 'matlab', 'visual-studio', 'oracle', 'scala', 'ajax', 'osx']
2023-04-26 15:01:19,502 - Detection - Number of labeled training samples = 2125
2023-04-26 15:01:19,502 - Detection - Number of unlabeled training samples = 666
2023-04-26 15:01:19,505 - Detection - Number of evaluation samples = 1048
2023-04-26 15:01:19,510 - Detection - Number of testing samples = 2905
2023-04-26 15:01:25,132 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-26 15:01:25,212 - Detection - Pre-training Begin...
2023-04-26 15:01:30,196 - Detection - ***** Epoch: 1: Eval results *****
2023-04-26 15:01:30,196 - Detection -   best_eval_score = 0
2023-04-26 15:01:30,196 - Detection -   eval_score = 1.55
2023-04-26 15:01:30,196 - Detection -   train_loss = 2.7214240887585808
2023-04-26 15:02:03,321 - Detection - ***** Epoch: 2: Eval results *****
2023-04-26 15:02:03,322 - Detection -   best_eval_score = 1.55
2023-04-26 15:02:03,322 - Detection -   eval_score = 1.99
2023-04-26 15:02:03,322 - Detection -   train_loss = 2.697884265114279
2023-04-26 15:02:36,249 - Detection - ***** Epoch: 3: Eval results *****
2023-04-26 15:02:36,250 - Detection -   best_eval_score = 1.99
2023-04-26 15:02:36,250 - Detection -   eval_score = 19.83
2023-04-26 15:02:36,250 - Detection -   train_loss = 2.5806967230404125
2023-04-26 15:03:09,390 - Detection - ***** Epoch: 4: Eval results *****
2023-04-26 15:03:09,390 - Detection -   best_eval_score = 19.83
2023-04-26 15:03:09,390 - Detection -   eval_score = 70.36
2023-04-26 15:03:09,390 - Detection -   train_loss = 2.330016627031214
2023-04-26 15:03:42,495 - Detection - ***** Epoch: 5: Eval results *****
2023-04-26 15:03:42,495 - Detection -   best_eval_score = 70.36
2023-04-26 15:03:42,495 - Detection -   eval_score = 78.12
2023-04-26 15:03:42,495 - Detection -   train_loss = 1.8492774402394014
2023-04-26 15:04:15,726 - Detection - ***** Epoch: 6: Eval results *****
2023-04-26 15:04:15,726 - Detection -   best_eval_score = 78.12
2023-04-26 15:04:15,726 - Detection -   eval_score = 80.28
2023-04-26 15:04:15,726 - Detection -   train_loss = 1.442432915463167
2023-04-26 15:04:48,736 - Detection - ***** Epoch: 7: Eval results *****
2023-04-26 15:04:48,736 - Detection -   best_eval_score = 80.28
2023-04-26 15:04:48,736 - Detection -   eval_score = 80.84
2023-04-26 15:04:48,736 - Detection -   train_loss = 1.2362460739472334
2023-04-26 15:05:21,810 - Detection - ***** Epoch: 8: Eval results *****
2023-04-26 15:05:21,810 - Detection -   best_eval_score = 80.84
2023-04-26 15:05:21,810 - Detection -   eval_score = 80.19
2023-04-26 15:05:21,810 - Detection -   train_loss = 1.1167087835424088
2023-04-26 15:05:55,009 - Detection - ***** Epoch: 9: Eval results *****
2023-04-26 15:05:55,009 - Detection -   best_eval_score = 80.84
2023-04-26 15:05:55,009 - Detection -   eval_score = 79.99
2023-04-26 15:05:55,009 - Detection -   train_loss = 1.0175704324946684
2023-04-26 15:06:28,242 - Detection - ***** Epoch: 10: Eval results *****
2023-04-26 15:06:28,242 - Detection -   best_eval_score = 80.84
2023-04-26 15:06:28,242 - Detection -   eval_score = 80.44
2023-04-26 15:06:28,242 - Detection -   train_loss = 0.9368775486946106
2023-04-26 15:07:01,351 - Detection - ***** Epoch: 11: Eval results *****
2023-04-26 15:07:01,351 - Detection -   best_eval_score = 80.84
2023-04-26 15:07:01,351 - Detection -   eval_score = 79.51
2023-04-26 15:07:01,351 - Detection -   train_loss = 0.8478307022767908
2023-04-26 15:07:34,543 - Detection - ***** Epoch: 12: Eval results *****
2023-04-26 15:07:34,543 - Detection -   best_eval_score = 80.84
2023-04-26 15:07:34,543 - Detection -   eval_score = 79.72
2023-04-26 15:07:34,543 - Detection -   train_loss = 0.7726306810098535
2023-04-26 15:08:07,619 - Detection - ***** Epoch: 13: Eval results *****
2023-04-26 15:08:07,619 - Detection -   best_eval_score = 80.84
2023-04-26 15:08:07,619 - Detection -   eval_score = 80.36
2023-04-26 15:08:07,619 - Detection -   train_loss = 0.7093129929374246
2023-04-26 15:08:40,596 - Detection - ***** Epoch: 14: Eval results *****
2023-04-26 15:08:40,596 - Detection -   best_eval_score = 80.84
2023-04-26 15:08:40,596 - Detection -   eval_score = 79.91
2023-04-26 15:08:40,596 - Detection -   train_loss = 0.6512326422859641
2023-04-26 15:09:13,714 - Detection - ***** Epoch: 15: Eval results *****
2023-04-26 15:09:13,714 - Detection -   best_eval_score = 80.84
2023-04-26 15:09:13,714 - Detection -   eval_score = 79.61
2023-04-26 15:09:13,714 - Detection -   train_loss = 0.6084685080191669
2023-04-26 15:09:46,805 - Detection - ***** Epoch: 16: Eval results *****
2023-04-26 15:09:46,806 - Detection -   best_eval_score = 80.84
2023-04-26 15:09:46,806 - Detection -   eval_score = 79.57
2023-04-26 15:09:46,806 - Detection -   train_loss = 0.5687719197834239
2023-04-26 15:10:19,813 - Detection - ***** Epoch: 17: Eval results *****
2023-04-26 15:10:19,813 - Detection -   best_eval_score = 80.84
2023-04-26 15:10:19,813 - Detection -   eval_score = 79.09
2023-04-26 15:10:19,813 - Detection -   train_loss = 0.5369251756107106
2023-04-26 15:10:19,813 - Detection - Pre-training finished...
2023-04-26 15:10:19,813 - Detection - Training Begin...
2023-04-26 15:10:22,624 - Detection - ***** Epoch: 1: Eval results *****
2023-04-26 15:10:22,624 - Detection -   best_eval_score = 0
2023-04-26 15:10:22,625 - Detection -   eval_score = 0.0
2023-04-26 15:10:22,625 - Detection -   train_loss = 4.004617256276748
2023-04-26 15:10:25,437 - Detection - ***** Epoch: 2: Eval results *****
2023-04-26 15:10:25,438 - Detection -   best_eval_score = 0
2023-04-26 15:10:25,438 - Detection -   eval_score = 0.36
2023-04-26 15:10:25,438 - Detection -   train_loss = 3.4512625021093033
2023-04-26 15:10:56,799 - Detection - ***** Epoch: 3: Eval results *****
2023-04-26 15:10:56,799 - Detection -   best_eval_score = 0.36
2023-04-26 15:10:56,799 - Detection -   eval_score = 69.01
2023-04-26 15:10:56,799 - Detection -   train_loss = 2.748785313437967
2023-04-26 15:11:27,837 - Detection - ***** Epoch: 4: Eval results *****
2023-04-26 15:11:27,837 - Detection -   best_eval_score = 69.01
2023-04-26 15:11:27,837 - Detection -   eval_score = 69.1
2023-04-26 15:11:27,837 - Detection -   train_loss = 0.9224244145786061
2023-04-26 15:11:59,036 - Detection - ***** Epoch: 5: Eval results *****
2023-04-26 15:11:59,036 - Detection -   best_eval_score = 69.1
2023-04-26 15:11:59,036 - Detection -   eval_score = 68.67
2023-04-26 15:11:59,036 - Detection -   train_loss = 0.8948070266667534
2023-04-26 15:12:30,083 - Detection - ***** Epoch: 6: Eval results *****
2023-04-26 15:12:30,083 - Detection -   best_eval_score = 69.1
2023-04-26 15:12:30,083 - Detection -   eval_score = 68.85
2023-04-26 15:12:30,083 - Detection -   train_loss = 0.8823216101702522
2023-04-26 15:13:01,224 - Detection - ***** Epoch: 7: Eval results *****
2023-04-26 15:13:01,224 - Detection -   best_eval_score = 69.1
2023-04-26 15:13:01,224 - Detection -   eval_score = 69.34
2023-04-26 15:13:01,224 - Detection -   train_loss = 0.9177329224698684
2023-04-26 15:13:32,242 - Detection - ***** Epoch: 8: Eval results *****
2023-04-26 15:13:32,242 - Detection -   best_eval_score = 69.34
2023-04-26 15:13:32,242 - Detection -   eval_score = 68.36
2023-04-26 15:13:32,242 - Detection -   train_loss = 0.9091219972161686
2023-04-26 15:14:03,382 - Detection - ***** Epoch: 9: Eval results *****
2023-04-26 15:14:03,382 - Detection -   best_eval_score = 69.34
2023-04-26 15:14:03,382 - Detection -   eval_score = 69.1
2023-04-26 15:14:03,382 - Detection -   train_loss = 0.9133451125201058
2023-04-26 15:14:34,423 - Detection - ***** Epoch: 10: Eval results *****
2023-04-26 15:14:34,423 - Detection -   best_eval_score = 69.34
2023-04-26 15:14:34,423 - Detection -   eval_score = 68.98
2023-04-26 15:14:34,423 - Detection -   train_loss = 0.9446297813864315
2023-04-26 15:15:05,454 - Detection - ***** Epoch: 11: Eval results *****
2023-04-26 15:15:05,454 - Detection -   best_eval_score = 69.34
2023-04-26 15:15:05,454 - Detection -   eval_score = 68.97
2023-04-26 15:15:05,454 - Detection -   train_loss = 0.9125507228514728
2023-04-26 15:15:36,617 - Detection - ***** Epoch: 12: Eval results *****
2023-04-26 15:15:36,618 - Detection -   best_eval_score = 69.34
2023-04-26 15:15:36,618 - Detection -   eval_score = 68.54
2023-04-26 15:15:36,618 - Detection -   train_loss = 0.9304153814035303
2023-04-26 15:16:07,647 - Detection - ***** Epoch: 13: Eval results *****
2023-04-26 15:16:07,647 - Detection -   best_eval_score = 69.34
2023-04-26 15:16:07,647 - Detection -   eval_score = 69.13
2023-04-26 15:16:07,647 - Detection -   train_loss = 0.8964426762917462
2023-04-26 15:16:38,764 - Detection - ***** Epoch: 14: Eval results *****
2023-04-26 15:16:38,764 - Detection -   best_eval_score = 69.34
2023-04-26 15:16:38,764 - Detection -   eval_score = 69.33
2023-04-26 15:16:38,764 - Detection -   train_loss = 0.9209717652376961
2023-04-26 15:17:09,764 - Detection - ***** Epoch: 15: Eval results *****
2023-04-26 15:17:09,764 - Detection -   best_eval_score = 69.34
2023-04-26 15:17:09,764 - Detection -   eval_score = 69.04
2023-04-26 15:17:09,764 - Detection -   train_loss = 0.9001389987328473
2023-04-26 15:17:41,071 - Detection - ***** Epoch: 16: Eval results *****
2023-04-26 15:17:41,071 - Detection -   best_eval_score = 69.34
2023-04-26 15:17:41,071 - Detection -   eval_score = 69.52
2023-04-26 15:17:41,071 - Detection -   train_loss = 0.900852340109208
2023-04-26 15:18:12,219 - Detection - ***** Epoch: 17: Eval results *****
2023-04-26 15:18:12,219 - Detection -   best_eval_score = 69.52
2023-04-26 15:18:12,219 - Detection -   eval_score = 69.22
2023-04-26 15:18:12,219 - Detection -   train_loss = 0.8954032940023086
2023-04-26 15:18:43,231 - Detection - ***** Epoch: 18: Eval results *****
2023-04-26 15:18:43,232 - Detection -   best_eval_score = 69.52
2023-04-26 15:18:43,232 - Detection -   eval_score = 68.87
2023-04-26 15:18:43,232 - Detection -   train_loss = 0.8766905735520756
2023-04-26 15:19:14,249 - Detection - ***** Epoch: 19: Eval results *****
2023-04-26 15:19:14,250 - Detection -   best_eval_score = 69.52
2023-04-26 15:19:14,250 - Detection -   eval_score = 69.27
2023-04-26 15:19:14,250 - Detection -   train_loss = 0.8701291785520666
2023-04-26 15:19:45,318 - Detection - ***** Epoch: 20: Eval results *****
2023-04-26 15:19:45,319 - Detection -   best_eval_score = 69.52
2023-04-26 15:19:45,319 - Detection -   eval_score = 68.54
2023-04-26 15:19:45,319 - Detection -   train_loss = 0.9429210950346554
2023-04-26 15:20:16,502 - Detection - ***** Epoch: 21: Eval results *****
2023-04-26 15:20:16,503 - Detection -   best_eval_score = 69.52
2023-04-26 15:20:16,503 - Detection -   eval_score = 69.23
2023-04-26 15:20:16,503 - Detection -   train_loss = 0.8813966687987832
2023-04-26 15:20:47,678 - Detection - ***** Epoch: 22: Eval results *****
2023-04-26 15:20:47,678 - Detection -   best_eval_score = 69.52
2023-04-26 15:20:47,678 - Detection -   eval_score = 69.23
2023-04-26 15:20:47,679 - Detection -   train_loss = 0.9194358902819016
2023-04-26 15:21:18,711 - Detection - ***** Epoch: 23: Eval results *****
2023-04-26 15:21:18,711 - Detection -   best_eval_score = 69.52
2023-04-26 15:21:18,711 - Detection -   eval_score = 68.74
2023-04-26 15:21:18,711 - Detection -   train_loss = 0.899350173333112
2023-04-26 15:21:49,784 - Detection - ***** Epoch: 24: Eval results *****
2023-04-26 15:21:49,784 - Detection -   best_eval_score = 69.52
2023-04-26 15:21:49,784 - Detection -   eval_score = 69.06
2023-04-26 15:21:49,784 - Detection -   train_loss = 0.9086251013419208
2023-04-26 15:22:20,832 - Detection - ***** Epoch: 25: Eval results *****
2023-04-26 15:22:20,832 - Detection -   best_eval_score = 69.52
2023-04-26 15:22:20,832 - Detection -   eval_score = 69.24
2023-04-26 15:22:20,832 - Detection -   train_loss = 0.9049040955655715
2023-04-26 15:22:51,910 - Detection - ***** Epoch: 26: Eval results *****
2023-04-26 15:22:51,910 - Detection -   best_eval_score = 69.52
2023-04-26 15:22:51,910 - Detection -   eval_score = 68.78
2023-04-26 15:22:51,910 - Detection -   train_loss = 0.9203555513830746
2023-04-26 15:22:51,910 - Detection - Training Finished...
2023-04-26 15:22:51,910 - Detection - Testing begin...
2023-04-26 15:22:54,305 - Detection - ***** Test: Confusion Matrix *****
2023-04-26 15:22:54,305 - Detection - [[ 88   7   0   0   6   7   2   2   1   0   0   1   1   0  22  24]
 [  0  65   0   2   3   2   2   0   1   2   0   0   2   0   2  41]
 [  3  10  85   0  10   1   2   2   0   0   0   5   1   0   1   8]
 [  3   9   0  91   0   6   1   0   0   1   1   1   6   1  11   9]
 [  0   4   4   0  88   1   0   0   0   0   0   0   1   0   4  49]
 [  0   1   0   1   1 143   4   2   0   0   5   1   1   1   3   8]
 [  6  17   0   0   1   1  74   2   0   1   0   0   4   1  11  21]
 [  1   5   0   0   0   7   0 110   0   0   0   0   2   2   1   0]
 [  3   5   0   0   1  12   0   2 105   0   0   0   0   0   1   3]
 [  5   8   0   0   0   0   1   0   0 135   0   0   5   1   3   6]
 [  8  10   0   1   2   9   1   7   0   0  44   2   1   1  18   2]
 [  0  11   0   0   0   5   1   3   0   0   0  99   0   0   4   4]
 [  0  18   0   0   5   1   1   0   0   0   0   0  84   0   1  14]
 [  1   9   1   1   1   9   1   5   0   0   1   0   1 118  10   2]
 [ 23   5   0   1   3   3   2   1   0   0   0   1   2   0 134  18]
 [ 28 177   1   7  33 135  67  40   4   3   8  22   7  39 139  49]]
2023-04-26 15:22:54,305 - Detection - ***** Test results *****
2023-04-26 15:22:54,305 - Detection -   Acc = 52.05
2023-04-26 15:22:54,305 - Detection -   F1 = 60.7697
2023-04-26 15:22:54,305 - Detection -   F1-known = 64.1786
2023-04-26 15:22:54,305 - Detection -   F1-open = 9.6362
2023-04-26 15:22:54,305 - Detection - Testing finished...
2023-04-26 15:22:54,305 - Detection - Results saved in results/results_DA-ADB-BOOST-F-10.csv
2023-04-26 15:22:54,321 - Detection - Open Intent Detection Finished...
