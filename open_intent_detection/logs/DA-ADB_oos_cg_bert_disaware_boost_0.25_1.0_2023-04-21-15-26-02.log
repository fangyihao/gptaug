2023-04-21 15:26:02,510 - Detection - Open Intent Detection Begin...
2023-04-21 15:26:02,510 - Detection - Parameters Initialization...
2023-04-21 15:26:02,510 - Detection - ============================== Params ==============================
2023-04-21 15:26:02,510 - Detection - type:	open_intent_detection
2023-04-21 15:26:02,511 - Detection - logger_name:	Detection
2023-04-21 15:26:02,511 - Detection - log_dir:	logs
2023-04-21 15:26:02,511 - Detection - dataset:	oos_cg
2023-04-21 15:26:02,511 - Detection - known_cls_ratio:	0.25
2023-04-21 15:26:02,511 - Detection - labeled_ratio:	1.0
2023-04-21 15:26:02,511 - Detection - method:	DA-ADB
2023-04-21 15:26:02,511 - Detection - train:	True
2023-04-21 15:26:02,511 - Detection - pretrain:	True
2023-04-21 15:26:02,511 - Detection - save_model:	False
2023-04-21 15:26:02,511 - Detection - backbone:	bert_disaware_boost
2023-04-21 15:26:02,511 - Detection - config_file_name:	DA-ADB
2023-04-21 15:26:02,511 - Detection - seed:	6
2023-04-21 15:26:02,511 - Detection - gpu_id:	0
2023-04-21 15:26:02,511 - Detection - pipe_results_path:	pipe_results
2023-04-21 15:26:02,511 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-21 15:26:02,511 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-21 15:26:02,511 - Detection - model_dir:	models
2023-04-21 15:26:02,511 - Detection - load_pretrained_method:	None
2023-04-21 15:26:02,511 - Detection - result_dir:	results
2023-04-21 15:26:02,511 - Detection - results_file_name:	results_DA-ADB-BOOST.csv
2023-04-21 15:26:02,511 - Detection - save_results:	True
2023-04-21 15:26:02,511 - Detection - loss_fct:	CrossEntropyLoss
2023-04-21 15:26:02,511 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_oos_cg_0.25_1.0_bert_disaware_boost_6
2023-04-21 15:26:02,511 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_oos_cg_0.25_1.0_bert_disaware_boost_6/models
2023-04-21 15:26:02,511 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-21 15:26:02,511 - Detection - num_train_epochs:	100
2023-04-21 15:26:02,511 - Detection - num_labels:	None
2023-04-21 15:26:02,511 - Detection - max_seq_length:	None
2023-04-21 15:26:02,511 - Detection - freeze_backbone_parameters:	True
2023-04-21 15:26:02,511 - Detection - feat_dim:	768
2023-04-21 15:26:02,511 - Detection - warmup_proportion:	0.1
2023-04-21 15:26:02,511 - Detection - scale:	4
2023-04-21 15:26:02,511 - Detection - lr_boundary:	0.05
2023-04-21 15:26:02,511 - Detection - lr:	2e-05
2023-04-21 15:26:02,511 - Detection - activation:	relu
2023-04-21 15:26:02,511 - Detection - train_batch_size:	128
2023-04-21 15:26:02,511 - Detection - eval_batch_size:	64
2023-04-21 15:26:02,511 - Detection - test_batch_size:	64
2023-04-21 15:26:02,511 - Detection - wait_patient:	10
2023-04-21 15:26:02,511 - Detection - ============================== End Params ==============================
2023-04-21 15:26:02,511 - Detection - Data and Model Preparation...
2023-04-21 15:26:02,512 - Detection - The number of known intents is 38
2023-04-21 15:26:02,512 - Detection - Lists of known labels are: ['apr', 'sync_device', 'alarm', 'change_speed', 'timezone', 'repeat', 'travel_suggestion', 'exchange_rate', 'user_name', 'improve_credit_score', 'todo_list_update', 'order_checks', 'spending_history', 'uber', 'next_holiday', 'text', 'roll_dice', 'how_busy', 'recipe', 'damaged_card', 'distance', 'thank_you', 'food_last', 'accept_reservations', 'ingredient_substitution', 'mpg', 'plug_type', 'restaurant_reviews', 'credit_score', 'redeem_rewards', 'freeze_account', 'interest_rate', 'cancel_reservation', 'calendar_update', 'travel_notification', 'traffic', 'lost_luggage', 'whisper_mode']
2023-04-21 15:26:02,521 - Detection - Number of labeled training samples = 930
2023-04-21 15:26:02,521 - Detection - Number of unlabeled training samples = 2753
2023-04-21 15:26:02,525 - Detection - Number of evaluation samples = 435
2023-04-21 15:26:02,532 - Detection - Number of testing samples = 3632
2023-04-21 15:26:08,112 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-21 15:26:08,195 - Detection - Pre-training Begin...
2023-04-21 15:26:10,088 - Detection - ***** Epoch: 1: Eval results *****
2023-04-21 15:26:10,088 - Detection -   best_eval_score = 0
2023-04-21 15:26:10,088 - Detection -   eval_score = 0.13
2023-04-21 15:26:10,088 - Detection -   train_loss = 3.6387124359607697
2023-04-21 15:26:21,279 - Detection - ***** Epoch: 2: Eval results *****
2023-04-21 15:26:21,279 - Detection -   best_eval_score = 0.13
2023-04-21 15:26:21,279 - Detection -   eval_score = 1.28
2023-04-21 15:26:21,279 - Detection -   train_loss = 3.612185448408127
2023-04-21 15:26:32,336 - Detection - ***** Epoch: 3: Eval results *****
2023-04-21 15:26:32,336 - Detection -   best_eval_score = 1.28
2023-04-21 15:26:32,336 - Detection -   eval_score = 14.35
2023-04-21 15:26:32,336 - Detection -   train_loss = 3.4132055044174194
2023-04-21 15:26:43,280 - Detection - ***** Epoch: 4: Eval results *****
2023-04-21 15:26:43,280 - Detection -   best_eval_score = 14.35
2023-04-21 15:26:43,280 - Detection -   eval_score = 31.06
2023-04-21 15:26:43,280 - Detection -   train_loss = 3.060498386621475
2023-04-21 15:26:54,351 - Detection - ***** Epoch: 5: Eval results *****
2023-04-21 15:26:54,351 - Detection -   best_eval_score = 31.06
2023-04-21 15:26:54,351 - Detection -   eval_score = 49.05
2023-04-21 15:26:54,351 - Detection -   train_loss = 2.578414112329483
2023-04-21 15:27:05,437 - Detection - ***** Epoch: 6: Eval results *****
2023-04-21 15:27:05,437 - Detection -   best_eval_score = 49.05
2023-04-21 15:27:05,437 - Detection -   eval_score = 65.7
2023-04-21 15:27:05,437 - Detection -   train_loss = 2.1208689212799072
2023-04-21 15:27:16,424 - Detection - ***** Epoch: 7: Eval results *****
2023-04-21 15:27:16,424 - Detection -   best_eval_score = 65.7
2023-04-21 15:27:16,424 - Detection -   eval_score = 71.7
2023-04-21 15:27:16,424 - Detection -   train_loss = 1.759723499417305
2023-04-21 15:27:27,548 - Detection - ***** Epoch: 8: Eval results *****
2023-04-21 15:27:27,548 - Detection -   best_eval_score = 71.7
2023-04-21 15:27:27,548 - Detection -   eval_score = 74.28
2023-04-21 15:27:27,548 - Detection -   train_loss = 1.5210294872522354
2023-04-21 15:27:38,663 - Detection - ***** Epoch: 9: Eval results *****
2023-04-21 15:27:38,663 - Detection -   best_eval_score = 74.28
2023-04-21 15:27:38,663 - Detection -   eval_score = 78.09
2023-04-21 15:27:38,663 - Detection -   train_loss = 1.3286710381507874
2023-04-21 15:27:49,608 - Detection - ***** Epoch: 10: Eval results *****
2023-04-21 15:27:49,608 - Detection -   best_eval_score = 78.09
2023-04-21 15:27:49,608 - Detection -   eval_score = 80.0
2023-04-21 15:27:49,608 - Detection -   train_loss = 1.223708063364029
2023-04-21 15:28:00,728 - Detection - ***** Epoch: 11: Eval results *****
2023-04-21 15:28:00,728 - Detection -   best_eval_score = 80.0
2023-04-21 15:28:00,728 - Detection -   eval_score = 81.67
2023-04-21 15:28:00,728 - Detection -   train_loss = 1.1324563473463058
2023-04-21 15:28:11,796 - Detection - ***** Epoch: 12: Eval results *****
2023-04-21 15:28:11,796 - Detection -   best_eval_score = 81.67
2023-04-21 15:28:11,796 - Detection -   eval_score = 82.62
2023-04-21 15:28:11,796 - Detection -   train_loss = 1.075859546661377
2023-04-21 15:28:22,853 - Detection - ***** Epoch: 13: Eval results *****
2023-04-21 15:28:22,853 - Detection -   best_eval_score = 82.62
2023-04-21 15:28:22,853 - Detection -   eval_score = 81.75
2023-04-21 15:28:22,853 - Detection -   train_loss = 1.025240994989872
2023-04-21 15:28:33,895 - Detection - ***** Epoch: 14: Eval results *****
2023-04-21 15:28:33,895 - Detection -   best_eval_score = 82.62
2023-04-21 15:28:33,895 - Detection -   eval_score = 83.07
2023-04-21 15:28:33,895 - Detection -   train_loss = 0.9859614595770836
2023-04-21 15:28:45,005 - Detection - ***** Epoch: 15: Eval results *****
2023-04-21 15:28:45,005 - Detection -   best_eval_score = 83.07
2023-04-21 15:28:45,005 - Detection -   eval_score = 82.8
2023-04-21 15:28:45,005 - Detection -   train_loss = 0.9551403447985649
2023-04-21 15:28:55,950 - Detection - ***** Epoch: 16: Eval results *****
2023-04-21 15:28:55,950 - Detection -   best_eval_score = 83.07
2023-04-21 15:28:55,950 - Detection -   eval_score = 83.74
2023-04-21 15:28:55,950 - Detection -   train_loss = 0.9285750016570091
2023-04-21 15:29:07,016 - Detection - ***** Epoch: 17: Eval results *****
2023-04-21 15:29:07,016 - Detection -   best_eval_score = 83.74
2023-04-21 15:29:07,016 - Detection -   eval_score = 83.81
2023-04-21 15:29:07,016 - Detection -   train_loss = 0.9007914736866951
2023-04-21 15:29:18,081 - Detection - ***** Epoch: 18: Eval results *****
2023-04-21 15:29:18,081 - Detection -   best_eval_score = 83.81
2023-04-21 15:29:18,081 - Detection -   eval_score = 85.46
2023-04-21 15:29:18,081 - Detection -   train_loss = 0.8886277079582214
2023-04-21 15:29:29,050 - Detection - ***** Epoch: 19: Eval results *****
2023-04-21 15:29:29,050 - Detection -   best_eval_score = 85.46
2023-04-21 15:29:29,050 - Detection -   eval_score = 84.66
2023-04-21 15:29:29,050 - Detection -   train_loss = 0.8740114495158195
2023-04-21 15:29:40,097 - Detection - ***** Epoch: 20: Eval results *****
2023-04-21 15:29:40,097 - Detection -   best_eval_score = 85.46
2023-04-21 15:29:40,098 - Detection -   eval_score = 85.09
2023-04-21 15:29:40,098 - Detection -   train_loss = 0.8517350777983665
2023-04-21 15:29:51,025 - Detection - ***** Epoch: 21: Eval results *****
2023-04-21 15:29:51,025 - Detection -   best_eval_score = 85.46
2023-04-21 15:29:51,025 - Detection -   eval_score = 85.26
2023-04-21 15:29:51,025 - Detection -   train_loss = 0.8321557193994522
2023-04-21 15:30:02,115 - Detection - ***** Epoch: 22: Eval results *****
2023-04-21 15:30:02,116 - Detection -   best_eval_score = 85.46
2023-04-21 15:30:02,116 - Detection -   eval_score = 84.81
2023-04-21 15:30:02,116 - Detection -   train_loss = 0.8263651207089424
2023-04-21 15:30:13,168 - Detection - ***** Epoch: 23: Eval results *****
2023-04-21 15:30:13,168 - Detection -   best_eval_score = 85.46
2023-04-21 15:30:13,168 - Detection -   eval_score = 85.01
2023-04-21 15:30:13,168 - Detection -   train_loss = 0.8189608603715897
2023-04-21 15:30:24,136 - Detection - ***** Epoch: 24: Eval results *****
2023-04-21 15:30:24,136 - Detection -   best_eval_score = 85.46
2023-04-21 15:30:24,137 - Detection -   eval_score = 85.34
2023-04-21 15:30:24,137 - Detection -   train_loss = 0.8075427114963531
2023-04-21 15:30:35,098 - Detection - ***** Epoch: 25: Eval results *****
2023-04-21 15:30:35,098 - Detection -   best_eval_score = 85.46
2023-04-21 15:30:35,098 - Detection -   eval_score = 85.24
2023-04-21 15:30:35,098 - Detection -   train_loss = 0.7965997159481049
2023-04-21 15:30:46,163 - Detection - ***** Epoch: 26: Eval results *****
2023-04-21 15:30:46,163 - Detection -   best_eval_score = 85.46
2023-04-21 15:30:46,163 - Detection -   eval_score = 85.01
2023-04-21 15:30:46,163 - Detection -   train_loss = 0.7887158617377281
2023-04-21 15:30:57,275 - Detection - ***** Epoch: 27: Eval results *****
2023-04-21 15:30:57,275 - Detection -   best_eval_score = 85.46
2023-04-21 15:30:57,275 - Detection -   eval_score = 85.24
2023-04-21 15:30:57,275 - Detection -   train_loss = 0.7814268991351128
2023-04-21 15:31:08,174 - Detection - ***** Epoch: 28: Eval results *****
2023-04-21 15:31:08,175 - Detection -   best_eval_score = 85.46
2023-04-21 15:31:08,175 - Detection -   eval_score = 85.24
2023-04-21 15:31:08,175 - Detection -   train_loss = 0.7747825086116791
2023-04-21 15:31:08,175 - Detection - Pre-training finished...
2023-04-21 15:31:08,175 - Detection - Training Begin...
2023-04-21 15:31:09,020 - Detection - ***** Epoch: 1: Eval results *****
2023-04-21 15:31:09,020 - Detection -   best_eval_score = 0
2023-04-21 15:31:09,020 - Detection -   eval_score = 2.85
2023-04-21 15:31:09,020 - Detection -   train_loss = 2.856240391731262
2023-04-21 15:31:19,447 - Detection - ***** Epoch: 2: Eval results *****
2023-04-21 15:31:19,448 - Detection -   best_eval_score = 2.85
2023-04-21 15:31:19,448 - Detection -   eval_score = 56.54
2023-04-21 15:31:19,448 - Detection -   train_loss = 2.6362192034721375
2023-04-21 15:31:29,787 - Detection - ***** Epoch: 3: Eval results *****
2023-04-21 15:31:29,787 - Detection -   best_eval_score = 56.54
2023-04-21 15:31:29,787 - Detection -   eval_score = 55.89
2023-04-21 15:31:29,787 - Detection -   train_loss = 0.4421596825122833
2023-04-21 15:31:40,095 - Detection - ***** Epoch: 4: Eval results *****
2023-04-21 15:31:40,095 - Detection -   best_eval_score = 56.54
2023-04-21 15:31:40,096 - Detection -   eval_score = 54.7
2023-04-21 15:31:40,096 - Detection -   train_loss = 0.43051883950829506
2023-04-21 15:31:50,512 - Detection - ***** Epoch: 5: Eval results *****
2023-04-21 15:31:50,512 - Detection -   best_eval_score = 56.54
2023-04-21 15:31:50,512 - Detection -   eval_score = 54.47
2023-04-21 15:31:50,512 - Detection -   train_loss = 0.4035807475447655
2023-04-21 15:32:00,891 - Detection - ***** Epoch: 6: Eval results *****
2023-04-21 15:32:00,891 - Detection -   best_eval_score = 56.54
2023-04-21 15:32:00,891 - Detection -   eval_score = 54.81
2023-04-21 15:32:00,891 - Detection -   train_loss = 0.4021335802972317
2023-04-21 15:32:11,220 - Detection - ***** Epoch: 7: Eval results *****
2023-04-21 15:32:11,220 - Detection -   best_eval_score = 56.54
2023-04-21 15:32:11,220 - Detection -   eval_score = 55.57
2023-04-21 15:32:11,220 - Detection -   train_loss = 0.3960454724729061
2023-04-21 15:32:21,674 - Detection - ***** Epoch: 8: Eval results *****
2023-04-21 15:32:21,674 - Detection -   best_eval_score = 56.54
2023-04-21 15:32:21,674 - Detection -   eval_score = 55.15
2023-04-21 15:32:21,674 - Detection -   train_loss = 0.41068045794963837
2023-04-21 15:32:31,950 - Detection - ***** Epoch: 9: Eval results *****
2023-04-21 15:32:31,950 - Detection -   best_eval_score = 56.54
2023-04-21 15:32:31,950 - Detection -   eval_score = 54.55
2023-04-21 15:32:31,950 - Detection -   train_loss = 0.44499363377690315
2023-04-21 15:32:42,525 - Detection - ***** Epoch: 10: Eval results *****
2023-04-21 15:32:42,526 - Detection -   best_eval_score = 56.54
2023-04-21 15:32:42,526 - Detection -   eval_score = 55.94
2023-04-21 15:32:42,526 - Detection -   train_loss = 0.40597984939813614
2023-04-21 15:32:52,993 - Detection - ***** Epoch: 11: Eval results *****
2023-04-21 15:32:52,993 - Detection -   best_eval_score = 56.54
2023-04-21 15:32:52,993 - Detection -   eval_score = 55.17
2023-04-21 15:32:52,993 - Detection -   train_loss = 0.4052739813923836
2023-04-21 15:33:03,300 - Detection - ***** Epoch: 12: Eval results *****
2023-04-21 15:33:03,300 - Detection -   best_eval_score = 56.54
2023-04-21 15:33:03,300 - Detection -   eval_score = 54.77
2023-04-21 15:33:03,300 - Detection -   train_loss = 0.4071020036935806
2023-04-21 15:33:03,300 - Detection - Training Finished...
2023-04-21 15:33:03,301 - Detection - Testing begin...
2023-04-21 15:33:05,354 - Detection - ***** Test: Confusion Matrix *****
2023-04-21 15:33:05,354 - Detection - [[   0    0    0 ...    0    0   11]
 [   0    9    0 ...    0    0    3]
 [   0    0   29 ...    0    0    1]
 ...
 [   0    0    0 ...   14    0   10]
 [   0    0    1 ...    0    4   17]
 [  14    1    0 ...    7    5 2806]]
2023-04-21 15:33:05,354 - Detection - ***** Test results *****
2023-04-21 15:33:05,354 - Detection -   Acc = 86.32
2023-04-21 15:33:05,354 - Detection -   F1 = 52.9863
2023-04-21 15:33:05,354 - Detection -   F1-known = 51.9624
2023-04-21 15:33:05,354 - Detection -   F1-open = 91.8945
2023-04-21 15:33:05,354 - Detection - Testing finished...
2023-04-21 15:33:05,355 - Detection - Results saved in results/results_DA-ADB-BOOST.csv
2023-04-21 15:33:05,373 - Detection - Open Intent Detection Finished...
