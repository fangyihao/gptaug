2023-04-22 23:50:13,828 - Detection - Open Intent Detection Begin...
2023-04-22 23:50:13,829 - Detection - Parameters Initialization...
2023-04-22 23:50:13,829 - Detection - ============================== Params ==============================
2023-04-22 23:50:13,829 - Detection - type:	open_intent_detection
2023-04-22 23:50:13,829 - Detection - logger_name:	Detection
2023-04-22 23:50:13,829 - Detection - log_dir:	logs
2023-04-22 23:50:13,829 - Detection - dataset:	stackoverflow_cg
2023-04-22 23:50:13,829 - Detection - known_cls_ratio:	0.25
2023-04-22 23:50:13,829 - Detection - labeled_ratio:	1.0
2023-04-22 23:50:13,829 - Detection - method:	DA-ADB
2023-04-22 23:50:13,829 - Detection - train:	True
2023-04-22 23:50:13,829 - Detection - pretrain:	True
2023-04-22 23:50:13,829 - Detection - save_model:	False
2023-04-22 23:50:13,829 - Detection - backbone:	bert_disaware_boost
2023-04-22 23:50:13,829 - Detection - config_file_name:	DA-ADB
2023-04-22 23:50:13,829 - Detection - seed:	3
2023-04-22 23:50:13,829 - Detection - gpu_id:	0
2023-04-22 23:50:13,829 - Detection - pipe_results_path:	pipe_results
2023-04-22 23:50:13,829 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-22 23:50:13,829 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-22 23:50:13,829 - Detection - model_dir:	models
2023-04-22 23:50:13,829 - Detection - load_pretrained_method:	None
2023-04-22 23:50:13,829 - Detection - result_dir:	results
2023-04-22 23:50:13,829 - Detection - results_file_name:	results_DA-ADB-BOOST-F-4.csv
2023-04-22 23:50:13,829 - Detection - save_results:	True
2023-04-22 23:50:13,829 - Detection - loss_fct:	CrossEntropyLoss
2023-04-22 23:50:13,829 - Detection - boost_method:	F-4
2023-04-22 23:50:13,829 - Detection - boost_start_score:	0.0
2023-04-22 23:50:13,829 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.25_1.0_bert_disaware_boost_3
2023-04-22 23:50:13,829 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.25_1.0_bert_disaware_boost_3/models
2023-04-22 23:50:13,829 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-22 23:50:13,829 - Detection - num_train_epochs:	100
2023-04-22 23:50:13,829 - Detection - num_labels:	None
2023-04-22 23:50:13,829 - Detection - max_seq_length:	None
2023-04-22 23:50:13,829 - Detection - freeze_backbone_parameters:	True
2023-04-22 23:50:13,829 - Detection - feat_dim:	768
2023-04-22 23:50:13,829 - Detection - warmup_proportion:	0.1
2023-04-22 23:50:13,829 - Detection - scale:	4
2023-04-22 23:50:13,829 - Detection - lr_boundary:	0.05
2023-04-22 23:50:13,830 - Detection - lr:	2e-05
2023-04-22 23:50:13,830 - Detection - activation:	relu
2023-04-22 23:50:13,830 - Detection - train_batch_size:	128
2023-04-22 23:50:13,830 - Detection - eval_batch_size:	64
2023-04-22 23:50:13,830 - Detection - test_batch_size:	64
2023-04-22 23:50:13,830 - Detection - wait_patient:	10
2023-04-22 23:50:13,830 - Detection - ============================== End Params ==============================
2023-04-22 23:50:13,830 - Detection - Data and Model Preparation...
2023-04-22 23:50:13,830 - Detection - The number of known intents is 5
2023-04-22 23:50:13,830 - Detection - Lists of known labels are: ['scala', 'bash', 'apache', 'svn', 'drupal']
2023-04-22 23:50:13,838 - Detection - Number of labeled training samples = 630
2023-04-22 23:50:13,838 - Detection - Number of unlabeled training samples = 2161
2023-04-22 23:50:13,840 - Detection - Number of evaluation samples = 377
2023-04-22 23:50:13,846 - Detection - Number of testing samples = 2905
2023-04-22 23:50:21,968 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-22 23:50:22,082 - Detection - Pre-training Begin...
2023-04-22 23:50:23,862 - Detection - ***** Epoch: 1: Eval results *****
2023-04-22 23:50:23,862 - Detection -   best_eval_score = 0
2023-04-22 23:50:23,862 - Detection -   eval_score = 7.96
2023-04-22 23:50:23,862 - Detection -   train_loss = 1.614135456085205
2023-04-22 23:50:28,721 - Detection - ***** Epoch: 2: Eval results *****
2023-04-22 23:50:28,721 - Detection -   best_eval_score = 7.96
2023-04-22 23:50:28,722 - Detection -   eval_score = 12.81
2023-04-22 23:50:28,722 - Detection -   train_loss = 1.6081175565719605
2023-04-22 23:50:33,678 - Detection - ***** Epoch: 3: Eval results *****
2023-04-22 23:50:33,678 - Detection -   best_eval_score = 12.81
2023-04-22 23:50:33,678 - Detection -   eval_score = 14.53
2023-04-22 23:50:33,678 - Detection -   train_loss = 1.578586173057556
2023-04-22 23:50:38,545 - Detection - ***** Epoch: 4: Eval results *****
2023-04-22 23:50:38,546 - Detection -   best_eval_score = 14.53
2023-04-22 23:50:38,546 - Detection -   eval_score = 30.73
2023-04-22 23:50:38,546 - Detection -   train_loss = 1.534824538230896
2023-04-22 23:50:43,421 - Detection - ***** Epoch: 5: Eval results *****
2023-04-22 23:50:43,421 - Detection -   best_eval_score = 30.73
2023-04-22 23:50:43,421 - Detection -   eval_score = 66.67
2023-04-22 23:50:43,421 - Detection -   train_loss = 1.427416944503784
2023-04-22 23:50:48,249 - Detection - ***** Epoch: 6: Eval results *****
2023-04-22 23:50:48,249 - Detection -   best_eval_score = 66.67
2023-04-22 23:50:48,249 - Detection -   eval_score = 73.71
2023-04-22 23:50:48,249 - Detection -   train_loss = 1.2037222862243653
2023-04-22 23:50:53,256 - Detection - ***** Epoch: 7: Eval results *****
2023-04-22 23:50:53,256 - Detection -   best_eval_score = 73.71
2023-04-22 23:50:53,256 - Detection -   eval_score = 79.66
2023-04-22 23:50:53,256 - Detection -   train_loss = 0.9099075198173523
2023-04-22 23:50:58,072 - Detection - ***** Epoch: 8: Eval results *****
2023-04-22 23:50:58,072 - Detection -   best_eval_score = 79.66
2023-04-22 23:50:58,073 - Detection -   eval_score = 83.29
2023-04-22 23:50:58,073 - Detection -   train_loss = 0.7522553324699401
2023-04-22 23:51:02,918 - Detection - ***** Epoch: 9: Eval results *****
2023-04-22 23:51:02,918 - Detection -   best_eval_score = 83.29
2023-04-22 23:51:02,918 - Detection -   eval_score = 87.7
2023-04-22 23:51:02,918 - Detection -   train_loss = 0.6502265810966492
2023-04-22 23:51:07,827 - Detection - ***** Epoch: 10: Eval results *****
2023-04-22 23:51:07,827 - Detection -   best_eval_score = 87.7
2023-04-22 23:51:07,827 - Detection -   eval_score = 89.95
2023-04-22 23:51:07,827 - Detection -   train_loss = 0.5296414613723754
2023-04-22 23:51:12,684 - Detection - ***** Epoch: 11: Eval results *****
2023-04-22 23:51:12,684 - Detection -   best_eval_score = 89.95
2023-04-22 23:51:12,684 - Detection -   eval_score = 90.99
2023-04-22 23:51:12,684 - Detection -   train_loss = 0.3891430199146271
2023-04-22 23:51:17,384 - Detection - ***** Epoch: 12: Eval results *****
2023-04-22 23:51:17,384 - Detection -   best_eval_score = 90.99
2023-04-22 23:51:17,384 - Detection -   eval_score = 91.82
2023-04-22 23:51:17,384 - Detection -   train_loss = 0.33927503824234007
2023-04-22 23:51:22,198 - Detection - ***** Epoch: 13: Eval results *****
2023-04-22 23:51:22,198 - Detection -   best_eval_score = 91.82
2023-04-22 23:51:22,198 - Detection -   eval_score = 91.26
2023-04-22 23:51:22,198 - Detection -   train_loss = 0.3006118595600128
2023-04-22 23:51:27,039 - Detection - ***** Epoch: 14: Eval results *****
2023-04-22 23:51:27,039 - Detection -   best_eval_score = 91.82
2023-04-22 23:51:27,039 - Detection -   eval_score = 90.72
2023-04-22 23:51:27,039 - Detection -   train_loss = 0.25828016102313994
2023-04-22 23:51:31,899 - Detection - ***** Epoch: 15: Eval results *****
2023-04-22 23:51:31,899 - Detection -   best_eval_score = 91.82
2023-04-22 23:51:31,899 - Detection -   eval_score = 91.11
2023-04-22 23:51:31,899 - Detection -   train_loss = 0.23977276384830476
2023-04-22 23:51:36,850 - Detection - ***** Epoch: 16: Eval results *****
2023-04-22 23:51:36,850 - Detection -   best_eval_score = 91.82
2023-04-22 23:51:36,850 - Detection -   eval_score = 87.92
2023-04-22 23:51:36,851 - Detection -   train_loss = 0.24393124282360076
2023-04-22 23:51:41,722 - Detection - ***** Epoch: 17: Eval results *****
2023-04-22 23:51:41,722 - Detection -   best_eval_score = 91.82
2023-04-22 23:51:41,722 - Detection -   eval_score = 91.51
2023-04-22 23:51:41,722 - Detection -   train_loss = 0.21571218967437744
2023-04-22 23:51:46,546 - Detection - ***** Epoch: 18: Eval results *****
2023-04-22 23:51:46,546 - Detection -   best_eval_score = 91.82
2023-04-22 23:51:46,546 - Detection -   eval_score = 91.64
2023-04-22 23:51:46,546 - Detection -   train_loss = 0.19394213557243348
2023-04-22 23:51:51,284 - Detection - ***** Epoch: 19: Eval results *****
2023-04-22 23:51:51,284 - Detection -   best_eval_score = 91.82
2023-04-22 23:51:51,284 - Detection -   eval_score = 91.83
2023-04-22 23:51:51,284 - Detection -   train_loss = 0.17246970534324646
2023-04-22 23:51:56,200 - Detection - ***** Epoch: 20: Eval results *****
2023-04-22 23:51:56,200 - Detection -   best_eval_score = 91.83
2023-04-22 23:51:56,200 - Detection -   eval_score = 91.5
2023-04-22 23:51:56,200 - Detection -   train_loss = 0.1716772735118866
2023-04-22 23:52:00,942 - Detection - ***** Epoch: 21: Eval results *****
2023-04-22 23:52:00,942 - Detection -   best_eval_score = 91.83
2023-04-22 23:52:00,942 - Detection -   eval_score = 92.39
2023-04-22 23:52:00,942 - Detection -   train_loss = 0.15617074966430664
2023-04-22 23:52:05,555 - Detection - ***** Epoch: 22: Eval results *****
2023-04-22 23:52:05,555 - Detection -   best_eval_score = 92.39
2023-04-22 23:52:05,555 - Detection -   eval_score = 91.8
2023-04-22 23:52:05,555 - Detection -   train_loss = 0.15597819089889525
2023-04-22 23:52:09,882 - Detection - ***** Epoch: 23: Eval results *****
2023-04-22 23:52:09,882 - Detection -   best_eval_score = 92.39
2023-04-22 23:52:09,882 - Detection -   eval_score = 91.81
2023-04-22 23:52:09,882 - Detection -   train_loss = 0.14253948330879213
2023-04-22 23:52:14,603 - Detection - ***** Epoch: 24: Eval results *****
2023-04-22 23:52:14,603 - Detection -   best_eval_score = 92.39
2023-04-22 23:52:14,603 - Detection -   eval_score = 91.55
2023-04-22 23:52:14,603 - Detection -   train_loss = 0.13918474912643433
2023-04-22 23:52:19,430 - Detection - ***** Epoch: 25: Eval results *****
2023-04-22 23:52:19,430 - Detection -   best_eval_score = 92.39
2023-04-22 23:52:19,430 - Detection -   eval_score = 92.11
2023-04-22 23:52:19,430 - Detection -   train_loss = 0.1376730129122734
2023-04-22 23:52:24,383 - Detection - ***** Epoch: 26: Eval results *****
2023-04-22 23:52:24,383 - Detection -   best_eval_score = 92.39
2023-04-22 23:52:24,383 - Detection -   eval_score = 92.36
2023-04-22 23:52:24,383 - Detection -   train_loss = 0.13435038775205613
2023-04-22 23:52:29,257 - Detection - ***** Epoch: 27: Eval results *****
2023-04-22 23:52:29,257 - Detection -   best_eval_score = 92.39
2023-04-22 23:52:29,257 - Detection -   eval_score = 92.37
2023-04-22 23:52:29,257 - Detection -   train_loss = 0.12505912333726882
2023-04-22 23:52:34,159 - Detection - ***** Epoch: 28: Eval results *****
2023-04-22 23:52:34,159 - Detection -   best_eval_score = 92.39
2023-04-22 23:52:34,159 - Detection -   eval_score = 92.11
2023-04-22 23:52:34,159 - Detection -   train_loss = 0.12005670517683029
2023-04-22 23:52:38,877 - Detection - ***** Epoch: 29: Eval results *****
2023-04-22 23:52:38,877 - Detection -   best_eval_score = 92.39
2023-04-22 23:52:38,877 - Detection -   eval_score = 92.35
2023-04-22 23:52:38,877 - Detection -   train_loss = 0.12098145931959152
2023-04-22 23:52:43,703 - Detection - ***** Epoch: 30: Eval results *****
2023-04-22 23:52:43,703 - Detection -   best_eval_score = 92.39
2023-04-22 23:52:43,703 - Detection -   eval_score = 91.83
2023-04-22 23:52:43,703 - Detection -   train_loss = 0.12176715135574341
2023-04-22 23:52:48,287 - Detection - ***** Epoch: 31: Eval results *****
2023-04-22 23:52:48,287 - Detection -   best_eval_score = 92.39
2023-04-22 23:52:48,287 - Detection -   eval_score = 92.12
2023-04-22 23:52:48,287 - Detection -   train_loss = 0.11924231201410293
2023-04-22 23:52:48,288 - Detection - Pre-training finished...
2023-04-22 23:52:48,288 - Detection - Training Begin...
2023-04-22 23:52:48,938 - Detection - ***** Epoch: 1: Eval results *****
2023-04-22 23:52:48,938 - Detection -   best_eval_score = 0
2023-04-22 23:52:48,938 - Detection -   eval_score = 0.0
2023-04-22 23:52:48,938 - Detection -   train_loss = 5.017223167419433
2023-04-22 23:52:49,586 - Detection - ***** Epoch: 2: Eval results *****
2023-04-22 23:52:49,587 - Detection -   best_eval_score = 0
2023-04-22 23:52:49,587 - Detection -   eval_score = 0.41
2023-04-22 23:52:49,587 - Detection -   train_loss = 4.855276584625244
2023-04-22 23:52:53,789 - Detection - ***** Epoch: 3: Eval results *****
2023-04-22 23:52:53,790 - Detection -   best_eval_score = 0.41
2023-04-22 23:52:53,790 - Detection -   eval_score = 2.02
2023-04-22 23:52:53,790 - Detection -   train_loss = 4.7256958961486815
2023-04-22 23:52:58,290 - Detection - ***** Epoch: 4: Eval results *****
2023-04-22 23:52:58,290 - Detection -   best_eval_score = 2.02
2023-04-22 23:52:58,290 - Detection -   eval_score = 24.3
2023-04-22 23:52:58,290 - Detection -   train_loss = 3.8304087638854982
2023-04-22 23:53:02,807 - Detection - ***** Epoch: 5: Eval results *****
2023-04-22 23:53:02,808 - Detection -   best_eval_score = 24.3
2023-04-22 23:53:02,808 - Detection -   eval_score = 63.24
2023-04-22 23:53:02,808 - Detection -   train_loss = 2.532420587539673
2023-04-22 23:53:07,365 - Detection - ***** Epoch: 6: Eval results *****
2023-04-22 23:53:07,365 - Detection -   best_eval_score = 63.24
2023-04-22 23:53:07,365 - Detection -   eval_score = 71.78
2023-04-22 23:53:07,365 - Detection -   train_loss = 1.3654596567153932
2023-04-22 23:53:11,504 - Detection - ***** Epoch: 7: Eval results *****
2023-04-22 23:53:11,504 - Detection -   best_eval_score = 71.78
2023-04-22 23:53:11,504 - Detection -   eval_score = 71.37
2023-04-22 23:53:11,504 - Detection -   train_loss = 0.9883880496025086
2023-04-22 23:53:15,721 - Detection - ***** Epoch: 8: Eval results *****
2023-04-22 23:53:15,721 - Detection -   best_eval_score = 71.78
2023-04-22 23:53:15,721 - Detection -   eval_score = 70.88
2023-04-22 23:53:15,721 - Detection -   train_loss = 0.9544846534729003
2023-04-22 23:53:20,154 - Detection - ***** Epoch: 9: Eval results *****
2023-04-22 23:53:20,154 - Detection -   best_eval_score = 71.78
2023-04-22 23:53:20,154 - Detection -   eval_score = 70.99
2023-04-22 23:53:20,154 - Detection -   train_loss = 0.9597105264663697
2023-04-22 23:53:24,478 - Detection - ***** Epoch: 10: Eval results *****
2023-04-22 23:53:24,478 - Detection -   best_eval_score = 71.78
2023-04-22 23:53:24,478 - Detection -   eval_score = 70.88
2023-04-22 23:53:24,478 - Detection -   train_loss = 0.9796218156814576
2023-04-22 23:53:29,035 - Detection - ***** Epoch: 11: Eval results *****
2023-04-22 23:53:29,035 - Detection -   best_eval_score = 71.78
2023-04-22 23:53:29,035 - Detection -   eval_score = 70.88
2023-04-22 23:53:29,035 - Detection -   train_loss = 0.9804468631744385
2023-04-22 23:53:33,439 - Detection - ***** Epoch: 12: Eval results *****
2023-04-22 23:53:33,439 - Detection -   best_eval_score = 71.78
2023-04-22 23:53:33,439 - Detection -   eval_score = 70.7
2023-04-22 23:53:33,439 - Detection -   train_loss = 0.9775631904602051
2023-04-22 23:53:37,271 - Detection - ***** Epoch: 13: Eval results *****
2023-04-22 23:53:37,271 - Detection -   best_eval_score = 71.78
2023-04-22 23:53:37,271 - Detection -   eval_score = 70.82
2023-04-22 23:53:37,271 - Detection -   train_loss = 1.0048512935638427
2023-04-22 23:53:41,177 - Detection - ***** Epoch: 14: Eval results *****
2023-04-22 23:53:41,177 - Detection -   best_eval_score = 71.78
2023-04-22 23:53:41,177 - Detection -   eval_score = 70.7
2023-04-22 23:53:41,177 - Detection -   train_loss = 0.9794288039207458
2023-04-22 23:53:45,497 - Detection - ***** Epoch: 15: Eval results *****
2023-04-22 23:53:45,497 - Detection -   best_eval_score = 71.78
2023-04-22 23:53:45,497 - Detection -   eval_score = 71.34
2023-04-22 23:53:45,497 - Detection -   train_loss = 1.0386135458946228
2023-04-22 23:53:49,956 - Detection - ***** Epoch: 16: Eval results *****
2023-04-22 23:53:49,956 - Detection -   best_eval_score = 71.78
2023-04-22 23:53:49,956 - Detection -   eval_score = 71.23
2023-04-22 23:53:49,956 - Detection -   train_loss = 0.9628064155578613
2023-04-22 23:53:49,956 - Detection - Training Finished...
2023-04-22 23:53:49,956 - Detection - Testing begin...
2023-04-22 23:53:51,701 - Detection - ***** Test: Confusion Matrix *****
2023-04-22 23:53:51,701 - Detection - [[  93    1    0    0    0   30]
 [   3   67    1    0    1   67]
 [   0    0   96    1    1   72]
 [   0    0    2  111    1   35]
 [   0    0    1    0  102   25]
 [ 125  118   45   19   16 1872]]
2023-04-22 23:53:51,701 - Detection - ***** Test results *****
2023-04-22 23:53:51,701 - Detection -   Acc = 80.59
2023-04-22 23:53:51,701 - Detection -   F1 = 67.4101
2023-04-22 23:53:51,701 - Detection -   F1-known = 63.4619
2023-04-22 23:53:51,701 - Detection -   F1-open = 87.1508
2023-04-22 23:53:51,701 - Detection - Testing finished...
2023-04-22 23:53:51,701 - Detection - Results saved in results/results_DA-ADB-BOOST-F-4.csv
2023-04-22 23:53:51,720 - Detection - Open Intent Detection Finished...
