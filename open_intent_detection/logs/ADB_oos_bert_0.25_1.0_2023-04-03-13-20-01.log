2023-04-03 13:20:01,401 - Detection - Open Intent Detection Begin...
2023-04-03 13:20:01,401 - Detection - Parameters Initialization...
2023-04-03 13:20:01,401 - Detection - ============================== Params ==============================
2023-04-03 13:20:01,402 - Detection - type:	open_intent_detection
2023-04-03 13:20:01,402 - Detection - logger_name:	Detection
2023-04-03 13:20:01,402 - Detection - log_dir:	logs
2023-04-03 13:20:01,402 - Detection - dataset:	oos
2023-04-03 13:20:01,402 - Detection - known_cls_ratio:	0.25
2023-04-03 13:20:01,402 - Detection - labeled_ratio:	1.0
2023-04-03 13:20:01,402 - Detection - method:	ADB
2023-04-03 13:20:01,402 - Detection - train:	True
2023-04-03 13:20:01,402 - Detection - pretrain:	True
2023-04-03 13:20:01,402 - Detection - save_model:	True
2023-04-03 13:20:01,402 - Detection - backbone:	bert
2023-04-03 13:20:01,402 - Detection - config_file_name:	ADB
2023-04-03 13:20:01,402 - Detection - seed:	0
2023-04-03 13:20:01,402 - Detection - gpu_id:	0
2023-04-03 13:20:01,402 - Detection - pipe_results_path:	pipe_results
2023-04-03 13:20:01,402 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-03 13:20:01,402 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-03 13:20:01,402 - Detection - model_dir:	models
2023-04-03 13:20:01,402 - Detection - load_pretrained_method:	None
2023-04-03 13:20:01,402 - Detection - result_dir:	results
2023-04-03 13:20:01,402 - Detection - results_file_name:	results_ADB.csv
2023-04-03 13:20:01,402 - Detection - save_results:	True
2023-04-03 13:20:01,402 - Detection - loss_fct:	CrossEntropyLoss
2023-04-03 13:20:01,402 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_0.25_1.0_bert_0
2023-04-03 13:20:01,402 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_0.25_1.0_bert_0/models
2023-04-03 13:20:01,402 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-03 13:20:01,402 - Detection - num_train_epochs:	100
2023-04-03 13:20:01,402 - Detection - num_labels:	None
2023-04-03 13:20:01,402 - Detection - max_seq_length:	None
2023-04-03 13:20:01,402 - Detection - freeze_backbone_parameters:	True
2023-04-03 13:20:01,402 - Detection - feat_dim:	768
2023-04-03 13:20:01,402 - Detection - warmup_proportion:	0.1
2023-04-03 13:20:01,402 - Detection - lr_boundary:	0.05
2023-04-03 13:20:01,402 - Detection - lr:	2e-05
2023-04-03 13:20:01,402 - Detection - activation:	relu
2023-04-03 13:20:01,402 - Detection - train_batch_size:	128
2023-04-03 13:20:01,402 - Detection - eval_batch_size:	64
2023-04-03 13:20:01,402 - Detection - test_batch_size:	64
2023-04-03 13:20:01,402 - Detection - wait_patient:	10
2023-04-03 13:20:01,402 - Detection - ============================== End Params ==============================
2023-04-03 13:20:01,402 - Detection - Data and Model Preparation...
2023-04-03 13:20:01,403 - Detection - The number of known intents is 38
2023-04-03 13:20:01,403 - Detection - Lists of known labels are: ['spelling', 'jump_start', 'date', 'routing', 'bill_balance', 'reset_settings', 'expiration_date', 'play_music', 'no', 'min_payment', 'travel_suggestion', 'how_busy', 'new_card', 'income', 'last_maintenance', 'distance', 'oil_change_how', 'pto_request_status', 'freeze_account', 'cancel_reservation', 'time', 'maybe', 'change_user_name', 'bill_due', 'todo_list', 'change_language', 'food_last', 'replacement_card_duration', 'redeem_rewards', 'confirm_reservation', 'user_name', 'payday', 'cook_time', 'todo_list_update', 'travel_alert', 'interest_rate', 'card_declined', 'pay_bill']
2023-04-03 13:20:01,443 - Detection - Number of labeled training samples = 3800
2023-04-03 13:20:01,443 - Detection - Number of unlabeled training samples = 11200
2023-04-03 13:20:01,449 - Detection - Number of evaluation samples = 760
2023-04-03 13:20:01,460 - Detection - Number of testing samples = 5700
2023-04-03 13:20:08,680 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-03 13:20:10,341 - Detection - Pre-training Begin...
2023-04-03 13:20:13,702 - Detection - ***** Epoch: 1: Eval results *****
2023-04-03 13:20:13,702 - Detection -   best_eval_score = 0
2023-04-03 13:20:13,702 - Detection -   eval_score = 5.53
2023-04-03 13:20:13,702 - Detection -   train_loss = 3.6340087175369264
2023-04-03 13:20:16,569 - Detection - ***** Epoch: 2: Eval results *****
2023-04-03 13:20:16,569 - Detection -   best_eval_score = 5.53
2023-04-03 13:20:16,569 - Detection -   eval_score = 17.5
2023-04-03 13:20:16,570 - Detection -   train_loss = 3.602588748931885
2023-04-03 13:20:19,436 - Detection - ***** Epoch: 3: Eval results *****
2023-04-03 13:20:19,436 - Detection -   best_eval_score = 17.5
2023-04-03 13:20:19,436 - Detection -   eval_score = 45.26
2023-04-03 13:20:19,436 - Detection -   train_loss = 3.531331729888916
2023-04-03 13:20:22,311 - Detection - ***** Epoch: 4: Eval results *****
2023-04-03 13:20:22,311 - Detection -   best_eval_score = 45.26
2023-04-03 13:20:22,311 - Detection -   eval_score = 59.34
2023-04-03 13:20:22,311 - Detection -   train_loss = 3.342646829287211
2023-04-03 13:20:25,294 - Detection - ***** Epoch: 5: Eval results *****
2023-04-03 13:20:25,294 - Detection -   best_eval_score = 59.34
2023-04-03 13:20:25,294 - Detection -   eval_score = 73.95
2023-04-03 13:20:25,294 - Detection -   train_loss = 2.8549190044403074
2023-04-03 13:20:28,174 - Detection - ***** Epoch: 6: Eval results *****
2023-04-03 13:20:28,174 - Detection -   best_eval_score = 73.95
2023-04-03 13:20:28,174 - Detection -   eval_score = 82.5
2023-04-03 13:20:28,174 - Detection -   train_loss = 2.099055767059326
2023-04-03 13:20:31,060 - Detection - ***** Epoch: 7: Eval results *****
2023-04-03 13:20:31,060 - Detection -   best_eval_score = 82.5
2023-04-03 13:20:31,060 - Detection -   eval_score = 89.74
2023-04-03 13:20:31,060 - Detection -   train_loss = 1.3856297254562377
2023-04-03 13:20:33,948 - Detection - ***** Epoch: 8: Eval results *****
2023-04-03 13:20:33,948 - Detection -   best_eval_score = 89.74
2023-04-03 13:20:33,948 - Detection -   eval_score = 93.29
2023-04-03 13:20:33,948 - Detection -   train_loss = 0.893679557243983
2023-04-03 13:20:36,841 - Detection - ***** Epoch: 9: Eval results *****
2023-04-03 13:20:36,841 - Detection -   best_eval_score = 93.29
2023-04-03 13:20:36,841 - Detection -   eval_score = 94.61
2023-04-03 13:20:36,841 - Detection -   train_loss = 0.5955710341533025
2023-04-03 13:20:39,733 - Detection - ***** Epoch: 10: Eval results *****
2023-04-03 13:20:39,733 - Detection -   best_eval_score = 94.61
2023-04-03 13:20:39,733 - Detection -   eval_score = 96.18
2023-04-03 13:20:39,733 - Detection -   train_loss = 0.41683394809563956
2023-04-03 13:20:42,628 - Detection - ***** Epoch: 11: Eval results *****
2023-04-03 13:20:42,628 - Detection -   best_eval_score = 96.18
2023-04-03 13:20:42,628 - Detection -   eval_score = 96.71
2023-04-03 13:20:42,628 - Detection -   train_loss = 0.3008687471350034
2023-04-03 13:20:45,526 - Detection - ***** Epoch: 12: Eval results *****
2023-04-03 13:20:45,526 - Detection -   best_eval_score = 96.71
2023-04-03 13:20:45,526 - Detection -   eval_score = 96.58
2023-04-03 13:20:45,526 - Detection -   train_loss = 0.2313088203469912
2023-04-03 13:20:48,418 - Detection - ***** Epoch: 13: Eval results *****
2023-04-03 13:20:48,418 - Detection -   best_eval_score = 96.71
2023-04-03 13:20:48,418 - Detection -   eval_score = 96.18
2023-04-03 13:20:48,418 - Detection -   train_loss = 0.18895373990138373
2023-04-03 13:20:51,315 - Detection - ***** Epoch: 14: Eval results *****
2023-04-03 13:20:51,315 - Detection -   best_eval_score = 96.71
2023-04-03 13:20:51,315 - Detection -   eval_score = 96.58
2023-04-03 13:20:51,315 - Detection -   train_loss = 0.1615783785780271
2023-04-03 13:20:54,216 - Detection - ***** Epoch: 15: Eval results *****
2023-04-03 13:20:54,217 - Detection -   best_eval_score = 96.71
2023-04-03 13:20:54,217 - Detection -   eval_score = 96.97
2023-04-03 13:20:54,217 - Detection -   train_loss = 0.13517550577720006
2023-04-03 13:20:57,130 - Detection - ***** Epoch: 16: Eval results *****
2023-04-03 13:20:57,130 - Detection -   best_eval_score = 96.97
2023-04-03 13:20:57,130 - Detection -   eval_score = 97.24
2023-04-03 13:20:57,130 - Detection -   train_loss = 0.11720841551820436
2023-04-03 13:21:00,045 - Detection - ***** Epoch: 17: Eval results *****
2023-04-03 13:21:00,045 - Detection -   best_eval_score = 97.24
2023-04-03 13:21:00,045 - Detection -   eval_score = 96.97
2023-04-03 13:21:00,045 - Detection -   train_loss = 0.10299294417103132
2023-04-03 13:21:02,950 - Detection - ***** Epoch: 18: Eval results *****
2023-04-03 13:21:02,950 - Detection -   best_eval_score = 97.24
2023-04-03 13:21:02,950 - Detection -   eval_score = 97.24
2023-04-03 13:21:02,950 - Detection -   train_loss = 0.09511240099867185
2023-04-03 13:21:05,856 - Detection - ***** Epoch: 19: Eval results *****
2023-04-03 13:21:05,856 - Detection -   best_eval_score = 97.24
2023-04-03 13:21:05,856 - Detection -   eval_score = 97.11
2023-04-03 13:21:05,856 - Detection -   train_loss = 0.08621923426787058
2023-04-03 13:21:08,766 - Detection - ***** Epoch: 20: Eval results *****
2023-04-03 13:21:08,766 - Detection -   best_eval_score = 97.24
2023-04-03 13:21:08,766 - Detection -   eval_score = 97.63
2023-04-03 13:21:08,766 - Detection -   train_loss = 0.07924021246532599
2023-04-03 13:21:11,691 - Detection - ***** Epoch: 21: Eval results *****
2023-04-03 13:21:11,691 - Detection -   best_eval_score = 97.63
2023-04-03 13:21:11,691 - Detection -   eval_score = 97.37
2023-04-03 13:21:11,691 - Detection -   train_loss = 0.07303068997959296
2023-04-03 13:21:14,606 - Detection - ***** Epoch: 22: Eval results *****
2023-04-03 13:21:14,607 - Detection -   best_eval_score = 97.63
2023-04-03 13:21:14,607 - Detection -   eval_score = 97.24
2023-04-03 13:21:14,607 - Detection -   train_loss = 0.06456781116624673
2023-04-03 13:21:17,523 - Detection - ***** Epoch: 23: Eval results *****
2023-04-03 13:21:17,523 - Detection -   best_eval_score = 97.63
2023-04-03 13:21:17,523 - Detection -   eval_score = 97.5
2023-04-03 13:21:17,523 - Detection -   train_loss = 0.06276008201142153
2023-04-03 13:21:20,442 - Detection - ***** Epoch: 24: Eval results *****
2023-04-03 13:21:20,442 - Detection -   best_eval_score = 97.63
2023-04-03 13:21:20,442 - Detection -   eval_score = 97.76
2023-04-03 13:21:20,442 - Detection -   train_loss = 0.055065034454067546
2023-04-03 13:21:23,364 - Detection - ***** Epoch: 25: Eval results *****
2023-04-03 13:21:23,364 - Detection -   best_eval_score = 97.76
2023-04-03 13:21:23,364 - Detection -   eval_score = 97.5
2023-04-03 13:21:23,364 - Detection -   train_loss = 0.05099622756242752
2023-04-03 13:21:26,277 - Detection - ***** Epoch: 26: Eval results *****
2023-04-03 13:21:26,277 - Detection -   best_eval_score = 97.76
2023-04-03 13:21:26,277 - Detection -   eval_score = 97.5
2023-04-03 13:21:26,277 - Detection -   train_loss = 0.050889225552479427
2023-04-03 13:21:29,186 - Detection - ***** Epoch: 27: Eval results *****
2023-04-03 13:21:29,186 - Detection -   best_eval_score = 97.76
2023-04-03 13:21:29,186 - Detection -   eval_score = 97.76
2023-04-03 13:21:29,186 - Detection -   train_loss = 0.045376220780114336
2023-04-03 13:21:32,092 - Detection - ***** Epoch: 28: Eval results *****
2023-04-03 13:21:32,092 - Detection -   best_eval_score = 97.76
2023-04-03 13:21:32,092 - Detection -   eval_score = 97.63
2023-04-03 13:21:32,092 - Detection -   train_loss = 0.04596843309700489
2023-04-03 13:21:34,999 - Detection - ***** Epoch: 29: Eval results *****
2023-04-03 13:21:34,999 - Detection -   best_eval_score = 97.76
2023-04-03 13:21:34,999 - Detection -   eval_score = 97.5
2023-04-03 13:21:34,999 - Detection -   train_loss = 0.039751818589866164
2023-04-03 13:21:37,906 - Detection - ***** Epoch: 30: Eval results *****
2023-04-03 13:21:37,906 - Detection -   best_eval_score = 97.76
2023-04-03 13:21:37,906 - Detection -   eval_score = 97.37
2023-04-03 13:21:37,906 - Detection -   train_loss = 0.038510278115669885
2023-04-03 13:21:40,812 - Detection - ***** Epoch: 31: Eval results *****
2023-04-03 13:21:40,812 - Detection -   best_eval_score = 97.76
2023-04-03 13:21:40,813 - Detection -   eval_score = 97.5
2023-04-03 13:21:40,813 - Detection -   train_loss = 0.03610632562388976
2023-04-03 13:21:43,723 - Detection - ***** Epoch: 32: Eval results *****
2023-04-03 13:21:43,723 - Detection -   best_eval_score = 97.76
2023-04-03 13:21:43,723 - Detection -   eval_score = 97.24
2023-04-03 13:21:43,723 - Detection -   train_loss = 0.03612268430491288
2023-04-03 13:21:46,630 - Detection - ***** Epoch: 33: Eval results *****
2023-04-03 13:21:46,630 - Detection -   best_eval_score = 97.76
2023-04-03 13:21:46,630 - Detection -   eval_score = 97.5
2023-04-03 13:21:46,630 - Detection -   train_loss = 0.030928924245138965
2023-04-03 13:21:49,536 - Detection - ***** Epoch: 34: Eval results *****
2023-04-03 13:21:49,536 - Detection -   best_eval_score = 97.76
2023-04-03 13:21:49,536 - Detection -   eval_score = 97.24
2023-04-03 13:21:49,536 - Detection -   train_loss = 0.03167953994125128
2023-04-03 13:21:49,537 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_0.25_1.0_bert_0/models
2023-04-03 13:21:50,083 - Detection - Pre-training finished...
2023-04-03 13:21:50,084 - Detection - Training Begin...
2023-04-03 13:21:55,113 - Detection - ***** Epoch: 1: Eval results *****
2023-04-03 13:21:55,113 - Detection -   best_eval_score = 0
2023-04-03 13:21:55,113 - Detection -   eval_score = 0.0
2023-04-03 13:21:55,113 - Detection -   train_loss = 9.925532086690266
2023-04-03 13:21:58,075 - Detection - ***** Epoch: 2: Eval results *****
2023-04-03 13:21:58,075 - Detection -   best_eval_score = 0
2023-04-03 13:21:58,075 - Detection -   eval_score = 2.7
2023-04-03 13:21:58,075 - Detection -   train_loss = 8.829214382171632
2023-04-03 13:22:00,934 - Detection - ***** Epoch: 3: Eval results *****
2023-04-03 13:22:00,935 - Detection -   best_eval_score = 2.7
2023-04-03 13:22:00,935 - Detection -   eval_score = 25.64
2023-04-03 13:22:00,935 - Detection -   train_loss = 7.433248615264892
2023-04-03 13:22:03,793 - Detection - ***** Epoch: 4: Eval results *****
2023-04-03 13:22:03,793 - Detection -   best_eval_score = 25.64
2023-04-03 13:22:03,793 - Detection -   eval_score = 56.33
2023-04-03 13:22:03,793 - Detection -   train_loss = 5.914781936009725
2023-04-03 13:22:06,654 - Detection - ***** Epoch: 5: Eval results *****
2023-04-03 13:22:06,654 - Detection -   best_eval_score = 56.33
2023-04-03 13:22:06,654 - Detection -   eval_score = 73.69
2023-04-03 13:22:06,654 - Detection -   train_loss = 4.42180008093516
2023-04-03 13:22:09,511 - Detection - ***** Epoch: 6: Eval results *****
2023-04-03 13:22:09,511 - Detection -   best_eval_score = 73.69
2023-04-03 13:22:09,511 - Detection -   eval_score = 85.16
2023-04-03 13:22:09,511 - Detection -   train_loss = 2.980701128641764
2023-04-03 13:22:12,372 - Detection - ***** Epoch: 7: Eval results *****
2023-04-03 13:22:12,372 - Detection -   best_eval_score = 85.16
2023-04-03 13:22:12,372 - Detection -   eval_score = 89.39
2023-04-03 13:22:12,372 - Detection -   train_loss = 1.834347665309906
2023-04-03 13:22:15,231 - Detection - ***** Epoch: 8: Eval results *****
2023-04-03 13:22:15,231 - Detection -   best_eval_score = 89.39
2023-04-03 13:22:15,231 - Detection -   eval_score = 91.44
2023-04-03 13:22:15,231 - Detection -   train_loss = 1.2582199295361838
2023-04-03 13:22:18,092 - Detection - ***** Epoch: 9: Eval results *****
2023-04-03 13:22:18,092 - Detection -   best_eval_score = 91.44
2023-04-03 13:22:18,092 - Detection -   eval_score = 91.79
2023-04-03 13:22:18,092 - Detection -   train_loss = 1.1330835004647573
2023-04-03 13:22:20,950 - Detection - ***** Epoch: 10: Eval results *****
2023-04-03 13:22:20,951 - Detection -   best_eval_score = 91.79
2023-04-03 13:22:20,951 - Detection -   eval_score = 91.94
2023-04-03 13:22:20,951 - Detection -   train_loss = 1.1484546820322672
2023-04-03 13:22:23,810 - Detection - ***** Epoch: 11: Eval results *****
2023-04-03 13:22:23,810 - Detection -   best_eval_score = 91.94
2023-04-03 13:22:23,810 - Detection -   eval_score = 91.87
2023-04-03 13:22:23,810 - Detection -   train_loss = 1.1048641145229339
2023-04-03 13:22:26,667 - Detection - ***** Epoch: 12: Eval results *****
2023-04-03 13:22:26,668 - Detection -   best_eval_score = 91.94
2023-04-03 13:22:26,668 - Detection -   eval_score = 91.87
2023-04-03 13:22:26,668 - Detection -   train_loss = 1.1261972904205322
2023-04-03 13:22:29,528 - Detection - ***** Epoch: 13: Eval results *****
2023-04-03 13:22:29,528 - Detection -   best_eval_score = 91.94
2023-04-03 13:22:29,528 - Detection -   eval_score = 91.87
2023-04-03 13:22:29,528 - Detection -   train_loss = 1.1347159008185068
2023-04-03 13:22:32,388 - Detection - ***** Epoch: 14: Eval results *****
2023-04-03 13:22:32,388 - Detection -   best_eval_score = 91.94
2023-04-03 13:22:32,388 - Detection -   eval_score = 91.79
2023-04-03 13:22:32,388 - Detection -   train_loss = 1.1348031202952067
2023-04-03 13:22:35,246 - Detection - ***** Epoch: 15: Eval results *****
2023-04-03 13:22:35,246 - Detection -   best_eval_score = 91.94
2023-04-03 13:22:35,246 - Detection -   eval_score = 91.87
2023-04-03 13:22:35,246 - Detection -   train_loss = 1.1268717646598816
2023-04-03 13:22:38,106 - Detection - ***** Epoch: 16: Eval results *****
2023-04-03 13:22:38,106 - Detection -   best_eval_score = 91.94
2023-04-03 13:22:38,106 - Detection -   eval_score = 91.94
2023-04-03 13:22:38,106 - Detection -   train_loss = 1.1322412411371867
2023-04-03 13:22:40,965 - Detection - ***** Epoch: 17: Eval results *****
2023-04-03 13:22:40,965 - Detection -   best_eval_score = 91.94
2023-04-03 13:22:40,965 - Detection -   eval_score = 91.87
2023-04-03 13:22:40,965 - Detection -   train_loss = 1.1437664290269216
2023-04-03 13:22:43,822 - Detection - ***** Epoch: 18: Eval results *****
2023-04-03 13:22:43,822 - Detection -   best_eval_score = 91.94
2023-04-03 13:22:43,822 - Detection -   eval_score = 91.94
2023-04-03 13:22:43,822 - Detection -   train_loss = 1.1359825273354849
2023-04-03 13:22:46,679 - Detection - ***** Epoch: 19: Eval results *****
2023-04-03 13:22:46,679 - Detection -   best_eval_score = 91.94
2023-04-03 13:22:46,679 - Detection -   eval_score = 91.79
2023-04-03 13:22:46,679 - Detection -   train_loss = 1.1621165414651236
2023-04-03 13:22:49,537 - Detection - ***** Epoch: 20: Eval results *****
2023-04-03 13:22:49,537 - Detection -   best_eval_score = 91.94
2023-04-03 13:22:49,537 - Detection -   eval_score = 91.86
2023-04-03 13:22:49,537 - Detection -   train_loss = 1.1260390738646189
2023-04-03 13:22:49,538 - Detection - Training Finished...
2023-04-03 13:22:49,538 - Detection - Testing begin...
2023-04-03 13:22:52,804 - Detection - ***** Test: Confusion Matrix *****
2023-04-03 13:22:52,804 - Detection - [[  26    0    0 ...    0    0    4]
 [   0   30    0 ...    0    0    0]
 [   0    0   27 ...    0    0    3]
 ...
 [   0    0    0 ...   24    0    5]
 [   0    0    0 ...    0   26    3]
 [  13   10    5 ...   18    4 4017]]
2023-04-03 13:22:52,804 - Detection - ***** Test results *****
2023-04-03 13:22:52,804 - Detection -   Acc = 88.33
2023-04-03 13:22:52,804 - Detection -   F1 = 77.1776
2023-04-03 13:22:52,804 - Detection -   F1-known = 76.7745
2023-04-03 13:22:52,804 - Detection -   F1-open = 92.4937
2023-04-03 13:22:52,804 - Detection - Testing finished...
2023-04-03 13:22:52,804 - Detection - Results saved in results/results_ADB.csv
2023-04-03 13:22:52,821 - Detection - Open Intent Detection Finished...
