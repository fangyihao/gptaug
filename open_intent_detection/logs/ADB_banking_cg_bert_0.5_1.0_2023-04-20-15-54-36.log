2023-04-20 15:54:36,925 - Detection - Open Intent Detection Begin...
2023-04-20 15:54:36,925 - Detection - Parameters Initialization...
2023-04-20 15:54:36,925 - Detection - ============================== Params ==============================
2023-04-20 15:54:36,926 - Detection - type:	open_intent_detection
2023-04-20 15:54:36,926 - Detection - logger_name:	Detection
2023-04-20 15:54:36,926 - Detection - log_dir:	logs
2023-04-20 15:54:36,926 - Detection - dataset:	banking_cg
2023-04-20 15:54:36,926 - Detection - known_cls_ratio:	0.5
2023-04-20 15:54:36,926 - Detection - labeled_ratio:	1.0
2023-04-20 15:54:36,926 - Detection - method:	ADB
2023-04-20 15:54:36,926 - Detection - train:	True
2023-04-20 15:54:36,926 - Detection - pretrain:	True
2023-04-20 15:54:36,926 - Detection - save_model:	True
2023-04-20 15:54:36,926 - Detection - backbone:	bert
2023-04-20 15:54:36,926 - Detection - config_file_name:	ADB
2023-04-20 15:54:36,926 - Detection - seed:	1
2023-04-20 15:54:36,926 - Detection - gpu_id:	0
2023-04-20 15:54:36,926 - Detection - pipe_results_path:	pipe_results
2023-04-20 15:54:36,926 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-20 15:54:36,926 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-20 15:54:36,926 - Detection - model_dir:	models
2023-04-20 15:54:36,926 - Detection - load_pretrained_method:	None
2023-04-20 15:54:36,926 - Detection - result_dir:	results
2023-04-20 15:54:36,926 - Detection - results_file_name:	results_ADB.csv
2023-04-20 15:54:36,926 - Detection - save_results:	True
2023-04-20 15:54:36,926 - Detection - loss_fct:	CrossEntropyLoss
2023-04-20 15:54:36,926 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.5_1.0_bert_1
2023-04-20 15:54:36,926 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.5_1.0_bert_1/models
2023-04-20 15:54:36,926 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-20 15:54:36,926 - Detection - num_train_epochs:	100
2023-04-20 15:54:36,926 - Detection - num_labels:	None
2023-04-20 15:54:36,926 - Detection - max_seq_length:	None
2023-04-20 15:54:36,926 - Detection - freeze_backbone_parameters:	True
2023-04-20 15:54:36,926 - Detection - feat_dim:	768
2023-04-20 15:54:36,926 - Detection - warmup_proportion:	0.1
2023-04-20 15:54:36,926 - Detection - lr_boundary:	0.05
2023-04-20 15:54:36,926 - Detection - lr:	2e-05
2023-04-20 15:54:36,926 - Detection - activation:	relu
2023-04-20 15:54:36,926 - Detection - train_batch_size:	128
2023-04-20 15:54:36,926 - Detection - eval_batch_size:	64
2023-04-20 15:54:36,926 - Detection - test_batch_size:	64
2023-04-20 15:54:36,926 - Detection - wait_patient:	10
2023-04-20 15:54:36,926 - Detection - ============================== End Params ==============================
2023-04-20 15:54:36,926 - Detection - Data and Model Preparation...
2023-04-20 15:54:36,927 - Detection - The number of known intents is 38
2023-04-20 15:54:36,927 - Detection - Lists of known labels are: ['edit_personal_details', 'lost_or_stolen_phone', 'declined_card_payment', 'why_verify_identity', 'top_up_by_cash_or_cheque', 'top_up_failed', 'top_up_reverted', 'receiving_money', 'failed_transfer', 'top_up_by_card_charge', 'card_about_to_expire', 'reverted_card_payment?', 'exchange_via_app', 'age_limit', 'verify_top_up', 'declined_cash_withdrawal', 'pending_card_payment', 'card_not_working', 'passcode_forgotten', 'card_swallowed', 'wrong_exchange_rate_for_cash_withdrawal', 'verify_source_of_funds', 'transaction_charged_twice', 'wrong_amount_of_cash_received', 'topping_up_by_card', 'extra_charge_on_statement', 'get_disposable_virtual_card', 'terminate_account', 'exchange_rate', 'transfer_timing', 'getting_spare_card', 'cash_withdrawal_not_recognised', 'unable_to_verify_identity', 'apple_pay_or_google_pay', 'order_physical_card', 'top_up_by_bank_transfer_charge', 'get_physical_card', 'pending_cash_withdrawal']
2023-04-20 15:54:36,936 - Detection - Number of labeled training samples = 1201
2023-04-20 15:54:36,936 - Detection - Number of unlabeled training samples = 1571
2023-04-20 15:54:36,938 - Detection - Number of evaluation samples = 397
2023-04-20 15:54:36,942 - Detection - Number of testing samples = 1896
2023-04-20 15:54:40,948 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-20 15:54:42,607 - Detection - Pre-training Begin...
2023-04-20 15:54:44,927 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 15:54:44,927 - Detection -   best_eval_score = 0
2023-04-20 15:54:44,927 - Detection -   eval_score = 2.02
2023-04-20 15:54:44,927 - Detection -   train_loss = 3.6437975406646728
2023-04-20 15:54:46,781 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 15:54:46,781 - Detection -   best_eval_score = 2.02
2023-04-20 15:54:46,781 - Detection -   eval_score = 2.77
2023-04-20 15:54:46,781 - Detection -   train_loss = 3.6296096086502074
2023-04-20 15:54:48,634 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 15:54:48,634 - Detection -   best_eval_score = 2.77
2023-04-20 15:54:48,634 - Detection -   eval_score = 6.8
2023-04-20 15:54:48,634 - Detection -   train_loss = 3.601590633392334
2023-04-20 15:54:50,468 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 15:54:50,468 - Detection -   best_eval_score = 6.8
2023-04-20 15:54:50,468 - Detection -   eval_score = 5.79
2023-04-20 15:54:50,468 - Detection -   train_loss = 3.5594207048416138
2023-04-20 15:54:52,295 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 15:54:52,295 - Detection -   best_eval_score = 6.8
2023-04-20 15:54:52,295 - Detection -   eval_score = 5.54
2023-04-20 15:54:52,295 - Detection -   train_loss = 3.495874810218811
2023-04-20 15:54:54,125 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 15:54:54,125 - Detection -   best_eval_score = 6.8
2023-04-20 15:54:54,125 - Detection -   eval_score = 6.3
2023-04-20 15:54:54,125 - Detection -   train_loss = 3.4016782522201536
2023-04-20 15:54:55,956 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 15:54:55,956 - Detection -   best_eval_score = 6.8
2023-04-20 15:54:55,956 - Detection -   eval_score = 17.63
2023-04-20 15:54:55,956 - Detection -   train_loss = 3.2559887170791626
2023-04-20 15:54:57,844 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 15:54:57,844 - Detection -   best_eval_score = 17.63
2023-04-20 15:54:57,844 - Detection -   eval_score = 28.72
2023-04-20 15:54:57,844 - Detection -   train_loss = 3.023286056518555
2023-04-20 15:54:59,716 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 15:54:59,716 - Detection -   best_eval_score = 28.72
2023-04-20 15:54:59,716 - Detection -   eval_score = 35.77
2023-04-20 15:54:59,716 - Detection -   train_loss = 2.7215062379837036
2023-04-20 15:55:01,627 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 15:55:01,627 - Detection -   best_eval_score = 35.77
2023-04-20 15:55:01,627 - Detection -   eval_score = 39.8
2023-04-20 15:55:01,627 - Detection -   train_loss = 2.3770352363586427
2023-04-20 15:55:03,514 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 15:55:03,514 - Detection -   best_eval_score = 39.8
2023-04-20 15:55:03,514 - Detection -   eval_score = 45.09
2023-04-20 15:55:03,514 - Detection -   train_loss = 2.0234278440475464
2023-04-20 15:55:05,418 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 15:55:05,418 - Detection -   best_eval_score = 45.09
2023-04-20 15:55:05,418 - Detection -   eval_score = 51.39
2023-04-20 15:55:05,418 - Detection -   train_loss = 1.7249624133110046
2023-04-20 15:55:07,332 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 15:55:07,332 - Detection -   best_eval_score = 51.39
2023-04-20 15:55:07,332 - Detection -   eval_score = 58.19
2023-04-20 15:55:07,332 - Detection -   train_loss = 1.4631510138511659
2023-04-20 15:55:09,255 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 15:55:09,255 - Detection -   best_eval_score = 58.19
2023-04-20 15:55:09,255 - Detection -   eval_score = 65.74
2023-04-20 15:55:09,255 - Detection -   train_loss = 1.2690135836601257
2023-04-20 15:55:11,201 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 15:55:11,201 - Detection -   best_eval_score = 65.74
2023-04-20 15:55:11,202 - Detection -   eval_score = 67.25
2023-04-20 15:55:11,202 - Detection -   train_loss = 1.105798500776291
2023-04-20 15:55:13,176 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 15:55:13,176 - Detection -   best_eval_score = 67.25
2023-04-20 15:55:13,176 - Detection -   eval_score = 70.53
2023-04-20 15:55:13,176 - Detection -   train_loss = 0.9387868404388428
2023-04-20 15:55:15,216 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 15:55:15,216 - Detection -   best_eval_score = 70.53
2023-04-20 15:55:15,216 - Detection -   eval_score = 72.04
2023-04-20 15:55:15,216 - Detection -   train_loss = 0.8225301504135132
2023-04-20 15:55:17,169 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 15:55:17,169 - Detection -   best_eval_score = 72.04
2023-04-20 15:55:17,169 - Detection -   eval_score = 73.55
2023-04-20 15:55:17,169 - Detection -   train_loss = 0.7377370834350586
2023-04-20 15:55:19,124 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 15:55:19,124 - Detection -   best_eval_score = 73.55
2023-04-20 15:55:19,124 - Detection -   eval_score = 74.56
2023-04-20 15:55:19,124 - Detection -   train_loss = 0.6674528777599334
2023-04-20 15:55:21,080 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 15:55:21,080 - Detection -   best_eval_score = 74.56
2023-04-20 15:55:21,080 - Detection -   eval_score = 76.07
2023-04-20 15:55:21,081 - Detection -   train_loss = 0.6079452872276306
2023-04-20 15:55:23,038 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 15:55:23,038 - Detection -   best_eval_score = 76.07
2023-04-20 15:55:23,039 - Detection -   eval_score = 76.57
2023-04-20 15:55:23,039 - Detection -   train_loss = 0.5474713623523713
2023-04-20 15:55:25,001 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 15:55:25,001 - Detection -   best_eval_score = 76.57
2023-04-20 15:55:25,001 - Detection -   eval_score = 76.57
2023-04-20 15:55:25,001 - Detection -   train_loss = 0.5021046608686447
2023-04-20 15:55:26,955 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 15:55:26,955 - Detection -   best_eval_score = 76.57
2023-04-20 15:55:26,955 - Detection -   eval_score = 77.08
2023-04-20 15:55:26,955 - Detection -   train_loss = 0.46258815824985505
2023-04-20 15:55:28,919 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 15:55:28,919 - Detection -   best_eval_score = 77.08
2023-04-20 15:55:28,919 - Detection -   eval_score = 76.83
2023-04-20 15:55:28,919 - Detection -   train_loss = 0.4172411859035492
2023-04-20 15:55:30,882 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 15:55:30,883 - Detection -   best_eval_score = 77.08
2023-04-20 15:55:30,883 - Detection -   eval_score = 77.33
2023-04-20 15:55:30,883 - Detection -   train_loss = 0.3887774646282196
2023-04-20 15:55:32,846 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 15:55:32,846 - Detection -   best_eval_score = 77.33
2023-04-20 15:55:32,846 - Detection -   eval_score = 76.83
2023-04-20 15:55:32,846 - Detection -   train_loss = 0.36901578307151794
2023-04-20 15:55:34,800 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 15:55:34,800 - Detection -   best_eval_score = 77.33
2023-04-20 15:55:34,800 - Detection -   eval_score = 78.59
2023-04-20 15:55:34,800 - Detection -   train_loss = 0.34428061842918395
2023-04-20 15:55:36,769 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 15:55:36,769 - Detection -   best_eval_score = 78.59
2023-04-20 15:55:36,769 - Detection -   eval_score = 78.59
2023-04-20 15:55:36,769 - Detection -   train_loss = 0.3163801908493042
2023-04-20 15:55:38,726 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 15:55:38,726 - Detection -   best_eval_score = 78.59
2023-04-20 15:55:38,726 - Detection -   eval_score = 78.84
2023-04-20 15:55:38,726 - Detection -   train_loss = 0.29891767501831057
2023-04-20 15:55:40,686 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 15:55:40,686 - Detection -   best_eval_score = 78.84
2023-04-20 15:55:40,686 - Detection -   eval_score = 80.1
2023-04-20 15:55:40,686 - Detection -   train_loss = 0.29121900498867037
2023-04-20 15:55:42,655 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 15:55:42,656 - Detection -   best_eval_score = 80.1
2023-04-20 15:55:42,656 - Detection -   eval_score = 78.34
2023-04-20 15:55:42,656 - Detection -   train_loss = 0.2716096192598343
2023-04-20 15:55:44,606 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 15:55:44,606 - Detection -   best_eval_score = 80.1
2023-04-20 15:55:44,606 - Detection -   eval_score = 80.1
2023-04-20 15:55:44,606 - Detection -   train_loss = 0.26482990831136705
2023-04-20 15:55:46,562 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 15:55:46,562 - Detection -   best_eval_score = 80.1
2023-04-20 15:55:46,562 - Detection -   eval_score = 79.35
2023-04-20 15:55:46,562 - Detection -   train_loss = 0.24568612426519393
2023-04-20 15:55:48,516 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 15:55:48,517 - Detection -   best_eval_score = 80.1
2023-04-20 15:55:48,517 - Detection -   eval_score = 79.85
2023-04-20 15:55:48,517 - Detection -   train_loss = 0.2421707645058632
2023-04-20 15:55:50,471 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 15:55:50,471 - Detection -   best_eval_score = 80.1
2023-04-20 15:55:50,471 - Detection -   eval_score = 80.1
2023-04-20 15:55:50,471 - Detection -   train_loss = 0.22055332362651825
2023-04-20 15:55:52,433 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 15:55:52,433 - Detection -   best_eval_score = 80.1
2023-04-20 15:55:52,433 - Detection -   eval_score = 80.6
2023-04-20 15:55:52,433 - Detection -   train_loss = 0.20607281923294068
2023-04-20 15:55:54,403 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 15:55:54,403 - Detection -   best_eval_score = 80.6
2023-04-20 15:55:54,404 - Detection -   eval_score = 80.1
2023-04-20 15:55:54,404 - Detection -   train_loss = 0.20288733690977095
2023-04-20 15:55:56,362 - Detection - ***** Epoch: 38: Eval results *****
2023-04-20 15:55:56,362 - Detection -   best_eval_score = 80.6
2023-04-20 15:55:56,362 - Detection -   eval_score = 80.1
2023-04-20 15:55:56,363 - Detection -   train_loss = 0.1876268595457077
2023-04-20 15:55:58,323 - Detection - ***** Epoch: 39: Eval results *****
2023-04-20 15:55:58,324 - Detection -   best_eval_score = 80.6
2023-04-20 15:55:58,324 - Detection -   eval_score = 81.11
2023-04-20 15:55:58,324 - Detection -   train_loss = 0.17983371764421463
2023-04-20 15:56:00,298 - Detection - ***** Epoch: 40: Eval results *****
2023-04-20 15:56:00,298 - Detection -   best_eval_score = 81.11
2023-04-20 15:56:00,298 - Detection -   eval_score = 80.6
2023-04-20 15:56:00,298 - Detection -   train_loss = 0.17174134254455567
2023-04-20 15:56:02,255 - Detection - ***** Epoch: 41: Eval results *****
2023-04-20 15:56:02,255 - Detection -   best_eval_score = 81.11
2023-04-20 15:56:02,255 - Detection -   eval_score = 80.6
2023-04-20 15:56:02,255 - Detection -   train_loss = 0.16405653059482575
2023-04-20 15:56:04,206 - Detection - ***** Epoch: 42: Eval results *****
2023-04-20 15:56:04,206 - Detection -   best_eval_score = 81.11
2023-04-20 15:56:04,206 - Detection -   eval_score = 81.36
2023-04-20 15:56:04,206 - Detection -   train_loss = 0.16916027218103408
2023-04-20 15:56:06,172 - Detection - ***** Epoch: 43: Eval results *****
2023-04-20 15:56:06,172 - Detection -   best_eval_score = 81.36
2023-04-20 15:56:06,172 - Detection -   eval_score = 80.86
2023-04-20 15:56:06,172 - Detection -   train_loss = 0.1556151896715164
2023-04-20 15:56:08,127 - Detection - ***** Epoch: 44: Eval results *****
2023-04-20 15:56:08,128 - Detection -   best_eval_score = 81.36
2023-04-20 15:56:08,128 - Detection -   eval_score = 80.86
2023-04-20 15:56:08,128 - Detection -   train_loss = 0.15348039269447328
2023-04-20 15:56:10,101 - Detection - ***** Epoch: 45: Eval results *****
2023-04-20 15:56:10,101 - Detection -   best_eval_score = 81.36
2023-04-20 15:56:10,102 - Detection -   eval_score = 80.86
2023-04-20 15:56:10,102 - Detection -   train_loss = 0.14575316458940507
2023-04-20 15:56:12,153 - Detection - ***** Epoch: 46: Eval results *****
2023-04-20 15:56:12,154 - Detection -   best_eval_score = 81.36
2023-04-20 15:56:12,154 - Detection -   eval_score = 81.36
2023-04-20 15:56:12,154 - Detection -   train_loss = 0.1436816468834877
2023-04-20 15:56:14,161 - Detection - ***** Epoch: 47: Eval results *****
2023-04-20 15:56:14,161 - Detection -   best_eval_score = 81.36
2023-04-20 15:56:14,161 - Detection -   eval_score = 81.11
2023-04-20 15:56:14,161 - Detection -   train_loss = 0.13973112255334855
2023-04-20 15:56:16,171 - Detection - ***** Epoch: 48: Eval results *****
2023-04-20 15:56:16,171 - Detection -   best_eval_score = 81.36
2023-04-20 15:56:16,171 - Detection -   eval_score = 81.86
2023-04-20 15:56:16,171 - Detection -   train_loss = 0.13276896998286247
2023-04-20 15:56:18,189 - Detection - ***** Epoch: 49: Eval results *****
2023-04-20 15:56:18,189 - Detection -   best_eval_score = 81.86
2023-04-20 15:56:18,189 - Detection -   eval_score = 81.86
2023-04-20 15:56:18,189 - Detection -   train_loss = 0.13296744152903556
2023-04-20 15:56:20,154 - Detection - ***** Epoch: 50: Eval results *****
2023-04-20 15:56:20,154 - Detection -   best_eval_score = 81.86
2023-04-20 15:56:20,154 - Detection -   eval_score = 81.86
2023-04-20 15:56:20,154 - Detection -   train_loss = 0.12973631396889687
2023-04-20 15:56:22,123 - Detection - ***** Epoch: 51: Eval results *****
2023-04-20 15:56:22,123 - Detection -   best_eval_score = 81.86
2023-04-20 15:56:22,123 - Detection -   eval_score = 82.12
2023-04-20 15:56:22,123 - Detection -   train_loss = 0.12476123720407487
2023-04-20 15:56:24,096 - Detection - ***** Epoch: 52: Eval results *****
2023-04-20 15:56:24,096 - Detection -   best_eval_score = 82.12
2023-04-20 15:56:24,096 - Detection -   eval_score = 81.86
2023-04-20 15:56:24,096 - Detection -   train_loss = 0.12170133665204048
2023-04-20 15:56:26,061 - Detection - ***** Epoch: 53: Eval results *****
2023-04-20 15:56:26,061 - Detection -   best_eval_score = 82.12
2023-04-20 15:56:26,061 - Detection -   eval_score = 81.61
2023-04-20 15:56:26,061 - Detection -   train_loss = 0.11442763954401017
2023-04-20 15:56:28,025 - Detection - ***** Epoch: 54: Eval results *****
2023-04-20 15:56:28,025 - Detection -   best_eval_score = 82.12
2023-04-20 15:56:28,026 - Detection -   eval_score = 81.61
2023-04-20 15:56:28,026 - Detection -   train_loss = 0.1131804533302784
2023-04-20 15:56:30,035 - Detection - ***** Epoch: 55: Eval results *****
2023-04-20 15:56:30,035 - Detection -   best_eval_score = 82.12
2023-04-20 15:56:30,035 - Detection -   eval_score = 82.12
2023-04-20 15:56:30,035 - Detection -   train_loss = 0.1152667872607708
2023-04-20 15:56:32,035 - Detection - ***** Epoch: 56: Eval results *****
2023-04-20 15:56:32,035 - Detection -   best_eval_score = 82.12
2023-04-20 15:56:32,035 - Detection -   eval_score = 82.12
2023-04-20 15:56:32,035 - Detection -   train_loss = 0.11469759419560432
2023-04-20 15:56:34,033 - Detection - ***** Epoch: 57: Eval results *****
2023-04-20 15:56:34,033 - Detection -   best_eval_score = 82.12
2023-04-20 15:56:34,033 - Detection -   eval_score = 81.86
2023-04-20 15:56:34,033 - Detection -   train_loss = 0.1025258645415306
2023-04-20 15:56:35,990 - Detection - ***** Epoch: 58: Eval results *****
2023-04-20 15:56:35,990 - Detection -   best_eval_score = 82.12
2023-04-20 15:56:35,990 - Detection -   eval_score = 81.11
2023-04-20 15:56:35,990 - Detection -   train_loss = 0.10801508873701096
2023-04-20 15:56:37,946 - Detection - ***** Epoch: 59: Eval results *****
2023-04-20 15:56:37,946 - Detection -   best_eval_score = 82.12
2023-04-20 15:56:37,946 - Detection -   eval_score = 81.11
2023-04-20 15:56:37,946 - Detection -   train_loss = 0.09991698935627938
2023-04-20 15:56:39,911 - Detection - ***** Epoch: 60: Eval results *****
2023-04-20 15:56:39,912 - Detection -   best_eval_score = 82.12
2023-04-20 15:56:39,912 - Detection -   eval_score = 81.11
2023-04-20 15:56:39,912 - Detection -   train_loss = 0.09811239093542098
2023-04-20 15:56:41,871 - Detection - ***** Epoch: 61: Eval results *****
2023-04-20 15:56:41,871 - Detection -   best_eval_score = 82.12
2023-04-20 15:56:41,871 - Detection -   eval_score = 81.86
2023-04-20 15:56:41,871 - Detection -   train_loss = 0.10117536336183548
2023-04-20 15:56:41,872 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.5_1.0_bert_1/models
2023-04-20 15:56:42,421 - Detection - Pre-training finished...
2023-04-20 15:56:42,422 - Detection - Training Begin...
2023-04-20 15:56:45,649 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 15:56:45,649 - Detection -   best_eval_score = 0
2023-04-20 15:56:45,649 - Detection -   eval_score = 0.0
2023-04-20 15:56:45,649 - Detection -   train_loss = 11.337388134002685
2023-04-20 15:56:47,582 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 15:56:47,582 - Detection -   best_eval_score = 0
2023-04-20 15:56:47,582 - Detection -   eval_score = 0.0
2023-04-20 15:56:47,582 - Detection -   train_loss = 11.049053478240968
2023-04-20 15:56:49,517 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 15:56:49,517 - Detection -   best_eval_score = 0
2023-04-20 15:56:49,517 - Detection -   eval_score = 0.0
2023-04-20 15:56:49,517 - Detection -   train_loss = 10.715829658508301
2023-04-20 15:56:51,448 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 15:56:51,448 - Detection -   best_eval_score = 0
2023-04-20 15:56:51,448 - Detection -   eval_score = 0.0
2023-04-20 15:56:51,448 - Detection -   train_loss = 10.339863491058349
2023-04-20 15:56:53,376 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 15:56:53,376 - Detection -   best_eval_score = 0
2023-04-20 15:56:53,376 - Detection -   eval_score = 0.0
2023-04-20 15:56:53,376 - Detection -   train_loss = 9.932588672637939
2023-04-20 15:56:55,309 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 15:56:55,309 - Detection -   best_eval_score = 0
2023-04-20 15:56:55,310 - Detection -   eval_score = 0.0
2023-04-20 15:56:55,310 - Detection -   train_loss = 9.46134157180786
2023-04-20 15:56:57,246 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 15:56:57,246 - Detection -   best_eval_score = 0
2023-04-20 15:56:57,246 - Detection -   eval_score = 0.0
2023-04-20 15:56:57,246 - Detection -   train_loss = 9.048204708099366
2023-04-20 15:56:59,187 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 15:56:59,187 - Detection -   best_eval_score = 0
2023-04-20 15:56:59,187 - Detection -   eval_score = 0.0
2023-04-20 15:56:59,187 - Detection -   train_loss = 8.559250926971435
2023-04-20 15:57:01,128 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 15:57:01,128 - Detection -   best_eval_score = 0
2023-04-20 15:57:01,128 - Detection -   eval_score = 0.28
2023-04-20 15:57:01,128 - Detection -   train_loss = 8.018721675872802
2023-04-20 15:57:03,067 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 15:57:03,067 - Detection -   best_eval_score = 0.28
2023-04-20 15:57:03,067 - Detection -   eval_score = 2.65
2023-04-20 15:57:03,067 - Detection -   train_loss = 7.505667018890381
2023-04-20 15:57:04,998 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 15:57:04,998 - Detection -   best_eval_score = 2.65
2023-04-20 15:57:04,998 - Detection -   eval_score = 6.54
2023-04-20 15:57:04,998 - Detection -   train_loss = 6.988113594055176
2023-04-20 15:57:06,933 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 15:57:06,933 - Detection -   best_eval_score = 6.54
2023-04-20 15:57:06,933 - Detection -   eval_score = 10.41
2023-04-20 15:57:06,933 - Detection -   train_loss = 6.52511248588562
2023-04-20 15:57:08,867 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 15:57:08,867 - Detection -   best_eval_score = 10.41
2023-04-20 15:57:08,867 - Detection -   eval_score = 15.4
2023-04-20 15:57:08,867 - Detection -   train_loss = 6.006581115722656
2023-04-20 15:57:10,807 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 15:57:10,807 - Detection -   best_eval_score = 15.4
2023-04-20 15:57:10,807 - Detection -   eval_score = 19.56
2023-04-20 15:57:10,807 - Detection -   train_loss = 5.539661312103272
2023-04-20 15:57:12,741 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 15:57:12,742 - Detection -   best_eval_score = 19.56
2023-04-20 15:57:12,742 - Detection -   eval_score = 21.93
2023-04-20 15:57:12,742 - Detection -   train_loss = 5.004423904418945
2023-04-20 15:57:14,680 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 15:57:14,680 - Detection -   best_eval_score = 21.93
2023-04-20 15:57:14,680 - Detection -   eval_score = 26.72
2023-04-20 15:57:14,680 - Detection -   train_loss = 4.565030479431153
2023-04-20 15:57:16,613 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 15:57:16,613 - Detection -   best_eval_score = 26.72
2023-04-20 15:57:16,613 - Detection -   eval_score = 32.46
2023-04-20 15:57:16,613 - Detection -   train_loss = 4.0711753368377686
2023-04-20 15:57:18,548 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 15:57:18,548 - Detection -   best_eval_score = 32.46
2023-04-20 15:57:18,548 - Detection -   eval_score = 39.71
2023-04-20 15:57:18,548 - Detection -   train_loss = 3.601123833656311
2023-04-20 15:57:20,482 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 15:57:20,482 - Detection -   best_eval_score = 39.71
2023-04-20 15:57:20,483 - Detection -   eval_score = 45.56
2023-04-20 15:57:20,483 - Detection -   train_loss = 3.139050555229187
2023-04-20 15:57:22,411 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 15:57:22,411 - Detection -   best_eval_score = 45.56
2023-04-20 15:57:22,411 - Detection -   eval_score = 50.43
2023-04-20 15:57:22,411 - Detection -   train_loss = 2.6689544916152954
2023-04-20 15:57:24,352 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 15:57:24,353 - Detection -   best_eval_score = 50.43
2023-04-20 15:57:24,353 - Detection -   eval_score = 56.34
2023-04-20 15:57:24,353 - Detection -   train_loss = 2.3023874044418333
2023-04-20 15:57:26,289 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 15:57:26,289 - Detection -   best_eval_score = 56.34
2023-04-20 15:57:26,289 - Detection -   eval_score = 59.03
2023-04-20 15:57:26,289 - Detection -   train_loss = 1.9438390374183654
2023-04-20 15:57:28,224 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 15:57:28,224 - Detection -   best_eval_score = 59.03
2023-04-20 15:57:28,224 - Detection -   eval_score = 60.24
2023-04-20 15:57:28,224 - Detection -   train_loss = 1.7419532537460327
2023-04-20 15:57:30,156 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 15:57:30,157 - Detection -   best_eval_score = 60.24
2023-04-20 15:57:30,157 - Detection -   eval_score = 62.57
2023-04-20 15:57:30,157 - Detection -   train_loss = 1.523679518699646
2023-04-20 15:57:32,088 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 15:57:32,088 - Detection -   best_eval_score = 62.57
2023-04-20 15:57:32,088 - Detection -   eval_score = 64.76
2023-04-20 15:57:32,088 - Detection -   train_loss = 1.472267246246338
2023-04-20 15:57:34,020 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 15:57:34,020 - Detection -   best_eval_score = 64.76
2023-04-20 15:57:34,020 - Detection -   eval_score = 66.13
2023-04-20 15:57:34,020 - Detection -   train_loss = 1.398759162425995
2023-04-20 15:57:35,949 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 15:57:35,949 - Detection -   best_eval_score = 66.13
2023-04-20 15:57:35,949 - Detection -   eval_score = 67.73
2023-04-20 15:57:35,949 - Detection -   train_loss = 1.3596417427062988
2023-04-20 15:57:37,884 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 15:57:37,884 - Detection -   best_eval_score = 67.73
2023-04-20 15:57:37,884 - Detection -   eval_score = 67.84
2023-04-20 15:57:37,884 - Detection -   train_loss = 1.3086097836494446
2023-04-20 15:57:39,820 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 15:57:39,820 - Detection -   best_eval_score = 67.84
2023-04-20 15:57:39,820 - Detection -   eval_score = 68.21
2023-04-20 15:57:39,820 - Detection -   train_loss = 1.3007784843444825
2023-04-20 15:57:41,757 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 15:57:41,757 - Detection -   best_eval_score = 68.21
2023-04-20 15:57:41,757 - Detection -   eval_score = 68.4
2023-04-20 15:57:41,757 - Detection -   train_loss = 1.2805077672004699
2023-04-20 15:57:43,783 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 15:57:43,783 - Detection -   best_eval_score = 68.4
2023-04-20 15:57:43,783 - Detection -   eval_score = 68.71
2023-04-20 15:57:43,783 - Detection -   train_loss = 1.281531071662903
2023-04-20 15:57:45,710 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 15:57:45,710 - Detection -   best_eval_score = 68.71
2023-04-20 15:57:45,710 - Detection -   eval_score = 68.68
2023-04-20 15:57:45,710 - Detection -   train_loss = 1.3332122325897218
2023-04-20 15:57:47,639 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 15:57:47,639 - Detection -   best_eval_score = 68.71
2023-04-20 15:57:47,639 - Detection -   eval_score = 68.68
2023-04-20 15:57:47,639 - Detection -   train_loss = 1.2965530157089233
2023-04-20 15:57:49,570 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 15:57:49,570 - Detection -   best_eval_score = 68.71
2023-04-20 15:57:49,570 - Detection -   eval_score = 68.57
2023-04-20 15:57:49,570 - Detection -   train_loss = 1.2890579223632812
2023-04-20 15:57:51,497 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 15:57:51,497 - Detection -   best_eval_score = 68.71
2023-04-20 15:57:51,497 - Detection -   eval_score = 69.26
2023-04-20 15:57:51,497 - Detection -   train_loss = 1.2875834465026856
2023-04-20 15:57:53,431 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 15:57:53,431 - Detection -   best_eval_score = 69.26
2023-04-20 15:57:53,431 - Detection -   eval_score = 68.49
2023-04-20 15:57:53,431 - Detection -   train_loss = 1.29253488779068
2023-04-20 15:57:55,363 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 15:57:55,363 - Detection -   best_eval_score = 69.26
2023-04-20 15:57:55,363 - Detection -   eval_score = 68.86
2023-04-20 15:57:55,363 - Detection -   train_loss = 1.265070867538452
2023-04-20 15:57:57,291 - Detection - ***** Epoch: 38: Eval results *****
2023-04-20 15:57:57,291 - Detection -   best_eval_score = 69.26
2023-04-20 15:57:57,291 - Detection -   eval_score = 68.62
2023-04-20 15:57:57,291 - Detection -   train_loss = 1.2592759728431702
2023-04-20 15:57:59,215 - Detection - ***** Epoch: 39: Eval results *****
2023-04-20 15:57:59,215 - Detection -   best_eval_score = 69.26
2023-04-20 15:57:59,215 - Detection -   eval_score = 68.73
2023-04-20 15:57:59,215 - Detection -   train_loss = 1.281674873828888
2023-04-20 15:58:01,150 - Detection - ***** Epoch: 40: Eval results *****
2023-04-20 15:58:01,150 - Detection -   best_eval_score = 69.26
2023-04-20 15:58:01,150 - Detection -   eval_score = 69.81
2023-04-20 15:58:01,150 - Detection -   train_loss = 1.2788453102111816
2023-04-20 15:58:03,082 - Detection - ***** Epoch: 41: Eval results *****
2023-04-20 15:58:03,083 - Detection -   best_eval_score = 69.81
2023-04-20 15:58:03,083 - Detection -   eval_score = 69.9
2023-04-20 15:58:03,083 - Detection -   train_loss = 1.3122649550437928
2023-04-20 15:58:05,009 - Detection - ***** Epoch: 42: Eval results *****
2023-04-20 15:58:05,009 - Detection -   best_eval_score = 69.9
2023-04-20 15:58:05,009 - Detection -   eval_score = 68.71
2023-04-20 15:58:05,009 - Detection -   train_loss = 1.281362807750702
2023-04-20 15:58:06,942 - Detection - ***** Epoch: 43: Eval results *****
2023-04-20 15:58:06,942 - Detection -   best_eval_score = 69.9
2023-04-20 15:58:06,942 - Detection -   eval_score = 69.0
2023-04-20 15:58:06,942 - Detection -   train_loss = 1.2716479778289795
2023-04-20 15:58:08,868 - Detection - ***** Epoch: 44: Eval results *****
2023-04-20 15:58:08,868 - Detection -   best_eval_score = 69.9
2023-04-20 15:58:08,868 - Detection -   eval_score = 69.0
2023-04-20 15:58:08,868 - Detection -   train_loss = 1.277543580532074
2023-04-20 15:58:10,799 - Detection - ***** Epoch: 45: Eval results *****
2023-04-20 15:58:10,799 - Detection -   best_eval_score = 69.9
2023-04-20 15:58:10,799 - Detection -   eval_score = 69.0
2023-04-20 15:58:10,799 - Detection -   train_loss = 1.2684824824333192
2023-04-20 15:58:12,729 - Detection - ***** Epoch: 46: Eval results *****
2023-04-20 15:58:12,729 - Detection -   best_eval_score = 69.9
2023-04-20 15:58:12,729 - Detection -   eval_score = 69.0
2023-04-20 15:58:12,729 - Detection -   train_loss = 1.3346819043159486
2023-04-20 15:58:14,659 - Detection - ***** Epoch: 47: Eval results *****
2023-04-20 15:58:14,659 - Detection -   best_eval_score = 69.9
2023-04-20 15:58:14,659 - Detection -   eval_score = 68.95
2023-04-20 15:58:14,659 - Detection -   train_loss = 1.2564780116081238
2023-04-20 15:58:16,587 - Detection - ***** Epoch: 48: Eval results *****
2023-04-20 15:58:16,588 - Detection -   best_eval_score = 69.9
2023-04-20 15:58:16,588 - Detection -   eval_score = 68.44
2023-04-20 15:58:16,588 - Detection -   train_loss = 1.286353302001953
2023-04-20 15:58:18,517 - Detection - ***** Epoch: 49: Eval results *****
2023-04-20 15:58:18,517 - Detection -   best_eval_score = 69.9
2023-04-20 15:58:18,517 - Detection -   eval_score = 68.84
2023-04-20 15:58:18,517 - Detection -   train_loss = 1.2718083024024964
2023-04-20 15:58:20,447 - Detection - ***** Epoch: 50: Eval results *****
2023-04-20 15:58:20,447 - Detection -   best_eval_score = 69.9
2023-04-20 15:58:20,447 - Detection -   eval_score = 68.84
2023-04-20 15:58:20,447 - Detection -   train_loss = 1.2927833199501038
2023-04-20 15:58:22,377 - Detection - ***** Epoch: 51: Eval results *****
2023-04-20 15:58:22,378 - Detection -   best_eval_score = 69.9
2023-04-20 15:58:22,378 - Detection -   eval_score = 68.84
2023-04-20 15:58:22,378 - Detection -   train_loss = 1.3122944831848145
2023-04-20 15:58:22,379 - Detection - Training Finished...
2023-04-20 15:58:22,379 - Detection - Testing begin...
2023-04-20 15:58:24,449 - Detection - ***** Test: Confusion Matrix *****
2023-04-20 15:58:24,449 - Detection - [[ 23   0   0 ...   0   0   4]
 [  0  18   0 ...   0   0   5]
 [  0   0  18 ...   0   0  10]
 ...
 [  0   0   0 ...  12   0   6]
 [  0   0   0 ...   0  19   7]
 [  0   2  10 ...   6   2 612]]
2023-04-20 15:58:24,449 - Detection - ***** Test results *****
2023-04-20 15:58:24,449 - Detection -   Acc = 65.72
2023-04-20 15:58:24,449 - Detection -   F1 = 62.2175
2023-04-20 15:58:24,449 - Detection -   F1-known = 62.0411
2023-04-20 15:58:24,449 - Detection -   F1-open = 68.9189
2023-04-20 15:58:24,449 - Detection - Testing finished...
2023-04-20 15:58:24,450 - Detection - Results saved in results/results_ADB.csv
2023-04-20 15:58:24,471 - Detection - Open Intent Detection Finished...
