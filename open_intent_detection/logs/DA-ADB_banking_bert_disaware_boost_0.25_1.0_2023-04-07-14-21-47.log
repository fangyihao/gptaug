2023-04-07 14:21:47,294 - Detection - Open Intent Detection Begin...
2023-04-07 14:21:47,294 - Detection - Parameters Initialization...
2023-04-07 14:21:47,294 - Detection - ============================== Params ==============================
2023-04-07 14:21:47,294 - Detection - type:	open_intent_detection
2023-04-07 14:21:47,294 - Detection - logger_name:	Detection
2023-04-07 14:21:47,294 - Detection - log_dir:	logs
2023-04-07 14:21:47,294 - Detection - dataset:	banking
2023-04-07 14:21:47,294 - Detection - known_cls_ratio:	0.25
2023-04-07 14:21:47,294 - Detection - labeled_ratio:	1.0
2023-04-07 14:21:47,294 - Detection - method:	DA-ADB
2023-04-07 14:21:47,294 - Detection - train:	True
2023-04-07 14:21:47,294 - Detection - pretrain:	True
2023-04-07 14:21:47,294 - Detection - save_model:	True
2023-04-07 14:21:47,294 - Detection - backbone:	bert_disaware_boost
2023-04-07 14:21:47,294 - Detection - config_file_name:	DA-ADB
2023-04-07 14:21:47,294 - Detection - seed:	0
2023-04-07 14:21:47,294 - Detection - gpu_id:	0
2023-04-07 14:21:47,294 - Detection - pipe_results_path:	pipe_results
2023-04-07 14:21:47,294 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-07 14:21:47,294 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-07 14:21:47,294 - Detection - model_dir:	models
2023-04-07 14:21:47,294 - Detection - load_pretrained_method:	None
2023-04-07 14:21:47,294 - Detection - result_dir:	results
2023-04-07 14:21:47,294 - Detection - results_file_name:	results_DA-ADB-BOOST.csv
2023-04-07 14:21:47,294 - Detection - save_results:	True
2023-04-07 14:21:47,294 - Detection - loss_fct:	CrossEntropyLoss
2023-04-07 14:21:47,294 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_0.25_1.0_bert_disaware_boost_0
2023-04-07 14:21:47,294 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_0.25_1.0_bert_disaware_boost_0/models
2023-04-07 14:21:47,294 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-07 14:21:47,294 - Detection - num_train_epochs:	100
2023-04-07 14:21:47,294 - Detection - num_labels:	None
2023-04-07 14:21:47,294 - Detection - max_seq_length:	None
2023-04-07 14:21:47,294 - Detection - freeze_backbone_parameters:	True
2023-04-07 14:21:47,294 - Detection - feat_dim:	768
2023-04-07 14:21:47,294 - Detection - warmup_proportion:	0.1
2023-04-07 14:21:47,295 - Detection - scale:	4
2023-04-07 14:21:47,295 - Detection - lr_boundary:	0.05
2023-04-07 14:21:47,295 - Detection - lr:	2e-05
2023-04-07 14:21:47,295 - Detection - activation:	relu
2023-04-07 14:21:47,295 - Detection - train_batch_size:	128
2023-04-07 14:21:47,295 - Detection - eval_batch_size:	64
2023-04-07 14:21:47,295 - Detection - test_batch_size:	64
2023-04-07 14:21:47,295 - Detection - wait_patient:	10
2023-04-07 14:21:47,295 - Detection - ============================== End Params ==============================
2023-04-07 14:21:47,295 - Detection - Data and Model Preparation...
2023-04-07 14:21:47,295 - Detection - The number of known intents is 19
2023-04-07 14:21:47,295 - Detection - Lists of known labels are: ['pending_top_up', 'why_verify_identity', 'top_up_failed', 'supported_cards_and_currencies', 'exchange_via_app', 'declined_card_payment', 'unable_to_verify_identity', 'exchange_rate', 'passcode_forgotten', 'verify_my_identity', 'declined_cash_withdrawal', 'top_up_limits', 'apple_pay_or_google_pay', 'lost_or_stolen_card', 'lost_or_stolen_phone', 'balance_not_updated_after_cheque_or_cash_deposit', 'change_pin', 'getting_virtual_card', 'pin_blocked']
2023-04-07 14:21:47,320 - Detection - Number of labeled training samples = 2119
2023-04-07 14:21:47,320 - Detection - Number of unlabeled training samples = 6884
2023-04-07 14:21:47,322 - Detection - Number of evaluation samples = 234
2023-04-07 14:21:47,329 - Detection - Number of testing samples = 3080
2023-04-07 14:21:54,238 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-07 14:21:54,319 - Detection - Pre-training Begin...
2023-04-07 14:21:59,322 - Detection - ***** Epoch: 1: Eval results *****
2023-04-07 14:21:59,322 - Detection -   best_eval_score = 0
2023-04-07 14:21:59,322 - Detection -   eval_score = 0.63
2023-04-07 14:21:59,322 - Detection -   train_loss = 2.945636973661535
2023-04-07 14:22:03,847 - Detection - ***** Epoch: 2: Eval results *****
2023-04-07 14:22:03,847 - Detection -   best_eval_score = 0.63
2023-04-07 14:22:03,847 - Detection -   eval_score = 0.76
2023-04-07 14:22:03,847 - Detection -   train_loss = 2.9285099506378174
2023-04-07 14:22:08,395 - Detection - ***** Epoch: 3: Eval results *****
2023-04-07 14:22:08,395 - Detection -   best_eval_score = 0.76
2023-04-07 14:22:08,395 - Detection -   eval_score = 1.32
2023-04-07 14:22:08,395 - Detection -   train_loss = 2.9088826880735508
2023-04-07 14:22:12,958 - Detection - ***** Epoch: 4: Eval results *****
2023-04-07 14:22:12,958 - Detection -   best_eval_score = 1.32
2023-04-07 14:22:12,958 - Detection -   eval_score = 1.53
2023-04-07 14:22:12,958 - Detection -   train_loss = 2.8899084820466885
2023-04-07 14:22:17,529 - Detection - ***** Epoch: 5: Eval results *****
2023-04-07 14:22:17,529 - Detection -   best_eval_score = 1.53
2023-04-07 14:22:17,529 - Detection -   eval_score = 3.76
2023-04-07 14:22:17,529 - Detection -   train_loss = 2.8544698743259205
2023-04-07 14:22:22,111 - Detection - ***** Epoch: 6: Eval results *****
2023-04-07 14:22:22,111 - Detection -   best_eval_score = 3.76
2023-04-07 14:22:22,111 - Detection -   eval_score = 22.96
2023-04-07 14:22:22,111 - Detection -   train_loss = 2.7718766577103557
2023-04-07 14:22:26,728 - Detection - ***** Epoch: 7: Eval results *****
2023-04-07 14:22:26,728 - Detection -   best_eval_score = 22.96
2023-04-07 14:22:26,728 - Detection -   eval_score = 44.85
2023-04-07 14:22:26,728 - Detection -   train_loss = 2.6004647226894604
2023-04-07 14:22:31,350 - Detection - ***** Epoch: 8: Eval results *****
2023-04-07 14:22:31,350 - Detection -   best_eval_score = 44.85
2023-04-07 14:22:31,350 - Detection -   eval_score = 60.81
2023-04-07 14:22:31,350 - Detection -   train_loss = 2.3313287987428555
2023-04-07 14:22:35,977 - Detection - ***** Epoch: 9: Eval results *****
2023-04-07 14:22:35,977 - Detection -   best_eval_score = 60.81
2023-04-07 14:22:35,977 - Detection -   eval_score = 73.52
2023-04-07 14:22:35,977 - Detection -   train_loss = 1.9804589257520788
2023-04-07 14:24:56,081 - Detection - ***** Epoch: 10: Eval results *****
2023-04-07 14:24:56,081 - Detection -   best_eval_score = 73.52
2023-04-07 14:24:56,081 - Detection -   eval_score = 83.54
2023-04-07 14:24:56,081 - Detection -   train_loss = 1.6642274505951826
2023-04-07 14:26:50,443 - Detection - ***** Epoch: 11: Eval results *****
2023-04-07 14:26:50,443 - Detection -   best_eval_score = 83.54
2023-04-07 14:26:50,443 - Detection -   eval_score = 90.51
2023-04-07 14:26:50,443 - Detection -   train_loss = 1.453103030429167
2023-04-07 14:28:49,789 - Detection - ***** Epoch: 12: Eval results *****
2023-04-07 14:28:49,789 - Detection -   best_eval_score = 90.51
2023-04-07 14:28:49,789 - Detection -   eval_score = 85.19
2023-04-07 14:28:49,789 - Detection -   train_loss = 1.3068292140960693
2023-04-07 14:30:13,028 - Detection - ***** Epoch: 13: Eval results *****
2023-04-07 14:30:13,029 - Detection -   best_eval_score = 90.51
2023-04-07 14:30:13,029 - Detection -   eval_score = 90.23
2023-04-07 14:30:13,029 - Detection -   train_loss = 1.212835900923785
2023-04-07 14:31:35,258 - Detection - ***** Epoch: 14: Eval results *****
2023-04-07 14:31:35,258 - Detection -   best_eval_score = 90.51
2023-04-07 14:31:35,258 - Detection -   eval_score = 86.65
2023-04-07 14:31:35,258 - Detection -   train_loss = 1.1420403157963472
2023-04-07 14:32:52,567 - Detection - ***** Epoch: 15: Eval results *****
2023-04-07 14:32:52,567 - Detection -   best_eval_score = 90.51
2023-04-07 14:32:52,567 - Detection -   eval_score = 93.2
2023-04-07 14:32:52,567 - Detection -   train_loss = 1.0811554263619816
2023-04-07 14:34:15,379 - Detection - ***** Epoch: 16: Eval results *****
2023-04-07 14:34:15,379 - Detection -   best_eval_score = 93.2
2023-04-07 14:34:15,379 - Detection -   eval_score = 89.83
2023-04-07 14:34:15,379 - Detection -   train_loss = 1.0355522913091324
2023-04-07 14:35:32,968 - Detection - ***** Epoch: 17: Eval results *****
2023-04-07 14:35:32,968 - Detection -   best_eval_score = 93.2
2023-04-07 14:35:32,968 - Detection -   eval_score = 92.69
2023-04-07 14:35:32,968 - Detection -   train_loss = 1.0004656805711634
2023-04-07 14:36:26,033 - Detection - ***** Epoch: 18: Eval results *****
2023-04-07 14:36:26,033 - Detection -   best_eval_score = 93.2
2023-04-07 14:36:26,033 - Detection -   eval_score = 92.41
2023-04-07 14:36:26,033 - Detection -   train_loss = 0.9573889514979195
2023-04-07 14:37:15,832 - Detection - ***** Epoch: 19: Eval results *****
2023-04-07 14:37:15,832 - Detection -   best_eval_score = 93.2
2023-04-07 14:37:15,832 - Detection -   eval_score = 92.72
2023-04-07 14:37:15,832 - Detection -   train_loss = 0.9312443557907554
2023-04-07 14:38:07,933 - Detection - ***** Epoch: 20: Eval results *****
2023-04-07 14:38:07,933 - Detection -   best_eval_score = 93.2
2023-04-07 14:38:07,933 - Detection -   eval_score = 93.64
2023-04-07 14:38:07,933 - Detection -   train_loss = 0.9046783271957847
2023-04-07 14:38:53,860 - Detection - ***** Epoch: 21: Eval results *****
2023-04-07 14:38:53,860 - Detection -   best_eval_score = 93.64
2023-04-07 14:38:53,860 - Detection -   eval_score = 93.64
2023-04-07 14:38:53,860 - Detection -   train_loss = 0.8790557349429411
2023-04-07 14:39:41,429 - Detection - ***** Epoch: 22: Eval results *****
2023-04-07 14:39:41,429 - Detection -   best_eval_score = 93.64
2023-04-07 14:39:41,429 - Detection -   eval_score = 94.81
2023-04-07 14:39:41,429 - Detection -   train_loss = 0.8644486525479484
2023-04-07 14:40:23,115 - Detection - ***** Epoch: 23: Eval results *****
2023-04-07 14:40:23,115 - Detection -   best_eval_score = 94.81
2023-04-07 14:40:23,115 - Detection -   eval_score = 94.24
2023-04-07 14:40:23,115 - Detection -   train_loss = 0.8396432680242202
2023-04-07 14:40:56,678 - Detection - ***** Epoch: 24: Eval results *****
2023-04-07 14:40:56,678 - Detection -   best_eval_score = 94.81
2023-04-07 14:40:56,679 - Detection -   eval_score = 94.81
2023-04-07 14:40:56,679 - Detection -   train_loss = 0.8258740726639243
2023-04-07 14:41:29,607 - Detection - ***** Epoch: 25: Eval results *****
2023-04-07 14:41:29,607 - Detection -   best_eval_score = 94.81
2023-04-07 14:41:29,607 - Detection -   eval_score = 93.85
2023-04-07 14:41:29,607 - Detection -   train_loss = 0.8131391791736379
2023-04-07 14:42:07,543 - Detection - ***** Epoch: 26: Eval results *****
2023-04-07 14:42:07,543 - Detection -   best_eval_score = 94.81
2023-04-07 14:42:07,543 - Detection -   eval_score = 94.77
2023-04-07 14:42:07,543 - Detection -   train_loss = 0.7938240240601933
2023-04-07 14:42:37,794 - Detection - ***** Epoch: 27: Eval results *****
2023-04-07 14:42:37,795 - Detection -   best_eval_score = 94.81
2023-04-07 14:42:37,795 - Detection -   eval_score = 94.76
2023-04-07 14:42:37,795 - Detection -   train_loss = 0.7813536980572868
2023-04-07 14:43:05,369 - Detection - ***** Epoch: 28: Eval results *****
2023-04-07 14:43:05,369 - Detection -   best_eval_score = 94.81
2023-04-07 14:43:05,369 - Detection -   eval_score = 94.79
2023-04-07 14:43:05,369 - Detection -   train_loss = 0.7711751145475051
2023-04-07 14:43:35,307 - Detection - ***** Epoch: 29: Eval results *****
2023-04-07 14:43:35,307 - Detection -   best_eval_score = 94.81
2023-04-07 14:43:35,307 - Detection -   eval_score = 94.79
2023-04-07 14:43:35,307 - Detection -   train_loss = 0.7537669048589819
2023-04-07 14:44:04,797 - Detection - ***** Epoch: 30: Eval results *****
2023-04-07 14:44:04,797 - Detection -   best_eval_score = 94.81
2023-04-07 14:44:04,797 - Detection -   eval_score = 94.79
2023-04-07 14:44:04,797 - Detection -   train_loss = 0.7458823849173153
2023-04-07 14:44:30,470 - Detection - ***** Epoch: 31: Eval results *****
2023-04-07 14:44:30,470 - Detection -   best_eval_score = 94.81
2023-04-07 14:44:30,471 - Detection -   eval_score = 94.79
2023-04-07 14:44:30,471 - Detection -   train_loss = 0.7353765508707832
2023-04-07 14:44:53,371 - Detection - ***** Epoch: 32: Eval results *****
2023-04-07 14:44:53,371 - Detection -   best_eval_score = 94.81
2023-04-07 14:44:53,371 - Detection -   eval_score = 94.42
2023-04-07 14:44:53,371 - Detection -   train_loss = 0.7287791196037742
2023-04-07 14:44:53,372 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_0.25_1.0_bert_disaware_boost_0/models
2023-04-07 14:44:54,287 - Detection - Pre-training finished...
2023-04-07 14:44:54,287 - Detection - Training Begin...
2023-04-07 14:44:56,819 - Detection - ***** Epoch: 1: Eval results *****
2023-04-07 14:44:56,819 - Detection -   best_eval_score = 0
2023-04-07 14:44:56,819 - Detection -   eval_score = 3.89
2023-04-07 14:44:56,819 - Detection -   train_loss = 3.3495392238392547
2023-04-07 14:44:59,356 - Detection - ***** Epoch: 2: Eval results *****
2023-04-07 14:44:59,356 - Detection -   best_eval_score = 3.89
2023-04-07 14:44:59,356 - Detection -   eval_score = 22.15
2023-04-07 14:44:59,356 - Detection -   train_loss = 2.8163272072287167
2023-04-07 14:45:01,895 - Detection - ***** Epoch: 3: Eval results *****
2023-04-07 14:45:01,895 - Detection -   best_eval_score = 22.15
2023-04-07 14:45:01,895 - Detection -   eval_score = 50.41
2023-04-07 14:45:01,895 - Detection -   train_loss = 2.1292553228490494
2023-04-07 14:45:04,438 - Detection - ***** Epoch: 4: Eval results *****
2023-04-07 14:45:04,438 - Detection -   best_eval_score = 50.41
2023-04-07 14:45:04,438 - Detection -   eval_score = 76.45
2023-04-07 14:45:04,438 - Detection -   train_loss = 1.3610617623609655
2023-04-07 14:47:14,388 - Detection - ***** Epoch: 5: Eval results *****
2023-04-07 14:47:14,389 - Detection -   best_eval_score = 76.45
2023-04-07 14:47:14,389 - Detection -   eval_score = 83.31
2023-04-07 14:47:14,389 - Detection -   train_loss = 0.8467143458478591
2023-04-07 14:49:14,787 - Detection - ***** Epoch: 6: Eval results *****
2023-04-07 14:49:14,787 - Detection -   best_eval_score = 83.31
2023-04-07 14:49:14,787 - Detection -   eval_score = 84.81
2023-04-07 14:49:14,787 - Detection -   train_loss = 0.6503174901008606
2023-04-07 14:51:13,786 - Detection - ***** Epoch: 7: Eval results *****
2023-04-07 14:51:13,787 - Detection -   best_eval_score = 84.81
2023-04-07 14:51:13,787 - Detection -   eval_score = 84.94
2023-04-07 14:51:13,787 - Detection -   train_loss = 0.6268789172172546
2023-04-07 14:53:14,849 - Detection - ***** Epoch: 8: Eval results *****
2023-04-07 14:53:14,849 - Detection -   best_eval_score = 84.94
2023-04-07 14:53:14,849 - Detection -   eval_score = 84.45
2023-04-07 14:53:14,849 - Detection -   train_loss = 0.6158877821529612
2023-04-07 14:55:07,903 - Detection - ***** Epoch: 9: Eval results *****
2023-04-07 14:55:07,903 - Detection -   best_eval_score = 84.94
2023-04-07 14:55:07,903 - Detection -   eval_score = 84.45
2023-04-07 14:55:07,903 - Detection -   train_loss = 0.6101586292771732
2023-04-07 14:57:00,451 - Detection - ***** Epoch: 10: Eval results *****
2023-04-07 14:57:00,451 - Detection -   best_eval_score = 84.94
2023-04-07 14:57:00,452 - Detection -   eval_score = 84.45
2023-04-07 14:57:00,452 - Detection -   train_loss = 0.5949676545227275
2023-04-07 14:59:30,444 - Detection - ***** Epoch: 11: Eval results *****
2023-04-07 14:59:30,444 - Detection -   best_eval_score = 84.94
2023-04-07 14:59:30,444 - Detection -   eval_score = 84.78
2023-04-07 14:59:30,444 - Detection -   train_loss = 0.59796282824348
2023-04-07 15:01:22,631 - Detection - ***** Epoch: 12: Eval results *****
2023-04-07 15:01:22,631 - Detection -   best_eval_score = 84.94
2023-04-07 15:01:22,631 - Detection -   eval_score = 84.45
2023-04-07 15:01:22,631 - Detection -   train_loss = 0.6047859086709864
2023-04-07 15:03:42,125 - Detection - ***** Epoch: 13: Eval results *****
2023-04-07 15:03:42,125 - Detection -   best_eval_score = 84.94
2023-04-07 15:03:42,125 - Detection -   eval_score = 84.13
2023-04-07 15:03:42,125 - Detection -   train_loss = 0.602967793450636
2023-04-07 15:05:42,812 - Detection - ***** Epoch: 14: Eval results *****
2023-04-07 15:05:42,812 - Detection -   best_eval_score = 84.94
2023-04-07 15:05:42,812 - Detection -   eval_score = 84.45
2023-04-07 15:05:42,812 - Detection -   train_loss = 0.601322724538691
2023-04-07 15:07:35,063 - Detection - ***** Epoch: 15: Eval results *****
2023-04-07 15:07:35,063 - Detection -   best_eval_score = 84.94
2023-04-07 15:07:35,063 - Detection -   eval_score = 84.45
2023-04-07 15:07:35,063 - Detection -   train_loss = 0.607081742847667
2023-04-07 15:09:28,957 - Detection - ***** Epoch: 16: Eval results *****
2023-04-07 15:09:28,958 - Detection -   best_eval_score = 84.94
2023-04-07 15:09:28,958 - Detection -   eval_score = 84.13
2023-04-07 15:09:28,958 - Detection -   train_loss = 0.6172391386593089
2023-04-07 15:11:18,675 - Detection - ***** Epoch: 17: Eval results *****
2023-04-07 15:11:18,675 - Detection -   best_eval_score = 84.94
2023-04-07 15:11:18,675 - Detection -   eval_score = 84.45
2023-04-07 15:11:18,675 - Detection -   train_loss = 0.600254113183302
2023-04-07 15:11:18,676 - Detection - Training Finished...
2023-04-07 15:11:18,676 - Detection - Testing begin...
2023-04-07 15:11:21,571 - Detection - ***** Test: Confusion Matrix *****
2023-04-07 15:11:21,572 - Detection - [[  30    0    4    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    6]
 [   0   26    0    0    0    0    5    0    0    8    0    0    0    0
     0    0    0    0    0    1]
 [   0    0   34    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    6]
 [   0    0    0   32    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    8]
 [   0    0    0    0   35    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    5]
 [   0    0    0    0    0   35    0    0    0    0    0    0    0    0
     0    0    0    0    0    5]
 [   0    2    0    0    0    0   29    0    0    1    0    0    0    0
     0    0    0    0    0    8]
 [   0    0    0    0    0    0    0   38    0    0    0    0    0    0
     0    0    0    0    0    2]
 [   0    0    0    0    0    0    0    0   40    0    0    0    0    0
     0    0    0    0    0    0]
 [   0    6    0    0    0    0    1    0    0   31    0    0    0    0
     0    0    0    0    0    2]
 [   0    0    0    0    0    0    0    0    0    0   37    0    0    0
     0    0    0    0    0    3]
 [   0    0    0    0    0    0    0    0    0    0    0   36    0    0
     0    0    0    0    0    4]
 [   0    0    0    0    0    0    0    0    0    0    0    0   39    0
     0    0    0    0    0    1]
 [   0    1    0    0    0    0    0    0    0    0    0    0    0   36
     0    0    0    0    0    3]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    1
    36    0    0    0    0    3]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0   34    0    0    0    6]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0   36    0    0    4]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0   39    0    1]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0   29   11]
 [   6    0   36   33   30   52    0   31    0    0   94    9    0   24
     0    5    1   55    2 1942]]
2023-04-07 15:11:21,572 - Detection - ***** Test results *****
2023-04-07 15:11:21,572 - Detection -   Acc = 84.22
2023-04-07 15:11:21,572 - Detection -   F1 = 75.8459
2023-04-07 15:11:21,572 - Detection -   F1-known = 75.1287
2023-04-07 15:11:21,572 - Detection -   F1-open = 89.4725
2023-04-07 15:11:21,572 - Detection - Testing finished...
2023-04-07 15:11:21,572 - Detection - Results saved in results/results_DA-ADB-BOOST.csv
2023-04-07 15:11:21,589 - Detection - Open Intent Detection Finished...
