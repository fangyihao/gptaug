2023-04-19 21:42:57,952 - Detection - Open Intent Detection Begin...
2023-04-19 21:42:57,952 - Detection - Parameters Initialization...
2023-04-19 21:42:57,952 - Detection - ============================== Params ==============================
2023-04-19 21:42:57,952 - Detection - type:	open_intent_detection
2023-04-19 21:42:57,952 - Detection - logger_name:	Detection
2023-04-19 21:42:57,952 - Detection - log_dir:	logs
2023-04-19 21:42:57,952 - Detection - dataset:	oos_cg
2023-04-19 21:42:57,952 - Detection - known_cls_ratio:	0.5
2023-04-19 21:42:57,952 - Detection - labeled_ratio:	1.0
2023-04-19 21:42:57,952 - Detection - method:	DA-ADB
2023-04-19 21:42:57,952 - Detection - train:	True
2023-04-19 21:42:57,952 - Detection - pretrain:	True
2023-04-19 21:42:57,952 - Detection - save_model:	True
2023-04-19 21:42:57,952 - Detection - backbone:	bert_disaware
2023-04-19 21:42:57,952 - Detection - config_file_name:	DA-ADB
2023-04-19 21:42:57,952 - Detection - seed:	1
2023-04-19 21:42:57,952 - Detection - gpu_id:	0
2023-04-19 21:42:57,952 - Detection - pipe_results_path:	pipe_results
2023-04-19 21:42:57,952 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-19 21:42:57,952 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-19 21:42:57,952 - Detection - model_dir:	models
2023-04-19 21:42:57,952 - Detection - load_pretrained_method:	None
2023-04-19 21:42:57,952 - Detection - result_dir:	results
2023-04-19 21:42:57,952 - Detection - results_file_name:	results_DA-ADB.csv
2023-04-19 21:42:57,952 - Detection - save_results:	True
2023-04-19 21:42:57,952 - Detection - loss_fct:	CrossEntropyLoss
2023-04-19 21:42:57,952 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_oos_cg_0.5_1.0_bert_disaware_1
2023-04-19 21:42:57,953 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_oos_cg_0.5_1.0_bert_disaware_1/models
2023-04-19 21:42:57,953 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-19 21:42:57,953 - Detection - num_train_epochs:	100
2023-04-19 21:42:57,953 - Detection - num_labels:	None
2023-04-19 21:42:57,953 - Detection - max_seq_length:	None
2023-04-19 21:42:57,953 - Detection - freeze_backbone_parameters:	True
2023-04-19 21:42:57,953 - Detection - feat_dim:	768
2023-04-19 21:42:57,953 - Detection - warmup_proportion:	0.1
2023-04-19 21:42:57,953 - Detection - scale:	4
2023-04-19 21:42:57,953 - Detection - lr_boundary:	0.05
2023-04-19 21:42:57,953 - Detection - lr:	2e-05
2023-04-19 21:42:57,953 - Detection - activation:	relu
2023-04-19 21:42:57,953 - Detection - train_batch_size:	128
2023-04-19 21:42:57,953 - Detection - eval_batch_size:	64
2023-04-19 21:42:57,953 - Detection - test_batch_size:	64
2023-04-19 21:42:57,953 - Detection - wait_patient:	10
2023-04-19 21:42:57,953 - Detection - ============================== End Params ==============================
2023-04-19 21:42:57,953 - Detection - Data and Model Preparation...
2023-04-19 21:42:57,953 - Detection - The number of known intents is 75
2023-04-19 21:42:57,953 - Detection - Lists of known labels are: ['calories', 'report_fraud', 'next_song', 'cancel_reservation', 'translate', 'ingredients_list', 'what_are_your_hobbies', 'food_last', 'credit_limit_change', 'thank_you', 'reminder', 'are_you_a_bot', 'restaurant_reviews', 'how_busy', 'oil_change_how', 'flight_status', 'recipe', 'maybe', 'current_location', 'direct_deposit', 'pto_request_status', 'payday', 'nutrition_info', 'expiration_date', 'tire_pressure', 'report_lost_card', 'date', 'carry_on', 'new_card', 'whisper_mode', 'pto_used', 'uber', 'measurement_conversion', 'traffic', 'spelling', 'gas_type', 'improve_credit_score', 'credit_limit', 'income', 'schedule_maintenance', 'shopping_list_update', 'car_rental', 'text', 'restaurant_suggestion', 'insurance_change', 'tell_joke', 'card_declined', 'apr', 'freeze_account', 'interest_rate', 'exchange_rate', 'directions', 'taxes', 'w2', 'routing', 'travel_alert', 'todo_list', 'pin_change', 'timer', 'reminder_update', 'calculator', 'smart_home', 'timezone', 'calendar', 'alarm', 'rewards_balance', 'balance', 'todo_list_update', 'share_location', 'make_call', 'ingredient_substitution', 'what_song', 'vaccines', 'fun_fact', 'jump_start']
2023-04-19 21:42:57,965 - Detection - Number of labeled training samples = 1844
2023-04-19 21:42:57,965 - Detection - Number of unlabeled training samples = 1839
2023-04-19 21:42:57,969 - Detection - Number of evaluation samples = 826
2023-04-19 21:42:57,977 - Detection - Number of testing samples = 3632
2023-04-19 21:43:03,636 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-19 21:43:03,718 - Detection - Pre-training Begin...
2023-04-19 21:43:06,914 - Detection - ***** Epoch: 1: Eval results *****
2023-04-19 21:43:06,914 - Detection -   best_eval_score = 0
2023-04-19 21:43:06,914 - Detection -   eval_score = 0.14
2023-04-19 21:43:06,914 - Detection -   train_loss = 4.326595052083333
2023-04-19 21:43:09,636 - Detection - ***** Epoch: 2: Eval results *****
2023-04-19 21:43:09,636 - Detection -   best_eval_score = 0.14
2023-04-19 21:43:09,636 - Detection -   eval_score = 0.06
2023-04-19 21:43:09,636 - Detection -   train_loss = 4.303996181488037
2023-04-19 21:43:12,351 - Detection - ***** Epoch: 3: Eval results *****
2023-04-19 21:43:12,351 - Detection -   best_eval_score = 0.14
2023-04-19 21:43:12,351 - Detection -   eval_score = 0.09
2023-04-19 21:43:12,351 - Detection -   train_loss = 4.268726189931233
2023-04-19 21:43:15,069 - Detection - ***** Epoch: 4: Eval results *****
2023-04-19 21:43:15,069 - Detection -   best_eval_score = 0.14
2023-04-19 21:43:15,069 - Detection -   eval_score = 0.26
2023-04-19 21:43:15,069 - Detection -   train_loss = 4.236006704966227
2023-04-19 21:43:17,796 - Detection - ***** Epoch: 5: Eval results *****
2023-04-19 21:43:17,797 - Detection -   best_eval_score = 0.26
2023-04-19 21:43:17,797 - Detection -   eval_score = 0.22
2023-04-19 21:43:17,797 - Detection -   train_loss = 4.203519185384114
2023-04-19 21:43:20,516 - Detection - ***** Epoch: 6: Eval results *****
2023-04-19 21:43:20,516 - Detection -   best_eval_score = 0.26
2023-04-19 21:43:20,516 - Detection -   eval_score = 1.15
2023-04-19 21:43:20,516 - Detection -   train_loss = 4.147739919026693
2023-04-19 21:43:23,353 - Detection - ***** Epoch: 7: Eval results *****
2023-04-19 21:43:23,353 - Detection -   best_eval_score = 1.15
2023-04-19 21:43:23,353 - Detection -   eval_score = 2.16
2023-04-19 21:43:23,353 - Detection -   train_loss = 4.046155166625977
2023-04-19 21:43:26,090 - Detection - ***** Epoch: 8: Eval results *****
2023-04-19 21:43:26,090 - Detection -   best_eval_score = 2.16
2023-04-19 21:43:26,090 - Detection -   eval_score = 5.2
2023-04-19 21:43:26,090 - Detection -   train_loss = 3.876462952295939
2023-04-19 21:43:28,828 - Detection - ***** Epoch: 9: Eval results *****
2023-04-19 21:43:28,828 - Detection -   best_eval_score = 5.2
2023-04-19 21:43:28,828 - Detection -   eval_score = 8.64
2023-04-19 21:43:28,828 - Detection -   train_loss = 3.6614154020945233
2023-04-19 21:43:31,572 - Detection - ***** Epoch: 10: Eval results *****
2023-04-19 21:43:31,572 - Detection -   best_eval_score = 8.64
2023-04-19 21:43:31,572 - Detection -   eval_score = 17.42
2023-04-19 21:43:31,572 - Detection -   train_loss = 3.4369380950927733
2023-04-19 21:43:34,321 - Detection - ***** Epoch: 11: Eval results *****
2023-04-19 21:43:34,321 - Detection -   best_eval_score = 17.42
2023-04-19 21:43:34,321 - Detection -   eval_score = 22.86
2023-04-19 21:43:34,321 - Detection -   train_loss = 3.2320602416992186
2023-04-19 21:43:37,068 - Detection - ***** Epoch: 12: Eval results *****
2023-04-19 21:43:37,069 - Detection -   best_eval_score = 22.86
2023-04-19 21:43:37,069 - Detection -   eval_score = 28.2
2023-04-19 21:43:37,069 - Detection -   train_loss = 3.052758741378784
2023-04-19 21:43:39,822 - Detection - ***** Epoch: 13: Eval results *****
2023-04-19 21:43:39,823 - Detection -   best_eval_score = 28.2
2023-04-19 21:43:39,823 - Detection -   eval_score = 33.6
2023-04-19 21:43:39,823 - Detection -   train_loss = 2.900956074396769
2023-04-19 21:43:42,579 - Detection - ***** Epoch: 14: Eval results *****
2023-04-19 21:43:42,579 - Detection -   best_eval_score = 33.6
2023-04-19 21:43:42,579 - Detection -   eval_score = 37.04
2023-04-19 21:43:42,579 - Detection -   train_loss = 2.7826191266377767
2023-04-19 21:43:45,334 - Detection - ***** Epoch: 15: Eval results *****
2023-04-19 21:43:45,334 - Detection -   best_eval_score = 37.04
2023-04-19 21:43:45,334 - Detection -   eval_score = 39.75
2023-04-19 21:43:45,334 - Detection -   train_loss = 2.6799025853474934
2023-04-19 21:43:48,090 - Detection - ***** Epoch: 16: Eval results *****
2023-04-19 21:43:48,091 - Detection -   best_eval_score = 39.75
2023-04-19 21:43:48,091 - Detection -   eval_score = 43.38
2023-04-19 21:43:48,091 - Detection -   train_loss = 2.594675095876058
2023-04-19 21:43:50,849 - Detection - ***** Epoch: 17: Eval results *****
2023-04-19 21:43:50,850 - Detection -   best_eval_score = 43.38
2023-04-19 21:43:50,850 - Detection -   eval_score = 44.58
2023-04-19 21:43:50,850 - Detection -   train_loss = 2.526939105987549
2023-04-19 21:43:53,609 - Detection - ***** Epoch: 18: Eval results *****
2023-04-19 21:43:53,609 - Detection -   best_eval_score = 44.58
2023-04-19 21:43:53,609 - Detection -   eval_score = 47.8
2023-04-19 21:43:53,609 - Detection -   train_loss = 2.4521610577901205
2023-04-19 21:43:56,371 - Detection - ***** Epoch: 19: Eval results *****
2023-04-19 21:43:56,372 - Detection -   best_eval_score = 47.8
2023-04-19 21:43:56,372 - Detection -   eval_score = 48.15
2023-04-19 21:43:56,372 - Detection -   train_loss = 2.3910202026367187
2023-04-19 21:43:59,138 - Detection - ***** Epoch: 20: Eval results *****
2023-04-19 21:43:59,138 - Detection -   best_eval_score = 48.15
2023-04-19 21:43:59,138 - Detection -   eval_score = 50.2
2023-04-19 21:43:59,139 - Detection -   train_loss = 2.3505289872487385
2023-04-19 21:44:01,904 - Detection - ***** Epoch: 21: Eval results *****
2023-04-19 21:44:01,905 - Detection -   best_eval_score = 50.2
2023-04-19 21:44:01,905 - Detection -   eval_score = 51.14
2023-04-19 21:44:01,905 - Detection -   train_loss = 2.299494743347168
2023-04-19 21:44:04,673 - Detection - ***** Epoch: 22: Eval results *****
2023-04-19 21:44:04,673 - Detection -   best_eval_score = 51.14
2023-04-19 21:44:04,673 - Detection -   eval_score = 52.81
2023-04-19 21:44:04,673 - Detection -   train_loss = 2.2582706451416015
2023-04-19 21:44:07,440 - Detection - ***** Epoch: 23: Eval results *****
2023-04-19 21:44:07,440 - Detection -   best_eval_score = 52.81
2023-04-19 21:44:07,440 - Detection -   eval_score = 54.91
2023-04-19 21:44:07,440 - Detection -   train_loss = 2.2205761909484862
2023-04-19 21:44:10,208 - Detection - ***** Epoch: 24: Eval results *****
2023-04-19 21:44:10,209 - Detection -   best_eval_score = 54.91
2023-04-19 21:44:10,209 - Detection -   eval_score = 55.98
2023-04-19 21:44:10,209 - Detection -   train_loss = 2.188783597946167
2023-04-19 21:44:12,978 - Detection - ***** Epoch: 25: Eval results *****
2023-04-19 21:44:12,978 - Detection -   best_eval_score = 55.98
2023-04-19 21:44:12,978 - Detection -   eval_score = 57.04
2023-04-19 21:44:12,978 - Detection -   train_loss = 2.1517739931742352
2023-04-19 21:44:15,843 - Detection - ***** Epoch: 26: Eval results *****
2023-04-19 21:44:15,843 - Detection -   best_eval_score = 57.04
2023-04-19 21:44:15,843 - Detection -   eval_score = 57.66
2023-04-19 21:44:15,843 - Detection -   train_loss = 2.124082072575887
2023-04-19 21:44:18,604 - Detection - ***** Epoch: 27: Eval results *****
2023-04-19 21:44:18,604 - Detection -   best_eval_score = 57.66
2023-04-19 21:44:18,604 - Detection -   eval_score = 58.09
2023-04-19 21:44:18,604 - Detection -   train_loss = 2.100031510988871
2023-04-19 21:44:21,366 - Detection - ***** Epoch: 28: Eval results *****
2023-04-19 21:44:21,366 - Detection -   best_eval_score = 58.09
2023-04-19 21:44:21,366 - Detection -   eval_score = 58.67
2023-04-19 21:44:21,366 - Detection -   train_loss = 2.071474480628967
2023-04-19 21:44:24,131 - Detection - ***** Epoch: 29: Eval results *****
2023-04-19 21:44:24,131 - Detection -   best_eval_score = 58.67
2023-04-19 21:44:24,131 - Detection -   eval_score = 58.64
2023-04-19 21:44:24,131 - Detection -   train_loss = 2.04488476117452
2023-04-19 21:44:26,882 - Detection - ***** Epoch: 30: Eval results *****
2023-04-19 21:44:26,882 - Detection -   best_eval_score = 58.67
2023-04-19 21:44:26,882 - Detection -   eval_score = 59.94
2023-04-19 21:44:26,882 - Detection -   train_loss = 2.0243898232777915
2023-04-19 21:44:29,645 - Detection - ***** Epoch: 31: Eval results *****
2023-04-19 21:44:29,645 - Detection -   best_eval_score = 59.94
2023-04-19 21:44:29,645 - Detection -   eval_score = 60.14
2023-04-19 21:44:29,645 - Detection -   train_loss = 2.003967603047689
2023-04-19 21:44:32,411 - Detection - ***** Epoch: 32: Eval results *****
2023-04-19 21:44:32,411 - Detection -   best_eval_score = 60.14
2023-04-19 21:44:32,411 - Detection -   eval_score = 61.12
2023-04-19 21:44:32,411 - Detection -   train_loss = 1.9782394250233968
2023-04-19 21:44:35,173 - Detection - ***** Epoch: 33: Eval results *****
2023-04-19 21:44:35,173 - Detection -   best_eval_score = 61.12
2023-04-19 21:44:35,173 - Detection -   eval_score = 61.68
2023-04-19 21:44:35,173 - Detection -   train_loss = 1.961987566947937
2023-04-19 21:44:37,935 - Detection - ***** Epoch: 34: Eval results *****
2023-04-19 21:44:37,935 - Detection -   best_eval_score = 61.68
2023-04-19 21:44:37,935 - Detection -   eval_score = 62.08
2023-04-19 21:44:37,935 - Detection -   train_loss = 1.9374176263809204
2023-04-19 21:44:40,699 - Detection - ***** Epoch: 35: Eval results *****
2023-04-19 21:44:40,699 - Detection -   best_eval_score = 62.08
2023-04-19 21:44:40,699 - Detection -   eval_score = 63.58
2023-04-19 21:44:40,699 - Detection -   train_loss = 1.9274388313293458
2023-04-19 21:44:43,465 - Detection - ***** Epoch: 36: Eval results *****
2023-04-19 21:44:43,465 - Detection -   best_eval_score = 63.58
2023-04-19 21:44:43,465 - Detection -   eval_score = 63.77
2023-04-19 21:44:43,465 - Detection -   train_loss = 1.915684413909912
2023-04-19 21:44:46,227 - Detection - ***** Epoch: 37: Eval results *****
2023-04-19 21:44:46,227 - Detection -   best_eval_score = 63.77
2023-04-19 21:44:46,227 - Detection -   eval_score = 64.36
2023-04-19 21:44:46,227 - Detection -   train_loss = 1.9005378325780233
2023-04-19 21:44:48,989 - Detection - ***** Epoch: 38: Eval results *****
2023-04-19 21:44:48,989 - Detection -   best_eval_score = 64.36
2023-04-19 21:44:48,989 - Detection -   eval_score = 64.46
2023-04-19 21:44:48,989 - Detection -   train_loss = 1.8806555032730103
2023-04-19 21:44:51,751 - Detection - ***** Epoch: 39: Eval results *****
2023-04-19 21:44:51,751 - Detection -   best_eval_score = 64.46
2023-04-19 21:44:51,751 - Detection -   eval_score = 64.62
2023-04-19 21:44:51,751 - Detection -   train_loss = 1.873289704322815
2023-04-19 21:44:54,513 - Detection - ***** Epoch: 40: Eval results *****
2023-04-19 21:44:54,513 - Detection -   best_eval_score = 64.62
2023-04-19 21:44:54,513 - Detection -   eval_score = 65.59
2023-04-19 21:44:54,513 - Detection -   train_loss = 1.8522443294525146
2023-04-19 21:44:57,277 - Detection - ***** Epoch: 41: Eval results *****
2023-04-19 21:44:57,277 - Detection -   best_eval_score = 65.59
2023-04-19 21:44:57,277 - Detection -   eval_score = 65.82
2023-04-19 21:44:57,277 - Detection -   train_loss = 1.8479732513427733
2023-04-19 21:45:00,037 - Detection - ***** Epoch: 42: Eval results *****
2023-04-19 21:45:00,038 - Detection -   best_eval_score = 65.82
2023-04-19 21:45:00,038 - Detection -   eval_score = 66.14
2023-04-19 21:45:00,038 - Detection -   train_loss = 1.8310157934824625
2023-04-19 21:45:02,797 - Detection - ***** Epoch: 43: Eval results *****
2023-04-19 21:45:02,797 - Detection -   best_eval_score = 66.14
2023-04-19 21:45:02,797 - Detection -   eval_score = 66.71
2023-04-19 21:45:02,797 - Detection -   train_loss = 1.8183693965276082
2023-04-19 21:45:05,556 - Detection - ***** Epoch: 44: Eval results *****
2023-04-19 21:45:05,557 - Detection -   best_eval_score = 66.71
2023-04-19 21:45:05,557 - Detection -   eval_score = 66.67
2023-04-19 21:45:05,557 - Detection -   train_loss = 1.817845884958903
2023-04-19 21:45:08,305 - Detection - ***** Epoch: 45: Eval results *****
2023-04-19 21:45:08,305 - Detection -   best_eval_score = 66.71
2023-04-19 21:45:08,305 - Detection -   eval_score = 66.94
2023-04-19 21:45:08,305 - Detection -   train_loss = 1.80413818359375
2023-04-19 21:45:11,168 - Detection - ***** Epoch: 46: Eval results *****
2023-04-19 21:45:11,168 - Detection -   best_eval_score = 66.94
2023-04-19 21:45:11,168 - Detection -   eval_score = 67.25
2023-04-19 21:45:11,168 - Detection -   train_loss = 1.7928271691004436
2023-04-19 21:45:13,927 - Detection - ***** Epoch: 47: Eval results *****
2023-04-19 21:45:13,927 - Detection -   best_eval_score = 67.25
2023-04-19 21:45:13,927 - Detection -   eval_score = 67.48
2023-04-19 21:45:13,928 - Detection -   train_loss = 1.7853809277216592
2023-04-19 21:45:16,688 - Detection - ***** Epoch: 48: Eval results *****
2023-04-19 21:45:16,689 - Detection -   best_eval_score = 67.48
2023-04-19 21:45:16,689 - Detection -   eval_score = 67.8
2023-04-19 21:45:16,689 - Detection -   train_loss = 1.7747954607009888
2023-04-19 21:45:19,447 - Detection - ***** Epoch: 49: Eval results *****
2023-04-19 21:45:19,447 - Detection -   best_eval_score = 67.8
2023-04-19 21:45:19,447 - Detection -   eval_score = 68.11
2023-04-19 21:45:19,447 - Detection -   train_loss = 1.7778133471806845
2023-04-19 21:45:22,205 - Detection - ***** Epoch: 50: Eval results *****
2023-04-19 21:45:22,205 - Detection -   best_eval_score = 68.11
2023-04-19 21:45:22,205 - Detection -   eval_score = 67.82
2023-04-19 21:45:22,205 - Detection -   train_loss = 1.7582340796788534
2023-04-19 21:45:24,952 - Detection - ***** Epoch: 51: Eval results *****
2023-04-19 21:45:24,953 - Detection -   best_eval_score = 68.11
2023-04-19 21:45:24,953 - Detection -   eval_score = 68.51
2023-04-19 21:45:24,953 - Detection -   train_loss = 1.7462283849716187
2023-04-19 21:45:27,711 - Detection - ***** Epoch: 52: Eval results *****
2023-04-19 21:45:27,711 - Detection -   best_eval_score = 68.51
2023-04-19 21:45:27,711 - Detection -   eval_score = 68.75
2023-04-19 21:45:27,711 - Detection -   train_loss = 1.7463780959447226
2023-04-19 21:45:30,468 - Detection - ***** Epoch: 53: Eval results *****
2023-04-19 21:45:30,468 - Detection -   best_eval_score = 68.75
2023-04-19 21:45:30,468 - Detection -   eval_score = 69.02
2023-04-19 21:45:30,468 - Detection -   train_loss = 1.733088493347168
2023-04-19 21:45:33,225 - Detection - ***** Epoch: 54: Eval results *****
2023-04-19 21:45:33,225 - Detection -   best_eval_score = 69.02
2023-04-19 21:45:33,225 - Detection -   eval_score = 68.88
2023-04-19 21:45:33,225 - Detection -   train_loss = 1.7396146774291992
2023-04-19 21:45:35,970 - Detection - ***** Epoch: 55: Eval results *****
2023-04-19 21:45:35,970 - Detection -   best_eval_score = 69.02
2023-04-19 21:45:35,970 - Detection -   eval_score = 68.29
2023-04-19 21:45:35,970 - Detection -   train_loss = 1.7191723903020224
2023-04-19 21:45:38,715 - Detection - ***** Epoch: 56: Eval results *****
2023-04-19 21:45:38,715 - Detection -   best_eval_score = 69.02
2023-04-19 21:45:38,715 - Detection -   eval_score = 69.11
2023-04-19 21:45:38,715 - Detection -   train_loss = 1.7181070804595948
2023-04-19 21:45:41,470 - Detection - ***** Epoch: 57: Eval results *****
2023-04-19 21:45:41,470 - Detection -   best_eval_score = 69.11
2023-04-19 21:45:41,470 - Detection -   eval_score = 69.42
2023-04-19 21:45:41,470 - Detection -   train_loss = 1.711861499150594
2023-04-19 21:45:44,225 - Detection - ***** Epoch: 58: Eval results *****
2023-04-19 21:45:44,225 - Detection -   best_eval_score = 69.42
2023-04-19 21:45:44,225 - Detection -   eval_score = 69.45
2023-04-19 21:45:44,225 - Detection -   train_loss = 1.704954210917155
2023-04-19 21:45:46,981 - Detection - ***** Epoch: 59: Eval results *****
2023-04-19 21:45:46,981 - Detection -   best_eval_score = 69.45
2023-04-19 21:45:46,982 - Detection -   eval_score = 69.08
2023-04-19 21:45:46,982 - Detection -   train_loss = 1.6972110986709594
2023-04-19 21:45:49,726 - Detection - ***** Epoch: 60: Eval results *****
2023-04-19 21:45:49,726 - Detection -   best_eval_score = 69.45
2023-04-19 21:45:49,726 - Detection -   eval_score = 69.01
2023-04-19 21:45:49,727 - Detection -   train_loss = 1.69250431060791
2023-04-19 21:45:52,472 - Detection - ***** Epoch: 61: Eval results *****
2023-04-19 21:45:52,472 - Detection -   best_eval_score = 69.45
2023-04-19 21:45:52,472 - Detection -   eval_score = 69.16
2023-04-19 21:45:52,472 - Detection -   train_loss = 1.692161790529887
2023-04-19 21:45:55,217 - Detection - ***** Epoch: 62: Eval results *****
2023-04-19 21:45:55,217 - Detection -   best_eval_score = 69.45
2023-04-19 21:45:55,217 - Detection -   eval_score = 69.4
2023-04-19 21:45:55,217 - Detection -   train_loss = 1.684730346997579
2023-04-19 21:45:57,966 - Detection - ***** Epoch: 63: Eval results *****
2023-04-19 21:45:57,966 - Detection -   best_eval_score = 69.45
2023-04-19 21:45:57,966 - Detection -   eval_score = 68.8
2023-04-19 21:45:57,966 - Detection -   train_loss = 1.6845661401748657
2023-04-19 21:46:00,714 - Detection - ***** Epoch: 64: Eval results *****
2023-04-19 21:46:00,714 - Detection -   best_eval_score = 69.45
2023-04-19 21:46:00,715 - Detection -   eval_score = 68.74
2023-04-19 21:46:00,715 - Detection -   train_loss = 1.676533285776774
2023-04-19 21:46:03,461 - Detection - ***** Epoch: 65: Eval results *****
2023-04-19 21:46:03,461 - Detection -   best_eval_score = 69.45
2023-04-19 21:46:03,461 - Detection -   eval_score = 69.48
2023-04-19 21:46:03,461 - Detection -   train_loss = 1.6740989605585734
2023-04-19 21:46:06,220 - Detection - ***** Epoch: 66: Eval results *****
2023-04-19 21:46:06,220 - Detection -   best_eval_score = 69.48
2023-04-19 21:46:06,220 - Detection -   eval_score = 69.33
2023-04-19 21:46:06,220 - Detection -   train_loss = 1.6729854027430215
2023-04-19 21:46:08,966 - Detection - ***** Epoch: 67: Eval results *****
2023-04-19 21:46:08,966 - Detection -   best_eval_score = 69.48
2023-04-19 21:46:08,966 - Detection -   eval_score = 69.12
2023-04-19 21:46:08,966 - Detection -   train_loss = 1.671055825551351
2023-04-19 21:46:11,713 - Detection - ***** Epoch: 68: Eval results *****
2023-04-19 21:46:11,713 - Detection -   best_eval_score = 69.48
2023-04-19 21:46:11,713 - Detection -   eval_score = 69.53
2023-04-19 21:46:11,713 - Detection -   train_loss = 1.6596193154652914
2023-04-19 21:46:14,469 - Detection - ***** Epoch: 69: Eval results *****
2023-04-19 21:46:14,469 - Detection -   best_eval_score = 69.53
2023-04-19 21:46:14,469 - Detection -   eval_score = 69.28
2023-04-19 21:46:14,469 - Detection -   train_loss = 1.6563292105992635
2023-04-19 21:46:17,214 - Detection - ***** Epoch: 70: Eval results *****
2023-04-19 21:46:17,214 - Detection -   best_eval_score = 69.53
2023-04-19 21:46:17,214 - Detection -   eval_score = 69.56
2023-04-19 21:46:17,214 - Detection -   train_loss = 1.6594214916229248
2023-04-19 21:46:19,970 - Detection - ***** Epoch: 71: Eval results *****
2023-04-19 21:46:19,970 - Detection -   best_eval_score = 69.56
2023-04-19 21:46:19,970 - Detection -   eval_score = 69.91
2023-04-19 21:46:19,970 - Detection -   train_loss = 1.6541393518447876
2023-04-19 21:46:22,829 - Detection - ***** Epoch: 72: Eval results *****
2023-04-19 21:46:22,829 - Detection -   best_eval_score = 69.91
2023-04-19 21:46:22,829 - Detection -   eval_score = 69.74
2023-04-19 21:46:22,829 - Detection -   train_loss = 1.6460631052652994
2023-04-19 21:46:25,578 - Detection - ***** Epoch: 73: Eval results *****
2023-04-19 21:46:25,578 - Detection -   best_eval_score = 69.91
2023-04-19 21:46:25,578 - Detection -   eval_score = 69.71
2023-04-19 21:46:25,578 - Detection -   train_loss = 1.6445191224416098
2023-04-19 21:46:28,323 - Detection - ***** Epoch: 74: Eval results *****
2023-04-19 21:46:28,323 - Detection -   best_eval_score = 69.91
2023-04-19 21:46:28,323 - Detection -   eval_score = 69.8
2023-04-19 21:46:28,323 - Detection -   train_loss = 1.6437151352564494
2023-04-19 21:46:31,067 - Detection - ***** Epoch: 75: Eval results *****
2023-04-19 21:46:31,067 - Detection -   best_eval_score = 69.91
2023-04-19 21:46:31,067 - Detection -   eval_score = 70.02
2023-04-19 21:46:31,067 - Detection -   train_loss = 1.6403666257858276
2023-04-19 21:46:33,825 - Detection - ***** Epoch: 76: Eval results *****
2023-04-19 21:46:33,825 - Detection -   best_eval_score = 70.02
2023-04-19 21:46:33,825 - Detection -   eval_score = 69.8
2023-04-19 21:46:33,825 - Detection -   train_loss = 1.64107080300649
2023-04-19 21:46:36,572 - Detection - ***** Epoch: 77: Eval results *****
2023-04-19 21:46:36,572 - Detection -   best_eval_score = 70.02
2023-04-19 21:46:36,572 - Detection -   eval_score = 69.71
2023-04-19 21:46:36,572 - Detection -   train_loss = 1.6355061690012613
2023-04-19 21:46:39,320 - Detection - ***** Epoch: 78: Eval results *****
2023-04-19 21:46:39,320 - Detection -   best_eval_score = 70.02
2023-04-19 21:46:39,320 - Detection -   eval_score = 69.81
2023-04-19 21:46:39,320 - Detection -   train_loss = 1.6362368186314902
2023-04-19 21:46:42,066 - Detection - ***** Epoch: 79: Eval results *****
2023-04-19 21:46:42,066 - Detection -   best_eval_score = 70.02
2023-04-19 21:46:42,066 - Detection -   eval_score = 69.91
2023-04-19 21:46:42,066 - Detection -   train_loss = 1.6337284406026205
2023-04-19 21:46:44,809 - Detection - ***** Epoch: 80: Eval results *****
2023-04-19 21:46:44,809 - Detection -   best_eval_score = 70.02
2023-04-19 21:46:44,809 - Detection -   eval_score = 69.81
2023-04-19 21:46:44,809 - Detection -   train_loss = 1.6321974277496338
2023-04-19 21:46:47,554 - Detection - ***** Epoch: 81: Eval results *****
2023-04-19 21:46:47,554 - Detection -   best_eval_score = 70.02
2023-04-19 21:46:47,554 - Detection -   eval_score = 70.02
2023-04-19 21:46:47,554 - Detection -   train_loss = 1.6289094765981038
2023-04-19 21:46:50,300 - Detection - ***** Epoch: 82: Eval results *****
2023-04-19 21:46:50,300 - Detection -   best_eval_score = 70.02
2023-04-19 21:46:50,300 - Detection -   eval_score = 70.23
2023-04-19 21:46:50,300 - Detection -   train_loss = 1.6269658565521241
2023-04-19 21:46:53,053 - Detection - ***** Epoch: 83: Eval results *****
2023-04-19 21:46:53,053 - Detection -   best_eval_score = 70.23
2023-04-19 21:46:53,054 - Detection -   eval_score = 70.23
2023-04-19 21:46:53,054 - Detection -   train_loss = 1.6259444952011108
2023-04-19 21:46:55,798 - Detection - ***** Epoch: 84: Eval results *****
2023-04-19 21:46:55,798 - Detection -   best_eval_score = 70.23
2023-04-19 21:46:55,798 - Detection -   eval_score = 70.23
2023-04-19 21:46:55,798 - Detection -   train_loss = 1.6267349561055502
2023-04-19 21:46:58,542 - Detection - ***** Epoch: 85: Eval results *****
2023-04-19 21:46:58,542 - Detection -   best_eval_score = 70.23
2023-04-19 21:46:58,542 - Detection -   eval_score = 70.1
2023-04-19 21:46:58,542 - Detection -   train_loss = 1.6239734172821045
2023-04-19 21:47:01,287 - Detection - ***** Epoch: 86: Eval results *****
2023-04-19 21:47:01,287 - Detection -   best_eval_score = 70.23
2023-04-19 21:47:01,287 - Detection -   eval_score = 70.01
2023-04-19 21:47:01,287 - Detection -   train_loss = 1.6264395475387574
2023-04-19 21:47:04,029 - Detection - ***** Epoch: 87: Eval results *****
2023-04-19 21:47:04,029 - Detection -   best_eval_score = 70.23
2023-04-19 21:47:04,029 - Detection -   eval_score = 70.13
2023-04-19 21:47:04,029 - Detection -   train_loss = 1.6258304357528686
2023-04-19 21:47:06,776 - Detection - ***** Epoch: 88: Eval results *****
2023-04-19 21:47:06,776 - Detection -   best_eval_score = 70.23
2023-04-19 21:47:06,776 - Detection -   eval_score = 70.23
2023-04-19 21:47:06,777 - Detection -   train_loss = 1.6201103846232097
2023-04-19 21:47:09,524 - Detection - ***** Epoch: 89: Eval results *****
2023-04-19 21:47:09,524 - Detection -   best_eval_score = 70.23
2023-04-19 21:47:09,524 - Detection -   eval_score = 70.1
2023-04-19 21:47:09,524 - Detection -   train_loss = 1.6193084398905435
2023-04-19 21:47:12,273 - Detection - ***** Epoch: 90: Eval results *****
2023-04-19 21:47:12,274 - Detection -   best_eval_score = 70.23
2023-04-19 21:47:12,274 - Detection -   eval_score = 70.1
2023-04-19 21:47:12,274 - Detection -   train_loss = 1.617125113805135
2023-04-19 21:47:15,016 - Detection - ***** Epoch: 91: Eval results *****
2023-04-19 21:47:15,017 - Detection -   best_eval_score = 70.23
2023-04-19 21:47:15,017 - Detection -   eval_score = 70.08
2023-04-19 21:47:15,017 - Detection -   train_loss = 1.6172826369603475
2023-04-19 21:47:17,759 - Detection - ***** Epoch: 92: Eval results *****
2023-04-19 21:47:17,759 - Detection -   best_eval_score = 70.23
2023-04-19 21:47:17,759 - Detection -   eval_score = 70.21
2023-04-19 21:47:17,759 - Detection -   train_loss = 1.624386207262675
2023-04-19 21:47:17,759 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_oos_cg_0.5_1.0_bert_disaware_1/models
2023-04-19 21:47:18,309 - Detection - Pre-training finished...
2023-04-19 21:47:18,309 - Detection - Training Begin...
2023-04-19 21:47:19,966 - Detection - ***** Epoch: 1: Eval results *****
2023-04-19 21:47:19,966 - Detection -   best_eval_score = 0
2023-04-19 21:47:19,966 - Detection -   eval_score = 1.53
2023-04-19 21:47:19,966 - Detection -   train_loss = 2.727225399017334
2023-04-19 21:47:21,625 - Detection - ***** Epoch: 2: Eval results *****
2023-04-19 21:47:21,625 - Detection -   best_eval_score = 1.53
2023-04-19 21:47:21,625 - Detection -   eval_score = 2.77
2023-04-19 21:47:21,625 - Detection -   train_loss = 2.3210458437601726
2023-04-19 21:47:23,285 - Detection - ***** Epoch: 3: Eval results *****
2023-04-19 21:47:23,285 - Detection -   best_eval_score = 2.77
2023-04-19 21:47:23,285 - Detection -   eval_score = 5.96
2023-04-19 21:47:23,285 - Detection -   train_loss = 1.8602126757303874
2023-04-19 21:47:24,943 - Detection - ***** Epoch: 4: Eval results *****
2023-04-19 21:47:24,943 - Detection -   best_eval_score = 5.96
2023-04-19 21:47:24,943 - Detection -   eval_score = 13.8
2023-04-19 21:47:24,943 - Detection -   train_loss = 1.3604220310846964
2023-04-19 21:47:26,602 - Detection - ***** Epoch: 5: Eval results *****
2023-04-19 21:47:26,602 - Detection -   best_eval_score = 13.8
2023-04-19 21:47:26,602 - Detection -   eval_score = 22.39
2023-04-19 21:47:26,602 - Detection -   train_loss = 0.9118312954902649
2023-04-19 21:47:28,262 - Detection - ***** Epoch: 6: Eval results *****
2023-04-19 21:47:28,262 - Detection -   best_eval_score = 22.39
2023-04-19 21:47:28,262 - Detection -   eval_score = 30.4
2023-04-19 21:47:28,262 - Detection -   train_loss = 0.6448058168093364
2023-04-19 21:47:29,921 - Detection - ***** Epoch: 7: Eval results *****
2023-04-19 21:47:29,921 - Detection -   best_eval_score = 30.4
2023-04-19 21:47:29,921 - Detection -   eval_score = 34.18
2023-04-19 21:47:29,921 - Detection -   train_loss = 0.53225759267807
2023-04-19 21:47:31,581 - Detection - ***** Epoch: 8: Eval results *****
2023-04-19 21:47:31,581 - Detection -   best_eval_score = 34.18
2023-04-19 21:47:31,581 - Detection -   eval_score = 36.69
2023-04-19 21:47:31,581 - Detection -   train_loss = 0.5014210164546966
2023-04-19 21:47:33,240 - Detection - ***** Epoch: 9: Eval results *****
2023-04-19 21:47:33,240 - Detection -   best_eval_score = 36.69
2023-04-19 21:47:33,240 - Detection -   eval_score = 35.12
2023-04-19 21:47:33,240 - Detection -   train_loss = 0.48345111807187396
2023-04-19 21:47:34,899 - Detection - ***** Epoch: 10: Eval results *****
2023-04-19 21:47:34,899 - Detection -   best_eval_score = 36.69
2023-04-19 21:47:34,899 - Detection -   eval_score = 34.71
2023-04-19 21:47:34,899 - Detection -   train_loss = 0.5138482848803202
2023-04-19 21:47:36,559 - Detection - ***** Epoch: 11: Eval results *****
2023-04-19 21:47:36,559 - Detection -   best_eval_score = 36.69
2023-04-19 21:47:36,559 - Detection -   eval_score = 34.97
2023-04-19 21:47:36,560 - Detection -   train_loss = 0.5077139854431152
2023-04-19 21:47:38,219 - Detection - ***** Epoch: 12: Eval results *****
2023-04-19 21:47:38,219 - Detection -   best_eval_score = 36.69
2023-04-19 21:47:38,220 - Detection -   eval_score = 35.21
2023-04-19 21:47:38,220 - Detection -   train_loss = 0.5071412245432536
2023-04-19 21:47:39,880 - Detection - ***** Epoch: 13: Eval results *****
2023-04-19 21:47:39,880 - Detection -   best_eval_score = 36.69
2023-04-19 21:47:39,880 - Detection -   eval_score = 35.66
2023-04-19 21:47:39,880 - Detection -   train_loss = 0.5189688682556153
2023-04-19 21:47:41,540 - Detection - ***** Epoch: 14: Eval results *****
2023-04-19 21:47:41,540 - Detection -   best_eval_score = 36.69
2023-04-19 21:47:41,540 - Detection -   eval_score = 34.75
2023-04-19 21:47:41,540 - Detection -   train_loss = 0.504588907957077
2023-04-19 21:47:43,201 - Detection - ***** Epoch: 15: Eval results *****
2023-04-19 21:47:43,201 - Detection -   best_eval_score = 36.69
2023-04-19 21:47:43,201 - Detection -   eval_score = 35.22
2023-04-19 21:47:43,201 - Detection -   train_loss = 0.5111307541529337
2023-04-19 21:47:44,860 - Detection - ***** Epoch: 16: Eval results *****
2023-04-19 21:47:44,860 - Detection -   best_eval_score = 36.69
2023-04-19 21:47:44,860 - Detection -   eval_score = 34.99
2023-04-19 21:47:44,860 - Detection -   train_loss = 0.5080511490503947
2023-04-19 21:47:46,521 - Detection - ***** Epoch: 17: Eval results *****
2023-04-19 21:47:46,521 - Detection -   best_eval_score = 36.69
2023-04-19 21:47:46,521 - Detection -   eval_score = 36.33
2023-04-19 21:47:46,521 - Detection -   train_loss = 0.513294380903244
2023-04-19 21:47:48,182 - Detection - ***** Epoch: 18: Eval results *****
2023-04-19 21:47:48,182 - Detection -   best_eval_score = 36.69
2023-04-19 21:47:48,182 - Detection -   eval_score = 35.55
2023-04-19 21:47:48,182 - Detection -   train_loss = 0.5174237330754597
2023-04-19 21:47:48,183 - Detection - Training Finished...
2023-04-19 21:47:48,183 - Detection - Testing begin...
2023-04-19 21:47:50,263 - Detection - ***** Test: Confusion Matrix *****
2023-04-19 21:47:50,263 - Detection - [[   1    0    0 ...    0    0   14]
 [   0    3    0 ...    0    0   12]
 [   0    0    2 ...    0    0    6]
 ...
 [   0    0    0 ...    2    0    9]
 [   0    0    0 ...    0    0   11]
 [   2    1    0 ...    0    0 2313]]
2023-04-19 21:47:50,263 - Detection - ***** Test results *****
2023-04-19 21:47:50,263 - Detection -   Acc = 73.24
2023-04-19 21:47:50,263 - Detection -   F1 = 35.3433
2023-04-19 21:47:50,263 - Detection -   F1-known = 34.7056
2023-04-19 21:47:50,263 - Detection -   F1-open = 83.1715
2023-04-19 21:47:50,263 - Detection - Testing finished...
2023-04-19 21:47:50,263 - Detection - Results saved in results/results_DA-ADB.csv
2023-04-19 21:47:50,283 - Detection - Open Intent Detection Finished...
