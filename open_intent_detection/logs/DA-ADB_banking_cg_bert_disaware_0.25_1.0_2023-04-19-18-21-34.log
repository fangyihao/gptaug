2023-04-19 18:21:34,179 - Detection - Open Intent Detection Begin...
2023-04-19 18:21:34,179 - Detection - Parameters Initialization...
2023-04-19 18:21:34,179 - Detection - ============================== Params ==============================
2023-04-19 18:21:34,179 - Detection - type:	open_intent_detection
2023-04-19 18:21:34,179 - Detection - logger_name:	Detection
2023-04-19 18:21:34,179 - Detection - log_dir:	logs
2023-04-19 18:21:34,179 - Detection - dataset:	banking_cg
2023-04-19 18:21:34,180 - Detection - known_cls_ratio:	0.25
2023-04-19 18:21:34,180 - Detection - labeled_ratio:	1.0
2023-04-19 18:21:34,180 - Detection - method:	DA-ADB
2023-04-19 18:21:34,180 - Detection - train:	True
2023-04-19 18:21:34,180 - Detection - pretrain:	True
2023-04-19 18:21:34,180 - Detection - save_model:	True
2023-04-19 18:21:34,180 - Detection - backbone:	bert_disaware
2023-04-19 18:21:34,180 - Detection - config_file_name:	DA-ADB
2023-04-19 18:21:34,180 - Detection - seed:	0
2023-04-19 18:21:34,180 - Detection - gpu_id:	0
2023-04-19 18:21:34,180 - Detection - pipe_results_path:	pipe_results
2023-04-19 18:21:34,180 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-19 18:21:34,180 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-19 18:21:34,180 - Detection - model_dir:	models
2023-04-19 18:21:34,180 - Detection - load_pretrained_method:	None
2023-04-19 18:21:34,180 - Detection - result_dir:	results
2023-04-19 18:21:34,180 - Detection - results_file_name:	results_DA-ADB.csv
2023-04-19 18:21:34,180 - Detection - save_results:	True
2023-04-19 18:21:34,180 - Detection - loss_fct:	CrossEntropyLoss
2023-04-19 18:21:34,180 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_cg_0.25_1.0_bert_disaware_0
2023-04-19 18:21:34,180 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_cg_0.25_1.0_bert_disaware_0/models
2023-04-19 18:21:34,180 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-19 18:21:34,180 - Detection - num_train_epochs:	100
2023-04-19 18:21:34,180 - Detection - num_labels:	None
2023-04-19 18:21:34,180 - Detection - max_seq_length:	None
2023-04-19 18:21:34,180 - Detection - freeze_backbone_parameters:	True
2023-04-19 18:21:34,180 - Detection - feat_dim:	768
2023-04-19 18:21:34,180 - Detection - warmup_proportion:	0.1
2023-04-19 18:21:34,180 - Detection - scale:	4
2023-04-19 18:21:34,180 - Detection - lr_boundary:	0.05
2023-04-19 18:21:34,180 - Detection - lr:	2e-05
2023-04-19 18:21:34,180 - Detection - activation:	relu
2023-04-19 18:21:34,180 - Detection - train_batch_size:	128
2023-04-19 18:21:34,180 - Detection - eval_batch_size:	64
2023-04-19 18:21:34,180 - Detection - test_batch_size:	64
2023-04-19 18:21:34,180 - Detection - wait_patient:	10
2023-04-19 18:21:34,180 - Detection - ============================== End Params ==============================
2023-04-19 18:21:34,180 - Detection - Data and Model Preparation...
2023-04-19 18:21:34,181 - Detection - The number of known intents is 19
2023-04-19 18:21:34,181 - Detection - Lists of known labels are: ['pending_top_up', 'why_verify_identity', 'top_up_failed', 'supported_cards_and_currencies', 'exchange_via_app', 'declined_card_payment', 'unable_to_verify_identity', 'exchange_rate', 'passcode_forgotten', 'verify_my_identity', 'declined_cash_withdrawal', 'top_up_limits', 'apple_pay_or_google_pay', 'lost_or_stolen_card', 'lost_or_stolen_phone', 'balance_not_updated_after_cheque_or_cash_deposit', 'change_pin', 'getting_virtual_card', 'pin_blocked']
2023-04-19 18:21:34,189 - Detection - Number of labeled training samples = 593
2023-04-19 18:21:34,189 - Detection - Number of unlabeled training samples = 2182
2023-04-19 18:21:34,191 - Detection - Number of evaluation samples = 185
2023-04-19 18:21:34,195 - Detection - Number of testing samples = 1896
2023-04-19 18:21:39,565 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-19 18:21:39,642 - Detection - Pre-training Begin...
2023-04-19 18:21:41,512 - Detection - ***** Epoch: 1: Eval results *****
2023-04-19 18:21:41,512 - Detection -   best_eval_score = 0
2023-04-19 18:21:41,512 - Detection -   eval_score = 0.69
2023-04-19 18:21:41,512 - Detection -   train_loss = 2.9459004402160645
2023-04-19 18:21:42,899 - Detection - ***** Epoch: 2: Eval results *****
2023-04-19 18:21:42,900 - Detection -   best_eval_score = 0.69
2023-04-19 18:21:42,900 - Detection -   eval_score = 1.48
2023-04-19 18:21:42,900 - Detection -   train_loss = 2.9292232036590575
2023-04-19 18:21:44,293 - Detection - ***** Epoch: 3: Eval results *****
2023-04-19 18:21:44,293 - Detection -   best_eval_score = 1.48
2023-04-19 18:21:44,293 - Detection -   eval_score = 0.8
2023-04-19 18:21:44,293 - Detection -   train_loss = 2.9023027420043945
2023-04-19 18:21:45,674 - Detection - ***** Epoch: 4: Eval results *****
2023-04-19 18:21:45,674 - Detection -   best_eval_score = 1.48
2023-04-19 18:21:45,674 - Detection -   eval_score = 0.8
2023-04-19 18:21:45,674 - Detection -   train_loss = 2.866044044494629
2023-04-19 18:21:47,057 - Detection - ***** Epoch: 5: Eval results *****
2023-04-19 18:21:47,057 - Detection -   best_eval_score = 1.48
2023-04-19 18:21:47,057 - Detection -   eval_score = 0.8
2023-04-19 18:21:47,057 - Detection -   train_loss = 2.8462470054626463
2023-04-19 18:21:48,442 - Detection - ***** Epoch: 6: Eval results *****
2023-04-19 18:21:48,442 - Detection -   best_eval_score = 1.48
2023-04-19 18:21:48,442 - Detection -   eval_score = 0.81
2023-04-19 18:21:48,442 - Detection -   train_loss = 2.8334107398986816
2023-04-19 18:21:49,828 - Detection - ***** Epoch: 7: Eval results *****
2023-04-19 18:21:49,828 - Detection -   best_eval_score = 1.48
2023-04-19 18:21:49,828 - Detection -   eval_score = 1.41
2023-04-19 18:21:49,828 - Detection -   train_loss = 2.8115110397338867
2023-04-19 18:21:51,216 - Detection - ***** Epoch: 8: Eval results *****
2023-04-19 18:21:51,216 - Detection -   best_eval_score = 1.48
2023-04-19 18:21:51,216 - Detection -   eval_score = 1.78
2023-04-19 18:21:51,216 - Detection -   train_loss = 2.785452938079834
2023-04-19 18:21:52,615 - Detection - ***** Epoch: 9: Eval results *****
2023-04-19 18:21:52,615 - Detection -   best_eval_score = 1.78
2023-04-19 18:21:52,615 - Detection -   eval_score = 2.16
2023-04-19 18:21:52,615 - Detection -   train_loss = 2.7496079921722414
2023-04-19 18:21:54,017 - Detection - ***** Epoch: 10: Eval results *****
2023-04-19 18:21:54,017 - Detection -   best_eval_score = 2.16
2023-04-19 18:21:54,017 - Detection -   eval_score = 2.72
2023-04-19 18:21:54,017 - Detection -   train_loss = 2.7041035652160645
2023-04-19 18:21:55,418 - Detection - ***** Epoch: 11: Eval results *****
2023-04-19 18:21:55,418 - Detection -   best_eval_score = 2.72
2023-04-19 18:21:55,418 - Detection -   eval_score = 5.73
2023-04-19 18:21:55,418 - Detection -   train_loss = 2.6572462558746337
2023-04-19 18:21:56,823 - Detection - ***** Epoch: 12: Eval results *****
2023-04-19 18:21:56,823 - Detection -   best_eval_score = 5.73
2023-04-19 18:21:56,823 - Detection -   eval_score = 9.08
2023-04-19 18:21:56,823 - Detection -   train_loss = 2.586450147628784
2023-04-19 18:21:58,226 - Detection - ***** Epoch: 13: Eval results *****
2023-04-19 18:21:58,226 - Detection -   best_eval_score = 9.08
2023-04-19 18:21:58,226 - Detection -   eval_score = 11.86
2023-04-19 18:21:58,226 - Detection -   train_loss = 2.4881946563720705
2023-04-19 18:21:59,634 - Detection - ***** Epoch: 14: Eval results *****
2023-04-19 18:21:59,635 - Detection -   best_eval_score = 11.86
2023-04-19 18:21:59,635 - Detection -   eval_score = 16.06
2023-04-19 18:21:59,635 - Detection -   train_loss = 2.37618727684021
2023-04-19 18:22:01,045 - Detection - ***** Epoch: 15: Eval results *****
2023-04-19 18:22:01,045 - Detection -   best_eval_score = 16.06
2023-04-19 18:22:01,045 - Detection -   eval_score = 24.8
2023-04-19 18:22:01,045 - Detection -   train_loss = 2.2651986598968508
2023-04-19 18:22:02,455 - Detection - ***** Epoch: 16: Eval results *****
2023-04-19 18:22:02,455 - Detection -   best_eval_score = 24.8
2023-04-19 18:22:02,455 - Detection -   eval_score = 30.08
2023-04-19 18:22:02,455 - Detection -   train_loss = 2.138917398452759
2023-04-19 18:22:03,867 - Detection - ***** Epoch: 17: Eval results *****
2023-04-19 18:22:03,867 - Detection -   best_eval_score = 30.08
2023-04-19 18:22:03,867 - Detection -   eval_score = 39.76
2023-04-19 18:22:03,867 - Detection -   train_loss = 2.0221165657043456
2023-04-19 18:22:05,278 - Detection - ***** Epoch: 18: Eval results *****
2023-04-19 18:22:05,278 - Detection -   best_eval_score = 39.76
2023-04-19 18:22:05,278 - Detection -   eval_score = 47.35
2023-04-19 18:22:05,278 - Detection -   train_loss = 1.9071080684661865
2023-04-19 18:22:06,796 - Detection - ***** Epoch: 19: Eval results *****
2023-04-19 18:22:06,796 - Detection -   best_eval_score = 47.35
2023-04-19 18:22:06,796 - Detection -   eval_score = 49.71
2023-04-19 18:22:06,796 - Detection -   train_loss = 1.795678687095642
2023-04-19 18:22:08,212 - Detection - ***** Epoch: 20: Eval results *****
2023-04-19 18:22:08,212 - Detection -   best_eval_score = 49.71
2023-04-19 18:22:08,212 - Detection -   eval_score = 50.36
2023-04-19 18:22:08,212 - Detection -   train_loss = 1.7019602298736571
2023-04-19 18:22:09,631 - Detection - ***** Epoch: 21: Eval results *****
2023-04-19 18:22:09,631 - Detection -   best_eval_score = 50.36
2023-04-19 18:22:09,631 - Detection -   eval_score = 53.5
2023-04-19 18:22:09,631 - Detection -   train_loss = 1.6320392847061158
2023-04-19 18:22:11,054 - Detection - ***** Epoch: 22: Eval results *****
2023-04-19 18:22:11,054 - Detection -   best_eval_score = 53.5
2023-04-19 18:22:11,054 - Detection -   eval_score = 56.92
2023-04-19 18:22:11,054 - Detection -   train_loss = 1.5542465925216675
2023-04-19 18:22:12,473 - Detection - ***** Epoch: 23: Eval results *****
2023-04-19 18:22:12,473 - Detection -   best_eval_score = 56.92
2023-04-19 18:22:12,473 - Detection -   eval_score = 59.49
2023-04-19 18:22:12,473 - Detection -   train_loss = 1.4889481782913208
2023-04-19 18:22:13,894 - Detection - ***** Epoch: 24: Eval results *****
2023-04-19 18:22:13,894 - Detection -   best_eval_score = 59.49
2023-04-19 18:22:13,894 - Detection -   eval_score = 63.3
2023-04-19 18:22:13,894 - Detection -   train_loss = 1.4458820104599
2023-04-19 18:22:15,314 - Detection - ***** Epoch: 25: Eval results *****
2023-04-19 18:22:15,314 - Detection -   best_eval_score = 63.3
2023-04-19 18:22:15,314 - Detection -   eval_score = 66.4
2023-04-19 18:22:15,314 - Detection -   train_loss = 1.3864077568054198
2023-04-19 18:22:16,736 - Detection - ***** Epoch: 26: Eval results *****
2023-04-19 18:22:16,736 - Detection -   best_eval_score = 66.4
2023-04-19 18:22:16,736 - Detection -   eval_score = 66.7
2023-04-19 18:22:16,736 - Detection -   train_loss = 1.3474441289901733
2023-04-19 18:22:18,163 - Detection - ***** Epoch: 27: Eval results *****
2023-04-19 18:22:18,163 - Detection -   best_eval_score = 66.7
2023-04-19 18:22:18,163 - Detection -   eval_score = 68.36
2023-04-19 18:22:18,163 - Detection -   train_loss = 1.3091807126998902
2023-04-19 18:22:19,590 - Detection - ***** Epoch: 28: Eval results *****
2023-04-19 18:22:19,591 - Detection -   best_eval_score = 68.36
2023-04-19 18:22:19,591 - Detection -   eval_score = 68.5
2023-04-19 18:22:19,591 - Detection -   train_loss = 1.2764548301696776
2023-04-19 18:22:21,021 - Detection - ***** Epoch: 29: Eval results *****
2023-04-19 18:22:21,021 - Detection -   best_eval_score = 68.5
2023-04-19 18:22:21,021 - Detection -   eval_score = 69.05
2023-04-19 18:22:21,021 - Detection -   train_loss = 1.2375604391098023
2023-04-19 18:22:22,452 - Detection - ***** Epoch: 30: Eval results *****
2023-04-19 18:22:22,453 - Detection -   best_eval_score = 69.05
2023-04-19 18:22:22,453 - Detection -   eval_score = 69.99
2023-04-19 18:22:22,453 - Detection -   train_loss = 1.2156809329986573
2023-04-19 18:22:23,888 - Detection - ***** Epoch: 31: Eval results *****
2023-04-19 18:22:23,888 - Detection -   best_eval_score = 69.99
2023-04-19 18:22:23,888 - Detection -   eval_score = 70.72
2023-04-19 18:22:23,888 - Detection -   train_loss = 1.1924318075180054
2023-04-19 18:22:25,319 - Detection - ***** Epoch: 32: Eval results *****
2023-04-19 18:22:25,319 - Detection -   best_eval_score = 70.72
2023-04-19 18:22:25,319 - Detection -   eval_score = 71.5
2023-04-19 18:22:25,319 - Detection -   train_loss = 1.163627314567566
2023-04-19 18:22:26,751 - Detection - ***** Epoch: 33: Eval results *****
2023-04-19 18:22:26,751 - Detection -   best_eval_score = 71.5
2023-04-19 18:22:26,751 - Detection -   eval_score = 70.29
2023-04-19 18:22:26,751 - Detection -   train_loss = 1.1424021482467652
2023-04-19 18:22:28,176 - Detection - ***** Epoch: 34: Eval results *****
2023-04-19 18:22:28,176 - Detection -   best_eval_score = 71.5
2023-04-19 18:22:28,176 - Detection -   eval_score = 73.43
2023-04-19 18:22:28,176 - Detection -   train_loss = 1.1312575578689574
2023-04-19 18:22:29,610 - Detection - ***** Epoch: 35: Eval results *****
2023-04-19 18:22:29,611 - Detection -   best_eval_score = 73.43
2023-04-19 18:22:29,611 - Detection -   eval_score = 74.94
2023-04-19 18:22:29,611 - Detection -   train_loss = 1.1067410469055177
2023-04-19 18:22:31,046 - Detection - ***** Epoch: 36: Eval results *****
2023-04-19 18:22:31,046 - Detection -   best_eval_score = 74.94
2023-04-19 18:22:31,046 - Detection -   eval_score = 73.82
2023-04-19 18:22:31,046 - Detection -   train_loss = 1.087406063079834
2023-04-19 18:22:32,476 - Detection - ***** Epoch: 37: Eval results *****
2023-04-19 18:22:32,476 - Detection -   best_eval_score = 74.94
2023-04-19 18:22:32,476 - Detection -   eval_score = 75.73
2023-04-19 18:22:32,476 - Detection -   train_loss = 1.0728954195976257
2023-04-19 18:22:33,916 - Detection - ***** Epoch: 38: Eval results *****
2023-04-19 18:22:33,916 - Detection -   best_eval_score = 75.73
2023-04-19 18:22:33,916 - Detection -   eval_score = 77.13
2023-04-19 18:22:33,916 - Detection -   train_loss = 1.063808274269104
2023-04-19 18:22:35,357 - Detection - ***** Epoch: 39: Eval results *****
2023-04-19 18:22:35,357 - Detection -   best_eval_score = 77.13
2023-04-19 18:22:35,357 - Detection -   eval_score = 76.39
2023-04-19 18:22:35,357 - Detection -   train_loss = 1.04206622838974
2023-04-19 18:22:36,788 - Detection - ***** Epoch: 40: Eval results *****
2023-04-19 18:22:36,789 - Detection -   best_eval_score = 77.13
2023-04-19 18:22:36,789 - Detection -   eval_score = 77.17
2023-04-19 18:22:36,789 - Detection -   train_loss = 1.0339731931686402
2023-04-19 18:22:38,231 - Detection - ***** Epoch: 41: Eval results *****
2023-04-19 18:22:38,231 - Detection -   best_eval_score = 77.17
2023-04-19 18:22:38,231 - Detection -   eval_score = 77.78
2023-04-19 18:22:38,231 - Detection -   train_loss = 1.0211518287658692
2023-04-19 18:22:39,674 - Detection - ***** Epoch: 42: Eval results *****
2023-04-19 18:22:39,674 - Detection -   best_eval_score = 77.78
2023-04-19 18:22:39,674 - Detection -   eval_score = 78.12
2023-04-19 18:22:39,674 - Detection -   train_loss = 1.0167915105819703
2023-04-19 18:22:41,119 - Detection - ***** Epoch: 43: Eval results *****
2023-04-19 18:22:41,119 - Detection -   best_eval_score = 78.12
2023-04-19 18:22:41,119 - Detection -   eval_score = 78.65
2023-04-19 18:22:41,119 - Detection -   train_loss = 1.0009649634361266
2023-04-19 18:22:42,565 - Detection - ***** Epoch: 44: Eval results *****
2023-04-19 18:22:42,565 - Detection -   best_eval_score = 78.65
2023-04-19 18:22:42,565 - Detection -   eval_score = 79.45
2023-04-19 18:22:42,565 - Detection -   train_loss = 0.9920288801193238
2023-04-19 18:22:44,113 - Detection - ***** Epoch: 45: Eval results *****
2023-04-19 18:22:44,113 - Detection -   best_eval_score = 79.45
2023-04-19 18:22:44,114 - Detection -   eval_score = 79.53
2023-04-19 18:22:44,114 - Detection -   train_loss = 0.9739175081253052
2023-04-19 18:22:45,560 - Detection - ***** Epoch: 46: Eval results *****
2023-04-19 18:22:45,560 - Detection -   best_eval_score = 79.53
2023-04-19 18:22:45,561 - Detection -   eval_score = 78.69
2023-04-19 18:22:45,561 - Detection -   train_loss = 0.9721765041351318
2023-04-19 18:22:46,997 - Detection - ***** Epoch: 47: Eval results *****
2023-04-19 18:22:46,997 - Detection -   best_eval_score = 79.53
2023-04-19 18:22:46,997 - Detection -   eval_score = 79.8
2023-04-19 18:22:46,997 - Detection -   train_loss = 0.9629570484161377
2023-04-19 18:22:48,446 - Detection - ***** Epoch: 48: Eval results *****
2023-04-19 18:22:48,446 - Detection -   best_eval_score = 79.8
2023-04-19 18:22:48,446 - Detection -   eval_score = 79.8
2023-04-19 18:22:48,446 - Detection -   train_loss = 0.9551004409790039
2023-04-19 18:22:49,883 - Detection - ***** Epoch: 49: Eval results *****
2023-04-19 18:22:49,883 - Detection -   best_eval_score = 79.8
2023-04-19 18:22:49,883 - Detection -   eval_score = 80.51
2023-04-19 18:22:49,883 - Detection -   train_loss = 0.9529485821723938
2023-04-19 18:22:51,332 - Detection - ***** Epoch: 50: Eval results *****
2023-04-19 18:22:51,332 - Detection -   best_eval_score = 80.51
2023-04-19 18:22:51,332 - Detection -   eval_score = 79.73
2023-04-19 18:22:51,332 - Detection -   train_loss = 0.9453097820281983
2023-04-19 18:22:52,773 - Detection - ***** Epoch: 51: Eval results *****
2023-04-19 18:22:52,773 - Detection -   best_eval_score = 80.51
2023-04-19 18:22:52,773 - Detection -   eval_score = 80.09
2023-04-19 18:22:52,773 - Detection -   train_loss = 0.9355172038078308
2023-04-19 18:22:54,213 - Detection - ***** Epoch: 52: Eval results *****
2023-04-19 18:22:54,213 - Detection -   best_eval_score = 80.51
2023-04-19 18:22:54,213 - Detection -   eval_score = 80.31
2023-04-19 18:22:54,213 - Detection -   train_loss = 0.9312380671501159
2023-04-19 18:22:55,655 - Detection - ***** Epoch: 53: Eval results *****
2023-04-19 18:22:55,655 - Detection -   best_eval_score = 80.51
2023-04-19 18:22:55,655 - Detection -   eval_score = 80.14
2023-04-19 18:22:55,655 - Detection -   train_loss = 0.919434916973114
2023-04-19 18:22:57,097 - Detection - ***** Epoch: 54: Eval results *****
2023-04-19 18:22:57,097 - Detection -   best_eval_score = 80.51
2023-04-19 18:22:57,097 - Detection -   eval_score = 80.16
2023-04-19 18:22:57,097 - Detection -   train_loss = 0.9204153537750244
2023-04-19 18:22:58,539 - Detection - ***** Epoch: 55: Eval results *****
2023-04-19 18:22:58,539 - Detection -   best_eval_score = 80.51
2023-04-19 18:22:58,539 - Detection -   eval_score = 80.63
2023-04-19 18:22:58,539 - Detection -   train_loss = 0.9147515296936035
2023-04-19 18:22:59,994 - Detection - ***** Epoch: 56: Eval results *****
2023-04-19 18:22:59,994 - Detection -   best_eval_score = 80.63
2023-04-19 18:22:59,994 - Detection -   eval_score = 81.16
2023-04-19 18:22:59,994 - Detection -   train_loss = 0.9067405462265015
2023-04-19 18:23:01,450 - Detection - ***** Epoch: 57: Eval results *****
2023-04-19 18:23:01,450 - Detection -   best_eval_score = 81.16
2023-04-19 18:23:01,450 - Detection -   eval_score = 80.81
2023-04-19 18:23:01,450 - Detection -   train_loss = 0.9055207133293152
2023-04-19 18:23:02,893 - Detection - ***** Epoch: 58: Eval results *****
2023-04-19 18:23:02,893 - Detection -   best_eval_score = 81.16
2023-04-19 18:23:02,893 - Detection -   eval_score = 80.74
2023-04-19 18:23:02,893 - Detection -   train_loss = 0.8947240352630615
2023-04-19 18:23:04,338 - Detection - ***** Epoch: 59: Eval results *****
2023-04-19 18:23:04,338 - Detection -   best_eval_score = 81.16
2023-04-19 18:23:04,338 - Detection -   eval_score = 81.45
2023-04-19 18:23:04,338 - Detection -   train_loss = 0.9011596322059632
2023-04-19 18:23:05,794 - Detection - ***** Epoch: 60: Eval results *****
2023-04-19 18:23:05,794 - Detection -   best_eval_score = 81.45
2023-04-19 18:23:05,795 - Detection -   eval_score = 81.09
2023-04-19 18:23:05,795 - Detection -   train_loss = 0.8923388600349427
2023-04-19 18:23:07,240 - Detection - ***** Epoch: 61: Eval results *****
2023-04-19 18:23:07,240 - Detection -   best_eval_score = 81.45
2023-04-19 18:23:07,240 - Detection -   eval_score = 81.09
2023-04-19 18:23:07,240 - Detection -   train_loss = 0.8904839873313903
2023-04-19 18:23:08,686 - Detection - ***** Epoch: 62: Eval results *****
2023-04-19 18:23:08,686 - Detection -   best_eval_score = 81.45
2023-04-19 18:23:08,686 - Detection -   eval_score = 81.09
2023-04-19 18:23:08,687 - Detection -   train_loss = 0.8805603384971619
2023-04-19 18:23:10,132 - Detection - ***** Epoch: 63: Eval results *****
2023-04-19 18:23:10,133 - Detection -   best_eval_score = 81.45
2023-04-19 18:23:10,133 - Detection -   eval_score = 81.09
2023-04-19 18:23:10,133 - Detection -   train_loss = 0.872310209274292
2023-04-19 18:23:11,579 - Detection - ***** Epoch: 64: Eval results *****
2023-04-19 18:23:11,579 - Detection -   best_eval_score = 81.45
2023-04-19 18:23:11,579 - Detection -   eval_score = 81.09
2023-04-19 18:23:11,579 - Detection -   train_loss = 0.8785798668861389
2023-04-19 18:23:13,028 - Detection - ***** Epoch: 65: Eval results *****
2023-04-19 18:23:13,028 - Detection -   best_eval_score = 81.45
2023-04-19 18:23:13,028 - Detection -   eval_score = 81.09
2023-04-19 18:23:13,028 - Detection -   train_loss = 0.8774184823036194
2023-04-19 18:23:14,476 - Detection - ***** Epoch: 66: Eval results *****
2023-04-19 18:23:14,477 - Detection -   best_eval_score = 81.45
2023-04-19 18:23:14,477 - Detection -   eval_score = 81.09
2023-04-19 18:23:14,477 - Detection -   train_loss = 0.8735105514526367
2023-04-19 18:23:15,927 - Detection - ***** Epoch: 67: Eval results *****
2023-04-19 18:23:15,927 - Detection -   best_eval_score = 81.45
2023-04-19 18:23:15,927 - Detection -   eval_score = 81.09
2023-04-19 18:23:15,927 - Detection -   train_loss = 0.8705397844314575
2023-04-19 18:23:17,379 - Detection - ***** Epoch: 68: Eval results *****
2023-04-19 18:23:17,379 - Detection -   best_eval_score = 81.45
2023-04-19 18:23:17,379 - Detection -   eval_score = 81.09
2023-04-19 18:23:17,379 - Detection -   train_loss = 0.8675663352012635
2023-04-19 18:23:18,831 - Detection - ***** Epoch: 69: Eval results *****
2023-04-19 18:23:18,831 - Detection -   best_eval_score = 81.45
2023-04-19 18:23:18,831 - Detection -   eval_score = 81.09
2023-04-19 18:23:18,831 - Detection -   train_loss = 0.8677804470062256
2023-04-19 18:23:18,831 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_banking_cg_0.25_1.0_bert_disaware_0/models
2023-04-19 18:23:19,370 - Detection - Pre-training finished...
2023-04-19 18:23:19,371 - Detection - Training Begin...
2023-04-19 18:23:20,225 - Detection - ***** Epoch: 1: Eval results *****
2023-04-19 18:23:20,225 - Detection -   best_eval_score = 0
2023-04-19 18:23:20,225 - Detection -   eval_score = 0.0
2023-04-19 18:23:20,225 - Detection -   train_loss = 3.4628219604492188
2023-04-19 18:23:21,085 - Detection - ***** Epoch: 2: Eval results *****
2023-04-19 18:23:21,085 - Detection -   best_eval_score = 0
2023-04-19 18:23:21,085 - Detection -   eval_score = 0.0
2023-04-19 18:23:21,085 - Detection -   train_loss = 3.3484593868255614
2023-04-19 18:23:21,942 - Detection - ***** Epoch: 3: Eval results *****
2023-04-19 18:23:21,942 - Detection -   best_eval_score = 0
2023-04-19 18:23:21,942 - Detection -   eval_score = 1.82
2023-04-19 18:23:21,942 - Detection -   train_loss = 3.217721128463745
2023-04-19 18:23:22,800 - Detection - ***** Epoch: 4: Eval results *****
2023-04-19 18:23:22,800 - Detection -   best_eval_score = 1.82
2023-04-19 18:23:22,800 - Detection -   eval_score = 1.82
2023-04-19 18:23:22,800 - Detection -   train_loss = 3.106193733215332
2023-04-19 18:23:23,657 - Detection - ***** Epoch: 5: Eval results *****
2023-04-19 18:23:23,657 - Detection -   best_eval_score = 1.82
2023-04-19 18:23:23,657 - Detection -   eval_score = 2.5
2023-04-19 18:23:23,657 - Detection -   train_loss = 2.9473289012908936
2023-04-19 18:23:24,515 - Detection - ***** Epoch: 6: Eval results *****
2023-04-19 18:23:24,515 - Detection -   best_eval_score = 2.5
2023-04-19 18:23:24,515 - Detection -   eval_score = 5.5
2023-04-19 18:23:24,515 - Detection -   train_loss = 2.7911588668823244
2023-04-19 18:23:25,373 - Detection - ***** Epoch: 7: Eval results *****
2023-04-19 18:23:25,373 - Detection -   best_eval_score = 5.5
2023-04-19 18:23:25,373 - Detection -   eval_score = 6.67
2023-04-19 18:23:25,373 - Detection -   train_loss = 2.6151994705200194
2023-04-19 18:23:26,231 - Detection - ***** Epoch: 8: Eval results *****
2023-04-19 18:23:26,231 - Detection -   best_eval_score = 6.67
2023-04-19 18:23:26,231 - Detection -   eval_score = 8.74
2023-04-19 18:23:26,231 - Detection -   train_loss = 2.4142770290374758
2023-04-19 18:23:27,088 - Detection - ***** Epoch: 9: Eval results *****
2023-04-19 18:23:27,088 - Detection -   best_eval_score = 8.74
2023-04-19 18:23:27,088 - Detection -   eval_score = 12.06
2023-04-19 18:23:27,088 - Detection -   train_loss = 2.2279917716979982
2023-04-19 18:23:27,947 - Detection - ***** Epoch: 10: Eval results *****
2023-04-19 18:23:27,947 - Detection -   best_eval_score = 12.06
2023-04-19 18:23:27,947 - Detection -   eval_score = 17.33
2023-04-19 18:23:27,947 - Detection -   train_loss = 1.9974791049957275
2023-04-19 18:23:28,806 - Detection - ***** Epoch: 11: Eval results *****
2023-04-19 18:23:28,806 - Detection -   best_eval_score = 17.33
2023-04-19 18:23:28,806 - Detection -   eval_score = 24.88
2023-04-19 18:23:28,806 - Detection -   train_loss = 1.7621241331100463
2023-04-19 18:23:29,665 - Detection - ***** Epoch: 12: Eval results *****
2023-04-19 18:23:29,665 - Detection -   best_eval_score = 24.88
2023-04-19 18:23:29,665 - Detection -   eval_score = 31.44
2023-04-19 18:23:29,665 - Detection -   train_loss = 1.5708021640777587
2023-04-19 18:23:30,524 - Detection - ***** Epoch: 13: Eval results *****
2023-04-19 18:23:30,524 - Detection -   best_eval_score = 31.44
2023-04-19 18:23:30,524 - Detection -   eval_score = 37.66
2023-04-19 18:23:30,524 - Detection -   train_loss = 1.3076394557952882
2023-04-19 18:23:31,383 - Detection - ***** Epoch: 14: Eval results *****
2023-04-19 18:23:31,383 - Detection -   best_eval_score = 37.66
2023-04-19 18:23:31,383 - Detection -   eval_score = 45.58
2023-04-19 18:23:31,383 - Detection -   train_loss = 1.1220386028289795
2023-04-19 18:23:32,242 - Detection - ***** Epoch: 15: Eval results *****
2023-04-19 18:23:32,242 - Detection -   best_eval_score = 45.58
2023-04-19 18:23:32,242 - Detection -   eval_score = 51.47
2023-04-19 18:23:32,242 - Detection -   train_loss = 0.9790786981582642
2023-04-19 18:23:33,102 - Detection - ***** Epoch: 16: Eval results *****
2023-04-19 18:23:33,102 - Detection -   best_eval_score = 51.47
2023-04-19 18:23:33,102 - Detection -   eval_score = 54.59
2023-04-19 18:23:33,102 - Detection -   train_loss = 0.8400094985961915
2023-04-19 18:23:33,963 - Detection - ***** Epoch: 17: Eval results *****
2023-04-19 18:23:33,963 - Detection -   best_eval_score = 54.59
2023-04-19 18:23:33,963 - Detection -   eval_score = 60.16
2023-04-19 18:23:33,963 - Detection -   train_loss = 0.697918152809143
2023-04-19 18:23:34,821 - Detection - ***** Epoch: 18: Eval results *****
2023-04-19 18:23:34,822 - Detection -   best_eval_score = 60.16
2023-04-19 18:23:34,822 - Detection -   eval_score = 62.01
2023-04-19 18:23:34,822 - Detection -   train_loss = 0.6248963594436645
2023-04-19 18:23:35,681 - Detection - ***** Epoch: 19: Eval results *****
2023-04-19 18:23:35,681 - Detection -   best_eval_score = 62.01
2023-04-19 18:23:35,681 - Detection -   eval_score = 62.75
2023-04-19 18:23:35,681 - Detection -   train_loss = 0.5677714586257935
2023-04-19 18:23:36,543 - Detection - ***** Epoch: 20: Eval results *****
2023-04-19 18:23:36,543 - Detection -   best_eval_score = 62.75
2023-04-19 18:23:36,543 - Detection -   eval_score = 62.83
2023-04-19 18:23:36,543 - Detection -   train_loss = 0.5756641983985901
2023-04-19 18:23:37,403 - Detection - ***** Epoch: 21: Eval results *****
2023-04-19 18:23:37,403 - Detection -   best_eval_score = 62.83
2023-04-19 18:23:37,403 - Detection -   eval_score = 62.21
2023-04-19 18:23:37,403 - Detection -   train_loss = 0.5588246703147888
2023-04-19 18:23:38,263 - Detection - ***** Epoch: 22: Eval results *****
2023-04-19 18:23:38,263 - Detection -   best_eval_score = 62.83
2023-04-19 18:23:38,263 - Detection -   eval_score = 62.37
2023-04-19 18:23:38,263 - Detection -   train_loss = 0.5663042902946472
2023-04-19 18:23:39,124 - Detection - ***** Epoch: 23: Eval results *****
2023-04-19 18:23:39,124 - Detection -   best_eval_score = 62.83
2023-04-19 18:23:39,124 - Detection -   eval_score = 62.37
2023-04-19 18:23:39,124 - Detection -   train_loss = 0.5515215516090393
2023-04-19 18:23:39,984 - Detection - ***** Epoch: 24: Eval results *****
2023-04-19 18:23:39,985 - Detection -   best_eval_score = 62.83
2023-04-19 18:23:39,985 - Detection -   eval_score = 62.17
2023-04-19 18:23:39,985 - Detection -   train_loss = 0.5221408486366272
2023-04-19 18:23:40,845 - Detection - ***** Epoch: 25: Eval results *****
2023-04-19 18:23:40,845 - Detection -   best_eval_score = 62.83
2023-04-19 18:23:40,845 - Detection -   eval_score = 61.95
2023-04-19 18:23:40,845 - Detection -   train_loss = 0.577514398097992
2023-04-19 18:23:41,706 - Detection - ***** Epoch: 26: Eval results *****
2023-04-19 18:23:41,706 - Detection -   best_eval_score = 62.83
2023-04-19 18:23:41,706 - Detection -   eval_score = 61.16
2023-04-19 18:23:41,706 - Detection -   train_loss = 0.5436524271965026
2023-04-19 18:23:42,567 - Detection - ***** Epoch: 27: Eval results *****
2023-04-19 18:23:42,567 - Detection -   best_eval_score = 62.83
2023-04-19 18:23:42,567 - Detection -   eval_score = 61.35
2023-04-19 18:23:42,567 - Detection -   train_loss = 0.5359803140163422
2023-04-19 18:23:43,427 - Detection - ***** Epoch: 28: Eval results *****
2023-04-19 18:23:43,428 - Detection -   best_eval_score = 62.83
2023-04-19 18:23:43,428 - Detection -   eval_score = 61.35
2023-04-19 18:23:43,428 - Detection -   train_loss = 0.5480713486671448
2023-04-19 18:23:44,288 - Detection - ***** Epoch: 29: Eval results *****
2023-04-19 18:23:44,288 - Detection -   best_eval_score = 62.83
2023-04-19 18:23:44,288 - Detection -   eval_score = 61.16
2023-04-19 18:23:44,289 - Detection -   train_loss = 0.5347458839416503
2023-04-19 18:23:45,149 - Detection - ***** Epoch: 30: Eval results *****
2023-04-19 18:23:45,149 - Detection -   best_eval_score = 62.83
2023-04-19 18:23:45,149 - Detection -   eval_score = 61.16
2023-04-19 18:23:45,149 - Detection -   train_loss = 0.537407523393631
2023-04-19 18:23:45,150 - Detection - Training Finished...
2023-04-19 18:23:45,151 - Detection - Testing begin...
2023-04-19 18:23:47,041 - Detection - ***** Test: Confusion Matrix *****
2023-04-19 18:23:47,042 - Detection - [[  11    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0   14]
 [   0    8    0    0    0    0   11    0    0    1    0    0    0    0
     0    0    0    0    0    2]
 [   2    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0   28]
 [   0    0    0    0   13    0    0    0    0    0    0    0    0    0
     0    0    0    0    0   11]
 [   0    0    0    0   15    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    7]
 [   0    0    0    0    0   16    0    0    0    0    0    0    0    0
     0    0    0    0    0   16]
 [   0    0    0    0    0    0   20    0    0    0    0    0    0    0
     0    0    0    0    0   10]
 [   0    0    0    0    0    0    0   20    0    0    0    0    0    0
     0    0    0    0    0    2]
 [   0    0    0    0    0    0    0    0   11    0    0    0    0    0
     0    0    0    0    0    5]
 [   0    0    0    0    0    0    6    0    0    6    0    0    0    0
     0    0    0    0    0    9]
 [   0    0    0    0    0    0    0    0    0    0   34    0    0    0
     0    0    0    0    0    1]
 [   0    0    0    0    0    0    0    0    0    0    0   11    0    0
     0    0    0    0    0    8]
 [   0    0    0    1    0    0    0    0    0    0    0    0   11    0
     0    0    0    0    0   10]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    7
     0    0    0    0    0    9]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    1
    10    0    0    0    0   13]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0   21    0    0    0    9]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    9    0    0    9]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0   16    0    5]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    2    0    4   15]
 [  14    1    0    8   29   19    0    7    0    0   62    2    0    7
     0    4    0    6    0 1287]]
2023-04-19 18:23:47,042 - Detection - ***** Test results *****
2023-04-19 18:23:47,042 - Detection -   Acc = 80.01
2023-04-19 18:23:47,042 - Detection -   F1 = 53.4881
2023-04-19 18:23:47,042 - Detection -   F1-known = 51.6574
2023-04-19 18:23:47,042 - Detection -   F1-open = 88.2716
2023-04-19 18:23:47,042 - Detection - Testing finished...
2023-04-19 18:23:47,042 - Detection - Results saved in results/results_DA-ADB.csv
2023-04-19 18:23:47,061 - Detection - Open Intent Detection Finished...
