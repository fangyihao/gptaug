2023-04-23 22:34:17,147 - Detection - Open Intent Detection Begin...
2023-04-23 22:34:17,147 - Detection - Parameters Initialization...
2023-04-23 22:34:17,147 - Detection - ============================== Params ==============================
2023-04-23 22:34:17,147 - Detection - type:	open_intent_detection
2023-04-23 22:34:17,147 - Detection - logger_name:	Detection
2023-04-23 22:34:17,147 - Detection - log_dir:	logs
2023-04-23 22:34:17,147 - Detection - dataset:	stackoverflow_cg
2023-04-23 22:34:17,147 - Detection - known_cls_ratio:	0.5
2023-04-23 22:34:17,147 - Detection - labeled_ratio:	1.0
2023-04-23 22:34:17,147 - Detection - method:	ADB
2023-04-23 22:34:17,147 - Detection - train:	True
2023-04-23 22:34:17,147 - Detection - pretrain:	True
2023-04-23 22:34:17,147 - Detection - save_model:	False
2023-04-23 22:34:17,147 - Detection - backbone:	bert_boost
2023-04-23 22:34:17,147 - Detection - config_file_name:	ADB
2023-04-23 22:34:17,147 - Detection - seed:	5
2023-04-23 22:34:17,147 - Detection - gpu_id:	0
2023-04-23 22:34:17,147 - Detection - pipe_results_path:	pipe_results
2023-04-23 22:34:17,147 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-23 22:34:17,147 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-23 22:34:17,147 - Detection - model_dir:	models
2023-04-23 22:34:17,147 - Detection - load_pretrained_method:	None
2023-04-23 22:34:17,147 - Detection - result_dir:	results
2023-04-23 22:34:17,147 - Detection - results_file_name:	results_ADB-BOOST-F-4.csv
2023-04-23 22:34:17,147 - Detection - save_results:	True
2023-04-23 22:34:17,147 - Detection - loss_fct:	CrossEntropyLoss
2023-04-23 22:34:17,147 - Detection - boost_method:	F-4
2023-04-23 22:34:17,147 - Detection - boost_start_score:	0.0
2023-04-23 22:34:17,147 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.5_1.0_bert_boost_5
2023-04-23 22:34:17,147 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.5_1.0_bert_boost_5/models
2023-04-23 22:34:17,147 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-23 22:34:17,147 - Detection - num_train_epochs:	100
2023-04-23 22:34:17,147 - Detection - num_labels:	None
2023-04-23 22:34:17,147 - Detection - max_seq_length:	None
2023-04-23 22:34:17,147 - Detection - freeze_backbone_parameters:	True
2023-04-23 22:34:17,147 - Detection - feat_dim:	768
2023-04-23 22:34:17,148 - Detection - warmup_proportion:	0.1
2023-04-23 22:34:17,148 - Detection - lr_boundary:	0.05
2023-04-23 22:34:17,148 - Detection - lr:	2e-05
2023-04-23 22:34:17,148 - Detection - activation:	relu
2023-04-23 22:34:17,148 - Detection - train_batch_size:	128
2023-04-23 22:34:17,148 - Detection - eval_batch_size:	64
2023-04-23 22:34:17,148 - Detection - test_batch_size:	64
2023-04-23 22:34:17,148 - Detection - wait_patient:	10
2023-04-23 22:34:17,148 - Detection - ============================== End Params ==============================
2023-04-23 22:34:17,148 - Detection - Data and Model Preparation...
2023-04-23 22:34:17,148 - Detection - The number of known intents is 10
2023-04-23 22:34:17,148 - Detection - Lists of known labels are: ['bash', 'excel', 'svn', 'wordpress', 'osx', 'apache', 'oracle', 'matlab', 'qt', 'visual-studio']
2023-04-23 22:34:17,157 - Detection - Number of labeled training samples = 1366
2023-04-23 22:34:17,157 - Detection - Number of unlabeled training samples = 1425
2023-04-23 22:34:17,160 - Detection - Number of evaluation samples = 715
2023-04-23 22:34:17,166 - Detection - Number of testing samples = 2905
2023-04-23 22:34:21,131 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-23 22:34:22,829 - Detection - Pre-training Begin...
2023-04-23 22:34:24,922 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 22:34:24,922 - Detection -   best_eval_score = 0
2023-04-23 22:34:24,922 - Detection -   eval_score = 9.79
2023-04-23 22:34:24,922 - Detection -   train_loss = 2.2979649630459873
2023-04-23 22:34:32,885 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 22:34:32,885 - Detection -   best_eval_score = 9.79
2023-04-23 22:34:32,885 - Detection -   eval_score = 9.93
2023-04-23 22:34:32,885 - Detection -   train_loss = 2.2820900787006724
2023-04-23 22:34:40,654 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 22:34:40,654 - Detection -   best_eval_score = 9.93
2023-04-23 22:34:40,654 - Detection -   eval_score = 50.49
2023-04-23 22:34:40,654 - Detection -   train_loss = 2.129028407010165
2023-04-23 22:34:48,486 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 22:34:48,486 - Detection -   best_eval_score = 50.49
2023-04-23 22:34:48,486 - Detection -   eval_score = 76.36
2023-04-23 22:34:48,486 - Detection -   train_loss = 1.6276303312995217
2023-04-23 22:34:56,431 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 22:34:56,431 - Detection -   best_eval_score = 76.36
2023-04-23 22:34:56,431 - Detection -   eval_score = 80.98
2023-04-23 22:34:56,431 - Detection -   train_loss = 0.9900555393912576
2023-04-23 22:35:04,272 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 22:35:04,272 - Detection -   best_eval_score = 80.98
2023-04-23 22:35:04,272 - Detection -   eval_score = 82.38
2023-04-23 22:35:04,272 - Detection -   train_loss = 0.7360567287965254
2023-04-23 22:35:12,289 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 22:35:12,289 - Detection -   best_eval_score = 82.38
2023-04-23 22:35:12,289 - Detection -   eval_score = 82.8
2023-04-23 22:35:12,289 - Detection -   train_loss = 0.6021736047484658
2023-04-23 22:35:20,110 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 22:35:20,110 - Detection -   best_eval_score = 82.8
2023-04-23 22:35:20,110 - Detection -   eval_score = 83.92
2023-04-23 22:35:20,110 - Detection -   train_loss = 0.5000624819235369
2023-04-23 22:35:27,995 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 22:35:27,995 - Detection -   best_eval_score = 83.92
2023-04-23 22:35:27,995 - Detection -   eval_score = 84.48
2023-04-23 22:35:27,995 - Detection -   train_loss = 0.4030615877021443
2023-04-23 22:35:35,785 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 22:35:35,786 - Detection -   best_eval_score = 84.48
2023-04-23 22:35:35,786 - Detection -   eval_score = 83.5
2023-04-23 22:35:35,786 - Detection -   train_loss = 0.3214289979501204
2023-04-23 22:35:43,587 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 22:35:43,587 - Detection -   best_eval_score = 84.48
2023-04-23 22:35:43,587 - Detection -   eval_score = 83.5
2023-04-23 22:35:43,587 - Detection -   train_loss = 0.2601299976760691
2023-04-23 22:35:51,469 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 22:35:51,469 - Detection -   best_eval_score = 84.48
2023-04-23 22:35:51,469 - Detection -   eval_score = 83.5
2023-04-23 22:35:51,469 - Detection -   train_loss = 0.20504638146270404
2023-04-23 22:35:59,342 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 22:35:59,342 - Detection -   best_eval_score = 84.48
2023-04-23 22:35:59,342 - Detection -   eval_score = 83.08
2023-04-23 22:35:59,342 - Detection -   train_loss = 0.1646150377663699
2023-04-23 22:36:07,226 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 22:36:07,226 - Detection -   best_eval_score = 84.48
2023-04-23 22:36:07,226 - Detection -   eval_score = 83.5
2023-04-23 22:36:07,227 - Detection -   train_loss = 0.14997687529433856
2023-04-23 22:36:15,033 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 22:36:15,033 - Detection -   best_eval_score = 84.48
2023-04-23 22:36:15,033 - Detection -   eval_score = 83.64
2023-04-23 22:36:15,033 - Detection -   train_loss = 0.13322746415029874
2023-04-23 22:36:22,869 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 22:36:22,869 - Detection -   best_eval_score = 84.48
2023-04-23 22:36:22,869 - Detection -   eval_score = 83.78
2023-04-23 22:36:22,869 - Detection -   train_loss = 0.09994722767309709
2023-04-23 22:36:30,813 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 22:36:30,813 - Detection -   best_eval_score = 84.48
2023-04-23 22:36:30,813 - Detection -   eval_score = 83.5
2023-04-23 22:36:30,813 - Detection -   train_loss = 0.09125263718041507
2023-04-23 22:36:38,572 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 22:36:38,572 - Detection -   best_eval_score = 84.48
2023-04-23 22:36:38,572 - Detection -   eval_score = 83.92
2023-04-23 22:36:38,572 - Detection -   train_loss = 0.08417025106874379
2023-04-23 22:36:46,427 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 22:36:46,427 - Detection -   best_eval_score = 84.48
2023-04-23 22:36:46,427 - Detection -   eval_score = 83.78
2023-04-23 22:36:46,427 - Detection -   train_loss = 0.06656405973163518
2023-04-23 22:36:46,428 - Detection - Pre-training finished...
2023-04-23 22:36:46,428 - Detection - Training Begin...
2023-04-23 22:36:48,602 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 22:36:48,602 - Detection -   best_eval_score = 0
2023-04-23 22:36:48,602 - Detection -   eval_score = 0.0
2023-04-23 22:36:48,602 - Detection -   train_loss = 8.338806585832076
2023-04-23 22:36:49,957 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 22:36:49,957 - Detection -   best_eval_score = 0
2023-04-23 22:36:49,957 - Detection -   eval_score = 0.0
2023-04-23 22:36:49,957 - Detection -   train_loss = 8.047106092626398
2023-04-23 22:36:51,313 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 22:36:51,313 - Detection -   best_eval_score = 0
2023-04-23 22:36:51,314 - Detection -   eval_score = 0.0
2023-04-23 22:36:51,314 - Detection -   train_loss = 7.694063533436168
2023-04-23 22:36:52,672 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 22:36:52,672 - Detection -   best_eval_score = 0
2023-04-23 22:36:52,672 - Detection -   eval_score = 0.0
2023-04-23 22:36:52,672 - Detection -   train_loss = 7.209400177001953
2023-04-23 22:36:54,028 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 22:36:54,028 - Detection -   best_eval_score = 0
2023-04-23 22:36:54,028 - Detection -   eval_score = 0.0
2023-04-23 22:36:54,028 - Detection -   train_loss = 6.702352307059548
2023-04-23 22:36:55,387 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 22:36:55,387 - Detection -   best_eval_score = 0
2023-04-23 22:36:55,387 - Detection -   eval_score = 1.65
2023-04-23 22:36:55,387 - Detection -   train_loss = 6.127204981717196
2023-04-23 22:37:03,266 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 22:37:03,266 - Detection -   best_eval_score = 1.65
2023-04-23 22:37:03,266 - Detection -   eval_score = 56.63
2023-04-23 22:37:03,266 - Detection -   train_loss = 5.504259066148237
2023-04-23 22:37:11,059 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 22:37:11,059 - Detection -   best_eval_score = 56.63
2023-04-23 22:37:11,059 - Detection -   eval_score = 75.67
2023-04-23 22:37:11,059 - Detection -   train_loss = 2.4907668070359663
2023-04-23 22:37:18,910 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 22:37:18,910 - Detection -   best_eval_score = 75.67
2023-04-23 22:37:18,910 - Detection -   eval_score = 75.74
2023-04-23 22:37:18,910 - Detection -   train_loss = 1.3979417952624233
2023-04-23 22:37:26,667 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 22:37:26,667 - Detection -   best_eval_score = 75.74
2023-04-23 22:37:26,667 - Detection -   eval_score = 75.6
2023-04-23 22:37:26,667 - Detection -   train_loss = 1.4238788756457241
2023-04-23 22:37:34,422 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 22:37:34,422 - Detection -   best_eval_score = 75.74
2023-04-23 22:37:34,422 - Detection -   eval_score = 75.74
2023-04-23 22:37:34,422 - Detection -   train_loss = 1.386815233664079
2023-04-23 22:37:42,329 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 22:37:42,329 - Detection -   best_eval_score = 75.74
2023-04-23 22:37:42,329 - Detection -   eval_score = 75.56
2023-04-23 22:37:42,329 - Detection -   train_loss = 1.3856677358800715
2023-04-23 22:37:50,052 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 22:37:50,052 - Detection -   best_eval_score = 75.74
2023-04-23 22:37:50,052 - Detection -   eval_score = 75.72
2023-04-23 22:37:50,052 - Detection -   train_loss = 1.374881386756897
2023-04-23 22:37:57,834 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 22:37:57,834 - Detection -   best_eval_score = 75.74
2023-04-23 22:37:57,834 - Detection -   eval_score = 75.5
2023-04-23 22:37:57,834 - Detection -   train_loss = 1.391623323613947
2023-04-23 22:38:05,685 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 22:38:05,685 - Detection -   best_eval_score = 75.74
2023-04-23 22:38:05,685 - Detection -   eval_score = 75.86
2023-04-23 22:38:05,685 - Detection -   train_loss = 1.3733666322448037
2023-04-23 22:38:13,424 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 22:38:13,424 - Detection -   best_eval_score = 75.86
2023-04-23 22:38:13,424 - Detection -   eval_score = 75.83
2023-04-23 22:38:13,424 - Detection -   train_loss = 1.422114220532504
2023-04-23 22:38:21,263 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 22:38:21,263 - Detection -   best_eval_score = 75.86
2023-04-23 22:38:21,263 - Detection -   eval_score = 75.73
2023-04-23 22:38:21,263 - Detection -   train_loss = 1.4111639803106135
2023-04-23 22:38:29,029 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 22:38:29,029 - Detection -   best_eval_score = 75.86
2023-04-23 22:38:29,029 - Detection -   eval_score = 75.92
2023-04-23 22:38:29,029 - Detection -   train_loss = 1.3907306844537908
2023-04-23 22:38:36,843 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 22:38:36,843 - Detection -   best_eval_score = 75.92
2023-04-23 22:38:36,843 - Detection -   eval_score = 75.72
2023-04-23 22:38:36,843 - Detection -   train_loss = 1.4156932830810547
2023-04-23 22:38:44,677 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 22:38:44,677 - Detection -   best_eval_score = 75.92
2023-04-23 22:38:44,677 - Detection -   eval_score = 75.75
2023-04-23 22:38:44,677 - Detection -   train_loss = 1.4017660834572532
2023-04-23 22:38:52,525 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 22:38:52,525 - Detection -   best_eval_score = 75.92
2023-04-23 22:38:52,525 - Detection -   eval_score = 75.69
2023-04-23 22:38:52,525 - Detection -   train_loss = 1.3799168413335627
2023-04-23 22:39:00,367 - Detection - ***** Epoch: 22: Eval results *****
2023-04-23 22:39:00,367 - Detection -   best_eval_score = 75.92
2023-04-23 22:39:00,367 - Detection -   eval_score = 75.82
2023-04-23 22:39:00,367 - Detection -   train_loss = 1.3574834628538652
2023-04-23 22:39:08,100 - Detection - ***** Epoch: 23: Eval results *****
2023-04-23 22:39:08,100 - Detection -   best_eval_score = 75.92
2023-04-23 22:39:08,100 - Detection -   eval_score = 75.82
2023-04-23 22:39:08,100 - Detection -   train_loss = 1.4224993640726262
2023-04-23 22:39:15,841 - Detection - ***** Epoch: 24: Eval results *****
2023-04-23 22:39:15,841 - Detection -   best_eval_score = 75.92
2023-04-23 22:39:15,841 - Detection -   eval_score = 75.78
2023-04-23 22:39:15,841 - Detection -   train_loss = 1.3698565634814175
2023-04-23 22:39:23,673 - Detection - ***** Epoch: 25: Eval results *****
2023-04-23 22:39:23,673 - Detection -   best_eval_score = 75.92
2023-04-23 22:39:23,673 - Detection -   eval_score = 75.77
2023-04-23 22:39:23,673 - Detection -   train_loss = 1.419064922766252
2023-04-23 22:39:31,437 - Detection - ***** Epoch: 26: Eval results *****
2023-04-23 22:39:31,437 - Detection -   best_eval_score = 75.92
2023-04-23 22:39:31,437 - Detection -   eval_score = 75.63
2023-04-23 22:39:31,437 - Detection -   train_loss = 1.4372432015158914
2023-04-23 22:39:39,308 - Detection - ***** Epoch: 27: Eval results *****
2023-04-23 22:39:39,309 - Detection -   best_eval_score = 75.92
2023-04-23 22:39:39,309 - Detection -   eval_score = 75.74
2023-04-23 22:39:39,309 - Detection -   train_loss = 1.377930998802185
2023-04-23 22:39:47,063 - Detection - ***** Epoch: 28: Eval results *****
2023-04-23 22:39:47,063 - Detection -   best_eval_score = 75.92
2023-04-23 22:39:47,063 - Detection -   eval_score = 75.64
2023-04-23 22:39:47,063 - Detection -   train_loss = 1.410463896664706
2023-04-23 22:39:47,064 - Detection - Training Finished...
2023-04-23 22:39:47,064 - Detection - Testing begin...
2023-04-23 22:39:48,813 - Detection - ***** Test: Confusion Matrix *****
2023-04-23 22:39:48,813 - Detection - [[  89    1    0    2    4    1    0    1    0    0   41]
 [   0   91    0    0    2    0    0    2    0    1   44]
 [   0    0  108    0    1    1    1    0    0    1   37]
 [   1    0    0  106    1    1    0    1    0    0   27]
 [   0    1    1    1  148    3    1    0    2    1   35]
 [   1    0    1    1    0  101    1    0    0    0   65]
 [   0    1    0    0    1    1   97    0    0    0   27]
 [   0    0    0    0    3    0    2  139    0    0   20]
 [   1    0    0    0    0    0    0    0  152    0   19]
 [   0    1    1    0    7    1    1    0    0   43   52]
 [   9   14    5    4  159   39   32   11    4   17 1114]]
2023-04-23 22:39:48,814 - Detection - ***** Test results *****
2023-04-23 22:39:48,814 - Detection -   Acc = 75.32
2023-04-23 22:39:48,814 - Detection -   F1 = 74.1256
2023-04-23 22:39:48,814 - Detection -   F1-known = 73.8261
2023-04-23 22:39:48,814 - Detection -   F1-open = 77.1201
2023-04-23 22:39:48,814 - Detection - Testing finished...
2023-04-23 22:39:48,814 - Detection - Results saved in results/results_ADB-BOOST-F-4.csv
2023-04-23 22:39:48,832 - Detection - Open Intent Detection Finished...
