2023-04-05 13:24:16,415 - Detection - Open Intent Detection Begin...
2023-04-05 13:24:16,415 - Detection - Parameters Initialization...
2023-04-05 13:24:16,416 - Detection - ============================== Params ==============================
2023-04-05 13:24:16,416 - Detection - type:	open_intent_detection
2023-04-05 13:24:16,416 - Detection - logger_name:	Detection
2023-04-05 13:24:16,416 - Detection - log_dir:	logs
2023-04-05 13:24:16,416 - Detection - dataset:	stackoverflow
2023-04-05 13:24:16,416 - Detection - known_cls_ratio:	0.5
2023-04-05 13:24:16,416 - Detection - labeled_ratio:	1.0
2023-04-05 13:24:16,416 - Detection - method:	DA-ADB
2023-04-05 13:24:16,416 - Detection - train:	True
2023-04-05 13:24:16,416 - Detection - pretrain:	True
2023-04-05 13:24:16,416 - Detection - save_model:	True
2023-04-05 13:24:16,416 - Detection - backbone:	bert_disaware
2023-04-05 13:24:16,416 - Detection - config_file_name:	DA-ADB
2023-04-05 13:24:16,416 - Detection - seed:	9
2023-04-05 13:24:16,416 - Detection - gpu_id:	0
2023-04-05 13:24:16,416 - Detection - pipe_results_path:	pipe_results
2023-04-05 13:24:16,416 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-05 13:24:16,416 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-05 13:24:16,416 - Detection - model_dir:	models
2023-04-05 13:24:16,416 - Detection - load_pretrained_method:	None
2023-04-05 13:24:16,416 - Detection - result_dir:	results
2023-04-05 13:24:16,416 - Detection - results_file_name:	results_DA-ADB.csv
2023-04-05 13:24:16,416 - Detection - save_results:	True
2023-04-05 13:24:16,416 - Detection - loss_fct:	CrossEntropyLoss
2023-04-05 13:24:16,416 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_0.5_1.0_bert_disaware_9
2023-04-05 13:24:16,416 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_0.5_1.0_bert_disaware_9/models
2023-04-05 13:24:16,416 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-05 13:24:16,416 - Detection - num_train_epochs:	100
2023-04-05 13:24:16,416 - Detection - num_labels:	None
2023-04-05 13:24:16,416 - Detection - max_seq_length:	None
2023-04-05 13:24:16,416 - Detection - freeze_backbone_parameters:	True
2023-04-05 13:24:16,416 - Detection - feat_dim:	768
2023-04-05 13:24:16,416 - Detection - warmup_proportion:	0.1
2023-04-05 13:24:16,416 - Detection - scale:	4
2023-04-05 13:24:16,416 - Detection - lr_boundary:	0.05
2023-04-05 13:24:16,416 - Detection - lr:	2e-05
2023-04-05 13:24:16,416 - Detection - activation:	relu
2023-04-05 13:24:16,416 - Detection - train_batch_size:	128
2023-04-05 13:24:16,416 - Detection - eval_batch_size:	64
2023-04-05 13:24:16,416 - Detection - test_batch_size:	64
2023-04-05 13:24:16,416 - Detection - wait_patient:	10
2023-04-05 13:24:16,416 - Detection - ============================== End Params ==============================
2023-04-05 13:24:16,416 - Detection - Data and Model Preparation...
2023-04-05 13:24:16,417 - Detection - The number of known intents is 10
2023-04-05 13:24:16,417 - Detection - Lists of known labels are: ['cocoa', 'haskell', 'hibernate', 'excel', 'spring', 'sharepoint', 'bash', 'drupal', 'magento', 'matlab']
2023-04-05 13:24:16,451 - Detection - Number of labeled training samples = 6000
2023-04-05 13:24:16,451 - Detection - Number of unlabeled training samples = 6000
2023-04-05 13:24:16,456 - Detection - Number of evaluation samples = 1000
2023-04-05 13:24:16,467 - Detection - Number of testing samples = 6000
2023-04-05 13:24:24,577 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-05 13:24:24,658 - Detection - Pre-training Begin...
2023-04-05 13:24:36,302 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 13:24:36,302 - Detection -   best_eval_score = 0
2023-04-05 13:24:36,302 - Detection -   eval_score = 9.19
2023-04-05 13:24:36,302 - Detection -   train_loss = 2.3058429068707404
2023-04-05 13:24:47,462 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 13:24:47,462 - Detection -   best_eval_score = 9.19
2023-04-05 13:24:47,462 - Detection -   eval_score = 26.66
2023-04-05 13:24:47,462 - Detection -   train_loss = 2.2867967372244977
2023-04-05 13:24:58,700 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 13:24:58,700 - Detection -   best_eval_score = 26.66
2023-04-05 13:24:58,700 - Detection -   eval_score = 31.03
2023-04-05 13:24:58,700 - Detection -   train_loss = 2.2458773826030973
2023-04-05 13:25:09,990 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 13:25:09,990 - Detection -   best_eval_score = 31.03
2023-04-05 13:25:09,990 - Detection -   eval_score = 57.69
2023-04-05 13:25:09,991 - Detection -   train_loss = 2.082405354114289
2023-04-05 13:25:21,311 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 13:25:21,311 - Detection -   best_eval_score = 57.69
2023-04-05 13:25:21,311 - Detection -   eval_score = 81.45
2023-04-05 13:25:21,311 - Detection -   train_loss = 1.6448298160065995
2023-04-05 13:25:32,782 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 13:25:32,782 - Detection -   best_eval_score = 81.45
2023-04-05 13:25:32,782 - Detection -   eval_score = 85.68
2023-04-05 13:25:32,782 - Detection -   train_loss = 1.1134575935120279
2023-04-05 13:25:44,107 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 13:25:44,107 - Detection -   best_eval_score = 85.68
2023-04-05 13:25:44,107 - Detection -   eval_score = 87.65
2023-04-05 13:25:44,107 - Detection -   train_loss = 0.8779427726218041
2023-04-05 13:25:55,420 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 13:25:55,420 - Detection -   best_eval_score = 87.65
2023-04-05 13:25:55,420 - Detection -   eval_score = 87.74
2023-04-05 13:25:55,420 - Detection -   train_loss = 0.783563734369075
2023-04-05 13:26:06,742 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 13:26:06,742 - Detection -   best_eval_score = 87.74
2023-04-05 13:26:06,742 - Detection -   eval_score = 88.33
2023-04-05 13:26:06,742 - Detection -   train_loss = 0.71569517445057
2023-04-05 13:26:18,057 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 13:26:18,058 - Detection -   best_eval_score = 88.33
2023-04-05 13:26:18,058 - Detection -   eval_score = 88.77
2023-04-05 13:26:18,058 - Detection -   train_loss = 0.6661438624909584
2023-04-05 13:26:29,395 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 13:26:29,395 - Detection -   best_eval_score = 88.77
2023-04-05 13:26:29,395 - Detection -   eval_score = 89.39
2023-04-05 13:26:29,395 - Detection -   train_loss = 0.6268195078728047
2023-04-05 13:26:40,716 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 13:26:40,716 - Detection -   best_eval_score = 89.39
2023-04-05 13:26:40,716 - Detection -   eval_score = 89.62
2023-04-05 13:26:40,716 - Detection -   train_loss = 0.5906186756935525
2023-04-05 13:26:52,047 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 13:26:52,047 - Detection -   best_eval_score = 89.62
2023-04-05 13:26:52,047 - Detection -   eval_score = 89.69
2023-04-05 13:26:52,047 - Detection -   train_loss = 0.567219004352042
2023-04-05 13:27:03,380 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 13:27:03,380 - Detection -   best_eval_score = 89.69
2023-04-05 13:27:03,380 - Detection -   eval_score = 90.06
2023-04-05 13:27:03,380 - Detection -   train_loss = 0.5396040189773479
2023-04-05 13:27:14,714 - Detection - ***** Epoch: 15: Eval results *****
2023-04-05 13:27:14,714 - Detection -   best_eval_score = 90.06
2023-04-05 13:27:14,714 - Detection -   eval_score = 90.08
2023-04-05 13:27:14,714 - Detection -   train_loss = 0.5187529522053739
2023-04-05 13:27:26,052 - Detection - ***** Epoch: 16: Eval results *****
2023-04-05 13:27:26,052 - Detection -   best_eval_score = 90.08
2023-04-05 13:27:26,053 - Detection -   eval_score = 89.92
2023-04-05 13:27:26,053 - Detection -   train_loss = 0.5014042169489759
2023-04-05 13:27:37,486 - Detection - ***** Epoch: 17: Eval results *****
2023-04-05 13:27:37,486 - Detection -   best_eval_score = 90.08
2023-04-05 13:27:37,486 - Detection -   eval_score = 90.37
2023-04-05 13:27:37,487 - Detection -   train_loss = 0.48280216848596613
2023-04-05 13:27:48,826 - Detection - ***** Epoch: 18: Eval results *****
2023-04-05 13:27:48,826 - Detection -   best_eval_score = 90.37
2023-04-05 13:27:48,826 - Detection -   eval_score = 90.17
2023-04-05 13:27:48,826 - Detection -   train_loss = 0.4674795295329804
2023-04-05 13:28:00,140 - Detection - ***** Epoch: 19: Eval results *****
2023-04-05 13:28:00,140 - Detection -   best_eval_score = 90.37
2023-04-05 13:28:00,140 - Detection -   eval_score = 90.45
2023-04-05 13:28:00,140 - Detection -   train_loss = 0.4515025882010764
2023-04-05 13:28:11,477 - Detection - ***** Epoch: 20: Eval results *****
2023-04-05 13:28:11,477 - Detection -   best_eval_score = 90.45
2023-04-05 13:28:11,477 - Detection -   eval_score = 90.75
2023-04-05 13:28:11,477 - Detection -   train_loss = 0.4404409927256564
2023-04-05 13:28:22,801 - Detection - ***** Epoch: 21: Eval results *****
2023-04-05 13:28:22,801 - Detection -   best_eval_score = 90.75
2023-04-05 13:28:22,801 - Detection -   eval_score = 90.64
2023-04-05 13:28:22,801 - Detection -   train_loss = 0.42698527396993435
2023-04-05 13:28:34,119 - Detection - ***** Epoch: 22: Eval results *****
2023-04-05 13:28:34,119 - Detection -   best_eval_score = 90.75
2023-04-05 13:28:34,119 - Detection -   eval_score = 91.04
2023-04-05 13:28:34,119 - Detection -   train_loss = 0.41634918273763455
2023-04-05 13:28:45,439 - Detection - ***** Epoch: 23: Eval results *****
2023-04-05 13:28:45,439 - Detection -   best_eval_score = 91.04
2023-04-05 13:28:45,439 - Detection -   eval_score = 90.26
2023-04-05 13:28:45,439 - Detection -   train_loss = 0.40445361492481635
2023-04-05 13:28:56,728 - Detection - ***** Epoch: 24: Eval results *****
2023-04-05 13:28:56,728 - Detection -   best_eval_score = 91.04
2023-04-05 13:28:56,728 - Detection -   eval_score = 90.94
2023-04-05 13:28:56,728 - Detection -   train_loss = 0.39784550096126314
2023-04-05 13:29:08,020 - Detection - ***** Epoch: 25: Eval results *****
2023-04-05 13:29:08,021 - Detection -   best_eval_score = 91.04
2023-04-05 13:29:08,021 - Detection -   eval_score = 90.17
2023-04-05 13:29:08,021 - Detection -   train_loss = 0.38794444533104594
2023-04-05 13:29:19,321 - Detection - ***** Epoch: 26: Eval results *****
2023-04-05 13:29:19,321 - Detection -   best_eval_score = 91.04
2023-04-05 13:29:19,321 - Detection -   eval_score = 90.42
2023-04-05 13:29:19,321 - Detection -   train_loss = 0.3756799602762182
2023-04-05 13:29:30,603 - Detection - ***** Epoch: 27: Eval results *****
2023-04-05 13:29:30,603 - Detection -   best_eval_score = 91.04
2023-04-05 13:29:30,603 - Detection -   eval_score = 90.84
2023-04-05 13:29:30,604 - Detection -   train_loss = 0.37060668113383843
2023-04-05 13:29:41,886 - Detection - ***** Epoch: 28: Eval results *****
2023-04-05 13:29:41,886 - Detection -   best_eval_score = 91.04
2023-04-05 13:29:41,886 - Detection -   eval_score = 90.29
2023-04-05 13:29:41,886 - Detection -   train_loss = 0.36275576847664853
2023-04-05 13:29:53,155 - Detection - ***** Epoch: 29: Eval results *****
2023-04-05 13:29:53,156 - Detection -   best_eval_score = 91.04
2023-04-05 13:29:53,156 - Detection -   eval_score = 90.82
2023-04-05 13:29:53,156 - Detection -   train_loss = 0.35795552996878927
2023-04-05 13:30:04,433 - Detection - ***** Epoch: 30: Eval results *****
2023-04-05 13:30:04,433 - Detection -   best_eval_score = 91.04
2023-04-05 13:30:04,433 - Detection -   eval_score = 90.52
2023-04-05 13:30:04,433 - Detection -   train_loss = 0.3493878188285422
2023-04-05 13:30:15,726 - Detection - ***** Epoch: 31: Eval results *****
2023-04-05 13:30:15,726 - Detection -   best_eval_score = 91.04
2023-04-05 13:30:15,726 - Detection -   eval_score = 91.02
2023-04-05 13:30:15,726 - Detection -   train_loss = 0.3428784393249674
2023-04-05 13:30:27,119 - Detection - ***** Epoch: 32: Eval results *****
2023-04-05 13:30:27,119 - Detection -   best_eval_score = 91.04
2023-04-05 13:30:27,119 - Detection -   eval_score = 90.8
2023-04-05 13:30:27,119 - Detection -   train_loss = 0.33921088563634993
2023-04-05 13:30:27,120 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_0.5_1.0_bert_disaware_9/models
2023-04-05 13:30:27,671 - Detection - Pre-training finished...
2023-04-05 13:30:27,671 - Detection - Training Begin...
2023-04-05 13:30:34,004 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 13:30:34,004 - Detection -   best_eval_score = 0
2023-04-05 13:30:34,004 - Detection -   eval_score = 39.74
2023-04-05 13:30:34,004 - Detection -   train_loss = 4.032428462454614
2023-04-05 13:30:40,349 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 13:30:40,349 - Detection -   best_eval_score = 39.74
2023-04-05 13:30:40,349 - Detection -   eval_score = 79.3
2023-04-05 13:30:40,349 - Detection -   train_loss = 1.9877430707850354
2023-04-05 13:30:46,692 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 13:30:46,692 - Detection -   best_eval_score = 79.3
2023-04-05 13:30:46,692 - Detection -   eval_score = 80.52
2023-04-05 13:30:46,692 - Detection -   train_loss = 1.1284076267100396
2023-04-05 13:30:53,037 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 13:30:53,037 - Detection -   best_eval_score = 80.52
2023-04-05 13:30:53,037 - Detection -   eval_score = 80.52
2023-04-05 13:30:53,037 - Detection -   train_loss = 1.1223961774339066
2023-04-05 13:30:59,380 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 13:30:59,380 - Detection -   best_eval_score = 80.52
2023-04-05 13:30:59,380 - Detection -   eval_score = 80.58
2023-04-05 13:30:59,380 - Detection -   train_loss = 1.1236024714530783
2023-04-05 13:31:05,730 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 13:31:05,730 - Detection -   best_eval_score = 80.58
2023-04-05 13:31:05,730 - Detection -   eval_score = 80.58
2023-04-05 13:31:05,730 - Detection -   train_loss = 1.1157055712760764
2023-04-05 13:31:12,081 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 13:31:12,082 - Detection -   best_eval_score = 80.58
2023-04-05 13:31:12,082 - Detection -   eval_score = 80.58
2023-04-05 13:31:12,082 - Detection -   train_loss = 1.1206116625603209
2023-04-05 13:31:18,433 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 13:31:18,433 - Detection -   best_eval_score = 80.58
2023-04-05 13:31:18,433 - Detection -   eval_score = 80.58
2023-04-05 13:31:18,433 - Detection -   train_loss = 1.1143122353452317
2023-04-05 13:31:24,788 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 13:31:24,788 - Detection -   best_eval_score = 80.58
2023-04-05 13:31:24,788 - Detection -   eval_score = 80.52
2023-04-05 13:31:24,788 - Detection -   train_loss = 1.1165966467654451
2023-04-05 13:31:31,143 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 13:31:31,143 - Detection -   best_eval_score = 80.58
2023-04-05 13:31:31,143 - Detection -   eval_score = 80.58
2023-04-05 13:31:31,143 - Detection -   train_loss = 1.1233874559402466
2023-04-05 13:31:37,501 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 13:31:37,501 - Detection -   best_eval_score = 80.58
2023-04-05 13:31:37,501 - Detection -   eval_score = 80.58
2023-04-05 13:31:37,501 - Detection -   train_loss = 1.1249275372383443
2023-04-05 13:31:43,866 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 13:31:43,866 - Detection -   best_eval_score = 80.58
2023-04-05 13:31:43,866 - Detection -   eval_score = 80.52
2023-04-05 13:31:43,866 - Detection -   train_loss = 1.1163110935941656
2023-04-05 13:31:50,231 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 13:31:50,231 - Detection -   best_eval_score = 80.58
2023-04-05 13:31:50,231 - Detection -   eval_score = 80.58
2023-04-05 13:31:50,231 - Detection -   train_loss = 1.1189694011465032
2023-04-05 13:31:56,602 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 13:31:56,602 - Detection -   best_eval_score = 80.58
2023-04-05 13:31:56,603 - Detection -   eval_score = 80.52
2023-04-05 13:31:56,603 - Detection -   train_loss = 1.1245563638971208
2023-04-05 13:32:02,978 - Detection - ***** Epoch: 15: Eval results *****
2023-04-05 13:32:02,978 - Detection -   best_eval_score = 80.58
2023-04-05 13:32:02,978 - Detection -   eval_score = 80.46
2023-04-05 13:32:02,978 - Detection -   train_loss = 1.1127622330442388
2023-04-05 13:32:02,979 - Detection - Training Finished...
2023-04-05 13:32:02,979 - Detection - Testing begin...
2023-04-05 13:32:07,974 - Detection - ***** Test: Confusion Matrix *****
2023-04-05 13:32:07,974 - Detection - [[ 214    0    0    0    0    0    1    0    0    0   85]
 [   0  233    0    0    0    0    1    0    0    0   66]
 [   0    0  252    0    1    0    0    0    0    0   47]
 [   0    0    0  243    0    0    0    0    0    0   57]
 [   0    0    2    0  227    0    0    0    0    0   71]
 [   0    0    0    1    0  255    1    0    0    0   43]
 [   2    0    0    0    0    0  233    0    0    1   64]
 [   0    0    0    0    0    0    0  256    0    0   44]
 [   0    0    0    0    0    0    0    0  261    0   39]
 [   0    0    0    0    0    0    0    0    0  253   47]
 [ 146    8    1    5    2    6   54    3    0    0 2775]]
2023-04-05 13:32:07,974 - Detection - ***** Test results *****
2023-04-05 13:32:07,974 - Detection -   Acc = 86.7
2023-04-05 13:32:07,974 - Detection -   F1 = 86.2928
2023-04-05 13:32:07,974 - Detection -   F1-known = 86.1653
2023-04-05 13:32:07,974 - Detection -   F1-open = 87.5671
2023-04-05 13:32:07,974 - Detection - Testing finished...
2023-04-05 13:32:07,974 - Detection - Results saved in results/results_DA-ADB.csv
2023-04-05 13:32:07,994 - Detection - Open Intent Detection Finished...
