2023-04-05 06:38:41,336 - Detection - Open Intent Detection Begin...
2023-04-05 06:38:41,336 - Detection - Parameters Initialization...
2023-04-05 06:38:41,336 - Detection - ============================== Params ==============================
2023-04-05 06:38:41,336 - Detection - type:	open_intent_detection
2023-04-05 06:38:41,336 - Detection - logger_name:	Detection
2023-04-05 06:38:41,336 - Detection - log_dir:	logs
2023-04-05 06:38:41,336 - Detection - dataset:	stackoverflow
2023-04-05 06:38:41,336 - Detection - known_cls_ratio:	0.5
2023-04-05 06:38:41,336 - Detection - labeled_ratio:	1.0
2023-04-05 06:38:41,336 - Detection - method:	ADB
2023-04-05 06:38:41,336 - Detection - train:	True
2023-04-05 06:38:41,337 - Detection - pretrain:	True
2023-04-05 06:38:41,337 - Detection - save_model:	True
2023-04-05 06:38:41,337 - Detection - backbone:	bert
2023-04-05 06:38:41,337 - Detection - config_file_name:	ADB
2023-04-05 06:38:41,337 - Detection - seed:	5
2023-04-05 06:38:41,337 - Detection - gpu_id:	0
2023-04-05 06:38:41,337 - Detection - pipe_results_path:	pipe_results
2023-04-05 06:38:41,337 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-05 06:38:41,337 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-05 06:38:41,337 - Detection - model_dir:	models
2023-04-05 06:38:41,337 - Detection - load_pretrained_method:	None
2023-04-05 06:38:41,337 - Detection - result_dir:	results
2023-04-05 06:38:41,337 - Detection - results_file_name:	results_ADB.csv
2023-04-05 06:38:41,337 - Detection - save_results:	True
2023-04-05 06:38:41,337 - Detection - loss_fct:	CrossEntropyLoss
2023-04-05 06:38:41,337 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_0.5_1.0_bert_5
2023-04-05 06:38:41,337 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_0.5_1.0_bert_5/models
2023-04-05 06:38:41,337 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-05 06:38:41,337 - Detection - num_train_epochs:	100
2023-04-05 06:38:41,337 - Detection - num_labels:	None
2023-04-05 06:38:41,337 - Detection - max_seq_length:	None
2023-04-05 06:38:41,337 - Detection - freeze_backbone_parameters:	True
2023-04-05 06:38:41,337 - Detection - feat_dim:	768
2023-04-05 06:38:41,337 - Detection - warmup_proportion:	0.1
2023-04-05 06:38:41,337 - Detection - lr_boundary:	0.05
2023-04-05 06:38:41,337 - Detection - lr:	2e-05
2023-04-05 06:38:41,337 - Detection - activation:	relu
2023-04-05 06:38:41,337 - Detection - train_batch_size:	128
2023-04-05 06:38:41,337 - Detection - eval_batch_size:	64
2023-04-05 06:38:41,337 - Detection - test_batch_size:	64
2023-04-05 06:38:41,337 - Detection - wait_patient:	10
2023-04-05 06:38:41,337 - Detection - ============================== End Params ==============================
2023-04-05 06:38:41,337 - Detection - Data and Model Preparation...
2023-04-05 06:38:41,338 - Detection - The number of known intents is 10
2023-04-05 06:38:41,338 - Detection - Lists of known labels are: ['bash', 'excel', 'svn', 'wordpress', 'osx', 'apache', 'oracle', 'matlab', 'qt', 'visual-studio']
2023-04-05 06:38:41,374 - Detection - Number of labeled training samples = 6000
2023-04-05 06:38:41,374 - Detection - Number of unlabeled training samples = 6000
2023-04-05 06:38:41,378 - Detection - Number of evaluation samples = 1000
2023-04-05 06:38:41,391 - Detection - Number of testing samples = 6000
2023-04-05 06:38:48,910 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-05 06:38:50,574 - Detection - Pre-training Begin...
2023-04-05 06:38:57,628 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 06:38:57,628 - Detection -   best_eval_score = 0
2023-04-05 06:38:57,628 - Detection -   eval_score = 16.9
2023-04-05 06:38:57,628 - Detection -   train_loss = 2.2939657251885595
2023-04-05 06:39:04,163 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 06:39:04,163 - Detection -   best_eval_score = 16.9
2023-04-05 06:39:04,164 - Detection -   eval_score = 52.8
2023-04-05 06:39:04,164 - Detection -   train_loss = 2.241715355122343
2023-04-05 06:39:10,888 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 06:39:10,888 - Detection -   best_eval_score = 52.8
2023-04-05 06:39:10,888 - Detection -   eval_score = 67.2
2023-04-05 06:39:10,888 - Detection -   train_loss = 2.054689775121973
2023-04-05 06:39:17,835 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 06:39:17,835 - Detection -   best_eval_score = 67.2
2023-04-05 06:39:17,835 - Detection -   eval_score = 80.8
2023-04-05 06:39:17,835 - Detection -   train_loss = 1.4646388190857909
2023-04-05 06:39:24,817 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 06:39:24,817 - Detection -   best_eval_score = 80.8
2023-04-05 06:39:24,817 - Detection -   eval_score = 84.2
2023-04-05 06:39:24,817 - Detection -   train_loss = 0.8059255246152269
2023-04-05 06:39:31,806 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 06:39:31,806 - Detection -   best_eval_score = 84.2
2023-04-05 06:39:31,806 - Detection -   eval_score = 85.8
2023-04-05 06:39:31,806 - Detection -   train_loss = 0.531928908951739
2023-04-05 06:39:38,785 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 06:39:38,785 - Detection -   best_eval_score = 85.8
2023-04-05 06:39:38,785 - Detection -   eval_score = 86.9
2023-04-05 06:39:38,785 - Detection -   train_loss = 0.4432570306544608
2023-04-05 06:39:45,856 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 06:39:45,856 - Detection -   best_eval_score = 86.9
2023-04-05 06:39:45,856 - Detection -   eval_score = 87.1
2023-04-05 06:39:45,856 - Detection -   train_loss = 0.3882557990703177
2023-04-05 06:39:52,841 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 06:39:52,842 - Detection -   best_eval_score = 87.1
2023-04-05 06:39:52,842 - Detection -   eval_score = 87.4
2023-04-05 06:39:52,842 - Detection -   train_loss = 0.3597246715997128
2023-04-05 06:39:59,832 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 06:39:59,832 - Detection -   best_eval_score = 87.4
2023-04-05 06:39:59,832 - Detection -   eval_score = 88.5
2023-04-05 06:39:59,832 - Detection -   train_loss = 0.3266071544048634
2023-04-05 06:40:06,810 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 06:40:06,810 - Detection -   best_eval_score = 88.5
2023-04-05 06:40:06,810 - Detection -   eval_score = 88.7
2023-04-05 06:40:06,810 - Detection -   train_loss = 0.29868486365105246
2023-04-05 06:40:13,800 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 06:40:13,800 - Detection -   best_eval_score = 88.7
2023-04-05 06:40:13,800 - Detection -   eval_score = 89.4
2023-04-05 06:40:13,800 - Detection -   train_loss = 0.2793536382786771
2023-04-05 06:40:20,779 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 06:40:20,779 - Detection -   best_eval_score = 89.4
2023-04-05 06:40:20,779 - Detection -   eval_score = 89.1
2023-04-05 06:40:20,779 - Detection -   train_loss = 0.25702382243694144
2023-04-05 06:40:27,742 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 06:40:27,742 - Detection -   best_eval_score = 89.4
2023-04-05 06:40:27,742 - Detection -   eval_score = 88.9
2023-04-05 06:40:27,742 - Detection -   train_loss = 0.24311435048250443
2023-04-05 06:40:34,706 - Detection - ***** Epoch: 15: Eval results *****
2023-04-05 06:40:34,706 - Detection -   best_eval_score = 89.4
2023-04-05 06:40:34,706 - Detection -   eval_score = 89.2
2023-04-05 06:40:34,706 - Detection -   train_loss = 0.22482841842352075
2023-04-05 06:40:41,668 - Detection - ***** Epoch: 16: Eval results *****
2023-04-05 06:40:41,668 - Detection -   best_eval_score = 89.4
2023-04-05 06:40:41,668 - Detection -   eval_score = 89.7
2023-04-05 06:40:41,668 - Detection -   train_loss = 0.21839803948681405
2023-04-05 06:40:48,674 - Detection - ***** Epoch: 17: Eval results *****
2023-04-05 06:40:48,674 - Detection -   best_eval_score = 89.7
2023-04-05 06:40:48,674 - Detection -   eval_score = 89.5
2023-04-05 06:40:48,674 - Detection -   train_loss = 0.20535678464047452
2023-04-05 06:40:55,650 - Detection - ***** Epoch: 18: Eval results *****
2023-04-05 06:40:55,650 - Detection -   best_eval_score = 89.7
2023-04-05 06:40:55,650 - Detection -   eval_score = 90.0
2023-04-05 06:40:55,650 - Detection -   train_loss = 0.19191224445053873
2023-04-05 06:41:02,649 - Detection - ***** Epoch: 19: Eval results *****
2023-04-05 06:41:02,650 - Detection -   best_eval_score = 90.0
2023-04-05 06:41:02,650 - Detection -   eval_score = 89.9
2023-04-05 06:41:02,650 - Detection -   train_loss = 0.17751168412096957
2023-04-05 06:41:09,620 - Detection - ***** Epoch: 20: Eval results *****
2023-04-05 06:41:09,620 - Detection -   best_eval_score = 90.0
2023-04-05 06:41:09,620 - Detection -   eval_score = 89.8
2023-04-05 06:41:09,620 - Detection -   train_loss = 0.1704357329835283
2023-04-05 06:41:16,579 - Detection - ***** Epoch: 21: Eval results *****
2023-04-05 06:41:16,579 - Detection -   best_eval_score = 90.0
2023-04-05 06:41:16,579 - Detection -   eval_score = 89.7
2023-04-05 06:41:16,579 - Detection -   train_loss = 0.16029379778402916
2023-04-05 06:41:23,525 - Detection - ***** Epoch: 22: Eval results *****
2023-04-05 06:41:23,525 - Detection -   best_eval_score = 90.0
2023-04-05 06:41:23,525 - Detection -   eval_score = 89.8
2023-04-05 06:41:23,525 - Detection -   train_loss = 0.1567630228844095
2023-04-05 06:41:30,477 - Detection - ***** Epoch: 23: Eval results *****
2023-04-05 06:41:30,477 - Detection -   best_eval_score = 90.0
2023-04-05 06:41:30,477 - Detection -   eval_score = 89.9
2023-04-05 06:41:30,477 - Detection -   train_loss = 0.14442310632860406
2023-04-05 06:41:37,414 - Detection - ***** Epoch: 24: Eval results *****
2023-04-05 06:41:37,414 - Detection -   best_eval_score = 90.0
2023-04-05 06:41:37,414 - Detection -   eval_score = 89.8
2023-04-05 06:41:37,414 - Detection -   train_loss = 0.13802222638054096
2023-04-05 06:41:44,356 - Detection - ***** Epoch: 25: Eval results *****
2023-04-05 06:41:44,357 - Detection -   best_eval_score = 90.0
2023-04-05 06:41:44,357 - Detection -   eval_score = 89.9
2023-04-05 06:41:44,357 - Detection -   train_loss = 0.12906391617465526
2023-04-05 06:41:51,305 - Detection - ***** Epoch: 26: Eval results *****
2023-04-05 06:41:51,305 - Detection -   best_eval_score = 90.0
2023-04-05 06:41:51,305 - Detection -   eval_score = 90.0
2023-04-05 06:41:51,305 - Detection -   train_loss = 0.12328107044734854
2023-04-05 06:41:58,232 - Detection - ***** Epoch: 27: Eval results *****
2023-04-05 06:41:58,232 - Detection -   best_eval_score = 90.0
2023-04-05 06:41:58,232 - Detection -   eval_score = 89.5
2023-04-05 06:41:58,232 - Detection -   train_loss = 0.11745579659621766
2023-04-05 06:42:05,190 - Detection - ***** Epoch: 28: Eval results *****
2023-04-05 06:42:05,191 - Detection -   best_eval_score = 90.0
2023-04-05 06:42:05,191 - Detection -   eval_score = 90.0
2023-04-05 06:42:05,191 - Detection -   train_loss = 0.11304547265172005
2023-04-05 06:42:05,191 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_0.5_1.0_bert_5/models
2023-04-05 06:42:05,731 - Detection - Pre-training finished...
2023-04-05 06:42:05,732 - Detection - Training Begin...
2023-04-05 06:42:17,781 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 06:42:17,781 - Detection -   best_eval_score = 0
2023-04-05 06:42:17,781 - Detection -   eval_score = 5.38
2023-04-05 06:42:17,781 - Detection -   train_loss = 7.267301985558043
2023-04-05 06:42:24,636 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 06:42:24,636 - Detection -   best_eval_score = 5.38
2023-04-05 06:42:24,636 - Detection -   eval_score = 65.11
2023-04-05 06:42:24,636 - Detection -   train_loss = 5.013018953039291
2023-04-05 06:42:31,509 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 06:42:31,509 - Detection -   best_eval_score = 65.11
2023-04-05 06:42:31,510 - Detection -   eval_score = 79.01
2023-04-05 06:42:31,510 - Detection -   train_loss = 2.576142529223828
2023-04-05 06:42:38,469 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 06:42:38,469 - Detection -   best_eval_score = 79.01
2023-04-05 06:42:38,469 - Detection -   eval_score = 79.92
2023-04-05 06:42:38,469 - Detection -   train_loss = 1.5158639740436635
2023-04-05 06:42:45,355 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 06:42:45,355 - Detection -   best_eval_score = 79.92
2023-04-05 06:42:45,355 - Detection -   eval_score = 79.92
2023-04-05 06:42:45,355 - Detection -   train_loss = 1.4711149575862479
2023-04-05 06:42:52,231 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 06:42:52,231 - Detection -   best_eval_score = 79.92
2023-04-05 06:42:52,231 - Detection -   eval_score = 79.98
2023-04-05 06:42:52,231 - Detection -   train_loss = 1.4754312621786239
2023-04-05 06:42:59,108 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 06:42:59,108 - Detection -   best_eval_score = 79.98
2023-04-05 06:42:59,108 - Detection -   eval_score = 79.96
2023-04-05 06:42:59,108 - Detection -   train_loss = 1.4912712954460305
2023-04-05 06:43:05,986 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 06:43:05,986 - Detection -   best_eval_score = 79.98
2023-04-05 06:43:05,987 - Detection -   eval_score = 80.03
2023-04-05 06:43:05,987 - Detection -   train_loss = 1.4899189903381023
2023-04-05 06:43:12,841 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 06:43:12,841 - Detection -   best_eval_score = 80.03
2023-04-05 06:43:12,841 - Detection -   eval_score = 80.09
2023-04-05 06:43:12,841 - Detection -   train_loss = 1.477791078547214
2023-04-05 06:43:19,716 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 06:43:19,716 - Detection -   best_eval_score = 80.09
2023-04-05 06:43:19,716 - Detection -   eval_score = 80.02
2023-04-05 06:43:19,716 - Detection -   train_loss = 1.4871244379814634
2023-04-05 06:43:26,577 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 06:43:26,577 - Detection -   best_eval_score = 80.09
2023-04-05 06:43:26,577 - Detection -   eval_score = 79.98
2023-04-05 06:43:26,577 - Detection -   train_loss = 1.4614447380634064
2023-04-05 06:43:33,430 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 06:43:33,430 - Detection -   best_eval_score = 80.09
2023-04-05 06:43:33,430 - Detection -   eval_score = 79.96
2023-04-05 06:43:33,430 - Detection -   train_loss = 1.4925485824016815
2023-04-05 06:43:40,281 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 06:43:40,281 - Detection -   best_eval_score = 80.09
2023-04-05 06:43:40,281 - Detection -   eval_score = 79.98
2023-04-05 06:43:40,281 - Detection -   train_loss = 1.47481529002494
2023-04-05 06:43:47,138 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 06:43:47,138 - Detection -   best_eval_score = 80.09
2023-04-05 06:43:47,138 - Detection -   eval_score = 79.97
2023-04-05 06:43:47,138 - Detection -   train_loss = 1.4668371778853395
2023-04-05 06:43:54,001 - Detection - ***** Epoch: 15: Eval results *****
2023-04-05 06:43:54,001 - Detection -   best_eval_score = 80.09
2023-04-05 06:43:54,001 - Detection -   eval_score = 79.86
2023-04-05 06:43:54,001 - Detection -   train_loss = 1.4756509293901159
2023-04-05 06:44:00,867 - Detection - ***** Epoch: 16: Eval results *****
2023-04-05 06:44:00,867 - Detection -   best_eval_score = 80.09
2023-04-05 06:44:00,867 - Detection -   eval_score = 79.98
2023-04-05 06:44:00,867 - Detection -   train_loss = 1.4799581385673362
2023-04-05 06:44:07,729 - Detection - ***** Epoch: 17: Eval results *****
2023-04-05 06:44:07,729 - Detection -   best_eval_score = 80.09
2023-04-05 06:44:07,729 - Detection -   eval_score = 80.04
2023-04-05 06:44:07,730 - Detection -   train_loss = 1.4812471460788807
2023-04-05 06:44:14,589 - Detection - ***** Epoch: 18: Eval results *****
2023-04-05 06:44:14,589 - Detection -   best_eval_score = 80.09
2023-04-05 06:44:14,589 - Detection -   eval_score = 80.01
2023-04-05 06:44:14,589 - Detection -   train_loss = 1.489488033538169
2023-04-05 06:44:21,433 - Detection - ***** Epoch: 19: Eval results *****
2023-04-05 06:44:21,433 - Detection -   best_eval_score = 80.09
2023-04-05 06:44:21,433 - Detection -   eval_score = 79.96
2023-04-05 06:44:21,433 - Detection -   train_loss = 1.4728207765741552
2023-04-05 06:44:21,434 - Detection - Training Finished...
2023-04-05 06:44:21,434 - Detection - Testing begin...
2023-04-05 06:44:26,804 - Detection - ***** Test: Confusion Matrix *****
2023-04-05 06:44:26,805 - Detection - [[ 222    0    0    0    4    1    0    0    0    0   73]
 [   0  239    0    0    0    0    0    0    0    0   61]
 [   0    0  245    0    0    1    0    0    0    1   53]
 [   0    0    0  260    0    2    0    0    0    0   38]
 [   0    1    1    0  229    1    0    0    3    0   65]
 [   1    1    2    1    0  227    0    0    0    0   68]
 [   0    0    0    0    0    0  244    0    0    1   55]
 [   1    0    0    0    0    0    0  255    0    0   44]
 [   0    0    0    0    0    0    0    0  277    0   23]
 [   0    0    0    0    1    1    0    0    0  220   78]
 [  11    4    1    2  112   44   37    2    6   17 2764]]
2023-04-05 06:44:26,805 - Detection - ***** Test results *****
2023-04-05 06:44:26,805 - Detection -   Acc = 86.37
2023-04-05 06:44:26,805 - Detection -   F1 = 85.551
2023-04-05 06:44:26,805 - Detection -   F1-known = 85.362
2023-04-05 06:44:26,805 - Detection -   F1-open = 87.4407
2023-04-05 06:44:26,805 - Detection - Testing finished...
2023-04-05 06:44:26,805 - Detection - Results saved in results/results_ADB.csv
2023-04-05 06:44:26,824 - Detection - Open Intent Detection Finished...
