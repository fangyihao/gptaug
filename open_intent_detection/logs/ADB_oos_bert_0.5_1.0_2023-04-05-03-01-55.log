2023-04-05 03:01:55,938 - Detection - Open Intent Detection Begin...
2023-04-05 03:01:55,938 - Detection - Parameters Initialization...
2023-04-05 03:01:55,939 - Detection - ============================== Params ==============================
2023-04-05 03:01:55,939 - Detection - type:	open_intent_detection
2023-04-05 03:01:55,939 - Detection - logger_name:	Detection
2023-04-05 03:01:55,939 - Detection - log_dir:	logs
2023-04-05 03:01:55,939 - Detection - dataset:	oos
2023-04-05 03:01:55,939 - Detection - known_cls_ratio:	0.5
2023-04-05 03:01:55,939 - Detection - labeled_ratio:	1.0
2023-04-05 03:01:55,939 - Detection - method:	ADB
2023-04-05 03:01:55,939 - Detection - train:	True
2023-04-05 03:01:55,939 - Detection - pretrain:	True
2023-04-05 03:01:55,939 - Detection - save_model:	True
2023-04-05 03:01:55,939 - Detection - backbone:	bert
2023-04-05 03:01:55,939 - Detection - config_file_name:	ADB
2023-04-05 03:01:55,939 - Detection - seed:	7
2023-04-05 03:01:55,939 - Detection - gpu_id:	0
2023-04-05 03:01:55,939 - Detection - pipe_results_path:	pipe_results
2023-04-05 03:01:55,939 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-05 03:01:55,939 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-05 03:01:55,939 - Detection - model_dir:	models
2023-04-05 03:01:55,939 - Detection - load_pretrained_method:	None
2023-04-05 03:01:55,939 - Detection - result_dir:	results
2023-04-05 03:01:55,939 - Detection - results_file_name:	results_ADB.csv
2023-04-05 03:01:55,939 - Detection - save_results:	True
2023-04-05 03:01:55,939 - Detection - loss_fct:	CrossEntropyLoss
2023-04-05 03:01:55,939 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_0.5_1.0_bert_7
2023-04-05 03:01:55,939 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_0.5_1.0_bert_7/models
2023-04-05 03:01:55,939 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-05 03:01:55,939 - Detection - num_train_epochs:	100
2023-04-05 03:01:55,939 - Detection - num_labels:	None
2023-04-05 03:01:55,939 - Detection - max_seq_length:	None
2023-04-05 03:01:55,939 - Detection - freeze_backbone_parameters:	True
2023-04-05 03:01:55,939 - Detection - feat_dim:	768
2023-04-05 03:01:55,939 - Detection - warmup_proportion:	0.1
2023-04-05 03:01:55,939 - Detection - lr_boundary:	0.05
2023-04-05 03:01:55,939 - Detection - lr:	2e-05
2023-04-05 03:01:55,939 - Detection - activation:	relu
2023-04-05 03:01:55,939 - Detection - train_batch_size:	128
2023-04-05 03:01:55,939 - Detection - eval_batch_size:	64
2023-04-05 03:01:55,939 - Detection - test_batch_size:	64
2023-04-05 03:01:55,939 - Detection - wait_patient:	10
2023-04-05 03:01:55,939 - Detection - ============================== End Params ==============================
2023-04-05 03:01:55,939 - Detection - Data and Model Preparation...
2023-04-05 03:01:55,940 - Detection - The number of known intents is 75
2023-04-05 03:01:55,940 - Detection - Lists of known labels are: ['yes', 'payday', 'expiration_date', 'maybe', 'rollover_401k', 'find_phone', 'how_old_are_you', 'reminder', 'calculator', 'how_busy', 'nutrition_info', 'pin_change', 'damaged_card', 'schedule_meeting', 'credit_limit', 'meeting_schedule', 'schedule_maintenance', 'user_name', 'fun_fact', 'distance', 'order_status', 'thank_you', 'last_maintenance', 'text', 'transactions', 'vaccines', 'replacement_card_duration', 'order', 'restaurant_reservation', 'weather', 'todo_list', 'oil_change_when', 'change_language', 'w2', 'next_holiday', 'freeze_account', 'directions', 'are_you_a_bot', 'car_rental', 'restaurant_reviews', 'tire_change', 'no', 'travel_alert', 'sync_device', 'reminder_update', 'goodbye', 'make_call', 'jump_start', 'shopping_list', 'credit_limit_change', 'application_status', 'exchange_rate', 'taxes', 'calendar_update', 'reset_settings', 'order_checks', 'international_fees', 'income', 'confirm_reservation', 'bill_due', 'flip_coin', 'play_music', 'routing', 'pto_request_status', 'interest_rate', 'cancel', 'tire_pressure', 'change_accent', 'calories', 'travel_suggestion', 'smart_home', 'calendar', 'rewards_balance', 'gas', 'insurance_change']
2023-04-05 03:01:55,987 - Detection - Number of labeled training samples = 7500
2023-04-05 03:01:55,988 - Detection - Number of unlabeled training samples = 7500
2023-04-05 03:01:55,994 - Detection - Number of evaluation samples = 1500
2023-04-05 03:01:56,007 - Detection - Number of testing samples = 5700
2023-04-05 03:02:03,404 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-05 03:02:05,068 - Detection - Pre-training Begin...
2023-04-05 03:02:11,392 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 03:02:11,392 - Detection -   best_eval_score = 0
2023-04-05 03:02:11,392 - Detection -   eval_score = 3.53
2023-04-05 03:02:11,392 - Detection -   train_loss = 4.313440363285905
2023-04-05 03:02:17,237 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 03:02:17,237 - Detection -   best_eval_score = 3.53
2023-04-05 03:02:17,237 - Detection -   eval_score = 15.47
2023-04-05 03:02:17,237 - Detection -   train_loss = 4.280549130197299
2023-04-05 03:02:23,172 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 03:02:23,172 - Detection -   best_eval_score = 15.47
2023-04-05 03:02:23,172 - Detection -   eval_score = 35.67
2023-04-05 03:02:23,172 - Detection -   train_loss = 4.189467648328361
2023-04-05 03:02:29,315 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 03:02:29,315 - Detection -   best_eval_score = 35.67
2023-04-05 03:02:29,315 - Detection -   eval_score = 54.93
2023-04-05 03:02:29,315 - Detection -   train_loss = 3.880455792960474
2023-04-05 03:02:35,566 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 03:02:35,567 - Detection -   best_eval_score = 54.93
2023-04-05 03:02:35,567 - Detection -   eval_score = 74.4
2023-04-05 03:02:35,567 - Detection -   train_loss = 3.203622486631749
2023-04-05 03:02:41,915 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 03:02:41,915 - Detection -   best_eval_score = 74.4
2023-04-05 03:02:41,915 - Detection -   eval_score = 82.27
2023-04-05 03:02:41,915 - Detection -   train_loss = 2.406251972004519
2023-04-05 03:02:48,162 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 03:02:48,162 - Detection -   best_eval_score = 82.27
2023-04-05 03:02:48,162 - Detection -   eval_score = 87.67
2023-04-05 03:02:48,162 - Detection -   train_loss = 1.6889500133061812
2023-04-05 03:02:54,410 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 03:02:54,410 - Detection -   best_eval_score = 87.67
2023-04-05 03:02:54,410 - Detection -   eval_score = 90.8
2023-04-05 03:02:54,410 - Detection -   train_loss = 1.1514341790797347
2023-04-05 03:03:00,643 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 03:03:00,643 - Detection -   best_eval_score = 90.8
2023-04-05 03:03:00,643 - Detection -   eval_score = 92.4
2023-04-05 03:03:00,643 - Detection -   train_loss = 0.7999795321690835
2023-04-05 03:03:06,886 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 03:03:06,886 - Detection -   best_eval_score = 92.4
2023-04-05 03:03:06,886 - Detection -   eval_score = 93.47
2023-04-05 03:03:06,886 - Detection -   train_loss = 0.5745798657506199
2023-04-05 03:03:13,137 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 03:03:13,138 - Detection -   best_eval_score = 93.47
2023-04-05 03:03:13,138 - Detection -   eval_score = 93.73
2023-04-05 03:03:13,138 - Detection -   train_loss = 0.4337084061008389
2023-04-05 03:03:19,372 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 03:03:19,372 - Detection -   best_eval_score = 93.73
2023-04-05 03:03:19,372 - Detection -   eval_score = 94.0
2023-04-05 03:03:19,372 - Detection -   train_loss = 0.3436423403731847
2023-04-05 03:03:25,619 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 03:03:25,619 - Detection -   best_eval_score = 94.0
2023-04-05 03:03:25,619 - Detection -   eval_score = 94.47
2023-04-05 03:03:25,619 - Detection -   train_loss = 0.28459475530406175
2023-04-05 03:03:31,855 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 03:03:31,855 - Detection -   best_eval_score = 94.47
2023-04-05 03:03:31,855 - Detection -   eval_score = 94.6
2023-04-05 03:03:31,855 - Detection -   train_loss = 0.24192853549779472
2023-04-05 03:03:38,111 - Detection - ***** Epoch: 15: Eval results *****
2023-04-05 03:03:38,112 - Detection -   best_eval_score = 94.6
2023-04-05 03:03:38,112 - Detection -   eval_score = 94.93
2023-04-05 03:03:38,112 - Detection -   train_loss = 0.20862679057202096
2023-04-05 03:03:44,358 - Detection - ***** Epoch: 16: Eval results *****
2023-04-05 03:03:44,358 - Detection -   best_eval_score = 94.93
2023-04-05 03:03:44,358 - Detection -   eval_score = 94.93
2023-04-05 03:03:44,358 - Detection -   train_loss = 0.18327066832679814
2023-04-05 03:03:50,569 - Detection - ***** Epoch: 17: Eval results *****
2023-04-05 03:03:50,569 - Detection -   best_eval_score = 94.93
2023-04-05 03:03:50,569 - Detection -   eval_score = 95.0
2023-04-05 03:03:50,569 - Detection -   train_loss = 0.1633059215747704
2023-04-05 03:03:56,796 - Detection - ***** Epoch: 18: Eval results *****
2023-04-05 03:03:56,796 - Detection -   best_eval_score = 95.0
2023-04-05 03:03:56,796 - Detection -   eval_score = 95.33
2023-04-05 03:03:56,796 - Detection -   train_loss = 0.14421029995053503
2023-04-05 03:04:03,010 - Detection - ***** Epoch: 19: Eval results *****
2023-04-05 03:04:03,010 - Detection -   best_eval_score = 95.33
2023-04-05 03:04:03,010 - Detection -   eval_score = 95.2
2023-04-05 03:04:03,010 - Detection -   train_loss = 0.13614240642321312
2023-04-05 03:04:09,219 - Detection - ***** Epoch: 20: Eval results *****
2023-04-05 03:04:09,219 - Detection -   best_eval_score = 95.33
2023-04-05 03:04:09,219 - Detection -   eval_score = 95.33
2023-04-05 03:04:09,219 - Detection -   train_loss = 0.11953355441406621
2023-04-05 03:04:15,511 - Detection - ***** Epoch: 21: Eval results *****
2023-04-05 03:04:15,511 - Detection -   best_eval_score = 95.33
2023-04-05 03:04:15,511 - Detection -   eval_score = 95.33
2023-04-05 03:04:15,511 - Detection -   train_loss = 0.1113807191535578
2023-04-05 03:04:21,700 - Detection - ***** Epoch: 22: Eval results *****
2023-04-05 03:04:21,700 - Detection -   best_eval_score = 95.33
2023-04-05 03:04:21,700 - Detection -   eval_score = 95.33
2023-04-05 03:04:21,700 - Detection -   train_loss = 0.10310278012085769
2023-04-05 03:04:27,884 - Detection - ***** Epoch: 23: Eval results *****
2023-04-05 03:04:27,884 - Detection -   best_eval_score = 95.33
2023-04-05 03:04:27,884 - Detection -   eval_score = 95.6
2023-04-05 03:04:27,884 - Detection -   train_loss = 0.09444734264733427
2023-04-05 03:04:34,086 - Detection - ***** Epoch: 24: Eval results *****
2023-04-05 03:04:34,086 - Detection -   best_eval_score = 95.6
2023-04-05 03:04:34,086 - Detection -   eval_score = 95.73
2023-04-05 03:04:34,086 - Detection -   train_loss = 0.08859065010891122
2023-04-05 03:04:40,295 - Detection - ***** Epoch: 25: Eval results *****
2023-04-05 03:04:40,295 - Detection -   best_eval_score = 95.73
2023-04-05 03:04:40,295 - Detection -   eval_score = 95.53
2023-04-05 03:04:40,295 - Detection -   train_loss = 0.08636489706271785
2023-04-05 03:04:46,498 - Detection - ***** Epoch: 26: Eval results *****
2023-04-05 03:04:46,498 - Detection -   best_eval_score = 95.73
2023-04-05 03:04:46,499 - Detection -   eval_score = 95.73
2023-04-05 03:04:46,499 - Detection -   train_loss = 0.07778786015460047
2023-04-05 03:04:52,693 - Detection - ***** Epoch: 27: Eval results *****
2023-04-05 03:04:52,693 - Detection -   best_eval_score = 95.73
2023-04-05 03:04:52,693 - Detection -   eval_score = 95.8
2023-04-05 03:04:52,693 - Detection -   train_loss = 0.07289972326765626
2023-04-05 03:04:58,904 - Detection - ***** Epoch: 28: Eval results *****
2023-04-05 03:04:58,905 - Detection -   best_eval_score = 95.8
2023-04-05 03:04:58,905 - Detection -   eval_score = 95.87
2023-04-05 03:04:58,905 - Detection -   train_loss = 0.06754896663508173
2023-04-05 03:05:05,112 - Detection - ***** Epoch: 29: Eval results *****
2023-04-05 03:05:05,112 - Detection -   best_eval_score = 95.87
2023-04-05 03:05:05,112 - Detection -   eval_score = 95.8
2023-04-05 03:05:05,112 - Detection -   train_loss = 0.06489268731389006
2023-04-05 03:05:11,303 - Detection - ***** Epoch: 30: Eval results *****
2023-04-05 03:05:11,303 - Detection -   best_eval_score = 95.87
2023-04-05 03:05:11,303 - Detection -   eval_score = 96.0
2023-04-05 03:05:11,303 - Detection -   train_loss = 0.06454057353785482
2023-04-05 03:05:17,493 - Detection - ***** Epoch: 31: Eval results *****
2023-04-05 03:05:17,493 - Detection -   best_eval_score = 96.0
2023-04-05 03:05:17,493 - Detection -   eval_score = 96.07
2023-04-05 03:05:17,493 - Detection -   train_loss = 0.05852604531130548
2023-04-05 03:05:23,691 - Detection - ***** Epoch: 32: Eval results *****
2023-04-05 03:05:23,691 - Detection -   best_eval_score = 96.07
2023-04-05 03:05:23,691 - Detection -   eval_score = 96.0
2023-04-05 03:05:23,691 - Detection -   train_loss = 0.053796620218683096
2023-04-05 03:05:29,915 - Detection - ***** Epoch: 33: Eval results *****
2023-04-05 03:05:29,915 - Detection -   best_eval_score = 96.07
2023-04-05 03:05:29,915 - Detection -   eval_score = 96.07
2023-04-05 03:05:29,915 - Detection -   train_loss = 0.05224561495548588
2023-04-05 03:05:36,117 - Detection - ***** Epoch: 34: Eval results *****
2023-04-05 03:05:36,117 - Detection -   best_eval_score = 96.07
2023-04-05 03:05:36,117 - Detection -   eval_score = 95.87
2023-04-05 03:05:36,117 - Detection -   train_loss = 0.05050686510058783
2023-04-05 03:05:42,318 - Detection - ***** Epoch: 35: Eval results *****
2023-04-05 03:05:42,318 - Detection -   best_eval_score = 96.07
2023-04-05 03:05:42,318 - Detection -   eval_score = 96.0
2023-04-05 03:05:42,318 - Detection -   train_loss = 0.04726528632059946
2023-04-05 03:05:48,523 - Detection - ***** Epoch: 36: Eval results *****
2023-04-05 03:05:48,523 - Detection -   best_eval_score = 96.07
2023-04-05 03:05:48,523 - Detection -   eval_score = 96.13
2023-04-05 03:05:48,523 - Detection -   train_loss = 0.04626672487642806
2023-04-05 03:05:54,726 - Detection - ***** Epoch: 37: Eval results *****
2023-04-05 03:05:54,726 - Detection -   best_eval_score = 96.13
2023-04-05 03:05:54,726 - Detection -   eval_score = 96.0
2023-04-05 03:05:54,726 - Detection -   train_loss = 0.041096459600632476
2023-04-05 03:06:00,929 - Detection - ***** Epoch: 38: Eval results *****
2023-04-05 03:06:00,929 - Detection -   best_eval_score = 96.13
2023-04-05 03:06:00,929 - Detection -   eval_score = 95.93
2023-04-05 03:06:00,929 - Detection -   train_loss = 0.0415612098650407
2023-04-05 03:06:07,127 - Detection - ***** Epoch: 39: Eval results *****
2023-04-05 03:06:07,127 - Detection -   best_eval_score = 96.13
2023-04-05 03:06:07,127 - Detection -   eval_score = 95.93
2023-04-05 03:06:07,127 - Detection -   train_loss = 0.03860647019819688
2023-04-05 03:06:13,313 - Detection - ***** Epoch: 40: Eval results *****
2023-04-05 03:06:13,313 - Detection -   best_eval_score = 96.13
2023-04-05 03:06:13,313 - Detection -   eval_score = 95.93
2023-04-05 03:06:13,313 - Detection -   train_loss = 0.039311685962444644
2023-04-05 03:06:19,582 - Detection - ***** Epoch: 41: Eval results *****
2023-04-05 03:06:19,582 - Detection -   best_eval_score = 96.13
2023-04-05 03:06:19,582 - Detection -   eval_score = 96.13
2023-04-05 03:06:19,582 - Detection -   train_loss = 0.037012380784598446
2023-04-05 03:06:25,751 - Detection - ***** Epoch: 42: Eval results *****
2023-04-05 03:06:25,751 - Detection -   best_eval_score = 96.13
2023-04-05 03:06:25,751 - Detection -   eval_score = 96.13
2023-04-05 03:06:25,751 - Detection -   train_loss = 0.034077672919226906
2023-04-05 03:06:31,920 - Detection - ***** Epoch: 43: Eval results *****
2023-04-05 03:06:31,920 - Detection -   best_eval_score = 96.13
2023-04-05 03:06:31,920 - Detection -   eval_score = 96.2
2023-04-05 03:06:31,920 - Detection -   train_loss = 0.03399577799995067
2023-04-05 03:06:38,110 - Detection - ***** Epoch: 44: Eval results *****
2023-04-05 03:06:38,110 - Detection -   best_eval_score = 96.2
2023-04-05 03:06:38,110 - Detection -   eval_score = 96.27
2023-04-05 03:06:38,110 - Detection -   train_loss = 0.032214459505374146
2023-04-05 03:06:44,292 - Detection - ***** Epoch: 45: Eval results *****
2023-04-05 03:06:44,292 - Detection -   best_eval_score = 96.27
2023-04-05 03:06:44,292 - Detection -   eval_score = 96.27
2023-04-05 03:06:44,292 - Detection -   train_loss = 0.03030387255347381
2023-04-05 03:06:50,457 - Detection - ***** Epoch: 46: Eval results *****
2023-04-05 03:06:50,458 - Detection -   best_eval_score = 96.27
2023-04-05 03:06:50,458 - Detection -   eval_score = 96.07
2023-04-05 03:06:50,458 - Detection -   train_loss = 0.02985503492971598
2023-04-05 03:06:56,627 - Detection - ***** Epoch: 47: Eval results *****
2023-04-05 03:06:56,627 - Detection -   best_eval_score = 96.27
2023-04-05 03:06:56,627 - Detection -   eval_score = 96.2
2023-04-05 03:06:56,628 - Detection -   train_loss = 0.028342763988017026
2023-04-05 03:07:02,790 - Detection - ***** Epoch: 48: Eval results *****
2023-04-05 03:07:02,790 - Detection -   best_eval_score = 96.27
2023-04-05 03:07:02,790 - Detection -   eval_score = 96.27
2023-04-05 03:07:02,790 - Detection -   train_loss = 0.02953662873261561
2023-04-05 03:07:08,957 - Detection - ***** Epoch: 49: Eval results *****
2023-04-05 03:07:08,957 - Detection -   best_eval_score = 96.27
2023-04-05 03:07:08,957 - Detection -   eval_score = 96.13
2023-04-05 03:07:08,957 - Detection -   train_loss = 0.026700324157915883
2023-04-05 03:07:15,118 - Detection - ***** Epoch: 50: Eval results *****
2023-04-05 03:07:15,118 - Detection -   best_eval_score = 96.27
2023-04-05 03:07:15,118 - Detection -   eval_score = 96.13
2023-04-05 03:07:15,118 - Detection -   train_loss = 0.0262281056651372
2023-04-05 03:07:21,288 - Detection - ***** Epoch: 51: Eval results *****
2023-04-05 03:07:21,288 - Detection -   best_eval_score = 96.27
2023-04-05 03:07:21,288 - Detection -   eval_score = 96.4
2023-04-05 03:07:21,288 - Detection -   train_loss = 0.02702129389143596
2023-04-05 03:07:27,457 - Detection - ***** Epoch: 52: Eval results *****
2023-04-05 03:07:27,457 - Detection -   best_eval_score = 96.4
2023-04-05 03:07:27,457 - Detection -   eval_score = 96.27
2023-04-05 03:07:27,457 - Detection -   train_loss = 0.024755202770485717
2023-04-05 03:07:33,621 - Detection - ***** Epoch: 53: Eval results *****
2023-04-05 03:07:33,621 - Detection -   best_eval_score = 96.4
2023-04-05 03:07:33,621 - Detection -   eval_score = 96.27
2023-04-05 03:07:33,621 - Detection -   train_loss = 0.0254341417102743
2023-04-05 03:07:39,773 - Detection - ***** Epoch: 54: Eval results *****
2023-04-05 03:07:39,773 - Detection -   best_eval_score = 96.4
2023-04-05 03:07:39,773 - Detection -   eval_score = 96.47
2023-04-05 03:07:39,773 - Detection -   train_loss = 0.023268289658856595
2023-04-05 03:07:45,943 - Detection - ***** Epoch: 55: Eval results *****
2023-04-05 03:07:45,943 - Detection -   best_eval_score = 96.47
2023-04-05 03:07:45,943 - Detection -   eval_score = 96.27
2023-04-05 03:07:45,943 - Detection -   train_loss = 0.022804465965699343
2023-04-05 03:07:52,094 - Detection - ***** Epoch: 56: Eval results *****
2023-04-05 03:07:52,094 - Detection -   best_eval_score = 96.47
2023-04-05 03:07:52,094 - Detection -   eval_score = 96.2
2023-04-05 03:07:52,094 - Detection -   train_loss = 0.02236062861284462
2023-04-05 03:07:58,248 - Detection - ***** Epoch: 57: Eval results *****
2023-04-05 03:07:58,248 - Detection -   best_eval_score = 96.47
2023-04-05 03:07:58,248 - Detection -   eval_score = 96.2
2023-04-05 03:07:58,248 - Detection -   train_loss = 0.02158922612098819
2023-04-05 03:08:04,405 - Detection - ***** Epoch: 58: Eval results *****
2023-04-05 03:08:04,405 - Detection -   best_eval_score = 96.47
2023-04-05 03:08:04,405 - Detection -   eval_score = 96.4
2023-04-05 03:08:04,405 - Detection -   train_loss = 0.020793668610059608
2023-04-05 03:08:10,557 - Detection - ***** Epoch: 59: Eval results *****
2023-04-05 03:08:10,557 - Detection -   best_eval_score = 96.47
2023-04-05 03:08:10,557 - Detection -   eval_score = 96.33
2023-04-05 03:08:10,557 - Detection -   train_loss = 0.02126946312896276
2023-04-05 03:08:16,709 - Detection - ***** Epoch: 60: Eval results *****
2023-04-05 03:08:16,709 - Detection -   best_eval_score = 96.47
2023-04-05 03:08:16,709 - Detection -   eval_score = 96.2
2023-04-05 03:08:16,709 - Detection -   train_loss = 0.019687689083107446
2023-04-05 03:08:22,864 - Detection - ***** Epoch: 61: Eval results *****
2023-04-05 03:08:22,864 - Detection -   best_eval_score = 96.47
2023-04-05 03:08:22,864 - Detection -   eval_score = 96.27
2023-04-05 03:08:22,864 - Detection -   train_loss = 0.02011556121504913
2023-04-05 03:08:29,023 - Detection - ***** Epoch: 62: Eval results *****
2023-04-05 03:08:29,023 - Detection -   best_eval_score = 96.47
2023-04-05 03:08:29,023 - Detection -   eval_score = 96.27
2023-04-05 03:08:29,023 - Detection -   train_loss = 0.019565510721403664
2023-04-05 03:08:35,174 - Detection - ***** Epoch: 63: Eval results *****
2023-04-05 03:08:35,174 - Detection -   best_eval_score = 96.47
2023-04-05 03:08:35,174 - Detection -   eval_score = 96.27
2023-04-05 03:08:35,174 - Detection -   train_loss = 0.02064885681305649
2023-04-05 03:08:41,427 - Detection - ***** Epoch: 64: Eval results *****
2023-04-05 03:08:41,427 - Detection -   best_eval_score = 96.47
2023-04-05 03:08:41,427 - Detection -   eval_score = 96.2
2023-04-05 03:08:41,427 - Detection -   train_loss = 0.01935755905016499
2023-04-05 03:08:41,427 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_0.5_1.0_bert_7/models
2023-04-05 03:08:41,984 - Detection - Pre-training finished...
2023-04-05 03:08:41,984 - Detection - Training Begin...
2023-04-05 03:08:52,623 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 03:08:52,623 - Detection -   best_eval_score = 0
2023-04-05 03:08:52,623 - Detection -   eval_score = 0.75
2023-04-05 03:08:52,623 - Detection -   train_loss = 13.453929141416388
2023-04-05 03:08:58,697 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 03:08:58,697 - Detection -   best_eval_score = 0.75
2023-04-05 03:08:58,697 - Detection -   eval_score = 10.26
2023-04-05 03:08:58,697 - Detection -   train_loss = 11.099316063573806
2023-04-05 03:09:04,793 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 03:09:04,793 - Detection -   best_eval_score = 10.26
2023-04-05 03:09:04,793 - Detection -   eval_score = 49.6
2023-04-05 03:09:04,793 - Detection -   train_loss = 8.450726218142751
2023-04-05 03:09:10,879 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 03:09:10,879 - Detection -   best_eval_score = 49.6
2023-04-05 03:09:10,879 - Detection -   eval_score = 76.02
2023-04-05 03:09:10,879 - Detection -   train_loss = 5.894995180226989
2023-04-05 03:09:16,973 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 03:09:16,973 - Detection -   best_eval_score = 76.02
2023-04-05 03:09:16,973 - Detection -   eval_score = 88.15
2023-04-05 03:09:16,973 - Detection -   train_loss = 3.4737804016824496
2023-04-05 03:09:23,071 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 03:09:23,071 - Detection -   best_eval_score = 88.15
2023-04-05 03:09:23,071 - Detection -   eval_score = 91.53
2023-04-05 03:09:23,071 - Detection -   train_loss = 1.8459615848832212
2023-04-05 03:09:29,166 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 03:09:29,166 - Detection -   best_eval_score = 91.53
2023-04-05 03:09:29,166 - Detection -   eval_score = 91.92
2023-04-05 03:09:29,166 - Detection -   train_loss = 1.487600960973966
2023-04-05 03:09:35,271 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 03:09:35,271 - Detection -   best_eval_score = 91.92
2023-04-05 03:09:35,272 - Detection -   eval_score = 92.13
2023-04-05 03:09:35,272 - Detection -   train_loss = 1.4433356099209542
2023-04-05 03:09:41,357 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 03:09:41,357 - Detection -   best_eval_score = 92.13
2023-04-05 03:09:41,357 - Detection -   eval_score = 92.13
2023-04-05 03:09:41,357 - Detection -   train_loss = 1.445549847715992
2023-04-05 03:09:47,433 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 03:09:47,434 - Detection -   best_eval_score = 92.13
2023-04-05 03:09:47,434 - Detection -   eval_score = 92.26
2023-04-05 03:09:47,434 - Detection -   train_loss = 1.435628228268381
2023-04-05 03:09:53,532 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 03:09:53,532 - Detection -   best_eval_score = 92.26
2023-04-05 03:09:53,532 - Detection -   eval_score = 92.27
2023-04-05 03:09:53,533 - Detection -   train_loss = 1.475675801099357
2023-04-05 03:09:59,622 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 03:09:59,622 - Detection -   best_eval_score = 92.27
2023-04-05 03:09:59,622 - Detection -   eval_score = 92.31
2023-04-05 03:09:59,622 - Detection -   train_loss = 1.4463191779993347
2023-04-05 03:10:05,716 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 03:10:05,716 - Detection -   best_eval_score = 92.31
2023-04-05 03:10:05,716 - Detection -   eval_score = 92.2
2023-04-05 03:10:05,716 - Detection -   train_loss = 1.4348065186355075
2023-04-05 03:10:11,799 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 03:10:11,799 - Detection -   best_eval_score = 92.31
2023-04-05 03:10:11,799 - Detection -   eval_score = 92.3
2023-04-05 03:10:11,799 - Detection -   train_loss = 1.4611993058253143
2023-04-05 03:10:17,897 - Detection - ***** Epoch: 15: Eval results *****
2023-04-05 03:10:17,897 - Detection -   best_eval_score = 92.31
2023-04-05 03:10:17,897 - Detection -   eval_score = 92.42
2023-04-05 03:10:17,897 - Detection -   train_loss = 1.4530684745917886
2023-04-05 03:10:23,985 - Detection - ***** Epoch: 16: Eval results *****
2023-04-05 03:10:23,986 - Detection -   best_eval_score = 92.42
2023-04-05 03:10:23,986 - Detection -   eval_score = 92.29
2023-04-05 03:10:23,986 - Detection -   train_loss = 1.463585027193619
2023-04-05 03:10:30,085 - Detection - ***** Epoch: 17: Eval results *****
2023-04-05 03:10:30,086 - Detection -   best_eval_score = 92.42
2023-04-05 03:10:30,086 - Detection -   eval_score = 92.43
2023-04-05 03:10:30,086 - Detection -   train_loss = 1.4540190494666665
2023-04-05 03:10:36,180 - Detection - ***** Epoch: 18: Eval results *****
2023-04-05 03:10:36,180 - Detection -   best_eval_score = 92.43
2023-04-05 03:10:36,181 - Detection -   eval_score = 92.27
2023-04-05 03:10:36,181 - Detection -   train_loss = 1.4463696863691686
2023-04-05 03:10:42,272 - Detection - ***** Epoch: 19: Eval results *****
2023-04-05 03:10:42,272 - Detection -   best_eval_score = 92.43
2023-04-05 03:10:42,272 - Detection -   eval_score = 92.34
2023-04-05 03:10:42,272 - Detection -   train_loss = 1.4462496749425338
2023-04-05 03:10:48,376 - Detection - ***** Epoch: 20: Eval results *****
2023-04-05 03:10:48,376 - Detection -   best_eval_score = 92.43
2023-04-05 03:10:48,376 - Detection -   eval_score = 92.28
2023-04-05 03:10:48,377 - Detection -   train_loss = 1.4523003848932556
2023-04-05 03:10:54,472 - Detection - ***** Epoch: 21: Eval results *****
2023-04-05 03:10:54,472 - Detection -   best_eval_score = 92.43
2023-04-05 03:10:54,472 - Detection -   eval_score = 92.31
2023-04-05 03:10:54,472 - Detection -   train_loss = 1.4475064398878712
2023-04-05 03:11:00,565 - Detection - ***** Epoch: 22: Eval results *****
2023-04-05 03:11:00,566 - Detection -   best_eval_score = 92.43
2023-04-05 03:11:00,566 - Detection -   eval_score = 92.17
2023-04-05 03:11:00,566 - Detection -   train_loss = 1.4376613709886195
2023-04-05 03:11:06,655 - Detection - ***** Epoch: 23: Eval results *****
2023-04-05 03:11:06,655 - Detection -   best_eval_score = 92.43
2023-04-05 03:11:06,655 - Detection -   eval_score = 92.26
2023-04-05 03:11:06,655 - Detection -   train_loss = 1.4468156422598888
2023-04-05 03:11:12,747 - Detection - ***** Epoch: 24: Eval results *****
2023-04-05 03:11:12,747 - Detection -   best_eval_score = 92.43
2023-04-05 03:11:12,747 - Detection -   eval_score = 92.33
2023-04-05 03:11:12,747 - Detection -   train_loss = 1.4604914552074368
2023-04-05 03:11:18,928 - Detection - ***** Epoch: 25: Eval results *****
2023-04-05 03:11:18,928 - Detection -   best_eval_score = 92.43
2023-04-05 03:11:18,928 - Detection -   eval_score = 92.3
2023-04-05 03:11:18,928 - Detection -   train_loss = 1.4529153270236517
2023-04-05 03:11:25,027 - Detection - ***** Epoch: 26: Eval results *****
2023-04-05 03:11:25,027 - Detection -   best_eval_score = 92.43
2023-04-05 03:11:25,027 - Detection -   eval_score = 92.18
2023-04-05 03:11:25,027 - Detection -   train_loss = 1.4723203485294925
2023-04-05 03:11:31,112 - Detection - ***** Epoch: 27: Eval results *****
2023-04-05 03:11:31,112 - Detection -   best_eval_score = 92.43
2023-04-05 03:11:31,112 - Detection -   eval_score = 92.27
2023-04-05 03:11:31,112 - Detection -   train_loss = 1.47048695006613
2023-04-05 03:11:31,113 - Detection - Training Finished...
2023-04-05 03:11:31,113 - Detection - Testing begin...
2023-04-05 03:11:34,608 - Detection - ***** Test: Confusion Matrix *****
2023-04-05 03:11:34,608 - Detection - [[  21    0    0 ...    0    0    9]
 [   0   25    0 ...    0    0    4]
 [   0    0   25 ...    0    0    4]
 ...
 [   0    0    0 ...   26    0    4]
 [   0    0    0 ...    0   25    5]
 [   0    0    1 ...   36    5 2836]]
2023-04-05 03:11:34,608 - Detection - ***** Test results *****
2023-04-05 03:11:34,608 - Detection -   Acc = 85.37
2023-04-05 03:11:34,608 - Detection -   F1 = 84.636
2023-04-05 03:11:34,608 - Detection -   F1-known = 84.599
2023-04-05 03:11:34,608 - Detection -   F1-open = 87.4095
2023-04-05 03:11:34,608 - Detection - Testing finished...
2023-04-05 03:11:34,608 - Detection - Results saved in results/results_ADB.csv
2023-04-05 03:11:34,631 - Detection - Open Intent Detection Finished...
