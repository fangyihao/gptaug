2023-04-05 04:58:30,013 - Detection - Open Intent Detection Begin...
2023-04-05 04:58:30,014 - Detection - Parameters Initialization...
2023-04-05 04:58:30,014 - Detection - ============================== Params ==============================
2023-04-05 04:58:30,014 - Detection - type:	open_intent_detection
2023-04-05 04:58:30,014 - Detection - logger_name:	Detection
2023-04-05 04:58:30,014 - Detection - log_dir:	logs
2023-04-05 04:58:30,014 - Detection - dataset:	oos
2023-04-05 04:58:30,014 - Detection - known_cls_ratio:	0.25
2023-04-05 04:58:30,014 - Detection - labeled_ratio:	1.0
2023-04-05 04:58:30,014 - Detection - method:	DA-ADB
2023-04-05 04:58:30,014 - Detection - train:	True
2023-04-05 04:58:30,014 - Detection - pretrain:	True
2023-04-05 04:58:30,014 - Detection - save_model:	True
2023-04-05 04:58:30,014 - Detection - backbone:	bert_disaware
2023-04-05 04:58:30,014 - Detection - config_file_name:	DA-ADB
2023-04-05 04:58:30,014 - Detection - seed:	8
2023-04-05 04:58:30,014 - Detection - gpu_id:	0
2023-04-05 04:58:30,014 - Detection - pipe_results_path:	pipe_results
2023-04-05 04:58:30,014 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-05 04:58:30,014 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-05 04:58:30,014 - Detection - model_dir:	models
2023-04-05 04:58:30,014 - Detection - load_pretrained_method:	None
2023-04-05 04:58:30,014 - Detection - result_dir:	results
2023-04-05 04:58:30,014 - Detection - results_file_name:	results_DA-ADB.csv
2023-04-05 04:58:30,014 - Detection - save_results:	True
2023-04-05 04:58:30,014 - Detection - loss_fct:	CrossEntropyLoss
2023-04-05 04:58:30,014 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_oos_0.25_1.0_bert_disaware_8
2023-04-05 04:58:30,014 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_oos_0.25_1.0_bert_disaware_8/models
2023-04-05 04:58:30,014 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-05 04:58:30,014 - Detection - num_train_epochs:	100
2023-04-05 04:58:30,014 - Detection - num_labels:	None
2023-04-05 04:58:30,015 - Detection - max_seq_length:	None
2023-04-05 04:58:30,015 - Detection - freeze_backbone_parameters:	True
2023-04-05 04:58:30,015 - Detection - feat_dim:	768
2023-04-05 04:58:30,015 - Detection - warmup_proportion:	0.1
2023-04-05 04:58:30,015 - Detection - scale:	4
2023-04-05 04:58:30,015 - Detection - lr_boundary:	0.05
2023-04-05 04:58:30,015 - Detection - lr:	2e-05
2023-04-05 04:58:30,015 - Detection - activation:	relu
2023-04-05 04:58:30,015 - Detection - train_batch_size:	128
2023-04-05 04:58:30,015 - Detection - eval_batch_size:	64
2023-04-05 04:58:30,015 - Detection - test_batch_size:	64
2023-04-05 04:58:30,015 - Detection - wait_patient:	10
2023-04-05 04:58:30,015 - Detection - ============================== End Params ==============================
2023-04-05 04:58:30,015 - Detection - Data and Model Preparation...
2023-04-05 04:58:30,015 - Detection - The number of known intents is 38
2023-04-05 04:58:30,016 - Detection - Lists of known labels are: ['apr', 'credit_limit_change', 'cook_time', 'what_are_your_hobbies', 'make_call', 'definition', 'change_speed', 'where_are_you_from', 'travel_alert', 'next_holiday', 'ingredients_list', 'credit_score', 'rollover_401k', 'greeting', 'text', 'whisper_mode', 'user_name', 'todo_list_update', 'meeting_schedule', 'transactions', 'how_old_are_you', 'account_blocked', 'meal_suggestion', 'pto_request', 'replacement_card_duration', 'accept_reservations', 'thank_you', 'application_status', 'car_rental', 'taxes', 'food_last', 'calendar', 'change_language', 'tire_change', 'pto_request_status', 'no', 'travel_suggestion', 'pto_balance']
2023-04-05 04:58:30,054 - Detection - Number of labeled training samples = 3800
2023-04-05 04:58:30,054 - Detection - Number of unlabeled training samples = 11200
2023-04-05 04:58:30,060 - Detection - Number of evaluation samples = 760
2023-04-05 04:58:30,071 - Detection - Number of testing samples = 5700
2023-04-05 04:58:38,878 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-05 04:58:38,959 - Detection - Pre-training Begin...
2023-04-05 04:58:44,457 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 04:58:44,457 - Detection -   best_eval_score = 0
2023-04-05 04:58:44,457 - Detection -   eval_score = 0.73
2023-04-05 04:58:44,457 - Detection -   train_loss = 3.6408286492029824
2023-04-05 04:58:49,490 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 04:58:49,490 - Detection -   best_eval_score = 0.73
2023-04-05 04:58:49,490 - Detection -   eval_score = 2.3
2023-04-05 04:58:49,490 - Detection -   train_loss = 3.6209850629170734
2023-04-05 04:58:54,635 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 04:58:54,635 - Detection -   best_eval_score = 2.3
2023-04-05 04:58:54,635 - Detection -   eval_score = 14.16
2023-04-05 04:58:54,635 - Detection -   train_loss = 3.5853501081466677
2023-04-05 04:58:59,685 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 04:58:59,686 - Detection -   best_eval_score = 14.16
2023-04-05 04:58:59,686 - Detection -   eval_score = 37.1
2023-04-05 04:58:59,686 - Detection -   train_loss = 3.501226774851481
2023-04-05 04:59:04,749 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 04:59:04,749 - Detection -   best_eval_score = 37.1
2023-04-05 04:59:04,749 - Detection -   eval_score = 65.96
2023-04-05 04:59:04,749 - Detection -   train_loss = 3.2938753525416056
2023-04-05 04:59:09,825 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 04:59:09,825 - Detection -   best_eval_score = 65.96
2023-04-05 04:59:09,825 - Detection -   eval_score = 82.42
2023-04-05 04:59:09,825 - Detection -   train_loss = 2.989587680498759
2023-04-05 04:59:14,902 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 04:59:14,902 - Detection -   best_eval_score = 82.42
2023-04-05 04:59:14,902 - Detection -   eval_score = 88.73
2023-04-05 04:59:14,902 - Detection -   train_loss = 2.609606957435608
2023-04-05 04:59:19,995 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 04:59:19,995 - Detection -   best_eval_score = 88.73
2023-04-05 04:59:19,995 - Detection -   eval_score = 93.85
2023-04-05 04:59:19,995 - Detection -   train_loss = 2.270967213312785
2023-04-05 04:59:25,088 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 04:59:25,088 - Detection -   best_eval_score = 93.85
2023-04-05 04:59:25,088 - Detection -   eval_score = 95.57
2023-04-05 04:59:25,089 - Detection -   train_loss = 2.012481609980265
2023-04-05 04:59:30,195 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 04:59:30,195 - Detection -   best_eval_score = 95.57
2023-04-05 04:59:30,195 - Detection -   eval_score = 96.53
2023-04-05 04:59:30,195 - Detection -   train_loss = 1.8168353279431662
2023-04-05 04:59:35,306 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 04:59:35,306 - Detection -   best_eval_score = 96.53
2023-04-05 04:59:35,306 - Detection -   eval_score = 96.25
2023-04-05 04:59:35,306 - Detection -   train_loss = 1.6671119689941407
2023-04-05 04:59:40,411 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 04:59:40,411 - Detection -   best_eval_score = 96.53
2023-04-05 04:59:40,411 - Detection -   eval_score = 96.8
2023-04-05 04:59:40,411 - Detection -   train_loss = 1.55237326224645
2023-04-05 04:59:45,530 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 04:59:45,530 - Detection -   best_eval_score = 96.8
2023-04-05 04:59:45,530 - Detection -   eval_score = 96.92
2023-04-05 04:59:45,530 - Detection -   train_loss = 1.4713021198908487
2023-04-05 04:59:50,646 - Detection - ***** Epoch: 14: Eval results *****
2023-04-05 04:59:50,646 - Detection -   best_eval_score = 96.92
2023-04-05 04:59:50,646 - Detection -   eval_score = 97.36
2023-04-05 04:59:50,646 - Detection -   train_loss = 1.4043256322542825
2023-04-05 04:59:55,762 - Detection - ***** Epoch: 15: Eval results *****
2023-04-05 04:59:55,762 - Detection -   best_eval_score = 97.36
2023-04-05 04:59:55,762 - Detection -   eval_score = 97.36
2023-04-05 04:59:55,763 - Detection -   train_loss = 1.3472963651021321
2023-04-05 05:00:00,869 - Detection - ***** Epoch: 16: Eval results *****
2023-04-05 05:00:00,869 - Detection -   best_eval_score = 97.36
2023-04-05 05:00:00,869 - Detection -   eval_score = 97.36
2023-04-05 05:00:00,869 - Detection -   train_loss = 1.3019190708796182
2023-04-05 05:00:05,974 - Detection - ***** Epoch: 17: Eval results *****
2023-04-05 05:00:05,974 - Detection -   best_eval_score = 97.36
2023-04-05 05:00:05,974 - Detection -   eval_score = 97.23
2023-04-05 05:00:05,975 - Detection -   train_loss = 1.2617002248764038
2023-04-05 05:00:11,081 - Detection - ***** Epoch: 18: Eval results *****
2023-04-05 05:00:11,081 - Detection -   best_eval_score = 97.36
2023-04-05 05:00:11,081 - Detection -   eval_score = 97.5
2023-04-05 05:00:11,081 - Detection -   train_loss = 1.2228063464164733
2023-04-05 05:00:16,297 - Detection - ***** Epoch: 19: Eval results *****
2023-04-05 05:00:16,297 - Detection -   best_eval_score = 97.5
2023-04-05 05:00:16,297 - Detection -   eval_score = 97.37
2023-04-05 05:00:16,297 - Detection -   train_loss = 1.1958062450091045
2023-04-05 05:00:21,398 - Detection - ***** Epoch: 20: Eval results *****
2023-04-05 05:00:21,398 - Detection -   best_eval_score = 97.5
2023-04-05 05:00:21,398 - Detection -   eval_score = 97.36
2023-04-05 05:00:21,398 - Detection -   train_loss = 1.1678717255592346
2023-04-05 05:00:26,509 - Detection - ***** Epoch: 21: Eval results *****
2023-04-05 05:00:26,509 - Detection -   best_eval_score = 97.5
2023-04-05 05:00:26,509 - Detection -   eval_score = 97.37
2023-04-05 05:00:26,509 - Detection -   train_loss = 1.1444722890853882
2023-04-05 05:00:31,610 - Detection - ***** Epoch: 22: Eval results *****
2023-04-05 05:00:31,610 - Detection -   best_eval_score = 97.5
2023-04-05 05:00:31,610 - Detection -   eval_score = 97.63
2023-04-05 05:00:31,610 - Detection -   train_loss = 1.1208208759625753
2023-04-05 05:00:36,722 - Detection - ***** Epoch: 23: Eval results *****
2023-04-05 05:00:36,722 - Detection -   best_eval_score = 97.63
2023-04-05 05:00:36,722 - Detection -   eval_score = 97.63
2023-04-05 05:00:36,722 - Detection -   train_loss = 1.1004409869511922
2023-04-05 05:00:41,821 - Detection - ***** Epoch: 24: Eval results *****
2023-04-05 05:00:41,821 - Detection -   best_eval_score = 97.63
2023-04-05 05:00:41,821 - Detection -   eval_score = 97.37
2023-04-05 05:00:41,821 - Detection -   train_loss = 1.085028620560964
2023-04-05 05:00:46,921 - Detection - ***** Epoch: 25: Eval results *****
2023-04-05 05:00:46,921 - Detection -   best_eval_score = 97.63
2023-04-05 05:00:46,921 - Detection -   eval_score = 97.63
2023-04-05 05:00:46,921 - Detection -   train_loss = 1.066560169061025
2023-04-05 05:00:52,016 - Detection - ***** Epoch: 26: Eval results *****
2023-04-05 05:00:52,017 - Detection -   best_eval_score = 97.63
2023-04-05 05:00:52,017 - Detection -   eval_score = 97.5
2023-04-05 05:00:52,017 - Detection -   train_loss = 1.0539637883504231
2023-04-05 05:00:57,110 - Detection - ***** Epoch: 27: Eval results *****
2023-04-05 05:00:57,110 - Detection -   best_eval_score = 97.63
2023-04-05 05:00:57,110 - Detection -   eval_score = 97.5
2023-04-05 05:00:57,110 - Detection -   train_loss = 1.0368270039558412
2023-04-05 05:01:02,208 - Detection - ***** Epoch: 28: Eval results *****
2023-04-05 05:01:02,209 - Detection -   best_eval_score = 97.63
2023-04-05 05:01:02,209 - Detection -   eval_score = 97.63
2023-04-05 05:01:02,209 - Detection -   train_loss = 1.024669071038564
2023-04-05 05:01:07,305 - Detection - ***** Epoch: 29: Eval results *****
2023-04-05 05:01:07,306 - Detection -   best_eval_score = 97.63
2023-04-05 05:01:07,306 - Detection -   eval_score = 97.62
2023-04-05 05:01:07,306 - Detection -   train_loss = 1.0140330831209818
2023-04-05 05:01:12,399 - Detection - ***** Epoch: 30: Eval results *****
2023-04-05 05:01:12,399 - Detection -   best_eval_score = 97.63
2023-04-05 05:01:12,399 - Detection -   eval_score = 97.63
2023-04-05 05:01:12,399 - Detection -   train_loss = 1.0016274789969126
2023-04-05 05:01:17,498 - Detection - ***** Epoch: 31: Eval results *****
2023-04-05 05:01:17,498 - Detection -   best_eval_score = 97.63
2023-04-05 05:01:17,498 - Detection -   eval_score = 97.62
2023-04-05 05:01:17,498 - Detection -   train_loss = 0.9892316003640492
2023-04-05 05:01:22,593 - Detection - ***** Epoch: 32: Eval results *****
2023-04-05 05:01:22,593 - Detection -   best_eval_score = 97.63
2023-04-05 05:01:22,593 - Detection -   eval_score = 97.62
2023-04-05 05:01:22,593 - Detection -   train_loss = 0.9795615414778391
2023-04-05 05:01:22,594 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_oos_0.25_1.0_bert_disaware_8/models
2023-04-05 05:01:23,157 - Detection - Pre-training finished...
2023-04-05 05:01:23,157 - Detection - Training Begin...
2023-04-05 05:01:26,026 - Detection - ***** Epoch: 1: Eval results *****
2023-04-05 05:01:26,026 - Detection -   best_eval_score = 0
2023-04-05 05:01:26,026 - Detection -   eval_score = 31.74
2023-04-05 05:01:26,026 - Detection -   train_loss = 2.507340959707896
2023-04-05 05:01:28,895 - Detection - ***** Epoch: 2: Eval results *****
2023-04-05 05:01:28,895 - Detection -   best_eval_score = 31.74
2023-04-05 05:01:28,895 - Detection -   eval_score = 74.39
2023-04-05 05:01:28,895 - Detection -   train_loss = 1.5434745987256369
2023-04-05 05:01:31,764 - Detection - ***** Epoch: 3: Eval results *****
2023-04-05 05:01:31,764 - Detection -   best_eval_score = 74.39
2023-04-05 05:01:31,764 - Detection -   eval_score = 90.51
2023-04-05 05:01:31,764 - Detection -   train_loss = 0.6972444703181585
2023-04-05 05:01:34,633 - Detection - ***** Epoch: 4: Eval results *****
2023-04-05 05:01:34,633 - Detection -   best_eval_score = 90.51
2023-04-05 05:01:34,633 - Detection -   eval_score = 90.43
2023-04-05 05:01:34,633 - Detection -   train_loss = 0.5119734764099121
2023-04-05 05:01:37,504 - Detection - ***** Epoch: 5: Eval results *****
2023-04-05 05:01:37,505 - Detection -   best_eval_score = 90.51
2023-04-05 05:01:37,505 - Detection -   eval_score = 90.12
2023-04-05 05:01:37,505 - Detection -   train_loss = 0.5130163848400116
2023-04-05 05:01:40,373 - Detection - ***** Epoch: 6: Eval results *****
2023-04-05 05:01:40,373 - Detection -   best_eval_score = 90.51
2023-04-05 05:01:40,373 - Detection -   eval_score = 90.21
2023-04-05 05:01:40,373 - Detection -   train_loss = 0.5094303558270137
2023-04-05 05:01:43,247 - Detection - ***** Epoch: 7: Eval results *****
2023-04-05 05:01:43,247 - Detection -   best_eval_score = 90.51
2023-04-05 05:01:43,247 - Detection -   eval_score = 90.36
2023-04-05 05:01:43,247 - Detection -   train_loss = 0.5108122328917185
2023-04-05 05:01:46,120 - Detection - ***** Epoch: 8: Eval results *****
2023-04-05 05:01:46,120 - Detection -   best_eval_score = 90.51
2023-04-05 05:01:46,120 - Detection -   eval_score = 90.42
2023-04-05 05:01:46,120 - Detection -   train_loss = 0.5126096099615097
2023-04-05 05:01:48,990 - Detection - ***** Epoch: 9: Eval results *****
2023-04-05 05:01:48,990 - Detection -   best_eval_score = 90.51
2023-04-05 05:01:48,990 - Detection -   eval_score = 90.38
2023-04-05 05:01:48,990 - Detection -   train_loss = 0.5071865260601044
2023-04-05 05:01:51,862 - Detection - ***** Epoch: 10: Eval results *****
2023-04-05 05:01:51,862 - Detection -   best_eval_score = 90.51
2023-04-05 05:01:51,862 - Detection -   eval_score = 90.21
2023-04-05 05:01:51,862 - Detection -   train_loss = 0.5108444263537725
2023-04-05 05:01:54,731 - Detection - ***** Epoch: 11: Eval results *****
2023-04-05 05:01:54,731 - Detection -   best_eval_score = 90.51
2023-04-05 05:01:54,731 - Detection -   eval_score = 90.42
2023-04-05 05:01:54,731 - Detection -   train_loss = 0.5019790013631185
2023-04-05 05:01:57,600 - Detection - ***** Epoch: 12: Eval results *****
2023-04-05 05:01:57,600 - Detection -   best_eval_score = 90.51
2023-04-05 05:01:57,600 - Detection -   eval_score = 90.36
2023-04-05 05:01:57,600 - Detection -   train_loss = 0.4930405418078105
2023-04-05 05:02:00,472 - Detection - ***** Epoch: 13: Eval results *****
2023-04-05 05:02:00,472 - Detection -   best_eval_score = 90.51
2023-04-05 05:02:00,472 - Detection -   eval_score = 90.37
2023-04-05 05:02:00,472 - Detection -   train_loss = 0.5045157074928284
2023-04-05 05:02:00,473 - Detection - Training Finished...
2023-04-05 05:02:00,473 - Detection - Testing begin...
2023-04-05 05:02:03,731 - Detection - ***** Test: Confusion Matrix *****
2023-04-05 05:02:03,731 - Detection - [[  21    0    0 ...    0    0    9]
 [   0   29    0 ...    0    0    1]
 [   0    0   25 ...    0    0    5]
 ...
 [   0    0    0 ...   25    0    5]
 [   0    0    0 ...    0   25    5]
 [   1   15    0 ...    2   13 4107]]
2023-04-05 05:02:03,731 - Detection - ***** Test results *****
2023-04-05 05:02:03,731 - Detection -   Acc = 89.14
2023-04-05 05:02:03,731 - Detection -   F1 = 78.5954
2023-04-05 05:02:03,731 - Detection -   F1-known = 78.216
2023-04-05 05:02:03,732 - Detection -   F1-open = 93.0132
2023-04-05 05:02:03,732 - Detection - Testing finished...
2023-04-05 05:02:03,732 - Detection - Results saved in results/results_DA-ADB.csv
2023-04-05 05:02:03,757 - Detection - Open Intent Detection Finished...
