2023-04-22 18:41:42,478 - Detection - Open Intent Detection Begin...
2023-04-22 18:41:42,478 - Detection - Parameters Initialization...
2023-04-22 18:41:42,478 - Detection - ============================== Params ==============================
2023-04-22 18:41:42,478 - Detection - type:	open_intent_detection
2023-04-22 18:41:42,478 - Detection - logger_name:	Detection
2023-04-22 18:41:42,478 - Detection - log_dir:	logs
2023-04-22 18:41:42,478 - Detection - dataset:	stackoverflow_cg
2023-04-22 18:41:42,478 - Detection - known_cls_ratio:	0.5
2023-04-22 18:41:42,478 - Detection - labeled_ratio:	1.0
2023-04-22 18:41:42,478 - Detection - method:	DA-ADB
2023-04-22 18:41:42,479 - Detection - train:	True
2023-04-22 18:41:42,479 - Detection - pretrain:	True
2023-04-22 18:41:42,479 - Detection - save_model:	False
2023-04-22 18:41:42,479 - Detection - backbone:	bert_disaware_boost
2023-04-22 18:41:42,479 - Detection - config_file_name:	DA-ADB
2023-04-22 18:41:42,479 - Detection - seed:	2
2023-04-22 18:41:42,479 - Detection - gpu_id:	0
2023-04-22 18:41:42,479 - Detection - pipe_results_path:	pipe_results
2023-04-22 18:41:42,479 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-22 18:41:42,479 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-22 18:41:42,479 - Detection - model_dir:	models
2023-04-22 18:41:42,479 - Detection - load_pretrained_method:	None
2023-04-22 18:41:42,479 - Detection - result_dir:	results
2023-04-22 18:41:42,479 - Detection - results_file_name:	results_DA-ADB-BOOST-WP-10.csv
2023-04-22 18:41:42,479 - Detection - save_results:	True
2023-04-22 18:41:42,479 - Detection - loss_fct:	CrossEntropyLoss
2023-04-22 18:41:42,479 - Detection - boost_method:	WP-10
2023-04-22 18:41:42,479 - Detection - boost_start_score:	70.0
2023-04-22 18:41:42,479 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.5_1.0_bert_disaware_boost_2
2023-04-22 18:41:42,479 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.5_1.0_bert_disaware_boost_2/models
2023-04-22 18:41:42,479 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-22 18:41:42,479 - Detection - num_train_epochs:	100
2023-04-22 18:41:42,479 - Detection - num_labels:	None
2023-04-22 18:41:42,479 - Detection - max_seq_length:	None
2023-04-22 18:41:42,479 - Detection - freeze_backbone_parameters:	True
2023-04-22 18:41:42,479 - Detection - feat_dim:	768
2023-04-22 18:41:42,479 - Detection - warmup_proportion:	0.1
2023-04-22 18:41:42,479 - Detection - scale:	4
2023-04-22 18:41:42,479 - Detection - lr_boundary:	0.05
2023-04-22 18:41:42,479 - Detection - lr:	2e-05
2023-04-22 18:41:42,479 - Detection - activation:	relu
2023-04-22 18:41:42,479 - Detection - train_batch_size:	128
2023-04-22 18:41:42,479 - Detection - eval_batch_size:	64
2023-04-22 18:41:42,479 - Detection - test_batch_size:	64
2023-04-22 18:41:42,479 - Detection - wait_patient:	10
2023-04-22 18:41:42,479 - Detection - ============================== End Params ==============================
2023-04-22 18:41:42,479 - Detection - Data and Model Preparation...
2023-04-22 18:41:42,480 - Detection - The number of known intents is 10
2023-04-22 18:41:42,480 - Detection - Lists of known labels are: ['osx', 'drupal', 'visual-studio', 'ajax', 'magento', 'excel', 'cocoa', 'matlab', 'apache', 'svn']
2023-04-22 18:41:42,488 - Detection - Number of labeled training samples = 1471
2023-04-22 18:41:42,488 - Detection - Number of unlabeled training samples = 1320
2023-04-22 18:41:42,491 - Detection - Number of evaluation samples = 707
2023-04-22 18:41:42,496 - Detection - Number of testing samples = 2905
2023-04-22 18:41:48,047 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-22 18:41:48,128 - Detection - Pre-training Begin...
2023-04-22 18:41:51,830 - Detection - ***** Epoch: 1: Eval results *****
2023-04-22 18:41:51,830 - Detection -   best_eval_score = 0
2023-04-22 18:41:51,830 - Detection -   eval_score = 3.11
2023-04-22 18:41:51,830 - Detection -   train_loss = 2.3163299759229026
2023-04-22 18:41:55,061 - Detection - ***** Epoch: 2: Eval results *****
2023-04-22 18:41:55,061 - Detection -   best_eval_score = 3.11
2023-04-22 18:41:55,061 - Detection -   eval_score = 1.71
2023-04-22 18:41:55,061 - Detection -   train_loss = 2.2877848943074546
2023-04-22 18:42:16,656 - Detection - ***** Epoch: 3: Eval results *****
2023-04-22 18:42:16,656 - Detection -   best_eval_score = 3.11
2023-04-22 18:42:16,656 - Detection -   eval_score = 5.55
2023-04-22 18:42:16,656 - Detection -   train_loss = 2.2615155577659607
2023-04-22 18:42:19,911 - Detection - ***** Epoch: 4: Eval results *****
2023-04-22 18:42:19,911 - Detection -   best_eval_score = 5.55
2023-04-22 18:42:19,911 - Detection -   eval_score = 19.45
2023-04-22 18:42:19,911 - Detection -   train_loss = 2.1246995329856873
2023-04-22 18:42:23,190 - Detection - ***** Epoch: 5: Eval results *****
2023-04-22 18:42:23,190 - Detection -   best_eval_score = 19.45
2023-04-22 18:42:23,190 - Detection -   eval_score = 34.34
2023-04-22 18:42:23,190 - Detection -   train_loss = 2.0246626138687134
2023-04-22 18:42:26,523 - Detection - ***** Epoch: 6: Eval results *****
2023-04-22 18:42:26,523 - Detection -   best_eval_score = 34.34
2023-04-22 18:42:26,523 - Detection -   eval_score = 55.9
2023-04-22 18:42:26,523 - Detection -   train_loss = 1.8847216467062633
2023-04-22 18:42:29,899 - Detection - ***** Epoch: 7: Eval results *****
2023-04-22 18:42:29,899 - Detection -   best_eval_score = 55.9
2023-04-22 18:42:29,899 - Detection -   eval_score = 65.34
2023-04-22 18:42:29,899 - Detection -   train_loss = 1.71049565076828
2023-04-22 18:42:33,302 - Detection - ***** Epoch: 8: Eval results *****
2023-04-22 18:42:33,302 - Detection -   best_eval_score = 65.34
2023-04-22 18:42:33,302 - Detection -   eval_score = 72.79
2023-04-22 18:42:33,302 - Detection -   train_loss = 1.5313969949881236
2023-04-22 18:42:43,485 - Detection - ***** Epoch: 9: Eval results *****
2023-04-22 18:42:43,485 - Detection -   best_eval_score = 72.79
2023-04-22 18:42:43,485 - Detection -   eval_score = 77.17
2023-04-22 18:42:43,485 - Detection -   train_loss = 1.372419039408366
2023-04-22 18:42:52,477 - Detection - ***** Epoch: 10: Eval results *****
2023-04-22 18:42:52,477 - Detection -   best_eval_score = 77.17
2023-04-22 18:42:52,477 - Detection -   eval_score = 73.21
2023-04-22 18:42:52,477 - Detection -   train_loss = 1.2142708500226338
2023-04-22 18:43:00,907 - Detection - ***** Epoch: 11: Eval results *****
2023-04-22 18:43:00,907 - Detection -   best_eval_score = 77.17
2023-04-22 18:43:00,907 - Detection -   eval_score = 80.32
2023-04-22 18:43:00,907 - Detection -   train_loss = 1.104309191306432
2023-04-22 18:43:08,425 - Detection - ***** Epoch: 12: Eval results *****
2023-04-22 18:43:08,425 - Detection -   best_eval_score = 80.32
2023-04-22 18:43:08,425 - Detection -   eval_score = 80.09
2023-04-22 18:43:08,425 - Detection -   train_loss = 1.0056317448616028
2023-04-22 18:43:15,733 - Detection - ***** Epoch: 13: Eval results *****
2023-04-22 18:43:15,733 - Detection -   best_eval_score = 80.32
2023-04-22 18:43:15,733 - Detection -   eval_score = 76.7
2023-04-22 18:43:15,733 - Detection -   train_loss = 0.9569442818562189
2023-04-22 18:43:23,046 - Detection - ***** Epoch: 14: Eval results *****
2023-04-22 18:43:23,047 - Detection -   best_eval_score = 80.32
2023-04-22 18:43:23,047 - Detection -   eval_score = 78.09
2023-04-22 18:43:23,047 - Detection -   train_loss = 0.9134066700935364
2023-04-22 18:43:29,866 - Detection - ***** Epoch: 15: Eval results *****
2023-04-22 18:43:29,866 - Detection -   best_eval_score = 80.32
2023-04-22 18:43:29,866 - Detection -   eval_score = 79.12
2023-04-22 18:43:29,866 - Detection -   train_loss = 0.8923564453919729
2023-04-22 18:43:36,297 - Detection - ***** Epoch: 16: Eval results *****
2023-04-22 18:43:36,297 - Detection -   best_eval_score = 80.32
2023-04-22 18:43:36,297 - Detection -   eval_score = 79.44
2023-04-22 18:43:36,297 - Detection -   train_loss = 0.8507420470317205
2023-04-22 18:43:42,593 - Detection - ***** Epoch: 17: Eval results *****
2023-04-22 18:43:42,593 - Detection -   best_eval_score = 80.32
2023-04-22 18:43:42,593 - Detection -   eval_score = 76.46
2023-04-22 18:43:42,593 - Detection -   train_loss = 0.8220684279998144
2023-04-22 18:43:48,743 - Detection - ***** Epoch: 18: Eval results *****
2023-04-22 18:43:48,743 - Detection -   best_eval_score = 80.32
2023-04-22 18:43:48,743 - Detection -   eval_score = 80.07
2023-04-22 18:43:48,743 - Detection -   train_loss = 0.8257522483666738
2023-04-22 18:43:54,960 - Detection - ***** Epoch: 19: Eval results *****
2023-04-22 18:43:54,960 - Detection -   best_eval_score = 80.32
2023-04-22 18:43:54,960 - Detection -   eval_score = 80.12
2023-04-22 18:43:54,960 - Detection -   train_loss = 0.7507758388916651
2023-04-22 18:44:01,131 - Detection - ***** Epoch: 20: Eval results *****
2023-04-22 18:44:01,131 - Detection -   best_eval_score = 80.32
2023-04-22 18:44:01,131 - Detection -   eval_score = 80.23
2023-04-22 18:44:01,131 - Detection -   train_loss = 0.7316730072100958
2023-04-22 18:44:07,097 - Detection - ***** Epoch: 21: Eval results *****
2023-04-22 18:44:07,097 - Detection -   best_eval_score = 80.32
2023-04-22 18:44:07,097 - Detection -   eval_score = 78.37
2023-04-22 18:44:07,097 - Detection -   train_loss = 0.7147644261519114
2023-04-22 18:44:07,097 - Detection - Pre-training finished...
2023-04-22 18:44:07,098 - Detection - Training Begin...
2023-04-22 18:44:09,169 - Detection - ***** Epoch: 1: Eval results *****
2023-04-22 18:44:09,169 - Detection -   best_eval_score = 0
2023-04-22 18:44:09,169 - Detection -   eval_score = 0.0
2023-04-22 18:44:09,169 - Detection -   train_loss = 4.094346384207408
2023-04-22 18:44:11,240 - Detection - ***** Epoch: 2: Eval results *****
2023-04-22 18:44:11,240 - Detection -   best_eval_score = 0
2023-04-22 18:44:11,240 - Detection -   eval_score = 0.0
2023-04-22 18:44:11,240 - Detection -   train_loss = 3.690405488014221
2023-04-22 18:44:13,317 - Detection - ***** Epoch: 3: Eval results *****
2023-04-22 18:44:13,317 - Detection -   best_eval_score = 0
2023-04-22 18:44:13,317 - Detection -   eval_score = 0.53
2023-04-22 18:44:13,317 - Detection -   train_loss = 3.2531978686650596
2023-04-22 18:44:15,402 - Detection - ***** Epoch: 4: Eval results *****
2023-04-22 18:44:15,402 - Detection -   best_eval_score = 0.53
2023-04-22 18:44:15,402 - Detection -   eval_score = 5.18
2023-04-22 18:44:15,402 - Detection -   train_loss = 2.7308003505071006
2023-04-22 18:44:17,493 - Detection - ***** Epoch: 5: Eval results *****
2023-04-22 18:44:17,493 - Detection -   best_eval_score = 5.18
2023-04-22 18:44:17,493 - Detection -   eval_score = 12.22
2023-04-22 18:44:17,493 - Detection -   train_loss = 2.119517912467321
2023-04-22 18:44:19,579 - Detection - ***** Epoch: 6: Eval results *****
2023-04-22 18:44:19,580 - Detection -   best_eval_score = 12.22
2023-04-22 18:44:19,580 - Detection -   eval_score = 20.92
2023-04-22 18:44:19,580 - Detection -   train_loss = 1.5531540215015411
2023-04-22 18:44:21,678 - Detection - ***** Epoch: 7: Eval results *****
2023-04-22 18:44:21,678 - Detection -   best_eval_score = 20.92
2023-04-22 18:44:21,678 - Detection -   eval_score = 42.15
2023-04-22 18:44:21,678 - Detection -   train_loss = 1.0360222111145656
2023-04-22 18:44:23,774 - Detection - ***** Epoch: 8: Eval results *****
2023-04-22 18:44:23,774 - Detection -   best_eval_score = 42.15
2023-04-22 18:44:23,774 - Detection -   eval_score = 57.52
2023-04-22 18:44:23,774 - Detection -   train_loss = 0.716494952638944
2023-04-22 18:44:25,871 - Detection - ***** Epoch: 9: Eval results *****
2023-04-22 18:44:25,871 - Detection -   best_eval_score = 57.52
2023-04-22 18:44:25,872 - Detection -   eval_score = 61.7
2023-04-22 18:44:25,872 - Detection -   train_loss = 0.6212791949510574
2023-04-22 18:44:27,964 - Detection - ***** Epoch: 10: Eval results *****
2023-04-22 18:44:27,964 - Detection -   best_eval_score = 61.7
2023-04-22 18:44:27,964 - Detection -   eval_score = 61.76
2023-04-22 18:44:27,965 - Detection -   train_loss = 0.6174755046765009
2023-04-22 18:44:30,062 - Detection - ***** Epoch: 11: Eval results *****
2023-04-22 18:44:30,063 - Detection -   best_eval_score = 61.76
2023-04-22 18:44:30,063 - Detection -   eval_score = 60.03
2023-04-22 18:44:30,063 - Detection -   train_loss = 0.6079252660274506
2023-04-22 18:44:43,057 - Detection - ***** Epoch: 12: Eval results *****
2023-04-22 18:44:43,057 - Detection -   best_eval_score = 61.76
2023-04-22 18:44:43,057 - Detection -   eval_score = 64.67
2023-04-22 18:44:43,057 - Detection -   train_loss = 0.5956340332825979
2023-04-22 18:44:45,110 - Detection - ***** Epoch: 13: Eval results *****
2023-04-22 18:44:45,110 - Detection -   best_eval_score = 64.67
2023-04-22 18:44:45,110 - Detection -   eval_score = 63.92
2023-04-22 18:44:45,110 - Detection -   train_loss = 0.8232260247071584
2023-04-22 18:44:57,181 - Detection - ***** Epoch: 14: Eval results *****
2023-04-22 18:44:57,181 - Detection -   best_eval_score = 64.67
2023-04-22 18:44:57,181 - Detection -   eval_score = 64.81
2023-04-22 18:44:57,182 - Detection -   train_loss = 0.6776367624600729
2023-04-22 18:44:59,218 - Detection - ***** Epoch: 15: Eval results *****
2023-04-22 18:44:59,218 - Detection -   best_eval_score = 64.81
2023-04-22 18:44:59,218 - Detection -   eval_score = 62.71
2023-04-22 18:44:59,218 - Detection -   train_loss = 0.8999147762854894
2023-04-22 18:45:10,944 - Detection - ***** Epoch: 16: Eval results *****
2023-04-22 18:45:10,945 - Detection -   best_eval_score = 64.81
2023-04-22 18:45:10,945 - Detection -   eval_score = 65.42
2023-04-22 18:45:10,945 - Detection -   train_loss = 0.7439804822206497
2023-04-22 18:45:12,980 - Detection - ***** Epoch: 17: Eval results *****
2023-04-22 18:45:12,980 - Detection -   best_eval_score = 65.42
2023-04-22 18:45:12,980 - Detection -   eval_score = 63.98
2023-04-22 18:45:12,980 - Detection -   train_loss = 0.9266648292541504
2023-04-22 18:45:24,531 - Detection - ***** Epoch: 18: Eval results *****
2023-04-22 18:45:24,531 - Detection -   best_eval_score = 65.42
2023-04-22 18:45:24,531 - Detection -   eval_score = 64.48
2023-04-22 18:45:24,531 - Detection -   train_loss = 0.7507519771655401
2023-04-22 18:45:34,775 - Detection - ***** Epoch: 19: Eval results *****
2023-04-22 18:45:34,775 - Detection -   best_eval_score = 65.42
2023-04-22 18:45:34,775 - Detection -   eval_score = 66.29
2023-04-22 18:45:34,775 - Detection -   train_loss = 0.8926976472139359
2023-04-22 18:45:36,805 - Detection - ***** Epoch: 20: Eval results *****
2023-04-22 18:45:36,805 - Detection -   best_eval_score = 66.29
2023-04-22 18:45:36,805 - Detection -   eval_score = 64.81
2023-04-22 18:45:36,805 - Detection -   train_loss = 0.9509676446517309
2023-04-22 18:45:48,409 - Detection - ***** Epoch: 21: Eval results *****
2023-04-22 18:45:48,409 - Detection -   best_eval_score = 66.29
2023-04-22 18:45:48,409 - Detection -   eval_score = 64.63
2023-04-22 18:45:48,410 - Detection -   train_loss = 0.76710145175457
2023-04-22 18:45:58,802 - Detection - ***** Epoch: 22: Eval results *****
2023-04-22 18:45:58,802 - Detection -   best_eval_score = 66.29
2023-04-22 18:45:58,802 - Detection -   eval_score = 66.04
2023-04-22 18:45:58,802 - Detection -   train_loss = 0.9264480421940485
2023-04-22 18:46:09,067 - Detection - ***** Epoch: 23: Eval results *****
2023-04-22 18:46:09,067 - Detection -   best_eval_score = 66.29
2023-04-22 18:46:09,067 - Detection -   eval_score = 65.67
2023-04-22 18:46:09,067 - Detection -   train_loss = 0.9535829474528631
2023-04-22 18:46:19,302 - Detection - ***** Epoch: 24: Eval results *****
2023-04-22 18:46:19,302 - Detection -   best_eval_score = 66.29
2023-04-22 18:46:19,302 - Detection -   eval_score = 65.82
2023-04-22 18:46:19,302 - Detection -   train_loss = 0.96541861196359
2023-04-22 18:46:29,621 - Detection - ***** Epoch: 25: Eval results *****
2023-04-22 18:46:29,621 - Detection -   best_eval_score = 66.29
2023-04-22 18:46:29,621 - Detection -   eval_score = 64.9
2023-04-22 18:46:29,621 - Detection -   train_loss = 0.9368175069491068
2023-04-22 18:46:39,738 - Detection - ***** Epoch: 26: Eval results *****
2023-04-22 18:46:39,739 - Detection -   best_eval_score = 66.29
2023-04-22 18:46:39,739 - Detection -   eval_score = 65.91
2023-04-22 18:46:39,739 - Detection -   train_loss = 0.9664627313613892
2023-04-22 18:46:49,454 - Detection - ***** Epoch: 27: Eval results *****
2023-04-22 18:46:49,454 - Detection -   best_eval_score = 66.29
2023-04-22 18:46:49,454 - Detection -   eval_score = 65.55
2023-04-22 18:46:49,454 - Detection -   train_loss = 0.9733094771703085
2023-04-22 18:46:59,511 - Detection - ***** Epoch: 28: Eval results *****
2023-04-22 18:46:59,511 - Detection -   best_eval_score = 66.29
2023-04-22 18:46:59,511 - Detection -   eval_score = 65.27
2023-04-22 18:46:59,511 - Detection -   train_loss = 0.9355872869491577
2023-04-22 18:47:09,755 - Detection - ***** Epoch: 29: Eval results *****
2023-04-22 18:47:09,755 - Detection -   best_eval_score = 66.29
2023-04-22 18:47:09,755 - Detection -   eval_score = 65.71
2023-04-22 18:47:09,755 - Detection -   train_loss = 0.9506651759147644
2023-04-22 18:47:09,755 - Detection - Training Finished...
2023-04-22 18:47:09,755 - Detection - Testing begin...
2023-04-22 18:47:12,261 - Detection - ***** Test: Confusion Matrix *****
2023-04-22 18:47:12,261 - Detection - [[ 94  10   3   0   0   3  68   0   4   4   7]
 [  0  59   0   0   0   2   1   0   1   0  65]
 [  2   6  52   1   0   8  13   0   2  10  12]
 [  0   7   3 118   0   4   7   0   3   0  18]
 [  0   3   0   0 109   2   5   0   2   1  10]
 [  0   6   4   0   0  63  11   1   1   1  53]
 [ 10   9   2   0   0   8 120   1   3   3   5]
 [  1   2   0   1   0   4   6 138   0   1  11]
 [  1  11   0   0   0   1   6   0 106   5  40]
 [  2   6   4   0   0   0   3   0   1 125   8]
 [ 36 210  17  18  11 328 261  14  34  91 382]]
2023-04-22 18:47:12,261 - Detection - ***** Test results *****
2023-04-22 18:47:12,261 - Detection -   Acc = 47.02
2023-04-22 18:47:12,261 - Detection -   F1 = 55.795
2023-04-22 18:47:12,261 - Detection -   F1-known = 57.5791
2023-04-22 18:47:12,261 - Detection -   F1-open = 37.9533
2023-04-22 18:47:12,261 - Detection - Testing finished...
2023-04-22 18:47:12,261 - Detection - Results saved in results/results_DA-ADB-BOOST-WP-10.csv
2023-04-22 18:47:12,280 - Detection - Open Intent Detection Finished...
