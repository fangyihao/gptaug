2023-04-23 17:43:43,806 - Detection - Open Intent Detection Begin...
2023-04-23 17:43:43,806 - Detection - Parameters Initialization...
2023-04-23 17:43:43,806 - Detection - ============================== Params ==============================
2023-04-23 17:43:43,806 - Detection - type:	open_intent_detection
2023-04-23 17:43:43,806 - Detection - logger_name:	Detection
2023-04-23 17:43:43,806 - Detection - log_dir:	logs
2023-04-23 17:43:43,806 - Detection - dataset:	oos_cg
2023-04-23 17:43:43,806 - Detection - known_cls_ratio:	0.25
2023-04-23 17:43:43,806 - Detection - labeled_ratio:	1.0
2023-04-23 17:43:43,806 - Detection - method:	ADB
2023-04-23 17:43:43,806 - Detection - train:	True
2023-04-23 17:43:43,806 - Detection - pretrain:	True
2023-04-23 17:43:43,807 - Detection - save_model:	False
2023-04-23 17:43:43,807 - Detection - backbone:	bert_boost
2023-04-23 17:43:43,807 - Detection - config_file_name:	ADB
2023-04-23 17:43:43,807 - Detection - seed:	4
2023-04-23 17:43:43,807 - Detection - gpu_id:	0
2023-04-23 17:43:43,807 - Detection - pipe_results_path:	pipe_results
2023-04-23 17:43:43,807 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-23 17:43:43,807 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-23 17:43:43,807 - Detection - model_dir:	models
2023-04-23 17:43:43,807 - Detection - load_pretrained_method:	None
2023-04-23 17:43:43,807 - Detection - result_dir:	results
2023-04-23 17:43:43,807 - Detection - results_file_name:	results_ADB-BOOST-F-4.csv
2023-04-23 17:43:43,807 - Detection - save_results:	True
2023-04-23 17:43:43,807 - Detection - loss_fct:	CrossEntropyLoss
2023-04-23 17:43:43,807 - Detection - boost_method:	F-4
2023-04-23 17:43:43,807 - Detection - boost_start_score:	0.0
2023-04-23 17:43:43,807 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_cg_0.25_1.0_bert_boost_4
2023-04-23 17:43:43,807 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_oos_cg_0.25_1.0_bert_boost_4/models
2023-04-23 17:43:43,807 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-23 17:43:43,807 - Detection - num_train_epochs:	100
2023-04-23 17:43:43,807 - Detection - num_labels:	None
2023-04-23 17:43:43,807 - Detection - max_seq_length:	None
2023-04-23 17:43:43,807 - Detection - freeze_backbone_parameters:	True
2023-04-23 17:43:43,807 - Detection - feat_dim:	768
2023-04-23 17:43:43,807 - Detection - warmup_proportion:	0.1
2023-04-23 17:43:43,807 - Detection - lr_boundary:	0.05
2023-04-23 17:43:43,807 - Detection - lr:	2e-05
2023-04-23 17:43:43,807 - Detection - activation:	relu
2023-04-23 17:43:43,807 - Detection - train_batch_size:	128
2023-04-23 17:43:43,807 - Detection - eval_batch_size:	64
2023-04-23 17:43:43,807 - Detection - test_batch_size:	64
2023-04-23 17:43:43,807 - Detection - wait_patient:	10
2023-04-23 17:43:43,807 - Detection - ============================== End Params ==============================
2023-04-23 17:43:43,807 - Detection - Data and Model Preparation...
2023-04-23 17:43:43,808 - Detection - The number of known intents is 38
2023-04-23 17:43:43,808 - Detection - Lists of known labels are: ['traffic', 'card_declined', 'transfer', 'roll_dice', 'routing', 'oil_change_how', 'pay_bill', 'calories', 'are_you_a_bot', 'travel_notification', 'change_volume', 'calculator', 'calendar', 'last_maintenance', 'smart_home', 'definition', 'international_fees', 'alarm', 'change_user_name', 'timezone', 'direct_deposit', 'tire_change', 'meaning_of_life', 'confirm_reservation', 'credit_limit_change', 'carry_on', 'find_phone', 'cancel_reservation', 'change_accent', 'restaurant_reservation', 'payday', 'gas', 'schedule_maintenance', 'account_blocked', 'redeem_rewards', 'what_song', 'tire_pressure', 'recipe']
2023-04-23 17:43:43,817 - Detection - Number of labeled training samples = 907
2023-04-23 17:43:43,817 - Detection - Number of unlabeled training samples = 2776
2023-04-23 17:43:43,821 - Detection - Number of evaluation samples = 417
2023-04-23 17:43:43,828 - Detection - Number of testing samples = 3632
2023-04-23 17:43:47,891 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-23 17:43:49,600 - Detection - Pre-training Begin...
2023-04-23 17:43:50,961 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 17:43:50,961 - Detection -   best_eval_score = 0
2023-04-23 17:43:50,961 - Detection -   eval_score = 1.44
2023-04-23 17:43:50,961 - Detection -   train_loss = 3.6460248231887817
2023-04-23 17:43:55,212 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 17:43:55,212 - Detection -   best_eval_score = 1.44
2023-04-23 17:43:55,212 - Detection -   eval_score = 11.27
2023-04-23 17:43:55,212 - Detection -   train_loss = 3.6192556023597717
2023-04-23 17:43:59,401 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 17:43:59,401 - Detection -   best_eval_score = 11.27
2023-04-23 17:43:59,401 - Detection -   eval_score = 16.55
2023-04-23 17:43:59,401 - Detection -   train_loss = 3.454041600227356
2023-04-23 17:44:03,489 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 17:44:03,489 - Detection -   best_eval_score = 16.55
2023-04-23 17:44:03,489 - Detection -   eval_score = 30.7
2023-04-23 17:44:03,489 - Detection -   train_loss = 3.0454541444778442
2023-04-23 17:44:07,592 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 17:44:07,592 - Detection -   best_eval_score = 30.7
2023-04-23 17:44:07,592 - Detection -   eval_score = 49.88
2023-04-23 17:44:07,592 - Detection -   train_loss = 2.196841686964035
2023-04-23 17:44:11,790 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 17:44:11,790 - Detection -   best_eval_score = 49.88
2023-04-23 17:44:11,790 - Detection -   eval_score = 71.22
2023-04-23 17:44:11,790 - Detection -   train_loss = 1.3391317501664162
2023-04-23 17:44:15,918 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 17:44:15,918 - Detection -   best_eval_score = 71.22
2023-04-23 17:44:15,918 - Detection -   eval_score = 79.86
2023-04-23 17:44:15,918 - Detection -   train_loss = 0.792550578713417
2023-04-23 17:44:20,030 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 17:44:20,030 - Detection -   best_eval_score = 79.86
2023-04-23 17:44:20,030 - Detection -   eval_score = 82.01
2023-04-23 17:44:20,030 - Detection -   train_loss = 0.5161069892346859
2023-04-23 17:44:24,274 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 17:44:24,274 - Detection -   best_eval_score = 82.01
2023-04-23 17:44:24,274 - Detection -   eval_score = 82.97
2023-04-23 17:44:24,274 - Detection -   train_loss = 0.2991973627358675
2023-04-23 17:44:28,389 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 17:44:28,390 - Detection -   best_eval_score = 82.97
2023-04-23 17:44:28,390 - Detection -   eval_score = 82.97
2023-04-23 17:44:28,390 - Detection -   train_loss = 0.20402065757662058
2023-04-23 17:44:32,499 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 17:44:32,499 - Detection -   best_eval_score = 82.97
2023-04-23 17:44:32,499 - Detection -   eval_score = 84.41
2023-04-23 17:44:32,499 - Detection -   train_loss = 0.16261722519993782
2023-04-23 17:44:36,853 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 17:44:36,853 - Detection -   best_eval_score = 84.41
2023-04-23 17:44:36,853 - Detection -   eval_score = 85.13
2023-04-23 17:44:36,853 - Detection -   train_loss = 0.11476299539208412
2023-04-23 17:44:41,021 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 17:44:41,021 - Detection -   best_eval_score = 85.13
2023-04-23 17:44:41,021 - Detection -   eval_score = 86.09
2023-04-23 17:44:41,021 - Detection -   train_loss = 0.09045052481815219
2023-04-23 17:44:45,144 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 17:44:45,144 - Detection -   best_eval_score = 86.09
2023-04-23 17:44:45,144 - Detection -   eval_score = 85.85
2023-04-23 17:44:45,144 - Detection -   train_loss = 0.0784460362046957
2023-04-23 17:44:49,244 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 17:44:49,244 - Detection -   best_eval_score = 86.09
2023-04-23 17:44:49,244 - Detection -   eval_score = 85.37
2023-04-23 17:44:49,244 - Detection -   train_loss = 0.067540202755481
2023-04-23 17:44:53,486 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 17:44:53,486 - Detection -   best_eval_score = 86.09
2023-04-23 17:44:53,486 - Detection -   eval_score = 86.33
2023-04-23 17:44:53,486 - Detection -   train_loss = 0.056913028471171856
2023-04-23 17:44:57,606 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 17:44:57,606 - Detection -   best_eval_score = 86.33
2023-04-23 17:44:57,606 - Detection -   eval_score = 86.09
2023-04-23 17:44:57,606 - Detection -   train_loss = 0.045327384024858475
2023-04-23 17:45:01,770 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 17:45:01,771 - Detection -   best_eval_score = 86.33
2023-04-23 17:45:01,771 - Detection -   eval_score = 86.33
2023-04-23 17:45:01,771 - Detection -   train_loss = 0.04614712484180927
2023-04-23 17:45:06,029 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 17:45:06,029 - Detection -   best_eval_score = 86.33
2023-04-23 17:45:06,029 - Detection -   eval_score = 85.37
2023-04-23 17:45:06,029 - Detection -   train_loss = 0.03957120538689196
2023-04-23 17:45:10,151 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 17:45:10,151 - Detection -   best_eval_score = 86.33
2023-04-23 17:45:10,151 - Detection -   eval_score = 86.09
2023-04-23 17:45:10,151 - Detection -   train_loss = 0.03362175798974931
2023-04-23 17:45:14,344 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 17:45:14,344 - Detection -   best_eval_score = 86.33
2023-04-23 17:45:14,344 - Detection -   eval_score = 86.09
2023-04-23 17:45:14,344 - Detection -   train_loss = 0.0337184714153409
2023-04-23 17:45:18,545 - Detection - ***** Epoch: 22: Eval results *****
2023-04-23 17:45:18,545 - Detection -   best_eval_score = 86.33
2023-04-23 17:45:18,545 - Detection -   eval_score = 85.85
2023-04-23 17:45:18,545 - Detection -   train_loss = 0.02964842808432877
2023-04-23 17:45:22,651 - Detection - ***** Epoch: 23: Eval results *****
2023-04-23 17:45:22,651 - Detection -   best_eval_score = 86.33
2023-04-23 17:45:22,651 - Detection -   eval_score = 85.85
2023-04-23 17:45:22,651 - Detection -   train_loss = 0.027605339186266065
2023-04-23 17:45:26,844 - Detection - ***** Epoch: 24: Eval results *****
2023-04-23 17:45:26,844 - Detection -   best_eval_score = 86.33
2023-04-23 17:45:26,844 - Detection -   eval_score = 86.09
2023-04-23 17:45:26,844 - Detection -   train_loss = 0.025232863379642367
2023-04-23 17:45:30,943 - Detection - ***** Epoch: 25: Eval results *****
2023-04-23 17:45:30,944 - Detection -   best_eval_score = 86.33
2023-04-23 17:45:30,944 - Detection -   eval_score = 86.33
2023-04-23 17:45:30,944 - Detection -   train_loss = 0.024007810279726982
2023-04-23 17:45:35,159 - Detection - ***** Epoch: 26: Eval results *****
2023-04-23 17:45:35,159 - Detection -   best_eval_score = 86.33
2023-04-23 17:45:35,159 - Detection -   eval_score = 86.33
2023-04-23 17:45:35,159 - Detection -   train_loss = 0.020573949674144387
2023-04-23 17:45:35,159 - Detection - Pre-training finished...
2023-04-23 17:45:35,160 - Detection - Training Begin...
2023-04-23 17:45:36,158 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 17:45:36,158 - Detection -   best_eval_score = 0
2023-04-23 17:45:36,158 - Detection -   eval_score = 0.0
2023-04-23 17:45:36,158 - Detection -   train_loss = 9.143715023994446
2023-04-23 17:45:36,764 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 17:45:36,765 - Detection -   best_eval_score = 0
2023-04-23 17:45:36,765 - Detection -   eval_score = 0.0
2023-04-23 17:45:36,765 - Detection -   train_loss = 8.711291432380676
2023-04-23 17:45:37,369 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 17:45:37,369 - Detection -   best_eval_score = 0
2023-04-23 17:45:37,369 - Detection -   eval_score = 0.0
2023-04-23 17:45:37,369 - Detection -   train_loss = 8.560317158699036
2023-04-23 17:45:37,975 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 17:45:37,975 - Detection -   best_eval_score = 0
2023-04-23 17:45:37,975 - Detection -   eval_score = 0.0
2023-04-23 17:45:37,975 - Detection -   train_loss = 8.302568972110748
2023-04-23 17:45:38,582 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 17:45:38,582 - Detection -   best_eval_score = 0
2023-04-23 17:45:38,582 - Detection -   eval_score = 0.85
2023-04-23 17:45:38,582 - Detection -   train_loss = 8.073128700256348
2023-04-23 17:45:42,647 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 17:45:42,647 - Detection -   best_eval_score = 0.85
2023-04-23 17:45:42,647 - Detection -   eval_score = 2.66
2023-04-23 17:45:42,647 - Detection -   train_loss = 7.705555737018585
2023-04-23 17:45:46,746 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 17:45:46,746 - Detection -   best_eval_score = 2.66
2023-04-23 17:45:46,746 - Detection -   eval_score = 16.13
2023-04-23 17:45:46,746 - Detection -   train_loss = 6.043900966644287
2023-04-23 17:45:50,926 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 17:45:50,926 - Detection -   best_eval_score = 16.13
2023-04-23 17:45:50,926 - Detection -   eval_score = 39.3
2023-04-23 17:45:50,926 - Detection -   train_loss = 4.34627628326416
2023-04-23 17:45:55,121 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 17:45:55,121 - Detection -   best_eval_score = 39.3
2023-04-23 17:45:55,121 - Detection -   eval_score = 58.98
2023-04-23 17:45:55,121 - Detection -   train_loss = 2.641626536846161
2023-04-23 17:45:59,202 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 17:45:59,202 - Detection -   best_eval_score = 58.98
2023-04-23 17:45:59,203 - Detection -   eval_score = 67.26
2023-04-23 17:45:59,203 - Detection -   train_loss = 1.49177847802639
2023-04-23 17:46:03,326 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 17:46:03,326 - Detection -   best_eval_score = 67.26
2023-04-23 17:46:03,326 - Detection -   eval_score = 70.19
2023-04-23 17:46:03,326 - Detection -   train_loss = 1.0446533858776093
2023-04-23 17:46:07,582 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 17:46:07,582 - Detection -   best_eval_score = 70.19
2023-04-23 17:46:07,582 - Detection -   eval_score = 69.74
2023-04-23 17:46:07,582 - Detection -   train_loss = 0.9275060072541237
2023-04-23 17:46:11,724 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 17:46:11,724 - Detection -   best_eval_score = 70.19
2023-04-23 17:46:11,725 - Detection -   eval_score = 69.95
2023-04-23 17:46:11,725 - Detection -   train_loss = 0.9819968566298485
2023-04-23 17:46:15,857 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 17:46:15,857 - Detection -   best_eval_score = 70.19
2023-04-23 17:46:15,857 - Detection -   eval_score = 69.88
2023-04-23 17:46:15,857 - Detection -   train_loss = 1.019047737121582
2023-04-23 17:46:20,065 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 17:46:20,065 - Detection -   best_eval_score = 70.19
2023-04-23 17:46:20,066 - Detection -   eval_score = 69.81
2023-04-23 17:46:20,066 - Detection -   train_loss = 1.002350315451622
2023-04-23 17:46:24,147 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 17:46:24,147 - Detection -   best_eval_score = 70.19
2023-04-23 17:46:24,147 - Detection -   eval_score = 69.46
2023-04-23 17:46:24,147 - Detection -   train_loss = 1.0021059960126877
2023-04-23 17:46:28,210 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 17:46:28,210 - Detection -   best_eval_score = 70.19
2023-04-23 17:46:28,210 - Detection -   eval_score = 69.9
2023-04-23 17:46:28,210 - Detection -   train_loss = 0.9596948251128197
2023-04-23 17:46:32,292 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 17:46:32,292 - Detection -   best_eval_score = 70.19
2023-04-23 17:46:32,292 - Detection -   eval_score = 69.81
2023-04-23 17:46:32,292 - Detection -   train_loss = 0.9812514334917068
2023-04-23 17:46:36,456 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 17:46:36,456 - Detection -   best_eval_score = 70.19
2023-04-23 17:46:36,456 - Detection -   eval_score = 70.11
2023-04-23 17:46:36,456 - Detection -   train_loss = 1.0346063897013664
2023-04-23 17:46:40,520 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 17:46:40,520 - Detection -   best_eval_score = 70.19
2023-04-23 17:46:40,520 - Detection -   eval_score = 69.59
2023-04-23 17:46:40,521 - Detection -   train_loss = 0.9270097091794014
2023-04-23 17:46:44,698 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 17:46:44,698 - Detection -   best_eval_score = 70.19
2023-04-23 17:46:44,698 - Detection -   eval_score = 69.34
2023-04-23 17:46:44,699 - Detection -   train_loss = 0.9970548823475838
2023-04-23 17:46:44,699 - Detection - Training Finished...
2023-04-23 17:46:44,699 - Detection - Testing begin...
2023-04-23 17:46:46,205 - Detection - ***** Test: Confusion Matrix *****
2023-04-23 17:46:46,205 - Detection - [[  11    0    0 ...    0    0    2]
 [   0    0    0 ...    0    0    9]
 [   0    0    2 ...    0    0   10]
 ...
 [   0    0    0 ...    3    0    9]
 [   0    0    0 ...    0   15    4]
 [   1    6    1 ...    0   28 2799]]
2023-04-23 17:46:46,205 - Detection - ***** Test results *****
2023-04-23 17:46:46,205 - Detection -   Acc = 86.48
2023-04-23 17:46:46,205 - Detection -   F1 = 57.8164
2023-04-23 17:46:46,205 - Detection -   F1-known = 56.9113
2023-04-23 17:46:46,205 - Detection -   F1-open = 92.2089
2023-04-23 17:46:46,205 - Detection - Testing finished...
2023-04-23 17:46:46,206 - Detection - Results saved in results/results_ADB-BOOST-F-4.csv
2023-04-23 17:46:46,226 - Detection - Open Intent Detection Finished...
