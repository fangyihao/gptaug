2023-04-24 10:58:44,446 - Detection - Open Intent Detection Begin...
2023-04-24 10:58:44,446 - Detection - Parameters Initialization...
2023-04-24 10:58:44,446 - Detection - ============================== Params ==============================
2023-04-24 10:58:44,446 - Detection - type:	open_intent_detection
2023-04-24 10:58:44,446 - Detection - logger_name:	Detection
2023-04-24 10:58:44,446 - Detection - log_dir:	logs
2023-04-24 10:58:44,446 - Detection - dataset:	stackoverflow_cg
2023-04-24 10:58:44,446 - Detection - known_cls_ratio:	0.5
2023-04-24 10:58:44,446 - Detection - labeled_ratio:	1.0
2023-04-24 10:58:44,446 - Detection - method:	ADB
2023-04-24 10:58:44,446 - Detection - train:	True
2023-04-24 10:58:44,446 - Detection - pretrain:	True
2023-04-24 10:58:44,446 - Detection - save_model:	False
2023-04-24 10:58:44,446 - Detection - backbone:	bert_boost
2023-04-24 10:58:44,446 - Detection - config_file_name:	ADB
2023-04-24 10:58:44,446 - Detection - seed:	3
2023-04-24 10:58:44,446 - Detection - gpu_id:	0
2023-04-24 10:58:44,446 - Detection - pipe_results_path:	pipe_results
2023-04-24 10:58:44,446 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-24 10:58:44,446 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-24 10:58:44,446 - Detection - model_dir:	models
2023-04-24 10:58:44,446 - Detection - load_pretrained_method:	None
2023-04-24 10:58:44,446 - Detection - result_dir:	results
2023-04-24 10:58:44,446 - Detection - results_file_name:	results_ADB-BOOST-F-10.csv
2023-04-24 10:58:44,446 - Detection - save_results:	True
2023-04-24 10:58:44,446 - Detection - loss_fct:	CrossEntropyLoss
2023-04-24 10:58:44,447 - Detection - boost_method:	F-10
2023-04-24 10:58:44,447 - Detection - boost_start_score:	0.0
2023-04-24 10:58:44,447 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.5_1.0_bert_boost_3
2023-04-24 10:58:44,447 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.5_1.0_bert_boost_3/models
2023-04-24 10:58:44,447 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-24 10:58:44,447 - Detection - num_train_epochs:	100
2023-04-24 10:58:44,447 - Detection - num_labels:	None
2023-04-24 10:58:44,447 - Detection - max_seq_length:	None
2023-04-24 10:58:44,447 - Detection - freeze_backbone_parameters:	True
2023-04-24 10:58:44,447 - Detection - feat_dim:	768
2023-04-24 10:58:44,447 - Detection - warmup_proportion:	0.1
2023-04-24 10:58:44,447 - Detection - lr_boundary:	0.05
2023-04-24 10:58:44,447 - Detection - lr:	2e-05
2023-04-24 10:58:44,447 - Detection - activation:	relu
2023-04-24 10:58:44,447 - Detection - train_batch_size:	128
2023-04-24 10:58:44,447 - Detection - eval_batch_size:	64
2023-04-24 10:58:44,447 - Detection - test_batch_size:	64
2023-04-24 10:58:44,447 - Detection - wait_patient:	10
2023-04-24 10:58:44,447 - Detection - ============================== End Params ==============================
2023-04-24 10:58:44,447 - Detection - Data and Model Preparation...
2023-04-24 10:58:44,447 - Detection - The number of known intents is 10
2023-04-24 10:58:44,447 - Detection - Lists of known labels are: ['scala', 'bash', 'apache', 'svn', 'drupal', 'spring', 'haskell', 'hibernate', 'sharepoint', 'osx']
2023-04-24 10:58:44,455 - Detection - Number of labeled training samples = 1319
2023-04-24 10:58:44,455 - Detection - Number of unlabeled training samples = 1472
2023-04-24 10:58:44,458 - Detection - Number of evaluation samples = 749
2023-04-24 10:58:44,463 - Detection - Number of testing samples = 2905
2023-04-24 10:58:48,485 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-24 10:58:50,140 - Detection - Pre-training Begin...
2023-04-24 10:58:52,472 - Detection - ***** Epoch: 1: Eval results *****
2023-04-24 10:58:52,472 - Detection -   best_eval_score = 0
2023-04-24 10:58:52,472 - Detection -   eval_score = 11.48
2023-04-24 10:58:52,472 - Detection -   train_loss = 2.3050951307470147
2023-04-24 10:59:12,043 - Detection - ***** Epoch: 2: Eval results *****
2023-04-24 10:59:12,043 - Detection -   best_eval_score = 11.48
2023-04-24 10:59:12,043 - Detection -   eval_score = 43.52
2023-04-24 10:59:12,043 - Detection -   train_loss = 2.294337207620794
2023-04-24 10:59:31,771 - Detection - ***** Epoch: 3: Eval results *****
2023-04-24 10:59:31,771 - Detection -   best_eval_score = 43.52
2023-04-24 10:59:31,771 - Detection -   eval_score = 71.16
2023-04-24 10:59:31,771 - Detection -   train_loss = 1.9261180379173972
2023-04-24 10:59:51,387 - Detection - ***** Epoch: 4: Eval results *****
2023-04-24 10:59:51,387 - Detection -   best_eval_score = 71.16
2023-04-24 10:59:51,387 - Detection -   eval_score = 80.37
2023-04-24 10:59:51,387 - Detection -   train_loss = 1.148960221897472
2023-04-24 11:00:11,103 - Detection - ***** Epoch: 5: Eval results *****
2023-04-24 11:00:11,103 - Detection -   best_eval_score = 80.37
2023-04-24 11:00:11,103 - Detection -   eval_score = 83.04
2023-04-24 11:00:11,103 - Detection -   train_loss = 0.7238663760098544
2023-04-24 11:00:30,775 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 11:00:30,775 - Detection -   best_eval_score = 83.04
2023-04-24 11:00:30,775 - Detection -   eval_score = 83.18
2023-04-24 11:00:30,776 - Detection -   train_loss = 0.5751417658545754
2023-04-24 11:00:50,268 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 11:00:50,268 - Detection -   best_eval_score = 83.18
2023-04-24 11:00:50,268 - Detection -   eval_score = 82.11
2023-04-24 11:00:50,268 - Detection -   train_loss = 0.44035561789165845
2023-04-24 11:01:09,887 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 11:01:09,887 - Detection -   best_eval_score = 83.18
2023-04-24 11:01:09,887 - Detection -   eval_score = 81.44
2023-04-24 11:01:09,887 - Detection -   train_loss = 0.31851398944854736
2023-04-24 11:01:29,543 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 11:01:29,543 - Detection -   best_eval_score = 83.18
2023-04-24 11:01:29,543 - Detection -   eval_score = 81.44
2023-04-24 11:01:29,543 - Detection -   train_loss = 0.2359754808924415
2023-04-24 11:01:49,194 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 11:01:49,194 - Detection -   best_eval_score = 83.18
2023-04-24 11:01:49,194 - Detection -   eval_score = 82.24
2023-04-24 11:01:49,194 - Detection -   train_loss = 0.2008393637158654
2023-04-24 11:02:08,917 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 11:02:08,917 - Detection -   best_eval_score = 83.18
2023-04-24 11:02:08,917 - Detection -   eval_score = 82.11
2023-04-24 11:02:08,918 - Detection -   train_loss = 0.1412741562182253
2023-04-24 11:02:28,585 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 11:02:28,585 - Detection -   best_eval_score = 83.18
2023-04-24 11:02:28,585 - Detection -   eval_score = 82.51
2023-04-24 11:02:28,585 - Detection -   train_loss = 0.12639724260026758
2023-04-24 11:02:48,207 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 11:02:48,207 - Detection -   best_eval_score = 83.18
2023-04-24 11:02:48,207 - Detection -   eval_score = 82.24
2023-04-24 11:02:48,207 - Detection -   train_loss = 0.10448001731525768
2023-04-24 11:03:07,763 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 11:03:07,763 - Detection -   best_eval_score = 83.18
2023-04-24 11:03:07,763 - Detection -   eval_score = 83.58
2023-04-24 11:03:07,763 - Detection -   train_loss = 0.09486564621329308
2023-04-24 11:03:27,519 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 11:03:27,519 - Detection -   best_eval_score = 83.58
2023-04-24 11:03:27,519 - Detection -   eval_score = 82.78
2023-04-24 11:03:27,519 - Detection -   train_loss = 0.06834185428240082
2023-04-24 11:03:47,126 - Detection - ***** Epoch: 16: Eval results *****
2023-04-24 11:03:47,126 - Detection -   best_eval_score = 83.58
2023-04-24 11:03:47,126 - Detection -   eval_score = 82.91
2023-04-24 11:03:47,126 - Detection -   train_loss = 0.07285129651427269
2023-04-24 11:04:06,751 - Detection - ***** Epoch: 17: Eval results *****
2023-04-24 11:04:06,751 - Detection -   best_eval_score = 83.58
2023-04-24 11:04:06,751 - Detection -   eval_score = 84.11
2023-04-24 11:04:06,751 - Detection -   train_loss = 0.058310724117539146
2023-04-24 11:04:26,377 - Detection - ***** Epoch: 18: Eval results *****
2023-04-24 11:04:26,377 - Detection -   best_eval_score = 84.11
2023-04-24 11:04:26,377 - Detection -   eval_score = 83.04
2023-04-24 11:04:26,377 - Detection -   train_loss = 0.054494805295359
2023-04-24 11:04:46,088 - Detection - ***** Epoch: 19: Eval results *****
2023-04-24 11:04:46,088 - Detection -   best_eval_score = 84.11
2023-04-24 11:04:46,088 - Detection -   eval_score = 83.71
2023-04-24 11:04:46,088 - Detection -   train_loss = 0.044648091393438255
2023-04-24 11:05:05,749 - Detection - ***** Epoch: 20: Eval results *****
2023-04-24 11:05:05,749 - Detection -   best_eval_score = 84.11
2023-04-24 11:05:05,749 - Detection -   eval_score = 84.11
2023-04-24 11:05:05,749 - Detection -   train_loss = 0.04026087559759617
2023-04-24 11:05:25,380 - Detection - ***** Epoch: 21: Eval results *****
2023-04-24 11:05:25,380 - Detection -   best_eval_score = 84.11
2023-04-24 11:05:25,380 - Detection -   eval_score = 83.18
2023-04-24 11:05:25,380 - Detection -   train_loss = 0.04130088300867514
2023-04-24 11:05:45,037 - Detection - ***** Epoch: 22: Eval results *****
2023-04-24 11:05:45,037 - Detection -   best_eval_score = 84.11
2023-04-24 11:05:45,037 - Detection -   eval_score = 83.58
2023-04-24 11:05:45,037 - Detection -   train_loss = 0.03034811458465728
2023-04-24 11:06:04,662 - Detection - ***** Epoch: 23: Eval results *****
2023-04-24 11:06:04,662 - Detection -   best_eval_score = 84.11
2023-04-24 11:06:04,662 - Detection -   eval_score = 84.11
2023-04-24 11:06:04,662 - Detection -   train_loss = 0.029796800830147484
2023-04-24 11:06:24,459 - Detection - ***** Epoch: 24: Eval results *****
2023-04-24 11:06:24,459 - Detection -   best_eval_score = 84.11
2023-04-24 11:06:24,459 - Detection -   eval_score = 83.85
2023-04-24 11:06:24,459 - Detection -   train_loss = 0.026738698001612316
2023-04-24 11:06:44,151 - Detection - ***** Epoch: 25: Eval results *****
2023-04-24 11:06:44,151 - Detection -   best_eval_score = 84.11
2023-04-24 11:06:44,151 - Detection -   eval_score = 83.18
2023-04-24 11:06:44,151 - Detection -   train_loss = 0.02858989101580598
2023-04-24 11:07:03,790 - Detection - ***** Epoch: 26: Eval results *****
2023-04-24 11:07:03,790 - Detection -   best_eval_score = 84.11
2023-04-24 11:07:03,790 - Detection -   eval_score = 83.31
2023-04-24 11:07:03,790 - Detection -   train_loss = 0.02118207946081053
2023-04-24 11:07:23,382 - Detection - ***** Epoch: 27: Eval results *****
2023-04-24 11:07:23,382 - Detection -   best_eval_score = 84.11
2023-04-24 11:07:23,382 - Detection -   eval_score = 83.31
2023-04-24 11:07:23,382 - Detection -   train_loss = 0.021393839015879414
2023-04-24 11:07:23,383 - Detection - Pre-training finished...
2023-04-24 11:07:23,383 - Detection - Training Begin...
2023-04-24 11:07:26,281 - Detection - ***** Epoch: 1: Eval results *****
2023-04-24 11:07:26,281 - Detection -   best_eval_score = 0
2023-04-24 11:07:26,281 - Detection -   eval_score = 0.0
2023-04-24 11:07:26,281 - Detection -   train_loss = 11.473309603604404
2023-04-24 11:07:28,114 - Detection - ***** Epoch: 2: Eval results *****
2023-04-24 11:07:28,114 - Detection -   best_eval_score = 0
2023-04-24 11:07:28,114 - Detection -   eval_score = 0.0
2023-04-24 11:07:28,114 - Detection -   train_loss = 11.039984269575639
2023-04-24 11:07:29,948 - Detection - ***** Epoch: 3: Eval results *****
2023-04-24 11:07:29,948 - Detection -   best_eval_score = 0
2023-04-24 11:07:29,948 - Detection -   eval_score = 0.0
2023-04-24 11:07:29,948 - Detection -   train_loss = 10.708323912187057
2023-04-24 11:07:31,782 - Detection - ***** Epoch: 4: Eval results *****
2023-04-24 11:07:31,782 - Detection -   best_eval_score = 0
2023-04-24 11:07:31,782 - Detection -   eval_score = 0.0
2023-04-24 11:07:31,782 - Detection -   train_loss = 10.202394485473633
2023-04-24 11:07:33,616 - Detection - ***** Epoch: 5: Eval results *****
2023-04-24 11:07:33,616 - Detection -   best_eval_score = 0
2023-04-24 11:07:33,616 - Detection -   eval_score = 0.0
2023-04-24 11:07:33,616 - Detection -   train_loss = 9.733816233548252
2023-04-24 11:07:35,451 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 11:07:35,451 - Detection -   best_eval_score = 0
2023-04-24 11:07:35,451 - Detection -   eval_score = 0.0
2023-04-24 11:07:35,451 - Detection -   train_loss = 9.13777004588734
2023-04-24 11:07:37,289 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 11:07:37,290 - Detection -   best_eval_score = 0
2023-04-24 11:07:37,290 - Detection -   eval_score = 0.0
2023-04-24 11:07:37,290 - Detection -   train_loss = 8.527342709628018
2023-04-24 11:07:39,131 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 11:07:39,132 - Detection -   best_eval_score = 0
2023-04-24 11:07:39,132 - Detection -   eval_score = 0.92
2023-04-24 11:07:39,132 - Detection -   train_loss = 7.898554628545588
2023-04-24 11:07:58,564 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 11:07:58,564 - Detection -   best_eval_score = 0.92
2023-04-24 11:07:58,564 - Detection -   eval_score = 68.11
2023-04-24 11:07:58,564 - Detection -   train_loss = 7.35183369029652
2023-04-24 11:08:17,997 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 11:08:17,997 - Detection -   best_eval_score = 68.11
2023-04-24 11:08:17,997 - Detection -   eval_score = 71.7
2023-04-24 11:08:17,997 - Detection -   train_loss = 1.9509701186960393
2023-04-24 11:08:37,512 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 11:08:37,512 - Detection -   best_eval_score = 71.7
2023-04-24 11:08:37,512 - Detection -   eval_score = 71.86
2023-04-24 11:08:37,513 - Detection -   train_loss = 1.5727617415514858
2023-04-24 11:08:57,088 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 11:08:57,089 - Detection -   best_eval_score = 71.86
2023-04-24 11:08:57,089 - Detection -   eval_score = 71.78
2023-04-24 11:08:57,089 - Detection -   train_loss = 1.6281838525425305
2023-04-24 11:09:16,555 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 11:09:16,555 - Detection -   best_eval_score = 71.86
2023-04-24 11:09:16,555 - Detection -   eval_score = 71.7
2023-04-24 11:09:16,555 - Detection -   train_loss = 1.6473612243478948
2023-04-24 11:09:36,148 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 11:09:36,148 - Detection -   best_eval_score = 71.86
2023-04-24 11:09:36,148 - Detection -   eval_score = 71.44
2023-04-24 11:09:36,148 - Detection -   train_loss = 1.5748225125399502
2023-04-24 11:09:55,641 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 11:09:55,641 - Detection -   best_eval_score = 71.86
2023-04-24 11:09:55,641 - Detection -   eval_score = 71.69
2023-04-24 11:09:55,641 - Detection -   train_loss = 1.595778389410539
2023-04-24 11:10:15,300 - Detection - ***** Epoch: 16: Eval results *****
2023-04-24 11:10:15,300 - Detection -   best_eval_score = 71.86
2023-04-24 11:10:15,300 - Detection -   eval_score = 71.92
2023-04-24 11:10:15,300 - Detection -   train_loss = 1.6073850176551125
2023-04-24 11:10:35,003 - Detection - ***** Epoch: 17: Eval results *****
2023-04-24 11:10:35,003 - Detection -   best_eval_score = 71.92
2023-04-24 11:10:35,003 - Detection -   eval_score = 71.72
2023-04-24 11:10:35,003 - Detection -   train_loss = 1.6123080903833562
2023-04-24 11:10:54,540 - Detection - ***** Epoch: 18: Eval results *****
2023-04-24 11:10:54,540 - Detection -   best_eval_score = 71.92
2023-04-24 11:10:54,540 - Detection -   eval_score = 71.62
2023-04-24 11:10:54,540 - Detection -   train_loss = 1.6742800907655195
2023-04-24 11:11:14,025 - Detection - ***** Epoch: 19: Eval results *****
2023-04-24 11:11:14,026 - Detection -   best_eval_score = 71.92
2023-04-24 11:11:14,026 - Detection -   eval_score = 71.79
2023-04-24 11:11:14,026 - Detection -   train_loss = 1.597160111774098
2023-04-24 11:11:33,559 - Detection - ***** Epoch: 20: Eval results *****
2023-04-24 11:11:33,560 - Detection -   best_eval_score = 71.92
2023-04-24 11:11:33,560 - Detection -   eval_score = 71.78
2023-04-24 11:11:33,560 - Detection -   train_loss = 1.6342669183557683
2023-04-24 11:11:53,109 - Detection - ***** Epoch: 21: Eval results *****
2023-04-24 11:11:53,109 - Detection -   best_eval_score = 71.92
2023-04-24 11:11:53,109 - Detection -   eval_score = 71.69
2023-04-24 11:11:53,109 - Detection -   train_loss = 1.6123450127514927
2023-04-24 11:12:12,534 - Detection - ***** Epoch: 22: Eval results *****
2023-04-24 11:12:12,534 - Detection -   best_eval_score = 71.92
2023-04-24 11:12:12,534 - Detection -   eval_score = 71.67
2023-04-24 11:12:12,534 - Detection -   train_loss = 1.63181611624631
2023-04-24 11:12:31,927 - Detection - ***** Epoch: 23: Eval results *****
2023-04-24 11:12:31,927 - Detection -   best_eval_score = 71.92
2023-04-24 11:12:31,927 - Detection -   eval_score = 71.61
2023-04-24 11:12:31,927 - Detection -   train_loss = 1.6000768488103694
2023-04-24 11:12:51,421 - Detection - ***** Epoch: 24: Eval results *****
2023-04-24 11:12:51,421 - Detection -   best_eval_score = 71.92
2023-04-24 11:12:51,421 - Detection -   eval_score = 71.65
2023-04-24 11:12:51,421 - Detection -   train_loss = 1.5684451406652278
2023-04-24 11:13:11,087 - Detection - ***** Epoch: 25: Eval results *****
2023-04-24 11:13:11,087 - Detection -   best_eval_score = 71.92
2023-04-24 11:13:11,087 - Detection -   eval_score = 71.7
2023-04-24 11:13:11,087 - Detection -   train_loss = 1.6530556787144055
2023-04-24 11:13:30,567 - Detection - ***** Epoch: 26: Eval results *****
2023-04-24 11:13:30,567 - Detection -   best_eval_score = 71.92
2023-04-24 11:13:30,567 - Detection -   eval_score = 71.78
2023-04-24 11:13:30,567 - Detection -   train_loss = 1.6241723949258977
2023-04-24 11:13:30,567 - Detection - Training Finished...
2023-04-24 11:13:30,567 - Detection - Testing begin...
2023-04-24 11:13:32,966 - Detection - ***** Test: Confusion Matrix *****
2023-04-24 11:13:32,966 - Detection - [[  76    0    0    0    0    0    3    0    0    0   45]
 [   1   73    0    0    0    0    2    0    0    2   61]
 [   0    1   95    1    1    0    0    0    0    0   72]
 [   0    0    2   99    1    0    0    0    0    1   46]
 [   0    0    0    0   96    0    0    0    0    0   32]
 [   0    0    0    0    0  103    0    3    0    0   45]
 [   2    0    0    0    0    0   82    0    0    0   38]
 [   0    0    0    0    0    2    1   75    0    0   50]
 [   0    0    0    0    0    0    0    0   85    1   85]
 [   1    1    1    1    1    0    0    0    1  116   71]
 [  25   10   29    1    9    6   21    1    7   99 1222]]
2023-04-24 11:13:32,966 - Detection - ***** Test results *****
2023-04-24 11:13:32,966 - Detection -   Acc = 73.05
2023-04-24 11:13:32,967 - Detection -   F1 = 70.4549
2023-04-24 11:13:32,967 - Detection -   F1-known = 69.8558
2023-04-24 11:13:32,967 - Detection -   F1-open = 76.4467
2023-04-24 11:13:32,967 - Detection - Testing finished...
2023-04-24 11:13:32,967 - Detection - Results saved in results/results_ADB-BOOST-F-10.csv
2023-04-24 11:13:32,985 - Detection - Open Intent Detection Finished...
