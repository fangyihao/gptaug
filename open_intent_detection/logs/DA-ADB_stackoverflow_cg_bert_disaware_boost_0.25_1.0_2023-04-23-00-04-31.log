2023-04-23 00:04:31,186 - Detection - Open Intent Detection Begin...
2023-04-23 00:04:31,186 - Detection - Parameters Initialization...
2023-04-23 00:04:31,186 - Detection - ============================== Params ==============================
2023-04-23 00:04:31,186 - Detection - type:	open_intent_detection
2023-04-23 00:04:31,186 - Detection - logger_name:	Detection
2023-04-23 00:04:31,186 - Detection - log_dir:	logs
2023-04-23 00:04:31,186 - Detection - dataset:	stackoverflow_cg
2023-04-23 00:04:31,186 - Detection - known_cls_ratio:	0.25
2023-04-23 00:04:31,186 - Detection - labeled_ratio:	1.0
2023-04-23 00:04:31,186 - Detection - method:	DA-ADB
2023-04-23 00:04:31,186 - Detection - train:	True
2023-04-23 00:04:31,186 - Detection - pretrain:	True
2023-04-23 00:04:31,186 - Detection - save_model:	False
2023-04-23 00:04:31,186 - Detection - backbone:	bert_disaware_boost
2023-04-23 00:04:31,186 - Detection - config_file_name:	DA-ADB
2023-04-23 00:04:31,186 - Detection - seed:	7
2023-04-23 00:04:31,186 - Detection - gpu_id:	0
2023-04-23 00:04:31,186 - Detection - pipe_results_path:	pipe_results
2023-04-23 00:04:31,186 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-23 00:04:31,186 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-23 00:04:31,186 - Detection - model_dir:	models
2023-04-23 00:04:31,186 - Detection - load_pretrained_method:	None
2023-04-23 00:04:31,186 - Detection - result_dir:	results
2023-04-23 00:04:31,186 - Detection - results_file_name:	results_DA-ADB-BOOST-F-4.csv
2023-04-23 00:04:31,186 - Detection - save_results:	True
2023-04-23 00:04:31,186 - Detection - loss_fct:	CrossEntropyLoss
2023-04-23 00:04:31,187 - Detection - boost_method:	F-4
2023-04-23 00:04:31,187 - Detection - boost_start_score:	0.0
2023-04-23 00:04:31,187 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.25_1.0_bert_disaware_boost_7
2023-04-23 00:04:31,187 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.25_1.0_bert_disaware_boost_7/models
2023-04-23 00:04:31,187 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-23 00:04:31,187 - Detection - num_train_epochs:	100
2023-04-23 00:04:31,187 - Detection - num_labels:	None
2023-04-23 00:04:31,187 - Detection - max_seq_length:	None
2023-04-23 00:04:31,187 - Detection - freeze_backbone_parameters:	True
2023-04-23 00:04:31,187 - Detection - feat_dim:	768
2023-04-23 00:04:31,187 - Detection - warmup_proportion:	0.1
2023-04-23 00:04:31,187 - Detection - scale:	4
2023-04-23 00:04:31,187 - Detection - lr_boundary:	0.05
2023-04-23 00:04:31,187 - Detection - lr:	2e-05
2023-04-23 00:04:31,187 - Detection - activation:	relu
2023-04-23 00:04:31,187 - Detection - train_batch_size:	128
2023-04-23 00:04:31,187 - Detection - eval_batch_size:	64
2023-04-23 00:04:31,187 - Detection - test_batch_size:	64
2023-04-23 00:04:31,187 - Detection - wait_patient:	10
2023-04-23 00:04:31,187 - Detection - ============================== End Params ==============================
2023-04-23 00:04:31,187 - Detection - Data and Model Preparation...
2023-04-23 00:04:31,187 - Detection - The number of known intents is 5
2023-04-23 00:04:31,187 - Detection - Lists of known labels are: ['apache', 'svn', 'bash', 'excel', 'oracle']
2023-04-23 00:04:31,194 - Detection - Number of labeled training samples = 593
2023-04-23 00:04:31,194 - Detection - Number of unlabeled training samples = 2198
2023-04-23 00:04:31,197 - Detection - Number of evaluation samples = 368
2023-04-23 00:04:31,202 - Detection - Number of testing samples = 2905
2023-04-23 00:04:36,699 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-23 00:04:36,812 - Detection - Pre-training Begin...
2023-04-23 00:04:38,540 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 00:04:38,540 - Detection -   best_eval_score = 0
2023-04-23 00:04:38,540 - Detection -   eval_score = 7.07
2023-04-23 00:04:38,540 - Detection -   train_loss = 1.623486089706421
2023-04-23 00:04:42,592 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 00:04:42,592 - Detection -   best_eval_score = 7.07
2023-04-23 00:04:42,592 - Detection -   eval_score = 7.16
2023-04-23 00:04:42,592 - Detection -   train_loss = 1.614588975906372
2023-04-23 00:04:46,726 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 00:04:46,726 - Detection -   best_eval_score = 7.16
2023-04-23 00:04:46,726 - Detection -   eval_score = 19.2
2023-04-23 00:04:46,726 - Detection -   train_loss = 1.5845691204071044
2023-04-23 00:04:50,755 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 00:04:50,755 - Detection -   best_eval_score = 19.2
2023-04-23 00:04:50,755 - Detection -   eval_score = 53.14
2023-04-23 00:04:50,755 - Detection -   train_loss = 1.535910415649414
2023-04-23 00:04:54,784 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 00:04:54,784 - Detection -   best_eval_score = 53.14
2023-04-23 00:04:54,784 - Detection -   eval_score = 81.19
2023-04-23 00:04:54,784 - Detection -   train_loss = 1.4162988901138305
2023-04-23 00:04:58,832 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 00:04:58,833 - Detection -   best_eval_score = 81.19
2023-04-23 00:04:58,833 - Detection -   eval_score = 84.43
2023-04-23 00:04:58,833 - Detection -   train_loss = 1.15444016456604
2023-04-23 00:05:02,920 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 00:05:02,920 - Detection -   best_eval_score = 84.43
2023-04-23 00:05:02,920 - Detection -   eval_score = 84.22
2023-04-23 00:05:02,920 - Detection -   train_loss = 0.8182538628578186
2023-04-23 00:05:06,959 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 00:05:06,959 - Detection -   best_eval_score = 84.43
2023-04-23 00:05:06,959 - Detection -   eval_score = 86.22
2023-04-23 00:05:06,959 - Detection -   train_loss = 0.6516429305076599
2023-04-23 00:05:10,974 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 00:05:10,974 - Detection -   best_eval_score = 86.22
2023-04-23 00:05:10,974 - Detection -   eval_score = 88.52
2023-04-23 00:05:10,974 - Detection -   train_loss = 0.563957929611206
2023-04-23 00:05:15,024 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 00:05:15,024 - Detection -   best_eval_score = 88.52
2023-04-23 00:05:15,024 - Detection -   eval_score = 87.95
2023-04-23 00:05:15,024 - Detection -   train_loss = 0.4582678020000458
2023-04-23 00:05:19,050 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 00:05:19,050 - Detection -   best_eval_score = 88.52
2023-04-23 00:05:19,050 - Detection -   eval_score = 87.06
2023-04-23 00:05:19,050 - Detection -   train_loss = 0.409319132566452
2023-04-23 00:05:23,197 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 00:05:23,197 - Detection -   best_eval_score = 88.52
2023-04-23 00:05:23,197 - Detection -   eval_score = 87.18
2023-04-23 00:05:23,197 - Detection -   train_loss = 0.3512330651283264
2023-04-23 00:05:27,221 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 00:05:27,221 - Detection -   best_eval_score = 88.52
2023-04-23 00:05:27,221 - Detection -   eval_score = 87.33
2023-04-23 00:05:27,221 - Detection -   train_loss = 0.3379277318716049
2023-04-23 00:05:31,249 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 00:05:31,249 - Detection -   best_eval_score = 88.52
2023-04-23 00:05:31,249 - Detection -   eval_score = 88.93
2023-04-23 00:05:31,249 - Detection -   train_loss = 0.27618802785873414
2023-04-23 00:05:35,317 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 00:05:35,317 - Detection -   best_eval_score = 88.93
2023-04-23 00:05:35,317 - Detection -   eval_score = 89.07
2023-04-23 00:05:35,317 - Detection -   train_loss = 0.2604139447212219
2023-04-23 00:05:40,423 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 00:05:40,423 - Detection -   best_eval_score = 89.07
2023-04-23 00:05:40,423 - Detection -   eval_score = 88.32
2023-04-23 00:05:40,423 - Detection -   train_loss = 0.22906128466129302
2023-04-23 00:05:44,592 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 00:05:44,592 - Detection -   best_eval_score = 89.07
2023-04-23 00:05:44,592 - Detection -   eval_score = 88.26
2023-04-23 00:05:44,592 - Detection -   train_loss = 0.20513055622577667
2023-04-23 00:05:48,654 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 00:05:48,654 - Detection -   best_eval_score = 89.07
2023-04-23 00:05:48,654 - Detection -   eval_score = 88.26
2023-04-23 00:05:48,654 - Detection -   train_loss = 0.19041399359703065
2023-04-23 00:05:52,688 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 00:05:52,689 - Detection -   best_eval_score = 89.07
2023-04-23 00:05:52,689 - Detection -   eval_score = 89.61
2023-04-23 00:05:52,689 - Detection -   train_loss = 0.19043910801410674
2023-04-23 00:05:56,730 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 00:05:56,731 - Detection -   best_eval_score = 89.61
2023-04-23 00:05:56,731 - Detection -   eval_score = 86.97
2023-04-23 00:05:56,731 - Detection -   train_loss = 0.18580852150917054
2023-04-23 00:06:00,744 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 00:06:00,744 - Detection -   best_eval_score = 89.61
2023-04-23 00:06:00,744 - Detection -   eval_score = 88.25
2023-04-23 00:06:00,744 - Detection -   train_loss = 0.1667640119791031
2023-04-23 00:06:04,881 - Detection - ***** Epoch: 22: Eval results *****
2023-04-23 00:06:04,881 - Detection -   best_eval_score = 89.61
2023-04-23 00:06:04,881 - Detection -   eval_score = 88.47
2023-04-23 00:06:04,881 - Detection -   train_loss = 0.1525413691997528
2023-04-23 00:06:08,900 - Detection - ***** Epoch: 23: Eval results *****
2023-04-23 00:06:08,900 - Detection -   best_eval_score = 89.61
2023-04-23 00:06:08,900 - Detection -   eval_score = 88.79
2023-04-23 00:06:08,901 - Detection -   train_loss = 0.15328828990459442
2023-04-23 00:06:12,940 - Detection - ***** Epoch: 24: Eval results *****
2023-04-23 00:06:12,940 - Detection -   best_eval_score = 89.61
2023-04-23 00:06:12,940 - Detection -   eval_score = 88.78
2023-04-23 00:06:12,940 - Detection -   train_loss = 0.14603058099746705
2023-04-23 00:06:16,986 - Detection - ***** Epoch: 25: Eval results *****
2023-04-23 00:06:16,986 - Detection -   best_eval_score = 89.61
2023-04-23 00:06:16,986 - Detection -   eval_score = 89.58
2023-04-23 00:06:16,986 - Detection -   train_loss = 0.13846830129623414
2023-04-23 00:06:21,013 - Detection - ***** Epoch: 26: Eval results *****
2023-04-23 00:06:21,013 - Detection -   best_eval_score = 89.61
2023-04-23 00:06:21,013 - Detection -   eval_score = 89.37
2023-04-23 00:06:21,013 - Detection -   train_loss = 0.133782459795475
2023-04-23 00:06:25,046 - Detection - ***** Epoch: 27: Eval results *****
2023-04-23 00:06:25,046 - Detection -   best_eval_score = 89.61
2023-04-23 00:06:25,046 - Detection -   eval_score = 88.5
2023-04-23 00:06:25,046 - Detection -   train_loss = 0.1279219150543213
2023-04-23 00:06:29,191 - Detection - ***** Epoch: 28: Eval results *****
2023-04-23 00:06:29,191 - Detection -   best_eval_score = 89.61
2023-04-23 00:06:29,191 - Detection -   eval_score = 87.71
2023-04-23 00:06:29,191 - Detection -   train_loss = 0.1280474454164505
2023-04-23 00:06:33,214 - Detection - ***** Epoch: 29: Eval results *****
2023-04-23 00:06:33,214 - Detection -   best_eval_score = 89.61
2023-04-23 00:06:33,214 - Detection -   eval_score = 88.5
2023-04-23 00:06:33,214 - Detection -   train_loss = 0.13816014528274537
2023-04-23 00:06:33,215 - Detection - Pre-training finished...
2023-04-23 00:06:33,215 - Detection - Training Begin...
2023-04-23 00:06:33,841 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 00:06:33,841 - Detection -   best_eval_score = 0
2023-04-23 00:06:33,841 - Detection -   eval_score = 0.0
2023-04-23 00:06:33,841 - Detection -   train_loss = 5.327076816558838
2023-04-23 00:06:34,465 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 00:06:34,465 - Detection -   best_eval_score = 0
2023-04-23 00:06:34,465 - Detection -   eval_score = 0.0
2023-04-23 00:06:34,465 - Detection -   train_loss = 5.1584446907043455
2023-04-23 00:06:35,091 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 00:06:35,091 - Detection -   best_eval_score = 0
2023-04-23 00:06:35,091 - Detection -   eval_score = 0.0
2023-04-23 00:06:35,091 - Detection -   train_loss = 5.118253517150879
2023-04-23 00:06:35,716 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 00:06:35,716 - Detection -   best_eval_score = 0
2023-04-23 00:06:35,716 - Detection -   eval_score = 0.0
2023-04-23 00:06:35,717 - Detection -   train_loss = 4.935458374023438
2023-04-23 00:06:36,343 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 00:06:36,343 - Detection -   best_eval_score = 0
2023-04-23 00:06:36,343 - Detection -   eval_score = 0.0
2023-04-23 00:06:36,343 - Detection -   train_loss = 4.818915748596192
2023-04-23 00:06:36,969 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 00:06:36,969 - Detection -   best_eval_score = 0
2023-04-23 00:06:36,969 - Detection -   eval_score = 0.0
2023-04-23 00:06:36,969 - Detection -   train_loss = 4.669140338897705
2023-04-23 00:06:37,595 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 00:06:37,595 - Detection -   best_eval_score = 0
2023-04-23 00:06:37,595 - Detection -   eval_score = 0.0
2023-04-23 00:06:37,595 - Detection -   train_loss = 4.458630084991455
2023-04-23 00:06:38,222 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 00:06:38,222 - Detection -   best_eval_score = 0
2023-04-23 00:06:38,222 - Detection -   eval_score = 0.0
2023-04-23 00:06:38,222 - Detection -   train_loss = 4.175184440612793
2023-04-23 00:06:38,847 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 00:06:38,848 - Detection -   best_eval_score = 0
2023-04-23 00:06:38,848 - Detection -   eval_score = 2.47
2023-04-23 00:06:38,848 - Detection -   train_loss = 4.0188579082489015
2023-04-23 00:06:42,530 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 00:06:42,531 - Detection -   best_eval_score = 2.47
2023-04-23 00:06:42,531 - Detection -   eval_score = 30.82
2023-04-23 00:06:42,531 - Detection -   train_loss = 3.740242767333984
2023-04-23 00:06:46,198 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 00:06:46,198 - Detection -   best_eval_score = 30.82
2023-04-23 00:06:46,198 - Detection -   eval_score = 62.48
2023-04-23 00:06:46,198 - Detection -   train_loss = 2.403454542160034
2023-04-23 00:06:49,840 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 00:06:49,840 - Detection -   best_eval_score = 62.48
2023-04-23 00:06:49,840 - Detection -   eval_score = 69.01
2023-04-23 00:06:49,840 - Detection -   train_loss = 1.277448344230652
2023-04-23 00:06:53,507 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 00:06:53,508 - Detection -   best_eval_score = 69.01
2023-04-23 00:06:53,508 - Detection -   eval_score = 68.64
2023-04-23 00:06:53,508 - Detection -   train_loss = 0.9945114731788636
2023-04-23 00:06:57,269 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 00:06:57,269 - Detection -   best_eval_score = 69.01
2023-04-23 00:06:57,269 - Detection -   eval_score = 68.64
2023-04-23 00:06:57,270 - Detection -   train_loss = 1.013728952407837
2023-04-23 00:07:00,919 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 00:07:00,919 - Detection -   best_eval_score = 69.01
2023-04-23 00:07:00,919 - Detection -   eval_score = 68.64
2023-04-23 00:07:00,919 - Detection -   train_loss = 1.0466809391975402
2023-04-23 00:07:04,651 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 00:07:04,651 - Detection -   best_eval_score = 69.01
2023-04-23 00:07:04,651 - Detection -   eval_score = 68.64
2023-04-23 00:07:04,651 - Detection -   train_loss = 1.036008083820343
2023-04-23 00:07:08,285 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 00:07:08,285 - Detection -   best_eval_score = 69.01
2023-04-23 00:07:08,285 - Detection -   eval_score = 68.83
2023-04-23 00:07:08,285 - Detection -   train_loss = 0.9992791414260864
2023-04-23 00:07:11,935 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 00:07:11,935 - Detection -   best_eval_score = 69.01
2023-04-23 00:07:11,935 - Detection -   eval_score = 68.64
2023-04-23 00:07:11,935 - Detection -   train_loss = 1.0014132261276245
2023-04-23 00:07:15,714 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 00:07:15,714 - Detection -   best_eval_score = 69.01
2023-04-23 00:07:15,714 - Detection -   eval_score = 69.01
2023-04-23 00:07:15,714 - Detection -   train_loss = 1.0225958466529845
2023-04-23 00:07:19,378 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 00:07:19,379 - Detection -   best_eval_score = 69.01
2023-04-23 00:07:19,379 - Detection -   eval_score = 68.64
2023-04-23 00:07:19,379 - Detection -   train_loss = 0.9980934500694275
2023-04-23 00:07:23,013 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 00:07:23,014 - Detection -   best_eval_score = 69.01
2023-04-23 00:07:23,014 - Detection -   eval_score = 68.45
2023-04-23 00:07:23,014 - Detection -   train_loss = 1.0132756114006043
2023-04-23 00:07:26,658 - Detection - ***** Epoch: 22: Eval results *****
2023-04-23 00:07:26,658 - Detection -   best_eval_score = 69.01
2023-04-23 00:07:26,658 - Detection -   eval_score = 69.01
2023-04-23 00:07:26,658 - Detection -   train_loss = 0.9990578055381775
2023-04-23 00:07:26,658 - Detection - Training Finished...
2023-04-23 00:07:26,658 - Detection - Testing begin...
2023-04-23 00:07:28,402 - Detection - ***** Test: Confusion Matrix *****
2023-04-23 00:07:28,403 - Detection - [[  99    1    0    0    0   70]
 [   4  108    0    0    1   36]
 [   3    0   63    0    1   72]
 [   0    0    0   95    2   43]
 [   1    0    1    0   98   27]
 [  92   12  129   37   47 1863]]
2023-04-23 00:07:28,403 - Detection - ***** Test results *****
2023-04-23 00:07:28,403 - Detection -   Acc = 80.07
2023-04-23 00:07:28,403 - Detection -   F1 = 66.5518
2023-04-23 00:07:28,403 - Detection -   F1-known = 62.4956
2023-04-23 00:07:28,403 - Detection -   F1-open = 86.8329
2023-04-23 00:07:28,403 - Detection - Testing finished...
2023-04-23 00:07:28,403 - Detection - Results saved in results/results_DA-ADB-BOOST-F-4.csv
2023-04-23 00:07:28,422 - Detection - Open Intent Detection Finished...
