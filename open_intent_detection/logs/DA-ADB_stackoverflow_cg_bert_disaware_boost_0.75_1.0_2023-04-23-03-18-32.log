2023-04-23 03:18:32,547 - Detection - Open Intent Detection Begin...
2023-04-23 03:18:32,547 - Detection - Parameters Initialization...
2023-04-23 03:18:32,547 - Detection - ============================== Params ==============================
2023-04-23 03:18:32,547 - Detection - type:	open_intent_detection
2023-04-23 03:18:32,547 - Detection - logger_name:	Detection
2023-04-23 03:18:32,547 - Detection - log_dir:	logs
2023-04-23 03:18:32,547 - Detection - dataset:	stackoverflow_cg
2023-04-23 03:18:32,547 - Detection - known_cls_ratio:	0.75
2023-04-23 03:18:32,547 - Detection - labeled_ratio:	1.0
2023-04-23 03:18:32,547 - Detection - method:	DA-ADB
2023-04-23 03:18:32,547 - Detection - train:	True
2023-04-23 03:18:32,547 - Detection - pretrain:	True
2023-04-23 03:18:32,547 - Detection - save_model:	False
2023-04-23 03:18:32,547 - Detection - backbone:	bert_disaware_boost
2023-04-23 03:18:32,547 - Detection - config_file_name:	DA-ADB
2023-04-23 03:18:32,547 - Detection - seed:	9
2023-04-23 03:18:32,547 - Detection - gpu_id:	0
2023-04-23 03:18:32,548 - Detection - pipe_results_path:	pipe_results
2023-04-23 03:18:32,548 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-23 03:18:32,548 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-23 03:18:32,548 - Detection - model_dir:	models
2023-04-23 03:18:32,548 - Detection - load_pretrained_method:	None
2023-04-23 03:18:32,548 - Detection - result_dir:	results
2023-04-23 03:18:32,548 - Detection - results_file_name:	results_DA-ADB-BOOST-F-4.csv
2023-04-23 03:18:32,548 - Detection - save_results:	True
2023-04-23 03:18:32,548 - Detection - loss_fct:	CrossEntropyLoss
2023-04-23 03:18:32,548 - Detection - boost_method:	F-4
2023-04-23 03:18:32,548 - Detection - boost_start_score:	0.0
2023-04-23 03:18:32,548 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.75_1.0_bert_disaware_boost_9
2023-04-23 03:18:32,548 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.75_1.0_bert_disaware_boost_9/models
2023-04-23 03:18:32,548 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-23 03:18:32,548 - Detection - num_train_epochs:	100
2023-04-23 03:18:32,548 - Detection - num_labels:	None
2023-04-23 03:18:32,548 - Detection - max_seq_length:	None
2023-04-23 03:18:32,548 - Detection - freeze_backbone_parameters:	True
2023-04-23 03:18:32,548 - Detection - feat_dim:	768
2023-04-23 03:18:32,548 - Detection - warmup_proportion:	0.1
2023-04-23 03:18:32,548 - Detection - scale:	4
2023-04-23 03:18:32,548 - Detection - lr_boundary:	0.05
2023-04-23 03:18:32,548 - Detection - lr:	2e-05
2023-04-23 03:18:32,548 - Detection - activation:	relu
2023-04-23 03:18:32,548 - Detection - train_batch_size:	128
2023-04-23 03:18:32,548 - Detection - eval_batch_size:	64
2023-04-23 03:18:32,548 - Detection - test_batch_size:	64
2023-04-23 03:18:32,548 - Detection - wait_patient:	10
2023-04-23 03:18:32,548 - Detection - ============================== End Params ==============================
2023-04-23 03:18:32,548 - Detection - Data and Model Preparation...
2023-04-23 03:18:32,548 - Detection - The number of known intents is 15
2023-04-23 03:18:32,549 - Detection - Lists of known labels are: ['cocoa', 'haskell', 'hibernate', 'excel', 'spring', 'sharepoint', 'bash', 'drupal', 'magento', 'matlab', 'visual-studio', 'oracle', 'scala', 'ajax', 'osx']
2023-04-23 03:18:32,558 - Detection - Number of labeled training samples = 2125
2023-04-23 03:18:32,558 - Detection - Number of unlabeled training samples = 666
2023-04-23 03:18:32,560 - Detection - Number of evaluation samples = 1048
2023-04-23 03:18:32,566 - Detection - Number of testing samples = 2905
2023-04-23 03:18:38,192 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-23 03:18:38,307 - Detection - Pre-training Begin...
2023-04-23 03:18:42,392 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 03:18:42,393 - Detection -   best_eval_score = 0
2023-04-23 03:18:42,393 - Detection -   eval_score = 1.55
2023-04-23 03:18:42,393 - Detection -   train_loss = 2.721179317025577
2023-04-23 03:18:55,668 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 03:18:55,668 - Detection -   best_eval_score = 1.55
2023-04-23 03:18:55,668 - Detection -   eval_score = 0.79
2023-04-23 03:18:55,668 - Detection -   train_loss = 2.697029380237355
2023-04-23 03:19:08,828 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 03:19:08,828 - Detection -   best_eval_score = 1.55
2023-04-23 03:19:08,828 - Detection -   eval_score = 3.27
2023-04-23 03:19:08,828 - Detection -   train_loss = 2.6447176512549904
2023-04-23 03:19:22,141 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 03:19:22,141 - Detection -   best_eval_score = 3.27
2023-04-23 03:19:22,141 - Detection -   eval_score = 32.58
2023-04-23 03:19:22,141 - Detection -   train_loss = 2.5384092611425064
2023-04-23 03:19:35,423 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 03:19:35,423 - Detection -   best_eval_score = 32.58
2023-04-23 03:19:35,423 - Detection -   eval_score = 73.05
2023-04-23 03:19:35,423 - Detection -   train_loss = 2.2600092747632194
2023-04-23 03:19:48,671 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 03:19:48,671 - Detection -   best_eval_score = 73.05
2023-04-23 03:19:48,671 - Detection -   eval_score = 77.38
2023-04-23 03:19:48,671 - Detection -   train_loss = 1.7840904838898604
2023-04-23 03:20:02,043 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 03:20:02,043 - Detection -   best_eval_score = 77.38
2023-04-23 03:20:02,043 - Detection -   eval_score = 79.66
2023-04-23 03:20:02,043 - Detection -   train_loss = 1.4650224938112146
2023-04-23 03:20:15,273 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 03:20:15,273 - Detection -   best_eval_score = 79.66
2023-04-23 03:20:15,273 - Detection -   eval_score = 79.63
2023-04-23 03:20:15,273 - Detection -   train_loss = 1.3094086296418135
2023-04-23 03:20:28,607 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 03:20:28,607 - Detection -   best_eval_score = 79.66
2023-04-23 03:20:28,607 - Detection -   eval_score = 79.74
2023-04-23 03:20:28,607 - Detection -   train_loss = 1.1968937901889576
2023-04-23 03:20:41,981 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 03:20:41,981 - Detection -   best_eval_score = 79.74
2023-04-23 03:20:41,981 - Detection -   eval_score = 80.51
2023-04-23 03:20:41,981 - Detection -   train_loss = 1.1211248145383947
2023-04-23 03:20:55,286 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 03:20:55,287 - Detection -   best_eval_score = 80.51
2023-04-23 03:20:55,287 - Detection -   eval_score = 80.31
2023-04-23 03:20:55,287 - Detection -   train_loss = 1.0426342978196985
2023-04-23 03:21:08,710 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 03:21:08,710 - Detection -   best_eval_score = 80.51
2023-04-23 03:21:08,710 - Detection -   eval_score = 80.31
2023-04-23 03:21:08,710 - Detection -   train_loss = 0.9665545891312992
2023-04-23 03:21:22,059 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 03:21:22,059 - Detection -   best_eval_score = 80.51
2023-04-23 03:21:22,059 - Detection -   eval_score = 81.17
2023-04-23 03:21:22,059 - Detection -   train_loss = 0.9315884428865769
2023-04-23 03:21:35,323 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 03:21:35,323 - Detection -   best_eval_score = 81.17
2023-04-23 03:21:35,323 - Detection -   eval_score = 80.5
2023-04-23 03:21:35,323 - Detection -   train_loss = 0.8609456209575429
2023-04-23 03:21:48,670 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 03:21:48,670 - Detection -   best_eval_score = 81.17
2023-04-23 03:21:48,670 - Detection -   eval_score = 80.44
2023-04-23 03:21:48,670 - Detection -   train_loss = 0.8150774696293999
2023-04-23 03:22:01,941 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 03:22:01,941 - Detection -   best_eval_score = 81.17
2023-04-23 03:22:01,941 - Detection -   eval_score = 80.0
2023-04-23 03:22:01,942 - Detection -   train_loss = 0.7763235569000244
2023-04-23 03:22:15,319 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 03:22:15,319 - Detection -   best_eval_score = 81.17
2023-04-23 03:22:15,319 - Detection -   eval_score = 79.56
2023-04-23 03:22:15,319 - Detection -   train_loss = 0.740257154492771
2023-04-23 03:22:28,659 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 03:22:28,660 - Detection -   best_eval_score = 81.17
2023-04-23 03:22:28,660 - Detection -   eval_score = 79.73
2023-04-23 03:22:28,660 - Detection -   train_loss = 0.7091601000112646
2023-04-23 03:22:41,909 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 03:22:41,909 - Detection -   best_eval_score = 81.17
2023-04-23 03:22:41,909 - Detection -   eval_score = 80.13
2023-04-23 03:22:41,909 - Detection -   train_loss = 0.6766583113109365
2023-04-23 03:22:55,327 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 03:22:55,327 - Detection -   best_eval_score = 81.17
2023-04-23 03:22:55,327 - Detection -   eval_score = 79.52
2023-04-23 03:22:55,327 - Detection -   train_loss = 0.6452624587451711
2023-04-23 03:23:08,593 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 03:23:08,593 - Detection -   best_eval_score = 81.17
2023-04-23 03:23:08,594 - Detection -   eval_score = 80.15
2023-04-23 03:23:08,594 - Detection -   train_loss = 0.6212243087151471
2023-04-23 03:23:22,010 - Detection - ***** Epoch: 22: Eval results *****
2023-04-23 03:23:22,011 - Detection -   best_eval_score = 81.17
2023-04-23 03:23:22,011 - Detection -   eval_score = 80.69
2023-04-23 03:23:22,011 - Detection -   train_loss = 0.601089242626639
2023-04-23 03:23:35,294 - Detection - ***** Epoch: 23: Eval results *****
2023-04-23 03:23:35,295 - Detection -   best_eval_score = 81.17
2023-04-23 03:23:35,295 - Detection -   eval_score = 80.91
2023-04-23 03:23:35,295 - Detection -   train_loss = 0.5689951479434967
2023-04-23 03:23:35,295 - Detection - Pre-training finished...
2023-04-23 03:23:35,295 - Detection - Training Begin...
2023-04-23 03:23:37,359 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 03:23:37,359 - Detection -   best_eval_score = 0
2023-04-23 03:23:37,359 - Detection -   eval_score = 0.0
2023-04-23 03:23:37,359 - Detection -   train_loss = 4.6951030001920815
2023-04-23 03:23:39,426 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 03:23:39,426 - Detection -   best_eval_score = 0
2023-04-23 03:23:39,426 - Detection -   eval_score = 0.18
2023-04-23 03:23:39,426 - Detection -   train_loss = 4.1488971569958855
2023-04-23 03:23:51,387 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 03:23:51,387 - Detection -   best_eval_score = 0.18
2023-04-23 03:23:51,387 - Detection -   eval_score = 73.14
2023-04-23 03:23:51,387 - Detection -   train_loss = 3.4331231537987206
2023-04-23 03:24:03,349 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 03:24:03,349 - Detection -   best_eval_score = 73.14
2023-04-23 03:24:03,349 - Detection -   eval_score = 73.64
2023-04-23 03:24:03,349 - Detection -   train_loss = 1.0287850183599136
2023-04-23 03:24:15,192 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 03:24:15,192 - Detection -   best_eval_score = 73.64
2023-04-23 03:24:15,192 - Detection -   eval_score = 73.81
2023-04-23 03:24:15,192 - Detection -   train_loss = 1.033118272528929
2023-04-23 03:24:27,130 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 03:24:27,130 - Detection -   best_eval_score = 73.81
2023-04-23 03:24:27,130 - Detection -   eval_score = 73.81
2023-04-23 03:24:27,130 - Detection -   train_loss = 1.006825163083918
2023-04-23 03:24:38,941 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 03:24:38,941 - Detection -   best_eval_score = 73.81
2023-04-23 03:24:38,941 - Detection -   eval_score = 73.75
2023-04-23 03:24:38,941 - Detection -   train_loss = 1.0155246888889986
2023-04-23 03:24:50,859 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 03:24:50,859 - Detection -   best_eval_score = 73.81
2023-04-23 03:24:50,859 - Detection -   eval_score = 72.88
2023-04-23 03:24:50,859 - Detection -   train_loss = 1.0228388905525208
2023-04-23 03:25:02,651 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 03:25:02,652 - Detection -   best_eval_score = 73.81
2023-04-23 03:25:02,652 - Detection -   eval_score = 73.31
2023-04-23 03:25:02,652 - Detection -   train_loss = 1.0319110610905815
2023-04-23 03:25:14,594 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 03:25:14,594 - Detection -   best_eval_score = 73.81
2023-04-23 03:25:14,594 - Detection -   eval_score = 73.37
2023-04-23 03:25:14,594 - Detection -   train_loss = 1.0356714585248161
2023-04-23 03:25:26,408 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 03:25:26,408 - Detection -   best_eval_score = 73.81
2023-04-23 03:25:26,409 - Detection -   eval_score = 73.5
2023-04-23 03:25:26,409 - Detection -   train_loss = 1.0252917934866512
2023-04-23 03:25:38,310 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 03:25:38,310 - Detection -   best_eval_score = 73.81
2023-04-23 03:25:38,310 - Detection -   eval_score = 73.61
2023-04-23 03:25:38,310 - Detection -   train_loss = 1.0253209997625912
2023-04-23 03:25:50,232 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 03:25:50,232 - Detection -   best_eval_score = 73.81
2023-04-23 03:25:50,232 - Detection -   eval_score = 73.75
2023-04-23 03:25:50,232 - Detection -   train_loss = 1.0142112619736616
2023-04-23 03:26:02,013 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 03:26:02,013 - Detection -   best_eval_score = 73.81
2023-04-23 03:26:02,013 - Detection -   eval_score = 73.47
2023-04-23 03:26:02,013 - Detection -   train_loss = 1.0201238814522238
2023-04-23 03:26:13,931 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 03:26:13,931 - Detection -   best_eval_score = 73.81
2023-04-23 03:26:13,931 - Detection -   eval_score = 73.31
2023-04-23 03:26:13,931 - Detection -   train_loss = 1.0194163918495178
2023-04-23 03:26:13,931 - Detection - Training Finished...
2023-04-23 03:26:13,931 - Detection - Testing begin...
2023-04-23 03:26:15,686 - Detection - ***** Test: Confusion Matrix *****
2023-04-23 03:26:15,686 - Detection - [[ 65   0   0   0   0   0   1   1   0   0   0   1   0   0  20  73]
 [  0  85   0   0   0   0   0   0   0   0   0   0   1   0   6  30]
 [  2   0  84   0   3   0   0   1   0   0   0   3   0   0   2  33]
 [  3   0   0  93   0   0   0   0   0   0   1   0   1   1   8  33]
 [  0   1   1   0 114   0   0   0   0   0   0   0   0   0   2  33]
 [  2   0   0   1   0 124   0   0   0   0   4   0   0   1   3  36]
 [  3   7   0   0   0   0  88   0   0   0   0   0   0   1   7  33]
 [  1   1   0   0   0   0   0 103   0   0   0   0   0   1   0  22]
 [  1   0   0   0   0   0   0   0 104   0   0   0   0   0   1  26]
 [  2   1   0   0   0   0   0   0   0 131   0   0   0   1   3  26]
 [  4   0   0   0   0   1   0   0   0   0  42   1   0   1  16  41]
 [  0   3   0   0   0   0   0   0   0   0   1  97   0   0   2  24]
 [  0   8   0   0   0   0   0   0   0   0   0   0  88   0   2  26]
 [  0   1   1   0   0   1   0   0   0   0   0   0   0 119   5  33]
 [ 17   0   0   1   1   0   0   0   0   0   0   1   0   0  79  94]
 [ 17  23   1   2   0   0   7  10   0   0   6   6   1  27 125 534]]
2023-04-23 03:26:15,686 - Detection - ***** Test results *****
2023-04-23 03:26:15,686 - Detection -   Acc = 67.13
2023-04-23 03:26:15,686 - Detection -   F1 = 72.4651
2023-04-23 03:26:15,687 - Detection -   F1-known = 73.4599
2023-04-23 03:26:15,687 - Detection -   F1-open = 57.5431
2023-04-23 03:26:15,687 - Detection - Testing finished...
2023-04-23 03:26:15,687 - Detection - Results saved in results/results_DA-ADB-BOOST-F-4.csv
2023-04-23 03:26:15,705 - Detection - Open Intent Detection Finished...
