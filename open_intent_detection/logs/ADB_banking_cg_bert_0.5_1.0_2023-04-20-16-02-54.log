2023-04-20 16:02:54,995 - Detection - Open Intent Detection Begin...
2023-04-20 16:02:54,995 - Detection - Parameters Initialization...
2023-04-20 16:02:54,996 - Detection - ============================== Params ==============================
2023-04-20 16:02:54,996 - Detection - type:	open_intent_detection
2023-04-20 16:02:54,996 - Detection - logger_name:	Detection
2023-04-20 16:02:54,996 - Detection - log_dir:	logs
2023-04-20 16:02:54,996 - Detection - dataset:	banking_cg
2023-04-20 16:02:54,996 - Detection - known_cls_ratio:	0.5
2023-04-20 16:02:54,996 - Detection - labeled_ratio:	1.0
2023-04-20 16:02:54,996 - Detection - method:	ADB
2023-04-20 16:02:54,996 - Detection - train:	True
2023-04-20 16:02:54,996 - Detection - pretrain:	True
2023-04-20 16:02:54,996 - Detection - save_model:	True
2023-04-20 16:02:54,996 - Detection - backbone:	bert
2023-04-20 16:02:54,996 - Detection - config_file_name:	ADB
2023-04-20 16:02:54,996 - Detection - seed:	3
2023-04-20 16:02:54,996 - Detection - gpu_id:	0
2023-04-20 16:02:54,996 - Detection - pipe_results_path:	pipe_results
2023-04-20 16:02:54,996 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-20 16:02:54,996 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-20 16:02:54,996 - Detection - model_dir:	models
2023-04-20 16:02:54,996 - Detection - load_pretrained_method:	None
2023-04-20 16:02:54,996 - Detection - result_dir:	results
2023-04-20 16:02:54,996 - Detection - results_file_name:	results_ADB.csv
2023-04-20 16:02:54,996 - Detection - save_results:	True
2023-04-20 16:02:54,996 - Detection - loss_fct:	CrossEntropyLoss
2023-04-20 16:02:54,996 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.5_1.0_bert_3
2023-04-20 16:02:54,996 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.5_1.0_bert_3/models
2023-04-20 16:02:54,996 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-20 16:02:54,996 - Detection - num_train_epochs:	100
2023-04-20 16:02:54,996 - Detection - num_labels:	None
2023-04-20 16:02:54,996 - Detection - max_seq_length:	None
2023-04-20 16:02:54,996 - Detection - freeze_backbone_parameters:	True
2023-04-20 16:02:54,996 - Detection - feat_dim:	768
2023-04-20 16:02:54,996 - Detection - warmup_proportion:	0.1
2023-04-20 16:02:54,996 - Detection - lr_boundary:	0.05
2023-04-20 16:02:54,996 - Detection - lr:	2e-05
2023-04-20 16:02:54,996 - Detection - activation:	relu
2023-04-20 16:02:54,996 - Detection - train_batch_size:	128
2023-04-20 16:02:54,996 - Detection - eval_batch_size:	64
2023-04-20 16:02:54,996 - Detection - test_batch_size:	64
2023-04-20 16:02:54,996 - Detection - wait_patient:	10
2023-04-20 16:02:54,996 - Detection - ============================== End Params ==============================
2023-04-20 16:02:54,996 - Detection - Data and Model Preparation...
2023-04-20 16:02:54,997 - Detection - The number of known intents is 38
2023-04-20 16:02:54,997 - Detection - Lists of known labels are: ['edit_personal_details', 'exchange_charge', 'compromised_card', 'top_up_limits', 'beneficiary_not_allowed', 'balance_not_updated_after_bank_transfer', 'request_refund', 'cancel_transfer', 'card_arrival', 'declined_cash_withdrawal', 'verify_source_of_funds', 'supported_cards_and_currencies', 'card_delivery_estimate', 'country_support', 'passcode_forgotten', 'verify_my_identity', 'card_payment_fee_charged', 'wrong_amount_of_cash_received', 'atm_support', 'card_acceptance', 'unable_to_verify_identity', 'pending_transfer', 'extra_charge_on_statement', 'top_up_by_cash_or_cheque', 'reverted_card_payment?', 'failed_transfer', 'transfer_not_received_by_recipient', 'lost_or_stolen_phone', 'pending_top_up', 'transfer_fee_charged', 'pin_blocked', 'topping_up_by_card', 'card_payment_wrong_exchange_rate', 'exchange_via_app', 'visa_or_mastercard', 'declined_transfer', 'top_up_reverted', 'transfer_timing']
2023-04-20 16:02:55,007 - Detection - Number of labeled training samples = 1445
2023-04-20 16:02:55,007 - Detection - Number of unlabeled training samples = 1327
2023-04-20 16:02:55,009 - Detection - Number of evaluation samples = 425
2023-04-20 16:02:55,014 - Detection - Number of testing samples = 1896
2023-04-20 16:02:58,957 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-20 16:03:00,729 - Detection - Pre-training Begin...
2023-04-20 16:03:03,354 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 16:03:03,355 - Detection -   best_eval_score = 0
2023-04-20 16:03:03,355 - Detection -   eval_score = 1.88
2023-04-20 16:03:03,355 - Detection -   train_loss = 3.6475802063941956
2023-04-20 16:03:05,491 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 16:03:05,491 - Detection -   best_eval_score = 1.88
2023-04-20 16:03:05,491 - Detection -   eval_score = 4.24
2023-04-20 16:03:05,491 - Detection -   train_loss = 3.6290422876675925
2023-04-20 16:03:07,635 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 16:03:07,635 - Detection -   best_eval_score = 4.24
2023-04-20 16:03:07,635 - Detection -   eval_score = 7.29
2023-04-20 16:03:07,636 - Detection -   train_loss = 3.5940969586372375
2023-04-20 16:03:09,781 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 16:03:09,781 - Detection -   best_eval_score = 7.29
2023-04-20 16:03:09,781 - Detection -   eval_score = 9.65
2023-04-20 16:03:09,781 - Detection -   train_loss = 3.5513392289479575
2023-04-20 16:03:11,929 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 16:03:11,930 - Detection -   best_eval_score = 9.65
2023-04-20 16:03:11,930 - Detection -   eval_score = 9.65
2023-04-20 16:03:11,930 - Detection -   train_loss = 3.4825480580329895
2023-04-20 16:03:14,073 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 16:03:14,073 - Detection -   best_eval_score = 9.65
2023-04-20 16:03:14,073 - Detection -   eval_score = 12.71
2023-04-20 16:03:14,073 - Detection -   train_loss = 3.3630495270093284
2023-04-20 16:03:16,236 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 16:03:16,236 - Detection -   best_eval_score = 12.71
2023-04-20 16:03:16,236 - Detection -   eval_score = 19.53
2023-04-20 16:03:16,236 - Detection -   train_loss = 3.1526810924212136
2023-04-20 16:03:18,416 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 16:03:18,416 - Detection -   best_eval_score = 19.53
2023-04-20 16:03:18,416 - Detection -   eval_score = 25.88
2023-04-20 16:03:18,416 - Detection -   train_loss = 2.8198206623395285
2023-04-20 16:03:20,612 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 16:03:20,612 - Detection -   best_eval_score = 25.88
2023-04-20 16:03:20,612 - Detection -   eval_score = 33.65
2023-04-20 16:03:20,612 - Detection -   train_loss = 2.4305724104245505
2023-04-20 16:03:22,833 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 16:03:22,833 - Detection -   best_eval_score = 33.65
2023-04-20 16:03:22,833 - Detection -   eval_score = 43.06
2023-04-20 16:03:22,833 - Detection -   train_loss = 2.0641757945219674
2023-04-20 16:03:25,070 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 16:03:25,070 - Detection -   best_eval_score = 43.06
2023-04-20 16:03:25,070 - Detection -   eval_score = 49.88
2023-04-20 16:03:25,070 - Detection -   train_loss = 1.755912681420644
2023-04-20 16:03:27,309 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 16:03:27,309 - Detection -   best_eval_score = 49.88
2023-04-20 16:03:27,309 - Detection -   eval_score = 56.94
2023-04-20 16:03:27,309 - Detection -   train_loss = 1.4971231520175934
2023-04-20 16:03:29,567 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 16:03:29,567 - Detection -   best_eval_score = 56.94
2023-04-20 16:03:29,567 - Detection -   eval_score = 58.59
2023-04-20 16:03:29,567 - Detection -   train_loss = 1.2830169995625813
2023-04-20 16:03:31,829 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 16:03:31,829 - Detection -   best_eval_score = 58.59
2023-04-20 16:03:31,829 - Detection -   eval_score = 62.82
2023-04-20 16:03:31,829 - Detection -   train_loss = 1.100147505601247
2023-04-20 16:03:34,196 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 16:03:34,196 - Detection -   best_eval_score = 62.82
2023-04-20 16:03:34,196 - Detection -   eval_score = 64.47
2023-04-20 16:03:34,196 - Detection -   train_loss = 0.9709540357192358
2023-04-20 16:03:36,481 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 16:03:36,481 - Detection -   best_eval_score = 64.47
2023-04-20 16:03:36,481 - Detection -   eval_score = 66.82
2023-04-20 16:03:36,481 - Detection -   train_loss = 0.8857242266337076
2023-04-20 16:03:38,771 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 16:03:38,771 - Detection -   best_eval_score = 66.82
2023-04-20 16:03:38,771 - Detection -   eval_score = 68.47
2023-04-20 16:03:38,771 - Detection -   train_loss = 0.787531798084577
2023-04-20 16:03:41,072 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 16:03:41,072 - Detection -   best_eval_score = 68.47
2023-04-20 16:03:41,072 - Detection -   eval_score = 69.65
2023-04-20 16:03:41,072 - Detection -   train_loss = 0.700022836526235
2023-04-20 16:03:43,373 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 16:03:43,373 - Detection -   best_eval_score = 69.65
2023-04-20 16:03:43,373 - Detection -   eval_score = 69.88
2023-04-20 16:03:43,373 - Detection -   train_loss = 0.6415085792541504
2023-04-20 16:03:45,669 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 16:03:45,670 - Detection -   best_eval_score = 69.88
2023-04-20 16:03:45,670 - Detection -   eval_score = 71.53
2023-04-20 16:03:45,670 - Detection -   train_loss = 0.5830322727560997
2023-04-20 16:03:47,975 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 16:03:47,975 - Detection -   best_eval_score = 71.53
2023-04-20 16:03:47,975 - Detection -   eval_score = 72.0
2023-04-20 16:03:47,975 - Detection -   train_loss = 0.5464179192980131
2023-04-20 16:03:50,276 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 16:03:50,276 - Detection -   best_eval_score = 72.0
2023-04-20 16:03:50,276 - Detection -   eval_score = 73.18
2023-04-20 16:03:50,276 - Detection -   train_loss = 0.4988815312584241
2023-04-20 16:03:52,579 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 16:03:52,579 - Detection -   best_eval_score = 73.18
2023-04-20 16:03:52,579 - Detection -   eval_score = 73.18
2023-04-20 16:03:52,579 - Detection -   train_loss = 0.46694116791089374
2023-04-20 16:03:54,874 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 16:03:54,874 - Detection -   best_eval_score = 73.18
2023-04-20 16:03:54,874 - Detection -   eval_score = 74.59
2023-04-20 16:03:54,874 - Detection -   train_loss = 0.43546905865271884
2023-04-20 16:03:57,177 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 16:03:57,177 - Detection -   best_eval_score = 74.59
2023-04-20 16:03:57,178 - Detection -   eval_score = 75.29
2023-04-20 16:03:57,178 - Detection -   train_loss = 0.41383712738752365
2023-04-20 16:03:59,481 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 16:03:59,482 - Detection -   best_eval_score = 75.29
2023-04-20 16:03:59,482 - Detection -   eval_score = 76.0
2023-04-20 16:03:59,482 - Detection -   train_loss = 0.38337837159633636
2023-04-20 16:04:01,787 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 16:04:01,787 - Detection -   best_eval_score = 76.0
2023-04-20 16:04:01,787 - Detection -   eval_score = 75.76
2023-04-20 16:04:01,787 - Detection -   train_loss = 0.36217742413282394
2023-04-20 16:04:04,076 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 16:04:04,076 - Detection -   best_eval_score = 76.0
2023-04-20 16:04:04,076 - Detection -   eval_score = 77.18
2023-04-20 16:04:04,076 - Detection -   train_loss = 0.3411870673298836
2023-04-20 16:04:06,384 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 16:04:06,384 - Detection -   best_eval_score = 77.18
2023-04-20 16:04:06,384 - Detection -   eval_score = 76.71
2023-04-20 16:04:06,384 - Detection -   train_loss = 0.326150036106507
2023-04-20 16:04:08,681 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 16:04:08,681 - Detection -   best_eval_score = 77.18
2023-04-20 16:04:08,681 - Detection -   eval_score = 77.18
2023-04-20 16:04:08,681 - Detection -   train_loss = 0.3088094964623451
2023-04-20 16:04:10,971 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 16:04:10,971 - Detection -   best_eval_score = 77.18
2023-04-20 16:04:10,971 - Detection -   eval_score = 77.41
2023-04-20 16:04:10,971 - Detection -   train_loss = 0.2931313216686249
2023-04-20 16:04:13,278 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 16:04:13,278 - Detection -   best_eval_score = 77.41
2023-04-20 16:04:13,278 - Detection -   eval_score = 77.41
2023-04-20 16:04:13,278 - Detection -   train_loss = 0.2811701335012913
2023-04-20 16:04:15,562 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 16:04:15,562 - Detection -   best_eval_score = 77.41
2023-04-20 16:04:15,562 - Detection -   eval_score = 78.35
2023-04-20 16:04:15,562 - Detection -   train_loss = 0.2640901878476143
2023-04-20 16:04:17,862 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 16:04:17,862 - Detection -   best_eval_score = 78.35
2023-04-20 16:04:17,862 - Detection -   eval_score = 78.12
2023-04-20 16:04:17,862 - Detection -   train_loss = 0.2530002308388551
2023-04-20 16:04:20,146 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 16:04:20,146 - Detection -   best_eval_score = 78.35
2023-04-20 16:04:20,146 - Detection -   eval_score = 78.12
2023-04-20 16:04:20,146 - Detection -   train_loss = 0.2509678478042285
2023-04-20 16:04:22,434 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 16:04:22,435 - Detection -   best_eval_score = 78.35
2023-04-20 16:04:22,435 - Detection -   eval_score = 78.59
2023-04-20 16:04:22,435 - Detection -   train_loss = 0.22464066371321678
2023-04-20 16:04:24,733 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 16:04:24,734 - Detection -   best_eval_score = 78.59
2023-04-20 16:04:24,734 - Detection -   eval_score = 78.35
2023-04-20 16:04:24,734 - Detection -   train_loss = 0.23045931880672774
2023-04-20 16:04:27,018 - Detection - ***** Epoch: 38: Eval results *****
2023-04-20 16:04:27,018 - Detection -   best_eval_score = 78.59
2023-04-20 16:04:27,018 - Detection -   eval_score = 78.12
2023-04-20 16:04:27,018 - Detection -   train_loss = 0.2092400590578715
2023-04-20 16:04:29,303 - Detection - ***** Epoch: 39: Eval results *****
2023-04-20 16:04:29,304 - Detection -   best_eval_score = 78.59
2023-04-20 16:04:29,304 - Detection -   eval_score = 78.59
2023-04-20 16:04:29,304 - Detection -   train_loss = 0.1984996385872364
2023-04-20 16:04:31,596 - Detection - ***** Epoch: 40: Eval results *****
2023-04-20 16:04:31,596 - Detection -   best_eval_score = 78.59
2023-04-20 16:04:31,596 - Detection -   eval_score = 78.12
2023-04-20 16:04:31,596 - Detection -   train_loss = 0.2109583057463169
2023-04-20 16:04:33,882 - Detection - ***** Epoch: 41: Eval results *****
2023-04-20 16:04:33,882 - Detection -   best_eval_score = 78.59
2023-04-20 16:04:33,882 - Detection -   eval_score = 78.35
2023-04-20 16:04:33,882 - Detection -   train_loss = 0.19496978943546614
2023-04-20 16:04:36,174 - Detection - ***** Epoch: 42: Eval results *****
2023-04-20 16:04:36,174 - Detection -   best_eval_score = 78.59
2023-04-20 16:04:36,174 - Detection -   eval_score = 78.59
2023-04-20 16:04:36,174 - Detection -   train_loss = 0.19385095437367758
2023-04-20 16:04:38,468 - Detection - ***** Epoch: 43: Eval results *****
2023-04-20 16:04:38,468 - Detection -   best_eval_score = 78.59
2023-04-20 16:04:38,468 - Detection -   eval_score = 78.82
2023-04-20 16:04:38,468 - Detection -   train_loss = 0.17793565491835275
2023-04-20 16:04:40,767 - Detection - ***** Epoch: 44: Eval results *****
2023-04-20 16:04:40,767 - Detection -   best_eval_score = 78.82
2023-04-20 16:04:40,767 - Detection -   eval_score = 78.59
2023-04-20 16:04:40,767 - Detection -   train_loss = 0.17313560470938683
2023-04-20 16:04:43,062 - Detection - ***** Epoch: 45: Eval results *****
2023-04-20 16:04:43,063 - Detection -   best_eval_score = 78.82
2023-04-20 16:04:43,063 - Detection -   eval_score = 78.82
2023-04-20 16:04:43,063 - Detection -   train_loss = 0.16837198163072267
2023-04-20 16:04:45,345 - Detection - ***** Epoch: 46: Eval results *****
2023-04-20 16:04:45,345 - Detection -   best_eval_score = 78.82
2023-04-20 16:04:45,345 - Detection -   eval_score = 79.06
2023-04-20 16:04:45,345 - Detection -   train_loss = 0.16030082354942957
2023-04-20 16:04:47,642 - Detection - ***** Epoch: 47: Eval results *****
2023-04-20 16:04:47,642 - Detection -   best_eval_score = 79.06
2023-04-20 16:04:47,642 - Detection -   eval_score = 79.06
2023-04-20 16:04:47,642 - Detection -   train_loss = 0.15360670164227486
2023-04-20 16:04:49,992 - Detection - ***** Epoch: 48: Eval results *****
2023-04-20 16:04:49,992 - Detection -   best_eval_score = 79.06
2023-04-20 16:04:49,992 - Detection -   eval_score = 78.82
2023-04-20 16:04:49,992 - Detection -   train_loss = 0.15410858144362768
2023-04-20 16:04:52,309 - Detection - ***** Epoch: 49: Eval results *****
2023-04-20 16:04:52,309 - Detection -   best_eval_score = 79.06
2023-04-20 16:04:52,309 - Detection -   eval_score = 79.29
2023-04-20 16:04:52,309 - Detection -   train_loss = 0.1499584193030993
2023-04-20 16:04:54,627 - Detection - ***** Epoch: 50: Eval results *****
2023-04-20 16:04:54,627 - Detection -   best_eval_score = 79.29
2023-04-20 16:04:54,627 - Detection -   eval_score = 78.59
2023-04-20 16:04:54,627 - Detection -   train_loss = 0.14566799625754356
2023-04-20 16:04:56,946 - Detection - ***** Epoch: 51: Eval results *****
2023-04-20 16:04:56,946 - Detection -   best_eval_score = 79.29
2023-04-20 16:04:56,946 - Detection -   eval_score = 79.53
2023-04-20 16:04:56,946 - Detection -   train_loss = 0.13964100616673628
2023-04-20 16:04:59,291 - Detection - ***** Epoch: 52: Eval results *****
2023-04-20 16:04:59,291 - Detection -   best_eval_score = 79.53
2023-04-20 16:04:59,291 - Detection -   eval_score = 80.0
2023-04-20 16:04:59,291 - Detection -   train_loss = 0.13517295010387897
2023-04-20 16:05:01,678 - Detection - ***** Epoch: 53: Eval results *****
2023-04-20 16:05:01,678 - Detection -   best_eval_score = 80.0
2023-04-20 16:05:01,678 - Detection -   eval_score = 78.82
2023-04-20 16:05:01,678 - Detection -   train_loss = 0.13432408248384795
2023-04-20 16:05:04,135 - Detection - ***** Epoch: 54: Eval results *****
2023-04-20 16:05:04,135 - Detection -   best_eval_score = 80.0
2023-04-20 16:05:04,135 - Detection -   eval_score = 79.53
2023-04-20 16:05:04,135 - Detection -   train_loss = 0.12492399476468563
2023-04-20 16:05:06,512 - Detection - ***** Epoch: 55: Eval results *****
2023-04-20 16:05:06,512 - Detection -   best_eval_score = 80.0
2023-04-20 16:05:06,512 - Detection -   eval_score = 79.06
2023-04-20 16:05:06,513 - Detection -   train_loss = 0.12760688426593939
2023-04-20 16:05:08,890 - Detection - ***** Epoch: 56: Eval results *****
2023-04-20 16:05:08,890 - Detection -   best_eval_score = 80.0
2023-04-20 16:05:08,890 - Detection -   eval_score = 80.0
2023-04-20 16:05:08,890 - Detection -   train_loss = 0.12339992510775726
2023-04-20 16:05:11,302 - Detection - ***** Epoch: 57: Eval results *****
2023-04-20 16:05:11,303 - Detection -   best_eval_score = 80.0
2023-04-20 16:05:11,303 - Detection -   eval_score = 80.0
2023-04-20 16:05:11,303 - Detection -   train_loss = 0.12073255144059658
2023-04-20 16:05:13,622 - Detection - ***** Epoch: 58: Eval results *****
2023-04-20 16:05:13,622 - Detection -   best_eval_score = 80.0
2023-04-20 16:05:13,623 - Detection -   eval_score = 80.0
2023-04-20 16:05:13,623 - Detection -   train_loss = 0.11810575984418392
2023-04-20 16:05:15,985 - Detection - ***** Epoch: 59: Eval results *****
2023-04-20 16:05:15,985 - Detection -   best_eval_score = 80.0
2023-04-20 16:05:15,985 - Detection -   eval_score = 80.24
2023-04-20 16:05:15,985 - Detection -   train_loss = 0.11349109498163064
2023-04-20 16:05:18,313 - Detection - ***** Epoch: 60: Eval results *****
2023-04-20 16:05:18,313 - Detection -   best_eval_score = 80.24
2023-04-20 16:05:18,313 - Detection -   eval_score = 80.0
2023-04-20 16:05:18,313 - Detection -   train_loss = 0.12172310799360275
2023-04-20 16:05:20,684 - Detection - ***** Epoch: 61: Eval results *****
2023-04-20 16:05:20,684 - Detection -   best_eval_score = 80.24
2023-04-20 16:05:20,684 - Detection -   eval_score = 80.47
2023-04-20 16:05:20,684 - Detection -   train_loss = 0.11094728919366996
2023-04-20 16:05:23,059 - Detection - ***** Epoch: 62: Eval results *****
2023-04-20 16:05:23,059 - Detection -   best_eval_score = 80.47
2023-04-20 16:05:23,059 - Detection -   eval_score = 80.0
2023-04-20 16:05:23,059 - Detection -   train_loss = 0.109093451872468
2023-04-20 16:05:25,417 - Detection - ***** Epoch: 63: Eval results *****
2023-04-20 16:05:25,417 - Detection -   best_eval_score = 80.47
2023-04-20 16:05:25,417 - Detection -   eval_score = 79.76
2023-04-20 16:05:25,417 - Detection -   train_loss = 0.10708624869585037
2023-04-20 16:05:27,804 - Detection - ***** Epoch: 64: Eval results *****
2023-04-20 16:05:27,804 - Detection -   best_eval_score = 80.47
2023-04-20 16:05:27,804 - Detection -   eval_score = 80.0
2023-04-20 16:05:27,804 - Detection -   train_loss = 0.1052666852871577
2023-04-20 16:05:30,161 - Detection - ***** Epoch: 65: Eval results *****
2023-04-20 16:05:30,161 - Detection -   best_eval_score = 80.47
2023-04-20 16:05:30,161 - Detection -   eval_score = 79.76
2023-04-20 16:05:30,161 - Detection -   train_loss = 0.11140674725174904
2023-04-20 16:05:32,460 - Detection - ***** Epoch: 66: Eval results *****
2023-04-20 16:05:32,460 - Detection -   best_eval_score = 80.47
2023-04-20 16:05:32,460 - Detection -   eval_score = 79.76
2023-04-20 16:05:32,460 - Detection -   train_loss = 0.09989993336300056
2023-04-20 16:05:34,746 - Detection - ***** Epoch: 67: Eval results *****
2023-04-20 16:05:34,746 - Detection -   best_eval_score = 80.47
2023-04-20 16:05:34,746 - Detection -   eval_score = 79.76
2023-04-20 16:05:34,746 - Detection -   train_loss = 0.1016148030757904
2023-04-20 16:05:37,053 - Detection - ***** Epoch: 68: Eval results *****
2023-04-20 16:05:37,053 - Detection -   best_eval_score = 80.47
2023-04-20 16:05:37,053 - Detection -   eval_score = 79.76
2023-04-20 16:05:37,053 - Detection -   train_loss = 0.09859576759239037
2023-04-20 16:05:39,339 - Detection - ***** Epoch: 69: Eval results *****
2023-04-20 16:05:39,339 - Detection -   best_eval_score = 80.47
2023-04-20 16:05:39,339 - Detection -   eval_score = 79.76
2023-04-20 16:05:39,339 - Detection -   train_loss = 0.10156060382723808
2023-04-20 16:05:41,638 - Detection - ***** Epoch: 70: Eval results *****
2023-04-20 16:05:41,638 - Detection -   best_eval_score = 80.47
2023-04-20 16:05:41,638 - Detection -   eval_score = 79.53
2023-04-20 16:05:41,638 - Detection -   train_loss = 0.09538663551211357
2023-04-20 16:05:43,936 - Detection - ***** Epoch: 71: Eval results *****
2023-04-20 16:05:43,936 - Detection -   best_eval_score = 80.47
2023-04-20 16:05:43,936 - Detection -   eval_score = 79.76
2023-04-20 16:05:43,936 - Detection -   train_loss = 0.10236275258163612
2023-04-20 16:05:43,936 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.5_1.0_bert_3/models
2023-04-20 16:05:44,475 - Detection - Pre-training finished...
2023-04-20 16:05:44,475 - Detection - Training Begin...
2023-04-20 16:05:48,362 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 16:05:48,362 - Detection -   best_eval_score = 0
2023-04-20 16:05:48,362 - Detection -   eval_score = 0.0
2023-04-20 16:05:48,362 - Detection -   train_loss = 11.618962208429972
2023-04-20 16:05:50,750 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 16:05:50,751 - Detection -   best_eval_score = 0
2023-04-20 16:05:50,751 - Detection -   eval_score = 0.0
2023-04-20 16:05:50,751 - Detection -   train_loss = 11.115516265233358
2023-04-20 16:05:53,102 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 16:05:53,102 - Detection -   best_eval_score = 0
2023-04-20 16:05:53,103 - Detection -   eval_score = 0.0
2023-04-20 16:05:53,103 - Detection -   train_loss = 10.828489065170288
2023-04-20 16:05:55,436 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 16:05:55,436 - Detection -   best_eval_score = 0
2023-04-20 16:05:55,436 - Detection -   eval_score = 0.0
2023-04-20 16:05:55,437 - Detection -   train_loss = 10.309512933095297
2023-04-20 16:05:57,719 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 16:05:57,719 - Detection -   best_eval_score = 0
2023-04-20 16:05:57,719 - Detection -   eval_score = 0.0
2023-04-20 16:05:57,719 - Detection -   train_loss = 9.822402397791544
2023-04-20 16:06:00,112 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 16:06:00,112 - Detection -   best_eval_score = 0
2023-04-20 16:06:00,112 - Detection -   eval_score = 0.39
2023-04-20 16:06:00,112 - Detection -   train_loss = 9.217655420303345
2023-04-20 16:06:02,455 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 16:06:02,455 - Detection -   best_eval_score = 0.39
2023-04-20 16:06:02,455 - Detection -   eval_score = 1.67
2023-04-20 16:06:02,455 - Detection -   train_loss = 8.635396798451742
2023-04-20 16:06:04,730 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 16:06:04,730 - Detection -   best_eval_score = 1.67
2023-04-20 16:06:04,730 - Detection -   eval_score = 4.09
2023-04-20 16:06:04,730 - Detection -   train_loss = 8.074056267738342
2023-04-20 16:06:06,993 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 16:06:06,993 - Detection -   best_eval_score = 4.09
2023-04-20 16:06:06,993 - Detection -   eval_score = 5.84
2023-04-20 16:06:06,993 - Detection -   train_loss = 7.462214112281799
2023-04-20 16:06:09,250 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 16:06:09,250 - Detection -   best_eval_score = 5.84
2023-04-20 16:06:09,250 - Detection -   eval_score = 9.85
2023-04-20 16:06:09,250 - Detection -   train_loss = 6.8859580755233765
2023-04-20 16:06:11,521 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 16:06:11,521 - Detection -   best_eval_score = 9.85
2023-04-20 16:06:11,521 - Detection -   eval_score = 13.36
2023-04-20 16:06:11,521 - Detection -   train_loss = 6.271557251612346
2023-04-20 16:06:13,791 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 16:06:13,791 - Detection -   best_eval_score = 13.36
2023-04-20 16:06:13,791 - Detection -   eval_score = 20.73
2023-04-20 16:06:13,791 - Detection -   train_loss = 5.630534728368123
2023-04-20 16:06:16,054 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 16:06:16,054 - Detection -   best_eval_score = 20.73
2023-04-20 16:06:16,054 - Detection -   eval_score = 25.71
2023-04-20 16:06:16,054 - Detection -   train_loss = 5.100505948066711
2023-04-20 16:06:18,313 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 16:06:18,313 - Detection -   best_eval_score = 25.71
2023-04-20 16:06:18,313 - Detection -   eval_score = 32.2
2023-04-20 16:06:18,313 - Detection -   train_loss = 4.554597576459249
2023-04-20 16:06:20,581 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 16:06:20,581 - Detection -   best_eval_score = 32.2
2023-04-20 16:06:20,581 - Detection -   eval_score = 38.17
2023-04-20 16:06:20,581 - Detection -   train_loss = 3.975065847237905
2023-04-20 16:06:22,844 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 16:06:22,844 - Detection -   best_eval_score = 38.17
2023-04-20 16:06:22,844 - Detection -   eval_score = 44.11
2023-04-20 16:06:22,844 - Detection -   train_loss = 3.420206069946289
2023-04-20 16:06:25,172 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 16:06:25,172 - Detection -   best_eval_score = 44.11
2023-04-20 16:06:25,172 - Detection -   eval_score = 48.87
2023-04-20 16:06:25,172 - Detection -   train_loss = 2.919049620628357
2023-04-20 16:06:27,605 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 16:06:27,605 - Detection -   best_eval_score = 48.87
2023-04-20 16:06:27,605 - Detection -   eval_score = 54.91
2023-04-20 16:06:27,605 - Detection -   train_loss = 2.4620237350463867
2023-04-20 16:06:29,926 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 16:06:29,926 - Detection -   best_eval_score = 54.91
2023-04-20 16:06:29,926 - Detection -   eval_score = 59.51
2023-04-20 16:06:29,926 - Detection -   train_loss = 2.034849484761556
2023-04-20 16:06:32,243 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 16:06:32,243 - Detection -   best_eval_score = 59.51
2023-04-20 16:06:32,243 - Detection -   eval_score = 62.61
2023-04-20 16:06:32,243 - Detection -   train_loss = 1.7832032640775044
2023-04-20 16:06:34,526 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 16:06:34,526 - Detection -   best_eval_score = 62.61
2023-04-20 16:06:34,526 - Detection -   eval_score = 64.0
2023-04-20 16:06:34,526 - Detection -   train_loss = 1.5864102641741435
2023-04-20 16:06:36,789 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 16:06:36,789 - Detection -   best_eval_score = 64.0
2023-04-20 16:06:36,789 - Detection -   eval_score = 64.36
2023-04-20 16:06:36,789 - Detection -   train_loss = 1.409016211827596
2023-04-20 16:06:39,098 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 16:06:39,098 - Detection -   best_eval_score = 64.36
2023-04-20 16:06:39,098 - Detection -   eval_score = 66.17
2023-04-20 16:06:39,098 - Detection -   train_loss = 1.3406072954336803
2023-04-20 16:06:41,418 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 16:06:41,418 - Detection -   best_eval_score = 66.17
2023-04-20 16:06:41,418 - Detection -   eval_score = 66.49
2023-04-20 16:06:41,418 - Detection -   train_loss = 1.3453627328077953
2023-04-20 16:06:43,726 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 16:06:43,726 - Detection -   best_eval_score = 66.49
2023-04-20 16:06:43,726 - Detection -   eval_score = 67.66
2023-04-20 16:06:43,726 - Detection -   train_loss = 1.3180186649163563
2023-04-20 16:06:45,998 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 16:06:45,998 - Detection -   best_eval_score = 67.66
2023-04-20 16:06:45,998 - Detection -   eval_score = 67.96
2023-04-20 16:06:45,998 - Detection -   train_loss = 1.2976774672667186
2023-04-20 16:06:48,244 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 16:06:48,244 - Detection -   best_eval_score = 67.96
2023-04-20 16:06:48,244 - Detection -   eval_score = 68.17
2023-04-20 16:06:48,244 - Detection -   train_loss = 1.3241649667421977
2023-04-20 16:06:50,492 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 16:06:50,492 - Detection -   best_eval_score = 68.17
2023-04-20 16:06:50,492 - Detection -   eval_score = 68.63
2023-04-20 16:06:50,492 - Detection -   train_loss = 1.3029844065507252
2023-04-20 16:06:52,738 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 16:06:52,739 - Detection -   best_eval_score = 68.63
2023-04-20 16:06:52,739 - Detection -   eval_score = 68.63
2023-04-20 16:06:52,739 - Detection -   train_loss = 1.3030587236086528
2023-04-20 16:06:55,039 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 16:06:55,039 - Detection -   best_eval_score = 68.63
2023-04-20 16:06:55,039 - Detection -   eval_score = 68.57
2023-04-20 16:06:55,039 - Detection -   train_loss = 1.3466399510701497
2023-04-20 16:06:57,342 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 16:06:57,342 - Detection -   best_eval_score = 68.63
2023-04-20 16:06:57,342 - Detection -   eval_score = 68.84
2023-04-20 16:06:57,342 - Detection -   train_loss = 1.315260688463847
2023-04-20 16:06:59,634 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 16:06:59,635 - Detection -   best_eval_score = 68.84
2023-04-20 16:06:59,635 - Detection -   eval_score = 68.76
2023-04-20 16:06:59,635 - Detection -   train_loss = 1.300196458896001
2023-04-20 16:07:01,926 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 16:07:01,926 - Detection -   best_eval_score = 68.84
2023-04-20 16:07:01,927 - Detection -   eval_score = 68.48
2023-04-20 16:07:01,927 - Detection -   train_loss = 1.2870318591594696
2023-04-20 16:07:04,244 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 16:07:04,244 - Detection -   best_eval_score = 68.84
2023-04-20 16:07:04,244 - Detection -   eval_score = 68.75
2023-04-20 16:07:04,244 - Detection -   train_loss = 1.2579755286375682
2023-04-20 16:07:06,553 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 16:07:06,553 - Detection -   best_eval_score = 68.84
2023-04-20 16:07:06,553 - Detection -   eval_score = 68.32
2023-04-20 16:07:06,553 - Detection -   train_loss = 1.282213677962621
2023-04-20 16:07:08,855 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 16:07:08,855 - Detection -   best_eval_score = 68.84
2023-04-20 16:07:08,856 - Detection -   eval_score = 68.54
2023-04-20 16:07:08,856 - Detection -   train_loss = 1.27147376537323
2023-04-20 16:07:11,191 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 16:07:11,191 - Detection -   best_eval_score = 68.84
2023-04-20 16:07:11,191 - Detection -   eval_score = 68.65
2023-04-20 16:07:11,191 - Detection -   train_loss = 1.3062134087085724
2023-04-20 16:07:13,485 - Detection - ***** Epoch: 38: Eval results *****
2023-04-20 16:07:13,485 - Detection -   best_eval_score = 68.84
2023-04-20 16:07:13,485 - Detection -   eval_score = 68.36
2023-04-20 16:07:13,485 - Detection -   train_loss = 1.2453042070070903
2023-04-20 16:07:15,741 - Detection - ***** Epoch: 39: Eval results *****
2023-04-20 16:07:15,741 - Detection -   best_eval_score = 68.84
2023-04-20 16:07:15,741 - Detection -   eval_score = 68.17
2023-04-20 16:07:15,741 - Detection -   train_loss = 1.2915396988391876
2023-04-20 16:07:18,027 - Detection - ***** Epoch: 40: Eval results *****
2023-04-20 16:07:18,027 - Detection -   best_eval_score = 68.84
2023-04-20 16:07:18,027 - Detection -   eval_score = 68.17
2023-04-20 16:07:18,027 - Detection -   train_loss = 1.3385764360427856
2023-04-20 16:07:20,336 - Detection - ***** Epoch: 41: Eval results *****
2023-04-20 16:07:20,336 - Detection -   best_eval_score = 68.84
2023-04-20 16:07:20,336 - Detection -   eval_score = 68.2
2023-04-20 16:07:20,336 - Detection -   train_loss = 1.2854255338509877
2023-04-20 16:07:20,338 - Detection - Training Finished...
2023-04-20 16:07:20,338 - Detection - Testing begin...
2023-04-20 16:07:22,406 - Detection - ***** Test: Confusion Matrix *****
2023-04-20 16:07:22,406 - Detection - [[ 20   0   0 ...   0   0   7]
 [  0  21   0 ...   0   0   3]
 [  0   0   7 ...   0   0  11]
 ...
 [  0   0   0 ...  21   0   5]
 [  0   0   0 ...   0  16   6]
 [  0  19  12 ...  27   1 645]]
2023-04-20 16:07:22,406 - Detection - ***** Test results *****
2023-04-20 16:07:22,407 - Detection -   Acc = 64.98
2023-04-20 16:07:22,407 - Detection -   F1 = 59.1405
2023-04-20 16:07:22,407 - Detection -   F1-known = 58.8786
2023-04-20 16:07:22,407 - Detection -   F1-open = 69.0948
2023-04-20 16:07:22,407 - Detection - Testing finished...
2023-04-20 16:07:22,407 - Detection - Results saved in results/results_ADB.csv
2023-04-20 16:07:22,426 - Detection - Open Intent Detection Finished...
