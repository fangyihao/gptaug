2023-04-20 17:21:42,289 - Detection - Open Intent Detection Begin...
2023-04-20 17:21:42,289 - Detection - Parameters Initialization...
2023-04-20 17:21:42,289 - Detection - ============================== Params ==============================
2023-04-20 17:21:42,289 - Detection - type:	open_intent_detection
2023-04-20 17:21:42,289 - Detection - logger_name:	Detection
2023-04-20 17:21:42,289 - Detection - log_dir:	logs
2023-04-20 17:21:42,289 - Detection - dataset:	banking_cg
2023-04-20 17:21:42,289 - Detection - known_cls_ratio:	0.75
2023-04-20 17:21:42,289 - Detection - labeled_ratio:	1.0
2023-04-20 17:21:42,289 - Detection - method:	ADB
2023-04-20 17:21:42,289 - Detection - train:	True
2023-04-20 17:21:42,289 - Detection - pretrain:	True
2023-04-20 17:21:42,289 - Detection - save_model:	True
2023-04-20 17:21:42,289 - Detection - backbone:	bert
2023-04-20 17:21:42,289 - Detection - config_file_name:	ADB
2023-04-20 17:21:42,289 - Detection - seed:	8
2023-04-20 17:21:42,289 - Detection - gpu_id:	0
2023-04-20 17:21:42,289 - Detection - pipe_results_path:	pipe_results
2023-04-20 17:21:42,289 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-20 17:21:42,289 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-20 17:21:42,290 - Detection - model_dir:	models
2023-04-20 17:21:42,290 - Detection - load_pretrained_method:	None
2023-04-20 17:21:42,290 - Detection - result_dir:	results
2023-04-20 17:21:42,290 - Detection - results_file_name:	results_ADB.csv
2023-04-20 17:21:42,290 - Detection - save_results:	True
2023-04-20 17:21:42,290 - Detection - loss_fct:	CrossEntropyLoss
2023-04-20 17:21:42,290 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.75_1.0_bert_8
2023-04-20 17:21:42,290 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.75_1.0_bert_8/models
2023-04-20 17:21:42,290 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-20 17:21:42,290 - Detection - num_train_epochs:	100
2023-04-20 17:21:42,290 - Detection - num_labels:	None
2023-04-20 17:21:42,290 - Detection - max_seq_length:	None
2023-04-20 17:21:42,290 - Detection - freeze_backbone_parameters:	True
2023-04-20 17:21:42,290 - Detection - feat_dim:	768
2023-04-20 17:21:42,290 - Detection - warmup_proportion:	0.1
2023-04-20 17:21:42,290 - Detection - lr_boundary:	0.05
2023-04-20 17:21:42,290 - Detection - lr:	2e-05
2023-04-20 17:21:42,290 - Detection - activation:	relu
2023-04-20 17:21:42,290 - Detection - train_batch_size:	128
2023-04-20 17:21:42,290 - Detection - eval_batch_size:	64
2023-04-20 17:21:42,290 - Detection - test_batch_size:	64
2023-04-20 17:21:42,290 - Detection - wait_patient:	10
2023-04-20 17:21:42,290 - Detection - ============================== End Params ==============================
2023-04-20 17:21:42,290 - Detection - Data and Model Preparation...
2023-04-20 17:21:42,291 - Detection - The number of known intents is 58
2023-04-20 17:21:42,291 - Detection - Lists of known labels are: ['getting_spare_card', 'failed_transfer', 'virtual_card_not_working', 'apple_pay_or_google_pay', 'pending_card_payment', 'order_physical_card', 'activate_my_card', 'card_arrival', 'card_payment_fee_charged', 'card_swallowed', 'verify_top_up', 'exchange_rate', 'passcode_forgotten', 'pending_cash_withdrawal', 'topping_up_by_card', 'exchange_charge', 'pin_blocked', 'compromised_card', 'visa_or_mastercard', 'exchange_via_app', 'card_acceptance', 'wrong_amount_of_cash_received', 'country_support', 'top_up_by_card_charge', 'contactless_not_working', 'transfer_fee_charged', 'disposable_card_limits', 'balance_not_updated_after_bank_transfer', 'verify_source_of_funds', 'unable_to_verify_identity', 'supported_cards_and_currencies', 'Refund_not_showing_up', 'card_about_to_expire', 'get_physical_card', 'extra_charge_on_statement', 'request_refund', 'why_verify_identity', 'cash_withdrawal_not_recognised', 'cash_withdrawal_charge', 'edit_personal_details', 'change_pin', 'verify_my_identity', 'declined_transfer', 'transfer_into_account', 'lost_or_stolen_phone', 'card_payment_not_recognised', 'fiat_currency_support', 'top_up_by_cash_or_cheque', 'transfer_not_received_by_recipient', 'age_limit', 'declined_card_payment', 'getting_virtual_card', 'lost_or_stolen_card', 'balance_not_updated_after_cheque_or_cash_deposit', 'terminate_account', 'reverted_card_payment?', 'atm_support', 'receiving_money']
2023-04-20 17:21:42,303 - Detection - Number of labeled training samples = 1993
2023-04-20 17:21:42,303 - Detection - Number of unlabeled training samples = 779
2023-04-20 17:21:42,305 - Detection - Number of evaluation samples = 597
2023-04-20 17:21:42,310 - Detection - Number of testing samples = 1896
2023-04-20 17:21:46,205 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-20 17:21:47,876 - Detection - Pre-training Begin...
2023-04-20 17:21:51,344 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 17:21:51,344 - Detection -   best_eval_score = 0
2023-04-20 17:21:51,344 - Detection -   eval_score = 1.68
2023-04-20 17:21:51,345 - Detection -   train_loss = 4.064285129308701
2023-04-20 17:21:54,337 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 17:21:54,337 - Detection -   best_eval_score = 1.68
2023-04-20 17:21:54,337 - Detection -   eval_score = 1.68
2023-04-20 17:21:54,337 - Detection -   train_loss = 4.046722114086151
2023-04-20 17:21:57,301 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 17:21:57,301 - Detection -   best_eval_score = 1.68
2023-04-20 17:21:57,301 - Detection -   eval_score = 3.02
2023-04-20 17:21:57,301 - Detection -   train_loss = 4.009791597723961
2023-04-20 17:22:00,279 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 17:22:00,279 - Detection -   best_eval_score = 3.02
2023-04-20 17:22:00,280 - Detection -   eval_score = 6.03
2023-04-20 17:22:00,280 - Detection -   train_loss = 3.958318307995796
2023-04-20 17:22:03,293 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 17:22:03,293 - Detection -   best_eval_score = 6.03
2023-04-20 17:22:03,293 - Detection -   eval_score = 6.37
2023-04-20 17:22:03,293 - Detection -   train_loss = 3.8674804717302322
2023-04-20 17:22:06,351 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 17:22:06,351 - Detection -   best_eval_score = 6.37
2023-04-20 17:22:06,351 - Detection -   eval_score = 10.72
2023-04-20 17:22:06,351 - Detection -   train_loss = 3.7213976979255676
2023-04-20 17:22:09,448 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 17:22:09,449 - Detection -   best_eval_score = 10.72
2023-04-20 17:22:09,449 - Detection -   eval_score = 20.44
2023-04-20 17:22:09,449 - Detection -   train_loss = 3.4667550176382065
2023-04-20 17:22:12,569 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 17:22:12,569 - Detection -   best_eval_score = 20.44
2023-04-20 17:22:12,569 - Detection -   eval_score = 24.12
2023-04-20 17:22:12,569 - Detection -   train_loss = 3.101647198200226
2023-04-20 17:22:15,685 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 17:22:15,685 - Detection -   best_eval_score = 24.12
2023-04-20 17:22:15,685 - Detection -   eval_score = 32.66
2023-04-20 17:22:15,685 - Detection -   train_loss = 2.7200129330158234
2023-04-20 17:22:18,838 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 17:22:18,838 - Detection -   best_eval_score = 32.66
2023-04-20 17:22:18,838 - Detection -   eval_score = 39.53
2023-04-20 17:22:18,838 - Detection -   train_loss = 2.353837788105011
2023-04-20 17:22:22,120 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 17:22:22,120 - Detection -   best_eval_score = 39.53
2023-04-20 17:22:22,120 - Detection -   eval_score = 46.06
2023-04-20 17:22:22,120 - Detection -   train_loss = 1.9871205538511276
2023-04-20 17:22:25,319 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 17:22:25,319 - Detection -   best_eval_score = 46.06
2023-04-20 17:22:25,319 - Detection -   eval_score = 53.27
2023-04-20 17:22:25,319 - Detection -   train_loss = 1.699196144938469
2023-04-20 17:22:28,550 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 17:22:28,550 - Detection -   best_eval_score = 53.27
2023-04-20 17:22:28,550 - Detection -   eval_score = 57.29
2023-04-20 17:22:28,550 - Detection -   train_loss = 1.4653323143720627
2023-04-20 17:22:31,774 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 17:22:31,775 - Detection -   best_eval_score = 57.29
2023-04-20 17:22:31,775 - Detection -   eval_score = 62.14
2023-04-20 17:22:31,775 - Detection -   train_loss = 1.2781595811247826
2023-04-20 17:22:35,006 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 17:22:35,006 - Detection -   best_eval_score = 62.14
2023-04-20 17:22:35,006 - Detection -   eval_score = 63.99
2023-04-20 17:22:35,006 - Detection -   train_loss = 1.1405374631285667
2023-04-20 17:22:38,216 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 17:22:38,216 - Detection -   best_eval_score = 63.99
2023-04-20 17:22:38,216 - Detection -   eval_score = 67.67
2023-04-20 17:22:38,216 - Detection -   train_loss = 1.0145888403058052
2023-04-20 17:22:41,467 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 17:22:41,468 - Detection -   best_eval_score = 67.67
2023-04-20 17:22:41,468 - Detection -   eval_score = 67.67
2023-04-20 17:22:41,468 - Detection -   train_loss = 0.9176817089319229
2023-04-20 17:22:44,768 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 17:22:44,768 - Detection -   best_eval_score = 67.67
2023-04-20 17:22:44,768 - Detection -   eval_score = 69.68
2023-04-20 17:22:44,768 - Detection -   train_loss = 0.8333164528012276
2023-04-20 17:22:48,022 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 17:22:48,022 - Detection -   best_eval_score = 69.68
2023-04-20 17:22:48,022 - Detection -   eval_score = 71.02
2023-04-20 17:22:48,022 - Detection -   train_loss = 0.7550139166414738
2023-04-20 17:22:51,254 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 17:22:51,254 - Detection -   best_eval_score = 71.02
2023-04-20 17:22:51,254 - Detection -   eval_score = 72.19
2023-04-20 17:22:51,254 - Detection -   train_loss = 0.7025317624211311
2023-04-20 17:22:54,507 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 17:22:54,507 - Detection -   best_eval_score = 72.19
2023-04-20 17:22:54,507 - Detection -   eval_score = 73.03
2023-04-20 17:22:54,507 - Detection -   train_loss = 0.6487791277468204
2023-04-20 17:22:57,769 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 17:22:57,769 - Detection -   best_eval_score = 73.03
2023-04-20 17:22:57,769 - Detection -   eval_score = 74.71
2023-04-20 17:22:57,769 - Detection -   train_loss = 0.6013413779437542
2023-04-20 17:23:01,027 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 17:23:01,027 - Detection -   best_eval_score = 74.71
2023-04-20 17:23:01,027 - Detection -   eval_score = 74.71
2023-04-20 17:23:01,027 - Detection -   train_loss = 0.5585046447813511
2023-04-20 17:23:04,263 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 17:23:04,263 - Detection -   best_eval_score = 74.71
2023-04-20 17:23:04,263 - Detection -   eval_score = 75.38
2023-04-20 17:23:04,263 - Detection -   train_loss = 0.5284649468958378
2023-04-20 17:23:07,520 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 17:23:07,520 - Detection -   best_eval_score = 75.38
2023-04-20 17:23:07,520 - Detection -   eval_score = 75.54
2023-04-20 17:23:07,520 - Detection -   train_loss = 0.4925651717931032
2023-04-20 17:23:10,795 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 17:23:10,795 - Detection -   best_eval_score = 75.54
2023-04-20 17:23:10,795 - Detection -   eval_score = 75.88
2023-04-20 17:23:10,795 - Detection -   train_loss = 0.46760100312530994
2023-04-20 17:23:14,021 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 17:23:14,021 - Detection -   best_eval_score = 75.88
2023-04-20 17:23:14,021 - Detection -   eval_score = 76.21
2023-04-20 17:23:14,021 - Detection -   train_loss = 0.43623807840049267
2023-04-20 17:23:17,248 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 17:23:17,248 - Detection -   best_eval_score = 76.21
2023-04-20 17:23:17,248 - Detection -   eval_score = 77.05
2023-04-20 17:23:17,248 - Detection -   train_loss = 0.41252642683684826
2023-04-20 17:23:20,473 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 17:23:20,473 - Detection -   best_eval_score = 77.05
2023-04-20 17:23:20,473 - Detection -   eval_score = 76.88
2023-04-20 17:23:20,473 - Detection -   train_loss = 0.39257942885160446
2023-04-20 17:23:23,666 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 17:23:23,666 - Detection -   best_eval_score = 77.05
2023-04-20 17:23:23,666 - Detection -   eval_score = 77.22
2023-04-20 17:23:23,666 - Detection -   train_loss = 0.369808342307806
2023-04-20 17:23:26,874 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 17:23:26,874 - Detection -   best_eval_score = 77.22
2023-04-20 17:23:26,874 - Detection -   eval_score = 77.05
2023-04-20 17:23:26,874 - Detection -   train_loss = 0.34837438724935055
2023-04-20 17:23:30,089 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 17:23:30,090 - Detection -   best_eval_score = 77.22
2023-04-20 17:23:30,090 - Detection -   eval_score = 77.89
2023-04-20 17:23:30,090 - Detection -   train_loss = 0.33530761674046516
2023-04-20 17:23:33,311 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 17:23:33,311 - Detection -   best_eval_score = 77.89
2023-04-20 17:23:33,311 - Detection -   eval_score = 77.89
2023-04-20 17:23:33,311 - Detection -   train_loss = 0.321929270401597
2023-04-20 17:23:36,519 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 17:23:36,520 - Detection -   best_eval_score = 77.89
2023-04-20 17:23:36,520 - Detection -   eval_score = 77.89
2023-04-20 17:23:36,520 - Detection -   train_loss = 0.3113793944939971
2023-04-20 17:23:39,700 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 17:23:39,701 - Detection -   best_eval_score = 77.89
2023-04-20 17:23:39,701 - Detection -   eval_score = 78.06
2023-04-20 17:23:39,701 - Detection -   train_loss = 0.28757111355662346
2023-04-20 17:23:42,905 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 17:23:42,905 - Detection -   best_eval_score = 78.06
2023-04-20 17:23:42,905 - Detection -   eval_score = 78.73
2023-04-20 17:23:42,905 - Detection -   train_loss = 0.2696885420009494
2023-04-20 17:23:46,112 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 17:23:46,112 - Detection -   best_eval_score = 78.73
2023-04-20 17:23:46,112 - Detection -   eval_score = 78.39
2023-04-20 17:23:46,112 - Detection -   train_loss = 0.27945468481630087
2023-04-20 17:23:49,322 - Detection - ***** Epoch: 38: Eval results *****
2023-04-20 17:23:49,322 - Detection -   best_eval_score = 78.73
2023-04-20 17:23:49,322 - Detection -   eval_score = 78.73
2023-04-20 17:23:49,322 - Detection -   train_loss = 0.25750848464667797
2023-04-20 17:23:52,526 - Detection - ***** Epoch: 39: Eval results *****
2023-04-20 17:23:52,526 - Detection -   best_eval_score = 78.73
2023-04-20 17:23:52,526 - Detection -   eval_score = 78.56
2023-04-20 17:23:52,526 - Detection -   train_loss = 0.24611681513488293
2023-04-20 17:23:55,812 - Detection - ***** Epoch: 40: Eval results *****
2023-04-20 17:23:55,812 - Detection -   best_eval_score = 78.73
2023-04-20 17:23:55,812 - Detection -   eval_score = 79.06
2023-04-20 17:23:55,812 - Detection -   train_loss = 0.23385341465473175
2023-04-20 17:23:59,004 - Detection - ***** Epoch: 41: Eval results *****
2023-04-20 17:23:59,004 - Detection -   best_eval_score = 79.06
2023-04-20 17:23:59,004 - Detection -   eval_score = 79.9
2023-04-20 17:23:59,004 - Detection -   train_loss = 0.23367736767977476
2023-04-20 17:24:02,219 - Detection - ***** Epoch: 42: Eval results *****
2023-04-20 17:24:02,219 - Detection -   best_eval_score = 79.9
2023-04-20 17:24:02,219 - Detection -   eval_score = 78.39
2023-04-20 17:24:02,219 - Detection -   train_loss = 0.2215200001373887
2023-04-20 17:24:05,431 - Detection - ***** Epoch: 43: Eval results *****
2023-04-20 17:24:05,432 - Detection -   best_eval_score = 79.9
2023-04-20 17:24:05,432 - Detection -   eval_score = 79.73
2023-04-20 17:24:05,432 - Detection -   train_loss = 0.21972045302391052
2023-04-20 17:24:08,639 - Detection - ***** Epoch: 44: Eval results *****
2023-04-20 17:24:08,639 - Detection -   best_eval_score = 79.9
2023-04-20 17:24:08,639 - Detection -   eval_score = 80.07
2023-04-20 17:24:08,639 - Detection -   train_loss = 0.20830460730940104
2023-04-20 17:24:11,850 - Detection - ***** Epoch: 45: Eval results *****
2023-04-20 17:24:11,850 - Detection -   best_eval_score = 80.07
2023-04-20 17:24:11,850 - Detection -   eval_score = 79.56
2023-04-20 17:24:11,850 - Detection -   train_loss = 0.19562883023172617
2023-04-20 17:24:15,026 - Detection - ***** Epoch: 46: Eval results *****
2023-04-20 17:24:15,026 - Detection -   best_eval_score = 80.07
2023-04-20 17:24:15,026 - Detection -   eval_score = 79.9
2023-04-20 17:24:15,026 - Detection -   train_loss = 0.1889892965555191
2023-04-20 17:24:18,217 - Detection - ***** Epoch: 47: Eval results *****
2023-04-20 17:24:18,217 - Detection -   best_eval_score = 80.07
2023-04-20 17:24:18,217 - Detection -   eval_score = 79.73
2023-04-20 17:24:18,217 - Detection -   train_loss = 0.1896032625809312
2023-04-20 17:24:21,499 - Detection - ***** Epoch: 48: Eval results *****
2023-04-20 17:24:21,499 - Detection -   best_eval_score = 80.07
2023-04-20 17:24:21,499 - Detection -   eval_score = 80.4
2023-04-20 17:24:21,499 - Detection -   train_loss = 0.18420235347002745
2023-04-20 17:24:24,804 - Detection - ***** Epoch: 49: Eval results *****
2023-04-20 17:24:24,804 - Detection -   best_eval_score = 80.4
2023-04-20 17:24:24,804 - Detection -   eval_score = 79.73
2023-04-20 17:24:24,804 - Detection -   train_loss = 0.17794470768421888
2023-04-20 17:24:28,059 - Detection - ***** Epoch: 50: Eval results *****
2023-04-20 17:24:28,059 - Detection -   best_eval_score = 80.4
2023-04-20 17:24:28,060 - Detection -   eval_score = 79.56
2023-04-20 17:24:28,060 - Detection -   train_loss = 0.1761870188638568
2023-04-20 17:24:31,271 - Detection - ***** Epoch: 51: Eval results *****
2023-04-20 17:24:31,271 - Detection -   best_eval_score = 80.4
2023-04-20 17:24:31,271 - Detection -   eval_score = 79.56
2023-04-20 17:24:31,271 - Detection -   train_loss = 0.16981581691652536
2023-04-20 17:24:34,532 - Detection - ***** Epoch: 52: Eval results *****
2023-04-20 17:24:34,532 - Detection -   best_eval_score = 80.4
2023-04-20 17:24:34,533 - Detection -   eval_score = 79.9
2023-04-20 17:24:34,533 - Detection -   train_loss = 0.16668858472257853
2023-04-20 17:24:37,742 - Detection - ***** Epoch: 53: Eval results *****
2023-04-20 17:24:37,742 - Detection -   best_eval_score = 80.4
2023-04-20 17:24:37,743 - Detection -   eval_score = 79.73
2023-04-20 17:24:37,743 - Detection -   train_loss = 0.16071015037596226
2023-04-20 17:24:40,936 - Detection - ***** Epoch: 54: Eval results *****
2023-04-20 17:24:40,937 - Detection -   best_eval_score = 80.4
2023-04-20 17:24:40,937 - Detection -   eval_score = 79.9
2023-04-20 17:24:40,937 - Detection -   train_loss = 0.1521591334603727
2023-04-20 17:24:44,144 - Detection - ***** Epoch: 55: Eval results *****
2023-04-20 17:24:44,144 - Detection -   best_eval_score = 80.4
2023-04-20 17:24:44,144 - Detection -   eval_score = 80.23
2023-04-20 17:24:44,144 - Detection -   train_loss = 0.15076304506510496
2023-04-20 17:24:47,300 - Detection - ***** Epoch: 56: Eval results *****
2023-04-20 17:24:47,300 - Detection -   best_eval_score = 80.4
2023-04-20 17:24:47,300 - Detection -   eval_score = 80.07
2023-04-20 17:24:47,300 - Detection -   train_loss = 0.14809815119951963
2023-04-20 17:24:50,460 - Detection - ***** Epoch: 57: Eval results *****
2023-04-20 17:24:50,461 - Detection -   best_eval_score = 80.4
2023-04-20 17:24:50,461 - Detection -   eval_score = 80.57
2023-04-20 17:24:50,461 - Detection -   train_loss = 0.14678385201841593
2023-04-20 17:24:53,660 - Detection - ***** Epoch: 58: Eval results *****
2023-04-20 17:24:53,660 - Detection -   best_eval_score = 80.57
2023-04-20 17:24:53,660 - Detection -   eval_score = 80.23
2023-04-20 17:24:53,660 - Detection -   train_loss = 0.14431569864973426
2023-04-20 17:24:56,848 - Detection - ***** Epoch: 59: Eval results *****
2023-04-20 17:24:56,848 - Detection -   best_eval_score = 80.57
2023-04-20 17:24:56,848 - Detection -   eval_score = 80.23
2023-04-20 17:24:56,848 - Detection -   train_loss = 0.1404270138591528
2023-04-20 17:25:00,050 - Detection - ***** Epoch: 60: Eval results *****
2023-04-20 17:25:00,050 - Detection -   best_eval_score = 80.57
2023-04-20 17:25:00,050 - Detection -   eval_score = 80.9
2023-04-20 17:25:00,050 - Detection -   train_loss = 0.13444423349574208
2023-04-20 17:25:03,237 - Detection - ***** Epoch: 61: Eval results *****
2023-04-20 17:25:03,237 - Detection -   best_eval_score = 80.9
2023-04-20 17:25:03,237 - Detection -   eval_score = 80.23
2023-04-20 17:25:03,237 - Detection -   train_loss = 0.13513856660574675
2023-04-20 17:25:06,400 - Detection - ***** Epoch: 62: Eval results *****
2023-04-20 17:25:06,400 - Detection -   best_eval_score = 80.9
2023-04-20 17:25:06,400 - Detection -   eval_score = 80.4
2023-04-20 17:25:06,400 - Detection -   train_loss = 0.13060868671163917
2023-04-20 17:25:09,576 - Detection - ***** Epoch: 63: Eval results *****
2023-04-20 17:25:09,576 - Detection -   best_eval_score = 80.9
2023-04-20 17:25:09,576 - Detection -   eval_score = 80.57
2023-04-20 17:25:09,576 - Detection -   train_loss = 0.13066769996657968
2023-04-20 17:25:12,762 - Detection - ***** Epoch: 64: Eval results *****
2023-04-20 17:25:12,763 - Detection -   best_eval_score = 80.9
2023-04-20 17:25:12,763 - Detection -   eval_score = 80.07
2023-04-20 17:25:12,763 - Detection -   train_loss = 0.13063928112387657
2023-04-20 17:25:16,007 - Detection - ***** Epoch: 65: Eval results *****
2023-04-20 17:25:16,007 - Detection -   best_eval_score = 80.9
2023-04-20 17:25:16,007 - Detection -   eval_score = 80.4
2023-04-20 17:25:16,007 - Detection -   train_loss = 0.12565816706046462
2023-04-20 17:25:19,240 - Detection - ***** Epoch: 66: Eval results *****
2023-04-20 17:25:19,240 - Detection -   best_eval_score = 80.9
2023-04-20 17:25:19,240 - Detection -   eval_score = 80.07
2023-04-20 17:25:19,240 - Detection -   train_loss = 0.12561337696388364
2023-04-20 17:25:22,397 - Detection - ***** Epoch: 67: Eval results *****
2023-04-20 17:25:22,397 - Detection -   best_eval_score = 80.9
2023-04-20 17:25:22,397 - Detection -   eval_score = 80.23
2023-04-20 17:25:22,397 - Detection -   train_loss = 0.12138956692069769
2023-04-20 17:25:25,557 - Detection - ***** Epoch: 68: Eval results *****
2023-04-20 17:25:25,557 - Detection -   best_eval_score = 80.9
2023-04-20 17:25:25,557 - Detection -   eval_score = 80.4
2023-04-20 17:25:25,557 - Detection -   train_loss = 0.12001951970160007
2023-04-20 17:25:28,800 - Detection - ***** Epoch: 69: Eval results *****
2023-04-20 17:25:28,800 - Detection -   best_eval_score = 80.9
2023-04-20 17:25:28,800 - Detection -   eval_score = 80.4
2023-04-20 17:25:28,800 - Detection -   train_loss = 0.12129511870443821
2023-04-20 17:25:32,034 - Detection - ***** Epoch: 70: Eval results *****
2023-04-20 17:25:32,034 - Detection -   best_eval_score = 80.9
2023-04-20 17:25:32,034 - Detection -   eval_score = 79.9
2023-04-20 17:25:32,034 - Detection -   train_loss = 0.11664412310346961
2023-04-20 17:25:32,035 - Detection - Trained models are saved in /home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_banking_cg_0.75_1.0_bert_8/models
2023-04-20 17:25:32,588 - Detection - Pre-training finished...
2023-04-20 17:25:32,589 - Detection - Training Begin...
2023-04-20 17:25:37,907 - Detection - ***** Epoch: 1: Eval results *****
2023-04-20 17:25:37,907 - Detection -   best_eval_score = 0
2023-04-20 17:25:37,907 - Detection -   eval_score = 0.0
2023-04-20 17:25:37,907 - Detection -   train_loss = 13.145858228206635
2023-04-20 17:25:41,193 - Detection - ***** Epoch: 2: Eval results *****
2023-04-20 17:25:41,193 - Detection -   best_eval_score = 0
2023-04-20 17:25:41,193 - Detection -   eval_score = 0.0
2023-04-20 17:25:41,193 - Detection -   train_loss = 12.646263062953949
2023-04-20 17:25:44,464 - Detection - ***** Epoch: 3: Eval results *****
2023-04-20 17:25:44,464 - Detection -   best_eval_score = 0
2023-04-20 17:25:44,464 - Detection -   eval_score = 0.0
2023-04-20 17:25:44,464 - Detection -   train_loss = 12.119037091732025
2023-04-20 17:25:47,692 - Detection - ***** Epoch: 4: Eval results *****
2023-04-20 17:25:47,692 - Detection -   best_eval_score = 0
2023-04-20 17:25:47,692 - Detection -   eval_score = 0.0
2023-04-20 17:25:47,692 - Detection -   train_loss = 11.460655152797699
2023-04-20 17:25:50,968 - Detection - ***** Epoch: 5: Eval results *****
2023-04-20 17:25:50,968 - Detection -   best_eval_score = 0
2023-04-20 17:25:50,968 - Detection -   eval_score = 0.34
2023-04-20 17:25:50,968 - Detection -   train_loss = 10.694822490215302
2023-04-20 17:25:54,116 - Detection - ***** Epoch: 6: Eval results *****
2023-04-20 17:25:54,117 - Detection -   best_eval_score = 0.34
2023-04-20 17:25:54,117 - Detection -   eval_score = 0.62
2023-04-20 17:25:54,117 - Detection -   train_loss = 9.902763843536377
2023-04-20 17:25:57,327 - Detection - ***** Epoch: 7: Eval results *****
2023-04-20 17:25:57,327 - Detection -   best_eval_score = 0.62
2023-04-20 17:25:57,327 - Detection -   eval_score = 1.44
2023-04-20 17:25:57,327 - Detection -   train_loss = 9.166516602039337
2023-04-20 17:26:00,566 - Detection - ***** Epoch: 8: Eval results *****
2023-04-20 17:26:00,566 - Detection -   best_eval_score = 1.44
2023-04-20 17:26:00,566 - Detection -   eval_score = 3.87
2023-04-20 17:26:00,566 - Detection -   train_loss = 8.428442239761353
2023-04-20 17:26:03,743 - Detection - ***** Epoch: 9: Eval results *****
2023-04-20 17:26:03,744 - Detection -   best_eval_score = 3.87
2023-04-20 17:26:03,744 - Detection -   eval_score = 9.45
2023-04-20 17:26:03,744 - Detection -   train_loss = 7.654724538326263
2023-04-20 17:26:07,009 - Detection - ***** Epoch: 10: Eval results *****
2023-04-20 17:26:07,009 - Detection -   best_eval_score = 9.45
2023-04-20 17:26:07,009 - Detection -   eval_score = 14.35
2023-04-20 17:26:07,009 - Detection -   train_loss = 6.894159436225891
2023-04-20 17:26:10,336 - Detection - ***** Epoch: 11: Eval results *****
2023-04-20 17:26:10,336 - Detection -   best_eval_score = 14.35
2023-04-20 17:26:10,336 - Detection -   eval_score = 21.81
2023-04-20 17:26:10,336 - Detection -   train_loss = 6.158916413784027
2023-04-20 17:26:13,494 - Detection - ***** Epoch: 12: Eval results *****
2023-04-20 17:26:13,494 - Detection -   best_eval_score = 21.81
2023-04-20 17:26:13,494 - Detection -   eval_score = 28.12
2023-04-20 17:26:13,494 - Detection -   train_loss = 5.397433429956436
2023-04-20 17:26:16,669 - Detection - ***** Epoch: 13: Eval results *****
2023-04-20 17:26:16,669 - Detection -   best_eval_score = 28.12
2023-04-20 17:26:16,669 - Detection -   eval_score = 36.03
2023-04-20 17:26:16,669 - Detection -   train_loss = 4.673871397972107
2023-04-20 17:26:19,842 - Detection - ***** Epoch: 14: Eval results *****
2023-04-20 17:26:19,842 - Detection -   best_eval_score = 36.03
2023-04-20 17:26:19,842 - Detection -   eval_score = 44.14
2023-04-20 17:26:19,842 - Detection -   train_loss = 3.9668495655059814
2023-04-20 17:26:23,003 - Detection - ***** Epoch: 15: Eval results *****
2023-04-20 17:26:23,003 - Detection -   best_eval_score = 44.14
2023-04-20 17:26:23,003 - Detection -   eval_score = 50.17
2023-04-20 17:26:23,003 - Detection -   train_loss = 3.2604215294122696
2023-04-20 17:26:26,209 - Detection - ***** Epoch: 16: Eval results *****
2023-04-20 17:26:26,209 - Detection -   best_eval_score = 50.17
2023-04-20 17:26:26,209 - Detection -   eval_score = 55.36
2023-04-20 17:26:26,209 - Detection -   train_loss = 2.6878957003355026
2023-04-20 17:26:29,370 - Detection - ***** Epoch: 17: Eval results *****
2023-04-20 17:26:29,371 - Detection -   best_eval_score = 55.36
2023-04-20 17:26:29,371 - Detection -   eval_score = 59.29
2023-04-20 17:26:29,371 - Detection -   train_loss = 2.188503049314022
2023-04-20 17:26:32,565 - Detection - ***** Epoch: 18: Eval results *****
2023-04-20 17:26:32,565 - Detection -   best_eval_score = 59.29
2023-04-20 17:26:32,565 - Detection -   eval_score = 62.21
2023-04-20 17:26:32,565 - Detection -   train_loss = 1.8565579801797867
2023-04-20 17:26:35,734 - Detection - ***** Epoch: 19: Eval results *****
2023-04-20 17:26:35,734 - Detection -   best_eval_score = 62.21
2023-04-20 17:26:35,734 - Detection -   eval_score = 64.67
2023-04-20 17:26:35,734 - Detection -   train_loss = 1.6621613875031471
2023-04-20 17:26:38,899 - Detection - ***** Epoch: 20: Eval results *****
2023-04-20 17:26:38,899 - Detection -   best_eval_score = 64.67
2023-04-20 17:26:38,899 - Detection -   eval_score = 66.56
2023-04-20 17:26:38,899 - Detection -   train_loss = 1.5507455170154572
2023-04-20 17:26:42,072 - Detection - ***** Epoch: 21: Eval results *****
2023-04-20 17:26:42,072 - Detection -   best_eval_score = 66.56
2023-04-20 17:26:42,072 - Detection -   eval_score = 67.88
2023-04-20 17:26:42,072 - Detection -   train_loss = 1.4491856768727303
2023-04-20 17:26:45,228 - Detection - ***** Epoch: 22: Eval results *****
2023-04-20 17:26:45,228 - Detection -   best_eval_score = 67.88
2023-04-20 17:26:45,228 - Detection -   eval_score = 68.64
2023-04-20 17:26:45,228 - Detection -   train_loss = 1.4251010864973068
2023-04-20 17:26:48,398 - Detection - ***** Epoch: 23: Eval results *****
2023-04-20 17:26:48,398 - Detection -   best_eval_score = 68.64
2023-04-20 17:26:48,398 - Detection -   eval_score = 69.24
2023-04-20 17:26:48,398 - Detection -   train_loss = 1.432234726846218
2023-04-20 17:26:51,647 - Detection - ***** Epoch: 24: Eval results *****
2023-04-20 17:26:51,647 - Detection -   best_eval_score = 69.24
2023-04-20 17:26:51,647 - Detection -   eval_score = 69.22
2023-04-20 17:26:51,647 - Detection -   train_loss = 1.3807734549045563
2023-04-20 17:26:54,914 - Detection - ***** Epoch: 25: Eval results *****
2023-04-20 17:26:54,914 - Detection -   best_eval_score = 69.24
2023-04-20 17:26:54,914 - Detection -   eval_score = 69.48
2023-04-20 17:26:54,914 - Detection -   train_loss = 1.3821648880839348
2023-04-20 17:26:58,048 - Detection - ***** Epoch: 26: Eval results *****
2023-04-20 17:26:58,048 - Detection -   best_eval_score = 69.48
2023-04-20 17:26:58,048 - Detection -   eval_score = 69.78
2023-04-20 17:26:58,048 - Detection -   train_loss = 1.3996878042817116
2023-04-20 17:27:01,203 - Detection - ***** Epoch: 27: Eval results *****
2023-04-20 17:27:01,204 - Detection -   best_eval_score = 69.78
2023-04-20 17:27:01,204 - Detection -   eval_score = 69.82
2023-04-20 17:27:01,204 - Detection -   train_loss = 1.4201054349541664
2023-04-20 17:27:04,355 - Detection - ***** Epoch: 28: Eval results *****
2023-04-20 17:27:04,355 - Detection -   best_eval_score = 69.82
2023-04-20 17:27:04,355 - Detection -   eval_score = 70.01
2023-04-20 17:27:04,355 - Detection -   train_loss = 1.4060505852103233
2023-04-20 17:27:07,511 - Detection - ***** Epoch: 29: Eval results *****
2023-04-20 17:27:07,511 - Detection -   best_eval_score = 70.01
2023-04-20 17:27:07,511 - Detection -   eval_score = 70.16
2023-04-20 17:27:07,511 - Detection -   train_loss = 1.413510039448738
2023-04-20 17:27:10,643 - Detection - ***** Epoch: 30: Eval results *****
2023-04-20 17:27:10,644 - Detection -   best_eval_score = 70.16
2023-04-20 17:27:10,644 - Detection -   eval_score = 70.16
2023-04-20 17:27:10,644 - Detection -   train_loss = 1.3965815231204033
2023-04-20 17:27:13,781 - Detection - ***** Epoch: 31: Eval results *****
2023-04-20 17:27:13,782 - Detection -   best_eval_score = 70.16
2023-04-20 17:27:13,782 - Detection -   eval_score = 70.07
2023-04-20 17:27:13,782 - Detection -   train_loss = 1.3720373958349228
2023-04-20 17:27:16,921 - Detection - ***** Epoch: 32: Eval results *****
2023-04-20 17:27:16,921 - Detection -   best_eval_score = 70.16
2023-04-20 17:27:16,921 - Detection -   eval_score = 69.8
2023-04-20 17:27:16,921 - Detection -   train_loss = 1.4231244325637817
2023-04-20 17:27:20,183 - Detection - ***** Epoch: 33: Eval results *****
2023-04-20 17:27:20,183 - Detection -   best_eval_score = 70.16
2023-04-20 17:27:20,183 - Detection -   eval_score = 69.87
2023-04-20 17:27:20,183 - Detection -   train_loss = 1.3912752866744995
2023-04-20 17:27:23,585 - Detection - ***** Epoch: 34: Eval results *****
2023-04-20 17:27:23,586 - Detection -   best_eval_score = 70.16
2023-04-20 17:27:23,586 - Detection -   eval_score = 69.97
2023-04-20 17:27:23,586 - Detection -   train_loss = 1.4081921353936195
2023-04-20 17:27:27,019 - Detection - ***** Epoch: 35: Eval results *****
2023-04-20 17:27:27,019 - Detection -   best_eval_score = 70.16
2023-04-20 17:27:27,019 - Detection -   eval_score = 69.82
2023-04-20 17:27:27,019 - Detection -   train_loss = 1.4181222394108772
2023-04-20 17:27:30,385 - Detection - ***** Epoch: 36: Eval results *****
2023-04-20 17:27:30,385 - Detection -   best_eval_score = 70.16
2023-04-20 17:27:30,385 - Detection -   eval_score = 69.6
2023-04-20 17:27:30,385 - Detection -   train_loss = 1.3735820427536964
2023-04-20 17:27:33,509 - Detection - ***** Epoch: 37: Eval results *****
2023-04-20 17:27:33,509 - Detection -   best_eval_score = 70.16
2023-04-20 17:27:33,509 - Detection -   eval_score = 69.73
2023-04-20 17:27:33,509 - Detection -   train_loss = 1.3882178738713264
2023-04-20 17:27:36,631 - Detection - ***** Epoch: 38: Eval results *****
2023-04-20 17:27:36,631 - Detection -   best_eval_score = 70.16
2023-04-20 17:27:36,631 - Detection -   eval_score = 69.56
2023-04-20 17:27:36,631 - Detection -   train_loss = 1.3728545904159546
2023-04-20 17:27:39,758 - Detection - ***** Epoch: 39: Eval results *****
2023-04-20 17:27:39,758 - Detection -   best_eval_score = 70.16
2023-04-20 17:27:39,758 - Detection -   eval_score = 69.69
2023-04-20 17:27:39,759 - Detection -   train_loss = 1.3853143081068993
2023-04-20 17:27:39,760 - Detection - Training Finished...
2023-04-20 17:27:39,760 - Detection - Testing begin...
2023-04-20 17:27:41,839 - Detection - ***** Test: Confusion Matrix *****
2023-04-20 17:27:41,839 - Detection - [[  2   0   0 ...   0   0  16]
 [  0   7   0 ...   0   0   5]
 [  0   0   3 ...   0   0   3]
 ...
 [  0   0   0 ...  15   0   5]
 [  0   0   0 ...   0   0  21]
 [  0   6   1 ...   1   0 317]]
2023-04-20 17:27:41,839 - Detection - ***** Test results *****
2023-04-20 17:27:41,839 - Detection -   Acc = 63.87
2023-04-20 17:27:41,839 - Detection -   F1 = 65.0008
2023-04-20 17:27:41,839 - Detection -   F1-known = 65.1751
2023-04-20 17:27:41,839 - Detection -   F1-open = 54.8918
2023-04-20 17:27:41,839 - Detection - Testing finished...
2023-04-20 17:27:41,839 - Detection - Results saved in results/results_ADB.csv
2023-04-20 17:27:41,859 - Detection - Open Intent Detection Finished...
