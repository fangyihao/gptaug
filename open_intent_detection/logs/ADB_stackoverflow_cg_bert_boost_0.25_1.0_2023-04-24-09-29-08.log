2023-04-24 09:29:08,648 - Detection - Open Intent Detection Begin...
2023-04-24 09:29:08,649 - Detection - Parameters Initialization...
2023-04-24 09:29:08,649 - Detection - ============================== Params ==============================
2023-04-24 09:29:08,649 - Detection - type:	open_intent_detection
2023-04-24 09:29:08,649 - Detection - logger_name:	Detection
2023-04-24 09:29:08,649 - Detection - log_dir:	logs
2023-04-24 09:29:08,649 - Detection - dataset:	stackoverflow_cg
2023-04-24 09:29:08,649 - Detection - known_cls_ratio:	0.25
2023-04-24 09:29:08,649 - Detection - labeled_ratio:	1.0
2023-04-24 09:29:08,649 - Detection - method:	ADB
2023-04-24 09:29:08,649 - Detection - train:	True
2023-04-24 09:29:08,649 - Detection - pretrain:	True
2023-04-24 09:29:08,649 - Detection - save_model:	False
2023-04-24 09:29:08,649 - Detection - backbone:	bert_boost
2023-04-24 09:29:08,649 - Detection - config_file_name:	ADB
2023-04-24 09:29:08,649 - Detection - seed:	5
2023-04-24 09:29:08,649 - Detection - gpu_id:	0
2023-04-24 09:29:08,649 - Detection - pipe_results_path:	pipe_results
2023-04-24 09:29:08,649 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-24 09:29:08,649 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-24 09:29:08,649 - Detection - model_dir:	models
2023-04-24 09:29:08,649 - Detection - load_pretrained_method:	None
2023-04-24 09:29:08,649 - Detection - result_dir:	results
2023-04-24 09:29:08,649 - Detection - results_file_name:	results_ADB-BOOST-F-10.csv
2023-04-24 09:29:08,649 - Detection - save_results:	True
2023-04-24 09:29:08,649 - Detection - loss_fct:	CrossEntropyLoss
2023-04-24 09:29:08,649 - Detection - boost_method:	F-10
2023-04-24 09:29:08,649 - Detection - boost_start_score:	0.0
2023-04-24 09:29:08,649 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.25_1.0_bert_boost_5
2023-04-24 09:29:08,649 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/ADB_stackoverflow_cg_0.25_1.0_bert_boost_5/models
2023-04-24 09:29:08,649 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-24 09:29:08,649 - Detection - num_train_epochs:	100
2023-04-24 09:29:08,649 - Detection - num_labels:	None
2023-04-24 09:29:08,649 - Detection - max_seq_length:	None
2023-04-24 09:29:08,649 - Detection - freeze_backbone_parameters:	True
2023-04-24 09:29:08,649 - Detection - feat_dim:	768
2023-04-24 09:29:08,649 - Detection - warmup_proportion:	0.1
2023-04-24 09:29:08,649 - Detection - lr_boundary:	0.05
2023-04-24 09:29:08,649 - Detection - lr:	2e-05
2023-04-24 09:29:08,650 - Detection - activation:	relu
2023-04-24 09:29:08,650 - Detection - train_batch_size:	128
2023-04-24 09:29:08,650 - Detection - eval_batch_size:	64
2023-04-24 09:29:08,650 - Detection - test_batch_size:	64
2023-04-24 09:29:08,650 - Detection - wait_patient:	10
2023-04-24 09:29:08,650 - Detection - ============================== End Params ==============================
2023-04-24 09:29:08,650 - Detection - Data and Model Preparation...
2023-04-24 09:29:08,650 - Detection - The number of known intents is 5
2023-04-24 09:29:08,650 - Detection - Lists of known labels are: ['bash', 'excel', 'svn', 'wordpress', 'osx']
2023-04-24 09:29:08,657 - Detection - Number of labeled training samples = 620
2023-04-24 09:29:08,657 - Detection - Number of unlabeled training samples = 2171
2023-04-24 09:29:08,660 - Detection - Number of evaluation samples = 374
2023-04-24 09:29:08,665 - Detection - Number of testing samples = 2905
2023-04-24 09:29:12,619 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-24 09:29:14,300 - Detection - Pre-training Begin...
2023-04-24 09:29:15,725 - Detection - ***** Epoch: 1: Eval results *****
2023-04-24 09:29:15,726 - Detection -   best_eval_score = 0
2023-04-24 09:29:15,726 - Detection -   eval_score = 17.11
2023-04-24 09:29:15,726 - Detection -   train_loss = 1.6177233695983886
2023-04-24 09:29:25,276 - Detection - ***** Epoch: 2: Eval results *****
2023-04-24 09:29:25,276 - Detection -   best_eval_score = 17.11
2023-04-24 09:29:25,276 - Detection -   eval_score = 45.72
2023-04-24 09:29:25,276 - Detection -   train_loss = 1.611089253425598
2023-04-24 09:29:34,674 - Detection - ***** Epoch: 3: Eval results *****
2023-04-24 09:29:34,674 - Detection -   best_eval_score = 45.72
2023-04-24 09:29:34,674 - Detection -   eval_score = 82.09
2023-04-24 09:29:34,674 - Detection -   train_loss = 1.4053499460220338
2023-04-24 09:29:44,057 - Detection - ***** Epoch: 4: Eval results *****
2023-04-24 09:29:44,057 - Detection -   best_eval_score = 82.09
2023-04-24 09:29:44,057 - Detection -   eval_score = 86.9
2023-04-24 09:29:44,057 - Detection -   train_loss = 0.8324666976928711
2023-04-24 09:29:53,474 - Detection - ***** Epoch: 5: Eval results *****
2023-04-24 09:29:53,474 - Detection -   best_eval_score = 86.9
2023-04-24 09:29:53,474 - Detection -   eval_score = 88.5
2023-04-24 09:29:53,474 - Detection -   train_loss = 0.4990349352359772
2023-04-24 09:30:02,951 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 09:30:02,951 - Detection -   best_eval_score = 88.5
2023-04-24 09:30:02,951 - Detection -   eval_score = 87.17
2023-04-24 09:30:02,951 - Detection -   train_loss = 0.36008405685424805
2023-04-24 09:30:12,453 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 09:30:12,453 - Detection -   best_eval_score = 88.5
2023-04-24 09:30:12,453 - Detection -   eval_score = 87.17
2023-04-24 09:30:12,453 - Detection -   train_loss = 0.24175864458084106
2023-04-24 09:30:21,869 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 09:30:21,870 - Detection -   best_eval_score = 88.5
2023-04-24 09:30:21,870 - Detection -   eval_score = 87.97
2023-04-24 09:30:21,870 - Detection -   train_loss = 0.15880219042301177
2023-04-24 09:30:31,459 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 09:30:31,459 - Detection -   best_eval_score = 88.5
2023-04-24 09:30:31,459 - Detection -   eval_score = 86.9
2023-04-24 09:30:31,459 - Detection -   train_loss = 0.10158160775899887
2023-04-24 09:30:40,932 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 09:30:40,932 - Detection -   best_eval_score = 88.5
2023-04-24 09:30:40,932 - Detection -   eval_score = 86.63
2023-04-24 09:30:40,932 - Detection -   train_loss = 0.0648542195558548
2023-04-24 09:30:50,751 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 09:30:50,751 - Detection -   best_eval_score = 88.5
2023-04-24 09:30:50,751 - Detection -   eval_score = 87.97
2023-04-24 09:30:50,751 - Detection -   train_loss = 0.06401558965444565
2023-04-24 09:31:00,195 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 09:31:00,195 - Detection -   best_eval_score = 88.5
2023-04-24 09:31:00,196 - Detection -   eval_score = 88.5
2023-04-24 09:31:00,196 - Detection -   train_loss = 0.041860055178403854
2023-04-24 09:31:10,142 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 09:31:10,143 - Detection -   best_eval_score = 88.5
2023-04-24 09:31:10,143 - Detection -   eval_score = 88.5
2023-04-24 09:31:10,143 - Detection -   train_loss = 0.03708177171647549
2023-04-24 09:31:19,572 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 09:31:19,572 - Detection -   best_eval_score = 88.5
2023-04-24 09:31:19,572 - Detection -   eval_score = 88.5
2023-04-24 09:31:19,572 - Detection -   train_loss = 0.03708985038101673
2023-04-24 09:31:29,076 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 09:31:29,076 - Detection -   best_eval_score = 88.5
2023-04-24 09:31:29,076 - Detection -   eval_score = 88.5
2023-04-24 09:31:29,076 - Detection -   train_loss = 0.03026503697037697
2023-04-24 09:31:29,077 - Detection - Pre-training finished...
2023-04-24 09:31:29,077 - Detection - Training Begin...
2023-04-24 09:31:30,466 - Detection - ***** Epoch: 1: Eval results *****
2023-04-24 09:31:30,466 - Detection -   best_eval_score = 0
2023-04-24 09:31:30,466 - Detection -   eval_score = 0.0
2023-04-24 09:31:30,466 - Detection -   train_loss = 6.052513790130615
2023-04-24 09:31:31,347 - Detection - ***** Epoch: 2: Eval results *****
2023-04-24 09:31:31,347 - Detection -   best_eval_score = 0
2023-04-24 09:31:31,347 - Detection -   eval_score = 0.0
2023-04-24 09:31:31,347 - Detection -   train_loss = 5.919953060150147
2023-04-24 09:31:32,230 - Detection - ***** Epoch: 3: Eval results *****
2023-04-24 09:31:32,230 - Detection -   best_eval_score = 0
2023-04-24 09:31:32,230 - Detection -   eval_score = 0.44
2023-04-24 09:31:32,230 - Detection -   train_loss = 5.842127704620362
2023-04-24 09:31:41,795 - Detection - ***** Epoch: 4: Eval results *****
2023-04-24 09:31:41,795 - Detection -   best_eval_score = 0.44
2023-04-24 09:31:41,795 - Detection -   eval_score = 15.9
2023-04-24 09:31:41,795 - Detection -   train_loss = 5.690857219696045
2023-04-24 09:31:51,157 - Detection - ***** Epoch: 5: Eval results *****
2023-04-24 09:31:51,157 - Detection -   best_eval_score = 15.9
2023-04-24 09:31:51,157 - Detection -   eval_score = 72.53
2023-04-24 09:31:51,157 - Detection -   train_loss = 3.255824899673462
2023-04-24 09:32:00,646 - Detection - ***** Epoch: 6: Eval results *****
2023-04-24 09:32:00,646 - Detection -   best_eval_score = 72.53
2023-04-24 09:32:00,646 - Detection -   eval_score = 73.62
2023-04-24 09:32:00,647 - Detection -   train_loss = 1.0619210124015808
2023-04-24 09:32:10,049 - Detection - ***** Epoch: 7: Eval results *****
2023-04-24 09:32:10,049 - Detection -   best_eval_score = 73.62
2023-04-24 09:32:10,049 - Detection -   eval_score = 73.5
2023-04-24 09:32:10,049 - Detection -   train_loss = 1.0319846153259278
2023-04-24 09:32:19,530 - Detection - ***** Epoch: 8: Eval results *****
2023-04-24 09:32:19,531 - Detection -   best_eval_score = 73.62
2023-04-24 09:32:19,531 - Detection -   eval_score = 73.62
2023-04-24 09:32:19,531 - Detection -   train_loss = 1.046909713745117
2023-04-24 09:32:28,907 - Detection - ***** Epoch: 9: Eval results *****
2023-04-24 09:32:28,908 - Detection -   best_eval_score = 73.62
2023-04-24 09:32:28,908 - Detection -   eval_score = 73.62
2023-04-24 09:32:28,908 - Detection -   train_loss = 1.0396095752716064
2023-04-24 09:32:38,417 - Detection - ***** Epoch: 10: Eval results *****
2023-04-24 09:32:38,417 - Detection -   best_eval_score = 73.62
2023-04-24 09:32:38,417 - Detection -   eval_score = 73.5
2023-04-24 09:32:38,417 - Detection -   train_loss = 0.9920565128326416
2023-04-24 09:32:47,898 - Detection - ***** Epoch: 11: Eval results *****
2023-04-24 09:32:47,898 - Detection -   best_eval_score = 73.62
2023-04-24 09:32:47,898 - Detection -   eval_score = 73.62
2023-04-24 09:32:47,898 - Detection -   train_loss = 1.0039493918418885
2023-04-24 09:32:57,467 - Detection - ***** Epoch: 12: Eval results *****
2023-04-24 09:32:57,467 - Detection -   best_eval_score = 73.62
2023-04-24 09:32:57,467 - Detection -   eval_score = 73.79
2023-04-24 09:32:57,467 - Detection -   train_loss = 1.0544930577278138
2023-04-24 09:33:06,938 - Detection - ***** Epoch: 13: Eval results *****
2023-04-24 09:33:06,938 - Detection -   best_eval_score = 73.79
2023-04-24 09:33:06,938 - Detection -   eval_score = 73.62
2023-04-24 09:33:06,938 - Detection -   train_loss = 1.052734112739563
2023-04-24 09:33:16,362 - Detection - ***** Epoch: 14: Eval results *****
2023-04-24 09:33:16,362 - Detection -   best_eval_score = 73.79
2023-04-24 09:33:16,362 - Detection -   eval_score = 73.62
2023-04-24 09:33:16,362 - Detection -   train_loss = 1.031921887397766
2023-04-24 09:33:25,842 - Detection - ***** Epoch: 15: Eval results *****
2023-04-24 09:33:25,842 - Detection -   best_eval_score = 73.79
2023-04-24 09:33:25,842 - Detection -   eval_score = 73.62
2023-04-24 09:33:25,842 - Detection -   train_loss = 1.0597888708114624
2023-04-24 09:33:35,378 - Detection - ***** Epoch: 16: Eval results *****
2023-04-24 09:33:35,378 - Detection -   best_eval_score = 73.79
2023-04-24 09:33:35,378 - Detection -   eval_score = 73.5
2023-04-24 09:33:35,378 - Detection -   train_loss = 1.0216739535331727
2023-04-24 09:33:44,953 - Detection - ***** Epoch: 17: Eval results *****
2023-04-24 09:33:44,954 - Detection -   best_eval_score = 73.79
2023-04-24 09:33:44,954 - Detection -   eval_score = 73.5
2023-04-24 09:33:44,954 - Detection -   train_loss = 1.0468087077140809
2023-04-24 09:33:54,325 - Detection - ***** Epoch: 18: Eval results *****
2023-04-24 09:33:54,326 - Detection -   best_eval_score = 73.79
2023-04-24 09:33:54,326 - Detection -   eval_score = 73.62
2023-04-24 09:33:54,326 - Detection -   train_loss = 1.0314515829086304
2023-04-24 09:34:03,695 - Detection - ***** Epoch: 19: Eval results *****
2023-04-24 09:34:03,695 - Detection -   best_eval_score = 73.79
2023-04-24 09:34:03,695 - Detection -   eval_score = 73.5
2023-04-24 09:34:03,696 - Detection -   train_loss = 1.0718891382217408
2023-04-24 09:34:13,148 - Detection - ***** Epoch: 20: Eval results *****
2023-04-24 09:34:13,148 - Detection -   best_eval_score = 73.79
2023-04-24 09:34:13,148 - Detection -   eval_score = 73.62
2023-04-24 09:34:13,148 - Detection -   train_loss = 1.031218409538269
2023-04-24 09:34:22,544 - Detection - ***** Epoch: 21: Eval results *****
2023-04-24 09:34:22,545 - Detection -   best_eval_score = 73.79
2023-04-24 09:34:22,545 - Detection -   eval_score = 73.62
2023-04-24 09:34:22,545 - Detection -   train_loss = 1.0638138055801392
2023-04-24 09:34:32,034 - Detection - ***** Epoch: 22: Eval results *****
2023-04-24 09:34:32,034 - Detection -   best_eval_score = 73.79
2023-04-24 09:34:32,034 - Detection -   eval_score = 73.62
2023-04-24 09:34:32,034 - Detection -   train_loss = 1.0214205145835877
2023-04-24 09:34:32,034 - Detection - Training Finished...
2023-04-24 09:34:32,034 - Detection - Testing begin...
2023-04-24 09:34:34,429 - Detection - ***** Test: Confusion Matrix *****
2023-04-24 09:34:34,429 - Detection - [[  95    4    1    3    8   28]
 [   4  102    1    1   11   21]
 [   0    0  122    0    4   23]
 [   2    0    2  110    1   22]
 [   2    1    2    3  152   33]
 [ 219  195   54   56  471 1152]]
2023-04-24 09:34:34,429 - Detection - ***** Test results *****
2023-04-24 09:34:34,429 - Detection -   Acc = 59.66
2023-04-24 09:34:34,429 - Detection -   F1 = 55.9155
2023-04-24 09:34:34,429 - Detection -   F1-known = 53.6486
2023-04-24 09:34:34,429 - Detection -   F1-open = 67.2504
2023-04-24 09:34:34,429 - Detection - Testing finished...
2023-04-24 09:34:34,429 - Detection - Results saved in results/results_ADB-BOOST-F-10.csv
2023-04-24 09:34:34,448 - Detection - Open Intent Detection Finished...
