2023-04-23 00:10:35,855 - Detection - Open Intent Detection Begin...
2023-04-23 00:10:35,856 - Detection - Parameters Initialization...
2023-04-23 00:10:35,856 - Detection - ============================== Params ==============================
2023-04-23 00:10:35,856 - Detection - type:	open_intent_detection
2023-04-23 00:10:35,856 - Detection - logger_name:	Detection
2023-04-23 00:10:35,856 - Detection - log_dir:	logs
2023-04-23 00:10:35,856 - Detection - dataset:	stackoverflow_cg
2023-04-23 00:10:35,856 - Detection - known_cls_ratio:	0.25
2023-04-23 00:10:35,856 - Detection - labeled_ratio:	1.0
2023-04-23 00:10:35,856 - Detection - method:	DA-ADB
2023-04-23 00:10:35,856 - Detection - train:	True
2023-04-23 00:10:35,856 - Detection - pretrain:	True
2023-04-23 00:10:35,856 - Detection - save_model:	False
2023-04-23 00:10:35,856 - Detection - backbone:	bert_disaware_boost
2023-04-23 00:10:35,856 - Detection - config_file_name:	DA-ADB
2023-04-23 00:10:35,856 - Detection - seed:	9
2023-04-23 00:10:35,856 - Detection - gpu_id:	0
2023-04-23 00:10:35,856 - Detection - pipe_results_path:	pipe_results
2023-04-23 00:10:35,856 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-23 00:10:35,856 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-23 00:10:35,856 - Detection - model_dir:	models
2023-04-23 00:10:35,856 - Detection - load_pretrained_method:	None
2023-04-23 00:10:35,856 - Detection - result_dir:	results
2023-04-23 00:10:35,856 - Detection - results_file_name:	results_DA-ADB-BOOST-F-4.csv
2023-04-23 00:10:35,856 - Detection - save_results:	True
2023-04-23 00:10:35,856 - Detection - loss_fct:	CrossEntropyLoss
2023-04-23 00:10:35,856 - Detection - boost_method:	F-4
2023-04-23 00:10:35,856 - Detection - boost_start_score:	0.0
2023-04-23 00:10:35,856 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.25_1.0_bert_disaware_boost_9
2023-04-23 00:10:35,856 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.25_1.0_bert_disaware_boost_9/models
2023-04-23 00:10:35,856 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-23 00:10:35,856 - Detection - num_train_epochs:	100
2023-04-23 00:10:35,856 - Detection - num_labels:	None
2023-04-23 00:10:35,856 - Detection - max_seq_length:	None
2023-04-23 00:10:35,856 - Detection - freeze_backbone_parameters:	True
2023-04-23 00:10:35,856 - Detection - feat_dim:	768
2023-04-23 00:10:35,856 - Detection - warmup_proportion:	0.1
2023-04-23 00:10:35,856 - Detection - scale:	4
2023-04-23 00:10:35,857 - Detection - lr_boundary:	0.05
2023-04-23 00:10:35,857 - Detection - lr:	2e-05
2023-04-23 00:10:35,857 - Detection - activation:	relu
2023-04-23 00:10:35,857 - Detection - train_batch_size:	128
2023-04-23 00:10:35,857 - Detection - eval_batch_size:	64
2023-04-23 00:10:35,857 - Detection - test_batch_size:	64
2023-04-23 00:10:35,857 - Detection - wait_patient:	10
2023-04-23 00:10:35,857 - Detection - ============================== End Params ==============================
2023-04-23 00:10:35,857 - Detection - Data and Model Preparation...
2023-04-23 00:10:35,857 - Detection - The number of known intents is 5
2023-04-23 00:10:35,857 - Detection - Lists of known labels are: ['cocoa', 'haskell', 'hibernate', 'excel', 'spring']
2023-04-23 00:10:35,865 - Detection - Number of labeled training samples = 749
2023-04-23 00:10:35,865 - Detection - Number of unlabeled training samples = 2042
2023-04-23 00:10:35,867 - Detection - Number of evaluation samples = 342
2023-04-23 00:10:35,873 - Detection - Number of testing samples = 2905
2023-04-23 00:10:41,333 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-23 00:10:41,446 - Detection - Pre-training Begin...
2023-04-23 00:10:43,349 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 00:10:43,350 - Detection -   best_eval_score = 0
2023-04-23 00:10:43,350 - Detection -   eval_score = 11.9
2023-04-23 00:10:43,350 - Detection -   train_loss = 1.6517390410105388
2023-04-23 00:10:48,260 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 00:10:48,260 - Detection -   best_eval_score = 11.9
2023-04-23 00:10:48,260 - Detection -   eval_score = 6.47
2023-04-23 00:10:48,260 - Detection -   train_loss = 1.621013919512431
2023-04-23 00:10:53,271 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 00:10:53,271 - Detection -   best_eval_score = 11.9
2023-04-23 00:10:53,271 - Detection -   eval_score = 6.47
2023-04-23 00:10:53,271 - Detection -   train_loss = 1.5545101761817932
2023-04-23 00:10:58,195 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 00:10:58,196 - Detection -   best_eval_score = 11.9
2023-04-23 00:10:58,196 - Detection -   eval_score = 17.28
2023-04-23 00:10:58,196 - Detection -   train_loss = 1.503800372282664
2023-04-23 00:11:03,101 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 00:11:03,101 - Detection -   best_eval_score = 17.28
2023-04-23 00:11:03,101 - Detection -   eval_score = 72.37
2023-04-23 00:11:03,101 - Detection -   train_loss = 1.3913500308990479
2023-04-23 00:11:08,111 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 00:11:08,111 - Detection -   best_eval_score = 72.37
2023-04-23 00:11:08,111 - Detection -   eval_score = 81.55
2023-04-23 00:11:08,111 - Detection -   train_loss = 1.127258876959483
2023-04-23 00:11:13,036 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 00:11:13,037 - Detection -   best_eval_score = 81.55
2023-04-23 00:11:13,037 - Detection -   eval_score = 82.33
2023-04-23 00:11:13,037 - Detection -   train_loss = 0.8037899732589722
2023-04-23 00:11:17,964 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 00:11:17,964 - Detection -   best_eval_score = 82.33
2023-04-23 00:11:17,964 - Detection -   eval_score = 76.66
2023-04-23 00:11:17,964 - Detection -   train_loss = 0.6374919811884562
2023-04-23 00:11:22,856 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 00:11:22,856 - Detection -   best_eval_score = 82.33
2023-04-23 00:11:22,856 - Detection -   eval_score = 83.05
2023-04-23 00:11:22,857 - Detection -   train_loss = 0.5352530976136526
2023-04-23 00:11:27,814 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 00:11:27,814 - Detection -   best_eval_score = 83.05
2023-04-23 00:11:27,814 - Detection -   eval_score = 84.44
2023-04-23 00:11:27,814 - Detection -   train_loss = 0.46681373318036395
2023-04-23 00:11:32,761 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 00:11:32,761 - Detection -   best_eval_score = 84.44
2023-04-23 00:11:32,761 - Detection -   eval_score = 85.2
2023-04-23 00:11:32,761 - Detection -   train_loss = 0.40811936060587567
2023-04-23 00:11:37,715 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 00:11:37,715 - Detection -   best_eval_score = 85.2
2023-04-23 00:11:37,715 - Detection -   eval_score = 85.73
2023-04-23 00:11:37,715 - Detection -   train_loss = 0.3628343641757965
2023-04-23 00:11:42,657 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 00:11:42,657 - Detection -   best_eval_score = 85.73
2023-04-23 00:11:42,657 - Detection -   eval_score = 81.5
2023-04-23 00:11:42,657 - Detection -   train_loss = 0.33988868693510693
2023-04-23 00:11:47,573 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 00:11:47,573 - Detection -   best_eval_score = 85.73
2023-04-23 00:11:47,574 - Detection -   eval_score = 85.9
2023-04-23 00:11:47,574 - Detection -   train_loss = 0.3094789907336235
2023-04-23 00:11:52,613 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 00:11:52,613 - Detection -   best_eval_score = 85.9
2023-04-23 00:11:52,613 - Detection -   eval_score = 83.18
2023-04-23 00:11:52,613 - Detection -   train_loss = 0.26074835409720737
2023-04-23 00:11:57,522 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 00:11:57,522 - Detection -   best_eval_score = 85.9
2023-04-23 00:11:57,522 - Detection -   eval_score = 85.43
2023-04-23 00:11:57,522 - Detection -   train_loss = 0.24226754903793335
2023-04-23 00:12:02,446 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 00:12:02,446 - Detection -   best_eval_score = 85.9
2023-04-23 00:12:02,446 - Detection -   eval_score = 85.64
2023-04-23 00:12:02,446 - Detection -   train_loss = 0.24246671299139658
2023-04-23 00:12:07,375 - Detection - ***** Epoch: 18: Eval results *****
2023-04-23 00:12:07,375 - Detection -   best_eval_score = 85.9
2023-04-23 00:12:07,375 - Detection -   eval_score = 87.42
2023-04-23 00:12:07,375 - Detection -   train_loss = 0.20167614767948785
2023-04-23 00:12:12,414 - Detection - ***** Epoch: 19: Eval results *****
2023-04-23 00:12:12,414 - Detection -   best_eval_score = 87.42
2023-04-23 00:12:12,414 - Detection -   eval_score = 86.33
2023-04-23 00:12:12,414 - Detection -   train_loss = 0.18236645559469858
2023-04-23 00:12:17,370 - Detection - ***** Epoch: 20: Eval results *****
2023-04-23 00:12:17,370 - Detection -   best_eval_score = 87.42
2023-04-23 00:12:17,370 - Detection -   eval_score = 86.26
2023-04-23 00:12:17,370 - Detection -   train_loss = 0.17355679223934808
2023-04-23 00:12:22,344 - Detection - ***** Epoch: 21: Eval results *****
2023-04-23 00:12:22,344 - Detection -   best_eval_score = 87.42
2023-04-23 00:12:22,344 - Detection -   eval_score = 87.16
2023-04-23 00:12:22,344 - Detection -   train_loss = 0.16842179745435715
2023-04-23 00:12:27,255 - Detection - ***** Epoch: 22: Eval results *****
2023-04-23 00:12:27,255 - Detection -   best_eval_score = 87.42
2023-04-23 00:12:27,255 - Detection -   eval_score = 86.31
2023-04-23 00:12:27,255 - Detection -   train_loss = 0.152636689444383
2023-04-23 00:12:32,300 - Detection - ***** Epoch: 23: Eval results *****
2023-04-23 00:12:32,300 - Detection -   best_eval_score = 87.42
2023-04-23 00:12:32,300 - Detection -   eval_score = 86.03
2023-04-23 00:12:32,300 - Detection -   train_loss = 0.14572983731826147
2023-04-23 00:12:37,219 - Detection - ***** Epoch: 24: Eval results *****
2023-04-23 00:12:37,220 - Detection -   best_eval_score = 87.42
2023-04-23 00:12:37,220 - Detection -   eval_score = 86.56
2023-04-23 00:12:37,220 - Detection -   train_loss = 0.14086619516213736
2023-04-23 00:12:42,161 - Detection - ***** Epoch: 25: Eval results *****
2023-04-23 00:12:42,161 - Detection -   best_eval_score = 87.42
2023-04-23 00:12:42,161 - Detection -   eval_score = 86.03
2023-04-23 00:12:42,161 - Detection -   train_loss = 0.1374914087355137
2023-04-23 00:12:47,080 - Detection - ***** Epoch: 26: Eval results *****
2023-04-23 00:12:47,081 - Detection -   best_eval_score = 87.42
2023-04-23 00:12:47,081 - Detection -   eval_score = 86.0
2023-04-23 00:12:47,081 - Detection -   train_loss = 0.1341977765162786
2023-04-23 00:12:52,009 - Detection - ***** Epoch: 27: Eval results *****
2023-04-23 00:12:52,009 - Detection -   best_eval_score = 87.42
2023-04-23 00:12:52,009 - Detection -   eval_score = 85.97
2023-04-23 00:12:52,009 - Detection -   train_loss = 0.12925435105959573
2023-04-23 00:12:57,035 - Detection - ***** Epoch: 28: Eval results *****
2023-04-23 00:12:57,035 - Detection -   best_eval_score = 87.42
2023-04-23 00:12:57,035 - Detection -   eval_score = 86.28
2023-04-23 00:12:57,035 - Detection -   train_loss = 0.12403687834739685
2023-04-23 00:12:57,036 - Detection - Pre-training finished...
2023-04-23 00:12:57,036 - Detection - Training Begin...
2023-04-23 00:12:57,750 - Detection - ***** Epoch: 1: Eval results *****
2023-04-23 00:12:57,750 - Detection -   best_eval_score = 0
2023-04-23 00:12:57,750 - Detection -   eval_score = 0.0
2023-04-23 00:12:57,750 - Detection -   train_loss = 4.337524334589641
2023-04-23 00:12:58,464 - Detection - ***** Epoch: 2: Eval results *****
2023-04-23 00:12:58,464 - Detection -   best_eval_score = 0
2023-04-23 00:12:58,464 - Detection -   eval_score = 1.88
2023-04-23 00:12:58,464 - Detection -   train_loss = 4.1321713129679365
2023-04-23 00:13:02,927 - Detection - ***** Epoch: 3: Eval results *****
2023-04-23 00:13:02,927 - Detection -   best_eval_score = 1.88
2023-04-23 00:13:02,927 - Detection -   eval_score = 23.95
2023-04-23 00:13:02,927 - Detection -   train_loss = 3.903489629427592
2023-04-23 00:13:07,372 - Detection - ***** Epoch: 4: Eval results *****
2023-04-23 00:13:07,372 - Detection -   best_eval_score = 23.95
2023-04-23 00:13:07,372 - Detection -   eval_score = 54.64
2023-04-23 00:13:07,372 - Detection -   train_loss = 2.5281614462534585
2023-04-23 00:13:11,823 - Detection - ***** Epoch: 5: Eval results *****
2023-04-23 00:13:11,823 - Detection -   best_eval_score = 54.64
2023-04-23 00:13:11,823 - Detection -   eval_score = 61.99
2023-04-23 00:13:11,823 - Detection -   train_loss = 1.3531039357185364
2023-04-23 00:13:16,457 - Detection - ***** Epoch: 6: Eval results *****
2023-04-23 00:13:16,458 - Detection -   best_eval_score = 61.99
2023-04-23 00:13:16,458 - Detection -   eval_score = 63.03
2023-04-23 00:13:16,458 - Detection -   train_loss = 1.0406239330768585
2023-04-23 00:13:20,921 - Detection - ***** Epoch: 7: Eval results *****
2023-04-23 00:13:20,921 - Detection -   best_eval_score = 63.03
2023-04-23 00:13:20,921 - Detection -   eval_score = 64.16
2023-04-23 00:13:20,921 - Detection -   train_loss = 1.0278249680995941
2023-04-23 00:13:25,364 - Detection - ***** Epoch: 8: Eval results *****
2023-04-23 00:13:25,364 - Detection -   best_eval_score = 64.16
2023-04-23 00:13:25,364 - Detection -   eval_score = 62.78
2023-04-23 00:13:25,364 - Detection -   train_loss = 0.9762522975603739
2023-04-23 00:13:29,795 - Detection - ***** Epoch: 9: Eval results *****
2023-04-23 00:13:29,795 - Detection -   best_eval_score = 64.16
2023-04-23 00:13:29,795 - Detection -   eval_score = 62.44
2023-04-23 00:13:29,795 - Detection -   train_loss = 1.0369348526000977
2023-04-23 00:13:34,329 - Detection - ***** Epoch: 10: Eval results *****
2023-04-23 00:13:34,329 - Detection -   best_eval_score = 64.16
2023-04-23 00:13:34,329 - Detection -   eval_score = 62.62
2023-04-23 00:13:34,329 - Detection -   train_loss = 1.055991033713023
2023-04-23 00:13:38,773 - Detection - ***** Epoch: 11: Eval results *****
2023-04-23 00:13:38,773 - Detection -   best_eval_score = 64.16
2023-04-23 00:13:38,773 - Detection -   eval_score = 63.03
2023-04-23 00:13:38,773 - Detection -   train_loss = 1.0294883251190186
2023-04-23 00:13:43,200 - Detection - ***** Epoch: 12: Eval results *****
2023-04-23 00:13:43,200 - Detection -   best_eval_score = 64.16
2023-04-23 00:13:43,200 - Detection -   eval_score = 62.62
2023-04-23 00:13:43,200 - Detection -   train_loss = 1.0338563124338787
2023-04-23 00:13:47,669 - Detection - ***** Epoch: 13: Eval results *****
2023-04-23 00:13:47,669 - Detection -   best_eval_score = 64.16
2023-04-23 00:13:47,670 - Detection -   eval_score = 62.61
2023-04-23 00:13:47,670 - Detection -   train_loss = 1.054118404785792
2023-04-23 00:13:52,106 - Detection - ***** Epoch: 14: Eval results *****
2023-04-23 00:13:52,106 - Detection -   best_eval_score = 64.16
2023-04-23 00:13:52,106 - Detection -   eval_score = 61.88
2023-04-23 00:13:52,106 - Detection -   train_loss = 1.0555818776289623
2023-04-23 00:13:56,646 - Detection - ***** Epoch: 15: Eval results *****
2023-04-23 00:13:56,646 - Detection -   best_eval_score = 64.16
2023-04-23 00:13:56,646 - Detection -   eval_score = 62.78
2023-04-23 00:13:56,646 - Detection -   train_loss = 1.0311557352542877
2023-04-23 00:14:01,085 - Detection - ***** Epoch: 16: Eval results *****
2023-04-23 00:14:01,085 - Detection -   best_eval_score = 64.16
2023-04-23 00:14:01,085 - Detection -   eval_score = 62.44
2023-04-23 00:14:01,085 - Detection -   train_loss = 1.013951023419698
2023-04-23 00:14:05,513 - Detection - ***** Epoch: 17: Eval results *****
2023-04-23 00:14:05,513 - Detection -   best_eval_score = 64.16
2023-04-23 00:14:05,513 - Detection -   eval_score = 63.21
2023-04-23 00:14:05,513 - Detection -   train_loss = 1.055269052584966
2023-04-23 00:14:05,513 - Detection - Training Finished...
2023-04-23 00:14:05,513 - Detection - Testing begin...
2023-04-23 00:14:07,262 - Detection - ***** Test: Confusion Matrix *****
2023-04-23 00:14:07,263 - Detection - [[  88    2    0    0    1   70]
 [   0   55    0    1    0   66]
 [   4    3   86    0    3   32]
 [   8    2    0   94    0   36]
 [   2    1    1    0  113   34]
 [ 365  189    2   23   14 1610]]
2023-04-23 00:14:07,263 - Detection - ***** Test results *****
2023-04-23 00:14:07,263 - Detection -   Acc = 70.43
2023-04-23 00:14:07,263 - Detection -   F1 = 61.5328
2023-04-23 00:14:07,263 - Detection -   F1-known = 57.942
2023-04-23 00:14:07,263 - Detection -   F1-open = 79.4865
2023-04-23 00:14:07,263 - Detection - Testing finished...
2023-04-23 00:14:07,263 - Detection - Results saved in results/results_DA-ADB-BOOST-F-4.csv
2023-04-23 00:14:07,281 - Detection - Open Intent Detection Finished...
