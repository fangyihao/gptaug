2023-04-22 14:06:28,639 - Detection - Open Intent Detection Begin...
2023-04-22 14:06:28,639 - Detection - Parameters Initialization...
2023-04-22 14:06:28,639 - Detection - ============================== Params ==============================
2023-04-22 14:06:28,639 - Detection - type:	open_intent_detection
2023-04-22 14:06:28,639 - Detection - logger_name:	Detection
2023-04-22 14:06:28,639 - Detection - log_dir:	logs
2023-04-22 14:06:28,639 - Detection - dataset:	stackoverflow_cg
2023-04-22 14:06:28,639 - Detection - known_cls_ratio:	0.75
2023-04-22 14:06:28,639 - Detection - labeled_ratio:	1.0
2023-04-22 14:06:28,639 - Detection - method:	DA-ADB
2023-04-22 14:06:28,639 - Detection - train:	True
2023-04-22 14:06:28,639 - Detection - pretrain:	True
2023-04-22 14:06:28,639 - Detection - save_model:	False
2023-04-22 14:06:28,639 - Detection - backbone:	bert_disaware_boost
2023-04-22 14:06:28,639 - Detection - config_file_name:	DA-ADB
2023-04-22 14:06:28,639 - Detection - seed:	0
2023-04-22 14:06:28,639 - Detection - gpu_id:	0
2023-04-22 14:06:28,639 - Detection - pipe_results_path:	pipe_results
2023-04-22 14:06:28,639 - Detection - data_dir:	/home/yfang/workspace/TEXTOIR/open_intent_detection/../data
2023-04-22 14:06:28,640 - Detection - output_dir:	/home/yfang/workspace/TEXTOIR/output
2023-04-22 14:06:28,640 - Detection - model_dir:	models
2023-04-22 14:06:28,640 - Detection - load_pretrained_method:	None
2023-04-22 14:06:28,640 - Detection - result_dir:	results
2023-04-22 14:06:28,640 - Detection - results_file_name:	results_DA-ADB-BOOST.csv
2023-04-22 14:06:28,640 - Detection - save_results:	True
2023-04-22 14:06:28,640 - Detection - loss_fct:	CrossEntropyLoss
2023-04-22 14:06:28,640 - Detection - boost_method:	F-10
2023-04-22 14:06:28,640 - Detection - boost_start_score:	0.0
2023-04-22 14:06:28,640 - Detection - method_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.75_1.0_bert_disaware_boost_0
2023-04-22 14:06:28,640 - Detection - model_output_dir:	/home/yfang/workspace/TEXTOIR/output/open_intent_detection/DA-ADB_stackoverflow_cg_0.75_1.0_bert_disaware_boost_0/models
2023-04-22 14:06:28,640 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-04-22 14:06:28,640 - Detection - num_train_epochs:	100
2023-04-22 14:06:28,640 - Detection - num_labels:	None
2023-04-22 14:06:28,640 - Detection - max_seq_length:	None
2023-04-22 14:06:28,640 - Detection - freeze_backbone_parameters:	True
2023-04-22 14:06:28,640 - Detection - feat_dim:	768
2023-04-22 14:06:28,640 - Detection - warmup_proportion:	0.1
2023-04-22 14:06:28,640 - Detection - scale:	4
2023-04-22 14:06:28,640 - Detection - lr_boundary:	0.05
2023-04-22 14:06:28,640 - Detection - lr:	2e-05
2023-04-22 14:06:28,640 - Detection - activation:	relu
2023-04-22 14:06:28,640 - Detection - train_batch_size:	128
2023-04-22 14:06:28,640 - Detection - eval_batch_size:	64
2023-04-22 14:06:28,640 - Detection - test_batch_size:	64
2023-04-22 14:06:28,640 - Detection - wait_patient:	10
2023-04-22 14:06:28,640 - Detection - ============================== End Params ==============================
2023-04-22 14:06:28,640 - Detection - Data and Model Preparation...
2023-04-22 14:06:28,640 - Detection - The number of known intents is 15
2023-04-22 14:06:28,641 - Detection - Lists of known labels are: ['visual-studio', 'apache', 'wordpress', 'linq', 'matlab', 'svn', 'haskell', 'qt', 'drupal', 'bash', 'excel', 'scala', 'magento', 'hibernate', 'spring']
2023-04-22 14:06:28,650 - Detection - Number of labeled training samples = 1997
2023-04-22 14:06:28,650 - Detection - Number of unlabeled training samples = 794
2023-04-22 14:06:28,653 - Detection - Number of evaluation samples = 1053
2023-04-22 14:06:28,659 - Detection - Number of testing samples = 2905
2023-04-22 14:06:34,398 - Detection - Freeze all parameters but the last layer for efficiency
2023-04-22 14:06:34,479 - Detection - Pre-training Begin...
2023-04-22 14:06:39,422 - Detection - ***** Epoch: 1: Eval results *****
2023-04-22 14:06:39,422 - Detection -   best_eval_score = 0
2023-04-22 14:06:39,422 - Detection -   eval_score = 0.71
2023-04-22 14:06:39,422 - Detection -   train_loss = 2.7046753466129303
2023-04-22 14:07:10,761 - Detection - ***** Epoch: 2: Eval results *****
2023-04-22 14:07:10,761 - Detection -   best_eval_score = 0.71
2023-04-22 14:07:10,761 - Detection -   eval_score = 6.18
2023-04-22 14:07:10,761 - Detection -   train_loss = 2.6936188340187073
2023-04-22 14:07:42,126 - Detection - ***** Epoch: 3: Eval results *****
2023-04-22 14:07:42,126 - Detection -   best_eval_score = 6.18
2023-04-22 14:07:42,126 - Detection -   eval_score = 38.67
2023-04-22 14:07:42,126 - Detection -   train_loss = 2.5736617892980576
2023-04-22 14:08:13,566 - Detection - ***** Epoch: 4: Eval results *****
2023-04-22 14:08:13,566 - Detection -   best_eval_score = 38.67
2023-04-22 14:08:13,566 - Detection -   eval_score = 77.98
2023-04-22 14:08:13,566 - Detection -   train_loss = 2.209879606962204
2023-04-22 14:08:44,938 - Detection - ***** Epoch: 5: Eval results *****
2023-04-22 14:08:44,938 - Detection -   best_eval_score = 77.98
2023-04-22 14:08:44,938 - Detection -   eval_score = 82.27
2023-04-22 14:08:44,938 - Detection -   train_loss = 1.6408190354704857
2023-04-22 14:09:16,443 - Detection - ***** Epoch: 6: Eval results *****
2023-04-22 14:09:16,443 - Detection -   best_eval_score = 82.27
2023-04-22 14:09:16,443 - Detection -   eval_score = 83.22
2023-04-22 14:09:16,443 - Detection -   train_loss = 1.30137250572443
2023-04-22 14:09:47,959 - Detection - ***** Epoch: 7: Eval results *****
2023-04-22 14:09:47,959 - Detection -   best_eval_score = 83.22
2023-04-22 14:09:47,959 - Detection -   eval_score = 83.78
2023-04-22 14:09:47,959 - Detection -   train_loss = 1.1166504360735416
2023-04-22 14:10:19,657 - Detection - ***** Epoch: 8: Eval results *****
2023-04-22 14:10:19,657 - Detection -   best_eval_score = 83.78
2023-04-22 14:10:19,657 - Detection -   eval_score = 84.38
2023-04-22 14:10:19,657 - Detection -   train_loss = 0.9919242300093174
2023-04-22 14:10:51,340 - Detection - ***** Epoch: 9: Eval results *****
2023-04-22 14:10:51,340 - Detection -   best_eval_score = 84.38
2023-04-22 14:10:51,340 - Detection -   eval_score = 84.74
2023-04-22 14:10:51,340 - Detection -   train_loss = 0.9050860740244389
2023-04-22 14:11:22,903 - Detection - ***** Epoch: 10: Eval results *****
2023-04-22 14:11:22,903 - Detection -   best_eval_score = 84.74
2023-04-22 14:11:22,903 - Detection -   eval_score = 85.06
2023-04-22 14:11:22,903 - Detection -   train_loss = 0.8177713416516781
2023-04-22 14:11:54,441 - Detection - ***** Epoch: 11: Eval results *****
2023-04-22 14:11:54,441 - Detection -   best_eval_score = 85.06
2023-04-22 14:11:54,441 - Detection -   eval_score = 85.35
2023-04-22 14:11:54,441 - Detection -   train_loss = 0.7405992820858955
2023-04-22 14:12:25,977 - Detection - ***** Epoch: 12: Eval results *****
2023-04-22 14:12:25,977 - Detection -   best_eval_score = 85.35
2023-04-22 14:12:25,977 - Detection -   eval_score = 85.32
2023-04-22 14:12:25,977 - Detection -   train_loss = 0.6614910885691643
2023-04-22 14:12:57,377 - Detection - ***** Epoch: 13: Eval results *****
2023-04-22 14:12:57,377 - Detection -   best_eval_score = 85.35
2023-04-22 14:12:57,377 - Detection -   eval_score = 85.03
2023-04-22 14:12:57,377 - Detection -   train_loss = 0.6224972866475582
2023-04-22 14:13:29,054 - Detection - ***** Epoch: 14: Eval results *****
2023-04-22 14:13:29,054 - Detection -   best_eval_score = 85.35
2023-04-22 14:13:29,054 - Detection -   eval_score = 84.52
2023-04-22 14:13:29,054 - Detection -   train_loss = 0.5742037259042263
2023-04-22 14:14:00,348 - Detection - ***** Epoch: 15: Eval results *****
2023-04-22 14:14:00,348 - Detection -   best_eval_score = 85.35
2023-04-22 14:14:00,348 - Detection -   eval_score = 84.11
2023-04-22 14:14:00,348 - Detection -   train_loss = 0.5351852960884571
2023-04-22 14:14:31,812 - Detection - ***** Epoch: 16: Eval results *****
2023-04-22 14:14:31,812 - Detection -   best_eval_score = 85.35
2023-04-22 14:14:31,812 - Detection -   eval_score = 84.66
2023-04-22 14:14:31,812 - Detection -   train_loss = 0.505572184920311
2023-04-22 14:15:03,244 - Detection - ***** Epoch: 17: Eval results *****
2023-04-22 14:15:03,244 - Detection -   best_eval_score = 85.35
2023-04-22 14:15:03,244 - Detection -   eval_score = 84.5
2023-04-22 14:15:03,244 - Detection -   train_loss = 0.472369521856308
2023-04-22 14:15:34,678 - Detection - ***** Epoch: 18: Eval results *****
2023-04-22 14:15:34,679 - Detection -   best_eval_score = 85.35
2023-04-22 14:15:34,679 - Detection -   eval_score = 84.28
2023-04-22 14:15:34,679 - Detection -   train_loss = 0.46141442842781544
2023-04-22 14:16:06,039 - Detection - ***** Epoch: 19: Eval results *****
2023-04-22 14:16:06,039 - Detection -   best_eval_score = 85.35
2023-04-22 14:16:06,039 - Detection -   eval_score = 85.03
2023-04-22 14:16:06,039 - Detection -   train_loss = 0.4339229241013527
2023-04-22 14:16:37,625 - Detection - ***** Epoch: 20: Eval results *****
2023-04-22 14:16:37,625 - Detection -   best_eval_score = 85.35
2023-04-22 14:16:37,626 - Detection -   eval_score = 85.43
2023-04-22 14:16:37,626 - Detection -   train_loss = 0.4132860265672207
2023-04-22 14:17:09,049 - Detection - ***** Epoch: 21: Eval results *****
2023-04-22 14:17:09,050 - Detection -   best_eval_score = 85.43
2023-04-22 14:17:09,050 - Detection -   eval_score = 85.97
2023-04-22 14:17:09,050 - Detection -   train_loss = 0.38877373188734055
2023-04-22 14:17:40,468 - Detection - ***** Epoch: 22: Eval results *****
2023-04-22 14:17:40,469 - Detection -   best_eval_score = 85.97
2023-04-22 14:17:40,469 - Detection -   eval_score = 85.41
2023-04-22 14:17:40,469 - Detection -   train_loss = 0.38846205919981003
2023-04-22 14:18:11,798 - Detection - ***** Epoch: 23: Eval results *****
2023-04-22 14:18:11,798 - Detection -   best_eval_score = 85.97
2023-04-22 14:18:11,798 - Detection -   eval_score = 85.22
2023-04-22 14:18:11,798 - Detection -   train_loss = 0.36986334808170795
2023-04-22 14:18:43,476 - Detection - ***** Epoch: 24: Eval results *****
2023-04-22 14:18:43,476 - Detection -   best_eval_score = 85.97
2023-04-22 14:18:43,476 - Detection -   eval_score = 85.22
2023-04-22 14:18:43,476 - Detection -   train_loss = 0.359803956001997
2023-04-22 14:19:15,007 - Detection - ***** Epoch: 25: Eval results *****
2023-04-22 14:19:15,007 - Detection -   best_eval_score = 85.97
2023-04-22 14:19:15,007 - Detection -   eval_score = 85.67
2023-04-22 14:19:15,007 - Detection -   train_loss = 0.3532730620354414
2023-04-22 14:19:46,308 - Detection - ***** Epoch: 26: Eval results *****
2023-04-22 14:19:46,308 - Detection -   best_eval_score = 85.97
2023-04-22 14:19:46,308 - Detection -   eval_score = 85.48
2023-04-22 14:19:46,308 - Detection -   train_loss = 0.3438389115035534
2023-04-22 14:20:17,761 - Detection - ***** Epoch: 27: Eval results *****
2023-04-22 14:20:17,761 - Detection -   best_eval_score = 85.97
2023-04-22 14:20:17,761 - Detection -   eval_score = 85.87
2023-04-22 14:20:17,761 - Detection -   train_loss = 0.33946442417800426
2023-04-22 14:20:49,091 - Detection - ***** Epoch: 28: Eval results *****
2023-04-22 14:20:49,091 - Detection -   best_eval_score = 85.97
2023-04-22 14:20:49,091 - Detection -   eval_score = 84.84
2023-04-22 14:20:49,091 - Detection -   train_loss = 0.32713244296610355
2023-04-22 14:21:20,652 - Detection - ***** Epoch: 29: Eval results *****
2023-04-22 14:21:20,652 - Detection -   best_eval_score = 85.97
2023-04-22 14:21:20,652 - Detection -   eval_score = 85.65
2023-04-22 14:21:20,652 - Detection -   train_loss = 0.32572513073682785
2023-04-22 14:21:52,254 - Detection - ***** Epoch: 30: Eval results *****
2023-04-22 14:21:52,254 - Detection -   best_eval_score = 85.97
2023-04-22 14:21:52,254 - Detection -   eval_score = 85.79
2023-04-22 14:21:52,254 - Detection -   train_loss = 0.3160015996545553
2023-04-22 14:22:23,871 - Detection - ***** Epoch: 31: Eval results *****
2023-04-22 14:22:23,871 - Detection -   best_eval_score = 85.97
2023-04-22 14:22:23,871 - Detection -   eval_score = 85.17
2023-04-22 14:22:23,871 - Detection -   train_loss = 0.31033599004149437
2023-04-22 14:22:23,872 - Detection - Pre-training finished...
2023-04-22 14:22:23,872 - Detection - Training Begin...
2023-04-22 14:22:26,593 - Detection - ***** Epoch: 1: Eval results *****
2023-04-22 14:22:26,593 - Detection -   best_eval_score = 0
2023-04-22 14:22:26,593 - Detection -   eval_score = 1.92
2023-04-22 14:22:26,593 - Detection -   train_loss = 5.738132923841476
2023-04-22 14:22:56,290 - Detection - ***** Epoch: 2: Eval results *****
2023-04-22 14:22:56,290 - Detection -   best_eval_score = 1.92
2023-04-22 14:22:56,290 - Detection -   eval_score = 77.01
2023-04-22 14:22:56,290 - Detection -   train_loss = 5.312514096498489
2023-04-22 14:23:25,960 - Detection - ***** Epoch: 3: Eval results *****
2023-04-22 14:23:25,960 - Detection -   best_eval_score = 77.01
2023-04-22 14:23:25,960 - Detection -   eval_score = 76.67
2023-04-22 14:23:25,960 - Detection -   train_loss = 1.4177061766386032
2023-04-22 14:23:55,583 - Detection - ***** Epoch: 4: Eval results *****
2023-04-22 14:23:55,583 - Detection -   best_eval_score = 77.01
2023-04-22 14:23:55,583 - Detection -   eval_score = 76.51
2023-04-22 14:23:55,583 - Detection -   train_loss = 1.4175290539860725
2023-04-22 14:24:25,178 - Detection - ***** Epoch: 5: Eval results *****
2023-04-22 14:24:25,178 - Detection -   best_eval_score = 77.01
2023-04-22 14:24:25,178 - Detection -   eval_score = 76.79
2023-04-22 14:24:25,178 - Detection -   train_loss = 1.3981485441327095
2023-04-22 14:24:54,757 - Detection - ***** Epoch: 6: Eval results *****
2023-04-22 14:24:54,757 - Detection -   best_eval_score = 77.01
2023-04-22 14:24:54,757 - Detection -   eval_score = 76.55
2023-04-22 14:24:54,757 - Detection -   train_loss = 1.3955291211605072
2023-04-22 14:25:24,377 - Detection - ***** Epoch: 7: Eval results *****
2023-04-22 14:25:24,378 - Detection -   best_eval_score = 77.01
2023-04-22 14:25:24,378 - Detection -   eval_score = 76.67
2023-04-22 14:25:24,378 - Detection -   train_loss = 1.4043146818876266
2023-04-22 14:25:54,074 - Detection - ***** Epoch: 8: Eval results *****
2023-04-22 14:25:54,074 - Detection -   best_eval_score = 77.01
2023-04-22 14:25:54,075 - Detection -   eval_score = 76.14
2023-04-22 14:25:54,075 - Detection -   train_loss = 1.4053517952561378
2023-04-22 14:26:23,677 - Detection - ***** Epoch: 9: Eval results *****
2023-04-22 14:26:23,677 - Detection -   best_eval_score = 77.01
2023-04-22 14:26:23,677 - Detection -   eval_score = 76.72
2023-04-22 14:26:23,677 - Detection -   train_loss = 1.3851222544908524
2023-04-22 14:26:53,237 - Detection - ***** Epoch: 10: Eval results *****
2023-04-22 14:26:53,237 - Detection -   best_eval_score = 77.01
2023-04-22 14:26:53,237 - Detection -   eval_score = 76.52
2023-04-22 14:26:53,237 - Detection -   train_loss = 1.426361694931984
2023-04-22 14:27:22,866 - Detection - ***** Epoch: 11: Eval results *****
2023-04-22 14:27:22,866 - Detection -   best_eval_score = 77.01
2023-04-22 14:27:22,866 - Detection -   eval_score = 76.92
2023-04-22 14:27:22,866 - Detection -   train_loss = 1.416449412703514
2023-04-22 14:27:52,383 - Detection - ***** Epoch: 12: Eval results *****
2023-04-22 14:27:52,383 - Detection -   best_eval_score = 77.01
2023-04-22 14:27:52,383 - Detection -   eval_score = 76.92
2023-04-22 14:27:52,383 - Detection -   train_loss = 1.4288491979241371
2023-04-22 14:27:52,383 - Detection - Training Finished...
2023-04-22 14:27:52,384 - Detection - Testing begin...
2023-04-22 14:27:54,801 - Detection - ***** Test: Confusion Matrix *****
2023-04-22 14:27:54,801 - Detection - [[ 43   0   0   0   0   0   0   0   0   0   0   0   0   0   0  63]
 [  0  58   1   0   0   1   0   0   1   0   1   0   0   0   0 108]
 [  0   1 107   0   0   0   0   0   0   0   0   0   0   0   0  29]
 [  0   0   0 106   0   0   1   0   0   0   0   1   0   0   0  23]
 [  0   0   0   0 128   0   0   0   0   0   0   1   0   0   0  35]
 [  1   0   0   0   0 103   0   1   0   0   0   0   0   0   0  44]
 [  0   0   0   0   0   0  65   0   0   0   0   0   0   0   0  57]
 [  0   0   0   0   0   0   0 153   0   0   0   0   0   0   0  19]
 [  0   1   0   0   0   0   0   0 102   0   0   0   0   0   0  25]
 [  1   0   0   0   0   0   0   0   0  70   0   0   0   0   0  68]
 [  0   0   0   0   0   0   0   0   0   0  92   0   0   0   0  48]
 [  0   0   0   0   0   0   3   0   0   0   0  84   0   0   0  37]
 [  0   0   0   0   0   0   0   1   0   0   0   0 106   0   0  25]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0  81   2  45]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   4  92  55]
 [  7  14   2   0   0   2   2   5   0   1   4   0   0   1   7 767]]
2023-04-22 14:27:54,801 - Detection - ***** Test results *****
2023-04-22 14:27:54,801 - Detection -   Acc = 74.25
2023-04-22 14:27:54,801 - Detection -   F1 = 76.5205
2023-04-22 14:27:54,801 - Detection -   F1-known = 77.0968
2023-04-22 14:27:54,801 - Detection -   F1-open = 67.8761
2023-04-22 14:27:54,801 - Detection - Testing finished...
2023-04-22 14:27:54,801 - Detection - Results saved in results/results_DA-ADB-BOOST.csv
2023-04-22 14:27:54,821 - Detection - Open Intent Detection Finished...
